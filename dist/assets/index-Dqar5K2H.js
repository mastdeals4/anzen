var GD=Object.defineProperty;var XD=(e,t,r)=>t in e?GD(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Kr=(e,t,r)=>XD(e,typeof t!="symbol"?t+"":t,r);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();var hi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function RS(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var MS={exports:{}},bx={},QS={exports:{}},Nr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var T0=Symbol.for("react.element"),YD=Symbol.for("react.portal"),JD=Symbol.for("react.fragment"),ZD=Symbol.for("react.strict_mode"),e8=Symbol.for("react.profiler"),t8=Symbol.for("react.provider"),r8=Symbol.for("react.context"),n8=Symbol.for("react.forward_ref"),a8=Symbol.for("react.suspense"),s8=Symbol.for("react.memo"),i8=Symbol.for("react.lazy"),RN=Symbol.iterator;function o8(e){return e===null||typeof e!="object"?null:(e=RN&&e[RN]||e["@@iterator"],typeof e=="function"?e:null)}var HS={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},qS=Object.assign,$S={};function HA(e,t,r){this.props=e,this.context=t,this.refs=$S,this.updater=r||HS}HA.prototype.isReactComponent={};HA.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};HA.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function KS(){}KS.prototype=HA.prototype;function rw(e,t,r){this.props=e,this.context=t,this.refs=$S,this.updater=r||HS}var nw=rw.prototype=new KS;nw.constructor=rw;qS(nw,HA.prototype);nw.isPureReactComponent=!0;var MN=Array.isArray,VS=Object.prototype.hasOwnProperty,aw={current:null},WS={key:!0,ref:!0,__self:!0,__source:!0};function zS(e,t,r){var a,s={},i=null,o=null;if(t!=null)for(a in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(i=""+t.key),t)VS.call(t,a)&&!WS.hasOwnProperty(a)&&(s[a]=t[a]);var l=arguments.length-2;if(l===1)s.children=r;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];s.children=c}if(e&&e.defaultProps)for(a in l=e.defaultProps,l)s[a]===void 0&&(s[a]=l[a]);return{$$typeof:T0,type:e,key:i,ref:o,props:s,_owner:aw.current}}function l8(e,t){return{$$typeof:T0,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function sw(e){return typeof e=="object"&&e!==null&&e.$$typeof===T0}function c8(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var QN=/\/+/g;function Vy(e,t){return typeof e=="object"&&e!==null&&e.key!=null?c8(""+e.key):t.toString(36)}function Hm(e,t,r,a,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case T0:case YD:o=!0}}if(o)return o=e,s=s(o),e=a===""?"."+Vy(o,0):a,MN(s)?(r="",e!=null&&(r=e.replace(QN,"$&/")+"/"),Hm(s,t,r,"",function(d){return d})):s!=null&&(sw(s)&&(s=l8(s,r+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(QN,"$&/")+"/")+e)),t.push(s)),1;if(o=0,a=a===""?".":a+":",MN(e))for(var l=0;l<e.length;l++){i=e[l];var c=a+Vy(i,l);o+=Hm(i,t,r,c,s)}else if(c=o8(e),typeof c=="function")for(e=c.call(e),l=0;!(i=e.next()).done;)i=i.value,c=a+Vy(i,l++),o+=Hm(i,t,r,c,s);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function kp(e,t,r){if(e==null)return e;var a=[],s=0;return Hm(e,a,"","",function(i){return t.call(r,i,s++)}),a}function d8(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Ds={current:null},qm={transition:null},u8={ReactCurrentDispatcher:Ds,ReactCurrentBatchConfig:qm,ReactCurrentOwner:aw};function GS(){throw Error("act(...) is not supported in production builds of React.")}Nr.Children={map:kp,forEach:function(e,t,r){kp(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return kp(e,function(){t++}),t},toArray:function(e){return kp(e,function(t){return t})||[]},only:function(e){if(!sw(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Nr.Component=HA;Nr.Fragment=JD;Nr.Profiler=e8;Nr.PureComponent=rw;Nr.StrictMode=ZD;Nr.Suspense=a8;Nr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=u8;Nr.act=GS;Nr.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=qS({},e.props),s=e.key,i=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,o=aw.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)VS.call(t,c)&&!WS.hasOwnProperty(c)&&(a[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)a.children=r;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];a.children=l}return{$$typeof:T0,type:e.type,key:s,ref:i,props:a,_owner:o}};Nr.createContext=function(e){return e={$$typeof:r8,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:t8,_context:e},e.Consumer=e};Nr.createElement=zS;Nr.createFactory=function(e){var t=zS.bind(null,e);return t.type=e,t};Nr.createRef=function(){return{current:null}};Nr.forwardRef=function(e){return{$$typeof:n8,render:e}};Nr.isValidElement=sw;Nr.lazy=function(e){return{$$typeof:i8,_payload:{_status:-1,_result:e},_init:d8}};Nr.memo=function(e,t){return{$$typeof:s8,type:e,compare:t===void 0?null:t}};Nr.startTransition=function(e){var t=qm.transition;qm.transition={};try{e()}finally{qm.transition=t}};Nr.unstable_act=GS;Nr.useCallback=function(e,t){return Ds.current.useCallback(e,t)};Nr.useContext=function(e){return Ds.current.useContext(e)};Nr.useDebugValue=function(){};Nr.useDeferredValue=function(e){return Ds.current.useDeferredValue(e)};Nr.useEffect=function(e,t){return Ds.current.useEffect(e,t)};Nr.useId=function(){return Ds.current.useId()};Nr.useImperativeHandle=function(e,t,r){return Ds.current.useImperativeHandle(e,t,r)};Nr.useInsertionEffect=function(e,t){return Ds.current.useInsertionEffect(e,t)};Nr.useLayoutEffect=function(e,t){return Ds.current.useLayoutEffect(e,t)};Nr.useMemo=function(e,t){return Ds.current.useMemo(e,t)};Nr.useReducer=function(e,t,r){return Ds.current.useReducer(e,t,r)};Nr.useRef=function(e){return Ds.current.useRef(e)};Nr.useState=function(e){return Ds.current.useState(e)};Nr.useSyncExternalStore=function(e,t,r){return Ds.current.useSyncExternalStore(e,t,r)};Nr.useTransition=function(){return Ds.current.useTransition()};Nr.version="18.3.1";QS.exports=Nr;var Q=QS.exports;const A8=RS(Q);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var h8=Q,f8=Symbol.for("react.element"),p8=Symbol.for("react.fragment"),m8=Object.prototype.hasOwnProperty,g8=h8.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,x8={key:!0,ref:!0,__self:!0,__source:!0};function XS(e,t,r){var a,s={},i=null,o=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(a in t)m8.call(t,a)&&!x8.hasOwnProperty(a)&&(s[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps,t)s[a]===void 0&&(s[a]=t[a]);return{$$typeof:f8,type:e,key:i,ref:o,props:s,_owner:g8.current}}bx.Fragment=p8;bx.jsx=XS;bx.jsxs=XS;MS.exports=bx;var n=MS.exports,YS={exports:{}},yi={},JS={exports:{}},ZS={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(Y,G){var re=Y.length;Y.push(G);e:for(;0<re;){var U=re-1>>>1,S=Y[U];if(0<s(S,G))Y[U]=G,Y[re]=S,re=U;else break e}}function r(Y){return Y.length===0?null:Y[0]}function a(Y){if(Y.length===0)return null;var G=Y[0],re=Y.pop();if(re!==G){Y[0]=re;e:for(var U=0,S=Y.length,D=S>>>1;U<D;){var L=2*(U+1)-1,P=Y[L],I=L+1,H=Y[I];if(0>s(P,re))I<S&&0>s(H,P)?(Y[U]=H,Y[I]=re,U=I):(Y[U]=P,Y[L]=re,U=L);else if(I<S&&0>s(H,re))Y[U]=H,Y[I]=re,U=I;else break e}}return G}function s(Y,G){var re=Y.sortIndex-G.sortIndex;return re!==0?re:Y.id-G.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],d=[],u=1,f=null,h=3,A=!1,x=!1,p=!1,b=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,g=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(Y){for(var G=r(d);G!==null;){if(G.callback===null)a(d);else if(G.startTime<=Y)a(d),G.sortIndex=G.expirationTime,t(c,G);else break;G=r(d)}}function v(Y){if(p=!1,y(Y),!x)if(r(c)!==null)x=!0,z(_);else{var G=r(d);G!==null&&ee(v,G.startTime-Y)}}function _(Y,G){x=!1,p&&(p=!1,m(B),B=-1),A=!0;var re=h;try{for(y(G),f=r(c);f!==null&&(!(f.expirationTime>G)||Y&&!k());){var U=f.callback;if(typeof U=="function"){f.callback=null,h=f.priorityLevel;var S=U(f.expirationTime<=G);G=e.unstable_now(),typeof S=="function"?f.callback=S:f===r(c)&&a(c),y(G)}else a(c);f=r(c)}if(f!==null)var D=!0;else{var L=r(d);L!==null&&ee(v,L.startTime-G),D=!1}return D}finally{f=null,h=re,A=!1}}var j=!1,N=null,B=-1,E=5,C=-1;function k(){return!(e.unstable_now()-C<E)}function w(){if(N!==null){var Y=e.unstable_now();C=Y;var G=!0;try{G=N(!0,Y)}finally{G?T():(j=!1,N=null)}}else j=!1}var T;if(typeof g=="function")T=function(){g(w)};else if(typeof MessageChannel<"u"){var R=new MessageChannel,q=R.port2;R.port1.onmessage=w,T=function(){q.postMessage(null)}}else T=function(){b(w,0)};function z(Y){N=Y,j||(j=!0,T())}function ee(Y,G){B=b(function(){Y(e.unstable_now())},G)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Y){Y.callback=null},e.unstable_continueExecution=function(){x||A||(x=!0,z(_))},e.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<Y?Math.floor(1e3/Y):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(Y){switch(h){case 1:case 2:case 3:var G=3;break;default:G=h}var re=h;h=G;try{return Y()}finally{h=re}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Y,G){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var re=h;h=Y;try{return G()}finally{h=re}},e.unstable_scheduleCallback=function(Y,G,re){var U=e.unstable_now();switch(typeof re=="object"&&re!==null?(re=re.delay,re=typeof re=="number"&&0<re?U+re:U):re=U,Y){case 1:var S=-1;break;case 2:S=250;break;case 5:S=1073741823;break;case 4:S=1e4;break;default:S=5e3}return S=re+S,Y={id:u++,callback:G,priorityLevel:Y,startTime:re,expirationTime:S,sortIndex:-1},re>U?(Y.sortIndex=re,t(d,Y),r(c)===null&&Y===r(d)&&(p?(m(B),B=-1):p=!0,ee(v,re-U))):(Y.sortIndex=S,t(c,Y),x||A||(x=!0,z(_))),Y},e.unstable_shouldYield=k,e.unstable_wrapCallback=function(Y){var G=h;return function(){var re=h;h=G;try{return Y.apply(this,arguments)}finally{h=re}}}})(ZS);JS.exports=ZS;var y8=JS.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var v8=Q,gi=y8;function Ct(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var e3=new Set,Hf={};function au(e,t){EA(e,t),EA(e+"Capture",t)}function EA(e,t){for(Hf[e]=t,e=0;e<t.length;e++)e3.add(t[e])}var Dl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),W1=Object.prototype.hasOwnProperty,b8=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,HN={},qN={};function _8(e){return W1.call(qN,e)?!0:W1.call(HN,e)?!1:b8.test(e)?qN[e]=!0:(HN[e]=!0,!1)}function w8(e,t,r,a){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return a?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function N8(e,t,r,a){if(t===null||typeof t>"u"||w8(e,t,r,a))return!0;if(a)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Ls(e,t,r,a,s,i,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=a,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var Xa={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Xa[e]=new Ls(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Xa[t]=new Ls(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Xa[e]=new Ls(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Xa[e]=new Ls(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Xa[e]=new Ls(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Xa[e]=new Ls(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Xa[e]=new Ls(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Xa[e]=new Ls(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Xa[e]=new Ls(e,5,!1,e.toLowerCase(),null,!1,!1)});var iw=/[\-:]([a-z])/g;function ow(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(iw,ow);Xa[t]=new Ls(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(iw,ow);Xa[t]=new Ls(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(iw,ow);Xa[t]=new Ls(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Xa[e]=new Ls(e,1,!1,e.toLowerCase(),null,!1,!1)});Xa.xlinkHref=new Ls("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Xa[e]=new Ls(e,1,!1,e.toLowerCase(),null,!0,!0)});function lw(e,t,r,a){var s=Xa.hasOwnProperty(t)?Xa[t]:null;(s!==null?s.type!==0:a||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(N8(t,r,s,a)&&(r=null),a||s===null?_8(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,a=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,a?e.setAttributeNS(a,t,r):e.setAttribute(t,r))))}var Hl=v8.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Cp=Symbol.for("react.element"),Yu=Symbol.for("react.portal"),Ju=Symbol.for("react.fragment"),cw=Symbol.for("react.strict_mode"),z1=Symbol.for("react.profiler"),t3=Symbol.for("react.provider"),r3=Symbol.for("react.context"),dw=Symbol.for("react.forward_ref"),G1=Symbol.for("react.suspense"),X1=Symbol.for("react.suspense_list"),uw=Symbol.for("react.memo"),mc=Symbol.for("react.lazy"),n3=Symbol.for("react.offscreen"),$N=Symbol.iterator;function Bh(e){return e===null||typeof e!="object"?null:(e=$N&&e[$N]||e["@@iterator"],typeof e=="function"?e:null)}var Bn=Object.assign,Wy;function Zh(e){if(Wy===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Wy=t&&t[1]||""}return`
`+Wy+e}var zy=!1;function Gy(e,t){if(!e||zy)return"";zy=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var a=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){a=d}e.call(t.prototype)}else{try{throw Error()}catch(d){a=d}e()}}catch(d){if(d&&a&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=a.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var c=`
`+s[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=l);break}}}finally{zy=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Zh(e):""}function j8(e){switch(e.tag){case 5:return Zh(e.type);case 16:return Zh("Lazy");case 13:return Zh("Suspense");case 19:return Zh("SuspenseList");case 0:case 2:case 15:return e=Gy(e.type,!1),e;case 11:return e=Gy(e.type.render,!1),e;case 1:return e=Gy(e.type,!0),e;default:return""}}function Y1(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Ju:return"Fragment";case Yu:return"Portal";case z1:return"Profiler";case cw:return"StrictMode";case G1:return"Suspense";case X1:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case r3:return(e.displayName||"Context")+".Consumer";case t3:return(e._context.displayName||"Context")+".Provider";case dw:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case uw:return t=e.displayName||null,t!==null?t:Y1(e.type)||"Memo";case mc:t=e._payload,e=e._init;try{return Y1(e(t))}catch{}}return null}function k8(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Y1(t);case 8:return t===cw?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Hc(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function a3(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function C8(e){var t=a3(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),a=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(o){a=""+o,i.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return a},setValue:function(o){a=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Sp(e){e._valueTracker||(e._valueTracker=C8(e))}function s3(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),a="";return e&&(a=a3(e)?e.checked?"true":"false":e.value),e=a,e!==r?(t.setValue(e),!0):!1}function Ag(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function J1(e,t){var r=t.checked;return Bn({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function KN(e,t){var r=t.defaultValue==null?"":t.defaultValue,a=t.checked!=null?t.checked:t.defaultChecked;r=Hc(t.value!=null?t.value:r),e._wrapperState={initialChecked:a,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function i3(e,t){t=t.checked,t!=null&&lw(e,"checked",t,!1)}function Z1(e,t){i3(e,t);var r=Hc(t.value),a=t.type;if(r!=null)a==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(a==="submit"||a==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?eb(e,t.type,r):t.hasOwnProperty("defaultValue")&&eb(e,t.type,Hc(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function VN(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var a=t.type;if(!(a!=="submit"&&a!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function eb(e,t,r){(t!=="number"||Ag(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var ef=Array.isArray;function hA(e,t,r,a){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&a&&(e[r].defaultSelected=!0)}else{for(r=""+Hc(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,a&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function tb(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Ct(91));return Bn({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function WN(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Ct(92));if(ef(r)){if(1<r.length)throw Error(Ct(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Hc(r)}}function o3(e,t){var r=Hc(t.value),a=Hc(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),a!=null&&(e.defaultValue=""+a)}function zN(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function l3(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function rb(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?l3(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Bp,c3=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,a,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,a,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Bp=Bp||document.createElement("div"),Bp.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Bp.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function qf(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var mf={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},S8=["Webkit","ms","Moz","O"];Object.keys(mf).forEach(function(e){S8.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),mf[t]=mf[e]})});function d3(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||mf.hasOwnProperty(e)&&mf[e]?(""+t).trim():t+"px"}function u3(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var a=r.indexOf("--")===0,s=d3(r,t[r],a);r==="float"&&(r="cssFloat"),a?e.setProperty(r,s):e[r]=s}}var B8=Bn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function nb(e,t){if(t){if(B8[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Ct(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Ct(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Ct(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Ct(62))}}function ab(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var sb=null;function Aw(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var ib=null,fA=null,pA=null;function GN(e){if(e=L0(e)){if(typeof ib!="function")throw Error(Ct(280));var t=e.stateNode;t&&(t=kx(t),ib(e.stateNode,e.type,t))}}function A3(e){fA?pA?pA.push(e):pA=[e]:fA=e}function h3(){if(fA){var e=fA,t=pA;if(pA=fA=null,GN(e),t)for(e=0;e<t.length;e++)GN(t[e])}}function f3(e,t){return e(t)}function p3(){}var Xy=!1;function m3(e,t,r){if(Xy)return e(t,r);Xy=!0;try{return f3(e,t,r)}finally{Xy=!1,(fA!==null||pA!==null)&&(p3(),h3())}}function $f(e,t){var r=e.stateNode;if(r===null)return null;var a=kx(r);if(a===null)return null;r=a[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(e=e.type,a=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!a;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Ct(231,t,typeof r));return r}var ob=!1;if(Dl)try{var Eh={};Object.defineProperty(Eh,"passive",{get:function(){ob=!0}}),window.addEventListener("test",Eh,Eh),window.removeEventListener("test",Eh,Eh)}catch{ob=!1}function E8(e,t,r,a,s,i,o,l,c){var d=Array.prototype.slice.call(arguments,3);try{t.apply(r,d)}catch(u){this.onError(u)}}var gf=!1,hg=null,fg=!1,lb=null,F8={onError:function(e){gf=!0,hg=e}};function T8(e,t,r,a,s,i,o,l,c){gf=!1,hg=null,E8.apply(F8,arguments)}function I8(e,t,r,a,s,i,o,l,c){if(T8.apply(this,arguments),gf){if(gf){var d=hg;gf=!1,hg=null}else throw Error(Ct(198));fg||(fg=!0,lb=d)}}function su(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function g3(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function XN(e){if(su(e)!==e)throw Error(Ct(188))}function D8(e){var t=e.alternate;if(!t){if(t=su(e),t===null)throw Error(Ct(188));return t!==e?null:e}for(var r=e,a=t;;){var s=r.return;if(s===null)break;var i=s.alternate;if(i===null){if(a=s.return,a!==null){r=a;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===r)return XN(s),e;if(i===a)return XN(s),t;i=i.sibling}throw Error(Ct(188))}if(r.return!==a.return)r=s,a=i;else{for(var o=!1,l=s.child;l;){if(l===r){o=!0,r=s,a=i;break}if(l===a){o=!0,a=s,r=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===r){o=!0,r=i,a=s;break}if(l===a){o=!0,a=i,r=s;break}l=l.sibling}if(!o)throw Error(Ct(189))}}if(r.alternate!==a)throw Error(Ct(190))}if(r.tag!==3)throw Error(Ct(188));return r.stateNode.current===r?e:t}function x3(e){return e=D8(e),e!==null?y3(e):null}function y3(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=y3(e);if(t!==null)return t;e=e.sibling}return null}var v3=gi.unstable_scheduleCallback,YN=gi.unstable_cancelCallback,L8=gi.unstable_shouldYield,P8=gi.unstable_requestPaint,zn=gi.unstable_now,O8=gi.unstable_getCurrentPriorityLevel,hw=gi.unstable_ImmediatePriority,b3=gi.unstable_UserBlockingPriority,pg=gi.unstable_NormalPriority,U8=gi.unstable_LowPriority,_3=gi.unstable_IdlePriority,_x=null,$o=null;function R8(e){if($o&&typeof $o.onCommitFiberRoot=="function")try{$o.onCommitFiberRoot(_x,e,void 0,(e.current.flags&128)===128)}catch{}}var po=Math.clz32?Math.clz32:H8,M8=Math.log,Q8=Math.LN2;function H8(e){return e>>>=0,e===0?32:31-(M8(e)/Q8|0)|0}var Ep=64,Fp=4194304;function tf(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function mg(e,t){var r=e.pendingLanes;if(r===0)return 0;var a=0,s=e.suspendedLanes,i=e.pingedLanes,o=r&268435455;if(o!==0){var l=o&~s;l!==0?a=tf(l):(i&=o,i!==0&&(a=tf(i)))}else o=r&~s,o!==0?a=tf(o):i!==0&&(a=tf(i));if(a===0)return 0;if(t!==0&&t!==a&&!(t&s)&&(s=a&-a,i=t&-t,s>=i||s===16&&(i&4194240)!==0))return t;if(a&4&&(a|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=a;0<t;)r=31-po(t),s=1<<r,a|=e[r],t&=~s;return a}function q8(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function $8(e,t){for(var r=e.suspendedLanes,a=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-po(i),l=1<<o,c=s[o];c===-1?(!(l&r)||l&a)&&(s[o]=q8(l,t)):c<=t&&(e.expiredLanes|=l),i&=~l}}function cb(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function w3(){var e=Ep;return Ep<<=1,!(Ep&4194240)&&(Ep=64),e}function Yy(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function I0(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-po(t),e[t]=r}function K8(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var a=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-po(r),i=1<<s;t[s]=0,a[s]=-1,e[s]=-1,r&=~i}}function fw(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var a=31-po(r),s=1<<a;s&t|e[a]&t&&(e[a]|=t),r&=~s}}var Xr=0;function N3(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var j3,pw,k3,C3,S3,db=!1,Tp=[],Fc=null,Tc=null,Ic=null,Kf=new Map,Vf=new Map,vc=[],V8="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function JN(e,t){switch(e){case"focusin":case"focusout":Fc=null;break;case"dragenter":case"dragleave":Tc=null;break;case"mouseover":case"mouseout":Ic=null;break;case"pointerover":case"pointerout":Kf.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Vf.delete(t.pointerId)}}function Fh(e,t,r,a,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:a,nativeEvent:i,targetContainers:[s]},t!==null&&(t=L0(t),t!==null&&pw(t)),e):(e.eventSystemFlags|=a,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function W8(e,t,r,a,s){switch(t){case"focusin":return Fc=Fh(Fc,e,t,r,a,s),!0;case"dragenter":return Tc=Fh(Tc,e,t,r,a,s),!0;case"mouseover":return Ic=Fh(Ic,e,t,r,a,s),!0;case"pointerover":var i=s.pointerId;return Kf.set(i,Fh(Kf.get(i)||null,e,t,r,a,s)),!0;case"gotpointercapture":return i=s.pointerId,Vf.set(i,Fh(Vf.get(i)||null,e,t,r,a,s)),!0}return!1}function B3(e){var t=Bd(e.target);if(t!==null){var r=su(t);if(r!==null){if(t=r.tag,t===13){if(t=g3(r),t!==null){e.blockedOn=t,S3(e.priority,function(){k3(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function $m(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=ub(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var a=new r.constructor(r.type,r);sb=a,r.target.dispatchEvent(a),sb=null}else return t=L0(r),t!==null&&pw(t),e.blockedOn=r,!1;t.shift()}return!0}function ZN(e,t,r){$m(e)&&r.delete(t)}function z8(){db=!1,Fc!==null&&$m(Fc)&&(Fc=null),Tc!==null&&$m(Tc)&&(Tc=null),Ic!==null&&$m(Ic)&&(Ic=null),Kf.forEach(ZN),Vf.forEach(ZN)}function Th(e,t){e.blockedOn===t&&(e.blockedOn=null,db||(db=!0,gi.unstable_scheduleCallback(gi.unstable_NormalPriority,z8)))}function Wf(e){function t(s){return Th(s,e)}if(0<Tp.length){Th(Tp[0],e);for(var r=1;r<Tp.length;r++){var a=Tp[r];a.blockedOn===e&&(a.blockedOn=null)}}for(Fc!==null&&Th(Fc,e),Tc!==null&&Th(Tc,e),Ic!==null&&Th(Ic,e),Kf.forEach(t),Vf.forEach(t),r=0;r<vc.length;r++)a=vc[r],a.blockedOn===e&&(a.blockedOn=null);for(;0<vc.length&&(r=vc[0],r.blockedOn===null);)B3(r),r.blockedOn===null&&vc.shift()}var mA=Hl.ReactCurrentBatchConfig,gg=!0;function G8(e,t,r,a){var s=Xr,i=mA.transition;mA.transition=null;try{Xr=1,mw(e,t,r,a)}finally{Xr=s,mA.transition=i}}function X8(e,t,r,a){var s=Xr,i=mA.transition;mA.transition=null;try{Xr=4,mw(e,t,r,a)}finally{Xr=s,mA.transition=i}}function mw(e,t,r,a){if(gg){var s=ub(e,t,r,a);if(s===null)ov(e,t,a,xg,r),JN(e,a);else if(W8(s,e,t,r,a))a.stopPropagation();else if(JN(e,a),t&4&&-1<V8.indexOf(e)){for(;s!==null;){var i=L0(s);if(i!==null&&j3(i),i=ub(e,t,r,a),i===null&&ov(e,t,a,xg,r),i===s)break;s=i}s!==null&&a.stopPropagation()}else ov(e,t,a,null,r)}}var xg=null;function ub(e,t,r,a){if(xg=null,e=Aw(a),e=Bd(e),e!==null)if(t=su(e),t===null)e=null;else if(r=t.tag,r===13){if(e=g3(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return xg=e,null}function E3(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(O8()){case hw:return 1;case b3:return 4;case pg:case U8:return 16;case _3:return 536870912;default:return 16}default:return 16}}var wc=null,gw=null,Km=null;function F3(){if(Km)return Km;var e,t=gw,r=t.length,a,s="value"in wc?wc.value:wc.textContent,i=s.length;for(e=0;e<r&&t[e]===s[e];e++);var o=r-e;for(a=1;a<=o&&t[r-a]===s[i-a];a++);return Km=s.slice(e,1<a?1-a:void 0)}function Vm(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Ip(){return!0}function ej(){return!1}function vi(e){function t(r,a,s,i,o){this._reactName=r,this._targetInst=s,this.type=a,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Ip:ej,this.isPropagationStopped=ej,this}return Bn(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Ip)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Ip)},persist:function(){},isPersistent:Ip}),t}var qA={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},xw=vi(qA),D0=Bn({},qA,{view:0,detail:0}),Y8=vi(D0),Jy,Zy,Ih,wx=Bn({},D0,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:yw,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ih&&(Ih&&e.type==="mousemove"?(Jy=e.screenX-Ih.screenX,Zy=e.screenY-Ih.screenY):Zy=Jy=0,Ih=e),Jy)},movementY:function(e){return"movementY"in e?e.movementY:Zy}}),tj=vi(wx),J8=Bn({},wx,{dataTransfer:0}),Z8=vi(J8),eL=Bn({},D0,{relatedTarget:0}),ev=vi(eL),tL=Bn({},qA,{animationName:0,elapsedTime:0,pseudoElement:0}),rL=vi(tL),nL=Bn({},qA,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),aL=vi(nL),sL=Bn({},qA,{data:0}),rj=vi(sL),iL={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},oL={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},lL={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function cL(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=lL[e])?!!t[e]:!1}function yw(){return cL}var dL=Bn({},D0,{key:function(e){if(e.key){var t=iL[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Vm(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?oL[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:yw,charCode:function(e){return e.type==="keypress"?Vm(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Vm(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),uL=vi(dL),AL=Bn({},wx,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),nj=vi(AL),hL=Bn({},D0,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:yw}),fL=vi(hL),pL=Bn({},qA,{propertyName:0,elapsedTime:0,pseudoElement:0}),mL=vi(pL),gL=Bn({},wx,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),xL=vi(gL),yL=[9,13,27,32],vw=Dl&&"CompositionEvent"in window,xf=null;Dl&&"documentMode"in document&&(xf=document.documentMode);var vL=Dl&&"TextEvent"in window&&!xf,T3=Dl&&(!vw||xf&&8<xf&&11>=xf),aj=" ",sj=!1;function I3(e,t){switch(e){case"keyup":return yL.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function D3(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Zu=!1;function bL(e,t){switch(e){case"compositionend":return D3(t);case"keypress":return t.which!==32?null:(sj=!0,aj);case"textInput":return e=t.data,e===aj&&sj?null:e;default:return null}}function _L(e,t){if(Zu)return e==="compositionend"||!vw&&I3(e,t)?(e=F3(),Km=gw=wc=null,Zu=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return T3&&t.locale!=="ko"?null:t.data;default:return null}}var wL={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ij(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!wL[e.type]:t==="textarea"}function L3(e,t,r,a){A3(a),t=yg(t,"onChange"),0<t.length&&(r=new xw("onChange","change",null,r,a),e.push({event:r,listeners:t}))}var yf=null,zf=null;function NL(e){V3(e,0)}function Nx(e){var t=rA(e);if(s3(t))return e}function jL(e,t){if(e==="change")return t}var P3=!1;if(Dl){var tv;if(Dl){var rv="oninput"in document;if(!rv){var oj=document.createElement("div");oj.setAttribute("oninput","return;"),rv=typeof oj.oninput=="function"}tv=rv}else tv=!1;P3=tv&&(!document.documentMode||9<document.documentMode)}function lj(){yf&&(yf.detachEvent("onpropertychange",O3),zf=yf=null)}function O3(e){if(e.propertyName==="value"&&Nx(zf)){var t=[];L3(t,zf,e,Aw(e)),m3(NL,t)}}function kL(e,t,r){e==="focusin"?(lj(),yf=t,zf=r,yf.attachEvent("onpropertychange",O3)):e==="focusout"&&lj()}function CL(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Nx(zf)}function SL(e,t){if(e==="click")return Nx(t)}function BL(e,t){if(e==="input"||e==="change")return Nx(t)}function EL(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var yo=typeof Object.is=="function"?Object.is:EL;function Gf(e,t){if(yo(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),a=Object.keys(t);if(r.length!==a.length)return!1;for(a=0;a<r.length;a++){var s=r[a];if(!W1.call(t,s)||!yo(e[s],t[s]))return!1}return!0}function cj(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function dj(e,t){var r=cj(e);e=0;for(var a;r;){if(r.nodeType===3){if(a=e+r.textContent.length,e<=t&&a>=t)return{node:r,offset:t-e};e=a}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cj(r)}}function U3(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?U3(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function R3(){for(var e=window,t=Ag();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Ag(e.document)}return t}function bw(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function FL(e){var t=R3(),r=e.focusedElem,a=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&U3(r.ownerDocument.documentElement,r)){if(a!==null&&bw(r)){if(t=a.start,e=a.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,i=Math.min(a.start,s);a=a.end===void 0?i:Math.min(a.end,s),!e.extend&&i>a&&(s=a,a=i,i=s),s=dj(r,i);var o=dj(r,a);s&&o&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),i>a?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var TL=Dl&&"documentMode"in document&&11>=document.documentMode,eA=null,Ab=null,vf=null,hb=!1;function uj(e,t,r){var a=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;hb||eA==null||eA!==Ag(a)||(a=eA,"selectionStart"in a&&bw(a)?a={start:a.selectionStart,end:a.selectionEnd}:(a=(a.ownerDocument&&a.ownerDocument.defaultView||window).getSelection(),a={anchorNode:a.anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset}),vf&&Gf(vf,a)||(vf=a,a=yg(Ab,"onSelect"),0<a.length&&(t=new xw("onSelect","select",null,t,r),e.push({event:t,listeners:a}),t.target=eA)))}function Dp(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var tA={animationend:Dp("Animation","AnimationEnd"),animationiteration:Dp("Animation","AnimationIteration"),animationstart:Dp("Animation","AnimationStart"),transitionend:Dp("Transition","TransitionEnd")},nv={},M3={};Dl&&(M3=document.createElement("div").style,"AnimationEvent"in window||(delete tA.animationend.animation,delete tA.animationiteration.animation,delete tA.animationstart.animation),"TransitionEvent"in window||delete tA.transitionend.transition);function jx(e){if(nv[e])return nv[e];if(!tA[e])return e;var t=tA[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in M3)return nv[e]=t[r];return e}var Q3=jx("animationend"),H3=jx("animationiteration"),q3=jx("animationstart"),$3=jx("transitionend"),K3=new Map,Aj="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Xc(e,t){K3.set(e,t),au(t,[e])}for(var av=0;av<Aj.length;av++){var sv=Aj[av],IL=sv.toLowerCase(),DL=sv[0].toUpperCase()+sv.slice(1);Xc(IL,"on"+DL)}Xc(Q3,"onAnimationEnd");Xc(H3,"onAnimationIteration");Xc(q3,"onAnimationStart");Xc("dblclick","onDoubleClick");Xc("focusin","onFocus");Xc("focusout","onBlur");Xc($3,"onTransitionEnd");EA("onMouseEnter",["mouseout","mouseover"]);EA("onMouseLeave",["mouseout","mouseover"]);EA("onPointerEnter",["pointerout","pointerover"]);EA("onPointerLeave",["pointerout","pointerover"]);au("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));au("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));au("onBeforeInput",["compositionend","keypress","textInput","paste"]);au("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));au("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));au("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var rf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),LL=new Set("cancel close invalid load scroll toggle".split(" ").concat(rf));function hj(e,t,r){var a=e.type||"unknown-event";e.currentTarget=r,I8(a,t,void 0,e),e.currentTarget=null}function V3(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var a=e[r],s=a.event;a=a.listeners;e:{var i=void 0;if(t)for(var o=a.length-1;0<=o;o--){var l=a[o],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;hj(s,l,d),i=c}else for(o=0;o<a.length;o++){if(l=a[o],c=l.instance,d=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;hj(s,l,d),i=c}}}if(fg)throw e=lb,fg=!1,lb=null,e}function un(e,t){var r=t[xb];r===void 0&&(r=t[xb]=new Set);var a=e+"__bubble";r.has(a)||(W3(t,e,2,!1),r.add(a))}function iv(e,t,r){var a=0;t&&(a|=4),W3(r,e,a,t)}var Lp="_reactListening"+Math.random().toString(36).slice(2);function Xf(e){if(!e[Lp]){e[Lp]=!0,e3.forEach(function(r){r!=="selectionchange"&&(LL.has(r)||iv(r,!1,e),iv(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Lp]||(t[Lp]=!0,iv("selectionchange",!1,t))}}function W3(e,t,r,a){switch(E3(t)){case 1:var s=G8;break;case 4:s=X8;break;default:s=mw}r=s.bind(null,t,r,e),s=void 0,!ob||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),a?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function ov(e,t,r,a,s){var i=a;if(!(t&1)&&!(t&2)&&a!==null)e:for(;;){if(a===null)return;var o=a.tag;if(o===3||o===4){var l=a.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=a.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;l!==null;){if(o=Bd(l),o===null)return;if(c=o.tag,c===5||c===6){a=i=o;continue e}l=l.parentNode}}a=a.return}m3(function(){var d=i,u=Aw(r),f=[];e:{var h=K3.get(e);if(h!==void 0){var A=xw,x=e;switch(e){case"keypress":if(Vm(r)===0)break e;case"keydown":case"keyup":A=uL;break;case"focusin":x="focus",A=ev;break;case"focusout":x="blur",A=ev;break;case"beforeblur":case"afterblur":A=ev;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":A=tj;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":A=Z8;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":A=fL;break;case Q3:case H3:case q3:A=rL;break;case $3:A=mL;break;case"scroll":A=Y8;break;case"wheel":A=xL;break;case"copy":case"cut":case"paste":A=aL;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":A=nj}var p=(t&4)!==0,b=!p&&e==="scroll",m=p?h!==null?h+"Capture":null:h;p=[];for(var g=d,y;g!==null;){y=g;var v=y.stateNode;if(y.tag===5&&v!==null&&(y=v,m!==null&&(v=$f(g,m),v!=null&&p.push(Yf(g,v,y)))),b)break;g=g.return}0<p.length&&(h=new A(h,x,null,r,u),f.push({event:h,listeners:p}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",A=e==="mouseout"||e==="pointerout",h&&r!==sb&&(x=r.relatedTarget||r.fromElement)&&(Bd(x)||x[Ll]))break e;if((A||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,A?(x=r.relatedTarget||r.toElement,A=d,x=x?Bd(x):null,x!==null&&(b=su(x),x!==b||x.tag!==5&&x.tag!==6)&&(x=null)):(A=null,x=d),A!==x)){if(p=tj,v="onMouseLeave",m="onMouseEnter",g="mouse",(e==="pointerout"||e==="pointerover")&&(p=nj,v="onPointerLeave",m="onPointerEnter",g="pointer"),b=A==null?h:rA(A),y=x==null?h:rA(x),h=new p(v,g+"leave",A,r,u),h.target=b,h.relatedTarget=y,v=null,Bd(u)===d&&(p=new p(m,g+"enter",x,r,u),p.target=y,p.relatedTarget=b,v=p),b=v,A&&x)t:{for(p=A,m=x,g=0,y=p;y;y=Nu(y))g++;for(y=0,v=m;v;v=Nu(v))y++;for(;0<g-y;)p=Nu(p),g--;for(;0<y-g;)m=Nu(m),y--;for(;g--;){if(p===m||m!==null&&p===m.alternate)break t;p=Nu(p),m=Nu(m)}p=null}else p=null;A!==null&&fj(f,h,A,p,!1),x!==null&&b!==null&&fj(f,b,x,p,!0)}}e:{if(h=d?rA(d):window,A=h.nodeName&&h.nodeName.toLowerCase(),A==="select"||A==="input"&&h.type==="file")var _=jL;else if(ij(h))if(P3)_=BL;else{_=CL;var j=kL}else(A=h.nodeName)&&A.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(_=SL);if(_&&(_=_(e,d))){L3(f,_,r,u);break e}j&&j(e,h,d),e==="focusout"&&(j=h._wrapperState)&&j.controlled&&h.type==="number"&&eb(h,"number",h.value)}switch(j=d?rA(d):window,e){case"focusin":(ij(j)||j.contentEditable==="true")&&(eA=j,Ab=d,vf=null);break;case"focusout":vf=Ab=eA=null;break;case"mousedown":hb=!0;break;case"contextmenu":case"mouseup":case"dragend":hb=!1,uj(f,r,u);break;case"selectionchange":if(TL)break;case"keydown":case"keyup":uj(f,r,u)}var N;if(vw)e:{switch(e){case"compositionstart":var B="onCompositionStart";break e;case"compositionend":B="onCompositionEnd";break e;case"compositionupdate":B="onCompositionUpdate";break e}B=void 0}else Zu?I3(e,r)&&(B="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(B="onCompositionStart");B&&(T3&&r.locale!=="ko"&&(Zu||B!=="onCompositionStart"?B==="onCompositionEnd"&&Zu&&(N=F3()):(wc=u,gw="value"in wc?wc.value:wc.textContent,Zu=!0)),j=yg(d,B),0<j.length&&(B=new rj(B,e,null,r,u),f.push({event:B,listeners:j}),N?B.data=N:(N=D3(r),N!==null&&(B.data=N)))),(N=vL?bL(e,r):_L(e,r))&&(d=yg(d,"onBeforeInput"),0<d.length&&(u=new rj("onBeforeInput","beforeinput",null,r,u),f.push({event:u,listeners:d}),u.data=N))}V3(f,t)})}function Yf(e,t,r){return{instance:e,listener:t,currentTarget:r}}function yg(e,t){for(var r=t+"Capture",a=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=$f(e,r),i!=null&&a.unshift(Yf(e,i,s)),i=$f(e,t),i!=null&&a.push(Yf(e,i,s))),e=e.return}return a}function Nu(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function fj(e,t,r,a,s){for(var i=t._reactName,o=[];r!==null&&r!==a;){var l=r,c=l.alternate,d=l.stateNode;if(c!==null&&c===a)break;l.tag===5&&d!==null&&(l=d,s?(c=$f(r,i),c!=null&&o.unshift(Yf(r,c,l))):s||(c=$f(r,i),c!=null&&o.push(Yf(r,c,l)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var PL=/\r\n?/g,OL=/\u0000|\uFFFD/g;function pj(e){return(typeof e=="string"?e:""+e).replace(PL,`
`).replace(OL,"")}function Pp(e,t,r){if(t=pj(t),pj(e)!==t&&r)throw Error(Ct(425))}function vg(){}var fb=null,pb=null;function mb(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var gb=typeof setTimeout=="function"?setTimeout:void 0,UL=typeof clearTimeout=="function"?clearTimeout:void 0,mj=typeof Promise=="function"?Promise:void 0,RL=typeof queueMicrotask=="function"?queueMicrotask:typeof mj<"u"?function(e){return mj.resolve(null).then(e).catch(ML)}:gb;function ML(e){setTimeout(function(){throw e})}function lv(e,t){var r=t,a=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(a===0){e.removeChild(s),Wf(t);return}a--}else r!=="$"&&r!=="$?"&&r!=="$!"||a++;r=s}while(r);Wf(t)}function Dc(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function gj(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var $A=Math.random().toString(36).slice(2),Mo="__reactFiber$"+$A,Jf="__reactProps$"+$A,Ll="__reactContainer$"+$A,xb="__reactEvents$"+$A,QL="__reactListeners$"+$A,HL="__reactHandles$"+$A;function Bd(e){var t=e[Mo];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Ll]||r[Mo]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=gj(e);e!==null;){if(r=e[Mo])return r;e=gj(e)}return t}e=r,r=e.parentNode}return null}function L0(e){return e=e[Mo]||e[Ll],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function rA(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Ct(33))}function kx(e){return e[Jf]||null}var yb=[],nA=-1;function Yc(e){return{current:e}}function mn(e){0>nA||(e.current=yb[nA],yb[nA]=null,nA--)}function ln(e,t){nA++,yb[nA]=e.current,e.current=t}var qc={},fs=Yc(qc),qs=Yc(!1),$d=qc;function FA(e,t){var r=e.type.contextTypes;if(!r)return qc;var a=e.stateNode;if(a&&a.__reactInternalMemoizedUnmaskedChildContext===t)return a.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in r)s[i]=t[i];return a&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function $s(e){return e=e.childContextTypes,e!=null}function bg(){mn(qs),mn(fs)}function xj(e,t,r){if(fs.current!==qc)throw Error(Ct(168));ln(fs,t),ln(qs,r)}function z3(e,t,r){var a=e.stateNode;if(t=t.childContextTypes,typeof a.getChildContext!="function")return r;a=a.getChildContext();for(var s in a)if(!(s in t))throw Error(Ct(108,k8(e)||"Unknown",s));return Bn({},r,a)}function _g(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||qc,$d=fs.current,ln(fs,e),ln(qs,qs.current),!0}function yj(e,t,r){var a=e.stateNode;if(!a)throw Error(Ct(169));r?(e=z3(e,t,$d),a.__reactInternalMemoizedMergedChildContext=e,mn(qs),mn(fs),ln(fs,e)):mn(qs),ln(qs,r)}var Nl=null,Cx=!1,cv=!1;function G3(e){Nl===null?Nl=[e]:Nl.push(e)}function qL(e){Cx=!0,G3(e)}function Jc(){if(!cv&&Nl!==null){cv=!0;var e=0,t=Xr;try{var r=Nl;for(Xr=1;e<r.length;e++){var a=r[e];do a=a(!0);while(a!==null)}Nl=null,Cx=!1}catch(s){throw Nl!==null&&(Nl=Nl.slice(e+1)),v3(hw,Jc),s}finally{Xr=t,cv=!1}}return null}var aA=[],sA=0,wg=null,Ng=0,Di=[],Li=0,Kd=null,kl=1,Cl="";function yd(e,t){aA[sA++]=Ng,aA[sA++]=wg,wg=e,Ng=t}function X3(e,t,r){Di[Li++]=kl,Di[Li++]=Cl,Di[Li++]=Kd,Kd=e;var a=kl;e=Cl;var s=32-po(a)-1;a&=~(1<<s),r+=1;var i=32-po(t)+s;if(30<i){var o=s-s%5;i=(a&(1<<o)-1).toString(32),a>>=o,s-=o,kl=1<<32-po(t)+s|r<<s|a,Cl=i+e}else kl=1<<i|r<<s|a,Cl=e}function _w(e){e.return!==null&&(yd(e,1),X3(e,1,0))}function ww(e){for(;e===wg;)wg=aA[--sA],aA[sA]=null,Ng=aA[--sA],aA[sA]=null;for(;e===Kd;)Kd=Di[--Li],Di[Li]=null,Cl=Di[--Li],Di[Li]=null,kl=Di[--Li],Di[Li]=null}var mi=null,fi=null,wn=!1,uo=null;function Y3(e,t){var r=Oi(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function vj(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,mi=e,fi=Dc(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,mi=e,fi=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Kd!==null?{id:kl,overflow:Cl}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Oi(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,mi=e,fi=null,!0):!1;default:return!1}}function vb(e){return(e.mode&1)!==0&&(e.flags&128)===0}function bb(e){if(wn){var t=fi;if(t){var r=t;if(!vj(e,t)){if(vb(e))throw Error(Ct(418));t=Dc(r.nextSibling);var a=mi;t&&vj(e,t)?Y3(a,r):(e.flags=e.flags&-4097|2,wn=!1,mi=e)}}else{if(vb(e))throw Error(Ct(418));e.flags=e.flags&-4097|2,wn=!1,mi=e}}}function bj(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;mi=e}function Op(e){if(e!==mi)return!1;if(!wn)return bj(e),wn=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!mb(e.type,e.memoizedProps)),t&&(t=fi)){if(vb(e))throw J3(),Error(Ct(418));for(;t;)Y3(e,t),t=Dc(t.nextSibling)}if(bj(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Ct(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){fi=Dc(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}fi=null}}else fi=mi?Dc(e.stateNode.nextSibling):null;return!0}function J3(){for(var e=fi;e;)e=Dc(e.nextSibling)}function TA(){fi=mi=null,wn=!1}function Nw(e){uo===null?uo=[e]:uo.push(e)}var $L=Hl.ReactCurrentBatchConfig;function Dh(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Ct(309));var a=r.stateNode}if(!a)throw Error(Ct(147,e));var s=a,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},t._stringRef=i,t)}if(typeof e!="string")throw Error(Ct(284));if(!r._owner)throw Error(Ct(290,e))}return e}function Up(e,t){throw e=Object.prototype.toString.call(t),Error(Ct(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function _j(e){var t=e._init;return t(e._payload)}function Z3(e){function t(m,g){if(e){var y=m.deletions;y===null?(m.deletions=[g],m.flags|=16):y.push(g)}}function r(m,g){if(!e)return null;for(;g!==null;)t(m,g),g=g.sibling;return null}function a(m,g){for(m=new Map;g!==null;)g.key!==null?m.set(g.key,g):m.set(g.index,g),g=g.sibling;return m}function s(m,g){return m=Uc(m,g),m.index=0,m.sibling=null,m}function i(m,g,y){return m.index=y,e?(y=m.alternate,y!==null?(y=y.index,y<g?(m.flags|=2,g):y):(m.flags|=2,g)):(m.flags|=1048576,g)}function o(m){return e&&m.alternate===null&&(m.flags|=2),m}function l(m,g,y,v){return g===null||g.tag!==6?(g=mv(y,m.mode,v),g.return=m,g):(g=s(g,y),g.return=m,g)}function c(m,g,y,v){var _=y.type;return _===Ju?u(m,g,y.props.children,v,y.key):g!==null&&(g.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===mc&&_j(_)===g.type)?(v=s(g,y.props),v.ref=Dh(m,g,y),v.return=m,v):(v=Zm(y.type,y.key,y.props,null,m.mode,v),v.ref=Dh(m,g,y),v.return=m,v)}function d(m,g,y,v){return g===null||g.tag!==4||g.stateNode.containerInfo!==y.containerInfo||g.stateNode.implementation!==y.implementation?(g=gv(y,m.mode,v),g.return=m,g):(g=s(g,y.children||[]),g.return=m,g)}function u(m,g,y,v,_){return g===null||g.tag!==7?(g=Pd(y,m.mode,v,_),g.return=m,g):(g=s(g,y),g.return=m,g)}function f(m,g,y){if(typeof g=="string"&&g!==""||typeof g=="number")return g=mv(""+g,m.mode,y),g.return=m,g;if(typeof g=="object"&&g!==null){switch(g.$$typeof){case Cp:return y=Zm(g.type,g.key,g.props,null,m.mode,y),y.ref=Dh(m,null,g),y.return=m,y;case Yu:return g=gv(g,m.mode,y),g.return=m,g;case mc:var v=g._init;return f(m,v(g._payload),y)}if(ef(g)||Bh(g))return g=Pd(g,m.mode,y,null),g.return=m,g;Up(m,g)}return null}function h(m,g,y,v){var _=g!==null?g.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return _!==null?null:l(m,g,""+y,v);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Cp:return y.key===_?c(m,g,y,v):null;case Yu:return y.key===_?d(m,g,y,v):null;case mc:return _=y._init,h(m,g,_(y._payload),v)}if(ef(y)||Bh(y))return _!==null?null:u(m,g,y,v,null);Up(m,y)}return null}function A(m,g,y,v,_){if(typeof v=="string"&&v!==""||typeof v=="number")return m=m.get(y)||null,l(g,m,""+v,_);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Cp:return m=m.get(v.key===null?y:v.key)||null,c(g,m,v,_);case Yu:return m=m.get(v.key===null?y:v.key)||null,d(g,m,v,_);case mc:var j=v._init;return A(m,g,y,j(v._payload),_)}if(ef(v)||Bh(v))return m=m.get(y)||null,u(g,m,v,_,null);Up(g,v)}return null}function x(m,g,y,v){for(var _=null,j=null,N=g,B=g=0,E=null;N!==null&&B<y.length;B++){N.index>B?(E=N,N=null):E=N.sibling;var C=h(m,N,y[B],v);if(C===null){N===null&&(N=E);break}e&&N&&C.alternate===null&&t(m,N),g=i(C,g,B),j===null?_=C:j.sibling=C,j=C,N=E}if(B===y.length)return r(m,N),wn&&yd(m,B),_;if(N===null){for(;B<y.length;B++)N=f(m,y[B],v),N!==null&&(g=i(N,g,B),j===null?_=N:j.sibling=N,j=N);return wn&&yd(m,B),_}for(N=a(m,N);B<y.length;B++)E=A(N,m,B,y[B],v),E!==null&&(e&&E.alternate!==null&&N.delete(E.key===null?B:E.key),g=i(E,g,B),j===null?_=E:j.sibling=E,j=E);return e&&N.forEach(function(k){return t(m,k)}),wn&&yd(m,B),_}function p(m,g,y,v){var _=Bh(y);if(typeof _!="function")throw Error(Ct(150));if(y=_.call(y),y==null)throw Error(Ct(151));for(var j=_=null,N=g,B=g=0,E=null,C=y.next();N!==null&&!C.done;B++,C=y.next()){N.index>B?(E=N,N=null):E=N.sibling;var k=h(m,N,C.value,v);if(k===null){N===null&&(N=E);break}e&&N&&k.alternate===null&&t(m,N),g=i(k,g,B),j===null?_=k:j.sibling=k,j=k,N=E}if(C.done)return r(m,N),wn&&yd(m,B),_;if(N===null){for(;!C.done;B++,C=y.next())C=f(m,C.value,v),C!==null&&(g=i(C,g,B),j===null?_=C:j.sibling=C,j=C);return wn&&yd(m,B),_}for(N=a(m,N);!C.done;B++,C=y.next())C=A(N,m,B,C.value,v),C!==null&&(e&&C.alternate!==null&&N.delete(C.key===null?B:C.key),g=i(C,g,B),j===null?_=C:j.sibling=C,j=C);return e&&N.forEach(function(w){return t(m,w)}),wn&&yd(m,B),_}function b(m,g,y,v){if(typeof y=="object"&&y!==null&&y.type===Ju&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case Cp:e:{for(var _=y.key,j=g;j!==null;){if(j.key===_){if(_=y.type,_===Ju){if(j.tag===7){r(m,j.sibling),g=s(j,y.props.children),g.return=m,m=g;break e}}else if(j.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===mc&&_j(_)===j.type){r(m,j.sibling),g=s(j,y.props),g.ref=Dh(m,j,y),g.return=m,m=g;break e}r(m,j);break}else t(m,j);j=j.sibling}y.type===Ju?(g=Pd(y.props.children,m.mode,v,y.key),g.return=m,m=g):(v=Zm(y.type,y.key,y.props,null,m.mode,v),v.ref=Dh(m,g,y),v.return=m,m=v)}return o(m);case Yu:e:{for(j=y.key;g!==null;){if(g.key===j)if(g.tag===4&&g.stateNode.containerInfo===y.containerInfo&&g.stateNode.implementation===y.implementation){r(m,g.sibling),g=s(g,y.children||[]),g.return=m,m=g;break e}else{r(m,g);break}else t(m,g);g=g.sibling}g=gv(y,m.mode,v),g.return=m,m=g}return o(m);case mc:return j=y._init,b(m,g,j(y._payload),v)}if(ef(y))return x(m,g,y,v);if(Bh(y))return p(m,g,y,v);Up(m,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,g!==null&&g.tag===6?(r(m,g.sibling),g=s(g,y),g.return=m,m=g):(r(m,g),g=mv(y,m.mode,v),g.return=m,m=g),o(m)):r(m,g)}return b}var IA=Z3(!0),eB=Z3(!1),jg=Yc(null),kg=null,iA=null,jw=null;function kw(){jw=iA=kg=null}function Cw(e){var t=jg.current;mn(jg),e._currentValue=t}function _b(e,t,r){for(;e!==null;){var a=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,a!==null&&(a.childLanes|=t)):a!==null&&(a.childLanes&t)!==t&&(a.childLanes|=t),e===r)break;e=e.return}}function gA(e,t){kg=e,jw=iA=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Qs=!0),e.firstContext=null)}function Hi(e){var t=e._currentValue;if(jw!==e)if(e={context:e,memoizedValue:t,next:null},iA===null){if(kg===null)throw Error(Ct(308));iA=e,kg.dependencies={lanes:0,firstContext:e}}else iA=iA.next=e;return t}var Ed=null;function Sw(e){Ed===null?Ed=[e]:Ed.push(e)}function tB(e,t,r,a){var s=t.interleaved;return s===null?(r.next=r,Sw(t)):(r.next=s.next,s.next=r),t.interleaved=r,Pl(e,a)}function Pl(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var gc=!1;function Bw(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function rB(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Bl(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Lc(e,t,r){var a=e.updateQueue;if(a===null)return null;if(a=a.shared,Ir&2){var s=a.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),a.pending=t,Pl(e,r)}return s=a.interleaved,s===null?(t.next=t,Sw(a)):(t.next=s.next,s.next=t),a.interleaved=t,Pl(e,r)}function Wm(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var a=t.lanes;a&=e.pendingLanes,r|=a,t.lanes=r,fw(e,r)}}function wj(e,t){var r=e.updateQueue,a=e.alternate;if(a!==null&&(a=a.updateQueue,r===a)){var s=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?s=i=o:i=i.next=o,r=r.next}while(r!==null);i===null?s=i=t:i=i.next=t}else s=i=t;r={baseState:a.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:a.shared,effects:a.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Cg(e,t,r,a){var s=e.updateQueue;gc=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,d=c.next;c.next=null,o===null?i=d:o.next=d,o=c;var u=e.alternate;u!==null&&(u=u.updateQueue,l=u.lastBaseUpdate,l!==o&&(l===null?u.firstBaseUpdate=d:l.next=d,u.lastBaseUpdate=c))}if(i!==null){var f=s.baseState;o=0,u=d=c=null,l=i;do{var h=l.lane,A=l.eventTime;if((a&h)===h){u!==null&&(u=u.next={eventTime:A,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var x=e,p=l;switch(h=t,A=r,p.tag){case 1:if(x=p.payload,typeof x=="function"){f=x.call(A,f,h);break e}f=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=p.payload,h=typeof x=="function"?x.call(A,f,h):x,h==null)break e;f=Bn({},f,h);break e;case 2:gc=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,h=s.effects,h===null?s.effects=[l]:h.push(l))}else A={eventTime:A,lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},u===null?(d=u=A,c=f):u=u.next=A,o|=h;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;h=l,l=h.next,h.next=null,s.lastBaseUpdate=h,s.shared.pending=null}}while(!0);if(u===null&&(c=f),s.baseState=c,s.firstBaseUpdate=d,s.lastBaseUpdate=u,t=s.shared.interleaved,t!==null){s=t;do o|=s.lane,s=s.next;while(s!==t)}else i===null&&(s.shared.lanes=0);Wd|=o,e.lanes=o,e.memoizedState=f}}function Nj(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var a=e[t],s=a.callback;if(s!==null){if(a.callback=null,a=r,typeof s!="function")throw Error(Ct(191,s));s.call(a)}}}var P0={},Ko=Yc(P0),Zf=Yc(P0),e0=Yc(P0);function Fd(e){if(e===P0)throw Error(Ct(174));return e}function Ew(e,t){switch(ln(e0,t),ln(Zf,e),ln(Ko,P0),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:rb(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=rb(t,e)}mn(Ko),ln(Ko,t)}function DA(){mn(Ko),mn(Zf),mn(e0)}function nB(e){Fd(e0.current);var t=Fd(Ko.current),r=rb(t,e.type);t!==r&&(ln(Zf,e),ln(Ko,r))}function Fw(e){Zf.current===e&&(mn(Ko),mn(Zf))}var jn=Yc(0);function Sg(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var dv=[];function Tw(){for(var e=0;e<dv.length;e++)dv[e]._workInProgressVersionPrimary=null;dv.length=0}var zm=Hl.ReactCurrentDispatcher,uv=Hl.ReactCurrentBatchConfig,Vd=0,Sn=null,ba=null,Ea=null,Bg=!1,bf=!1,t0=0,KL=0;function Ja(){throw Error(Ct(321))}function Iw(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!yo(e[r],t[r]))return!1;return!0}function Dw(e,t,r,a,s,i){if(Vd=i,Sn=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,zm.current=e===null||e.memoizedState===null?GL:XL,e=r(a,s),bf){i=0;do{if(bf=!1,t0=0,25<=i)throw Error(Ct(301));i+=1,Ea=ba=null,t.updateQueue=null,zm.current=YL,e=r(a,s)}while(bf)}if(zm.current=Eg,t=ba!==null&&ba.next!==null,Vd=0,Ea=ba=Sn=null,Bg=!1,t)throw Error(Ct(300));return e}function Lw(){var e=t0!==0;return t0=0,e}function Ro(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ea===null?Sn.memoizedState=Ea=e:Ea=Ea.next=e,Ea}function qi(){if(ba===null){var e=Sn.alternate;e=e!==null?e.memoizedState:null}else e=ba.next;var t=Ea===null?Sn.memoizedState:Ea.next;if(t!==null)Ea=t,ba=e;else{if(e===null)throw Error(Ct(310));ba=e,e={memoizedState:ba.memoizedState,baseState:ba.baseState,baseQueue:ba.baseQueue,queue:ba.queue,next:null},Ea===null?Sn.memoizedState=Ea=e:Ea=Ea.next=e}return Ea}function r0(e,t){return typeof t=="function"?t(e):t}function Av(e){var t=qi(),r=t.queue;if(r===null)throw Error(Ct(311));r.lastRenderedReducer=e;var a=ba,s=a.baseQueue,i=r.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}a.baseQueue=s=i,r.pending=null}if(s!==null){i=s.next,a=a.baseState;var l=o=null,c=null,d=i;do{var u=d.lane;if((Vd&u)===u)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),a=d.hasEagerState?d.eagerState:e(a,d.action);else{var f={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=f,o=a):c=c.next=f,Sn.lanes|=u,Wd|=u}d=d.next}while(d!==null&&d!==i);c===null?o=a:c.next=l,yo(a,t.memoizedState)||(Qs=!0),t.memoizedState=a,t.baseState=o,t.baseQueue=c,r.lastRenderedState=a}if(e=r.interleaved,e!==null){s=e;do i=s.lane,Sn.lanes|=i,Wd|=i,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function hv(e){var t=qi(),r=t.queue;if(r===null)throw Error(Ct(311));r.lastRenderedReducer=e;var a=r.dispatch,s=r.pending,i=t.memoizedState;if(s!==null){r.pending=null;var o=s=s.next;do i=e(i,o.action),o=o.next;while(o!==s);yo(i,t.memoizedState)||(Qs=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,a]}function aB(){}function sB(e,t){var r=Sn,a=qi(),s=t(),i=!yo(a.memoizedState,s);if(i&&(a.memoizedState=s,Qs=!0),a=a.queue,Pw(lB.bind(null,r,a,e),[e]),a.getSnapshot!==t||i||Ea!==null&&Ea.memoizedState.tag&1){if(r.flags|=2048,n0(9,oB.bind(null,r,a,s,t),void 0,null),Da===null)throw Error(Ct(349));Vd&30||iB(r,t,s)}return s}function iB(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Sn.updateQueue,t===null?(t={lastEffect:null,stores:null},Sn.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function oB(e,t,r,a){t.value=r,t.getSnapshot=a,cB(t)&&dB(e)}function lB(e,t,r){return r(function(){cB(t)&&dB(e)})}function cB(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!yo(e,r)}catch{return!0}}function dB(e){var t=Pl(e,1);t!==null&&mo(t,e,1,-1)}function jj(e){var t=Ro();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:r0,lastRenderedState:e},t.queue=e,e=e.dispatch=zL.bind(null,Sn,e),[t.memoizedState,e]}function n0(e,t,r,a){return e={tag:e,create:t,destroy:r,deps:a,next:null},t=Sn.updateQueue,t===null?(t={lastEffect:null,stores:null},Sn.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(a=r.next,r.next=e,e.next=a,t.lastEffect=e)),e}function uB(){return qi().memoizedState}function Gm(e,t,r,a){var s=Ro();Sn.flags|=e,s.memoizedState=n0(1|t,r,void 0,a===void 0?null:a)}function Sx(e,t,r,a){var s=qi();a=a===void 0?null:a;var i=void 0;if(ba!==null){var o=ba.memoizedState;if(i=o.destroy,a!==null&&Iw(a,o.deps)){s.memoizedState=n0(t,r,i,a);return}}Sn.flags|=e,s.memoizedState=n0(1|t,r,i,a)}function kj(e,t){return Gm(8390656,8,e,t)}function Pw(e,t){return Sx(2048,8,e,t)}function AB(e,t){return Sx(4,2,e,t)}function hB(e,t){return Sx(4,4,e,t)}function fB(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function pB(e,t,r){return r=r!=null?r.concat([e]):null,Sx(4,4,fB.bind(null,t,e),r)}function Ow(){}function mB(e,t){var r=qi();t=t===void 0?null:t;var a=r.memoizedState;return a!==null&&t!==null&&Iw(t,a[1])?a[0]:(r.memoizedState=[e,t],e)}function gB(e,t){var r=qi();t=t===void 0?null:t;var a=r.memoizedState;return a!==null&&t!==null&&Iw(t,a[1])?a[0]:(e=e(),r.memoizedState=[e,t],e)}function xB(e,t,r){return Vd&21?(yo(r,t)||(r=w3(),Sn.lanes|=r,Wd|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Qs=!0),e.memoizedState=r)}function VL(e,t){var r=Xr;Xr=r!==0&&4>r?r:4,e(!0);var a=uv.transition;uv.transition={};try{e(!1),t()}finally{Xr=r,uv.transition=a}}function yB(){return qi().memoizedState}function WL(e,t,r){var a=Oc(e);if(r={lane:a,action:r,hasEagerState:!1,eagerState:null,next:null},vB(e))bB(t,r);else if(r=tB(e,t,r,a),r!==null){var s=Bs();mo(r,e,a,s),_B(r,t,a)}}function zL(e,t,r){var a=Oc(e),s={lane:a,action:r,hasEagerState:!1,eagerState:null,next:null};if(vB(e))bB(t,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var o=t.lastRenderedState,l=i(o,r);if(s.hasEagerState=!0,s.eagerState=l,yo(l,o)){var c=t.interleaved;c===null?(s.next=s,Sw(t)):(s.next=c.next,c.next=s),t.interleaved=s;return}}catch{}finally{}r=tB(e,t,s,a),r!==null&&(s=Bs(),mo(r,e,a,s),_B(r,t,a))}}function vB(e){var t=e.alternate;return e===Sn||t!==null&&t===Sn}function bB(e,t){bf=Bg=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function _B(e,t,r){if(r&4194240){var a=t.lanes;a&=e.pendingLanes,r|=a,t.lanes=r,fw(e,r)}}var Eg={readContext:Hi,useCallback:Ja,useContext:Ja,useEffect:Ja,useImperativeHandle:Ja,useInsertionEffect:Ja,useLayoutEffect:Ja,useMemo:Ja,useReducer:Ja,useRef:Ja,useState:Ja,useDebugValue:Ja,useDeferredValue:Ja,useTransition:Ja,useMutableSource:Ja,useSyncExternalStore:Ja,useId:Ja,unstable_isNewReconciler:!1},GL={readContext:Hi,useCallback:function(e,t){return Ro().memoizedState=[e,t===void 0?null:t],e},useContext:Hi,useEffect:kj,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Gm(4194308,4,fB.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Gm(4194308,4,e,t)},useInsertionEffect:function(e,t){return Gm(4,2,e,t)},useMemo:function(e,t){var r=Ro();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var a=Ro();return t=r!==void 0?r(t):t,a.memoizedState=a.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},a.queue=e,e=e.dispatch=WL.bind(null,Sn,e),[a.memoizedState,e]},useRef:function(e){var t=Ro();return e={current:e},t.memoizedState=e},useState:jj,useDebugValue:Ow,useDeferredValue:function(e){return Ro().memoizedState=e},useTransition:function(){var e=jj(!1),t=e[0];return e=VL.bind(null,e[1]),Ro().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var a=Sn,s=Ro();if(wn){if(r===void 0)throw Error(Ct(407));r=r()}else{if(r=t(),Da===null)throw Error(Ct(349));Vd&30||iB(a,t,r)}s.memoizedState=r;var i={value:r,getSnapshot:t};return s.queue=i,kj(lB.bind(null,a,i,e),[e]),a.flags|=2048,n0(9,oB.bind(null,a,i,r,t),void 0,null),r},useId:function(){var e=Ro(),t=Da.identifierPrefix;if(wn){var r=Cl,a=kl;r=(a&~(1<<32-po(a)-1)).toString(32)+r,t=":"+t+"R"+r,r=t0++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=KL++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},XL={readContext:Hi,useCallback:mB,useContext:Hi,useEffect:Pw,useImperativeHandle:pB,useInsertionEffect:AB,useLayoutEffect:hB,useMemo:gB,useReducer:Av,useRef:uB,useState:function(){return Av(r0)},useDebugValue:Ow,useDeferredValue:function(e){var t=qi();return xB(t,ba.memoizedState,e)},useTransition:function(){var e=Av(r0)[0],t=qi().memoizedState;return[e,t]},useMutableSource:aB,useSyncExternalStore:sB,useId:yB,unstable_isNewReconciler:!1},YL={readContext:Hi,useCallback:mB,useContext:Hi,useEffect:Pw,useImperativeHandle:pB,useInsertionEffect:AB,useLayoutEffect:hB,useMemo:gB,useReducer:hv,useRef:uB,useState:function(){return hv(r0)},useDebugValue:Ow,useDeferredValue:function(e){var t=qi();return ba===null?t.memoizedState=e:xB(t,ba.memoizedState,e)},useTransition:function(){var e=hv(r0)[0],t=qi().memoizedState;return[e,t]},useMutableSource:aB,useSyncExternalStore:sB,useId:yB,unstable_isNewReconciler:!1};function io(e,t){if(e&&e.defaultProps){t=Bn({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function wb(e,t,r,a){t=e.memoizedState,r=r(a,t),r=r==null?t:Bn({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Bx={isMounted:function(e){return(e=e._reactInternals)?su(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var a=Bs(),s=Oc(e),i=Bl(a,s);i.payload=t,r!=null&&(i.callback=r),t=Lc(e,i,s),t!==null&&(mo(t,e,s,a),Wm(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var a=Bs(),s=Oc(e),i=Bl(a,s);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=Lc(e,i,s),t!==null&&(mo(t,e,s,a),Wm(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Bs(),a=Oc(e),s=Bl(r,a);s.tag=2,t!=null&&(s.callback=t),t=Lc(e,s,a),t!==null&&(mo(t,e,a,r),Wm(t,e,a))}};function Cj(e,t,r,a,s,i,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(a,i,o):t.prototype&&t.prototype.isPureReactComponent?!Gf(r,a)||!Gf(s,i):!0}function wB(e,t,r){var a=!1,s=qc,i=t.contextType;return typeof i=="object"&&i!==null?i=Hi(i):(s=$s(t)?$d:fs.current,a=t.contextTypes,i=(a=a!=null)?FA(e,s):qc),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Bx,e.stateNode=t,t._reactInternals=e,a&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function Sj(e,t,r,a){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,a),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,a),t.state!==e&&Bx.enqueueReplaceState(t,t.state,null)}function Nb(e,t,r,a){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},Bw(e);var i=t.contextType;typeof i=="object"&&i!==null?s.context=Hi(i):(i=$s(t)?$d:fs.current,s.context=FA(e,i)),s.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(wb(e,t,i,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&Bx.enqueueReplaceState(s,s.state,null),Cg(e,r,s,a),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function LA(e,t){try{var r="",a=t;do r+=j8(a),a=a.return;while(a);var s=r}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:s,digest:null}}function fv(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function jb(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var JL=typeof WeakMap=="function"?WeakMap:Map;function NB(e,t,r){r=Bl(-1,r),r.tag=3,r.payload={element:null};var a=t.value;return r.callback=function(){Tg||(Tg=!0,Lb=a),jb(e,t)},r}function jB(e,t,r){r=Bl(-1,r),r.tag=3;var a=e.type.getDerivedStateFromError;if(typeof a=="function"){var s=t.value;r.payload=function(){return a(s)},r.callback=function(){jb(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){jb(e,t),typeof a!="function"&&(Pc===null?Pc=new Set([this]):Pc.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function Bj(e,t,r){var a=e.pingCache;if(a===null){a=e.pingCache=new JL;var s=new Set;a.set(t,s)}else s=a.get(t),s===void 0&&(s=new Set,a.set(t,s));s.has(r)||(s.add(r),e=AP.bind(null,e,t,r),t.then(e,e))}function Ej(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Fj(e,t,r,a,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Bl(-1,1),t.tag=2,Lc(r,t,1))),r.lanes|=1),e)}var ZL=Hl.ReactCurrentOwner,Qs=!1;function Ns(e,t,r,a){t.child=e===null?eB(t,null,r,a):IA(t,e.child,r,a)}function Tj(e,t,r,a,s){r=r.render;var i=t.ref;return gA(t,s),a=Dw(e,t,r,a,i,s),r=Lw(),e!==null&&!Qs?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Ol(e,t,s)):(wn&&r&&_w(t),t.flags|=1,Ns(e,t,a,s),t.child)}function Ij(e,t,r,a,s){if(e===null){var i=r.type;return typeof i=="function"&&!Kw(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,kB(e,t,i,a,s)):(e=Zm(r.type,null,a,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&s)){var o=i.memoizedProps;if(r=r.compare,r=r!==null?r:Gf,r(o,a)&&e.ref===t.ref)return Ol(e,t,s)}return t.flags|=1,e=Uc(i,a),e.ref=t.ref,e.return=t,t.child=e}function kB(e,t,r,a,s){if(e!==null){var i=e.memoizedProps;if(Gf(i,a)&&e.ref===t.ref)if(Qs=!1,t.pendingProps=a=i,(e.lanes&s)!==0)e.flags&131072&&(Qs=!0);else return t.lanes=e.lanes,Ol(e,t,s)}return kb(e,t,r,a,s)}function CB(e,t,r){var a=t.pendingProps,s=a.children,i=e!==null?e.memoizedState:null;if(a.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},ln(lA,oi),oi|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,ln(lA,oi),oi|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},a=i!==null?i.baseLanes:r,ln(lA,oi),oi|=a}else i!==null?(a=i.baseLanes|r,t.memoizedState=null):a=r,ln(lA,oi),oi|=a;return Ns(e,t,s,r),t.child}function SB(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function kb(e,t,r,a,s){var i=$s(r)?$d:fs.current;return i=FA(t,i),gA(t,s),r=Dw(e,t,r,a,i,s),a=Lw(),e!==null&&!Qs?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Ol(e,t,s)):(wn&&a&&_w(t),t.flags|=1,Ns(e,t,r,s),t.child)}function Dj(e,t,r,a,s){if($s(r)){var i=!0;_g(t)}else i=!1;if(gA(t,s),t.stateNode===null)Xm(e,t),wB(t,r,a),Nb(t,r,a,s),a=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var c=o.context,d=r.contextType;typeof d=="object"&&d!==null?d=Hi(d):(d=$s(r)?$d:fs.current,d=FA(t,d));var u=r.getDerivedStateFromProps,f=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==a||c!==d)&&Sj(t,o,a,d),gc=!1;var h=t.memoizedState;o.state=h,Cg(t,a,o,s),c=t.memoizedState,l!==a||h!==c||qs.current||gc?(typeof u=="function"&&(wb(t,r,u,a),c=t.memoizedState),(l=gc||Cj(t,r,l,a,h,c,d))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=a,t.memoizedState=c),o.props=a,o.state=c,o.context=d,a=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),a=!1)}else{o=t.stateNode,rB(e,t),l=t.memoizedProps,d=t.type===t.elementType?l:io(t.type,l),o.props=d,f=t.pendingProps,h=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=Hi(c):(c=$s(r)?$d:fs.current,c=FA(t,c));var A=r.getDerivedStateFromProps;(u=typeof A=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==f||h!==c)&&Sj(t,o,a,c),gc=!1,h=t.memoizedState,o.state=h,Cg(t,a,o,s);var x=t.memoizedState;l!==f||h!==x||qs.current||gc?(typeof A=="function"&&(wb(t,r,A,a),x=t.memoizedState),(d=gc||Cj(t,r,d,a,h,x,c)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(a,x,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(a,x,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=a,t.memoizedState=x),o.props=a,o.state=x,o.context=c,a=d):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),a=!1)}return Cb(e,t,r,a,i,s)}function Cb(e,t,r,a,s,i){SB(e,t);var o=(t.flags&128)!==0;if(!a&&!o)return s&&yj(t,r,!1),Ol(e,t,i);a=t.stateNode,ZL.current=t;var l=o&&typeof r.getDerivedStateFromError!="function"?null:a.render();return t.flags|=1,e!==null&&o?(t.child=IA(t,e.child,null,i),t.child=IA(t,null,l,i)):Ns(e,t,l,i),t.memoizedState=a.state,s&&yj(t,r,!0),t.child}function BB(e){var t=e.stateNode;t.pendingContext?xj(e,t.pendingContext,t.pendingContext!==t.context):t.context&&xj(e,t.context,!1),Ew(e,t.containerInfo)}function Lj(e,t,r,a,s){return TA(),Nw(s),t.flags|=256,Ns(e,t,r,a),t.child}var Sb={dehydrated:null,treeContext:null,retryLane:0};function Bb(e){return{baseLanes:e,cachePool:null,transitions:null}}function EB(e,t,r){var a=t.pendingProps,s=jn.current,i=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(s&2)!==0),l?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),ln(jn,s&1),e===null)return bb(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=a.children,e=a.fallback,i?(a=t.mode,i=t.child,o={mode:"hidden",children:o},!(a&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Tx(o,a,0,null),e=Pd(e,a,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Bb(r),t.memoizedState=Sb,e):Uw(t,o));if(s=e.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return eP(e,t,o,a,l,s,r);if(i){i=a.fallback,o=t.mode,s=e.child,l=s.sibling;var c={mode:"hidden",children:a.children};return!(o&1)&&t.child!==s?(a=t.child,a.childLanes=0,a.pendingProps=c,t.deletions=null):(a=Uc(s,c),a.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=Uc(l,i):(i=Pd(i,o,r,null),i.flags|=2),i.return=t,a.return=t,a.sibling=i,t.child=a,a=i,i=t.child,o=e.child.memoizedState,o=o===null?Bb(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=e.childLanes&~r,t.memoizedState=Sb,a}return i=e.child,e=i.sibling,a=Uc(i,{mode:"visible",children:a.children}),!(t.mode&1)&&(a.lanes=r),a.return=t,a.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=a,t.memoizedState=null,a}function Uw(e,t){return t=Tx({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Rp(e,t,r,a){return a!==null&&Nw(a),IA(t,e.child,null,r),e=Uw(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function eP(e,t,r,a,s,i,o){if(r)return t.flags&256?(t.flags&=-257,a=fv(Error(Ct(422))),Rp(e,t,o,a)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=a.fallback,s=t.mode,a=Tx({mode:"visible",children:a.children},s,0,null),i=Pd(i,s,o,null),i.flags|=2,a.return=t,i.return=t,a.sibling=i,t.child=a,t.mode&1&&IA(t,e.child,null,o),t.child.memoizedState=Bb(o),t.memoizedState=Sb,i);if(!(t.mode&1))return Rp(e,t,o,null);if(s.data==="$!"){if(a=s.nextSibling&&s.nextSibling.dataset,a)var l=a.dgst;return a=l,i=Error(Ct(419)),a=fv(i,a,void 0),Rp(e,t,o,a)}if(l=(o&e.childLanes)!==0,Qs||l){if(a=Da,a!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(a.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Pl(e,s),mo(a,e,s,-1))}return $w(),a=fv(Error(Ct(421))),Rp(e,t,o,a)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=hP.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,fi=Dc(s.nextSibling),mi=t,wn=!0,uo=null,e!==null&&(Di[Li++]=kl,Di[Li++]=Cl,Di[Li++]=Kd,kl=e.id,Cl=e.overflow,Kd=t),t=Uw(t,a.children),t.flags|=4096,t)}function Pj(e,t,r){e.lanes|=t;var a=e.alternate;a!==null&&(a.lanes|=t),_b(e.return,t,r)}function pv(e,t,r,a,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:a,tail:r,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=a,i.tail=r,i.tailMode=s)}function FB(e,t,r){var a=t.pendingProps,s=a.revealOrder,i=a.tail;if(Ns(e,t,a.children,r),a=jn.current,a&2)a=a&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Pj(e,r,t);else if(e.tag===19)Pj(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}a&=1}if(ln(jn,a),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&Sg(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),pv(t,!1,s,r,i);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&Sg(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}pv(t,!0,r,null,i);break;case"together":pv(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Xm(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ol(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Wd|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Ct(153));if(t.child!==null){for(e=t.child,r=Uc(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Uc(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function tP(e,t,r){switch(t.tag){case 3:BB(t),TA();break;case 5:nB(t);break;case 1:$s(t.type)&&_g(t);break;case 4:Ew(t,t.stateNode.containerInfo);break;case 10:var a=t.type._context,s=t.memoizedProps.value;ln(jg,a._currentValue),a._currentValue=s;break;case 13:if(a=t.memoizedState,a!==null)return a.dehydrated!==null?(ln(jn,jn.current&1),t.flags|=128,null):r&t.child.childLanes?EB(e,t,r):(ln(jn,jn.current&1),e=Ol(e,t,r),e!==null?e.sibling:null);ln(jn,jn.current&1);break;case 19:if(a=(r&t.childLanes)!==0,e.flags&128){if(a)return FB(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),ln(jn,jn.current),a)break;return null;case 22:case 23:return t.lanes=0,CB(e,t,r)}return Ol(e,t,r)}var TB,Eb,IB,DB;TB=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Eb=function(){};IB=function(e,t,r,a){var s=e.memoizedProps;if(s!==a){e=t.stateNode,Fd(Ko.current);var i=null;switch(r){case"input":s=J1(e,s),a=J1(e,a),i=[];break;case"select":s=Bn({},s,{value:void 0}),a=Bn({},a,{value:void 0}),i=[];break;case"textarea":s=tb(e,s),a=tb(e,a),i=[];break;default:typeof s.onClick!="function"&&typeof a.onClick=="function"&&(e.onclick=vg)}nb(r,a);var o;r=null;for(d in s)if(!a.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var l=s[d];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Hf.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in a){var c=a[d];if(l=s!=null?s[d]:void 0,a.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(i||(i=[]),i.push(d,r)),r=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Hf.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&un("scroll",e),i||l===c||(i=[])):(i=i||[]).push(d,c))}r&&(i=i||[]).push("style",r);var d=i;(t.updateQueue=d)&&(t.flags|=4)}};DB=function(e,t,r,a){r!==a&&(t.flags|=4)};function Lh(e,t){if(!wn)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var a=null;r!==null;)r.alternate!==null&&(a=r),r=r.sibling;a===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:a.sibling=null}}function Za(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,a=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,a|=s.subtreeFlags&14680064,a|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,a|=s.subtreeFlags,a|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=a,e.childLanes=r,t}function rP(e,t,r){var a=t.pendingProps;switch(ww(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Za(t),null;case 1:return $s(t.type)&&bg(),Za(t),null;case 3:return a=t.stateNode,DA(),mn(qs),mn(fs),Tw(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(e===null||e.child===null)&&(Op(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,uo!==null&&(Ub(uo),uo=null))),Eb(e,t),Za(t),null;case 5:Fw(t);var s=Fd(e0.current);if(r=t.type,e!==null&&t.stateNode!=null)IB(e,t,r,a,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!a){if(t.stateNode===null)throw Error(Ct(166));return Za(t),null}if(e=Fd(Ko.current),Op(t)){a=t.stateNode,r=t.type;var i=t.memoizedProps;switch(a[Mo]=t,a[Jf]=i,e=(t.mode&1)!==0,r){case"dialog":un("cancel",a),un("close",a);break;case"iframe":case"object":case"embed":un("load",a);break;case"video":case"audio":for(s=0;s<rf.length;s++)un(rf[s],a);break;case"source":un("error",a);break;case"img":case"image":case"link":un("error",a),un("load",a);break;case"details":un("toggle",a);break;case"input":KN(a,i),un("invalid",a);break;case"select":a._wrapperState={wasMultiple:!!i.multiple},un("invalid",a);break;case"textarea":WN(a,i),un("invalid",a)}nb(r,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?a.textContent!==l&&(i.suppressHydrationWarning!==!0&&Pp(a.textContent,l,e),s=["children",l]):typeof l=="number"&&a.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Pp(a.textContent,l,e),s=["children",""+l]):Hf.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&un("scroll",a)}switch(r){case"input":Sp(a),VN(a,i,!0);break;case"textarea":Sp(a),zN(a);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(a.onclick=vg)}a=s,t.updateQueue=a,a!==null&&(t.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=l3(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof a.is=="string"?e=o.createElement(r,{is:a.is}):(e=o.createElement(r),r==="select"&&(o=e,a.multiple?o.multiple=!0:a.size&&(o.size=a.size))):e=o.createElementNS(e,r),e[Mo]=t,e[Jf]=a,TB(e,t,!1,!1),t.stateNode=e;e:{switch(o=ab(r,a),r){case"dialog":un("cancel",e),un("close",e),s=a;break;case"iframe":case"object":case"embed":un("load",e),s=a;break;case"video":case"audio":for(s=0;s<rf.length;s++)un(rf[s],e);s=a;break;case"source":un("error",e),s=a;break;case"img":case"image":case"link":un("error",e),un("load",e),s=a;break;case"details":un("toggle",e),s=a;break;case"input":KN(e,a),s=J1(e,a),un("invalid",e);break;case"option":s=a;break;case"select":e._wrapperState={wasMultiple:!!a.multiple},s=Bn({},a,{value:void 0}),un("invalid",e);break;case"textarea":WN(e,a),s=tb(e,a),un("invalid",e);break;default:s=a}nb(r,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?u3(e,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&c3(e,c)):i==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&qf(e,c):typeof c=="number"&&qf(e,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Hf.hasOwnProperty(i)?c!=null&&i==="onScroll"&&un("scroll",e):c!=null&&lw(e,i,c,o))}switch(r){case"input":Sp(e),VN(e,a,!1);break;case"textarea":Sp(e),zN(e);break;case"option":a.value!=null&&e.setAttribute("value",""+Hc(a.value));break;case"select":e.multiple=!!a.multiple,i=a.value,i!=null?hA(e,!!a.multiple,i,!1):a.defaultValue!=null&&hA(e,!!a.multiple,a.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=vg)}switch(r){case"button":case"input":case"select":case"textarea":a=!!a.autoFocus;break e;case"img":a=!0;break e;default:a=!1}}a&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Za(t),null;case 6:if(e&&t.stateNode!=null)DB(e,t,e.memoizedProps,a);else{if(typeof a!="string"&&t.stateNode===null)throw Error(Ct(166));if(r=Fd(e0.current),Fd(Ko.current),Op(t)){if(a=t.stateNode,r=t.memoizedProps,a[Mo]=t,(i=a.nodeValue!==r)&&(e=mi,e!==null))switch(e.tag){case 3:Pp(a.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Pp(a.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else a=(r.nodeType===9?r:r.ownerDocument).createTextNode(a),a[Mo]=t,t.stateNode=a}return Za(t),null;case 13:if(mn(jn),a=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(wn&&fi!==null&&t.mode&1&&!(t.flags&128))J3(),TA(),t.flags|=98560,i=!1;else if(i=Op(t),a!==null&&a.dehydrated!==null){if(e===null){if(!i)throw Error(Ct(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Ct(317));i[Mo]=t}else TA(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Za(t),i=!1}else uo!==null&&(Ub(uo),uo=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(a=a!==null,a!==(e!==null&&e.memoizedState!==null)&&a&&(t.child.flags|=8192,t.mode&1&&(e===null||jn.current&1?Na===0&&(Na=3):$w())),t.updateQueue!==null&&(t.flags|=4),Za(t),null);case 4:return DA(),Eb(e,t),e===null&&Xf(t.stateNode.containerInfo),Za(t),null;case 10:return Cw(t.type._context),Za(t),null;case 17:return $s(t.type)&&bg(),Za(t),null;case 19:if(mn(jn),i=t.memoizedState,i===null)return Za(t),null;if(a=(t.flags&128)!==0,o=i.rendering,o===null)if(a)Lh(i,!1);else{if(Na!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=Sg(e),o!==null){for(t.flags|=128,Lh(i,!1),a=o.updateQueue,a!==null&&(t.updateQueue=a,t.flags|=4),t.subtreeFlags=0,a=r,r=t.child;r!==null;)i=r,e=a,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,e=o.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return ln(jn,jn.current&1|2),t.child}e=e.sibling}i.tail!==null&&zn()>PA&&(t.flags|=128,a=!0,Lh(i,!1),t.lanes=4194304)}else{if(!a)if(e=Sg(o),e!==null){if(t.flags|=128,a=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Lh(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!wn)return Za(t),null}else 2*zn()-i.renderingStartTime>PA&&r!==1073741824&&(t.flags|=128,a=!0,Lh(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(r=i.last,r!==null?r.sibling=o:t.child=o,i.last=o)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=zn(),t.sibling=null,r=jn.current,ln(jn,a?r&1|2:r&1),t):(Za(t),null);case 22:case 23:return qw(),a=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==a&&(t.flags|=8192),a&&t.mode&1?oi&1073741824&&(Za(t),t.subtreeFlags&6&&(t.flags|=8192)):Za(t),null;case 24:return null;case 25:return null}throw Error(Ct(156,t.tag))}function nP(e,t){switch(ww(t),t.tag){case 1:return $s(t.type)&&bg(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return DA(),mn(qs),mn(fs),Tw(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Fw(t),null;case 13:if(mn(jn),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Ct(340));TA()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return mn(jn),null;case 4:return DA(),null;case 10:return Cw(t.type._context),null;case 22:case 23:return qw(),null;case 24:return null;default:return null}}var Mp=!1,cs=!1,aP=typeof WeakSet=="function"?WeakSet:Set,Rt=null;function oA(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(a){Pn(e,t,a)}else r.current=null}function Fb(e,t,r){try{r()}catch(a){Pn(e,t,a)}}var Oj=!1;function sP(e,t){if(fb=gg,e=R3(),bw(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var a=r.getSelection&&r.getSelection();if(a&&a.rangeCount!==0){r=a.anchorNode;var s=a.anchorOffset,i=a.focusNode;a=a.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var o=0,l=-1,c=-1,d=0,u=0,f=e,h=null;t:for(;;){for(var A;f!==r||s!==0&&f.nodeType!==3||(l=o+s),f!==i||a!==0&&f.nodeType!==3||(c=o+a),f.nodeType===3&&(o+=f.nodeValue.length),(A=f.firstChild)!==null;)h=f,f=A;for(;;){if(f===e)break t;if(h===r&&++d===s&&(l=o),h===i&&++u===a&&(c=o),(A=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=A}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(pb={focusedElem:e,selectionRange:r},gg=!1,Rt=t;Rt!==null;)if(t=Rt,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Rt=e;else for(;Rt!==null;){t=Rt;try{var x=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var p=x.memoizedProps,b=x.memoizedState,m=t.stateNode,g=m.getSnapshotBeforeUpdate(t.elementType===t.type?p:io(t.type,p),b);m.__reactInternalSnapshotBeforeUpdate=g}break;case 3:var y=t.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ct(163))}}catch(v){Pn(t,t.return,v)}if(e=t.sibling,e!==null){e.return=t.return,Rt=e;break}Rt=t.return}return x=Oj,Oj=!1,x}function _f(e,t,r){var a=t.updateQueue;if(a=a!==null?a.lastEffect:null,a!==null){var s=a=a.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&Fb(t,r,i)}s=s.next}while(s!==a)}}function Ex(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var a=r.create;r.destroy=a()}r=r.next}while(r!==t)}}function Tb(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function LB(e){var t=e.alternate;t!==null&&(e.alternate=null,LB(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Mo],delete t[Jf],delete t[xb],delete t[QL],delete t[HL])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function PB(e){return e.tag===5||e.tag===3||e.tag===4}function Uj(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||PB(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Ib(e,t,r){var a=e.tag;if(a===5||a===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=vg));else if(a!==4&&(e=e.child,e!==null))for(Ib(e,t,r),e=e.sibling;e!==null;)Ib(e,t,r),e=e.sibling}function Db(e,t,r){var a=e.tag;if(a===5||a===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(a!==4&&(e=e.child,e!==null))for(Db(e,t,r),e=e.sibling;e!==null;)Db(e,t,r),e=e.sibling}var qa=null,lo=!1;function dc(e,t,r){for(r=r.child;r!==null;)OB(e,t,r),r=r.sibling}function OB(e,t,r){if($o&&typeof $o.onCommitFiberUnmount=="function")try{$o.onCommitFiberUnmount(_x,r)}catch{}switch(r.tag){case 5:cs||oA(r,t);case 6:var a=qa,s=lo;qa=null,dc(e,t,r),qa=a,lo=s,qa!==null&&(lo?(e=qa,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):qa.removeChild(r.stateNode));break;case 18:qa!==null&&(lo?(e=qa,r=r.stateNode,e.nodeType===8?lv(e.parentNode,r):e.nodeType===1&&lv(e,r),Wf(e)):lv(qa,r.stateNode));break;case 4:a=qa,s=lo,qa=r.stateNode.containerInfo,lo=!0,dc(e,t,r),qa=a,lo=s;break;case 0:case 11:case 14:case 15:if(!cs&&(a=r.updateQueue,a!==null&&(a=a.lastEffect,a!==null))){s=a=a.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Fb(r,t,o),s=s.next}while(s!==a)}dc(e,t,r);break;case 1:if(!cs&&(oA(r,t),a=r.stateNode,typeof a.componentWillUnmount=="function"))try{a.props=r.memoizedProps,a.state=r.memoizedState,a.componentWillUnmount()}catch(l){Pn(r,t,l)}dc(e,t,r);break;case 21:dc(e,t,r);break;case 22:r.mode&1?(cs=(a=cs)||r.memoizedState!==null,dc(e,t,r),cs=a):dc(e,t,r);break;default:dc(e,t,r)}}function Rj(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new aP),t.forEach(function(a){var s=fP.bind(null,e,a);r.has(a)||(r.add(a),a.then(s,s))})}}function eo(e,t){var r=t.deletions;if(r!==null)for(var a=0;a<r.length;a++){var s=r[a];try{var i=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:qa=l.stateNode,lo=!1;break e;case 3:qa=l.stateNode.containerInfo,lo=!0;break e;case 4:qa=l.stateNode.containerInfo,lo=!0;break e}l=l.return}if(qa===null)throw Error(Ct(160));OB(i,o,s),qa=null,lo=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(d){Pn(s,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)UB(t,e),t=t.sibling}function UB(e,t){var r=e.alternate,a=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(eo(t,e),Eo(e),a&4){try{_f(3,e,e.return),Ex(3,e)}catch(p){Pn(e,e.return,p)}try{_f(5,e,e.return)}catch(p){Pn(e,e.return,p)}}break;case 1:eo(t,e),Eo(e),a&512&&r!==null&&oA(r,r.return);break;case 5:if(eo(t,e),Eo(e),a&512&&r!==null&&oA(r,r.return),e.flags&32){var s=e.stateNode;try{qf(s,"")}catch(p){Pn(e,e.return,p)}}if(a&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,o=r!==null?r.memoizedProps:i,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&i3(s,i),ab(l,o);var d=ab(l,i);for(o=0;o<c.length;o+=2){var u=c[o],f=c[o+1];u==="style"?u3(s,f):u==="dangerouslySetInnerHTML"?c3(s,f):u==="children"?qf(s,f):lw(s,u,f,d)}switch(l){case"input":Z1(s,i);break;case"textarea":o3(s,i);break;case"select":var h=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var A=i.value;A!=null?hA(s,!!i.multiple,A,!1):h!==!!i.multiple&&(i.defaultValue!=null?hA(s,!!i.multiple,i.defaultValue,!0):hA(s,!!i.multiple,i.multiple?[]:"",!1))}s[Jf]=i}catch(p){Pn(e,e.return,p)}}break;case 6:if(eo(t,e),Eo(e),a&4){if(e.stateNode===null)throw Error(Ct(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(p){Pn(e,e.return,p)}}break;case 3:if(eo(t,e),Eo(e),a&4&&r!==null&&r.memoizedState.isDehydrated)try{Wf(t.containerInfo)}catch(p){Pn(e,e.return,p)}break;case 4:eo(t,e),Eo(e);break;case 13:eo(t,e),Eo(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Qw=zn())),a&4&&Rj(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(cs=(d=cs)||u,eo(t,e),cs=d):eo(t,e),Eo(e),a&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!u&&e.mode&1)for(Rt=e,u=e.child;u!==null;){for(f=Rt=u;Rt!==null;){switch(h=Rt,A=h.child,h.tag){case 0:case 11:case 14:case 15:_f(4,h,h.return);break;case 1:oA(h,h.return);var x=h.stateNode;if(typeof x.componentWillUnmount=="function"){a=h,r=h.return;try{t=a,x.props=t.memoizedProps,x.state=t.memoizedState,x.componentWillUnmount()}catch(p){Pn(a,r,p)}}break;case 5:oA(h,h.return);break;case 22:if(h.memoizedState!==null){Qj(f);continue}}A!==null?(A.return=h,Rt=A):Qj(f)}u=u.sibling}e:for(u=null,f=e;;){if(f.tag===5){if(u===null){u=f;try{s=f.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=f.stateNode,c=f.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=d3("display",o))}catch(p){Pn(e,e.return,p)}}}else if(f.tag===6){if(u===null)try{f.stateNode.nodeValue=d?"":f.memoizedProps}catch(p){Pn(e,e.return,p)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;u===f&&(u=null),f=f.return}u===f&&(u=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:eo(t,e),Eo(e),a&4&&Rj(e);break;case 21:break;default:eo(t,e),Eo(e)}}function Eo(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(PB(r)){var a=r;break e}r=r.return}throw Error(Ct(160))}switch(a.tag){case 5:var s=a.stateNode;a.flags&32&&(qf(s,""),a.flags&=-33);var i=Uj(e);Db(e,i,s);break;case 3:case 4:var o=a.stateNode.containerInfo,l=Uj(e);Ib(e,l,o);break;default:throw Error(Ct(161))}}catch(c){Pn(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function iP(e,t,r){Rt=e,RB(e)}function RB(e,t,r){for(var a=(e.mode&1)!==0;Rt!==null;){var s=Rt,i=s.child;if(s.tag===22&&a){var o=s.memoizedState!==null||Mp;if(!o){var l=s.alternate,c=l!==null&&l.memoizedState!==null||cs;l=Mp;var d=cs;if(Mp=o,(cs=c)&&!d)for(Rt=s;Rt!==null;)o=Rt,c=o.child,o.tag===22&&o.memoizedState!==null?Hj(s):c!==null?(c.return=o,Rt=c):Hj(s);for(;i!==null;)Rt=i,RB(i),i=i.sibling;Rt=s,Mp=l,cs=d}Mj(e)}else s.subtreeFlags&8772&&i!==null?(i.return=s,Rt=i):Mj(e)}}function Mj(e){for(;Rt!==null;){var t=Rt;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:cs||Ex(5,t);break;case 1:var a=t.stateNode;if(t.flags&4&&!cs)if(r===null)a.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:io(t.type,r.memoizedProps);a.componentDidUpdate(s,r.memoizedState,a.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&Nj(t,i,a);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Nj(t,o,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var u=d.memoizedState;if(u!==null){var f=u.dehydrated;f!==null&&Wf(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ct(163))}cs||t.flags&512&&Tb(t)}catch(h){Pn(t,t.return,h)}}if(t===e){Rt=null;break}if(r=t.sibling,r!==null){r.return=t.return,Rt=r;break}Rt=t.return}}function Qj(e){for(;Rt!==null;){var t=Rt;if(t===e){Rt=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Rt=r;break}Rt=t.return}}function Hj(e){for(;Rt!==null;){var t=Rt;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Ex(4,t)}catch(c){Pn(t,r,c)}break;case 1:var a=t.stateNode;if(typeof a.componentDidMount=="function"){var s=t.return;try{a.componentDidMount()}catch(c){Pn(t,s,c)}}var i=t.return;try{Tb(t)}catch(c){Pn(t,i,c)}break;case 5:var o=t.return;try{Tb(t)}catch(c){Pn(t,o,c)}}}catch(c){Pn(t,t.return,c)}if(t===e){Rt=null;break}var l=t.sibling;if(l!==null){l.return=t.return,Rt=l;break}Rt=t.return}}var oP=Math.ceil,Fg=Hl.ReactCurrentDispatcher,Rw=Hl.ReactCurrentOwner,Mi=Hl.ReactCurrentBatchConfig,Ir=0,Da=null,ca=null,za=0,oi=0,lA=Yc(0),Na=0,a0=null,Wd=0,Fx=0,Mw=0,wf=null,Ms=null,Qw=0,PA=1/0,_l=null,Tg=!1,Lb=null,Pc=null,Qp=!1,Nc=null,Ig=0,Nf=0,Pb=null,Ym=-1,Jm=0;function Bs(){return Ir&6?zn():Ym!==-1?Ym:Ym=zn()}function Oc(e){return e.mode&1?Ir&2&&za!==0?za&-za:$L.transition!==null?(Jm===0&&(Jm=w3()),Jm):(e=Xr,e!==0||(e=window.event,e=e===void 0?16:E3(e.type)),e):1}function mo(e,t,r,a){if(50<Nf)throw Nf=0,Pb=null,Error(Ct(185));I0(e,r,a),(!(Ir&2)||e!==Da)&&(e===Da&&(!(Ir&2)&&(Fx|=r),Na===4&&bc(e,za)),Ks(e,a),r===1&&Ir===0&&!(t.mode&1)&&(PA=zn()+500,Cx&&Jc()))}function Ks(e,t){var r=e.callbackNode;$8(e,t);var a=mg(e,e===Da?za:0);if(a===0)r!==null&&YN(r),e.callbackNode=null,e.callbackPriority=0;else if(t=a&-a,e.callbackPriority!==t){if(r!=null&&YN(r),t===1)e.tag===0?qL(qj.bind(null,e)):G3(qj.bind(null,e)),RL(function(){!(Ir&6)&&Jc()}),r=null;else{switch(N3(a)){case 1:r=hw;break;case 4:r=b3;break;case 16:r=pg;break;case 536870912:r=_3;break;default:r=pg}r=WB(r,MB.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function MB(e,t){if(Ym=-1,Jm=0,Ir&6)throw Error(Ct(327));var r=e.callbackNode;if(xA()&&e.callbackNode!==r)return null;var a=mg(e,e===Da?za:0);if(a===0)return null;if(a&30||a&e.expiredLanes||t)t=Dg(e,a);else{t=a;var s=Ir;Ir|=2;var i=HB();(Da!==e||za!==t)&&(_l=null,PA=zn()+500,Ld(e,t));do try{dP();break}catch(l){QB(e,l)}while(!0);kw(),Fg.current=i,Ir=s,ca!==null?t=0:(Da=null,za=0,t=Na)}if(t!==0){if(t===2&&(s=cb(e),s!==0&&(a=s,t=Ob(e,s))),t===1)throw r=a0,Ld(e,0),bc(e,a),Ks(e,zn()),r;if(t===6)bc(e,a);else{if(s=e.current.alternate,!(a&30)&&!lP(s)&&(t=Dg(e,a),t===2&&(i=cb(e),i!==0&&(a=i,t=Ob(e,i))),t===1))throw r=a0,Ld(e,0),bc(e,a),Ks(e,zn()),r;switch(e.finishedWork=s,e.finishedLanes=a,t){case 0:case 1:throw Error(Ct(345));case 2:vd(e,Ms,_l);break;case 3:if(bc(e,a),(a&130023424)===a&&(t=Qw+500-zn(),10<t)){if(mg(e,0)!==0)break;if(s=e.suspendedLanes,(s&a)!==a){Bs(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=gb(vd.bind(null,e,Ms,_l),t);break}vd(e,Ms,_l);break;case 4:if(bc(e,a),(a&4194240)===a)break;for(t=e.eventTimes,s=-1;0<a;){var o=31-po(a);i=1<<o,o=t[o],o>s&&(s=o),a&=~i}if(a=s,a=zn()-a,a=(120>a?120:480>a?480:1080>a?1080:1920>a?1920:3e3>a?3e3:4320>a?4320:1960*oP(a/1960))-a,10<a){e.timeoutHandle=gb(vd.bind(null,e,Ms,_l),a);break}vd(e,Ms,_l);break;case 5:vd(e,Ms,_l);break;default:throw Error(Ct(329))}}}return Ks(e,zn()),e.callbackNode===r?MB.bind(null,e):null}function Ob(e,t){var r=wf;return e.current.memoizedState.isDehydrated&&(Ld(e,t).flags|=256),e=Dg(e,t),e!==2&&(t=Ms,Ms=r,t!==null&&Ub(t)),e}function Ub(e){Ms===null?Ms=e:Ms.push.apply(Ms,e)}function lP(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var a=0;a<r.length;a++){var s=r[a],i=s.getSnapshot;s=s.value;try{if(!yo(i(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function bc(e,t){for(t&=~Mw,t&=~Fx,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-po(t),a=1<<r;e[r]=-1,t&=~a}}function qj(e){if(Ir&6)throw Error(Ct(327));xA();var t=mg(e,0);if(!(t&1))return Ks(e,zn()),null;var r=Dg(e,t);if(e.tag!==0&&r===2){var a=cb(e);a!==0&&(t=a,r=Ob(e,a))}if(r===1)throw r=a0,Ld(e,0),bc(e,t),Ks(e,zn()),r;if(r===6)throw Error(Ct(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,vd(e,Ms,_l),Ks(e,zn()),null}function Hw(e,t){var r=Ir;Ir|=1;try{return e(t)}finally{Ir=r,Ir===0&&(PA=zn()+500,Cx&&Jc())}}function zd(e){Nc!==null&&Nc.tag===0&&!(Ir&6)&&xA();var t=Ir;Ir|=1;var r=Mi.transition,a=Xr;try{if(Mi.transition=null,Xr=1,e)return e()}finally{Xr=a,Mi.transition=r,Ir=t,!(Ir&6)&&Jc()}}function qw(){oi=lA.current,mn(lA)}function Ld(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,UL(r)),ca!==null)for(r=ca.return;r!==null;){var a=r;switch(ww(a),a.tag){case 1:a=a.type.childContextTypes,a!=null&&bg();break;case 3:DA(),mn(qs),mn(fs),Tw();break;case 5:Fw(a);break;case 4:DA();break;case 13:mn(jn);break;case 19:mn(jn);break;case 10:Cw(a.type._context);break;case 22:case 23:qw()}r=r.return}if(Da=e,ca=e=Uc(e.current,null),za=oi=t,Na=0,a0=null,Mw=Fx=Wd=0,Ms=wf=null,Ed!==null){for(t=0;t<Ed.length;t++)if(r=Ed[t],a=r.interleaved,a!==null){r.interleaved=null;var s=a.next,i=r.pending;if(i!==null){var o=i.next;i.next=s,a.next=o}r.pending=a}Ed=null}return e}function QB(e,t){do{var r=ca;try{if(kw(),zm.current=Eg,Bg){for(var a=Sn.memoizedState;a!==null;){var s=a.queue;s!==null&&(s.pending=null),a=a.next}Bg=!1}if(Vd=0,Ea=ba=Sn=null,bf=!1,t0=0,Rw.current=null,r===null||r.return===null){Na=1,a0=t,ca=null;break}e:{var i=e,o=r.return,l=r,c=t;if(t=za,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,u=l,f=u.tag;if(!(u.mode&1)&&(f===0||f===11||f===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var A=Ej(o);if(A!==null){A.flags&=-257,Fj(A,o,l,i,t),A.mode&1&&Bj(i,d,t),t=A,c=d;var x=t.updateQueue;if(x===null){var p=new Set;p.add(c),t.updateQueue=p}else x.add(c);break e}else{if(!(t&1)){Bj(i,d,t),$w();break e}c=Error(Ct(426))}}else if(wn&&l.mode&1){var b=Ej(o);if(b!==null){!(b.flags&65536)&&(b.flags|=256),Fj(b,o,l,i,t),Nw(LA(c,l));break e}}i=c=LA(c,l),Na!==4&&(Na=2),wf===null?wf=[i]:wf.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var m=NB(i,c,t);wj(i,m);break e;case 1:l=c;var g=i.type,y=i.stateNode;if(!(i.flags&128)&&(typeof g.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Pc===null||!Pc.has(y)))){i.flags|=65536,t&=-t,i.lanes|=t;var v=jB(i,l,t);wj(i,v);break e}}i=i.return}while(i!==null)}$B(r)}catch(_){t=_,ca===r&&r!==null&&(ca=r=r.return);continue}break}while(!0)}function HB(){var e=Fg.current;return Fg.current=Eg,e===null?Eg:e}function $w(){(Na===0||Na===3||Na===2)&&(Na=4),Da===null||!(Wd&268435455)&&!(Fx&268435455)||bc(Da,za)}function Dg(e,t){var r=Ir;Ir|=2;var a=HB();(Da!==e||za!==t)&&(_l=null,Ld(e,t));do try{cP();break}catch(s){QB(e,s)}while(!0);if(kw(),Ir=r,Fg.current=a,ca!==null)throw Error(Ct(261));return Da=null,za=0,Na}function cP(){for(;ca!==null;)qB(ca)}function dP(){for(;ca!==null&&!L8();)qB(ca)}function qB(e){var t=VB(e.alternate,e,oi);e.memoizedProps=e.pendingProps,t===null?$B(e):ca=t,Rw.current=null}function $B(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=nP(r,t),r!==null){r.flags&=32767,ca=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Na=6,ca=null;return}}else if(r=rP(r,t,oi),r!==null){ca=r;return}if(t=t.sibling,t!==null){ca=t;return}ca=t=e}while(t!==null);Na===0&&(Na=5)}function vd(e,t,r){var a=Xr,s=Mi.transition;try{Mi.transition=null,Xr=1,uP(e,t,r,a)}finally{Mi.transition=s,Xr=a}return null}function uP(e,t,r,a){do xA();while(Nc!==null);if(Ir&6)throw Error(Ct(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Ct(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(K8(e,i),e===Da&&(ca=Da=null,za=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Qp||(Qp=!0,WB(pg,function(){return xA(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=Mi.transition,Mi.transition=null;var o=Xr;Xr=1;var l=Ir;Ir|=4,Rw.current=null,sP(e,r),UB(r,e),FL(pb),gg=!!fb,pb=fb=null,e.current=r,iP(r),P8(),Ir=l,Xr=o,Mi.transition=i}else e.current=r;if(Qp&&(Qp=!1,Nc=e,Ig=s),i=e.pendingLanes,i===0&&(Pc=null),R8(r.stateNode),Ks(e,zn()),t!==null)for(a=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],a(s.value,{componentStack:s.stack,digest:s.digest});if(Tg)throw Tg=!1,e=Lb,Lb=null,e;return Ig&1&&e.tag!==0&&xA(),i=e.pendingLanes,i&1?e===Pb?Nf++:(Nf=0,Pb=e):Nf=0,Jc(),null}function xA(){if(Nc!==null){var e=N3(Ig),t=Mi.transition,r=Xr;try{if(Mi.transition=null,Xr=16>e?16:e,Nc===null)var a=!1;else{if(e=Nc,Nc=null,Ig=0,Ir&6)throw Error(Ct(331));var s=Ir;for(Ir|=4,Rt=e.current;Rt!==null;){var i=Rt,o=i.child;if(Rt.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(Rt=d;Rt!==null;){var u=Rt;switch(u.tag){case 0:case 11:case 15:_f(8,u,i)}var f=u.child;if(f!==null)f.return=u,Rt=f;else for(;Rt!==null;){u=Rt;var h=u.sibling,A=u.return;if(LB(u),u===d){Rt=null;break}if(h!==null){h.return=A,Rt=h;break}Rt=A}}}var x=i.alternate;if(x!==null){var p=x.child;if(p!==null){x.child=null;do{var b=p.sibling;p.sibling=null,p=b}while(p!==null)}}Rt=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,Rt=o;else e:for(;Rt!==null;){if(i=Rt,i.flags&2048)switch(i.tag){case 0:case 11:case 15:_f(9,i,i.return)}var m=i.sibling;if(m!==null){m.return=i.return,Rt=m;break e}Rt=i.return}}var g=e.current;for(Rt=g;Rt!==null;){o=Rt;var y=o.child;if(o.subtreeFlags&2064&&y!==null)y.return=o,Rt=y;else e:for(o=g;Rt!==null;){if(l=Rt,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Ex(9,l)}}catch(_){Pn(l,l.return,_)}if(l===o){Rt=null;break e}var v=l.sibling;if(v!==null){v.return=l.return,Rt=v;break e}Rt=l.return}}if(Ir=s,Jc(),$o&&typeof $o.onPostCommitFiberRoot=="function")try{$o.onPostCommitFiberRoot(_x,e)}catch{}a=!0}return a}finally{Xr=r,Mi.transition=t}}return!1}function $j(e,t,r){t=LA(r,t),t=NB(e,t,1),e=Lc(e,t,1),t=Bs(),e!==null&&(I0(e,1,t),Ks(e,t))}function Pn(e,t,r){if(e.tag===3)$j(e,e,r);else for(;t!==null;){if(t.tag===3){$j(t,e,r);break}else if(t.tag===1){var a=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof a.componentDidCatch=="function"&&(Pc===null||!Pc.has(a))){e=LA(r,e),e=jB(t,e,1),t=Lc(t,e,1),e=Bs(),t!==null&&(I0(t,1,e),Ks(t,e));break}}t=t.return}}function AP(e,t,r){var a=e.pingCache;a!==null&&a.delete(t),t=Bs(),e.pingedLanes|=e.suspendedLanes&r,Da===e&&(za&r)===r&&(Na===4||Na===3&&(za&130023424)===za&&500>zn()-Qw?Ld(e,0):Mw|=r),Ks(e,t)}function KB(e,t){t===0&&(e.mode&1?(t=Fp,Fp<<=1,!(Fp&130023424)&&(Fp=4194304)):t=1);var r=Bs();e=Pl(e,t),e!==null&&(I0(e,t,r),Ks(e,r))}function hP(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),KB(e,r)}function fP(e,t){var r=0;switch(e.tag){case 13:var a=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:a=e.stateNode;break;default:throw Error(Ct(314))}a!==null&&a.delete(t),KB(e,r)}var VB;VB=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||qs.current)Qs=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Qs=!1,tP(e,t,r);Qs=!!(e.flags&131072)}else Qs=!1,wn&&t.flags&1048576&&X3(t,Ng,t.index);switch(t.lanes=0,t.tag){case 2:var a=t.type;Xm(e,t),e=t.pendingProps;var s=FA(t,fs.current);gA(t,r),s=Dw(null,t,a,e,s,r);var i=Lw();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,$s(a)?(i=!0,_g(t)):i=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Bw(t),s.updater=Bx,t.stateNode=s,s._reactInternals=t,Nb(t,a,e,r),t=Cb(null,t,a,!0,i,r)):(t.tag=0,wn&&i&&_w(t),Ns(null,t,s,r),t=t.child),t;case 16:a=t.elementType;e:{switch(Xm(e,t),e=t.pendingProps,s=a._init,a=s(a._payload),t.type=a,s=t.tag=mP(a),e=io(a,e),s){case 0:t=kb(null,t,a,e,r);break e;case 1:t=Dj(null,t,a,e,r);break e;case 11:t=Tj(null,t,a,e,r);break e;case 14:t=Ij(null,t,a,io(a.type,e),r);break e}throw Error(Ct(306,a,""))}return t;case 0:return a=t.type,s=t.pendingProps,s=t.elementType===a?s:io(a,s),kb(e,t,a,s,r);case 1:return a=t.type,s=t.pendingProps,s=t.elementType===a?s:io(a,s),Dj(e,t,a,s,r);case 3:e:{if(BB(t),e===null)throw Error(Ct(387));a=t.pendingProps,i=t.memoizedState,s=i.element,rB(e,t),Cg(t,a,null,r);var o=t.memoizedState;if(a=o.element,i.isDehydrated)if(i={element:a,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){s=LA(Error(Ct(423)),t),t=Lj(e,t,a,r,s);break e}else if(a!==s){s=LA(Error(Ct(424)),t),t=Lj(e,t,a,r,s);break e}else for(fi=Dc(t.stateNode.containerInfo.firstChild),mi=t,wn=!0,uo=null,r=eB(t,null,a,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(TA(),a===s){t=Ol(e,t,r);break e}Ns(e,t,a,r)}t=t.child}return t;case 5:return nB(t),e===null&&bb(t),a=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,o=s.children,mb(a,s)?o=null:i!==null&&mb(a,i)&&(t.flags|=32),SB(e,t),Ns(e,t,o,r),t.child;case 6:return e===null&&bb(t),null;case 13:return EB(e,t,r);case 4:return Ew(t,t.stateNode.containerInfo),a=t.pendingProps,e===null?t.child=IA(t,null,a,r):Ns(e,t,a,r),t.child;case 11:return a=t.type,s=t.pendingProps,s=t.elementType===a?s:io(a,s),Tj(e,t,a,s,r);case 7:return Ns(e,t,t.pendingProps,r),t.child;case 8:return Ns(e,t,t.pendingProps.children,r),t.child;case 12:return Ns(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(a=t.type._context,s=t.pendingProps,i=t.memoizedProps,o=s.value,ln(jg,a._currentValue),a._currentValue=o,i!==null)if(yo(i.value,o)){if(i.children===s.children&&!qs.current){t=Ol(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===a){if(i.tag===1){c=Bl(-1,r&-r),c.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var u=d.pending;u===null?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}i.lanes|=r,c=i.alternate,c!==null&&(c.lanes|=r),_b(i.return,r,t),l.lanes|=r;break}c=c.next}}else if(i.tag===10)o=i.type===t.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(Ct(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),_b(o,r,t),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===t){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Ns(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,a=t.pendingProps.children,gA(t,r),s=Hi(s),a=a(s),t.flags|=1,Ns(e,t,a,r),t.child;case 14:return a=t.type,s=io(a,t.pendingProps),s=io(a.type,s),Ij(e,t,a,s,r);case 15:return kB(e,t,t.type,t.pendingProps,r);case 17:return a=t.type,s=t.pendingProps,s=t.elementType===a?s:io(a,s),Xm(e,t),t.tag=1,$s(a)?(e=!0,_g(t)):e=!1,gA(t,r),wB(t,a,s),Nb(t,a,s,r),Cb(null,t,a,!0,e,r);case 19:return FB(e,t,r);case 22:return CB(e,t,r)}throw Error(Ct(156,t.tag))};function WB(e,t){return v3(e,t)}function pP(e,t,r,a){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Oi(e,t,r,a){return new pP(e,t,r,a)}function Kw(e){return e=e.prototype,!(!e||!e.isReactComponent)}function mP(e){if(typeof e=="function")return Kw(e)?1:0;if(e!=null){if(e=e.$$typeof,e===dw)return 11;if(e===uw)return 14}return 2}function Uc(e,t){var r=e.alternate;return r===null?(r=Oi(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Zm(e,t,r,a,s,i){var o=2;if(a=e,typeof e=="function")Kw(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case Ju:return Pd(r.children,s,i,t);case cw:o=8,s|=8;break;case z1:return e=Oi(12,r,t,s|2),e.elementType=z1,e.lanes=i,e;case G1:return e=Oi(13,r,t,s),e.elementType=G1,e.lanes=i,e;case X1:return e=Oi(19,r,t,s),e.elementType=X1,e.lanes=i,e;case n3:return Tx(r,s,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case t3:o=10;break e;case r3:o=9;break e;case dw:o=11;break e;case uw:o=14;break e;case mc:o=16,a=null;break e}throw Error(Ct(130,e==null?e:typeof e,""))}return t=Oi(o,r,t,s),t.elementType=e,t.type=a,t.lanes=i,t}function Pd(e,t,r,a){return e=Oi(7,e,a,t),e.lanes=r,e}function Tx(e,t,r,a){return e=Oi(22,e,a,t),e.elementType=n3,e.lanes=r,e.stateNode={isHidden:!1},e}function mv(e,t,r){return e=Oi(6,e,null,t),e.lanes=r,e}function gv(e,t,r){return t=Oi(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function gP(e,t,r,a,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Yy(0),this.expirationTimes=Yy(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Yy(0),this.identifierPrefix=a,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Vw(e,t,r,a,s,i,o,l,c){return e=new gP(e,t,r,l,c),t===1?(t=1,i===!0&&(t|=8)):t=0,i=Oi(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:a,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Bw(i),e}function xP(e,t,r){var a=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Yu,key:a==null?null:""+a,children:e,containerInfo:t,implementation:r}}function zB(e){if(!e)return qc;e=e._reactInternals;e:{if(su(e)!==e||e.tag!==1)throw Error(Ct(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if($s(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Ct(171))}if(e.tag===1){var r=e.type;if($s(r))return z3(e,r,t)}return t}function GB(e,t,r,a,s,i,o,l,c){return e=Vw(r,a,!0,e,s,i,o,l,c),e.context=zB(null),r=e.current,a=Bs(),s=Oc(r),i=Bl(a,s),i.callback=t??null,Lc(r,i,s),e.current.lanes=s,I0(e,s,a),Ks(e,a),e}function Ix(e,t,r,a){var s=t.current,i=Bs(),o=Oc(s);return r=zB(r),t.context===null?t.context=r:t.pendingContext=r,t=Bl(i,o),t.payload={element:e},a=a===void 0?null:a,a!==null&&(t.callback=a),e=Lc(s,t,o),e!==null&&(mo(e,s,o,i),Wm(e,s,o)),o}function Lg(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Kj(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Ww(e,t){Kj(e,t),(e=e.alternate)&&Kj(e,t)}function yP(){return null}var XB=typeof reportError=="function"?reportError:function(e){console.error(e)};function zw(e){this._internalRoot=e}Dx.prototype.render=zw.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Ct(409));Ix(e,t,null,null)};Dx.prototype.unmount=zw.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;zd(function(){Ix(null,e,null,null)}),t[Ll]=null}};function Dx(e){this._internalRoot=e}Dx.prototype.unstable_scheduleHydration=function(e){if(e){var t=C3();e={blockedOn:null,target:e,priority:t};for(var r=0;r<vc.length&&t!==0&&t<vc[r].priority;r++);vc.splice(r,0,e),r===0&&B3(e)}};function Gw(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Lx(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Vj(){}function vP(e,t,r,a,s){if(s){if(typeof a=="function"){var i=a;a=function(){var d=Lg(o);i.call(d)}}var o=GB(t,a,e,0,null,!1,!1,"",Vj);return e._reactRootContainer=o,e[Ll]=o.current,Xf(e.nodeType===8?e.parentNode:e),zd(),o}for(;s=e.lastChild;)e.removeChild(s);if(typeof a=="function"){var l=a;a=function(){var d=Lg(c);l.call(d)}}var c=Vw(e,0,!1,null,null,!1,!1,"",Vj);return e._reactRootContainer=c,e[Ll]=c.current,Xf(e.nodeType===8?e.parentNode:e),zd(function(){Ix(t,c,r,a)}),c}function Px(e,t,r,a,s){var i=r._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var c=Lg(o);l.call(c)}}Ix(t,o,e,s)}else o=vP(r,t,e,s,a);return Lg(o)}j3=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=tf(t.pendingLanes);r!==0&&(fw(t,r|1),Ks(t,zn()),!(Ir&6)&&(PA=zn()+500,Jc()))}break;case 13:zd(function(){var a=Pl(e,1);if(a!==null){var s=Bs();mo(a,e,1,s)}}),Ww(e,1)}};pw=function(e){if(e.tag===13){var t=Pl(e,134217728);if(t!==null){var r=Bs();mo(t,e,134217728,r)}Ww(e,134217728)}};k3=function(e){if(e.tag===13){var t=Oc(e),r=Pl(e,t);if(r!==null){var a=Bs();mo(r,e,t,a)}Ww(e,t)}};C3=function(){return Xr};S3=function(e,t){var r=Xr;try{return Xr=e,t()}finally{Xr=r}};ib=function(e,t,r){switch(t){case"input":if(Z1(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var a=r[t];if(a!==e&&a.form===e.form){var s=kx(a);if(!s)throw Error(Ct(90));s3(a),Z1(a,s)}}}break;case"textarea":o3(e,r);break;case"select":t=r.value,t!=null&&hA(e,!!r.multiple,t,!1)}};f3=Hw;p3=zd;var bP={usingClientEntryPoint:!1,Events:[L0,rA,kx,A3,h3,Hw]},Ph={findFiberByHostInstance:Bd,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},_P={bundleType:Ph.bundleType,version:Ph.version,rendererPackageName:Ph.rendererPackageName,rendererConfig:Ph.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Hl.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=x3(e),e===null?null:e.stateNode},findFiberByHostInstance:Ph.findFiberByHostInstance||yP,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Hp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Hp.isDisabled&&Hp.supportsFiber)try{_x=Hp.inject(_P),$o=Hp}catch{}}yi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=bP;yi.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Gw(t))throw Error(Ct(200));return xP(e,t,null,r)};yi.createRoot=function(e,t){if(!Gw(e))throw Error(Ct(299));var r=!1,a="",s=XB;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(a=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=Vw(e,1,!1,null,null,r,!1,a,s),e[Ll]=t.current,Xf(e.nodeType===8?e.parentNode:e),new zw(t)};yi.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Ct(188)):(e=Object.keys(e).join(","),Error(Ct(268,e)));return e=x3(t),e=e===null?null:e.stateNode,e};yi.flushSync=function(e){return zd(e)};yi.hydrate=function(e,t,r){if(!Lx(t))throw Error(Ct(200));return Px(null,e,t,!0,r)};yi.hydrateRoot=function(e,t,r){if(!Gw(e))throw Error(Ct(405));var a=r!=null&&r.hydratedSources||null,s=!1,i="",o=XB;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=GB(t,null,e,1,r??null,s,!1,i,o),e[Ll]=t.current,Xf(e),a)for(e=0;e<a.length;e++)r=a[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new Dx(t)};yi.render=function(e,t,r){if(!Lx(t))throw Error(Ct(200));return Px(null,e,t,!1,r)};yi.unmountComponentAtNode=function(e){if(!Lx(e))throw Error(Ct(40));return e._reactRootContainer?(zd(function(){Px(null,null,e,!1,function(){e._reactRootContainer=null,e[Ll]=null})}),!0):!1};yi.unstable_batchedUpdates=Hw;yi.unstable_renderSubtreeIntoContainer=function(e,t,r,a){if(!Lx(r))throw Error(Ct(200));if(e==null||e._reactInternals===void 0)throw Error(Ct(38));return Px(e,t,r,!1,a)};yi.version="18.3.1-next-f1338f8080-20240426";function YB(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(YB)}catch(e){console.error(e)}}YB(),YS.exports=yi;var JB=YS.exports,ZB,Wj=JB;ZB=Wj.createRoot,Wj.hydrateRoot;function Ox(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,a=Object.getOwnPropertySymbols(e);s<a.length;s++)t.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(e,a[s])&&(r[a[s]]=e[a[s]]);return r}function wP(e,t,r,a){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(u){try{d(a.next(u))}catch(f){o(f)}}function c(u){try{d(a.throw(u))}catch(f){o(f)}}function d(u){u.done?i(u.value):s(u.value).then(l,c)}d((a=a.apply(e,t||[])).next())})}const NP=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class Xw extends Error{constructor(t,r="FunctionsError",a){super(t),this.name=r,this.context=a}}class jP extends Xw{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class zj extends Xw{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Gj extends Xw{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Rb;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(Rb||(Rb={}));class kP{constructor(t,{headers:r={},customFetch:a,region:s=Rb.Any}={}){this.url=t,this.headers=r,this.region=s,this.fetch=NP(a)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return wP(this,arguments,void 0,function*(r,a={}){var s;let i,o;try{const{headers:l,method:c,body:d,signal:u,timeout:f}=a;let h={},{region:A}=a;A||(A=this.region);const x=new URL(`${this.url}/${r}`);A&&A!=="any"&&(h["x-region"]=A,x.searchParams.set("forceFunctionRegion",A));let p;d&&(l&&!Object.prototype.hasOwnProperty.call(l,"Content-Type")||!l)?typeof Blob<"u"&&d instanceof Blob||d instanceof ArrayBuffer?(h["Content-Type"]="application/octet-stream",p=d):typeof d=="string"?(h["Content-Type"]="text/plain",p=d):typeof FormData<"u"&&d instanceof FormData?p=d:(h["Content-Type"]="application/json",p=JSON.stringify(d)):d&&typeof d!="string"&&!(typeof Blob<"u"&&d instanceof Blob)&&!(d instanceof ArrayBuffer)&&!(typeof FormData<"u"&&d instanceof FormData)?p=JSON.stringify(d):p=d;let b=u;f&&(o=new AbortController,i=setTimeout(()=>o.abort(),f),u?(b=o.signal,u.addEventListener("abort",()=>o.abort())):b=o.signal);const m=yield this.fetch(x.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},h),this.headers),l),body:p,signal:b}).catch(_=>{throw new jP(_)}),g=m.headers.get("x-relay-error");if(g&&g==="true")throw new zj(m);if(!m.ok)throw new Gj(m);let y=((s=m.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),v;return y==="application/json"?v=yield m.json():y==="application/octet-stream"||y==="application/pdf"?v=yield m.blob():y==="text/event-stream"?v=m:y==="multipart/form-data"?v=yield m.formData():v=yield m.text(),{data:v,error:null,response:m}}catch(l){return{data:null,error:l,response:l instanceof Gj||l instanceof zj?l.context:void 0}}finally{i&&clearTimeout(i)}})}}var CP=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},SP=class{constructor(e){var t,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(t=e.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const a=this.fetch;let s=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{let o=null,l=null,c=null,d=i.status,u=i.statusText;if(i.ok){var f,h;if(r.method!=="HEAD"){var A;const m=await i.text();m===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((A=r.headers.get("Accept"))===null||A===void 0)&&A.includes("application/vnd.pgrst.plan+text"))?l=m:l=JSON.parse(m))}const p=(f=r.headers.get("Prefer"))===null||f===void 0?void 0:f.match(/count=(exact|planned|estimated)/),b=(h=i.headers.get("content-range"))===null||h===void 0?void 0:h.split("/");p&&b&&b.length>1&&(c=parseInt(b[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(l)&&(l.length>1?(o={code:"PGRST116",details:`Results contain ${l.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},l=null,c=null,d=406,u="Not Acceptable"):l.length===1?l=l[0]:l=null)}else{var x;const p=await i.text();try{o=JSON.parse(p),Array.isArray(o)&&i.status===404&&(l=[],o=null,d=200,u="OK")}catch{i.status===404&&p===""?(d=204,u="No Content"):o={message:p}}if(o&&r.isMaybeSingle&&(!(o==null||(x=o.details)===null||x===void 0)&&x.includes("0 rows"))&&(o=null,d=200,u="OK"),o&&r.shouldThrowOnError)throw new CP(o)}return{error:o,data:l,count:c,status:d,statusText:u}});return this.shouldThrowOnError||(s=s.catch(i=>{var o;let l="";const c=i==null?void 0:i.cause;if(c){var d,u,f,h;const x=(d=c==null?void 0:c.message)!==null&&d!==void 0?d:"",p=(u=c==null?void 0:c.code)!==null&&u!==void 0?u:"";l=`${(f=i==null?void 0:i.name)!==null&&f!==void 0?f:"FetchError"}: ${i==null?void 0:i.message}`,l+=`

Caused by: ${(h=c==null?void 0:c.name)!==null&&h!==void 0?h:"Error"}: ${x}`,p&&(l+=` (${p})`),c!=null&&c.stack&&(l+=`
${c.stack}`)}else{var A;l=(A=i==null?void 0:i.stack)!==null&&A!==void 0?A:""}return{error:{message:`${(o=i==null?void 0:i.name)!==null&&o!==void 0?o:"FetchError"}: ${i==null?void 0:i.message}`,details:l,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),s.then(e,t)}returns(){return this}overrideTypes(){return this}},BP=class extends SP{select(e){let t=!1;const r=(e??"*").split("").map(a=>/\s/.test(a)&&!t?"":(a==='"'&&(t=!t),a)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:a,referencedTable:s=a}={}){const i=s?`${s}.order`:"order",o=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${o?`${o},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const a=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(a,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:a=r}={}){const s=typeof a>"u"?"offset":`${a}.offset`,i=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(s,`${e}`),this.url.searchParams.set(i,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:a=!1,wal:s=!1,format:i="text"}={}){var o;const l=[e?"analyze":null,t?"verbose":null,r?"settings":null,a?"buffers":null,s?"wal":null].filter(Boolean).join("|"),c=(o=this.headers.get("Accept"))!==null&&o!==void 0?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${c}"; options=${l};`),i==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};const Xj=new RegExp("[,()]");var qu=class extends BP{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}regexMatch(e,t){return this.url.searchParams.append(e,`match.${t}`),this}regexIMatch(e,t){return this.url.searchParams.append(e,`imatch.${t}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}isDistinct(e,t){return this.url.searchParams.append(e,`isdistinct.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(a=>typeof a=="string"&&Xj.test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}notIn(e,t){const r=Array.from(new Set(t)).map(a=>typeof a=="string"&&Xj.test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(e,`not.in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:a}={}){let s="";a==="plain"?s="pl":a==="phrase"?s="ph":a==="websearch"&&(s="w");const i=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${s}fts${i}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const a=r?`${r}.or`:"or";return this.url.searchParams.append(a,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}},EP=class{constructor(e,{headers:t={},schema:r,fetch:a}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=a}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(e,t){const{head:r=!1,count:a}=t??{},s=r?"HEAD":"GET";let i=!1;const o=(e??"*").split("").map(d=>/\s/.test(d)&&!i?"":(d==='"'&&(i=!i),d)).join(""),{url:l,headers:c}=this.cloneRequestState();return l.searchParams.set("select",o),a&&c.append("Prefer",`count=${a}`),new qu({method:s,url:l,headers:c,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:r=!0}={}){var a;const s="POST",{url:i,headers:o}=this.cloneRequestState();if(t&&o.append("Prefer",`count=${t}`),r||o.append("Prefer","missing=default"),Array.isArray(e)){const l=e.reduce((c,d)=>c.concat(Object.keys(d)),[]);if(l.length>0){const c=[...new Set(l)].map(d=>`"${d}"`);i.searchParams.set("columns",c.join(","))}}return new qu({method:s,url:i,headers:o,schema:this.schema,body:e,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:a,defaultToNull:s=!0}={}){var i;const o="POST",{url:l,headers:c}=this.cloneRequestState();if(c.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),t!==void 0&&l.searchParams.set("on_conflict",t),a&&c.append("Prefer",`count=${a}`),s||c.append("Prefer","missing=default"),Array.isArray(e)){const d=e.reduce((u,f)=>u.concat(Object.keys(f)),[]);if(d.length>0){const u=[...new Set(d)].map(f=>`"${f}"`);l.searchParams.set("columns",u.join(","))}}return new qu({method:o,url:l,headers:c,schema:this.schema,body:e,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}update(e,{count:t}={}){var r;const a="PATCH",{url:s,headers:i}=this.cloneRequestState();return t&&i.append("Prefer",`count=${t}`),new qu({method:a,url:s,headers:i,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:e}={}){var t;const r="DELETE",{url:a,headers:s}=this.cloneRequestState();return e&&s.append("Prefer",`count=${e}`),new qu({method:r,url:a,headers:s,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}},FP=class eE{constructor(t,{headers:r={},schema:a,fetch:s}={}){this.url=t,this.headers=new Headers(r),this.schemaName=a,this.fetch=s}from(t){if(!t||typeof t!="string"||t.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new EP(new URL(`${this.url}/${t}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new eE(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:a=!1,get:s=!1,count:i}={}){var o;let l;const c=new URL(`${this.url}/rpc/${t}`);let d;const u=A=>A!==null&&typeof A=="object"&&(!Array.isArray(A)||A.some(u)),f=a&&Object.values(r).some(u);f?(l="POST",d=r):a||s?(l=a?"HEAD":"GET",Object.entries(r).filter(([A,x])=>x!==void 0).map(([A,x])=>[A,Array.isArray(x)?`{${x.join(",")}}`:`${x}`]).forEach(([A,x])=>{c.searchParams.append(A,x)})):(l="POST",d=r);const h=new Headers(this.headers);return f?h.set("Prefer",i?`count=${i},return=minimal`:"return=minimal"):i&&h.set("Prefer",`count=${i}`),new qu({method:l,url:c,headers:h,schema:this.schemaName,body:d,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}};class TP{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const r=globalThis.process;if(r){const a=r.versions;if(a&&a.node){const s=a.node,i=parseInt(s.replace(/^v/,"").split(".")[0]);return i>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${i} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${i} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const a=this.getWebSocketConstructor();return new a(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const IP="2.93.3",DP=`realtime-js/${IP}`,LP="1.0.0",tE="2.0.0",Yj=tE,Mb=1e4,PP=1e3,OP=100;var xc;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(xc||(xc={}));var ya;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(ya||(ya={}));var co;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(co||(co={}));var Qb;(function(e){e.websocket="websocket"})(Qb||(Qb={}));var Nd;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Nd||(Nd={}));class UP{constructor(t){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=t??[]}encode(t,r){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let a=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(a))}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,a;const s=(a=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&a!==void 0?a:new ArrayBuffer(0);return this._encodeUserBroadcastPush(t,this.BINARY_ENCODING,s)}_encodeJsonUserBroadcastPush(t){var r,a;const s=(a=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&a!==void 0?a:{},o=new TextEncoder().encode(JSON.stringify(s)).buffer;return this._encodeUserBroadcastPush(t,this.JSON_ENCODING,o)}_encodeUserBroadcastPush(t,r,a){var s,i;const o=t.topic,l=(s=t.ref)!==null&&s!==void 0?s:"",c=(i=t.join_ref)!==null&&i!==void 0?i:"",d=t.payload.event,u=this.allowedMetadataKeys?this._pick(t.payload,this.allowedMetadataKeys):{},f=Object.keys(u).length===0?"":JSON.stringify(u);if(c.length>255)throw new Error(`joinRef length ${c.length} exceeds maximum of 255`);if(l.length>255)throw new Error(`ref length ${l.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`topic length ${o.length} exceeds maximum of 255`);if(d.length>255)throw new Error(`userEvent length ${d.length} exceeds maximum of 255`);if(f.length>255)throw new Error(`metadata length ${f.length} exceeds maximum of 255`);const h=this.USER_BROADCAST_PUSH_META_LENGTH+c.length+l.length+o.length+d.length+f.length,A=new ArrayBuffer(this.HEADER_LENGTH+h);let x=new DataView(A),p=0;x.setUint8(p++,this.KINDS.userBroadcastPush),x.setUint8(p++,c.length),x.setUint8(p++,l.length),x.setUint8(p++,o.length),x.setUint8(p++,d.length),x.setUint8(p++,f.length),x.setUint8(p++,r),Array.from(c,m=>x.setUint8(p++,m.charCodeAt(0))),Array.from(l,m=>x.setUint8(p++,m.charCodeAt(0))),Array.from(o,m=>x.setUint8(p++,m.charCodeAt(0))),Array.from(d,m=>x.setUint8(p++,m.charCodeAt(0))),Array.from(f,m=>x.setUint8(p++,m.charCodeAt(0)));var b=new Uint8Array(A.byteLength+a.byteLength);return b.set(new Uint8Array(A),0),b.set(new Uint8Array(a),A.byteLength),b.buffer}decode(t,r){if(this._isArrayBuffer(t)){let a=this._binaryDecode(t);return r(a)}if(typeof t=="string"){const a=JSON.parse(t),[s,i,o,l,c]=a;return r({join_ref:s,ref:i,topic:o,event:l,payload:c})}return r({})}_binaryDecode(t){const r=new DataView(t),a=r.getUint8(0),s=new TextDecoder;switch(a){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(t,r,s)}}_decodeUserBroadcast(t,r,a){const s=r.getUint8(1),i=r.getUint8(2),o=r.getUint8(3),l=r.getUint8(4);let c=this.HEADER_LENGTH+4;const d=a.decode(t.slice(c,c+s));c=c+s;const u=a.decode(t.slice(c,c+i));c=c+i;const f=a.decode(t.slice(c,c+o));c=c+o;const h=t.slice(c,t.byteLength),A=l===this.JSON_ENCODING?JSON.parse(a.decode(h)):h,x={type:this.BROADCAST_EVENT,event:u,payload:A};return o>0&&(x.meta=JSON.parse(f)),{join_ref:null,ref:null,topic:d,event:this.BROADCAST_EVENT,payload:x}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t==null?void 0:t.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(t,r){return!t||typeof t!="object"?{}:Object.fromEntries(Object.entries(t).filter(([a])=>r.includes(a)))}}class rE{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var sn;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(sn||(sn={}));const Jj=(e,t,r={})=>{var a;const s=(a=r.skipTypes)!==null&&a!==void 0?a:[];return t?Object.keys(t).reduce((i,o)=>(i[o]=RP(o,e,t,s),i),{}):{}},RP=(e,t,r,a)=>{const s=t.find(l=>l.name===e),i=s==null?void 0:s.type,o=r[e];return i&&!a.includes(i)?nE(i,o):Hb(o)},nE=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return qP(t,r)}switch(e){case sn.bool:return MP(t);case sn.float4:case sn.float8:case sn.int2:case sn.int4:case sn.int8:case sn.numeric:case sn.oid:return QP(t);case sn.json:case sn.jsonb:return HP(t);case sn.timestamp:return $P(t);case sn.abstime:case sn.date:case sn.daterange:case sn.int4range:case sn.int8range:case sn.money:case sn.reltime:case sn.text:case sn.time:case sn.timestamptz:case sn.timetz:case sn.tsrange:case sn.tstzrange:return Hb(t);default:return Hb(t)}},Hb=e=>e,MP=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},QP=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},HP=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e},qP=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,a=e[r];if(e[0]==="{"&&a==="}"){let i;const o=e.slice(1,r);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(l=>nE(t,l))}return e},$P=e=>typeof e=="string"?e.replace(" ","T"):e,aE=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class xv{constructor(t,r,a={},s=Mb){this.channel=t,this.event=r,this.payload=a,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var a;return this._hasReceived(t)&&r((a=this.receivedResp)===null||a===void 0?void 0:a.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(a=>a.status===t).forEach(a=>a.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Zj;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(Zj||(Zj={}));class jf{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const a=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(a.state,{},s=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=jf.syncState(this.state,s,i,o),this.pendingDiffs.forEach(c=>{this.state=jf.syncDiff(this.state,c,i,o)}),this.pendingDiffs=[],l()}),this.channel._on(a.diff,{},s=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=jf.syncDiff(this.state,s,i,o),l())}),this.onJoin((s,i,o)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:i,newPresences:o})}),this.onLeave((s,i,o)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,a,s){const i=this.cloneDeep(t),o=this.transformState(r),l={},c={};return this.map(i,(d,u)=>{o[d]||(c[d]=u)}),this.map(o,(d,u)=>{const f=i[d];if(f){const h=u.map(b=>b.presence_ref),A=f.map(b=>b.presence_ref),x=u.filter(b=>A.indexOf(b.presence_ref)<0),p=f.filter(b=>h.indexOf(b.presence_ref)<0);x.length>0&&(l[d]=x),p.length>0&&(c[d]=p)}else l[d]=u}),this.syncDiff(i,{joins:l,leaves:c},a,s)}static syncDiff(t,r,a,s){const{joins:i,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return a||(a=()=>{}),s||(s=()=>{}),this.map(i,(l,c)=>{var d;const u=(d=t[l])!==null&&d!==void 0?d:[];if(t[l]=this.cloneDeep(c),u.length>0){const f=t[l].map(A=>A.presence_ref),h=u.filter(A=>f.indexOf(A.presence_ref)<0);t[l].unshift(...h)}a(l,u,c)}),this.map(o,(l,c)=>{let d=t[l];if(!d)return;const u=c.map(f=>f.presence_ref);d=d.filter(f=>u.indexOf(f.presence_ref)<0),t[l]=d,s(l,d,c),d.length===0&&delete t[l]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(a=>r(a,t[a]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,a)=>{const s=t[a];return"metas"in s?r[a]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[a]=s,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var e5;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(e5||(e5={}));var kf;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(kf||(kf={}));var wl;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(wl||(wl={}));class cA{constructor(t,r={config:{}},a){var s,i;if(this.topic=t,this.params=r,this.socket=a,this.bindings={},this.state=ya.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new xv(this,co.join,this.params,this.timeout),this.rejoinTimer=new rE(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=ya.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=ya.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=ya.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=ya.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=ya.errored,this.rejoinTimer.scheduleTimeout())}),this._on(co.reply,{},(o,l)=>{this._trigger(this._replyEventName(l),o)}),this.presence=new jf(this),this.broadcastEndpointURL=aE(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((i=(s=this.params.config)===null||s===void 0?void 0:s.broadcast)===null||i===void 0)&&i.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var a,s,i;if(this.socket.isConnected()||this.socket.connect(),this.state==ya.closed){const{config:{broadcast:o,presence:l,private:c}}=this.params,d=(s=(a=this.bindings.postgres_changes)===null||a===void 0?void 0:a.map(A=>A.filter))!==null&&s!==void 0?s:[],u=!!this.bindings[kf.PRESENCE]&&this.bindings[kf.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,f={},h={broadcast:o,presence:Object.assign(Object.assign({},l),{enabled:u}),postgres_changes:d,private:c};this.socket.accessTokenValue&&(f.access_token=this.socket.accessTokenValue),this._onError(A=>t==null?void 0:t(wl.CHANNEL_ERROR,A)),this._onClose(()=>t==null?void 0:t(wl.CLOSED)),this.updateJoinPayload(Object.assign({config:h},f)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:A})=>{var x;if(this.socket._isManualToken()||this.socket.setAuth(),A===void 0){t==null||t(wl.SUBSCRIBED);return}else{const p=this.bindings.postgres_changes,b=(x=p==null?void 0:p.length)!==null&&x!==void 0?x:0,m=[];for(let g=0;g<b;g++){const y=p[g],{filter:{event:v,schema:_,table:j,filter:N}}=y,B=A&&A[g];if(B&&B.event===v&&cA.isFilterValueEqual(B.schema,_)&&cA.isFilterValueEqual(B.table,j)&&cA.isFilterValueEqual(B.filter,N))m.push(Object.assign(Object.assign({},y),{id:B.id}));else{this.unsubscribe(),this.state=ya.errored,t==null||t(wl.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=m,t&&t(wl.SUBSCRIBED);return}}).receive("error",A=>{this.state=ya.errored,t==null||t(wl.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(A).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(wl.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,a){return this.state===ya.joined&&t===kf.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(t,r,a)}async httpSend(t,r,a={}){var s;if(r==null)return Promise.reject("Payload is required for httpSend()");const i={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(i.Authorization=`Bearer ${this.socket.accessTokenValue}`);const o={method:"POST",headers:i,body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},l=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(s=a.timeout)!==null&&s!==void 0?s:this.timeout);if(l.status===202)return{success:!0};let c=l.statusText;try{const d=await l.json();c=d.error||d.message||c}catch{}return Promise.reject(new Error(c))}async send(t,r={}){var a,s;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:i,payload:o}=t,l={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(l.Authorization=`Bearer ${this.socket.accessTokenValue}`);const c={method:"POST",headers:l,body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(a=r.timeout)!==null&&a!==void 0?a:this.timeout);return await((s=d.body)===null||s===void 0?void 0:s.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,l,c;const d=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((c=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&i("ok"),d.receive("ok",()=>i("ok")),d.receive("error",()=>i("error")),d.receive("timeout",()=>i("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=ya.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(co.close,"leave",this._joinRef())};this.joinPush.destroy();let a=null;return new Promise(s=>{a=new xv(this,co.leave,{},t),a.receive("ok",()=>{r(),s("ok")}).receive("timeout",()=>{r(),s("timed out")}).receive("error",()=>{s("error")}),a.send(),this._canPush()||a.trigger("ok",{})}).finally(()=>{a==null||a.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=ya.closed,this.bindings={}}async _fetchWithTimeout(t,r,a){const s=new AbortController,i=setTimeout(()=>s.abort(),a),o=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:s.signal}));return clearTimeout(i),o}_push(t,r,a=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new xv(this,t,r,a);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>OP){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,a){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,a){var s,i;const o=t.toLocaleLowerCase(),{close:l,error:c,leave:d,join:u}=co;if(a&&[l,c,d,u].indexOf(o)>=0&&a!==this._joinRef())return;let h=this._onMessage(o,r,a);if(r&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(A=>{var x,p,b;return((x=A.filter)===null||x===void 0?void 0:x.event)==="*"||((b=(p=A.filter)===null||p===void 0?void 0:p.event)===null||b===void 0?void 0:b.toLocaleLowerCase())===o}).map(A=>A.callback(h,a)):(i=this.bindings[o])===null||i===void 0||i.filter(A=>{var x,p,b,m,g,y;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in A){const v=A.id,_=(x=A.filter)===null||x===void 0?void 0:x.event;return v&&((p=r.ids)===null||p===void 0?void 0:p.includes(v))&&(_==="*"||(_==null?void 0:_.toLocaleLowerCase())===((b=r.data)===null||b===void 0?void 0:b.type.toLocaleLowerCase()))}else{const v=(g=(m=A==null?void 0:A.filter)===null||m===void 0?void 0:m.event)===null||g===void 0?void 0:g.toLocaleLowerCase();return v==="*"||v===((y=r==null?void 0:r.event)===null||y===void 0?void 0:y.toLocaleLowerCase())}else return A.type.toLocaleLowerCase()===o}).map(A=>{if(typeof h=="object"&&"ids"in h){const x=h.data,{schema:p,table:b,commit_timestamp:m,type:g,errors:y}=x;h=Object.assign(Object.assign({},{schema:p,table:b,commit_timestamp:m,eventType:g,new:{},old:{},errors:y}),this._getPayloadRecords(x))}A.callback(h,a)})}_isClosed(){return this.state===ya.closed}_isJoined(){return this.state===ya.joined}_isJoining(){return this.state===ya.joining}_isLeaving(){return this.state===ya.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,a){const s=t.toLocaleLowerCase(),i={type:s,filter:r,callback:a};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(t,r){const a=t.toLocaleLowerCase();return this.bindings[a]&&(this.bindings[a]=this.bindings[a].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===a&&cA.isEqual(s.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const a in t)if(t[a]!==r[a])return!1;return!0}static isFilterValueEqual(t,r){return(t??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(co.close,{},t)}_onError(t){this._on(co.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=ya.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=Jj(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=Jj(t.columns,t.old_record)),r}}const yv=()=>{},qp={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},KP=[1e3,2e3,5e3,1e4],VP=1e4,WP=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class zP{constructor(t,r){var a;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Mb,this.transport=null,this.heartbeatIntervalMs=qp.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=yv,this.ref=0,this.reconnectTimer=null,this.vsn=Yj,this.logger=yv,this.conn=null,this.sendBuffer=[],this.serializer=new UP,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=s=>s?(...i)=>s(...i):(...i)=>fetch(...i),!(!((a=r==null?void 0:r.params)===null||a===void 0)&&a.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${Qb.websocket}`,this.httpEndpoint=aE(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=TP.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const a=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(a),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,a){this.logger(t,r,a)}connectionState(){switch(this.conn&&this.conn.readyState){case xc.connecting:return Nd.Connecting;case xc.open:return Nd.Open;case xc.closing:return Nd.Closing;default:return Nd.Closed}}isConnected(){return this.connectionState()===Nd.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const a=`realtime:${t}`,s=this.getChannels().find(i=>i.topic===a);if(s)return s;{const i=new cA(`realtime:${t}`,r,this);return this.channels.push(i),i}}push(t){const{topic:r,event:a,payload:s,ref:i}=t,o=()=>{this.encode(t,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${r} ${a} (${i})`,s),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(PP,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},qp.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(a=>a.topic===t&&(a._isJoined()||a._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply"&&r.ref&&r.ref===this.pendingHeartbeatRef){const d=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error",d)}catch(u){this.log("error","error in heartbeat callback",u)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:a,event:s,payload:i,ref:o}=r,l=o?`(${o})`:"",c=i.status||"";this.log("receive",`${c} ${a} ${s} ${l}`.trim(),i),this.channels.filter(d=>d._isMember(a)).forEach(d=>d._trigger(s,i,o)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t),this.conn.readyState===xc.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===xc.open||this.conn.readyState===xc.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t);try{this.heartbeatCallback("error")}catch(r){this.log("error","error in heartbeat callback",r)}}_triggerChanError(){this.channels.forEach(t=>t._trigger(co.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const a=t.match(/\?/)?"&":"?",s=new URLSearchParams(r);return`${t}${a}${s}`}_workerObjectUrl(t){let r;if(t)r=t;else{const a=new Blob([WP],{type:"application/javascript"});r=URL.createObjectURL(a)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r,a=!1;if(t)r=t,a=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(s){this.log("error","Error fetching access token from callback",s),r=this.accessTokenValue}else r=this.accessTokenValue;a?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(s=>{const i={access_token:r,version:DP};r&&s.updateJoinPayload(i),s.joinedOnce&&s._isJoined()&&s._push(co.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(a=>{try{a(r)}catch(s){this.log("error",`error in ${t} callback`,s)}})}catch(a){this.log("error",`error triggering ${t} callbacks`,a)}}_setupReconnectionTimer(){this.reconnectTimer=new rE(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},qp.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,a,s,i,o,l,c,d,u,f,h,A;switch(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(a=t==null?void 0:t.timeout)!==null&&a!==void 0?a:Mb,this.heartbeatIntervalMs=(s=t==null?void 0:t.heartbeatIntervalMs)!==null&&s!==void 0?s:qp.HEARTBEAT_INTERVAL,this.worker=(i=t==null?void 0:t.worker)!==null&&i!==void 0?i:!1,this.accessToken=(o=t==null?void 0:t.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(l=t==null?void 0:t.heartbeatCallback)!==null&&l!==void 0?l:yv,this.vsn=(c=t==null?void 0:t.vsn)!==null&&c!==void 0?c:Yj,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(d=t==null?void 0:t.reconnectAfterMs)!==null&&d!==void 0?d:x=>KP[x-1]||VP,this.vsn){case LP:this.encode=(u=t==null?void 0:t.encode)!==null&&u!==void 0?u:(x,p)=>p(JSON.stringify(x)),this.decode=(f=t==null?void 0:t.decode)!==null&&f!==void 0?f:(x,p)=>p(JSON.parse(x));break;case tE:this.encode=(h=t==null?void 0:t.encode)!==null&&h!==void 0?h:this.serializer.encode.bind(this.serializer),this.decode=(A=t==null?void 0:t.decode)!==null&&A!==void 0?A:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}var s0=class extends Error{constructor(e,t){var r;super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&((r=t.icebergType)==null?void 0:r.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function GP(e,t,r){const a=new URL(t,e);if(r)for(const[s,i]of Object.entries(r))i!==void 0&&a.searchParams.set(s,i);return a.toString()}async function XP(e){return!e||e.type==="none"?{}:e.type==="bearer"?{Authorization:`Bearer ${e.token}`}:e.type==="header"?{[e.name]:e.value}:e.type==="custom"?await e.getHeaders():{}}function YP(e){const t=e.fetchImpl??globalThis.fetch;return{async request({method:r,path:a,query:s,body:i,headers:o}){const l=GP(e.baseUrl,a,s),c=await XP(e.auth),d=await t(l,{method:r,headers:{...i?{"Content-Type":"application/json"}:{},...c,...o},body:i?JSON.stringify(i):void 0}),u=await d.text(),f=(d.headers.get("content-type")||"").includes("application/json"),h=f&&u?JSON.parse(u):u;if(!d.ok){const A=f?h:void 0,x=A==null?void 0:A.error;throw new s0((x==null?void 0:x.message)??`Request failed with status ${d.status}`,{status:d.status,icebergType:x==null?void 0:x.type,icebergCode:x==null?void 0:x.code,details:A})}return{status:d.status,headers:d.headers,data:h}}}}function $p(e){return e.join("")}var JP=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:$p(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(a=>({namespace:a}))}async createNamespace(e,t){const r={namespace:e.namespace,properties:t==null?void 0:t.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${$p(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${$p(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${$p(e.namespace)}`}),!0}catch(t){if(t instanceof s0&&t.status===404)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(r){if(r instanceof s0&&r.status===409)return;throw r}}};function ju(e){return e.join("")}var ZP=class{constructor(e,t="",r){this.client=e,this.prefix=t,this.accessDelegation=r}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${ju(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${ju(e.namespace)}/tables`,body:t,headers:r})).data.metadata}async updateTable(e,t){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${ju(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${ju(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String((t==null?void 0:t.purge)??!1)}})}async loadTable(e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${ju(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${ju(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(r){if(r instanceof s0&&r.status===404)return!1;throw r}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(r){if(r instanceof s0&&r.status===409)return await this.loadTable({namespace:e.namespace,name:t.name});throw r}}},eO=class{constructor(e){var a;let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);const r=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=YP({baseUrl:r,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=(a=e.accessDelegation)==null?void 0:a.join(","),this.namespaceOps=new JP(this.client,t),this.tableOps=new ZP(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}},Ux=class extends Error{constructor(e,t="storage",r,a){super(e),this.__isStorageError=!0,this.namespace=t,this.name=t==="vectors"?"StorageVectorsError":"StorageError",this.status=r,this.statusCode=a}};function Rx(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}var Kp=class extends Ux{constructor(e,t,r,a="storage"){super(e,a,t,r),this.name=a==="vectors"?"StorageVectorsApiError":"StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},sE=class extends Ux{constructor(e,t,r="storage"){super(e,r),this.name=r==="vectors"?"StorageVectorsUnknownError":"StorageUnknownError",this.originalError=t}};const tO=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),rO=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},qb=e=>{if(Array.isArray(e))return e.map(r=>qb(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,a])=>{const s=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));t[s]=qb(a)}),t},nO=e=>!e||typeof e!="string"||e.length===0||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(e);function i0(e){"@babel/helpers - typeof";return i0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i0(e)}function aO(e,t){if(i0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(i0(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sO(e){var t=aO(e,"string");return i0(t)=="symbol"?t:t+""}function iO(e,t,r){return(t=sO(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function t5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function ar(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?t5(Object(r),!0).forEach(function(a){iO(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t5(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}const r5=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},oO=async(e,t,r,a)=>{if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!(r!=null&&r.noResolveJson)){const s=e,i=s.status||500;if(typeof s.json=="function")s.json().then(o=>{const l=(o==null?void 0:o.statusCode)||(o==null?void 0:o.code)||i+"";t(new Kp(r5(o),i,l,a))}).catch(()=>{if(a==="vectors"){const o=i+"";t(new Kp(s.statusText||`HTTP ${i} error`,i,o,a))}else{const o=i+"";t(new Kp(s.statusText||`HTTP ${i} error`,i,o,a))}});else{const o=i+"";t(new Kp(s.statusText||`HTTP ${i} error`,i,o,a))}}else t(new sE(r5(e),e,a))},lO=(e,t,r,a)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||e==="HEAD"||!a?ar(ar({},s),r):(rO(a)?(s.headers=ar({"Content-Type":"application/json"},t==null?void 0:t.headers),s.body=JSON.stringify(a)):s.body=a,t!=null&&t.duplex&&(s.duplex=t.duplex),ar(ar({},s),r))};async function Oh(e,t,r,a,s,i,o){return new Promise((l,c)=>{e(r,lO(t,a,s,i)).then(d=>{if(!d.ok)throw d;if(a!=null&&a.noResolveJson)return d;if(o==="vectors"){const u=d.headers.get("content-type");if(d.headers.get("content-length")==="0"||d.status===204)return{};if(!u||!u.includes("application/json"))return{}}return d.json()}).then(d=>l(d)).catch(d=>oO(d,c,a,o))})}function iE(e="storage"){return{get:async(t,r,a,s)=>Oh(t,"GET",r,a,s,void 0,e),post:async(t,r,a,s,i)=>Oh(t,"POST",r,s,i,a,e),put:async(t,r,a,s,i)=>Oh(t,"PUT",r,s,i,a,e),head:async(t,r,a,s)=>Oh(t,"HEAD",r,ar(ar({},a),{},{noResolveJson:!0}),s,void 0,e),remove:async(t,r,a,s,i)=>Oh(t,"DELETE",r,s,i,a,e)}}const cO=iE("storage"),{get:o0,post:oo,put:$b,head:dO,remove:Yw}=cO,di=iE("vectors");var KA=class{constructor(e,t={},r,a="storage"){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.fetch=tO(r),this.namespace=a}throwOnError(){return this.shouldThrowOnError=!0,this}async handleOperation(e){var t=this;try{return{data:await e(),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Rx(r))return{data:null,error:r};throw r}}},uO=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){var e=this;try{return{data:(await e.downloadFn()).body,error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Rx(t))return{data:null,error:t};throw t}}};let oE;oE=Symbol.toStringTag;var AO=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[oE]="BlobDownloadBuilder",this.promise=null}asStream(){return new uO(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var e=this;try{return{data:await(await e.downloadFn()).blob(),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Rx(t))return{data:null,error:t};throw t}}};const hO={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},n5={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var fO=class extends KA{constructor(e,t={},r,a){super(e,t,a,"storage"),this.bucketId=r}async uploadOrUpdate(e,t,r,a){var s=this;return s.handleOperation(async()=>{let i;const o=ar(ar({},n5),a);let l=ar(ar({},s.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob<"u"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),c&&i.append("metadata",s.encodeMetadata(c)),i.append("",r)):typeof FormData<"u"&&r instanceof FormData?(i=r,i.has("cacheControl")||i.append("cacheControl",o.cacheControl),c&&!i.has("metadata")&&i.append("metadata",s.encodeMetadata(c))):(i=r,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,c&&(l["x-metadata"]=s.toBase64(s.encodeMetadata(c))),(typeof ReadableStream<"u"&&i instanceof ReadableStream||i&&typeof i=="object"&&"pipe"in i&&typeof i.pipe=="function")&&!o.duplex&&(o.duplex="half")),a!=null&&a.headers&&(l=ar(ar({},l),a.headers));const d=s._removeEmptyFolders(t),u=s._getFinalPath(d),f=await(e=="PUT"?$b:oo)(s.fetch,`${s.url}/object/${u}`,i,ar({headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{path:d,id:f.Id,fullPath:f.Key}})}async upload(e,t,r){return this.uploadOrUpdate("POST",e,t,r)}async uploadToSignedUrl(e,t,r,a){var s=this;const i=s._removeEmptyFolders(e),o=s._getFinalPath(i),l=new URL(s.url+`/object/upload/sign/${o}`);return l.searchParams.set("token",t),s.handleOperation(async()=>{let c;const d=ar({upsert:n5.upsert},a),u=ar(ar({},s.headers),{"x-upsert":String(d.upsert)});return typeof Blob<"u"&&r instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),c.append("",r)):typeof FormData<"u"&&r instanceof FormData?(c=r,c.append("cacheControl",d.cacheControl)):(c=r,u["cache-control"]=`max-age=${d.cacheControl}`,u["content-type"]=d.contentType),{path:i,fullPath:(await $b(s.fetch,l.toString(),c,{headers:u})).Key}})}async createSignedUploadUrl(e,t){var r=this;return r.handleOperation(async()=>{let a=r._getFinalPath(e);const s=ar({},r.headers);t!=null&&t.upsert&&(s["x-upsert"]="true");const i=await oo(r.fetch,`${r.url}/object/upload/sign/${a}`,{},{headers:s}),o=new URL(r.url+i.url),l=o.searchParams.get("token");if(!l)throw new Ux("No token returned by API");return{signedUrl:o.toString(),path:e,token:l}})}async update(e,t,r){return this.uploadOrUpdate("PUT",e,t,r)}async move(e,t,r){var a=this;return a.handleOperation(async()=>await oo(a.fetch,`${a.url}/object/move`,{bucketId:a.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:a.headers}))}async copy(e,t,r){var a=this;return a.handleOperation(async()=>({path:(await oo(a.fetch,`${a.url}/object/copy`,{bucketId:a.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:a.headers})).Key}))}async createSignedUrl(e,t,r){var a=this;return a.handleOperation(async()=>{let s=a._getFinalPath(e),i=await oo(a.fetch,`${a.url}/object/sign/${s}`,ar({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:a.headers});const o=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{signedUrl:encodeURI(`${a.url}${i.signedURL}${o}`)}})}async createSignedUrls(e,t,r){var a=this;return a.handleOperation(async()=>{const s=await oo(a.fetch,`${a.url}/object/sign/${a.bucketId}`,{expiresIn:t,paths:e},{headers:a.headers}),i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return s.map(o=>ar(ar({},o),{},{signedUrl:o.signedURL?encodeURI(`${a.url}${o.signedURL}${i}`):null}))})}download(e,t){const r=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),s=a?`?${a}`:"",i=this._getFinalPath(e),o=()=>o0(this.fetch,`${this.url}/${r}/${i}${s}`,{headers:this.headers,noResolveJson:!0});return new AO(o,this.shouldThrowOnError)}async info(e){var t=this;const r=t._getFinalPath(e);return t.handleOperation(async()=>qb(await o0(t.fetch,`${t.url}/object/info/${r}`,{headers:t.headers})))}async exists(e){var t=this;const r=t._getFinalPath(e);try{return await dO(t.fetch,`${t.url}/object/${r}`,{headers:t.headers}),{data:!0,error:null}}catch(a){if(t.shouldThrowOnError)throw a;if(Rx(a)&&a instanceof sE){const s=a.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:a}}throw a}}getPublicUrl(e,t){const r=this._getFinalPath(e),a=[],s=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";s!==""&&a.push(s);const i=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",o=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});o!==""&&a.push(o);let l=a.join("&");return l!==""&&(l=`?${l}`),{data:{publicUrl:encodeURI(`${this.url}/${i}/public/${r}${l}`)}}}async remove(e){var t=this;return t.handleOperation(async()=>await Yw(t.fetch,`${t.url}/object/${t.bucketId}`,{prefixes:e},{headers:t.headers}))}async list(e,t,r){var a=this;return a.handleOperation(async()=>{const s=ar(ar(ar({},hO),t),{},{prefix:e||""});return await oo(a.fetch,`${a.url}/object/list/${a.bucketId}`,s,{headers:a.headers},r)})}async listV2(e,t){var r=this;return r.handleOperation(async()=>{const a=ar({},e);return await oo(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,a,{headers:r.headers},t)})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}};const pO="2.93.3",O0={"X-Client-Info":`storage-js/${pO}`};var mO=class extends KA{constructor(e,t={},r,a){const s=new URL(e);a!=null&&a.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase."));const i=s.href.replace(/\/$/,""),o=ar(ar({},O0),t);super(i,o,r,"storage")}async listBuckets(e){var t=this;return t.handleOperation(async()=>{const r=t.listBucketOptionsToQueryString(e);return await o0(t.fetch,`${t.url}/bucket${r}`,{headers:t.headers})})}async getBucket(e){var t=this;return t.handleOperation(async()=>await o0(t.fetch,`${t.url}/bucket/${e}`,{headers:t.headers}))}async createBucket(e,t={public:!1}){var r=this;return r.handleOperation(async()=>await oo(r.fetch,`${r.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}))}async updateBucket(e,t){var r=this;return r.handleOperation(async()=>await $b(r.fetch,`${r.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}))}async emptyBucket(e){var t=this;return t.handleOperation(async()=>await oo(t.fetch,`${t.url}/bucket/${e}/empty`,{},{headers:t.headers}))}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await Yw(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}))}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},gO=class extends KA{constructor(e,t={},r){const a=e.replace(/\/$/,""),s=ar(ar({},O0),t);super(a,s,r,"storage")}async createBucket(e){var t=this;return t.handleOperation(async()=>await oo(t.fetch,`${t.url}/bucket`,{name:e},{headers:t.headers}))}async listBuckets(e){var t=this;return t.handleOperation(async()=>{const r=new URLSearchParams;(e==null?void 0:e.limit)!==void 0&&r.set("limit",e.limit.toString()),(e==null?void 0:e.offset)!==void 0&&r.set("offset",e.offset.toString()),e!=null&&e.sortColumn&&r.set("sortColumn",e.sortColumn),e!=null&&e.sortOrder&&r.set("sortOrder",e.sortOrder),e!=null&&e.search&&r.set("search",e.search);const a=r.toString(),s=a?`${t.url}/bucket?${a}`:`${t.url}/bucket`;return await o0(t.fetch,s,{headers:t.headers})})}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await Yw(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}))}from(e){var t=this;if(!nO(e))throw new Ux("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new eO({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),a=this.shouldThrowOnError;return new Proxy(r,{get(s,i){const o=s[i];return typeof o!="function"?o:async(...l)=>{try{return{data:await o.apply(s,l),error:null}}catch(c){if(a)throw c;return{data:null,error:c}}}}})}},xO=class extends KA{constructor(e,t={},r){const a=e.replace(/\/$/,""),s=ar(ar({},O0),{},{"Content-Type":"application/json"},t);super(a,s,r,"vectors")}async createIndex(e){var t=this;return t.handleOperation(async()=>await di.post(t.fetch,`${t.url}/CreateIndex`,e,{headers:t.headers})||{})}async getIndex(e,t){var r=this;return r.handleOperation(async()=>await di.post(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers}))}async listIndexes(e){var t=this;return t.handleOperation(async()=>await di.post(t.fetch,`${t.url}/ListIndexes`,e,{headers:t.headers}))}async deleteIndex(e,t){var r=this;return r.handleOperation(async()=>await di.post(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers})||{})}},yO=class extends KA{constructor(e,t={},r){const a=e.replace(/\/$/,""),s=ar(ar({},O0),{},{"Content-Type":"application/json"},t);super(a,s,r,"vectors")}async putVectors(e){var t=this;if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return t.handleOperation(async()=>await di.post(t.fetch,`${t.url}/PutVectors`,e,{headers:t.headers})||{})}async getVectors(e){var t=this;return t.handleOperation(async()=>await di.post(t.fetch,`${t.url}/GetVectors`,e,{headers:t.headers}))}async listVectors(e){var t=this;if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return t.handleOperation(async()=>await di.post(t.fetch,`${t.url}/ListVectors`,e,{headers:t.headers}))}async queryVectors(e){var t=this;return t.handleOperation(async()=>await di.post(t.fetch,`${t.url}/QueryVectors`,e,{headers:t.headers}))}async deleteVectors(e){var t=this;if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return t.handleOperation(async()=>await di.post(t.fetch,`${t.url}/DeleteVectors`,e,{headers:t.headers})||{})}},vO=class extends KA{constructor(e,t={},r){const a=e.replace(/\/$/,""),s=ar(ar({},O0),{},{"Content-Type":"application/json"},t);super(a,s,r,"vectors")}async createBucket(e){var t=this;return t.handleOperation(async()=>await di.post(t.fetch,`${t.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{})}async getBucket(e){var t=this;return t.handleOperation(async()=>await di.post(t.fetch,`${t.url}/GetVectorBucket`,{vectorBucketName:e},{headers:t.headers}))}async listBuckets(e={}){var t=this;return t.handleOperation(async()=>await di.post(t.fetch,`${t.url}/ListVectorBuckets`,e,{headers:t.headers}))}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await di.post(t.fetch,`${t.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{})}},bO=class extends vO{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new _O(this.url,this.headers,e,this.fetch)}async createBucket(e){var t=()=>super.createBucket,r=this;return t().call(r,e)}async getBucket(e){var t=()=>super.getBucket,r=this;return t().call(r,e)}async listBuckets(e={}){var t=()=>super.listBuckets,r=this;return t().call(r,e)}async deleteBucket(e){var t=()=>super.deleteBucket,r=this;return t().call(r,e)}},_O=class extends xO{constructor(e,t,r,a){super(e,t,a),this.vectorBucketName=r}async createIndex(e){var t=()=>super.createIndex,r=this;return t().call(r,ar(ar({},e),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(e={}){var t=()=>super.listIndexes,r=this;return t().call(r,ar(ar({},e),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(e){var t=()=>super.getIndex,r=this;return t().call(r,r.vectorBucketName,e)}async deleteIndex(e){var t=()=>super.deleteIndex,r=this;return t().call(r,r.vectorBucketName,e)}index(e){return new wO(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},wO=class extends yO{constructor(e,t,r,a,s){super(e,t,s),this.vectorBucketName=r,this.indexName=a}async putVectors(e){var t=()=>super.putVectors,r=this;return t().call(r,ar(ar({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(e){var t=()=>super.getVectors,r=this;return t().call(r,ar(ar({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(e={}){var t=()=>super.listVectors,r=this;return t().call(r,ar(ar({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(e){var t=()=>super.queryVectors,r=this;return t().call(r,ar(ar({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(e){var t=()=>super.deleteVectors,r=this;return t().call(r,ar(ar({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},NO=class extends mO{constructor(e,t={},r,a){super(e,t,r,a)}from(e){return new fO(this.url,this.headers,e,this.fetch)}get vectors(){return new bO(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new gO(this.url+"/iceberg",this.headers,this.fetch)}};const lE="2.93.3",$u=30*1e3,Kb=3,vv=Kb*$u,jO="http://localhost:9999",kO="supabase.auth.token",CO={"X-Client-Info":`gotrue-js/${lE}`},Vb="X-Supabase-Api-Version",cE={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},SO=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,BO=10*60*1e3;class l0 extends Error{constructor(t,r,a){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=a}}function Gt(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class EO extends l0{constructor(t,r,a){super(t,r,a),this.name="AuthApiError",this.status=r,this.code=a}}function FO(e){return Gt(e)&&e.name==="AuthApiError"}class jd extends l0{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class ql extends l0{constructor(t,r,a,s){super(t,a,s),this.name=r,this.status=a}}class si extends ql{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function bv(e){return Gt(e)&&e.name==="AuthSessionMissingError"}class ku extends ql{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Vp extends ql{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Wp extends ql{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function TO(e){return Gt(e)&&e.name==="AuthImplicitGrantRedirectError"}class a5 extends ql{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class IO extends ql{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class Wb extends ql{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function _v(e){return Gt(e)&&e.name==="AuthRetryableFetchError"}class s5 extends ql{constructor(t,r,a){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=a}}class zb extends ql{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Pg="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),i5=` 	
\r=`.split(""),DO=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<i5.length;t+=1)e[i5[t].charCodeAt(0)]=-2;for(let t=0;t<Pg.length;t+=1)e[Pg[t].charCodeAt(0)]=t;return e})();function o5(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const a=t.queue>>t.queuedBits-6&63;r(Pg[a]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const a=t.queue>>t.queuedBits-6&63;r(Pg[a]),t.queuedBits-=6}}function dE(e,t,r){const a=DO[e];if(a>-1)for(t.queue=t.queue<<6|a,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(a===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function l5(e){const t=[],r=o=>{t.push(String.fromCodePoint(o))},a={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},i=o=>{OO(o,a,r)};for(let o=0;o<e.length;o+=1)dE(e.charCodeAt(o),s,i);return t.join("")}function LO(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function PO(e,t){for(let r=0;r<e.length;r+=1){let a=e.charCodeAt(r);if(a>55295&&a<=56319){const s=(a-55296)*1024&65535;a=(e.charCodeAt(r+1)-56320&65535|s)+65536,r+=1}LO(a,t)}}function OO(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let a=1;a<6;a+=1)if(!(e>>7-a&1)){t.utf8seq=a;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function yA(e){const t=[],r={queue:0,queuedBits:0},a=s=>{t.push(s)};for(let s=0;s<e.length;s+=1)dE(e.charCodeAt(s),r,a);return new Uint8Array(t)}function UO(e){const t=[];return PO(e,r=>t.push(r)),new Uint8Array(t)}function Td(e){const t=[],r={queue:0,queuedBits:0},a=s=>{t.push(s)};return e.forEach(s=>o5(s,r,a)),o5(null,r,a),t.join("")}function RO(e){return Math.round(Date.now()/1e3)+e}function MO(){return Symbol("auth-callback")}const Qa=()=>typeof window<"u"&&typeof document<"u",md={tested:!1,writable:!1},uE=()=>{if(!Qa())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(md.tested)return md.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),md.tested=!0,md.writable=!0}catch{md.tested=!0,md.writable=!1}return md.writable};function QO(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((s,i)=>{t[i]=s})}catch{}return r.searchParams.forEach((a,s)=>{t[s]=a}),t}const AE=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),HO=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Ku=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},gd=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Ma=async(e,t)=>{await e.removeItem(t)};class Mx{constructor(){this.promise=new Mx.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Mx.promiseConstructor=Promise;function zp(e){const t=e.split(".");if(t.length!==3)throw new zb("Invalid JWT structure");for(let a=0;a<t.length;a++)if(!SO.test(t[a]))throw new zb("JWT not in base64url format");return{header:JSON.parse(l5(t[0])),payload:JSON.parse(l5(t[1])),signature:yA(t[2]),raw:{header:t[0],payload:t[1]}}}async function qO(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function $O(e,t){return new Promise((a,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await e(i);if(!t(i,null,o)){a(o);return}}catch(o){if(!t(i,o)){s(o);return}}})()})}function KO(e){return("0"+e.toString(16)).substr(-2)}function VO(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",a=r.length;let s="";for(let i=0;i<56;i++)s+=r.charAt(Math.floor(Math.random()*a));return s}return crypto.getRandomValues(t),Array.from(t,KO).join("")}async function WO(e){const r=new TextEncoder().encode(e),a=await crypto.subtle.digest("SHA-256",r),s=new Uint8Array(a);return Array.from(s).map(i=>String.fromCharCode(i)).join("")}async function zO(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await WO(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Cu(e,t,r=!1){const a=VO();let s=a;r&&(s+="/PASSWORD_RECOVERY"),await Ku(e,`${t}-code-verifier`,s);const i=await zO(a);return[i,a===i?"plain":"s256"]}const GO=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function XO(e){const t=e.headers.get(Vb);if(!t||!t.match(GO))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function YO(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function JO(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const ZO=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Su(e){if(!ZO.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function wv(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const a=r.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function eU(e,t){return new Proxy(e,{get:(r,a,s)=>{if(a==="__isInsecureUserWarningProxy")return!0;if(typeof a=="symbol"){const i=a.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)"||i==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,a,s)}return!t.value&&typeof a=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,a,s)}})}function c5(e){return JSON.parse(JSON.stringify(e))}const bd=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),tU=[502,503,504];async function d5(e){var t;if(!HO(e))throw new Wb(bd(e),0);if(tU.includes(e.status))throw new Wb(bd(e),e.status);let r;try{r=await e.json()}catch(i){throw new jd(bd(i),i)}let a;const s=XO(e);if(s&&s.getTime()>=cE["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?a=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(a=r.error_code),a){if(a==="weak_password")throw new s5(bd(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(a==="session_not_found")throw new si}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new s5(bd(r),e.status,r.weak_password.reasons);throw new EO(bd(r),e.status||500,a)}const rU=(e,t,r,a)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),s.body=JSON.stringify(a),Object.assign(Object.assign({},s),r))};async function rr(e,t,r,a){var s;const i=Object.assign({},a==null?void 0:a.headers);i[Vb]||(i[Vb]=cE["2024-01-01"].name),a!=null&&a.jwt&&(i.Authorization=`Bearer ${a.jwt}`);const o=(s=a==null?void 0:a.query)!==null&&s!==void 0?s:{};a!=null&&a.redirectTo&&(o.redirect_to=a.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await nU(e,t,r+l,{headers:i,noResolveJson:a==null?void 0:a.noResolveJson},{},a==null?void 0:a.body);return a!=null&&a.xform?a==null?void 0:a.xform(c):{data:Object.assign({},c),error:null}}async function nU(e,t,r,a,s,i){const o=rU(t,a,s,i);let l;try{l=await e(r,Object.assign({},o))}catch(c){throw console.error(c),new Wb(bd(c),0)}if(l.ok||await d5(l),a!=null&&a.noResolveJson)return l;try{return await l.json()}catch(c){await d5(c)}}function no(e){var t;let r=null;iU(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=RO(e.expires_in)));const a=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:a},error:null}}function u5(e){const t=no(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,a)=>r&&typeof a=="string",!0)&&(t.data.weak_password=e.weak_password),t}function _c(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function aU(e){return{data:e,error:null}}function sU(e){const{action_link:t,email_otp:r,hashed_token:a,redirect_to:s,verification_type:i}=e,o=Ox(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:t,email_otp:r,hashed_token:a,redirect_to:s,verification_type:i},c=Object.assign({},o);return{data:{properties:l,user:c},error:null}}function A5(e){return e}function iU(e){return e.access_token&&e.refresh_token&&e.expires_in}const Nv=["global","local","others"];class oU{constructor({url:t="",headers:r={},fetch:a}){this.url=t,this.headers=r,this.fetch=AE(a),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=Nv[0]){if(Nv.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Nv.join(", ")}`);try{return await rr(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(a){if(Gt(a))return{data:null,error:a};throw a}}async inviteUserByEmail(t,r={}){try{return await rr(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:_c})}catch(a){if(Gt(a))return{data:{user:null},error:a};throw a}}async generateLink(t){try{const{options:r}=t,a=Ox(t,["options"]),s=Object.assign(Object.assign({},a),r);return"newEmail"in a&&(s.new_email=a==null?void 0:a.newEmail,delete s.newEmail),await rr(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:sU,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Gt(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await rr(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:_c})}catch(r){if(Gt(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,a,s,i,o,l,c;try{const d={nextPage:null,lastPage:0,total:0},u=await rr(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&a!==void 0?a:"",per_page:(i=(s=t==null?void 0:t.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:A5});if(u.error)throw u.error;const f=await u.json(),h=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,A=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return A.length>0&&(A.forEach(x=>{const p=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),b=JSON.parse(x.split(";")[1].split("=")[1]);d[`${b}Page`]=p}),d.total=parseInt(h)),{data:Object.assign(Object.assign({},f),d),error:null}}catch(d){if(Gt(d))return{data:{users:[]},error:d};throw d}}async getUserById(t){Su(t);try{return await rr(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:_c})}catch(r){if(Gt(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){Su(t);try{return await rr(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:_c})}catch(a){if(Gt(a))return{data:{user:null},error:a};throw a}}async deleteUser(t,r=!1){Su(t);try{return await rr(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:_c})}catch(a){if(Gt(a))return{data:{user:null},error:a};throw a}}async _listFactors(t){Su(t.userId);try{const{data:r,error:a}=await rr(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:r,error:a}}catch(r){if(Gt(r))return{data:null,error:r};throw r}}async _deleteFactor(t){Su(t.userId),Su(t.id);try{return{data:await rr(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Gt(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,a,s,i,o,l,c;try{const d={nextPage:null,lastPage:0,total:0},u=await rr(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&a!==void 0?a:"",per_page:(i=(s=t==null?void 0:t.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:A5});if(u.error)throw u.error;const f=await u.json(),h=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,A=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return A.length>0&&(A.forEach(x=>{const p=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),b=JSON.parse(x.split(";")[1].split("=")[1]);d[`${b}Page`]=p}),d.total=parseInt(h)),{data:Object.assign(Object.assign({},f),d),error:null}}catch(d){if(Gt(d))return{data:{clients:[]},error:d};throw d}}async _createOAuthClient(t){try{return await rr(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Gt(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await rr(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Gt(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await rr(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:a=>({data:a,error:null})})}catch(a){if(Gt(a))return{data:null,error:a};throw a}}async _deleteOAuthClient(t){try{return await rr(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Gt(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await rr(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Gt(r))return{data:null,error:r};throw r}}}function h5(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const Bu={debug:!!(globalThis&&uE()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class hE extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class lU extends hE{}async function cU(e,t,r){Bu.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const a=new globalThis.AbortController;return t>0&&setTimeout(()=>{a.abort(),Bu.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:a.signal},async s=>{if(s){Bu.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,s.name);try{return await r()}finally{Bu.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,s.name)}}else{if(t===0)throw Bu.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new lU(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Bu.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function dU(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function fE(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function uU(e){return parseInt(e,16)}function AU(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,a=>a.toString(16).padStart(2,"0")).join("")}function hU(e){var t;const{chainId:r,domain:a,expirationTime:s,issuedAt:i=new Date,nonce:o,notBefore:l,requestId:c,resources:d,scheme:u,uri:f,version:h}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!a)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!f)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(h!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${h}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const A=fE(e.address),x=u?`${u}://${a}`:a,p=e.statement?`${e.statement}
`:"",b=`${x} wants you to sign in with your Ethereum account:
${A}

${p}`;let m=`URI: ${f}
Version: ${h}
Chain ID: ${r}${o?`
Nonce: ${o}`:""}
Issued At: ${i.toISOString()}`;if(s&&(m+=`
Expiration Time: ${s.toISOString()}`),l&&(m+=`
Not Before: ${l.toISOString()}`),c&&(m+=`
Request ID: ${c}`),d){let g=`
Resources:`;for(const y of d){if(!y||typeof y!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${y}`);g+=`
- ${y}`}m+=g}return`${b}
${m}`}class oa extends Error{constructor({message:t,code:r,cause:a,name:s}){var i;super(t,{cause:a}),this.__isWebAuthnError=!0,this.name=(i=s??(a instanceof Error?a.name:void 0))!==null&&i!==void 0?i:"Unknown Error",this.code=r}}class Og extends oa{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function fU({error:e,options:t}){var r,a,s;const{publicKey:i}=t;if(!i)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new oa({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=i.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new oa({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((a=i.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new oa({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((s=i.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new oa({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new oa({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new oa({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return i.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new oa({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new oa({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const o=window.location.hostname;if(pE(o)){if(i.rp.id!==o)return new oa({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new oa({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new oa({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new oa({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new oa({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function pU({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new oa({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new oa({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const a=window.location.hostname;if(pE(a)){if(r.rpId!==a)return new oa({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new oa({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new oa({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new oa({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class mU{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const gU=new mU;function xU(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:a}=e,s=Ox(e,["challenge","user","excludeCredentials"]),i=yA(t).buffer,o=Object.assign(Object.assign({},r),{id:yA(r.id).buffer}),l=Object.assign(Object.assign({},s),{challenge:i,user:o});if(a&&a.length>0){l.excludeCredentials=new Array(a.length);for(let c=0;c<a.length;c++){const d=a[c];l.excludeCredentials[c]=Object.assign(Object.assign({},d),{id:yA(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return l}function yU(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,a=Ox(e,["challenge","allowCredentials"]),s=yA(t).buffer,i=Object.assign(Object.assign({},a),{challenge:s});if(r&&r.length>0){i.allowCredentials=new Array(r.length);for(let o=0;o<r.length;o++){const l=r[o];i.allowCredentials[o]=Object.assign(Object.assign({},l),{id:yA(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return i}function vU(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:Td(new Uint8Array(e.response.attestationObject)),clientDataJSON:Td(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function bU(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,a=e.getClientExtensionResults(),s=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:Td(new Uint8Array(s.authenticatorData)),clientDataJSON:Td(new Uint8Array(s.clientDataJSON)),signature:Td(new Uint8Array(s.signature)),userHandle:s.userHandle?Td(new Uint8Array(s.userHandle)):void 0},type:"public-key",clientExtensionResults:a,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function pE(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function f5(){var e,t;return!!(Qa()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function _U(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Og("Browser returned unexpected credential type",t)}:{data:null,error:new Og("Empty credential response",t)}}catch(t){return{data:null,error:fU({error:t,options:e})}}}async function wU(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Og("Browser returned unexpected credential type",t)}:{data:null,error:new Og("Empty credential response",t)}}catch(t){return{data:null,error:pU({error:t,options:e})}}}const NU={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},jU={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Ug(...e){const t=s=>s!==null&&typeof s=="object"&&!Array.isArray(s),r=s=>s instanceof ArrayBuffer||ArrayBuffer.isView(s),a={};for(const s of e)if(s)for(const i in s){const o=s[i];if(o!==void 0)if(Array.isArray(o))a[i]=o;else if(r(o))a[i]=o;else if(t(o)){const l=a[i];t(l)?a[i]=Ug(l,o):a[i]=Ug(o)}else a[i]=o}return a}function kU(e,t){return Ug(NU,e,t||{})}function CU(e,t){return Ug(jU,e,t||{})}class SU{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:a,signal:s},i){var o;try{const{data:l,error:c}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!l)return{data:null,error:c};const d=s??gU.createNewAbortSignal();if(l.webauthn.type==="create"){const{user:u}=l.webauthn.credential_options.publicKey;if(!u.name){const f=a;if(f)u.name=`${u.id}:${f}`;else{const A=(await this.client.getUser()).data.user,x=((o=A==null?void 0:A.user_metadata)===null||o===void 0?void 0:o.name)||(A==null?void 0:A.email)||(A==null?void 0:A.id)||"User";u.name=`${u.id}:${x}`}}u.displayName||(u.displayName=u.name)}switch(l.webauthn.type){case"create":{const u=kU(l.webauthn.credential_options.publicKey,i==null?void 0:i.create),{data:f,error:h}=await _U({publicKey:u,signal:d});return f?{data:{factorId:t,challengeId:l.id,webauthn:{type:l.webauthn.type,credential_response:f}},error:null}:{data:null,error:h}}case"request":{const u=CU(l.webauthn.credential_options.publicKey,i==null?void 0:i.request),{data:f,error:h}=await wU(Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:u,signal:d}));return f?{data:{factorId:t,challengeId:l.id,webauthn:{type:l.webauthn.type,credential_response:f}},error:null}:{data:null,error:h}}}}catch(l){return Gt(l)?{data:null,error:l}:{data:null,error:new jd("Unexpected error in challenge",l)}}}async _verify({challengeId:t,factorId:r,webauthn:a}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:a})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:a=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},i){if(!r)return{data:null,error:new l0("rpId is required for WebAuthn authentication")};try{if(!f5())return{data:null,error:new jd("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:a},signal:s},{request:i});if(!o)return{data:null,error:l};const{webauthn:c}=o;return this._verify({factorId:t,challengeId:o.challengeId,webauthn:{type:c.type,rpId:r,rpOrigins:a,credential_response:c.credential_response}})}catch(o){return Gt(o)?{data:null,error:o}:{data:null,error:new jd("Unexpected error in authenticate",o)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:a=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},i){if(!r)return{data:null,error:new l0("rpId is required for WebAuthn registration")};try{if(!f5())return{data:null,error:new jd("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this._enroll({friendlyName:t});if(!o)return await this.client.mfa.listFactors().then(u=>{var f;return(f=u.data)===null||f===void 0?void 0:f.all.find(h=>h.factor_type==="webauthn"&&h.friendly_name===t&&h.status!=="unverified")}).then(u=>u?this.client.mfa.unenroll({factorId:u==null?void 0:u.id}):void 0),{data:null,error:l};const{data:c,error:d}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:r,rpOrigins:a},signal:s},{create:i});return c?this._verify({factorId:o.id,challengeId:c.challengeId,webauthn:{rpId:r,rpOrigins:a,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:d}}catch(o){return Gt(o)?{data:null,error:o}:{data:null,error:new jd("Unexpected error in register",o)}}}}dU();const BU={url:jO,storageKey:kO,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:CO,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function p5(e,t,r){return await r()}const Eu={};class c0{get jwks(){var t,r;return(r=(t=Eu[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){Eu[this.storageKey]=Object.assign(Object.assign({},Eu[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=Eu[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Eu[this.storageKey]=Object.assign(Object.assign({},Eu[this.storageKey]),{cachedAt:t})}constructor(t){var r,a,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const i=Object.assign(Object.assign({},BU),t);if(this.storageKey=i.storageKey,this.instanceID=(r=c0.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,c0.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.instanceID>0&&Qa()){const o=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(o),this.logDebugMessages&&console.trace(o)}if(this.persistSession=i.persistSession,this.autoRefreshToken=i.autoRefreshToken,this.admin=new oU({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=AE(i.fetch),this.lock=i.lock||p5,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,this.throwOnError=i.throwOnError,this.lockAcquireTimeout=i.lockAcquireTimeout,i.lock?this.lock=i.lock:this.persistSession&&Qa()&&(!((a=globalThis==null?void 0:globalThis.navigator)===null||a===void 0)&&a.locks)?this.lock=cU:this.lock=p5,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new SU(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:uE()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=h5(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=h5(this.memoryStorage)),Qa()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o);try{await this._notifyAllSubscribers(o.data.event,o.data.session,!1)}catch(l){this._debug("#broadcastChannel","error",l)}})}this.initialize().catch(o=>{this._debug("#initialize()","error",o)})}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${lE}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},a="none";if(Qa()&&(r=QO(window.location.href),this._isImplicitGrantCallback(r)?a="implicit":await this._isPKCECallback(r)&&(a="pkce")),Qa()&&this.detectSessionInUrl&&a!=="none"){const{data:s,error:i}=await this._getSessionFromURL(r,a);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),TO(i)){const c=(t=i.details)===null||t===void 0?void 0:t.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:i}}return{error:i}}const{session:o,redirectType:l}=s;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Gt(r)?this._returnResult({error:r}):this._returnResult({error:new jd("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,a,s;try{const i=await rr(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(a=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&a!==void 0?a:{},gotrue_meta_security:{captcha_token:(s=t==null?void 0:t.options)===null||s===void 0?void 0:s.captchaToken}},xform:no}),{data:o,error:l}=i;if(l||!o)return this._returnResult({data:{user:null,session:null},error:l});const c=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(i){if(Gt(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signUp(t){var r,a,s;try{let i;if("email"in t){const{email:u,password:f,options:h}=t;let A=null,x=null;this.flowType==="pkce"&&([A,x]=await Cu(this.storage,this.storageKey)),i=await rr(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:u,password:f,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:A,code_challenge_method:x},xform:no})}else if("phone"in t){const{phone:u,password:f,options:h}=t;i=await rr(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:f,data:(a=h==null?void 0:h.data)!==null&&a!==void 0?a:{},channel:(s=h==null?void 0:h.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:no})}else throw new Vp("You must provide either an email or phone number and a password");const{data:o,error:l}=i;if(l||!o)return await Ma(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:l});const c=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(i){if(await Ma(this.storage,`${this.storageKey}-code-verifier`),Gt(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithPassword(t){try{let r;if("email"in t){const{email:i,password:o,options:l}=t;r=await rr(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:u5})}else if("phone"in t){const{phone:i,password:o,options:l}=t;r=await rr(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:u5})}else throw new Vp("You must provide either an email or phone number and a password");const{data:a,error:s}=r;if(s)return this._returnResult({data:{user:null,session:null},error:s});if(!a||!a.session||!a.user){const i=new ku;return this._returnResult({data:{user:null,session:null},error:i})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:Object.assign({user:a.user,session:a.session},a.weak_password?{weakPassword:a.weak_password}:null),error:s})}catch(r){if(Gt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,a,s,i;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(a=t.options)===null||a===void 0?void 0:a.scopes,queryParams:(s=t.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=t.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,a,s,i,o,l,c,d,u,f,h;let A,x;if("message"in t)A=t.message,x=t.signature;else{const{chain:p,wallet:b,statement:m,options:g}=t;let y;if(Qa())if(typeof b=="object")y=b;else{const E=window;if("ethereum"in E&&typeof E.ethereum=="object"&&"request"in E.ethereum&&typeof E.ethereum.request=="function")y=E.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof b!="object"||!(g!=null&&g.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");y=b}const v=new URL((r=g==null?void 0:g.url)!==null&&r!==void 0?r:window.location.href),_=await y.request({method:"eth_requestAccounts"}).then(E=>E).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!_||_.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const j=fE(_[0]);let N=(a=g==null?void 0:g.signInWithEthereum)===null||a===void 0?void 0:a.chainId;if(!N){const E=await y.request({method:"eth_chainId"});N=uU(E)}const B={domain:v.host,address:j,statement:m,uri:v.href,version:"1",chainId:N,nonce:(s=g==null?void 0:g.signInWithEthereum)===null||s===void 0?void 0:s.nonce,issuedAt:(o=(i=g==null?void 0:g.signInWithEthereum)===null||i===void 0?void 0:i.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(l=g==null?void 0:g.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(c=g==null?void 0:g.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(d=g==null?void 0:g.signInWithEthereum)===null||d===void 0?void 0:d.requestId,resources:(u=g==null?void 0:g.signInWithEthereum)===null||u===void 0?void 0:u.resources};A=hU(B),x=await y.request({method:"personal_sign",params:[AU(A),j]})}try{const{data:p,error:b}=await rr(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:A,signature:x},!((f=t.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(h=t.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:no});if(b)throw b;if(!p||!p.session||!p.user){const m=new ku;return this._returnResult({data:{user:null,session:null},error:m})}return p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("SIGNED_IN",p.session)),this._returnResult({data:Object.assign({},p),error:b})}catch(p){if(Gt(p))return this._returnResult({data:{user:null,session:null},error:p});throw p}}async signInWithSolana(t){var r,a,s,i,o,l,c,d,u,f,h,A;let x,p;if("message"in t)x=t.message,p=t.signature;else{const{chain:b,wallet:m,statement:g,options:y}=t;let v;if(Qa())if(typeof m=="object")v=m;else{const j=window;if("solana"in j&&typeof j.solana=="object"&&("signIn"in j.solana&&typeof j.solana.signIn=="function"||"signMessage"in j.solana&&typeof j.solana.signMessage=="function"))v=j.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof m!="object"||!(y!=null&&y.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");v=m}const _=new URL((r=y==null?void 0:y.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in v&&v.signIn){const j=await v.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},y==null?void 0:y.signInWithSolana),{version:"1",domain:_.host,uri:_.href}),g?{statement:g}:null));let N;if(Array.isArray(j)&&j[0]&&typeof j[0]=="object")N=j[0];else if(j&&typeof j=="object"&&"signedMessage"in j&&"signature"in j)N=j;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in N&&"signature"in N&&(typeof N.signedMessage=="string"||N.signedMessage instanceof Uint8Array)&&N.signature instanceof Uint8Array)x=typeof N.signedMessage=="string"?N.signedMessage:new TextDecoder().decode(N.signedMessage),p=N.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in v)||typeof v.signMessage!="function"||!("publicKey"in v)||typeof v!="object"||!v.publicKey||!("toBase58"in v.publicKey)||typeof v.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");x=[`${_.host} wants you to sign in with your Solana account:`,v.publicKey.toBase58(),...g?["",g,""]:[""],"Version: 1",`URI: ${_.href}`,`Issued At: ${(s=(a=y==null?void 0:y.signInWithSolana)===null||a===void 0?void 0:a.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((i=y==null?void 0:y.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${y.signInWithSolana.notBefore}`]:[],...!((o=y==null?void 0:y.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${y.signInWithSolana.expirationTime}`]:[],...!((l=y==null?void 0:y.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${y.signInWithSolana.chainId}`]:[],...!((c=y==null?void 0:y.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${y.signInWithSolana.nonce}`]:[],...!((d=y==null?void 0:y.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${y.signInWithSolana.requestId}`]:[],...!((f=(u=y==null?void 0:y.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||f===void 0)&&f.length?["Resources",...y.signInWithSolana.resources.map(N=>`- ${N}`)]:[]].join(`
`);const j=await v.signMessage(new TextEncoder().encode(x),"utf8");if(!j||!(j instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");p=j}}try{const{data:b,error:m}=await rr(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:x,signature:Td(p)},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(A=t.options)===null||A===void 0?void 0:A.captchaToken}}:null),xform:no});if(m)throw m;if(!b||!b.session||!b.user){const g=new ku;return this._returnResult({data:{user:null,session:null},error:g})}return b.session&&(await this._saveSession(b.session),await this._notifyAllSubscribers("SIGNED_IN",b.session)),this._returnResult({data:Object.assign({},b),error:m})}catch(b){if(Gt(b))return this._returnResult({data:{user:null,session:null},error:b});throw b}}async _exchangeCodeForSession(t){const r=await gd(this.storage,`${this.storageKey}-code-verifier`),[a,s]=(r??"").split("/");try{if(!a&&this.flowType==="pkce")throw new IO;const{data:i,error:o}=await rr(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:a},xform:no});if(await Ma(this.storage,`${this.storageKey}-code-verifier`),o)throw o;if(!i||!i.session||!i.user){const l=new ku;return this._returnResult({data:{user:null,session:null,redirectType:null},error:l})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign(Object.assign({},i),{redirectType:s??null}),error:o})}catch(i){if(await Ma(this.storage,`${this.storageKey}-code-verifier`),Gt(i))return this._returnResult({data:{user:null,session:null,redirectType:null},error:i});throw i}}async signInWithIdToken(t){try{const{options:r,provider:a,token:s,access_token:i,nonce:o}=t,l=await rr(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:a,id_token:s,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:no}),{data:c,error:d}=l;if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!c||!c.session||!c.user){const u=new ku;return this._returnResult({data:{user:null,session:null},error:u})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:c,error:d})}catch(r){if(Gt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,a,s,i,o;try{if("email"in t){const{email:l,options:c}=t;let d=null,u=null;this.flowType==="pkce"&&([d,u]=await Cu(this.storage,this.storageKey));const{error:f}=await rr(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(a=c==null?void 0:c.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:d,code_challenge_method:u},redirectTo:c==null?void 0:c.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:f})}if("phone"in t){const{phone:l,options:c}=t,{data:d,error:u}=await rr(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(s=c==null?void 0:c.data)!==null&&s!==void 0?s:{},create_user:(i=c==null?void 0:c.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(o=c==null?void 0:c.channel)!==null&&o!==void 0?o:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:u})}throw new Vp("You must provide either an email or phone number.")}catch(l){if(await Ma(this.storage,`${this.storageKey}-code-verifier`),Gt(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async verifyOtp(t){var r,a;try{let s,i;"options"in t&&(s=(r=t.options)===null||r===void 0?void 0:r.redirectTo,i=(a=t.options)===null||a===void 0?void 0:a.captchaToken);const{data:o,error:l}=await rr(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:no});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,d=o.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(s){if(Gt(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithSSO(t){var r,a,s,i,o;try{let l=null,c=null;this.flowType==="pkce"&&([l,c]=await Cu(this.storage,this.storageKey));const d=await rr(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&a!==void 0?a:void 0}),!((s=t==null?void 0:t.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:c}),headers:this.headers,xform:aU});return!((i=d.data)===null||i===void 0)&&i.url&&Qa()&&!(!((o=t.options)===null||o===void 0)&&o.skipBrowserRedirect)&&window.location.assign(d.data.url),this._returnResult(d)}catch(l){if(await Ma(this.storage,`${this.storageKey}-code-verifier`),Gt(l))return this._returnResult({data:null,error:l});throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:a}=t;if(a)throw a;if(!r)throw new si;const{error:s}=await rr(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:s})})}catch(t){if(Gt(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:a,type:s,options:i}=t,{error:o}=await rr(this.fetch,"POST",r,{headers:this.headers,body:{email:a,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}else if("phone"in t){const{phone:a,type:s,options:i}=t,{data:o,error:l}=await rr(this.fetch,"POST",r,{headers:this.headers,body:{phone:a,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l})}throw new Vp("You must provide either an email or phone number and a type")}catch(r){if(Gt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const a=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await a,await r()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const a=r();for(this.pendingInLock.push((async()=>{try{await a}catch{}})()),await a;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await a}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await gd(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const a=t.expires_at?t.expires_at*1e3-Date.now()<vv:!1;if(this._debug("#__loadSession()",`session has${a?"":" not"} expired`,"expires_at",t.expires_at),!a){if(this.userStorage){const o=await gd(this.userStorage,this.storageKey+"-user");o!=null&&o.user?t.user=o.user:t.user=wv()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const o={value:this.suppressGetSessionWarning};t.user=eU(t.user,o),o.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:s,error:i}=await this._callRefreshToken(t.refresh_token);return i?this._returnResult({data:{session:null},error:i}):this._returnResult({data:{session:s},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){if(t)return await this._getUser(t);await this.initializePromise;const r=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(t){try{return t?await rr(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:_c}):await this._useSession(async r=>{var a,s,i;const{data:o,error:l}=r;if(l)throw l;return!(!((a=o.session)===null||a===void 0)&&a.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new si}:await rr(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0,xform:_c})})}catch(r){if(Gt(r))return bv(r)&&(await this._removeSession(),await Ma(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async a=>{const{data:s,error:i}=a;if(i)throw i;if(!s.session)throw new si;const o=s.session;let l=null,c=null;this.flowType==="pkce"&&t.email!=null&&([l,c]=await Cu(this.storage,this.storageKey));const{data:d,error:u}=await rr(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:l,code_challenge_method:c}),jwt:o.access_token,xform:_c});if(u)throw u;return o.user=d.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),this._returnResult({data:{user:o.user},error:null})})}catch(a){if(await Ma(this.storage,`${this.storageKey}-code-verifier`),Gt(a))return this._returnResult({data:{user:null},error:a});throw a}}async setSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new si;const r=Date.now()/1e3;let a=r,s=!0,i=null;const{payload:o}=zp(t.access_token);if(o.exp&&(a=o.exp,s=a<=r),s){const{data:l,error:c}=await this._callRefreshToken(t.refresh_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l)return{data:{user:null,session:null},error:null};i=l}else{const{data:l,error:c}=await this._getUser(t.access_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});i={access_token:t.access_token,refresh_token:t.refresh_token,user:l.user,token_type:"bearer",expires_in:a-r,expires_at:a},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return this._returnResult({data:{user:i.user,session:i},error:null})}catch(r){if(Gt(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var a;if(!t){const{data:o,error:l}=r;if(l)throw l;t=(a=o.session)!==null&&a!==void 0?a:void 0}if(!(t!=null&&t.refresh_token))throw new si;const{data:s,error:i}=await this._callRefreshToken(t.refresh_token);return i?this._returnResult({data:{user:null,session:null},error:i}):s?this._returnResult({data:{user:s.user,session:s},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(Gt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!Qa())throw new Wp("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Wp(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new a5("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Wp("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new a5("No code detected.");const{data:g,error:y}=await this._exchangeCodeForSession(t.code);if(y)throw y;const v=new URL(window.location.href);return v.searchParams.delete("code"),window.history.replaceState(window.history.state,"",v.toString()),{data:{session:g.session,redirectType:null},error:null}}const{provider_token:a,provider_refresh_token:s,access_token:i,refresh_token:o,expires_in:l,expires_at:c,token_type:d}=t;if(!i||!l||!o||!d)throw new Wp("No session defined in URL");const u=Math.round(Date.now()/1e3),f=parseInt(l);let h=u+f;c&&(h=parseInt(c));const A=h-u;A*1e3<=$u&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${A}s, should have been closer to ${f}s`);const x=h-f;u-x>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",x,h,u):u-x<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",x,h,u);const{data:p,error:b}=await this._getUser(i);if(b)throw b;const m={provider_token:a,provider_refresh_token:s,access_token:i,expires_in:f,expires_at:h,refresh_token:o,token_type:d,user:p.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:m,redirectType:t.type},error:null})}catch(a){if(Gt(a))return this._returnResult({data:{session:null,redirectType:null},error:a});throw a}}_isImplicitGrantCallback(t){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),t):!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await gd(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var a;const{data:s,error:i}=r;if(i&&!bv(i))return this._returnResult({error:i});const o=(a=s.session)===null||a===void 0?void 0:a.access_token;if(o){const{error:l}=await this.admin.signOut(o,t);if(l&&!(FO(l)&&(l.status===404||l.status===401||l.status===403)||bv(l)))return this._returnResult({error:l})}return t!=="others"&&(await this._removeSession(),await Ma(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=MO(),a={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,a),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:a}}}async _emitInitialSession(t){return await this._useSession(async r=>{var a,s;try{const{data:{session:i},error:o}=r;if(o)throw o;await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",t,"session",i)}catch(i){await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",i),console.error(i)}})}async resetPasswordForEmail(t,r={}){let a=null,s=null;this.flowType==="pkce"&&([a,s]=await Cu(this.storage,this.storageKey,!0));try{return await rr(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:a,code_challenge_method:s,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(await Ma(this.storage,`${this.storageKey}-code-verifier`),Gt(i))return this._returnResult({data:null,error:i});throw i}}async getUserIdentities(){var t;try{const{data:r,error:a}=await this.getUser();if(a)throw a;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(Gt(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:a,error:s}=await this._useSession(async i=>{var o,l,c,d,u;const{data:f,error:h}=i;if(h)throw h;const A=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(o=t.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=t.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await rr(this.fetch,"GET",A,{headers:this.headers,jwt:(u=(d=f.session)===null||d===void 0?void 0:d.access_token)!==null&&u!==void 0?u:void 0})});if(s)throw s;return Qa()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(a==null?void 0:a.url),this._returnResult({data:{provider:t.provider,url:a==null?void 0:a.url},error:null})}catch(a){if(Gt(a))return this._returnResult({data:{provider:t.provider,url:null},error:a});throw a}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var a;try{const{error:s,data:{session:i}}=r;if(s)throw s;const{options:o,provider:l,token:c,access_token:d,nonce:u}=t,f=await rr(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(a=i==null?void 0:i.access_token)!==null&&a!==void 0?a:void 0,body:{provider:l,id_token:c,access_token:d,nonce:u,link_identity:!0,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:no}),{data:h,error:A}=f;return A?this._returnResult({data:{user:null,session:null},error:A}):!h||!h.session||!h.user?this._returnResult({data:{user:null,session:null},error:new ku}):(h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("USER_UPDATED",h.session)),this._returnResult({data:h,error:A}))}catch(s){if(await Ma(this.storage,`${this.storageKey}-code-verifier`),Gt(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var a,s;const{data:i,error:o}=r;if(o)throw o;return await rr(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(s=(a=i.session)===null||a===void 0?void 0:a.access_token)!==null&&s!==void 0?s:void 0})})}catch(r){if(Gt(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const a=Date.now();return await $O(async s=>(s>0&&await qO(200*Math.pow(2,s-1)),this._debug(r,"refreshing attempt",s),await rr(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:no})),(s,i)=>{const o=200*Math.pow(2,s);return i&&_v(i)&&Date.now()+o-a<$u})}catch(a){if(this._debug(r,"error",a),Gt(a))return this._returnResult({data:{session:null,user:null},error:a});throw a}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const a=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",a),Qa()&&!r.skipBrowserRedirect&&window.location.assign(a),{data:{provider:t,url:a},error:null}}async _recoverAndRefresh(){var t,r;const a="#_recoverAndRefresh()";this._debug(a,"begin");try{const s=await gd(this.storage,this.storageKey);if(s&&this.userStorage){let o=await gd(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:s.user},await Ku(this.userStorage,this.storageKey+"-user",o)),s.user=(t=o==null?void 0:o.user)!==null&&t!==void 0?t:wv()}else if(s&&!s.user&&!s.user){const o=await gd(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(s.user=o.user,await Ma(this.storage,this.storageKey+"-user"),await Ku(this.storage,this.storageKey,s)):s.user=wv()}if(this._debug(a,"session from storage",s),!this._isValidSession(s)){this._debug(a,"session is not valid"),s!==null&&await this._removeSession();return}const i=((r=s.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<vv;if(this._debug(a,`session has${i?"":" not"} expired with margin of ${vv}s`),i){if(this.autoRefreshToken&&s.refresh_token){const{error:o}=await this._callRefreshToken(s.refresh_token);o&&(console.error(o),_v(o)||(this._debug(a,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=await this._getUser(s.access_token);!l&&(o!=null&&o.user)?(s.user=o.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(a,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(a,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(a,"error",s),console.error(s);return}finally{this._debug(a,"end")}}async _callRefreshToken(t){var r,a;if(!t)throw new si;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new Mx;const{data:i,error:o}=await this._refreshAccessToken(t);if(o)throw o;if(!i.session)throw new si;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const l={data:i.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(i){if(this._debug(s,"error",i),Gt(i)){const o={data:null,error:i};return _v(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(a=this.refreshingDeferred)===null||a===void 0||a.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(t,r,a=!0){const s=`#_notifyAllSubscribers(${t})`;this._debug(s,"begin",r,`broadcast = ${a}`);try{this.broadcastChannel&&a&&this.broadcastChannel.postMessage({event:t,session:r});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(t,r)}catch(c){i.push(c)}});if(await Promise.all(o),i.length>0){for(let l=0;l<i.length;l+=1)console.error(i[l]);throw i[0]}}finally{this._debug(s,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await Ma(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},t),a=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!a&&r.user&&await Ku(this.userStorage,this.storageKey+"-user",{user:r.user});const s=Object.assign({},r);delete s.user;const i=c5(s);await Ku(this.storage,this.storageKey,i)}else{const s=c5(r);await Ku(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await Ma(this.storage,this.storageKey),await Ma(this.storage,this.storageKey+"-code-verifier"),await Ma(this.storage,this.storageKey+"-user"),this.userStorage&&await Ma(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Qa()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),$u);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t);const r=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t);const r=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,r&&clearTimeout(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:a}}=r;if(!a||!a.refresh_token||!a.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((a.expires_at*1e3-t)/$u);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${$u}ms, refresh threshold is ${Kb} ticks`),s<=Kb&&await this._callRefreshToken(a.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof hE)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Qa()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>{try{await this._onVisibilityChanged(!1)}catch(t){this._debug("#visibilityChangedCallback","error",t)}},window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,a){const s=[`provider=${encodeURIComponent(r)}`];if(a!=null&&a.redirectTo&&s.push(`redirect_to=${encodeURIComponent(a.redirectTo)}`),a!=null&&a.scopes&&s.push(`scopes=${encodeURIComponent(a.scopes)}`),this.flowType==="pkce"){const[i,o]=await Cu(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});s.push(l.toString())}if(a!=null&&a.queryParams){const i=new URLSearchParams(a.queryParams);s.push(i.toString())}return a!=null&&a.skipBrowserRedirect&&s.push(`skip_http_redirect=${a.skipBrowserRedirect}`),`${t}?${s.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var a;const{data:s,error:i}=r;return i?this._returnResult({data:null,error:i}):await rr(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(a=s==null?void 0:s.session)===null||a===void 0?void 0:a.access_token})})}catch(r){if(Gt(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var a,s;const{data:i,error:o}=r;if(o)return this._returnResult({data:null,error:o});const l=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:c,error:d}=await rr(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(a=i==null?void 0:i.session)===null||a===void 0?void 0:a.access_token});return d?this._returnResult({data:null,error:d}):(t.factorType==="totp"&&c.type==="totp"&&(!((s=c==null?void 0:c.totp)===null||s===void 0)&&s.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),this._returnResult({data:c,error:null}))})}catch(r){if(Gt(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var a;const{data:s,error:i}=r;if(i)return this._returnResult({data:null,error:i});const o=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?vU(t.webauthn.credential_response):bU(t.webauthn.credential_response)})}:{code:t.code}),{data:l,error:c}=await rr(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:o,headers:this.headers,jwt:(a=s==null?void 0:s.session)===null||a===void 0?void 0:a.access_token});return c?this._returnResult({data:null,error:c}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:c}))})}catch(r){if(Gt(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var a;const{data:s,error:i}=r;if(i)return this._returnResult({data:null,error:i});const o=await rr(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(a=s==null?void 0:s.session)===null||a===void 0?void 0:a.access_token});if(o.error)return o;const{data:l}=o;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:xU(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:yU(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(Gt(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:a}=await this._challenge({factorId:t.factorId});return a?this._returnResult({data:null,error:a}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:a}=await this.getUser();if(a)return{data:null,error:a};const s={all:[],phone:[],totp:[],webauthn:[]};for(const i of(t=r==null?void 0:r.factors)!==null&&t!==void 0?t:[])s.all.push(i),i.status==="verified"&&s[i.factor_type].push(i);return{data:s,error:null}}async _getAuthenticatorAssuranceLevel(t){var r,a,s,i;if(t)try{const{payload:A}=zp(t);let x=null;A.aal&&(x=A.aal);let p=x;const{data:{user:b},error:m}=await this.getUser(t);if(m)return this._returnResult({data:null,error:m});((a=(r=b==null?void 0:b.factors)===null||r===void 0?void 0:r.filter(v=>v.status==="verified"))!==null&&a!==void 0?a:[]).length>0&&(p="aal2");const y=A.amr||[];return{data:{currentLevel:x,nextLevel:p,currentAuthenticationMethods:y},error:null}}catch(A){if(Gt(A))return this._returnResult({data:null,error:A});throw A}const{data:{session:o},error:l}=await this.getSession();if(l)return this._returnResult({data:null,error:l});if(!o)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:c}=zp(o.access_token);let d=null;c.aal&&(d=c.aal);let u=d;((i=(s=o.user.factors)===null||s===void 0?void 0:s.filter(A=>A.status==="verified"))!==null&&i!==void 0?i:[]).length>0&&(u="aal2");const h=c.amr||[];return{data:{currentLevel:d,nextLevel:u,currentAuthenticationMethods:h},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:a},error:s}=r;return s?this._returnResult({data:null,error:s}):a?await rr(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:a.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new si})})}catch(r){if(Gt(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async a=>{const{data:{session:s},error:i}=a;if(i)return this._returnResult({data:null,error:i});if(!s)return this._returnResult({data:null,error:new si});const o=await rr(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"approve"},xform:l=>({data:l,error:null})});return o.data&&o.data.redirect_url&&Qa()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(a){if(Gt(a))return this._returnResult({data:null,error:a});throw a}}async _denyAuthorization(t,r){try{return await this._useSession(async a=>{const{data:{session:s},error:i}=a;if(i)return this._returnResult({data:null,error:i});if(!s)return this._returnResult({data:null,error:new si});const o=await rr(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"deny"},xform:l=>({data:l,error:null})});return o.data&&o.data.redirect_url&&Qa()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(a){if(Gt(a))return this._returnResult({data:null,error:a});throw a}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:r},error:a}=t;return a?this._returnResult({data:null,error:a}):r?await rr(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new si})})}catch(t){if(Gt(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async r=>{const{data:{session:a},error:s}=r;return s?this._returnResult({data:null,error:s}):a?(await rr(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:a.access_token,query:{client_id:t.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new si})})}catch(r){if(Gt(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(t,r={keys:[]}){let a=r.keys.find(l=>l.kid===t);if(a)return a;const s=Date.now();if(a=this.jwks.keys.find(l=>l.kid===t),a&&this.jwks_cached_at+BO>s)return a;const{data:i,error:o}=await rr(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=s,a=i.keys.find(l=>l.kid===t),!a)?null:a}async getClaims(t,r={}){try{let a=t;if(!a){const{data:A,error:x}=await this.getSession();if(x||!A.session)return this._returnResult({data:null,error:x});a=A.session.access_token}const{header:s,payload:i,signature:o,raw:{header:l,payload:c}}=zp(a);r!=null&&r.allowExpired||YO(i.exp);const d=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!d){const{error:A}=await this.getUser(a);if(A)throw A;return{data:{claims:i,header:s,signature:o},error:null}}const u=JO(s.alg),f=await crypto.subtle.importKey("jwk",d,u,!0,["verify"]);if(!await crypto.subtle.verify(u,f,o,UO(`${l}.${c}`)))throw new zb("Invalid JWT signature");return{data:{claims:i,header:s,signature:o},error:null}}catch(a){if(Gt(a))return this._returnResult({data:null,error:a});throw a}}}c0.nextInstanceID={};const EU=c0,FU="2.93.3";let nf="";typeof Deno<"u"?nf="deno":typeof document<"u"?nf="web":typeof navigator<"u"&&navigator.product==="ReactNative"?nf="react-native":nf="node";const TU={"X-Client-Info":`supabase-js-${nf}/${FU}`},IU={headers:TU},DU={schema:"public"},LU={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},PU={};function d0(e){"@babel/helpers - typeof";return d0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d0(e)}function OU(e,t){if(d0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(d0(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function UU(e){var t=OU(e,"string");return d0(t)=="symbol"?t:t+""}function RU(e,t,r){return(t=UU(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function m5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function Ln(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?m5(Object(r),!0).forEach(function(a){RU(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m5(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}const MU=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),QU=()=>Headers,HU=(e,t,r)=>{const a=MU(r),s=QU();return async(i,o)=>{var l;const c=(l=await t())!==null&&l!==void 0?l:e;let d=new s(o==null?void 0:o.headers);return d.has("apikey")||d.set("apikey",e),d.has("Authorization")||d.set("Authorization",`Bearer ${c}`),a(i,Ln(Ln({},o),{},{headers:d}))}};function qU(e){return e.endsWith("/")?e:e+"/"}function $U(e,t){var r,a;const{db:s,auth:i,realtime:o,global:l}=e,{db:c,auth:d,realtime:u,global:f}=t,h={db:Ln(Ln({},c),s),auth:Ln(Ln({},d),i),realtime:Ln(Ln({},u),o),storage:{},global:Ln(Ln(Ln({},f),l),{},{headers:Ln(Ln({},(r=f==null?void 0:f.headers)!==null&&r!==void 0?r:{}),(a=l==null?void 0:l.headers)!==null&&a!==void 0?a:{})}),accessToken:async()=>""};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}function KU(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(qU(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var VU=class extends EU{constructor(e){super(e)}},WU=class{constructor(e,t,r){var a,s;this.supabaseUrl=e,this.supabaseKey=t;const i=KU(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",i),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",i),this.storageUrl=new URL("storage/v1",i),this.functionsUrl=new URL("functions/v1",i);const o=`sb-${i.hostname.split(".")[0]}-auth-token`,l={db:DU,realtime:PU,auth:Ln(Ln({},LU),{},{storageKey:o}),global:IU},c=$U(r??{},l);if(this.storageKey=(a=c.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(s=c.global.headers)!==null&&s!==void 0?s:{},c.accessToken)this.accessToken=c.accessToken,this.auth=new Proxy({},{get:(u,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}});else{var d;this.auth=this._initSupabaseAuthClient((d=c.auth)!==null&&d!==void 0?d:{},this.headers,c.global.fetch)}this.fetch=HU(t,this._getAccessToken.bind(this),c.global.fetch),this.realtime=this._initRealtimeClient(Ln({headers:this.headers,accessToken:this._getAccessToken.bind(this)},c.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(u=>this.realtime.setAuth(u)).catch(u=>console.warn("Failed to set initial Realtime auth token:",u)),this.rest=new FP(new URL("rest/v1",i).href,{headers:this.headers,schema:c.db.schema,fetch:this.fetch}),this.storage=new NO(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),c.accessToken||this._listenForAuthEvents()}get functions(){return new kP(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e=this,t,r;if(e.accessToken)return await e.accessToken();const{data:a}=await e.auth.getSession();return(t=(r=a.session)===null||r===void 0?void 0:r.access_token)!==null&&t!==void 0?t:e.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:a,userStorage:s,storageKey:i,flowType:o,lock:l,debug:c,throwOnError:d},u,f){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new VU({url:this.authUrl.href,headers:Ln(Ln({},h),u),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:a,userStorage:s,flowType:o,lock:l,debug:c,throwOnError:d,fetch:f,hasCustomAuthorizationHeader:Object.keys(this.headers).some(A=>A.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new zP(this.realtimeUrl.href,Ln(Ln({},e),{},{params:Ln(Ln({},{apikey:this.supabaseKey}),e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",t==null?void 0:t.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const zU=(e,t,r)=>new WU(e,t,r);function GU(){if(typeof window<"u")return!1;const e=globalThis.process;if(!e)return!1;const t=e.version;if(t==null)return!1;const r=t.match(/^v(\d+)\./);return r?parseInt(r[1],10)<=18:!1}GU()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const XU="https://dkrtsqienlhpouohmfki.supabase.co",YU="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRrcnRzcWllbmxocG91b2htZmtpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE5MTQxNzQsImV4cCI6MjA3NzQ5MDE3NH0.Kjo9RU0WAfQSSEm2vTWmuN5BIYk_hvanKDQkm5qdCGY",Z=zU(XU,YU),mE=Q.createContext(void 0);function JU({children:e}){const[t,r]=Q.useState(null),[a,s]=Q.useState(null),[i,o]=Q.useState(!0);Q.useEffect(()=>{Z.auth.getSession().then(({data:{session:h}})=>{r((h==null?void 0:h.user)??null),h!=null&&h.user?l(h.user.id):o(!1)});const{data:{subscription:f}}=Z.auth.onAuthStateChange((h,A)=>{r((A==null?void 0:A.user)??null),A!=null&&A.user?l(A.user.id):(s(null),o(!1))});return()=>f.unsubscribe()},[]);const l=async f=>{try{const{data:h,error:A}=await Z.from("user_profiles").select("*").eq("id",f).maybeSingle();if(A)throw A;s(h)}catch(h){console.error("Error loading profile:",h)}finally{o(!1)}},c=async(f,h)=>{let A=f;if(!f.includes("@")){const{data:p,error:b}=await Z.from("user_profiles").select("email, username, is_active").eq("username",f.toLowerCase()).maybeSingle();if(b)throw new Error("Invalid username or password");if(!p)throw new Error("Invalid username or password");if(!p.is_active)throw new Error("Account is inactive. Please contact administrator.");A=p.email}const{error:x}=await Z.auth.signInWithPassword({email:A,password:h});if(x)throw x},d=async(f,h,A,x)=>{const{data:p,error:b}=await Z.auth.signUp({email:f,password:h});if(b)throw b;if(p.user){const{error:m}=await Z.from("user_profiles").insert({id:p.user.id,email:f,full_name:A,role:x,language:"en",is_active:!0});if(m)throw m}},u=async()=>{const{error:f}=await Z.auth.signOut();if(f)throw f};return n.jsx(mE.Provider,{value:{user:t,profile:a,loading:i,signIn:c,signUp:d,signOut:u},children:e})}function Cr(){const e=Q.useContext(mE);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e}const g5={en:{common:{search:"Search",filter:"Filter",export:"Export",add:"Add",edit:"Edit",delete:"Delete",save:"Save",cancel:"Cancel",close:"Close",submit:"Submit",actions:"Actions",loading:"Loading...",noData:"No data available",confirm:"Confirm",yes:"Yes",no:"No",success:"Success",error:"Error",warning:"Warning"},auth:{login:"Login",logout:"Logout",email:"Email",password:"Password",signIn:"Sign In",signOut:"Sign Out",welcomeBack:"Welcome Back",enterCredentials:"Enter your credentials to continue"},nav:{dashboard:"Dashboard",products:"Products",stock:"Stock",batches:"Batches",inventory:"Inventory",customers:"Customers",crm:"CRM",deliveryChallan:"Delivery Challan",sales:"Sales",finance:"Finance",materialReturns:"Material Returns",stockRejections:"Stock Rejections",approvals:"Approvals",settings:"Settings",users:"Users"},commandCenter:{title:"CRM Command Center",subtitle:"Ultra-fast inquiry processing with AI automation",emailList:"Email Inbox",inquiryForm:"Inquiry Form",quickActions:"Quick Actions",todaysActions:"Today's Actions",parseEmail:"Parse Email",parsing:"Parsing...",autoFilled:"Auto-filled by AI",confidence:"Confidence",saveInquiry:"Save Inquiry",saving:"Saving...",sendPrice:"Send Price",sendCOA:"Send COA",sendMSDS:"Send MSDS",sendSample:"Send Sample",logActivity:"Log Activity",noEmailSelected:"Select an email to parse",noInquirySelected:"Select an inquiry for quick actions",selectEmail:"Select an email from the list",emailFrom:"From",emailDate:"Date",requestedItems:"Requested",priority:"Priority",activityType:"Activity Type",activityOutcome:"Outcome",activityNotes:"Notes",dueReminders:"Due Reminders",upcomingFollowups:"Upcoming Follow-ups",recentActivity:"Recent Activity",viewAll:"View All",noReminders:"No due reminders",noFollowups:"No upcoming follow-ups",noActivity:"No recent activity",priorities:{low:"Low",medium:"Medium",high:"High",urgent:"Urgent"},statuses:{new:"New Inquiry",price_quoted:"Price Quoted",coa_pending:"COA Pending",sample_sent:"Sample Sent",negotiation:"Negotiation",po_received:"PO Received",won:"Won",lost:"Lost"},activities:{email_sent:"Email Sent",phone_call:"Phone Call",meeting:"Meeting",document_sent:"Document Sent",follow_up:"Follow-up",note:"Note"},outcomes:{positive:"Positive",neutral:"Neutral",negative:"Negative",pending:"Pending Response"}},dashboard:{title:"Dashboard",totalProducts:"Total Products",lowStock:"Low Stock Items",nearExpiry:"Near Expiry",totalCustomers:"Total Customers",salesThisMonth:"Sales This Month",revenueThisMonth:"Revenue This Month",profitThisMonth:"Profit This Month",pendingFollowUps:"Pending Follow-ups"},products:{title:"Products",addProduct:"Add Product",editProduct:"Edit Product",productName:"Product Name",productCode:"Product Code",hsnCode:"HSN Code",category:"Category",unit:"Unit",packagingType:"Packaging Type",defaultSupplier:"Default Supplier",description:"Description",uploadFiles:"Upload Files",categories:{api:"API",excipient:"Excipient",solvent:"Solvent",other:"Other"},units:{kg:"Kilogram",litre:"Litre",ton:"Ton",piece:"Piece"}},batches:{title:"Batches",addBatch:"Add Batch",editBatch:"Edit Batch",batchNumber:"Batch Number",product:"Product",importDate:"Import Date",importQuantity:"Import Quantity",currentStock:"Current Stock",packagingDetails:"Packaging Details",importPrice:"Import Price",dutyCharges:"Duty Charges",freightCharges:"Freight Charges",otherCharges:"Other Charges",totalCost:"Total Cost",costPerUnit:"Cost Per Unit",expiryDate:"Expiry Date",warehouseLocation:"Warehouse Location",uploadDocuments:"Upload Documents"},inventory:{title:"Inventory",stockSummary:"Stock Summary",batchWiseStock:"Batch-wise Stock",lowStockAlert:"Low Stock Alert",expiryAlert:"Expiry Alert",stockMovement:"Stock Movement",adjustStock:"Adjust Stock"},customers:{title:"Customers",addCustomer:"Add Customer",editCustomer:"Edit Customer",customerName:"Customer Name",companyName:"Company Name",npwp:"NPWP (Tax ID)",address:"Address",city:"City",country:"Country",contactPerson:"Contact Person",email:"Email",phone:"Phone",gstVatType:"GST/VAT Type",paymentTerms:"Payment Terms"},crm:{title:"CRM",leads:"Leads",activities:"Activities",addLead:"Add Lead",editLead:"Edit Lead",companyName:"Company Name",contactPerson:"Contact Person",productInterest:"Product Interest",quantityInterest:"Quantity Interest",leadSource:"Lead Source",status:"Status",assignedTo:"Assigned To",expectedCloseDate:"Expected Close Date",estimatedValue:"Estimated Value",addActivity:"Add Activity",followUp:"Follow-up",statuses:{inquiry:"Inquiry",quotation:"Quotation",negotiation:"Negotiation",won:"Won",lost:"Lost"}},sales:{title:"Sales",invoices:"Invoices",createInvoice:"Create Invoice",invoiceNumber:"Invoice Number",customer:"Customer",invoiceDate:"Invoice Date",dueDate:"Due Date",items:"Items",addItem:"Add Item",quantity:"Quantity",unitPrice:"Unit Price",taxRate:"Tax Rate",subtotal:"Subtotal",tax:"Tax",discount:"Discount",total:"Total",paymentStatus:"Payment Status",deliveryChallan:"Delivery Challan",generatePDF:"Generate PDF",sendEmail:"Send Email"},salesOrders:{title:"Sales Orders",createSalesOrder:"Create Sales Order",customerPoNumber:"Customer PO Number",customerPoDate:"Customer PO Date",soDate:"Sales Order Date",expectedDeliveryDate:"Expected Delivery Date",uploadPo:"Upload Customer PO",product:"Product",freeStock:"Free Stock",discountPercent:"Discount %",taxPercent:"Tax %",lineTotal:"Line Total",itemDeliveryDate:"Item Delivery Date",notes:"Notes",grandTotal:"Grand Total",saveAsDraft:"Save as Draft",submitForApproval:"Submit for Approval"},finance:{title:"Finance",dashboard:"Dashboard",expenses:"Expenses",reports:"Reports",importCosts:"Import Costs",salesRevenue:"Sales Revenue",grossProfit:"Gross Profit",profitMargin:"Profit Margin",addExpense:"Add Expense",expenseCategory:"Category",amount:"Amount",expenseDate:"Date",vouchers:"VOUCHERS",books:"BOOKS",masters:"MASTERS",purchase:"Purchase",receipt:"Receipt",payment:"Payment",journal:"Journal",contra:"Contra",pettyCash:"Petty Cash",ledger:"Ledger",journalRegister:"Journal Register",bankLedger:"Bank Ledger",partyLedger:"Party Ledger",bankReconciliation:"Bank Reconciliation",caReports:"CA Reports (Excel)",trialBalance:"Trial Balance",profitLoss:"Profit & Loss",balanceSheet:"Balance Sheet",receivables:"Receivables",payables:"Payables",ageing:"Ageing",taxReports:"Tax Reports",chartOfAccounts:"Chart of Accounts",suppliers:"Suppliers",banks:"Banks",dateRange:"Date Range",from:"From",to:"To",financialYear:"Financial Year",voucherNumber:"Voucher Number",voucherDate:"Voucher Date",accountName:"Account Name",accountCode:"Account Code",debit:"Debit",credit:"Credit",narration:"Narration",particulars:"Particulars",closingBalance:"Closing Balance",openingBalance:"Opening Balance",assets:"Assets",liabilities:"Liabilities",income:"Income",expense:"Expense",equity:"Equity",outstandingSummary:"Outstanding Summary",totalReceivables:"Total Receivables",totalPayables:"Total Payables",netPosition:"Net Position",bankAccount:"Bank Account",bankName:"Bank Name",accountNumber:"Account Number",ifscCode:"IFSC Code",branch:"Branch",reconcile:"Reconcile",supplierName:"Supplier Name",supplierCode:"Supplier Code",contactPerson:"Contact Person",taxInvoice:"Tax Invoice",ppn:"PPN",pph:"PPh",taxAmount:"Tax Amount",addNew:"Add New",viewDetails:"View Details",printVoucher:"Print Voucher",downloadExcel:"Download Excel",purchaseInvoice:"Purchase Invoice",invoiceDetails:"Invoice Details",supplierInvoiceNumber:"Supplier Invoice Number",supplierInvoiceDate:"Supplier Invoice Date",dueDate:"Due Date",selectSupplier:"Select Supplier",addItems:"Add Items",selectProduct:"Select Product",selectBatch:"Select Batch",price:"Price",taxRate:"Tax Rate",totalAmount:"Total Amount",searchPlaceholder:"Search by invoice number or supplier...",noInvoices:"No invoices found",receiptVoucher:"Receipt Voucher",paymentVoucher:"Payment Voucher",referenceNumber:"Reference Number",paymentMode:"Payment Mode",chequeNumber:"Cheque Number",chequeDate:"Cheque Date",bank:"Bank",cash:"Cash",expenseDetails:"Expense Details",expenseType:"Expense Type",vendor:"Vendor",billNumber:"Bill Number",uploadBill:"Upload Bill",pettyCashDetails:"Petty Cash Details",pettyCashVoucher:"Petty Cash Voucher",itemDetails:"Item Details",removeItem:"Remove Item",addItem:"Add Item",grandTotal:"Grand Total",notes:"Notes",attachments:"Attachments"},settings:{title:"Settings",companyProfile:"Company Profile",taxSettings:"Tax Settings",emailSettings:"Email Settings",systemSettings:"System Settings",companyName:"Company Name",companyAddress:"Company Address",companyPhone:"Company Phone",companyEmail:"Company Email",companyTaxId:"Company Tax ID",defaultTaxRate:"Default Tax Rate",invoicePrefix:"Invoice Prefix",lowStockThreshold:"Low Stock Threshold",expiryAlertDays:"Expiry Alert Days"}},id:{common:{search:"Cari",filter:"Filter",export:"Ekspor",add:"Tambah",edit:"Edit",delete:"Hapus",save:"Simpan",cancel:"Batal",close:"Tutup",submit:"Kirim",actions:"Aksi",loading:"Memuat...",noData:"Tidak ada data",confirm:"Konfirmasi",yes:"Ya",no:"Tidak",success:"Berhasil",error:"Error",warning:"Peringatan"},auth:{login:"Masuk",logout:"Keluar",email:"Email",password:"Kata Sandi",signIn:"Masuk",signOut:"Keluar",welcomeBack:"Selamat Datang Kembali",enterCredentials:"Masukkan kredensial Anda untuk melanjutkan"},nav:{dashboard:"Dasbor",products:"Produk",stock:"Stok",batches:"Batch",inventory:"Inventaris",customers:"Pelanggan",crm:"CRM",deliveryChallan:"Surat Jalan",sales:"Penjualan",finance:"Keuangan",materialReturns:"Pengembalian Material",stockRejections:"Penolakan Stok",approvals:"Persetujuan",settings:"Pengaturan",users:"Pengguna"},commandCenter:{title:"Pusat Komando CRM",subtitle:"Pemrosesan pertanyaan ultra-cepat dengan otomasi AI",emailList:"Kotak Masuk Email",inquiryForm:"Formulir Pertanyaan",quickActions:"Aksi Cepat",todaysActions:"Aksi Hari Ini",parseEmail:"Parse Email",parsing:"Memproses...",autoFilled:"Diisi otomatis oleh AI",confidence:"Kepercayaan",saveInquiry:"Simpan Pertanyaan",saving:"Menyimpan...",sendPrice:"Kirim Harga",sendCOA:"Kirim COA",sendMSDS:"Kirim MSDS",sendSample:"Kirim Sample",logActivity:"Catat Aktivitas",noEmailSelected:"Pilih email untuk diproses",noInquirySelected:"Pilih pertanyaan untuk aksi cepat",selectEmail:"Pilih email dari daftar",emailFrom:"Dari",emailDate:"Tanggal",requestedItems:"Diminta",priority:"Prioritas",activityType:"Jenis Aktivitas",activityOutcome:"Hasil",activityNotes:"Catatan",dueReminders:"Pengingat Jatuh Tempo",upcomingFollowups:"Tindak Lanjut Mendatang",recentActivity:"Aktivitas Terbaru",viewAll:"Lihat Semua",noReminders:"Tidak ada pengingat jatuh tempo",noFollowups:"Tidak ada tindak lanjut mendatang",noActivity:"Tidak ada aktivitas terbaru",priorities:{low:"Rendah",medium:"Sedang",high:"Tinggi",urgent:"Mendesak"},statuses:{new:"Pertanyaan Baru",price_quoted:"Harga Dikutip",coa_pending:"COA Tertunda",sample_sent:"Sample Terkirim",negotiation:"Negosiasi",po_received:"PO Diterima",won:"Menang",lost:"Kalah"},activities:{email_sent:"Email Terkirim",phone_call:"Panggilan Telepon",meeting:"Pertemuan",document_sent:"Dokumen Terkirim",follow_up:"Tindak Lanjut",note:"Catatan"},outcomes:{positive:"Positif",neutral:"Netral",negative:"Negatif",pending:"Menunggu Respons"}},dashboard:{title:"Dasbor",totalProducts:"Total Produk",lowStock:"Stok Rendah",nearExpiry:"Mendekati Kadaluarsa",totalCustomers:"Total Pelanggan",salesThisMonth:"Penjualan Bulan Ini",revenueThisMonth:"Pendapatan Bulan Ini",profitThisMonth:"Laba Bulan Ini",pendingFollowUps:"Follow-up Tertunda"},products:{title:"Produk",addProduct:"Tambah Produk",editProduct:"Edit Produk",productName:"Nama Produk",productCode:"Kode Produk",hsnCode:"Kode HSN",category:"Kategori",unit:"Satuan",packagingType:"Jenis Kemasan",defaultSupplier:"Pemasok Default",description:"Deskripsi",uploadFiles:"Unggah File",categories:{api:"API",excipient:"Excipient",solvent:"Pelarut",other:"Lainnya"},units:{kg:"Kilogram",litre:"Liter",ton:"Ton",piece:"Buah"}},batches:{title:"Batch",addBatch:"Tambah Batch",editBatch:"Edit Batch",batchNumber:"Nomor Batch",product:"Produk",importDate:"Tanggal Impor",importQuantity:"Jumlah Impor",currentStock:"Stok Saat Ini",packagingDetails:"Detail Kemasan",importPrice:"Harga Impor",dutyCharges:"Biaya Bea",freightCharges:"Biaya Pengiriman",otherCharges:"Biaya Lainnya",totalCost:"Total Biaya",costPerUnit:"Biaya Per Unit",expiryDate:"Tanggal Kadaluarsa",warehouseLocation:"Lokasi Gudang",uploadDocuments:"Unggah Dokumen"},inventory:{title:"Inventaris",stockSummary:"Ringkasan Stok",batchWiseStock:"Stok Per Batch",lowStockAlert:"Peringatan Stok Rendah",expiryAlert:"Peringatan Kadaluarsa",stockMovement:"Pergerakan Stok",adjustStock:"Sesuaikan Stok"},customers:{title:"Pelanggan",addCustomer:"Tambah Pelanggan",editCustomer:"Edit Pelanggan",customerName:"Nama Pelanggan",companyName:"Nama Perusahaan",npwp:"NPWP",address:"Alamat",city:"Kota",country:"Negara",contactPerson:"Orang yang Dihubungi",email:"Email",phone:"Telepon",gstVatType:"Jenis GST/VAT",paymentTerms:"Syarat Pembayaran"},crm:{title:"CRM",leads:"Prospek",activities:"Aktivitas",addLead:"Tambah Prospek",editLead:"Edit Prospek",companyName:"Nama Perusahaan",contactPerson:"Orang yang Dihubungi",productInterest:"Produk yang Diminati",quantityInterest:"Jumlah yang Diminati",leadSource:"Sumber Prospek",status:"Status",assignedTo:"Ditugaskan Kepada",expectedCloseDate:"Tanggal Penutupan yang Diharapkan",estimatedValue:"Nilai Perkiraan",addActivity:"Tambah Aktivitas",followUp:"Tindak Lanjut",statuses:{inquiry:"Pertanyaan",quotation:"Penawaran",negotiation:"Negosiasi",won:"Menang",lost:"Kalah"}},sales:{title:"Penjualan",invoices:"Faktur",createInvoice:"Buat Faktur",invoiceNumber:"Nomor Faktur",customer:"Pelanggan",invoiceDate:"Tanggal Faktur",dueDate:"Tanggal Jatuh Tempo",items:"Item",addItem:"Tambah Item",quantity:"Jumlah",unitPrice:"Harga Satuan",taxRate:"Tarif Pajak",subtotal:"Subtotal",tax:"Pajak",discount:"Diskon",total:"Total",paymentStatus:"Status Pembayaran",deliveryChallan:"Surat Jalan",generatePDF:"Buat PDF",sendEmail:"Kirim Email"},salesOrders:{title:"Sales Order",createSalesOrder:"Buat Sales Order",customerPoNumber:"Nomor PO Pelanggan",customerPoDate:"Tanggal PO Pelanggan",soDate:"Tanggal Sales Order",expectedDeliveryDate:"Tanggal Pengiriman Diharapkan",uploadPo:"Unggah PO Pelanggan",product:"Produk",freeStock:"Stok Tersedia",discountPercent:"Diskon %",taxPercent:"Pajak %",lineTotal:"Total Baris",itemDeliveryDate:"Tanggal Pengiriman Item",notes:"Catatan",grandTotal:"Total Keseluruhan",saveAsDraft:"Simpan sebagai Draft",submitForApproval:"Kirim untuk Persetujuan"},finance:{title:"Keuangan",dashboard:"Dasbor",expenses:"Pengeluaran",reports:"Laporan",importCosts:"Biaya Impor",salesRevenue:"Pendapatan Penjualan",grossProfit:"Laba Kotor",profitMargin:"Margin Laba",addExpense:"Tambah Pengeluaran",expenseCategory:"Kategori",amount:"Jumlah",expenseDate:"Tanggal",vouchers:"VOUCHER",books:"BUKU",masters:"MASTER",purchase:"Pembelian",receipt:"Penerimaan",payment:"Pembayaran",journal:"Jurnal",contra:"Kontra",pettyCash:"Kas Kecil",ledger:"Buku Besar",journalRegister:"Register Jurnal",bankLedger:"Buku Bank",partyLedger:"Buku Pihak",bankReconciliation:"Rekonsiliasi Bank",caReports:"Laporan CA (Excel)",trialBalance:"Neraca Saldo",profitLoss:"Laba Rugi",balanceSheet:"Neraca",receivables:"Piutang",payables:"Hutang",ageing:"Umur Piutang/Hutang",taxReports:"Laporan Pajak",chartOfAccounts:"Bagan Akun",suppliers:"Pemasok",banks:"Bank",dateRange:"Rentang Tanggal",from:"Dari",to:"Sampai",financialYear:"Tahun Fiskal",voucherNumber:"Nomor Voucher",voucherDate:"Tanggal Voucher",accountName:"Nama Akun",accountCode:"Kode Akun",debit:"Debit",credit:"Kredit",narration:"Keterangan",particulars:"Rincian",closingBalance:"Saldo Akhir",openingBalance:"Saldo Awal",assets:"Aset",liabilities:"Kewajiban",income:"Pendapatan",expense:"Beban",equity:"Ekuitas",outstandingSummary:"Ringkasan Terutang",totalReceivables:"Total Piutang",totalPayables:"Total Hutang",netPosition:"Posisi Bersih",bankAccount:"Akun Bank",bankName:"Nama Bank",accountNumber:"Nomor Rekening",ifscCode:"Kode IFSC",branch:"Cabang",reconcile:"Rekonsiliasi",supplierName:"Nama Pemasok",supplierCode:"Kode Pemasok",contactPerson:"Orang yang Dihubungi",taxInvoice:"Faktur Pajak",ppn:"PPN",pph:"PPh",taxAmount:"Jumlah Pajak",addNew:"Tambah Baru",viewDetails:"Lihat Detail",printVoucher:"Cetak Voucher",downloadExcel:"Unduh Excel",purchaseInvoice:"Faktur Pembelian",invoiceDetails:"Detail Faktur",supplierInvoiceNumber:"Nomor Faktur Pemasok",supplierInvoiceDate:"Tanggal Faktur Pemasok",dueDate:"Tanggal Jatuh Tempo",selectSupplier:"Pilih Pemasok",addItems:"Tambah Item",selectProduct:"Pilih Produk",selectBatch:"Pilih Batch",price:"Harga",taxRate:"Tarif Pajak",totalAmount:"Jumlah Total",searchPlaceholder:"Cari berdasarkan nomor faktur atau pemasok...",noInvoices:"Tidak ada faktur ditemukan",receiptVoucher:"Voucher Penerimaan",paymentVoucher:"Voucher Pembayaran",referenceNumber:"Nomor Referensi",paymentMode:"Metode Pembayaran",chequeNumber:"Nomor Cek",chequeDate:"Tanggal Cek",bank:"Bank",cash:"Tunai",expenseDetails:"Detail Pengeluaran",expenseType:"Jenis Pengeluaran",vendor:"Vendor",billNumber:"Nomor Tagihan",uploadBill:"Unggah Tagihan",pettyCashDetails:"Detail Kas Kecil",pettyCashVoucher:"Voucher Kas Kecil",itemDetails:"Detail Item",removeItem:"Hapus Item",addItem:"Tambah Item",grandTotal:"Total Keseluruhan",notes:"Catatan",attachments:"Lampiran"},settings:{title:"Pengaturan",companyProfile:"Profil Perusahaan",taxSettings:"Pengaturan Pajak",emailSettings:"Pengaturan Email",systemSettings:"Pengaturan Sistem",companyName:"Nama Perusahaan",companyAddress:"Alamat Perusahaan",companyPhone:"Telepon Perusahaan",companyEmail:"Email Perusahaan",companyTaxId:"ID Pajak Perusahaan",defaultTaxRate:"Tarif Pajak Default",invoicePrefix:"Awalan Faktur",lowStockThreshold:"Ambang Stok Rendah",expiryAlertDays:"Hari Peringatan Kadaluarsa"}}},gE=Q.createContext(void 0);function ZU({children:e}){const[t,r]=Q.useState("en");Q.useEffect(()=>{const o=localStorage.getItem("language");o&&(o==="en"||o==="id")&&r(o)},[]);const a=o=>{r(o),localStorage.setItem("language",o)},i=Object.assign(o=>{const l=o.split(".");let c=g5[t];for(const d of l)if(c&&typeof c=="object"&&d in c)c=c[d];else return o;return typeof c=="string"?c:o},g5[t]);return n.jsx(gE.Provider,{value:{language:t,setLanguage:a,t:i},children:e})}function cn(){const e=Q.useContext(gE);if(e===void 0)throw new Error("useLanguage must be used within a LanguageProvider");return e}const xE=Q.createContext(void 0);function e7({children:e}){const t=()=>(window.location.hash.slice(1)||"dashboard").split("/")[0],[r,a]=Q.useState(t()),[s,i]=Q.useState(null),[o,l]=Q.useState(!1),c=u=>{a(u),window.location.hash=u};Q.useEffect(()=>{const u=()=>{const f=t();a(f)};return window.addEventListener("hashchange",u),()=>window.removeEventListener("hashchange",u)},[]);const d=()=>i(null);return n.jsx(xE.Provider,{value:{currentPage:r,setCurrentPage:c,navigationData:s,setNavigationData:i,clearNavigationData:d,sidebarCollapsed:o,setSidebarCollapsed:l},children:e})}function Go(){const e=Q.useContext(xE);if(e===void 0)throw new Error("useNavigation must be used within a NavigationProvider");return e}const yE="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3c!--%20Creator:%20CorelDRAW%20--%3e%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xml:space='preserve'%20width='48.8745mm'%20height='48.2317mm'%20version='1.1'%20style='shape-rendering:geometricPrecision;%20text-rendering:geometricPrecision;%20image-rendering:optimizeQuality;%20fill-rule:evenodd;%20clip-rule:evenodd'%20viewBox='0%200%2015686.55%2015480.24'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20xmlns:xodm='http://www.corel.com/coreldraw/odm/2003'%3e%3cdefs%3e%3cstyle%20type='text/css'%3e%3c![CDATA[%20.fil1%20{fill:%23FD6D26}%20.fil0%20{fill:%23FDB763}%20]]%3e%3c/style%3e%3c/defs%3e%3cg%20id='Layer_x0020_1'%3e%3cmetadata%20id='CorelCorpID_0Corel-Layer'/%3e%3cg%20id='_105553262742272'%3e%3cpath%20class='fil0'%20d='M69.94%2010438.12l10353.39%200%200%20-1798.67%201665.92%200%200%201868.6%200%20320.44%200%204552.28c0,38.48%20-31.45,69.94%20-69.94,69.94l-11949.38%200c-38.48,0%20-69.94,-31.45%20-69.94,-69.94l0%20-4872.72c0,-38.48%2031.45,-69.94%2069.94,-69.94zm1605.9%201710.15l8737.57%200c13.58,0%2024.68,11.11%2024.68,24.68l0%201719.84c0,13.58%20-11.11,24.68%20-24.68,24.68l-8737.57%200c-13.58,0%20-24.68,-11.11%20-24.68,-24.68l0%20-1719.84c0,-13.58%2011.11,-24.68%2024.68,-24.68z'/%3e%3cpath%20class='fil0'%20d='M15587.15%205136.67l-10353.49%200%200%201822.07%20-1665.92%200%200%20-1892.9%200%20-324.61%200%20-4611.43c0,-39%2031.45,-70.87%2069.94,-70.87l11949.47%200c38.48,0%2069.94,31.87%2069.94,70.87l0%204936.04c0,39%20-31.45,70.83%20-69.94,70.83zm-1605.9%20-1732.36l-8737.67%200c-13.58,0%20-24.68,-11.27%20-24.68,-25l0%20-1742.21c0,-13.74%2011.11,-25%2024.68,-25l8737.67%200c13.58,0%2024.68,11.27%2024.68,25l0%201742.21c0,13.74%20-11.11,25%20-24.68,25z'/%3e%3cpolygon%20class='fil1'%20points='-0,0%201651.16,0%201651.16,6929.27%2015657.09,6929.27%2015657.09,6958.74%2015686.55,6958.74%2015686.55,15480.24%2014022.85,15480.24%2014022.85,8639.45%201651.16,8639.45%20-0,8639.45%20-0,6929.27%20'/%3e%3c/g%3e%3c/g%3e%3c/svg%3e";function t7(){const[e,t]=Q.useState(""),[r,a]=Q.useState(""),[s,i]=Q.useState(!1),[o,l]=Q.useState(""),{signIn:c}=Cr(),{t:d}=cn(),u=async f=>{f.preventDefault(),l(""),i(!0);try{await c(e,r)}catch{l("Invalid username or password")}finally{i(!1)}};return n.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 flex items-center justify-center p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md p-8",children:[n.jsxs("div",{className:"flex flex-col items-center mb-8",children:[n.jsx("div",{className:"mb-4",children:n.jsx("img",{src:yE,alt:"Company Logo",className:"h-24 w-24 mx-auto"})}),n.jsx("h1",{className:"text-2xl font-bold text-gray-900 text-center",children:"PT. SHUBHAM ANZEN"}),n.jsx("h2",{className:"text-xl font-bold text-gray-900 text-center",children:"PHARMA JAYA"})]}),n.jsx("h2",{className:"text-2xl font-bold text-center text-gray-900 mb-2",children:d("auth.welcomeBack")}),n.jsx("p",{className:"text-gray-600 text-center mb-8",children:d("auth.enterCredentials")}),n.jsxs("form",{onSubmit:u,className:"space-y-6",children:[n.jsxs("div",{children:[n.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-2",children:"Username"}),n.jsx("input",{id:"username",type:"text",value:e,onChange:f=>t(f.target.value),required:!0,autoComplete:"username",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition",placeholder:"username"}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enter your username (e.g., admin, kunal, sales)"})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:d("auth.password")}),n.jsx("input",{id:"password",type:"password",value:r,onChange:f=>a(f.target.value),required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition",placeholder:""})]}),o&&n.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm",children:o}),n.jsx("button",{type:"submit",disabled:s,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:d(s?"common.loading":"auth.signIn")})]})]})})}/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var r7={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n7=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),_t=(e,t)=>{const r=Q.forwardRef(({color:a="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:l="",children:c,...d},u)=>Q.createElement("svg",{ref:u,...r7,width:s,height:s,stroke:a,strokeWidth:o?Number(i)*24/Number(s):i,className:["lucide",`lucide-${n7(e)}`,l].join(" "),...d},[...t.map(([f,h])=>Q.createElement(f,h)),...Array.isArray(c)?c:[c]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a7=_t("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const En=_t("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ga=_t("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vE=_t("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gb=_t("ArrowDownCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 8v8",key:"napkw2"}],["path",{d:"m8 12 4 4 4-4",key:"k98ssh"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s7=_t("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x5=_t("ArrowRightLeft",[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i7=_t("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xb=_t("ArrowUpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y5=_t("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yb=_t("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o7=_t("AtSign",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M16 8v5a3 3 0 0 0 6 0v-1a10 10 0 1 0-4 8",key:"7n84p3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jv=_t("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l7=_t("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c7=_t("Boxes",[["path",{d:"M2.97 12.92A2 2 0 0 0 2 14.63v3.24a2 2 0 0 0 .97 1.71l3 1.8a2 2 0 0 0 2.06 0L12 19v-5.5l-5-3-4.03 2.42Z",key:"lc1i9w"}],["path",{d:"m7 16.5-4.74-2.85",key:"1o9zyk"}],["path",{d:"m7 16.5 5-3",key:"va8pkn"}],["path",{d:"M7 16.5v5.17",key:"jnp8gn"}],["path",{d:"M12 13.5V19l3.97 2.38a2 2 0 0 0 2.06 0l3-1.8a2 2 0 0 0 .97-1.71v-3.24a2 2 0 0 0-.97-1.71L17 10.5l-5 3Z",key:"8zsnat"}],["path",{d:"m17 16.5-5-3",key:"8arw3v"}],["path",{d:"m17 16.5 4.74-2.85",key:"8rfmw"}],["path",{d:"M17 16.5v5.17",key:"k6z78m"}],["path",{d:"M7.97 4.42A2 2 0 0 0 7 6.13v4.37l5 3 5-3V6.13a2 2 0 0 0-.97-1.71l-3-1.8a2 2 0 0 0-2.06 0l-3 1.8Z",key:"1xygjf"}],["path",{d:"M12 8 7.26 5.15",key:"1vbdud"}],["path",{d:"m12 8 4.74-2.85",key:"3rx089"}],["path",{d:"M12 13.5V8",key:"1io7kd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kv=_t("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _n=_t("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d7=_t("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ja=_t("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u7=_t("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A7=_t("CheckCheck",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ss=_t("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zr=_t("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u0=_t("CheckSquare",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jb=_t("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cs=_t("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h7=_t("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rc=_t("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rg=_t("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f7=_t("CircleUser",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bE=_t("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _E=_t("ClipboardCheck",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p7=_t("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wE=_t("Clipboard",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const da=_t("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m7=_t("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g7=_t("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hn=_t("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zn=_t("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gd=_t("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bi=_t("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v5=_t("FileCheck",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x7=_t("FileDown",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b5=_t("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zt=_t("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y7=_t("FileX",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m14.5 12.5-5 5",key:"b62r18"}],["path",{d:"m9.5 12.5 5 5",key:"1rk7el"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zb=_t("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v7=_t("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NE=_t("Flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _5=_t("Forward",[["polyline",{points:"15 17 20 12 15 7",key:"1w3sku"}],["path",{d:"M4 18v-2a4 4 0 0 1 4-4h12",key:"jmiej9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jE=_t("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jw=_t("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kE=_t("Inbox",[["polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12",key:"o97t9d"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b7=_t("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _7=_t("Landmark",[["line",{x1:"3",x2:"21",y1:"22",y2:"22",key:"j8o0r"}],["line",{x1:"6",x2:"6",y1:"18",y2:"11",key:"10tf0k"}],["line",{x1:"10",x2:"10",y1:"18",y2:"11",key:"54lgf6"}],["line",{x1:"14",x2:"14",y1:"18",y2:"11",key:"380y"}],["line",{x1:"18",x2:"18",y1:"18",y2:"11",key:"1kevvc"}],["polygon",{points:"12 2 20 7 4 7",key:"jkujk7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CE=_t("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w7=_t("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N7=_t("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vo=_t("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const af=_t("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SE=_t("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ua=_t("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j7=_t("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w5=_t("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e_=_t("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k7=_t("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U0=_t("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C7=_t("Minimize2",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mg=_t("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S7=_t("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N5=_t("PackageX",[["path",{d:"M21 10V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l2-1.14",key:"e7tb2h"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["line",{x1:"12",x2:"12",y1:"22",y2:"12",key:"a4e8g8"}],["path",{d:"m17 13 5 5m-5 0 5-5",key:"im3w4b"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rr=_t("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wo=_t("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B7=_t("PauseCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"10",x2:"10",y1:"15",y2:"9",key:"c1nkhi"}],["line",{x1:"14",x2:"14",y1:"15",y2:"9",key:"h65svq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OA=_t("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ul=_t("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pr=_t("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $l=_t("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hs=_t("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j5=_t("Reply",[["polyline",{points:"9 17 4 12 9 7",key:"hvgpf2"}],["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t_=_t("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eg=_t("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ca=_t("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $i=_t("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BE=_t("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E7=_t("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vA=_t("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aa=_t("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cv=_t("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F7=_t("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qg=_t("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EE=_t("TestTube",[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5h0c-1.4 0-2.5-1.1-2.5-2.5V2",key:"187lwq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lr=_t("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sv=_t("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FE=_t("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zo=_t("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const us=_t("Truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rl=_t("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r_=_t("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ao=_t("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vo=_t("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TE=_t("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k5=_t("Warehouse",[["path",{d:"M22 8.35V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8.35A2 2 0 0 1 3.26 6.5l8-3.2a2 2 0 0 1 1.48 0l8 3.2A2 2 0 0 1 22 8.35Z",key:"gksnxg"}],["path",{d:"M6 18h12",key:"9pbo8z"}],["path",{d:"M6 14h12",key:"4cwo0f"}],["rect",{width:"12",height:"12",x:"6",y:"10",key:"apd30q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gn=_t("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wr=_t("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IE=_t("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);function T7({toast:e,onClose:t}){Q.useEffect(()=>{const s=setTimeout(()=>{t(e.id)},e.duration||5e3);return()=>clearTimeout(s)},[e,t]);const r=()=>{switch(e.type){case"appointment":return n.jsx(ja,{className:"h-5 w-5 text-blue-600"});case"success":return n.jsx(Zr,{className:"h-5 w-5 text-green-600"});case"warning":return n.jsx(En,{className:"h-5 w-5 text-yellow-600"});case"error":return n.jsx(En,{className:"h-5 w-5 text-red-600"});default:return n.jsx(b7,{className:"h-5 w-5 text-blue-600"})}},a=()=>{switch(e.type){case"appointment":return"bg-blue-50 border-blue-200";case"success":return"bg-green-50 border-green-200";case"warning":return"bg-yellow-50 border-yellow-200";case"error":return"bg-red-50 border-red-200";default:return"bg-white border-gray-200"}};return n.jsx("div",{className:`${a()} border rounded-lg shadow-lg p-4 mb-3 min-w-80 max-w-md animate-slide-in`,style:{animation:"slideIn 0.3s ease-out"},children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"flex-shrink-0 mt-0.5",children:r()}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-1",children:e.title}),n.jsx("p",{className:"text-sm text-gray-700",children:e.message})]}),n.jsx("button",{onClick:()=>t(e.id),className:"flex-shrink-0 text-gray-400 hover:text-gray-600 transition",children:n.jsx(wr,{className:"h-4 w-4"})})]})})}function I7(){const[e,t]=Q.useState([]);Q.useEffect(()=>{const a=s=>{t(i=>[...i,s.detail])};return window.addEventListener("showToast",a),()=>window.removeEventListener("showToast",a)},[]);const r=a=>{t(s=>s.filter(i=>i.id!==a))};return n.jsx("div",{className:"fixed top-4 right-4 z-[9999] pointer-events-none",children:n.jsx("div",{className:"pointer-events-auto",children:e.map(a=>n.jsx(T7,{toast:a,onClose:r},a.id))})})}function C5(e){const t=new CustomEvent("showToast",{detail:{...e,id:Math.random().toString(36).substring(7)}});window.dispatchEvent(t)}function D7(){const[e,t]=Q.useState(!1),[r,a]=Q.useState([]),[s,i]=Q.useState(0),{user:o}=Cr(),l=Q.useRef(new Set),c=`notification_session_${o==null?void 0:o.id}`;Q.useEffect(()=>{if(o){const x=sessionStorage.getItem(c);d(!x);const p=setInterval(()=>d(!1),6e4);return()=>clearInterval(p)}},[o]);const d=async(x=!1)=>{try{const{data:p,error:b}=await Z.from("notifications").select("*").eq("user_id",o==null?void 0:o.id).eq("is_read",!1).order("created_at",{ascending:!1}).limit(10);if(b)throw b;const m=p||[];a(m),i(m.length||0),x?(sessionStorage.setItem(c,"true"),m.forEach(g=>{!g.is_read&&!l.current.has(g.id)&&(g.type==="appointment"?C5({type:"appointment",title:g.title,message:g.message,duration:8e3}):C5({type:"info",title:g.title,message:g.message,duration:6e3})),l.current.add(g.id)})):m.forEach(g=>{l.current.add(g.id)})}catch(p){console.error("Error loading notifications:",p)}},u=async x=>{try{const{error:p}=await Z.from("notifications").update({is_read:!0,read_at:new Date().toISOString()}).eq("id",x);if(p)throw p;d()}catch(p){console.error("Error marking notification as read:",p)}},f=async()=>{try{const{error:x}=await Z.from("notifications").update({is_read:!0,read_at:new Date().toISOString()}).eq("user_id",o==null?void 0:o.id).eq("is_read",!1);if(x)throw x;d()}catch(x){console.error("Error marking all as read:",x)}},h=x=>{switch(x){case"appointment":return n.jsx(da,{className:"w-5 h-5 text-blue-600"});case"low_stock":return n.jsx(Ga,{className:"w-5 h-5 text-orange-600"});case"near_expiry":return n.jsx(da,{className:"w-5 h-5 text-red-600"});case"pending_invoice":return n.jsx(Zt,{className:"w-5 h-5 text-blue-600"});case"follow_up":return n.jsx(jv,{className:"w-5 h-5 text-purple-600"});case"task_assigned":return n.jsx(u0,{className:"w-5 h-5 text-blue-600"});case"task_mention":return n.jsx(o7,{className:"w-5 h-5 text-purple-600"});case"task_comment":return n.jsx(U0,{className:"w-5 h-5 text-green-600"});case"task_status_change":return n.jsx(u0,{className:"w-5 h-5 text-orange-600"});case"task_deadline":return n.jsx(da,{className:"w-5 h-5 text-red-600"});default:return n.jsx(Rr,{className:"w-5 h-5 text-gray-600"})}},A=x=>{const p=new Date(x),m=new Date().getTime()-p.getTime(),g=Math.floor(m/6e4),y=Math.floor(m/36e5),v=Math.floor(m/864e5);return g<1?"Just now":g<60?`${g}m ago`:y<24?`${y}h ago`:v<7?`${v}d ago`:p.toLocaleDateString()};return n.jsxs("div",{className:"relative",children:[n.jsxs("button",{onClick:()=>t(!e),className:"p-2 rounded hover:bg-gray-100 relative",children:[n.jsx(jv,{className:"w-5 h-5 text-gray-600"}),s>0&&n.jsx("span",{className:"absolute top-1 right-1 w-5 h-5 bg-red-500 rounded-full text-white text-xs flex items-center justify-center font-semibold",children:s>9?"9+":s})]}),e&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"fixed inset-0 z-30",onClick:()=>t(!1)}),n.jsxs("div",{className:"absolute right-0 mt-2 w-96 bg-white rounded-lg shadow-xl border border-gray-200 z-40",children:[n.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Notifications"}),n.jsxs("div",{className:"flex items-center gap-2",children:[s>0&&n.jsxs("button",{onClick:f,className:"text-sm text-blue-600 hover:text-blue-700 flex items-center gap-1",children:[n.jsx(A7,{className:"w-4 h-4"}),"Mark all read"]}),n.jsx("button",{onClick:()=>t(!1),className:"text-gray-400 hover:text-gray-600",children:n.jsx(wr,{className:"w-5 h-5"})})]})]}),n.jsx("div",{className:"max-h-96 overflow-y-auto",children:r.length===0?n.jsxs("div",{className:"p-8 text-center text-gray-500",children:[n.jsx(jv,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),n.jsx("p",{children:"No notifications"})]}):r.map(x=>n.jsx("div",{className:`p-4 border-b hover:bg-gray-50 cursor-pointer transition ${x.is_read?"":"bg-blue-50"}`,onClick:()=>{x.is_read||u(x.id)},children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"flex-shrink-0 mt-1",children:h(x.type)}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-start justify-between gap-2",children:[n.jsx("p",{className:`text-sm font-medium ${x.is_read?"text-gray-700":"text-gray-900"}`,children:x.title}),!x.is_read&&n.jsx("span",{className:"w-2 h-2 bg-blue-600 rounded-full flex-shrink-0 mt-1.5"})]}),n.jsx("p",{className:"text-sm text-gray-600 mt-1",children:x.message}),n.jsx("p",{className:"text-xs text-gray-400 mt-2",children:A(x.created_at)})]})]})},x.id))}),r.length>0&&n.jsx("div",{className:"p-3 border-t bg-gray-50 text-center",children:n.jsxs("p",{className:"text-xs text-gray-500",children:["Showing last ",r.length," notifications"]})})]})]})]})}function Un({children:e}){const[t,r]=Q.useState(!1),{profile:a,signOut:s}=Cr(),{language:i,setLanguage:o,t:l}=cn(),{currentPage:c,setCurrentPage:d,sidebarCollapsed:u,setSidebarCollapsed:f}=Go(),A=["crm","command-center","finance"].includes(c);Q.useEffect(()=>{A&&!u&&f(!0)},[c,A,u,f]);const p=[{id:"dashboard",label:l("nav.dashboard"),icon:w7,roles:["admin","accounts","sales","warehouse"]},{id:"products",label:l("nav.products"),icon:Rr,roles:["admin","sales","warehouse"]},{id:"batches",label:l("nav.batches"),icon:c7,roles:["admin","warehouse","accounts"]},{id:"stock",label:l("nav.stock"),icon:k5,roles:["admin","sales","warehouse","accounts"]},{id:"customers",label:l("nav.customers"),icon:vo,roles:["admin","accounts","sales"]},{id:"sales-orders",label:"Sales Orders",icon:Zt,roles:["admin","accounts","sales"]},{id:"delivery-challan",label:l("nav.deliveryChallan"),icon:us,roles:["admin","accounts","sales","warehouse"]},{id:"sales",label:l("nav.sales"),icon:E7,roles:["admin","accounts","sales"]},{id:"purchase-orders",label:"Purchase Orders",icon:p7,roles:["admin","warehouse","accounts"]},{id:"import-requirements",label:"Import Requirements",icon:zo,roles:["admin","warehouse","sales"]},{id:"import-containers",label:"Import Containers",icon:Rr,roles:["admin","warehouse","accounts"]},{id:"finance",label:l("nav.finance"),icon:hn,roles:["admin","accounts"]},{id:"crm",label:l("nav.crm"),icon:f7,roles:["admin","sales"]},{id:"command-center",label:"Command Center",icon:IE,roles:["admin","sales"]},{id:"tasks",label:"Tasks",icon:u0,roles:["admin","accounts","sales","warehouse"]},{id:"inventory",label:l("nav.inventory"),icon:k5,roles:["admin","warehouse"]},{id:"settings",label:l("nav.settings"),icon:BE,roles:["admin","accounts","sales"]}].filter(m=>a&&m.roles.includes(a.role)),b=()=>{o(i==="en"?"id":"en")};return n.jsxs("div",{className:"min-h-screen bg-gray-50",children:[t&&n.jsx("div",{className:"fixed inset-0 bg-gray-900 bg-opacity-50 z-20 lg:hidden transition-opacity",onClick:()=>r(!1)}),n.jsxs("aside",{className:`fixed top-0 left-0 z-30 h-full bg-white border-r border-gray-200 transform transition-all lg:translate-x-0 ${t?"translate-x-0":"-translate-x-full"} ${u&&A?"w-16":"w-64"} flex flex-col`,children:[n.jsxs("div",{className:"flex items-center justify-between p-3 border-b border-gray-200 flex-shrink-0",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("img",{src:yE,alt:"Logo",className:"h-8 w-8 flex-shrink-0"}),!(u&&A)&&n.jsxs("div",{className:"flex flex-col leading-tight",children:[n.jsx("span",{className:"text-xs font-bold text-gray-900",children:"PT. SHUBHAM ANZEN"}),n.jsx("span",{className:"text-xs font-bold text-gray-900",children:"PHARMA JAYA"})]})]}),n.jsx("button",{onClick:()=>r(!1),className:"lg:hidden p-1 rounded hover:bg-gray-100",children:n.jsx(wr,{className:"w-5 h-5"})})]}),n.jsx("nav",{className:"flex-1 overflow-y-auto p-3 space-y-1",children:p.map(m=>{const g=m.icon,y=c===m.id;return n.jsxs("a",{href:`#${m.id}`,onClick:v=>{v.preventDefault(),d(m.id),r(!1)},className:`w-full flex items-center gap-2 px-3 py-2 rounded-lg transition relative group ${y?"bg-blue-50 text-blue-600":"text-gray-700 hover:bg-gray-50"} ${u&&A?"justify-center":""}`,title:u&&A?m.label:"",children:[n.jsx(g,{className:"w-5 h-5 flex-shrink-0"}),!(u&&A)&&n.jsx("span",{className:"font-medium text-sm",children:m.label}),u&&A&&n.jsx("span",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-900 text-white text-xs rounded whitespace-nowrap opacity-0 group-hover:opacity-100 pointer-events-none transition-opacity z-50",children:m.label})]},m.id)})})]}),n.jsxs("div",{className:`transition-all ${u&&A?"lg:pl-16":"lg:pl-64"}`,children:[n.jsx("header",{className:"bg-white border-b border-gray-200 sticky top-0 z-10",children:n.jsxs("div",{className:"flex items-center justify-between px-4 py-3",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>r(!0),className:"lg:hidden p-2 rounded hover:bg-gray-100",children:n.jsx(e_,{className:"w-6 h-6"})}),A&&n.jsx("button",{onClick:()=>f(!u),className:"hidden lg:block p-2 rounded hover:bg-gray-100",title:u?"Expand sidebar":"Collapse sidebar",children:n.jsx(e_,{className:"w-6 h-6"})})]}),n.jsx("div",{className:"flex-1"}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(D7,{}),n.jsxs("button",{onClick:b,className:"flex items-center gap-2 px-3 py-2 rounded hover:bg-gray-100",children:[n.jsx(jE,{className:"w-5 h-5 text-gray-600"}),n.jsx("span",{className:"text-sm font-medium text-gray-700 uppercase",children:i})]}),n.jsxs("button",{onClick:()=>s(),className:"flex items-center gap-2 px-3 py-2 rounded hover:bg-gray-100 text-gray-700",children:[n.jsx(SE,{className:"w-5 h-5"}),n.jsx("span",{className:"text-sm font-medium",children:l("auth.logout")})]})]})]})}),n.jsx("main",{className:"p-4 lg:p-6",children:e})]})]})}function L7({onActionClick:e}){const{profile:t}=Cr(),{setCurrentPage:r}=Go(),[a,s]=Q.useState([]),[i,o]=Q.useState([]),[l,c]=Q.useState(0),[d,u]=Q.useState(0),[f,h]=Q.useState(!0);Q.useEffect(()=>{A(),x();const y=Z.channel("reminders_changes").on("postgres_changes",{event:"*",schema:"public",table:"crm_reminders"},()=>{A()}).subscribe();return()=>{y.unsubscribe()}},[]);const A=async()=>{try{const y=new Date;y.setHours(0,0,0,0);const v=new Date(y);v.setDate(v.getDate()+1);const{data:_,error:j}=await Z.from("crm_reminders").select(`
          *,
          crm_inquiries (
            inquiry_number,
            company_name,
            product_name
          )
        `).eq("is_completed",!1).gte("due_date",y.toISOString()).lt("due_date",v.toISOString()).order("due_date",{ascending:!0}).limit(5);if(j)throw j;const{data:N,error:B}=await Z.from("crm_reminders").select(`
          *,
          crm_inquiries (
            inquiry_number,
            company_name,
            product_name
          )
        `).eq("is_completed",!1).lt("due_date",y.toISOString()).order("due_date",{ascending:!0}).limit(5);if(B)throw B;s(_||[]),o(N||[])}catch(y){console.error("Error loading reminders:",y)}finally{h(!1)}},x=async()=>{try{if((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="sales"){const{count:y}=await Z.from("sales_orders").select("id",{count:"exact",head:!0}).eq("status","pending_approval");c(y||0)}if((t==null?void 0:t.role)==="admin"){const{count:y}=await Z.from("delivery_challans").select("id",{count:"exact",head:!0}).eq("approval_status","pending_approval");u(y||0)}}catch(y){console.error("Error loading approvals:",y)}},p=async y=>{try{const{error:v}=await Z.from("crm_reminders").update({is_completed:!0,completed_at:new Date().toISOString()}).eq("id",y);if(v)throw v;A()}catch(v){console.error("Error completing reminder:",v)}},b=y=>{switch(y){case"send_price":case"send_coa":case"send_sample":return $i;case"follow_up":return Ul;default:return ja}},m=y=>{switch(y){case"send_price":return"text-green-600";case"send_coa":return"text-blue-600";case"send_sample":return"text-purple-600";case"follow_up":return"text-orange-600";default:return"text-gray-600"}};if(f)return n.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:n.jsxs("div",{className:"animate-pulse space-y-4",children:[n.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/3"}),n.jsx("div",{className:"h-10 bg-gray-200 rounded"}),n.jsx("div",{className:"h-10 bg-gray-200 rounded"})]})});const g=a.length+i.length+l+d;return g===0?n.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[n.jsx(da,{className:"w-5 h-5 text-blue-600"}),"Today's Actions"]}),n.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-green-100 text-green-700 rounded-full",children:"All Clear!"})]}),n.jsxs("div",{className:"text-center py-8",children:[n.jsx(Ss,{className:"w-16 h-16 text-green-500 mx-auto mb-3"}),n.jsx("p",{className:"text-gray-600",children:"No pending actions for today"}),n.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Great job staying on top of everything!"})]})]}):n.jsxs("div",{className:"bg-white rounded-lg shadow",children:[n.jsx("div",{className:"p-4 border-b border-gray-200",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[n.jsx(da,{className:"w-5 h-5 text-blue-600"}),"Today's Actions"]}),n.jsxs("span",{className:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-700 rounded-full",children:[g," ",g===1?"Action":"Actions"]})]})}),n.jsxs("div",{className:"p-4 space-y-3",children:[(l>0||d>0)&&n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(En,{className:"w-4 h-4 text-yellow-600"}),n.jsx("h3",{className:"text-sm font-semibold text-yellow-600",children:"Pending Approvals"})]}),n.jsxs("div",{className:"space-y-2",children:[l>0&&n.jsxs("div",{onClick:()=>r("sales-orders"),className:"flex items-start gap-3 p-3 bg-yellow-50 border border-yellow-200 rounded-lg hover:shadow-md transition cursor-pointer",children:[n.jsx(Zt,{className:"w-4 h-4 text-yellow-600 mt-0.5 flex-shrink-0"}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Sales Orders Pending Approval"}),n.jsxs("p",{className:"text-xs text-gray-600 mt-0.5",children:[l," order",l!==1?"s":""," waiting for your review"]})]}),n.jsx(Rc,{className:"w-5 h-5 text-gray-400 flex-shrink-0"})]}),d>0&&n.jsxs("div",{onClick:()=>r("delivery-challan"),className:"flex items-start gap-3 p-3 bg-yellow-50 border border-yellow-200 rounded-lg hover:shadow-md transition cursor-pointer",children:[n.jsx(_E,{className:"w-4 h-4 text-yellow-600 mt-0.5 flex-shrink-0"}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Delivery Challans Pending Approval"}),n.jsxs("p",{className:"text-xs text-gray-600 mt-0.5",children:[d," challan",d!==1?"s":""," waiting for your review"]})]}),n.jsx(Rc,{className:"w-5 h-5 text-gray-400 flex-shrink-0"})]})]})]}),i.length>0&&n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(En,{className:"w-4 h-4 text-red-600"}),n.jsxs("h3",{className:"text-sm font-semibold text-red-600",children:["Overdue (",i.length,")"]})]}),n.jsx("div",{className:"space-y-2",children:i.map(y=>{const v=b(y.reminder_type),_=m(y.reminder_type);return n.jsxs("div",{className:"flex items-start gap-3 p-3 bg-red-50 border border-red-200 rounded-lg hover:shadow-sm transition",children:[n.jsx(v,{className:`w-4 h-4 ${_} mt-0.5 flex-shrink-0`}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"text-sm font-medium text-gray-900 line-clamp-1",children:y.title}),y.crm_inquiries&&n.jsxs("p",{className:"text-xs text-gray-600 mt-0.5 truncate",children:["#",y.crm_inquiries.inquiry_number," - ",y.crm_inquiries.company_name]}),n.jsxs("p",{className:"text-xs text-red-600 font-medium mt-1",children:[Math.abs(Math.floor((new Date().getTime()-new Date(y.due_date).getTime())/(1e3*60*60*24)))," days overdue"]})]}),n.jsx("button",{onClick:()=>p(y.id),className:"p-1 text-gray-400 hover:text-green-600 flex-shrink-0",title:"Mark as complete",children:n.jsx(Ss,{className:"w-5 h-5"})})]},y.id)})})]}),a.length>0&&n.jsxs("div",{children:[i.length>0&&n.jsxs("div",{className:"flex items-center gap-2 mb-2 mt-4",children:[n.jsx(da,{className:"w-4 h-4 text-blue-600"}),n.jsxs("h3",{className:"text-sm font-semibold text-blue-600",children:["Today (",a.length,")"]})]}),n.jsx("div",{className:"space-y-2",children:a.map(y=>{const v=b(y.reminder_type),_=m(y.reminder_type);return n.jsxs("div",{className:"flex items-start gap-3 p-3 bg-blue-50 border border-blue-200 rounded-lg hover:shadow-sm transition",children:[n.jsx(v,{className:`w-4 h-4 ${_} mt-0.5 flex-shrink-0`}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"text-sm font-medium text-gray-900 line-clamp-1",children:y.title}),y.crm_inquiries&&n.jsxs("p",{className:"text-xs text-gray-600 mt-0.5 truncate",children:["#",y.crm_inquiries.inquiry_number," - ",y.crm_inquiries.company_name]}),n.jsx("p",{className:"text-xs text-blue-600 mt-1",children:new Date(y.due_date).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})})]}),n.jsx("button",{onClick:()=>p(y.id),className:"p-1 text-gray-400 hover:text-green-600 flex-shrink-0",title:"Mark as complete",children:n.jsx(Ss,{className:"w-5 h-5"})})]},y.id)})})]})]}),g>5&&n.jsx("div",{className:"p-3 border-t border-gray-200",children:n.jsxs("button",{className:"w-full flex items-center justify-center gap-2 text-sm text-blue-600 hover:text-blue-700 font-medium",children:[n.jsx("span",{children:"View All Actions"}),n.jsx(Rc,{className:"w-4 h-4"})]})})]})}function S5(){const{t:e}=cn(),{profile:t}=Cr(),{setCurrentPage:r}=Go(),[a,s]=Q.useState({totalProducts:0,lowStockItems:0,nearExpiryBatches:0,totalCustomers:0,salesThisMonth:0,revenueThisMonth:0,profitThisMonth:0,pendingFollowUps:0,pendingSalesOrders:0,pendingDeliveryChallans:0,overdueInvoicesCount:0,overdueInvoicesAmount:0}),[i,o]=Q.useState(!0),[l,c]=Q.useState(null);Q.useEffect(()=>{d()},[]);const d=async()=>{var x,p,b,m,g,y;try{c(null);const v=new Date,_=new Date(v.getFullYear(),v.getMonth(),1),j=new Date(v.getFullYear(),v.getMonth()+1,0,23,59,59),[N,B,E,C,k,w,T,R]=await Promise.all([Z.from("products").select("id",{count:"exact",head:!0}).eq("is_active",!0),Z.from("products").select("id, min_stock_level, current_stock").eq("is_active",!0),Z.from("customers").select("id",{count:"exact",head:!0}).eq("is_active",!0),Z.from("sales_invoices").select("total_amount, subtotal, created_at, invoice_date").gte("invoice_date",_.toISOString()).lte("invoice_date",j.toISOString()),Z.from("crm_activities").select("id",{count:"exact"}).eq("is_completed",!1).not("follow_up_date","is",null),Z.from("sales_orders").select("id",{count:"exact",head:!0}).eq("status","pending_approval"),Z.from("delivery_challans").select("id",{count:"exact",head:!0}).eq("approval_status","pending_approval"),Z.from("sales_invoices").select("id, total_amount, due_date").in("payment_status",["pending","partial"]).lt("due_date",new Date().toISOString().split("T")[0])]),q=((x=B.data)==null?void 0:x.filter(L=>L.min_stock_level>0&&L.current_stock<L.min_stock_level).length)||0,z=await Z.from("batches").select("current_stock, expiry_date").eq("is_active",!0),ee=new Date;ee.setDate(ee.getDate()+30);const Y=((p=z.data)==null?void 0:p.filter(L=>L.expiry_date&&new Date(L.expiry_date)<=ee&&new Date(L.expiry_date)>=new Date).length)||0,G=((b=C.data)==null?void 0:b.reduce((L,P)=>L+(Number(P.total_amount)||0),0))||0,re=((m=C.data)==null?void 0:m.reduce((L,P)=>L+(Number(P.subtotal)||0),0))||0,U=G-re*.7,D=(await Promise.all((R.data||[]).map(async L=>{const{data:P}=await Z.rpc("get_invoice_paid_amount",{p_invoice_id:L.id}),I=P||0;return L.total_amount-I}))).reduce((L,P)=>L+P,0);s({totalProducts:N.count||0,lowStockItems:q,nearExpiryBatches:Y,totalCustomers:E.count||0,salesThisMonth:((g=C.data)==null?void 0:g.length)||0,revenueThisMonth:G,profitThisMonth:Math.max(0,U),pendingFollowUps:k.count||0,pendingSalesOrders:w.count||0,pendingDeliveryChallans:T.count||0,overdueInvoicesCount:((y=R.data)==null?void 0:y.length)||0,overdueInvoicesAmount:D})}catch{c("Failed to load dashboard data. Please try again.")}finally{o(!1)}},u=[{title:e("dashboard.lowStock"),value:a.lowStockItems,icon:Ga,color:"orange"},{title:e("dashboard.nearExpiry"),value:a.nearExpiryBatches,icon:da,color:"red"},{title:e("dashboard.salesThisMonth"),value:a.salesThisMonth,icon:zo,color:"blue"}],f=[];((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="accounts")&&f.push({title:"Overdue Invoices",value:a.overdueInvoicesCount,subtitle:`Rp ${a.overdueInvoicesAmount.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})}`,icon:Ga,color:"red-gradient",link:"sales"}),((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="sales")&&f.push({title:"Pending PO Approvals",value:a.pendingSalesOrders,icon:Zt,color:"yellow",link:"sales-orders"}),(t==null?void 0:t.role)==="admin"&&f.push({title:"Pending DC Approvals",value:a.pendingDeliveryChallans,icon:_E,color:"yellow",link:"delivery-challan"});const h=[...f,...u],A={blue:{bg:"bg-blue-50",text:"text-blue-600",icon:"bg-blue-100"},orange:{bg:"bg-orange-50",text:"text-orange-600",icon:"bg-orange-100"},red:{bg:"bg-red-50",text:"text-red-600",icon:"bg-red-100"},"red-gradient":{bg:"bg-gradient-to-br from-red-500 to-orange-500",text:"text-white",icon:"bg-white/20"},green:{bg:"bg-green-50",text:"text-green-600",icon:"bg-green-100"},emerald:{bg:"bg-emerald-50",text:"text-emerald-600",icon:"bg-emerald-100"},purple:{bg:"bg-purple-50",text:"text-purple-600",icon:"bg-purple-100"},yellow:{bg:"bg-yellow-50",text:"text-yellow-600",icon:"bg-yellow-100"}};return n.jsx(Un,{children:n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:e("dashboard.title")}),n.jsx("p",{className:"text-gray-600 mt-1",children:"Welcome to your pharma trading management system"})]}),l?n.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 text-center",children:[n.jsx(Ga,{className:"w-12 h-12 text-red-500 mx-auto mb-3"}),n.jsx("p",{className:"text-red-700 font-medium",children:l}),n.jsx("button",{onClick:d,className:"mt-4 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition",children:"Try Again"})]}):i?n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-3 md:gap-4",children:[...Array(8)].map((x,p)=>n.jsxs("div",{className:"bg-white rounded-lg shadow p-4 animate-pulse",children:[n.jsx("div",{className:"h-10 bg-gray-200 rounded mb-3"}),n.jsx("div",{className:"h-5 bg-gray-200 rounded w-1/2"})]},p))}):n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-3 md:gap-4",children:h.map((x,p)=>{const b=x.icon,m=A[x.color],g=!!x.link;return n.jsx("div",{className:`${m.bg} rounded-lg shadow p-3 md:p-4 transition hover:shadow-lg ${g?"cursor-pointer":""}`,onClick:()=>g&&r(x.link),children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"min-w-0 flex-1",children:[n.jsx("p",{className:`text-xs md:text-sm font-medium ${x.color==="red-gradient"?"text-white/80":"text-gray-600"} truncate`,children:x.title}),n.jsx("p",{className:`text-xl md:text-2xl font-bold ${m.text} mt-1`,children:x.value}),x.subtitle&&n.jsx("p",{className:`text-xs mt-0.5 ${x.color==="red-gradient"?"text-white/90":"text-gray-500"} truncate`,children:x.subtitle})]}),n.jsx("div",{className:`${m.icon} p-2 md:p-3 rounded-full flex-shrink-0 ml-2`,children:n.jsx(b,{className:`w-4 h-4 md:w-5 md:h-5 ${m.text}`})})]})},p)})}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mt-6",children:[n.jsx("div",{className:"lg:col-span-2",children:n.jsx(L7,{})}),n.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Links"}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("a",{href:"#",className:"block p-3 bg-blue-50 hover:bg-blue-100 rounded-lg transition text-blue-700 font-medium",children:"Go to Command Center"}),n.jsx("a",{href:"#",className:"block p-3 bg-gray-50 hover:bg-gray-100 rounded-lg transition text-gray-700 font-medium",children:"View All Inquiries"}),n.jsx("a",{href:"#",className:"block p-3 bg-gray-50 hover:bg-gray-100 rounded-lg transition text-gray-700 font-medium",children:"Create Manual Inquiry"})]})]})]})]})})}function Fs({data:e,columns:t,onRowClick:r,actions:a,loading:s}){const[i,o]=Q.useState(""),[l,c]=Q.useState(null),{t:d}=cn(),u=A=>{let x="asc";(l==null?void 0:l.key)===A&&l.direction==="asc"&&(x="desc"),c({key:A,direction:x})},f=A=>{const x=[],p=b=>{b!=null&&(typeof b=="object"&&!Array.isArray(b)?Object.values(b).forEach(p):Array.isArray(b)?b.forEach(p):x.push(String(b)))};return Object.values(A).forEach(p),x},h=(()=>{let A=[...e];return i&&(A=A.filter(x=>f(x).some(p=>p.toLowerCase().includes(i.toLowerCase())))),l&&A.sort((x,p)=>{const b=x[l.key],m=p[l.key];return b<m?l.direction==="asc"?-1:1:b>m?l.direction==="asc"?1:-1:0}),A})();return s?n.jsx("div",{className:"bg-white rounded-lg shadow",children:n.jsxs("div",{className:"p-8 text-center",children:[n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),n.jsx("p",{className:"mt-4 text-gray-600",children:d("common.loading")})]})}):n.jsxs("div",{className:"bg-white rounded-lg shadow",children:[n.jsx("div",{className:"p-4 border-b border-gray-200",children:n.jsxs("div",{className:"relative",children:[n.jsx(Ca,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:i,onChange:A=>o(A.target.value),placeholder:d("common.search"),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"})]})}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:n.jsxs("tr",{children:[t.map(A=>n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:A.sortable?n.jsxs("button",{onClick:()=>u(A.key),className:"flex items-center gap-1 hover:text-gray-700",children:[A.label,(l==null?void 0:l.key)===A.key?l.direction==="asc"?n.jsx(Rg,{className:"w-4 h-4"}):n.jsx(Cs,{className:"w-4 h-4"}):n.jsx(Cs,{className:"w-4 h-4 opacity-30"})]}):A.label},A.key)),a&&n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:d("common.actions")})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:h.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:t.length+(a?1:0),className:"px-6 py-8 text-center text-gray-500",children:d("common.noData")})}):h.map((A,x)=>n.jsxs("tr",{onClick:()=>r==null?void 0:r(A),className:r?"cursor-pointer hover:bg-gray-50":"",children:[t.map(p=>n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:p.render?p.render(A[p.key],A):A[p.key]},p.key)),a&&n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:a(A)})]},x))})]})})]})}function Ot({isOpen:e,onClose:t,title:r,children:a,size:s="md",maxWidth:i}){const{t:o}=cn();if(Q.useEffect(()=>{const d=u=>{u.key==="Escape"&&e&&t()};if(e)return document.addEventListener("keydown",d),()=>document.removeEventListener("keydown",d)},[e,t]),!e)return null;const c=i||{sm:"max-w-md",md:"max-w-2xl",lg:"max-w-4xl",xl:"max-w-6xl"}[s];return n.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:n.jsxs("div",{className:"flex min-h-screen items-center justify-center p-4",children:[n.jsx("div",{className:"fixed inset-0 bg-gray-900 bg-opacity-50 transition-opacity",onClick:t}),n.jsxs("div",{className:`relative bg-white rounded-lg shadow-xl ${c} w-full max-h-[90vh] flex flex-col`,children:[n.jsxs("div",{className:"flex items-center justify-between p-3 border-b border-gray-200",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:r}),n.jsx("button",{onClick:t,className:"p-1 rounded hover:bg-gray-100 transition",children:n.jsx(wr,{className:"w-5 h-5 text-gray-500"})})]}),n.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:a})]})]})})}function P7(){var G,re,U;const{t:e}=cn(),{profile:t}=Cr(),[r,a]=Q.useState([]),[s,i]=Q.useState(!0),[o,l]=Q.useState(!1),[c,d]=Q.useState(!1),[u,f]=Q.useState(null),[h,A]=Q.useState([]),[x,p]=Q.useState(null),[b,m]=Q.useState({product_name:"",hsn_code:"",category:"api",unit:"kg",packaging_type:"",default_supplier:"",description:"",min_stock_level:"",duty_a1:""}),[g,y]=Q.useState([{source_name:"",grade:"BP",files:[]}]);Q.useEffect(()=>{v()},[]);const v=async()=>{try{i(!0);const{data:S,error:D}=await Z.from("products").select("*").eq("is_active",!0).order("product_name");if(D)throw D;a(S||[])}catch(S){console.error("Error loading products:",S)}finally{i(!1)}},_=async S=>{try{const{data:D,error:L}=await Z.from("product_sources").select(`
          id,
          supplier_name,
          grade,
          country,
          remarks,
          created_at
        `).eq("product_id",S).order("created_at",{ascending:!1});if(L)throw L;const P=await Promise.all((D||[]).map(async H=>{const{data:V}=await Z.from("product_source_documents").select("*").eq("source_id",H.id);return{...H,documents:V||[]}})),{data:I}=await Z.from("product_documents").select("*").eq("product_id",S);if(I&&I.length>0){const H={id:"default",supplier_name:"Product Documents",grade:"-",country:null,remarks:"General product documents",created_at:new Date().toISOString(),documents:I.map(V=>({id:V.id,doc_type:V.document_type,original_filename:V.file_name,file_url:V.file_url,file_size:V.file_size}))};A([H,...P])}else A(P)}catch(D){console.error("Error loading sources:",D)}},j=async S=>{f(S),await _(S.id),d(!0)},N=()=>{y([...g,{source_name:"",grade:"BP",files:[]}])},B=S=>{g.length>1&&y(g.filter((D,L)=>L!==S))},E=(S,D,L)=>{const P=[...g];P[S]={...P[S],[D]:L},y(P)},C=(S,D)=>{if(!D)return;const L=[...g];L[S].files=[...L[S].files,...Array.from(D)],y(L)},k=(S,D)=>{const L=[...g];L[S].files=L[S].files.filter((P,I)=>I!==D),y(L)},w=async S=>{var L;p(S),m({product_name:S.product_name,hsn_code:S.hsn_code,category:S.category,unit:S.unit,packaging_type:S.packaging_type||"",default_supplier:S.default_supplier||"",description:S.description||"",min_stock_level:((L=S.min_stock_level)==null?void 0:L.toString())||"",duty_a1:S.duty_a1||""});const{data:D}=await Z.from("product_sources").select(`
        id,
        supplier_name,
        grade
      `).eq("product_id",S.id);if(D&&D.length>0){const P=await Promise.all(D.map(async I=>{const{data:H}=await Z.from("product_source_documents").select("*").eq("source_id",I.id);return{id:I.id,source_name:I.supplier_name||"",grade:I.grade||"BP",files:[],existing_docs:H||[]}}));y(P)}else y([{source_name:"",grade:"BP",files:[]}]);l(!0)},T=async S=>{try{const{data:D}=await Z.from("sales_invoice_items").select("id").eq("product_id",S.id).limit(1);if(D&&D.length>0){alert('Cannot delete this product. It has been used in sales invoices. Please use the "Deactivate" option instead or contact your administrator.');return}const{data:L}=await Z.from("sales_order_items").select("id").eq("product_id",S.id).limit(1);if(L&&L.length>0){alert("Cannot delete this product. It has been used in sales orders. Please deactivate it instead.");return}const{data:P}=await Z.from("delivery_challan_items").select("id").eq("product_id",S.id).limit(1);if(P&&P.length>0){alert('Cannot delete this product. It has been used in delivery challans. Please use the "Deactivate" option instead.');return}const{data:I}=await Z.from("batches").select("id, batch_number").eq("product_id",S.id);if(I&&I.length>0){if(!confirm(`This product has ${I.length} batch(es). Deleting this product will permanently remove:
- ${I.length} batches
- All related inventory transactions
- All related documents

Are you absolutely sure you want to continue?`))return}else if(!confirm("Are you sure you want to delete this product?"))return;if(I&&I.length>0){for(const V of I)await Z.from("batch_documents").delete().eq("batch_id",V.id),await Z.from("inventory_transactions").delete().eq("batch_id",V.id),await Z.from("finance_expenses").delete().eq("batch_id",V.id);await Z.from("batches").delete().eq("product_id",S.id)}await Z.from("inventory_transactions").delete().eq("product_id",S.id),await Z.from("product_files").delete().eq("product_id",S.id);const{error:H}=await Z.from("products").delete().eq("id",S.id);if(H)throw H;alert("Product deleted successfully"),await v()}catch(D){console.error("Error deleting product:",D);const L=(D==null?void 0:D.message)||"Unknown error occurred";alert(`Failed to delete product: ${L}

If this product is in use, consider deactivating it instead.`)}},R=()=>{p(null),m({product_name:"",hsn_code:"",category:"api",unit:"kg",packaging_type:"",default_supplier:"",description:"",min_stock_level:"",duty_a1:""}),y([{source_name:"",grade:"BP",files:[]}])},q=async S=>{S.preventDefault();try{const D=parseFloat(b.min_stock_level)||null,L={product_name:b.product_name,product_code:null,hsn_code:b.hsn_code,category:b.category,unit:b.unit,packaging_type:b.packaging_type,default_supplier:b.default_supplier,description:b.description,min_stock_level:D,duty_a1:b.duty_a1||null};let P;if(x){const{error:I}=await Z.from("products").update(L).eq("id",x.id);if(I)throw I;P=x.id}else{const{data:I,error:H}=await Z.from("products").insert([{...L,created_by:t==null?void 0:t.id}]).select().single();if(H)throw H;P=I.id}for(const I of g){if(!I.source_name.trim())continue;let H;if(I.id){const{error:V}=await Z.from("product_sources").update({supplier_name:I.source_name,grade:I.grade}).eq("id",I.id);if(V)throw V;H=I.id}else{const{data:V,error:W}=await Z.from("product_sources").insert([{product_id:P,supplier_name:I.source_name,grade:I.grade,created_by:t==null?void 0:t.id}]).select().single();if(W)throw W;H=V.id}for(const V of I.files){const W=V.name.split(".").pop(),M=`${P}/${H}/${Date.now()}.${W}`,{error:se}=await Z.storage.from("product-source-documents").upload(M,V);if(se){console.error("Upload error:",se);continue}const{data:K}=Z.storage.from("product-source-documents").getPublicUrl(M);await Z.from("product_source_documents").insert([{source_id:H,doc_type:"Other",file_url:K.publicUrl,original_filename:V.name,file_size:V.size,uploaded_by:t==null?void 0:t.id}])}}alert(x?"Product updated successfully":"Product added successfully"),l(!1),R(),await v()}catch(D){console.error("Error saving product:",D),alert("Failed to save product: "+D.message)}},z=async(S,D)=>{try{const P=await(await fetch(S)).blob(),I=window.URL.createObjectURL(P),H=document.createElement("a");H.href=I,H.download=D,document.body.appendChild(H),H.click(),window.URL.revokeObjectURL(I),document.body.removeChild(H)}catch(L){console.error("Error downloading:",L),alert("Failed to download file")}},ee=async(S,D)=>{if(confirm("Delete this document?"))try{const{error:L}=await Z.from("product_source_documents").delete().eq("id",S);if(L)throw L;alert("Document deleted"),u&&await _(u.id)}catch(L){console.error("Error deleting document:",L),alert("Failed to delete: "+L.message)}},Y=[{key:"product_name",label:"NAME",render:(S,D)=>n.jsx("button",{onClick:()=>j(D),className:"text-blue-600 hover:text-blue-800 font-medium text-left",children:S||"-"})},{key:"hsn_code",label:"HSN CODE"},{key:"category",label:"CATEGORY",render:S=>S&&typeof S=="string"?S.toUpperCase():"-"},{key:"unit",label:"UNIT",render:S=>S&&typeof S=="string"?S.toUpperCase():"-"},{key:"current_stock",label:"STOCK",render:S=>S!=null&&typeof S=="number"?S.toFixed(2):"-"},{key:"duty_a1",label:"DUTY A1"}];return n.jsxs(Un,{children:[n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Products"}),n.jsx("p",{className:"text-gray-600",children:"Manage your product catalog with packaging details"})]}),n.jsxs("button",{onClick:()=>{R(),l(!0)},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:[n.jsx(Pr,{className:"w-4 h-4"}),"Add Product"]})]}),n.jsx(Fs,{data:r,columns:Y,loading:s,actions:S=>n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>w(S),className:"p-1 text-blue-600 hover:bg-blue-50 rounded transition",children:n.jsx(Aa,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>T(S),className:"p-1 text-red-600 hover:bg-red-50 rounded transition",children:n.jsx(Lr,{className:"w-4 h-4"})})]})})]}),n.jsx(Ot,{isOpen:o,onClose:()=>{l(!1),R()},title:x?"Edit Product":"Add Product",maxWidth:"max-w-4xl",children:n.jsxs("form",{onSubmit:q,className:"space-y-6",children:[n.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg space-y-4",children:[n.jsx("h3",{className:"font-semibold text-gray-900",children:"Product Details"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Product Name *"}),n.jsx("input",{type:"text",required:!0,value:b.product_name,onChange:S=>m({...b,product_name:S.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"HSN Code *"}),n.jsx("input",{type:"text",required:!0,value:b.hsn_code,onChange:S=>m({...b,hsn_code:S.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500"})]})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category *"}),n.jsxs("select",{required:!0,value:b.category,onChange:S=>m({...b,category:S.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"api",children:"API"}),n.jsx("option",{value:"excipients",children:"Excipients"}),n.jsx("option",{value:"packaging",children:"Packaging"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Unit *"}),n.jsxs("select",{required:!0,value:b.unit,onChange:S=>m({...b,unit:S.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"kg",children:"KG"}),n.jsx("option",{value:"liter",children:"Liter"}),n.jsx("option",{value:"pieces",children:"Pieces"}),n.jsx("option",{value:"box",children:"Box"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Min Stock Level"}),n.jsx("input",{type:"number",step:"0.01",value:b.min_stock_level,onChange:S=>m({...b,min_stock_level:S.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Packaging Type"}),n.jsx("input",{type:"text",value:b.packaging_type,onChange:S=>m({...b,packaging_type:S.target.value}),placeholder:"e.g., 25kg drum",className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Duty A1 (%)"}),n.jsx("input",{type:"text",value:b.duty_a1,onChange:S=>m({...b,duty_a1:S.target.value}),placeholder:"e.g., 5.0",className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),n.jsx("textarea",{value:b.description,onChange:S=>m({...b,description:S.target.value}),rows:2,className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500"})]})]}),n.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg space-y-4",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("h3",{className:"font-semibold text-gray-900",children:"Sources"}),n.jsxs("button",{type:"button",onClick:N,className:"flex items-center gap-1 px-3 py-1 text-sm bg-blue-600 text-white rounded hover:bg-blue-700",children:[n.jsx(Pr,{className:"w-3 h-3"}),"Add Source"]})]}),g.map((S,D)=>n.jsxs("div",{className:"bg-white p-4 rounded-lg border border-blue-200 space-y-3",children:[n.jsxs("div",{className:"flex justify-between items-start",children:[n.jsxs("div",{className:"flex-1 grid grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Source Name"}),n.jsx("input",{type:"text",value:S.source_name,onChange:L=>E(D,"source_name",L.target.value),placeholder:"e.g., Everest Organics",className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Grade"}),n.jsxs("select",{value:S.grade,onChange:L=>E(D,"grade",L.target.value),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"BP",children:"BP (British Pharmacopoeia)"}),n.jsx("option",{value:"USP",children:"USP (United States Pharmacopeia)"}),n.jsx("option",{value:"EP",children:"EP (European Pharmacopoeia)"}),n.jsx("option",{value:"IP",children:"IP (Indian Pharmacopoeia)"}),n.jsx("option",{value:"Tech",children:"Tech Grade"}),n.jsx("option",{value:"Food Grade",children:"Food Grade"}),n.jsx("option",{value:"Industrial",children:"Industrial"}),n.jsx("option",{value:"Other",children:"Other"})]})]})]}),g.length>1&&n.jsx("button",{type:"button",onClick:()=>B(D),className:"ml-2 p-1 text-red-600 hover:bg-red-50 rounded",children:n.jsx(wr,{className:"w-4 h-4"})})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Upload Documents"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("label",{className:"flex items-center gap-2 px-3 py-2 bg-gray-50 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-100",children:[n.jsx(Rl,{className:"w-4 h-4 text-gray-600"}),n.jsx("span",{className:"text-sm text-gray-600",children:"Choose Files"}),n.jsx("input",{type:"file",multiple:!0,onChange:L=>C(D,L.target.files),className:"hidden",accept:".pdf,.doc,.docx,.jpg,.jpeg,.png"})]}),n.jsx("span",{className:"text-xs text-gray-500",children:"PDF, DOC, JPG (Max 10MB each)"})]}),S.files.length>0&&n.jsx("div",{className:"mt-2 space-y-1",children:S.files.map((L,P)=>n.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-gray-50 rounded text-sm",children:[n.jsx("span",{className:"text-gray-700",children:L.name}),n.jsx("button",{type:"button",onClick:()=>k(D,P),className:"text-red-600 hover:text-red-800",children:n.jsx(wr,{className:"w-4 h-4"})})]},P))}),S.existing_docs&&S.existing_docs.length>0&&n.jsxs("div",{className:"mt-2 space-y-1",children:[n.jsx("p",{className:"text-xs font-medium text-gray-600",children:"Existing Documents:"}),S.existing_docs.map(L=>n.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-green-50 rounded text-sm",children:[n.jsx("span",{className:"text-gray-700",children:L.original_filename}),n.jsxs("span",{className:"text-xs text-gray-500",children:[(L.file_size/1024).toFixed(1)," KB"]})]},L.id))]})]})]},D))]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[n.jsx("button",{type:"button",onClick:()=>{l(!1),R()},className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),n.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:x?"Update Product":"Add Product"})]})]})}),n.jsx(Ot,{isOpen:c,onClose:()=>{d(!1),f(null),A([])},title:(u==null?void 0:u.product_name)||"Product Details",maxWidth:"max-w-5xl",children:u&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"grid grid-cols-4 gap-4 p-4 bg-gray-50 rounded-lg",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-xs text-gray-500",children:"HSN Code"}),n.jsx("p",{className:"font-medium",children:u.hsn_code})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-xs text-gray-500",children:"Category"}),n.jsx("p",{className:"font-medium",children:(G=u.category)==null?void 0:G.toUpperCase()})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-xs text-gray-500",children:"Unit"}),n.jsx("p",{className:"font-medium",children:(re=u.unit)==null?void 0:re.toUpperCase()})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-xs text-gray-500",children:"Current Stock"}),n.jsx("p",{className:"font-medium",children:((U=u.current_stock)==null?void 0:U.toFixed(2))||"0.00"})]})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Sources & Documents"}),h.length===0?n.jsx("div",{className:"text-center py-8 text-gray-500",children:"No sources added yet. Edit the product to add sources."}):n.jsx("div",{className:"border rounded-lg overflow-hidden",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Source Name"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Grade"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Documents"})]})}),n.jsx("tbody",{className:"divide-y divide-gray-200",children:h.map(S=>n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-4 py-3 font-medium",children:S.supplier_name}),n.jsx("td",{className:"px-4 py-3",children:S.grade}),n.jsx("td",{className:"px-4 py-3",children:S.documents.length===0?n.jsx("span",{className:"text-gray-400 text-sm",children:"No documents"}):n.jsx("div",{className:"space-y-1",children:S.documents.map(D=>n.jsxs("div",{className:"flex items-center justify-between gap-2 text-sm",children:[n.jsx("button",{onClick:()=>z(D.file_url,D.original_filename),className:"text-blue-600 hover:text-blue-800 flex-1 text-left",children:D.original_filename}),n.jsx("button",{onClick:()=>ee(D.id,S.id),className:"text-red-600 hover:text-red-800 p-1",children:n.jsx(Lr,{className:"w-3 h-3"})})]},D.id))})})]},S.id))})]})})]})]})})]})}const O7=["PT","CV","TBK","LTD","CO","PT.","CV."];function U7(e){if(!e)return"";let t=e.trim();for(const r of O7){const a=new RegExp(`^${r}\\.?\\s+`,"i");t=t.replace(a,"")}return t.toLowerCase().trim()}function Qo({value:e,onChange:t,options:r,placeholder:a="Select...",className:s="",disabled:i=!1,required:o=!1}){const[l,c]=Q.useState(!1),[d,u]=Q.useState(-1),[f,h]=Q.useState(""),A=Q.useRef(null),x=Q.useRef(null),p=Q.useRef(null),b=r.find(_=>_.value===e);Q.useEffect(()=>{const _=j=>{A.current&&!A.current.contains(j.target)&&(c(!1),h(""))};if(l)return document.addEventListener("mousedown",_),()=>document.removeEventListener("mousedown",_)},[l]),Q.useEffect(()=>{if(l&&e){const _=r.findIndex(j=>j.value===e);_!==-1&&(u(_),m(_))}},[l,e,r]);const m=_=>{if(x.current){const j=x.current.children[_];j&&j.scrollIntoView({block:"nearest"})}},g=_=>{if(!l){(_.key==="Enter"||_.key===" "||_.key==="ArrowDown")&&(_.preventDefault(),c(!0));return}switch(_.key){case"Escape":_.preventDefault(),c(!1),h("");break;case"Enter":_.preventDefault(),d>=0&&d<r.length&&(t(r[d].value),c(!1),h(""));break;case"ArrowDown":_.preventDefault(),u(j=>{const N=j<r.length-1?j+1:j;return m(N),N});break;case"ArrowUp":_.preventDefault(),u(j=>{const N=j>0?j-1:0;return m(N),N});break;case"Home":_.preventDefault(),u(0),m(0);break;case"End":_.preventDefault(),u(r.length-1),m(r.length-1);break;default:_.key.length===1&&!_.ctrlKey&&!_.metaKey&&(_.preventDefault(),y(_.key));break}},y=_=>{p.current&&clearTimeout(p.current);const j=f+_.toLowerCase();h(j);const N=r.findIndex(B=>U7(B.label).startsWith(j));N!==-1&&(u(N),m(N)),p.current=setTimeout(()=>{h("")},1e3)},v=_=>{t(_),c(!1),h("")};return n.jsxs("div",{ref:A,className:"relative",children:[n.jsxs("button",{type:"button",onClick:()=>!i&&c(!l),onKeyDown:g,disabled:i,className:`w-full px-3 py-2 border rounded-lg text-left flex items-center justify-between ${i?"bg-gray-100 cursor-not-allowed":"bg-white hover:border-blue-500"} ${s}`,"aria-haspopup":"listbox","aria-expanded":l,required:o,children:[n.jsx("span",{className:b?"text-gray-900":"text-gray-400",children:b?b.label:a}),n.jsx(Cs,{className:`w-4 h-4 text-gray-400 transition-transform ${l?"rotate-180":""}`})]}),l&&n.jsx("div",{ref:x,className:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto",role:"listbox",children:r.length===0?n.jsx("div",{className:"px-3 py-2 text-gray-500 text-sm",children:"No options available"}):r.map((_,j)=>n.jsx("div",{onClick:()=>v(_.value),className:`px-3 py-2 cursor-pointer ${j===d?"bg-blue-500 text-white":_.value===e?"bg-blue-50 text-blue-900":"hover:bg-gray-100"}`,role:"option","aria-selected":_.value===e,children:_.label},_.value))}),f&&l&&n.jsxs("div",{className:"absolute top-full left-0 mt-1 px-2 py-1 bg-gray-900 text-white text-xs rounded shadow-lg z-50",children:["Searching: ",f]})]})}const DE=["Jakarta Barat","Jakarta Pusat","Jakarta Selatan","Jakarta Timur","Jakarta Utara","Kepulauan Seribu","Banda Aceh","Sabang","Lhokseumawe","Langsa","Subulussalam","Aceh Besar","Aceh Barat","Aceh Selatan","Aceh Timur","Aceh Utara","Aceh Tengah","Aceh Tenggara","Aceh Barat Daya","Aceh Jaya","Aceh Singkil","Aceh Tamiang","Bener Meriah","Bireuen","Gayo Lues","Nagan Raya","Pidie","Pidie Jaya","Simeulue","Medan","Pematang Siantar","Sibolga","Tanjung Balai","Binjai","Tebing Tinggi","Padang Sidempuan","Gunungsitoli","Asahan","Batubara","Dairi","Deli Serdang","Humbang Hasundutan","Karo","Labuhanbatu","Labuhanbatu Selatan","Labuhanbatu Utara","Langkat","Mandailing Natal","Nias","Nias Barat","Nias Selatan","Nias Utara","Padang Lawas","Padang Lawas Utara","Pakpak Bharat","Samosir","Serdang Bedagai","Simalungun","Tapanuli Selatan","Tapanuli Tengah","Tapanuli Utara","Toba Samosir","Padang","Bukittinggi","Padang Panjang","Payakumbuh","Pariaman","Sawahlunto","Solok","Agam","Dharmasraya","Kepulauan Mentawai","Lima Puluh Kota","Padang Pariaman","Pasaman","Pasaman Barat","Pesisir Selatan","Sijunjung","Solok Selatan","Tanah Datar","Pekanbaru","Dumai","Bengkalis","Indragiri Hilir","Indragiri Hulu","Kampar","Kepulauan Meranti","Kuantan Singingi","Pelalawan","Rokan Hilir","Rokan Hulu","Siak","Batam","Tanjung Pinang","Bintan","Karimun","Kepulauan Anambas","Lingga","Natuna","Jambi","Sungai Penuh","Batang Hari","Bungo","Kerinci","Merangin","Muaro Jambi","Sarolangun","Tanjung Jabung Barat","Tanjung Jabung Timur","Tebo","Palembang","Prabumulih","Pagar Alam","Lubuklinggau","Banyuasin","Empat Lawang","Lahat","Muara Enim","Musi Banyuasin","Musi Rawas","Musi Rawas Utara","Ogan Ilir","Ogan Komering Ilir","Ogan Komering Ulu","Ogan Komering Ulu Selatan","Ogan Komering Ulu Timur","Penukal Abab Lematang Ilir","Bengkulu","Bengkulu Selatan","Bengkulu Tengah","Bengkulu Utara","Kaur","Kepahiang","Lebong","Mukomuko","Rejang Lebong","Seluma","Bandar Lampung","Metro","Lampung Barat","Lampung Selatan","Lampung Tengah","Lampung Timur","Lampung Utara","Mesuji","Pesawaran","Pesisir Barat","Pringsewu","Tanggamus","Tulang Bawang","Tulang Bawang Barat","Way Kanan","Pangkal Pinang","Bangka","Bangka Barat","Bangka Selatan","Bangka Tengah","Belitung","Belitung Timur","Serang","Tangerang","Tangerang Selatan","Cilegon","Lebak","Pandeglang","Tangerang (Kabupaten)","Bandung","Bekasi","Bogor","Cimahi","Cirebon","Depok","Sukabumi","Tasikmalaya","Banjar","Bandung (Kabupaten)","Bandung Barat","Bekasi (Kabupaten)","Bogor (Kabupaten)","Ciamis","Cianjur","Cirebon (Kabupaten)","Garut","Indramayu","Karawang","Kuningan","Majalengka","Pangandaran","Purwakarta","Subang","Sukabumi (Kabupaten)","Sumedang","Tasikmalaya (Kabupaten)","Semarang","Magelang","Pekalongan","Salatiga","Surakarta","Tegal","Banjarnegara","Banyumas","Batang","Blora","Boyolali","Brebes","Cilacap","Demak","Grobogan","Jepara","Karanganyar","Kebumen","Kendal","Klaten","Kudus","Magelang (Kabupaten)","Pati","Pekalongan (Kabupaten)","Pemalang","Purbalingga","Purworejo","Rembang","Semarang (Kabupaten)","Sragen","Sukoharjo","Tegal (Kabupaten)","Temanggung","Wonogiri","Wonosobo","Yogyakarta","Bantul","Gunung Kidul","Kulon Progo","Sleman","Surabaya","Batu","Blitar","Kediri","Madiun","Malang","Mojokerto","Pasuruan","Probolinggo","Bangkalan","Banyuwangi","Blitar (Kabupaten)","Bojonegoro","Bondowoso","Gresik","Jember","Jombang","Kediri (Kabupaten)","Lamongan","Lumajang","Madiun (Kabupaten)","Magetan","Malang (Kabupaten)","Mojokerto (Kabupaten)","Nganjuk","Ngawi","Pacitan","Pamekasan","Pasuruan (Kabupaten)","Ponorogo","Probolinggo (Kabupaten)","Sampang","Sidoarjo","Situbondo","Sumenep","Trenggalek","Tuban","Tulungagung","Denpasar","Badung","Bangli","Buleleng","Gianyar","Jembrana","Karangasem","Klungkung","Tabanan","Mataram","Bima","Bima (Kabupaten)","Dompu","Lombok Barat","Lombok Tengah","Lombok Timur","Lombok Utara","Sumbawa","Sumbawa Barat","Kupang","Alor","Belu","Ende","Flores Timur","Kupang (Kabupaten)","Lembata","Malaka","Manggarai","Manggarai Barat","Manggarai Timur","Nagekeo","Ngada","Rote Ndao","Sabu Raijua","Sikka","Sumba Barat","Sumba Barat Daya","Sumba Tengah","Sumba Timur","Timor Tengah Selatan","Timor Tengah Utara","Pontianak","Singkawang","Bengkayang","Kapuas Hulu","Kayong Utara","Ketapang","Kubu Raya","Landak","Melawi","Mempawah","Sambas","Sanggau","Sekadau","Sintang","Palangkaraya","Barito Selatan","Barito Timur","Barito Utara","Gunung Mas","Kapuas","Katingan","Kotawaringin Barat","Kotawaringin Timur","Lamandau","Murung Raya","Pulang Pisau","Seruyan","Sukamara","Banjarmasin","Banjarbaru","Balangan","Banjar","Barito Kuala","Hulu Sungai Selatan","Hulu Sungai Tengah","Hulu Sungai Utara","Kotabaru","Tabalong","Tanah Bumbu","Tanah Laut","Tapin","Balikpapan","Bontang","Samarinda","Berau","Kutai Barat","Kutai Kartanegara","Kutai Timur","Mahakam Ulu","Paser","Penajam Paser Utara","Tarakan","Bulungan","Malinau","Nunukan","Tana Tidung","Manado","Bitung","Kotamobagu","Tomohon","Bolaang Mongondow","Bolaang Mongondow Selatan","Bolaang Mongondow Timur","Bolaang Mongondow Utara","Kepulauan Sangihe","Kepulauan Siau Tagulandang Biaro","Kepulauan Talaud","Minahasa","Minahasa Selatan","Minahasa Tenggara","Minahasa Utara","Palu","Banggai","Banggai Kepulauan","Banggai Laut","Buol","Donggala","Morowali","Morowali Utara","Parigi Moutong","Poso","Sigi","Tojo Una-Una","Tolitoli","Makassar","Palopo","Parepare","Bantaeng","Barru","Bone","Bulukumba","Enrekang","Gowa","Jeneponto","Kepulauan Selayar","Luwu","Luwu Timur","Luwu Utara","Maros","Pangkajene dan Kepulauan","Pinrang","Sidenreng Rappang","Sinjai","Soppeng","Takalar","Tana Toraja","Toraja Utara","Wajo","Kendari","Bau-Bau","Bombana","Buton","Buton Selatan","Buton Tengah","Buton Utara","Kolaka","Kolaka Timur","Kolaka Utara","Konawe","Konawe Kepulauan","Konawe Selatan","Konawe Utara","Muna","Muna Barat","Wakatobi","Gorontalo","Boalemo","Bone Bolango","Gorontalo (Kabupaten)","Gorontalo Utara","Pohuwato","Mamuju","Majene","Mamasa","Mamuju (Kabupaten)","Mamuju Tengah","Mamuju Utara","Pasangkayu","Polewali Mandar","Ambon","Tual","Buru","Buru Selatan","Kepulauan Aru","Maluku Barat Daya","Maluku Tengah","Maluku Tenggara","Maluku Tenggara Barat","Seram Bagian Barat","Seram Bagian Timur","Ternate","Tidore Kepulauan","Halmahera Barat","Halmahera Selatan","Halmahera Tengah","Halmahera Timur","Halmahera Utara","Kepulauan Sula","Pulau Morotai","Pulau Taliabu","Sorong","Fakfak","Kaimana","Manokwari","Manokwari Selatan","Maybrat","Pegunungan Arfak","Raja Ampat","Sorong (Kabupaten)","Sorong Selatan","Tambrauw","Teluk Bintuni","Teluk Wondama","Jayapura","Asmat","Biak Numfor","Boven Digoel","Deiyai","Dogiyai","Intan Jaya","Jayapura (Kabupaten)","Jayawijaya","Keerom","Kepulauan Yapen","Lanny Jaya","Mamberamo Raya","Mamberamo Tengah","Mappi","Merauke","Mimika","Nabire","Nduga","Paniai","Pegunungan Bintang","Puncak","Puncak Jaya","Sarmi","Supiori","Tolikara","Waropen","Yahukimo","Yalimo"].sort(),R7=["Cash on Delivery","Net 7 days","Net 10 days","Net 15 days","Net 30 days","Net 45 days","Net 60 days","Net 90 days","End of Month","2/10 Net 30","1/10 Net 30","Due on Receipt","Advance Payment","50% Advance, 50% on Delivery","Monthly Billing"];function M7(){const{t:e}=cn(),{profile:t}=Cr(),[r,a]=Q.useState([]),[s,i]=Q.useState(!0),[o,l]=Q.useState(!1),[c,d]=Q.useState(null),[u,f]=Q.useState({company_name:"",npwp:"",address:"",city:"Jakarta Pusat",country:"Indonesia",contact_person:"",email:"",phone:"",pbf_license:"",gst_vat_type:"",payment_terms:""});Q.useEffect(()=>{h()},[]);const h=async()=>{try{const{data:g,error:y}=await Z.from("customers").select("*").eq("is_active",!0).order("created_at",{ascending:!1});if(y)throw y;a(g||[])}catch(g){console.error("Error loading customers:",g)}finally{i(!1)}},A=async g=>{g.preventDefault();try{if(c){const{error:y}=await Z.from("customers").update(u).eq("id",c.id);if(y)throw y}else{const{error:y}=await Z.from("customers").insert([{...u,created_by:t==null?void 0:t.id}]);if(y)throw y}l(!1),d(null),x(),h()}catch(y){console.error("Error saving customer:",y),alert("Failed to save customer")}},x=()=>{f({company_name:"",npwp:"",address:"",city:"Jakarta Pusat",country:"Indonesia",contact_person:"",email:"",phone:"",pbf_license:"",gst_vat_type:"",payment_terms:""})},p=g=>{d(g),f({company_name:g.company_name,npwp:g.npwp,address:g.address,city:g.city,country:g.country,contact_person:g.contact_person,email:g.email,phone:g.phone,pbf_license:g.pbf_license||"",gst_vat_type:g.gst_vat_type,payment_terms:g.payment_terms}),l(!0)},b=async g=>{if(confirm("Are you sure you want to delete this customer?"))try{const{error:y}=await Z.from("customers").update({is_active:!1}).eq("id",g.id);if(y)throw y;h()}catch(y){console.error("Error deleting customer:",y),alert("Failed to delete customer")}},m=[{key:"company_name",label:e("customers.companyName"),sortable:!0},{key:"contact_person",label:e("customers.contactPerson"),sortable:!0,render:(g,y)=>n.jsxs("div",{children:[n.jsx("div",{children:y.contact_person}),n.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mt-1",children:[y.email&&n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(ua,{className:"w-3 h-3"}),y.email]}),y.phone&&n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(Ul,{className:"w-3 h-3"}),y.phone]})]})]})},{key:"city",label:e("customers.city"),sortable:!0},{key:"payment_terms",label:e("customers.paymentTerms"),sortable:!0}];return n.jsxs(Un,{children:[n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:e("customers.title")}),n.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your customer relationships"})]}),n.jsxs("button",{onClick:()=>{d(null),x(),l(!0)},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:[n.jsx(Pr,{className:"w-5 h-5"}),e("customers.addCustomer")]})]}),n.jsx(Fs,{data:r,columns:m,loading:s,actions:g=>n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>p(g),className:"p-1 text-blue-600 hover:bg-blue-50 rounded transition",children:n.jsx(Aa,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>b(g),className:"p-1 text-red-600 hover:bg-red-50 rounded transition",children:n.jsx(Lr,{className:"w-4 h-4"})})]})})]}),n.jsx(Ot,{isOpen:o,onClose:()=>l(!1),title:e(c?"customers.editCustomer":"customers.addCustomer"),size:"xl",children:n.jsxs("form",{onSubmit:A,className:"space-y-3",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:[e("customers.companyName")," *"]}),n.jsx("input",{type:"text",required:!0,value:u.company_name,onChange:g=>f({...u,company_name:g.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:e("customers.npwp")}),n.jsx("input",{type:"text",value:u.npwp,onChange:g=>f({...u,npwp:g.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:[e("customers.contactPerson")," *"]}),n.jsx("input",{type:"text",required:!0,value:u.contact_person,onChange:g=>f({...u,contact_person:g.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:e("customers.email")}),n.jsx("input",{type:"email",value:u.email,onChange:g=>f({...u,email:g.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:e("customers.phone")}),n.jsx("input",{type:"tel",value:u.phone,onChange:g=>f({...u,phone:g.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"PBF License (No.Izin PBF)"}),n.jsx("input",{type:"text",value:u.pbf_license,onChange:g=>f({...u,pbf_license:g.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",placeholder:"e.g., 01.001.722.9-411.000"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:e("customers.city")}),n.jsx(Qo,{value:u.city,onChange:g=>f({...u,city:g}),options:[{value:"",label:"Select City"},...DE.map(g=>({value:g,label:g}))],placeholder:"Select City",className:"text-sm"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:e("customers.country")}),n.jsx("input",{type:"text",value:u.country,readOnly:!0,className:"w-full px-2 py-1.5 text-sm border border-gray-200 rounded bg-gray-50 text-gray-600"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:e("customers.gstVatType")}),n.jsx("input",{type:"text",value:u.gst_vat_type,onChange:g=>f({...u,gst_vat_type:g.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:e("customers.paymentTerms")}),n.jsxs("select",{value:u.payment_terms,onChange:g=>f({...u,payment_terms:g.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",children:[n.jsx("option",{value:"",children:"Select Payment Terms"}),R7.map(g=>n.jsx("option",{value:g,children:g},g))]})]})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:e("customers.address")}),n.jsx("textarea",{value:u.address,onChange:g=>f({...u,address:g.target.value}),rows:2,className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500"})]}),n.jsxs("div",{className:"flex justify-end gap-2 pt-2 border-t",children:[n.jsx("button",{type:"button",onClick:()=>l(!1),className:"px-3 py-1.5 text-sm text-gray-700 bg-gray-100 rounded hover:bg-gray-200 transition",children:e("common.cancel")}),n.jsx("button",{type:"submit",className:"px-3 py-1.5 text-sm bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:e("common.save")})]})]})})]})}function Q7(){const{t:e}=cn(),{setCurrentPage:t}=Go(),[r,a]=Q.useState([]),[s,i]=Q.useState(!0),[o,l]=Q.useState(null),[c,d]=Q.useState([]);Q.useEffect(()=>{u()},[]);const u=async()=>{try{const{data:N,error:B}=await Z.from("product_stock_summary").select("*").order("product_name");if(B)throw B;const{data:E}=await Z.from("import_requirements").select("product_id, shortage_quantity").in("status",["pending","ordered"]),C=new Map;E==null||E.forEach(T=>{const R=C.get(T.product_id)||0;C.set(T.product_id,R+Number(T.shortage_quantity))});const w=(await Promise.all((N||[]).map(async T=>{const{data:R}=await Z.from("stock_reservations").select("reserved_quantity").eq("product_id",T.product_id).eq("status","active"),q=(R==null?void 0:R.reduce((G,re)=>G+Number(re.reserved_quantity),0))||0,z=C.get(T.product_id)||0,ee=z>0?-z:q,Y=T.total_current_stock-q;return{...T,reserved_stock:ee,available_quantity:Y}}))).filter(T=>T.total_current_stock>0||T.reserved_stock!==0||C.has(T.product_id));a(w)}catch(N){console.error("Error loading stock summary:",N)}finally{i(!1)}},f=async N=>{try{const{data:B,error:E}=await Z.from("batches").select("id, batch_number, current_stock, reserved_stock, expiry_date, import_date").eq("product_id",N).eq("is_active",!0).gt("current_stock",0).order("expiry_date",{ascending:!0,nullsFirst:!1});if(E)throw E;const C=(B||[]).map(k=>({...k,available_quantity:k.current_stock-(k.reserved_stock||0)}));d(C)}catch(B){console.error("Error loading product batches:",B)}},h=async N=>{l(N),await f(N.product_id)},A=()=>{t("batches")},x=N=>N?new Date(N)<new Date:!1,p=N=>{if(!N)return!1;const B=new Date;return B.setDate(B.getDate()+30),new Date(N)<=B&&!x(N)},b=(N,B)=>N===0?"text-gray-400":N<500?"text-orange-600":"text-green-600",m=[{key:"product_name",label:"Product",render:(N,B)=>n.jsxs("div",{className:"py-1",children:[n.jsx("span",{className:"font-medium text-gray-900",children:B.product_name}),n.jsxs("span",{className:"text-xs text-gray-500 ml-2 capitalize",children:["(",B.category,")"]})]})},{key:"stock",label:"Total Stock",render:(N,B)=>n.jsxs("span",{className:`font-semibold ${b(B.total_current_stock,B.active_batch_count)}`,children:[B.total_current_stock.toLocaleString()," ",B.unit]})},{key:"reserved",label:"Reserved",render:(N,B)=>B.reserved_stock===0?n.jsx("span",{className:"text-gray-400",children:"-"}):B.reserved_stock<0?n.jsxs("span",{className:"text-red-600 font-semibold",children:[B.reserved_stock.toLocaleString()," ",B.unit]}):n.jsxs("span",{className:"text-orange-600 font-medium",children:[B.reserved_stock.toLocaleString()," ",B.unit]})},{key:"available",label:"Available",render:(N,B)=>n.jsxs("span",{className:"text-green-600 font-semibold",children:[B.available_quantity.toLocaleString()," ",B.unit]})},{key:"batches",label:"Batches",render:(N,B)=>n.jsxs("span",{className:"text-sm",children:[n.jsx("span",{className:"text-blue-600 font-medium",children:B.active_batch_count}),B.expired_batch_count>0&&n.jsxs("span",{className:"text-red-600 ml-1",children:["(",B.expired_batch_count," expired)"]})]})},{key:"expiry",label:"Nearest Expiry",render:(N,B)=>B.nearest_expiry_date?n.jsxs("span",{className:`text-sm ${x(B.nearest_expiry_date)?"text-red-700 font-semibold":p(B.nearest_expiry_date)?"text-orange-600 font-semibold":"text-gray-700"}`,children:[new Date(B.nearest_expiry_date).toLocaleDateString(),p(B.nearest_expiry_date)&&n.jsx(Ga,{className:"w-3 h-3 inline ml-1"})]}):n.jsx("span",{className:"text-gray-400 text-sm",children:"-"})}],g=[{key:"batch_number",label:"Batch",render:(N,B)=>n.jsx("span",{className:"font-mono text-sm",children:B.batch_number})},{key:"current_stock",label:"Total",render:(N,B)=>n.jsxs("span",{className:"font-semibold text-sm",children:[B.current_stock.toLocaleString()," ",o==null?void 0:o.unit]})},{key:"reserved_stock",label:"Reserved",render:(N,B)=>n.jsx("span",{className:"text-orange-600 font-medium text-sm",children:B.reserved_stock>0?`${B.reserved_stock.toLocaleString()} ${o==null?void 0:o.unit}`:"-"})},{key:"available_quantity",label:"Available",render:(N,B)=>n.jsxs("span",{className:"text-green-600 font-semibold text-sm",children:[B.available_quantity.toLocaleString()," ",o==null?void 0:o.unit]})},{key:"import_date",label:"Imported",render:(N,B)=>n.jsx("span",{className:"text-sm text-gray-600",children:new Date(B.import_date).toLocaleDateString()})},{key:"expiry_date",label:"Expiry",render:(N,B)=>n.jsx("span",{className:`text-sm ${x(B.expiry_date)?"text-red-700 font-semibold":p(B.expiry_date)?"text-orange-600 font-semibold":"text-gray-700"}`,children:B.expiry_date?new Date(B.expiry_date).toLocaleDateString():"-"})}],y=r.reduce((N,B)=>N+B.total_current_stock,0),v=r.length,_=r.filter(N=>N.total_current_stock<500).length,j=r.filter(N=>N.nearest_expiry_date&&p(N.nearest_expiry_date)).length;return n.jsx(Un,{children:n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Stock Inventory"}),n.jsx("p",{className:"text-gray-600 mt-1",children:"Current stock levels across all products"})]}),n.jsxs("button",{onClick:A,className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition",children:[n.jsx(Rr,{className:"w-5 h-5"}),"View Batches"]})]}),o&&n.jsxs("div",{className:"bg-blue-50 rounded-lg shadow-md p-4 border-l-4 border-blue-500",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:[o.product_name," - Batch Details"]}),n.jsx("button",{onClick:()=>l(null),className:"text-gray-500 hover:text-gray-700 text-xl font-bold",children:""})]}),n.jsx(Fs,{columns:g,data:c,loading:!1})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[n.jsx(Fs,{columns:m,data:r,loading:s,onRowClick:h}),!s&&r.length===0&&n.jsxs("div",{className:"text-center py-12",children:[n.jsx(Rr,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),n.jsx("p",{className:"text-gray-500 text-lg",children:"No stock available"}),n.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"All products are currently out of stock"})]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[n.jsx("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg shadow-lg p-6 text-white",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-blue-100 text-sm font-medium",children:"Products In Stock"}),n.jsx("p",{className:"text-3xl font-bold mt-1",children:v})]}),n.jsx(Rr,{className:"w-10 h-10 text-blue-200"})]})}),n.jsx("div",{className:"bg-gradient-to-br from-green-500 to-green-600 rounded-lg shadow-lg p-6 text-white",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-green-100 text-sm font-medium",children:"Total Stock Units"}),n.jsx("p",{className:"text-3xl font-bold mt-1",children:y.toLocaleString()})]}),n.jsx(zo,{className:"w-10 h-10 text-green-200"})]})}),n.jsx("div",{className:"bg-gradient-to-br from-orange-500 to-orange-600 rounded-lg shadow-lg p-6 text-white",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-orange-100 text-sm font-medium",children:"Low Stock Items"}),n.jsx("p",{className:"text-3xl font-bold mt-1",children:_})]}),n.jsx(Ga,{className:"w-10 h-10 text-orange-200"})]})}),n.jsx("div",{className:"bg-gradient-to-br from-red-500 to-red-600 rounded-lg shadow-lg p-6 text-white",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-red-100 text-sm font-medium",children:"Near Expiry"}),n.jsx("p",{className:"text-3xl font-bold mt-1",children:j})]}),n.jsx(ja,{className:"w-10 h-10 text-red-200"})]})})]})]})})}const H7=["application/pdf","image/jpeg","image/jpg","image/png","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/msword"],q7=10*1024*1024,$7=[{value:"invoice",label:"Invoice"},{value:"bill_of_lading",label:"Bill of Lading"},{value:"coa",label:"Certificate of Analysis"},{value:"packing_list",label:"Packing List"},{value:"other",label:"Other"}];function LE({batchId:e,existingFiles:t=[],onFilesChange:r,disabled:a=!1}){const[s,i]=Q.useState(t),[o,l]=Q.useState(!1),[c,d]=Q.useState(!1),u=Q.useRef(null),f=Q.useRef(null),h=N=>{i(N),r==null||r(N)};Q.useEffect(()=>{const N=B=>{var k;if(a)return;const E=(k=B.clipboardData)==null?void 0:k.items;if(!E)return;const C=[];for(let w=0;w<E.length;w++){const T=E[w];if(T.type.indexOf("image")!==-1){B.preventDefault();const R=T.getAsFile();if(R){const q=`pasted-image-${Date.now()}.png`,z=new Zb([R],q,{type:R.type});C.push(z)}}}if(C.length>0){const w=new DataTransfer;C.forEach(T=>w.items.add(T)),p(w.files),d(!0),setTimeout(()=>d(!1),2e3)}};return document.addEventListener("paste",N),()=>document.removeEventListener("paste",N)},[a,s]);const A=()=>{a||d(!0)},x=()=>{d(!1)},p=N=>{if(!N||N.length===0)return;const B=[];Array.from(N).forEach(E=>{if(!H7.includes(E.type)){alert(`File ${E.name} is not a supported format. Please upload PDF, JPG, PNG, XLSX, or DOCX files.`);return}if(E.size>q7){alert(`File ${E.name} exceeds the 10MB size limit.`);return}B.push({file:E,file_name:E.name,file_type:"other",file_size:E.size,uploading:!1})}),h([...s,...B])},b=N=>{N.preventDefault(),l(!1),p(N.dataTransfer.files)},m=N=>{N.preventDefault(),l(!0)},g=()=>{l(!1)},y=async N=>{const B=s[N];if(B.id&&e){if(!confirm("Are you sure you want to delete this document?"))return;try{const{error:C}=await Z.from("batch_documents").delete().eq("id",B.id);if(C)throw C;if(B.file_url){const k=B.file_url.split("/"),w=k[k.length-1],T=`${e}/${w}`;await Z.storage.from("batch-documents").remove([T])}}catch(C){console.error("Error deleting file:",C),alert("Failed to delete file. Please try again.");return}}const E=s.filter((C,k)=>k!==N);h(E)},v=(N,B)=>{const E=[...s];E[N].file_type=B,h(E)},_=N=>{var E;const B=(E=N.split(".").pop())==null?void 0:E.toLowerCase();return["jpg","jpeg","png"].includes(B||"")?n.jsx(Jw,{className:"w-5 h-5 text-blue-600"}):B==="pdf"?n.jsx(Zt,{className:"w-5 h-5 text-red-600"}):n.jsx(Zb,{className:"w-5 h-5 text-gray-600"})},j=N=>N<1024?N+" B":N<1024*1024?(N/1024).toFixed(1)+" KB":(N/(1024*1024)).toFixed(1)+" MB";return n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{ref:f,onDrop:b,onDragOver:m,onDragLeave:g,onMouseEnter:A,onMouseLeave:x,className:`border-2 border-dashed rounded-lg p-6 text-center transition-colors relative ${o?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"} ${a?"opacity-50 cursor-not-allowed":"cursor-pointer"}`,onClick:()=>{var N;return!a&&((N=u.current)==null?void 0:N.click())},children:[n.jsx(Rl,{className:`w-12 h-12 mx-auto mb-3 ${o?"text-blue-500":"text-gray-400"}`}),n.jsxs("p",{className:"text-sm text-gray-600 mb-1",children:[n.jsx("span",{className:"font-medium text-blue-600",children:"Click to upload"})," or drag and drop"]}),n.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"PDF, JPG, PNG, XLSX, DOCX (max 10MB)"}),c&&n.jsxs("div",{className:"flex items-center justify-center gap-2 text-xs text-green-600 font-medium animate-pulse",children:[n.jsx(wE,{className:"w-4 h-4"}),n.jsx("span",{children:"Press Ctrl+V to paste images from clipboard"})]}),n.jsx("input",{ref:u,type:"file",multiple:!0,accept:".pdf,.jpg,.jpeg,.png,.xlsx,.xls,.docx,.doc",onChange:N=>p(N.target.files),className:"hidden",disabled:a})]}),s.length>0&&n.jsxs("div",{className:"space-y-2",children:[n.jsxs("h4",{className:"text-sm font-medium text-gray-700",children:["Documents (",s.length,")"]}),s.map((N,B)=>n.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg border border-gray-200",children:[n.jsx("div",{className:"flex-shrink-0",children:_(N.file_name)}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("div",{className:"flex items-center gap-2",children:N.file_url?n.jsx("a",{href:N.file_url,target:"_blank",rel:"noopener noreferrer",className:"text-sm font-medium text-blue-600 hover:text-blue-700 truncate",onClick:E=>E.stopPropagation(),children:N.file_name}):n.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:N.file_name})}),n.jsx("p",{className:"text-xs text-gray-500",children:j(N.file_size)})]}),n.jsx("select",{value:N.file_type,onChange:E=>v(B,E.target.value),className:"text-xs px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:a,onClick:E=>E.stopPropagation(),children:$7.map(E=>n.jsx("option",{value:E.value,children:E.label},E.value))}),N.uploading&&n.jsx("div",{className:"flex-shrink-0",children:n.jsx("div",{className:"w-5 h-5 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"})}),N.error&&n.jsx("div",{className:"flex-shrink-0",title:N.error,children:n.jsx(En,{className:"w-5 h-5 text-red-600"})}),!a&&!N.uploading&&n.jsx("button",{type:"button",onClick:E=>{E.stopPropagation(),y(B)},className:"flex-shrink-0 p-1 text-red-600 hover:bg-red-50 rounded transition",children:n.jsx(wr,{className:"w-4 h-4"})})]},B))]})]})}function K7(){const{t:e}=cn(),{profile:t}=Cr(),[r,a]=Q.useState([]),[s,i]=Q.useState([]),[o,l]=Q.useState([]),[c,d]=Q.useState(!0),[u,f]=Q.useState(!1),[h,A]=Q.useState(!1),[x,p]=Q.useState(!1),[b,m]=Q.useState([]),[g,y]=Q.useState(null),[v,_]=Q.useState(null),[j,N]=Q.useState([]),[B,E]=Q.useState(null),[C,k]=Q.useState([]),[w,T]=Q.useState({batch_number:"",product_id:"",import_container_id:"",import_date:"",import_quantity:0,packaging_details:"",import_price_usd:0,exchange_rate_usd_to_idr:0,duty_charges:0,duty_percent:0,duty_charge_type:"fixed",freight_charges:0,freight_charge_type:"fixed",other_charges:0,other_charge_type:"fixed",expiry_date:"",per_pack_weight:"",pack_type:"bag"});Q.useEffect(()=>{R(),q(),z()},[]);const R=async()=>{try{const{data:K,error:he}=await Z.from("batches").select(`
          *,
          products(product_name, product_code, unit),
          import_containers(container_ref)
        `).order("import_date",{ascending:!1});if(he)throw he;const ne=await Promise.all((K||[]).map(async te=>{const{count:ce}=await Z.from("batch_documents").select("*",{count:"exact",head:!0}).eq("batch_id",te.id);return{...te,document_count:ce||0}}));a(ne)}catch(K){console.error("Error loading batches:",K)}finally{d(!1)}},q=async()=>{try{const{data:K,error:he}=await Z.from("products").select("id, product_name, product_code, unit, duty_percent").eq("is_active",!0).order("product_name");if(he)throw he;i(K||[])}catch(K){console.error("Error loading products:",K)}},z=async()=>{try{const{data:K,error:he}=await Z.from("import_containers").select("id, container_ref, status").order("container_ref",{ascending:!1});if(he)throw he;l(K||[])}catch(K){console.error("Error loading import containers:",K)}},ee=async K=>{try{const{data:he,error:ne}=await Z.from("batch_documents").select("*").eq("batch_id",K).order("uploaded_at",{ascending:!1});if(ne)throw ne;m(he||[]),y(K),A(!0)}catch(he){console.error("Error loading documents:",he),alert("Failed to load documents")}},Y=async K=>{if(K.preventDefault(),w.import_price_usd>0&&w.exchange_rate_usd_to_idr<=0){alert("Please enter a valid exchange rate");return}try{let he=0;if(B){const{data:Le,error:we}=await Z.from("sales_invoice_items").select("quantity").eq("batch_id",B.id);if(we)throw we;if(he=(Le==null?void 0:Le.reduce((ge,Re)=>ge+parseFloat(Re.quantity||0),0))||0,w.import_quantity<he){alert(`Cannot reduce import quantity to ${w.import_quantity}. You have already sold ${he} units from this batch.`);return}}const ne=w.import_price_usd*w.exchange_rate_usd_to_idr,te=(Le,we,ge)=>we==="percentage"?ge*Le/100:Le,ce=ne*w.duty_percent/100,_e=te(w.freight_charges,w.freight_charge_type,ne),de=te(w.other_charges,w.other_charge_type,ne);let ye;if(B){const Le=w.import_quantity-B.import_quantity,we={batch_number:w.batch_number,product_id:w.product_id,import_container_id:w.import_container_id&&w.import_container_id.trim()!==""?w.import_container_id:null,import_date:w.import_date,import_quantity:w.import_quantity,packaging_details:w.packaging_details,import_price:ne,import_price_usd:w.import_price_usd||null,exchange_rate_usd_to_idr:w.exchange_rate_usd_to_idr||null,duty_percent:w.duty_percent||0,duty_charges:ce,duty_charge_type:"percentage",freight_charges:_e,freight_charge_type:w.freight_charge_type,other_charges:de,other_charge_type:w.other_charge_type,expiry_date:w.expiry_date||null},{error:ge}=await Z.from("batches").update(we).eq("id",B.id);if(ge)throw ge;if(ye=B.id,Le!==0){const{error:Re}=await Z.from("inventory_transactions").update({quantity:w.import_quantity,notes:`Updated import quantity from ${B.import_quantity} to ${w.import_quantity} (Delta: ${Le>0?"+":""}${Le})`}).eq("batch_id",B.id).eq("transaction_type","purchase");Re&&console.error("Error updating purchase transaction:",Re);const{data:et}=await Z.from("inventory_transactions").select("quantity").eq("batch_id",B.id),Ye=(et==null?void 0:et.reduce((Be,Fe)=>Be+parseFloat(Fe.quantity||"0"),0))||0;await Z.from("batches").update({current_stock:Ye}).eq("id",B.id)}}else{const Le={batch_number:w.batch_number,product_id:w.product_id,import_container_id:w.import_container_id&&w.import_container_id.trim()!==""?w.import_container_id:null,import_date:w.import_date,import_quantity:w.import_quantity,current_stock:w.import_quantity,packaging_details:w.packaging_details,import_price:ne,import_price_usd:w.import_price_usd||null,exchange_rate_usd_to_idr:w.exchange_rate_usd_to_idr||null,duty_percent:w.duty_percent||0,duty_charges:ce,duty_charge_type:"percentage",freight_charges:_e,freight_charge_type:w.freight_charge_type,other_charges:de,other_charge_type:w.other_charge_type,expiry_date:w.expiry_date||null},{data:{user:we}}=await Z.auth.getUser();if(!we)throw new Error("Not authenticated");const{data:ge,error:Re}=await Z.from("batches").insert([{...Le,is_active:!0,created_by:we.id}]).select().single();if(Re)throw Re;ye=ge.id}await G(ye),f(!1),S(),R()}catch(he){console.error("Error saving batch:",he),alert("Failed to save batch. Please try again.")}},G=async K=>{const he=C.filter(ne=>ne.file&&!ne.id);for(const ne of he)try{const te=`${Date.now()}_${ne.file.name}`,ce=`${K}/${te}`,{error:_e}=await Z.storage.from("batch-documents").upload(ce,ne.file);if(_e)throw _e;const{data:{publicUrl:de}}=Z.storage.from("batch-documents").getPublicUrl(ce),{error:ye}=await Z.from("batch_documents").insert([{batch_id:K,file_url:de,file_name:ne.file.name,file_type:ne.file_type,file_size:ne.file_size}]);if(ye)throw ye}catch(te){console.error("Error uploading file:",te)}},re=async K=>{E(K);let he="",ne="bag";if(K.packaging_details){const de=K.packaging_details.match(/(\d+)\s+(\w+)s?\s+x\s+(\d+(?:\.\d+)?)kg/);de&&(he=de[3],ne=de[2].toLowerCase())}const te=s.find(de=>de.id===K.product_id),ce=(te==null?void 0:te.duty_percent)||0;T({batch_number:K.batch_number,product_id:K.product_id,import_container_id:K.import_container_id||"",import_date:K.import_date,import_quantity:K.import_quantity,packaging_details:K.packaging_details,import_price_usd:K.import_price_usd||0,exchange_rate_usd_to_idr:K.exchange_rate_usd_to_idr||0,duty_percent:ce,duty_charges:K.duty_charges,duty_charge_type:"fixed",freight_charges:K.freight_charges,freight_charge_type:"fixed",other_charges:K.other_charges,other_charge_type:"fixed",expiry_date:K.expiry_date,per_pack_weight:he,pack_type:ne});const{data:_e}=await Z.from("batch_documents").select("*").eq("batch_id",K.id);k(_e||[]),f(!0)},U=async K=>{try{const{data:he}=await Z.from("sales_invoice_items").select("id, sales_invoices(invoice_number)").eq("batch_id",K).limit(1);if(he&&he.length>0){alert("Cannot delete this batch. It has been used in sales invoices. Please delete the related invoices first or contact your administrator.");return}const{data:ne}=await Z.from("delivery_challan_items").select("id").eq("batch_id",K).limit(1);if(ne&&ne.length>0){alert("Cannot delete this batch. It has been used in delivery challans. Please delete the related delivery challans first.");return}if(!confirm("Are you sure you want to delete this batch? This will permanently remove all related data."))return;const{error:te}=await Z.from("batch_documents").delete().eq("batch_id",K);if(te)throw te;const{error:ce}=await Z.from("inventory_transactions").delete().eq("batch_id",K);if(ce)throw ce;const{error:_e}=await Z.from("finance_expenses").delete().eq("batch_id",K);if(_e)throw _e;const{error:de}=await Z.from("batches").delete().eq("id",K);if(de)throw de;alert("Batch deleted successfully"),await R()}catch(he){console.error("Error deleting batch:",he);const ne=(he==null?void 0:he.message)||"Unknown error occurred";alert(`Failed to delete batch: ${ne}`)}},S=()=>{E(null),k([]),T({batch_number:"",product_id:"",import_container_id:"",import_date:"",import_quantity:0,packaging_details:"",import_price_usd:0,exchange_rate_usd_to_idr:0,duty_percent:0,duty_charges:0,duty_charge_type:"fixed",freight_charges:0,freight_charge_type:"fixed",other_charges:0,other_charge_type:"fixed",expiry_date:"",per_pack_weight:"",pack_type:"bag"})},D=async(K,he,ne)=>{_({id:K,name:he,code:ne}),p(!0);const{data:te,error:ce}=await Z.from("inventory_transactions").select("*").eq("product_id",K).order("transaction_date",{ascending:!1}).order("created_at",{ascending:!1});if(ce){console.error("Error loading transaction history:",ce),alert("Error loading transaction history: "+ce.message);return}const _e=await Promise.all((te||[]).map(async de=>{let ye=null,Le=null;if(de.reference_number&&de.reference_number.startsWith("DO-")){const{data:we}=await Z.from("delivery_challans").select("challan_number, customer_id, customers(customer_name)").eq("challan_number",de.reference_number).single();ye=we}if(de.sales_order_id){const{data:we}=await Z.from("sales_orders").select("so_number, customer_id, customers(customer_name)").eq("id",de.sales_order_id).single();Le=we}return{...de,delivery_challans:ye,sales_orders:Le}}));N(_e)},L=K=>K.current_stock<K.import_quantity*.2,P=K=>K.expiry_date?new Date(K.expiry_date)<new Date:!1,I=K=>{if(!K.expiry_date)return!1;const he=new Date;return he.setDate(he.getDate()+30),new Date(K.expiry_date)<=he&&!P(K)},H=()=>{const K=w.import_price_usd*w.exchange_rate_usd_to_idr,he=(_e,de)=>de==="percentage"?K*_e/100:_e,ne=K*w.duty_percent/100,te=he(w.freight_charges,w.freight_charge_type),ce=he(w.other_charges,w.other_charge_type);return K+ne+te+ce},V=(K,he)=>{const ne=w.import_price_usd*w.exchange_rate_usd_to_idr;return he==="percentage"?ne*K/100:K},W=(K,he="IDR")=>he==="USD"?`$ ${K.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`:`Rp ${K.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})}`,M=[{key:"batch_number",label:"Batch Number"},{key:"product",label:"Product",render:(K,he)=>{var ne,te;return n.jsxs("div",{children:[n.jsx("button",{onClick:()=>{var ce,_e;return D(he.product_id,((ce=he.products)==null?void 0:ce.product_name)||"",((_e=he.products)==null?void 0:_e.product_code)||"")},className:"font-medium text-blue-600 hover:text-blue-800 hover:underline text-left",children:(ne=he.products)==null?void 0:ne.product_name}),((te=he.products)==null?void 0:te.product_code)&&n.jsx("div",{className:"text-xs text-gray-500",children:he.products.product_code})]})}},{key:"import_date",label:"Import Date",render:(K,he)=>new Date(he.import_date).toLocaleDateString()},{key:"stock",label:"Stock",render:(K,he)=>{var te,ce,_e;const ne=he.current_stock-(he.reserved_stock||0);return n.jsxs("div",{className:"flex flex-col gap-1",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("span",{className:L(he)?"text-orange-600 font-semibold":"font-medium",children:[he.current_stock," ",(te=he.products)==null?void 0:te.unit]}),L(he)&&n.jsx(Ga,{className:"w-4 h-4 text-orange-600"})]}),he.reserved_stock>0&&n.jsxs("div",{className:"text-xs space-y-0.5",children:[n.jsxs("div",{className:"text-amber-600",children:["Reserved: ",he.reserved_stock," ",(ce=he.products)==null?void 0:ce.unit]}),n.jsxs("div",{className:"text-green-600",children:["Free: ",ne," ",(_e=he.products)==null?void 0:_e.unit]})]})]})}},{key:"pricing",label:"Import Price",render:(K,he)=>n.jsx("div",{className:"text-sm",children:he.import_price_usd&&he.exchange_rate_usd_to_idr?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"font-medium text-green-700",children:W(he.import_price_usd,"USD")}),n.jsx("div",{className:"text-xs text-gray-500",children:W(he.import_price)}),n.jsxs("div",{className:"text-xs text-gray-400",children:["@ ",he.exchange_rate_usd_to_idr.toLocaleString()]})]}):n.jsx("div",{className:"text-gray-500",children:W(he.import_price)})})},{key:"landed_cost",label:"Landed Cost",render:(K,he)=>{var _e;const ne=he.import_cost_allocated&&he.import_cost_allocated>0,te=he.landed_cost_per_unit||he.import_price,ce=ne?he.import_cost_allocated/he.import_quantity:0;return n.jsxs("div",{className:"text-sm",children:[he.import_price_usd&&he.exchange_rate_usd_to_idr?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"font-medium text-blue-700",children:W(te/he.exchange_rate_usd_to_idr,"USD")}),n.jsx("div",{className:"text-xs text-gray-500",children:W(te)}),ne&&n.jsxs("div",{className:"text-xs text-green-600",children:["+Container: ",W(ce)]}),n.jsxs("div",{className:"text-xs text-gray-400",children:["@ ",he.exchange_rate_usd_to_idr.toLocaleString("id-ID")]})]}):n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"font-medium text-blue-700",children:W(te)}),ne&&n.jsxs("div",{className:"text-xs text-green-600",children:["+Container: ",W(ce)]})]}),((_e=he.import_containers)==null?void 0:_e.container_ref)&&n.jsx("div",{className:"text-xs text-gray-400",children:he.import_containers.container_ref}),he.cost_locked&&n.jsx("div",{className:"text-xs text-amber-600 font-medium",children:" Locked"})]})}},{key:"expiry_date",label:"Expiry Date",render:(K,he)=>n.jsx("span",{className:P(he)?"text-red-700 font-semibold":I(he)?"text-orange-600 font-semibold":"",children:he.expiry_date?new Date(he.expiry_date).toLocaleDateString():"N/A"})},{key:"documents",label:"Docs",render:(K,he)=>n.jsxs("button",{onClick:()=>ee(he.id),className:"flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-600 rounded hover:bg-blue-100 transition",children:[n.jsx(Zt,{className:"w-4 h-4"}),n.jsx("span",{className:"text-sm font-medium",children:he.document_count||0})]})},{key:"total_cost",label:"Total Cost",render:(K,he)=>{const ne=he.import_price*he.import_quantity,te=he.import_price_usd?he.import_price_usd*he.import_quantity:null;return n.jsx("div",{className:"text-sm",children:te&&he.exchange_rate_usd_to_idr?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"font-semibold text-green-700",children:W(te,"USD")}),n.jsx("div",{className:"text-xs text-gray-500",children:W(ne)})]}):n.jsx("div",{className:"font-semibold",children:W(ne)})})}}],se=(t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="warehouse"||(t==null?void 0:t.role)==="accounts";return n.jsx(Un,{children:n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Import Batches"}),n.jsx("p",{className:"text-gray-600 mt-1",children:"Manage import batches with USD pricing and document tracking"})]}),se&&n.jsxs("button",{onClick:()=>{S(),f(!0)},className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition",children:[n.jsx(Pr,{className:"w-5 h-5"}),"Add Batch"]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-600",children:"Total Batches"}),n.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:r.length})]}),n.jsx(Rr,{className:"w-8 h-8 text-blue-600"})]})}),n.jsx("div",{className:"bg-orange-50 rounded-lg shadow p-6",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-orange-600",children:"Low Stock"}),n.jsx("p",{className:"text-2xl font-bold text-orange-600 mt-1",children:r.filter(L).length})]}),n.jsx(Ga,{className:"w-8 h-8 text-orange-600"})]})}),n.jsx("div",{className:"bg-red-50 rounded-lg shadow p-6",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-red-600",children:"Near Expiry"}),n.jsx("p",{className:"text-2xl font-bold text-red-600 mt-1",children:r.filter(I).length})]}),n.jsx(Ga,{className:"w-8 h-8 text-red-600"})]})})]}),n.jsx(Fs,{columns:M,data:r,loading:c,actions:se?K=>n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>re(K),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",children:n.jsx(Aa,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>U(K.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",children:n.jsx(Lr,{className:"w-4 h-4"})})]}):void 0}),r.length>0&&n.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-green-50 rounded-lg shadow-lg p-6 border-2 border-blue-200",children:[n.jsxs("h3",{className:"text-lg font-bold text-gray-900 mb-4 flex items-center gap-2",children:[n.jsx(hn,{className:"w-5 h-5 text-blue-600"}),"Total Import Value Summary"]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx("p",{className:"text-sm text-gray-600 font-medium",children:"Total Value (USD)"}),n.jsx("p",{className:"text-3xl font-bold text-green-700",children:W(r.reduce((K,he)=>{const ne=he.import_price_usd?he.import_price_usd*he.import_quantity:0;return K+ne},0),"USD")})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("p",{className:"text-sm text-gray-600 font-medium",children:"Total Value (IDR)"}),n.jsx("p",{className:"text-3xl font-bold text-blue-700",children:W(r.reduce((K,he)=>{const ne=he.import_price*he.import_quantity;return K+ne},0))})]})]}),n.jsxs("div",{className:"mt-4 pt-4 border-t border-blue-200",children:[n.jsxs("div",{className:"flex justify-between items-center text-sm",children:[n.jsx("span",{className:"text-gray-600",children:"Total Batches:"}),n.jsx("span",{className:"font-semibold text-gray-900",children:r.length})]}),n.jsxs("div",{className:"flex justify-between items-center text-sm mt-1",children:[n.jsx("span",{className:"text-gray-600",children:"Total Quantity:"}),n.jsxs("span",{className:"font-semibold text-gray-900",children:[r.reduce((K,he)=>K+he.import_quantity,0).toLocaleString()," units"]})]})]})]}),n.jsx(Ot,{isOpen:u,onClose:()=>{f(!1),S()},title:B?"Edit Batch":"Add New Batch",size:"xl",children:n.jsxs("form",{onSubmit:Y,className:"space-y-2",children:[n.jsxs("div",{className:"border-b pb-1.5",children:[n.jsx("h3",{className:"text-xs font-semibold text-gray-900 mb-1.5",children:"Basic Information"}),n.jsxs("div",{className:"grid grid-cols-[2fr_1fr_1fr] gap-2 mb-2",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Batch Number *"}),n.jsx("input",{type:"text",value:w.batch_number,onChange:K=>T({...w,batch_number:K.target.value}),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Import Date *"}),n.jsx("input",{type:"date",value:w.import_date,onChange:K=>T({...w,import_date:K.target.value}),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Expiry Date"}),n.jsx("input",{type:"date",value:w.expiry_date,onChange:K=>T({...w,expiry_date:K.target.value}),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Product *"}),n.jsx(Qo,{value:w.product_id,onChange:K=>{const he=s.find(ne=>ne.id===K);T({...w,product_id:K,duty_percent:(he==null?void 0:he.duty_percent)||0})},options:s.map(K=>({value:K.id,label:`${K.product_name}${K.product_code?` (${K.product_code})`:""}`})),placeholder:"Select Product",className:"text-sm",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Import Container (Optional)"}),n.jsx(Qo,{value:w.import_container_id,onChange:K=>T({...w,import_container_id:K}),options:[{value:"",label:"Select Container (Optional)"},...o.map(K=>({value:K.id,label:`${K.container_ref} (${K.status})`}))],placeholder:"Select Container",className:"text-sm"}),n.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"Link batch to import container for cost allocation"})]})]})]}),n.jsxs("div",{className:"border-b pb-1.5",children:[n.jsx("h3",{className:"text-xs font-semibold text-gray-900 mb-1.5",children:"Quantity"}),n.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Import Quantity *"}),n.jsx("input",{type:"number",value:w.import_quantity===0?"":w.import_quantity,onChange:K=>T({...w,import_quantity:K.target.value===""?0:Number(K.target.value)}),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",required:!0,min:"0",step:"0.001",placeholder:"0"}),n.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"Total quantity being imported"})]}),B&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Current Stock"}),n.jsx("div",{className:"w-full px-2 py-1 text-sm border border-gray-200 rounded bg-gray-50",children:n.jsx("span",{className:"text-gray-700 font-medium",children:B.current_stock.toLocaleString()})}),n.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:["Available: ",B.current_stock.toLocaleString()," | Sold: ",(B.import_quantity-B.current_stock).toLocaleString()]})]})]})]}),n.jsxs("div",{className:"border-b pb-1.5",children:[n.jsxs("h3",{className:"text-xs font-semibold text-gray-900 mb-1 flex items-center gap-1.5",children:[n.jsx(Rr,{className:"w-3.5 h-3.5"}),"Packaging Details (Optional)"]}),n.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Per Pack Weight"}),n.jsx("input",{type:"number",step:"0.001",value:w.per_pack_weight,onChange:K=>{const he={...w,per_pack_weight:K.target.value};if(w.import_quantity&&K.target.value){const ne=parseFloat(K.target.value);if(ne){const te=(w.import_quantity/ne).toFixed(0);he.packaging_details=`${te} ${w.pack_type}${parseInt(te)!==1?"s":""} x ${ne}kg`}}T(he)},placeholder:"e.g., 25",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500"}),n.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"kg per pack"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Pack Type"}),n.jsxs("select",{value:w.pack_type,onChange:K=>{const he={...w,pack_type:K.target.value};if(w.import_quantity&&w.per_pack_weight){const ne=parseFloat(w.per_pack_weight);if(ne){const te=(w.import_quantity/ne).toFixed(0);he.packaging_details=`${te} ${K.target.value}${parseInt(te)!==1?"s":""} x ${ne}kg`}}T(he)},className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",children:[n.jsx("option",{value:"bag",children:"Bag"}),n.jsx("option",{value:"drum",children:"Drum"}),n.jsx("option",{value:"tin",children:"Tin"}),n.jsx("option",{value:"box",children:"Box"}),n.jsx("option",{value:"carton",children:"Carton"}),n.jsx("option",{value:"pallet",children:"Pallet"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Calculated Packs"}),n.jsx("div",{className:"px-2 py-1 text-sm bg-gray-50 border border-gray-200 rounded",children:n.jsx("span",{className:"text-gray-700 font-medium",children:w.import_quantity&&w.per_pack_weight?Math.ceil(w.import_quantity/parseFloat(w.per_pack_weight)):"-"})}),n.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"Total packs"})]})]}),w.packaging_details&&n.jsx("div",{className:"mt-1 p-1.5 bg-blue-50 border border-blue-200 rounded",children:n.jsxs("p",{className:"text-xs text-blue-900",children:[n.jsx("span",{className:"font-semibold",children:"Packaging: "}),w.packaging_details]})})]}),n.jsxs("div",{className:"border-b pb-1.5",children:[n.jsxs("h3",{className:"text-xs font-semibold text-gray-900 mb-1 flex items-center gap-1.5",children:[n.jsx(hn,{className:"w-3.5 h-3.5 text-green-600"}),"Import Pricing (USD)"]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Import Price (USD)"}),n.jsx("input",{type:"number",value:w.import_price_usd===0?"":w.import_price_usd,onChange:K=>T({...w,import_price_usd:K.target.value===""?0:Number(K.target.value)}),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",min:"0",step:"0.01",placeholder:"0.00"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-0.5",children:"Exchange Rate (USD to IDR)"}),n.jsx("input",{type:"number",value:w.exchange_rate_usd_to_idr===0?"":w.exchange_rate_usd_to_idr,onChange:K=>T({...w,exchange_rate_usd_to_idr:K.target.value===""?0:Number(K.target.value)}),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",min:"0",step:"0.0001",placeholder:"15000"}),n.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:["1 USD = ",w.exchange_rate_usd_to_idr.toLocaleString()," IDR"]})]})]}),w.import_price_usd>0&&w.exchange_rate_usd_to_idr>0&&n.jsxs("div",{className:"mt-1 p-1.5 bg-green-50 border border-green-200 rounded",children:[n.jsxs("p",{className:"text-xs text-green-800",children:[n.jsx("span",{className:"font-semibold",children:"Calculated Import Price (IDR):"})," ",W(w.import_price_usd*w.exchange_rate_usd_to_idr)]}),n.jsxs("p",{className:"text-xs text-green-600 mt-0.5",children:[W(w.import_price_usd,"USD"),"  ",w.exchange_rate_usd_to_idr.toLocaleString()," = ",W(w.import_price_usd*w.exchange_rate_usd_to_idr)]})]})]}),n.jsxs("div",{className:"border-b pb-1.5",children:[n.jsx("h3",{className:"text-xs font-semibold text-gray-900 mb-1",children:"Additional Charges"}),n.jsx("div",{className:"space-y-3",children:n.jsxs("div",{className:"grid grid-cols-[1fr_1fr_1fr] gap-2",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Duty (Form A1 %)"}),n.jsxs("div",{className:"flex gap-0.5",children:[n.jsx("input",{type:"number",value:w.duty_percent===0?"":w.duty_percent,onChange:K=>T({...w,duty_percent:K.target.value===""?0:Number(K.target.value)}),className:"flex-1 px-1.5 py-1 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",min:"0",max:"100",step:"0.01",placeholder:"Auto from product"}),n.jsx("div",{className:"w-12 px-0.5 py-1 text-xs border border-gray-300 rounded bg-gray-50 flex items-center justify-center",children:"%"})]}),w.duty_percent>0&&w.import_price_usd>0&&w.exchange_rate_usd_to_idr>0&&n.jsxs("p",{className:"text-xs text-gray-600 mt-0.5",children:["= ",W(w.import_price_usd*w.exchange_rate_usd_to_idr*w.duty_percent/100)]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Freight"}),n.jsxs("div",{className:"flex gap-0.5",children:[n.jsx("input",{type:"number",value:w.freight_charges===0?"":w.freight_charges,onChange:K=>T({...w,freight_charges:K.target.value===""?0:Number(K.target.value)}),className:"flex-1 px-1.5 py-1 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",min:"0",step:"0.01",placeholder:"0"}),n.jsxs("select",{value:w.freight_charge_type,onChange:K=>T({...w,freight_charge_type:K.target.value}),className:"w-12 px-0.5 py-1 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 bg-white",children:[n.jsx("option",{value:"percentage",children:"%"}),n.jsx("option",{value:"fixed",children:"Rp"})]})]}),w.freight_charges>0&&n.jsxs("p",{className:"text-xs text-gray-600 mt-0.5",children:["= ",W(V(w.freight_charges,w.freight_charge_type))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Other"}),n.jsxs("div",{className:"flex gap-0.5",children:[n.jsx("input",{type:"number",value:w.other_charges===0?"":w.other_charges,onChange:K=>T({...w,other_charges:K.target.value===""?0:Number(K.target.value)}),className:"flex-1 px-1.5 py-1 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",min:"0",step:"0.01",placeholder:"0"}),n.jsxs("select",{value:w.other_charge_type,onChange:K=>T({...w,other_charge_type:K.target.value}),className:"w-12 px-0.5 py-1 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 bg-white",children:[n.jsx("option",{value:"percentage",children:"%"}),n.jsx("option",{value:"fixed",children:"Rp"})]})]}),w.other_charges>0&&n.jsxs("p",{className:"text-xs text-gray-600 mt-0.5",children:["= ",W(V(w.other_charges,w.other_charge_type))]})]})]})})]}),n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded p-2",children:[n.jsx("h3",{className:"text-xs font-semibold text-blue-900 mb-1.5",children:"Total Cost Summary"}),n.jsxs("div",{className:"space-y-0.5 text-xs text-blue-800",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{children:"Import Price (per unit):"}),n.jsx("span",{className:"font-medium",children:W(w.import_price_usd*w.exchange_rate_usd_to_idr)})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{children:"Duty (Form A1):"}),n.jsxs("span",{className:"font-medium",children:[W(w.import_price_usd*w.exchange_rate_usd_to_idr*w.duty_percent/100),w.duty_percent>0&&n.jsxs("span",{className:"text-xs ml-1",children:["(",w.duty_percent,"%)"]})]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{children:"Freight Charges:"}),n.jsxs("span",{className:"font-medium",children:[W(V(w.freight_charges,w.freight_charge_type)),w.freight_charge_type==="percentage"&&w.freight_charges>0&&n.jsxs("span",{className:"text-xs ml-1",children:["(",w.freight_charges,"%)"]})]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{children:"Other Charges:"}),n.jsxs("span",{className:"font-medium",children:[W(V(w.other_charges,w.other_charge_type)),w.other_charge_type==="percentage"&&w.other_charges>0&&n.jsxs("span",{className:"text-xs ml-1",children:["(",w.other_charges,"%)"]})]})]}),n.jsxs("div",{className:"border-t border-blue-300 pt-1.5 mt-1.5 space-y-1",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"font-bold",children:"Total Cost (IDR):"}),n.jsx("span",{className:"font-bold text-sm",children:W(H())})]}),w.import_quantity>0&&n.jsxs("div",{className:"bg-green-50 border border-green-200 rounded px-2 py-1.5 mt-2",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{className:"font-bold text-green-900",children:"Total Batch Cost:"}),n.jsxs("div",{className:"text-right",children:[n.jsx("div",{className:"font-bold text-green-700",children:W(w.import_price_usd*w.import_quantity,"USD")}),n.jsx("div",{className:"text-xs text-green-600",children:W(w.import_price_usd*w.exchange_rate_usd_to_idr*w.import_quantity)})]})]}),n.jsxs("div",{className:"text-xs text-green-700 mt-0.5",children:[W(w.import_price_usd,"USD"),"  ",w.import_quantity," = ",W(w.import_price_usd*w.import_quantity,"USD")]})]})]})]})]}),n.jsxs("div",{className:"border-t pt-1.5",children:[n.jsxs("h3",{className:"text-xs font-semibold text-gray-900 mb-1 flex items-center gap-1.5",children:[n.jsx(Zt,{className:"w-3.5 h-3.5"}),"Import Documents"]}),n.jsx(LE,{batchId:B==null?void 0:B.id,existingFiles:C,onFilesChange:k})]}),n.jsxs("div",{className:"flex justify-end gap-2 pt-2 border-t",children:[n.jsx("button",{type:"button",onClick:()=>{f(!1),S()},className:"px-3 py-1 text-sm border border-gray-300 rounded hover:bg-gray-50 transition",children:"Cancel"}),n.jsx("button",{type:"submit",className:"px-3 py-1 text-sm bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:B?"Update Batch":"Add Batch"})]})]})}),n.jsx(Ot,{isOpen:h,onClose:()=>{A(!1),m([]),y(null)},title:"Batch Documents",children:n.jsx("div",{className:"space-y-3",children:b.length>0?b.map(K=>n.jsxs("a",{href:K.file_url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg border border-gray-200 hover:bg-blue-50 hover:border-blue-300 transition",children:[n.jsx(Zt,{className:"w-5 h-5 text-blue-600 flex-shrink-0"}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:K.file_name}),n.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mt-1",children:[n.jsx("span",{className:"capitalize",children:K.file_type.replace("_"," ")}),n.jsx("span",{children:""}),n.jsxs("span",{children:[(K.file_size/1024).toFixed(1)," KB"]}),n.jsx("span",{children:""}),n.jsx("span",{children:new Date(K.uploaded_at).toLocaleDateString()})]})]}),n.jsx(Gd,{className:"w-4 h-4 text-gray-400 flex-shrink-0"})]},K.id)):n.jsxs("div",{className:"text-center py-8 text-gray-500",children:[n.jsx(Zt,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),n.jsx("p",{children:"No documents uploaded for this batch"})]})})}),n.jsx(Ot,{isOpen:x,onClose:()=>{p(!1),_(null),N([])},title:`Transaction History - ${(v==null?void 0:v.name)||""} (${(v==null?void 0:v.code)||""})`,children:n.jsx("div",{className:"space-y-3 max-h-[600px] overflow-y-auto",children:j.length>0?n.jsx("div",{className:"space-y-2",children:j.map((K,he)=>n.jsx("div",{className:`p-3 rounded-lg border-l-4 ${parseFloat(K.quantity)>0?"bg-green-50 border-green-500":"bg-red-50 border-red-500"}`,children:n.jsxs("div",{className:"flex items-start justify-between gap-3",children:[n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsxs("span",{className:`font-semibold ${parseFloat(K.quantity)>0?"text-green-700":"text-red-700"}`,children:[parseFloat(K.quantity)>0?"+":"",parseFloat(K.quantity).toFixed(3)]}),n.jsx("span",{className:"text-xs px-2 py-0.5 rounded bg-gray-200 text-gray-700 uppercase",children:K.transaction_type.replace("_"," ")})]}),n.jsxs("div",{className:"text-sm text-gray-600 space-y-0.5",children:[n.jsxs("div",{children:[n.jsx("strong",{children:"Date:"})," ",new Date(K.transaction_date).toLocaleDateString()]}),K.reference_number&&n.jsxs("div",{children:[n.jsx("strong",{children:"Reference:"})," ",K.reference_number]}),K.reference_type==="delivery_challan"&&K.delivery_challans&&n.jsxs("div",{className:"text-xs text-blue-600",children:["DC: ",K.delivery_challans.challan_number,K.delivery_challans.customers&&n.jsxs("span",{className:"ml-1",children:[" ",K.delivery_challans.customers.customer_name]})]}),K.sales_order_id&&K.sales_orders&&n.jsxs("div",{className:"text-xs text-blue-600",children:["SO: ",K.sales_orders.so_number,K.sales_orders.customers&&n.jsxs("span",{className:"ml-1",children:[" ",K.sales_orders.customers.customer_name]})]}),K.notes&&n.jsx("div",{className:"text-xs text-gray-500 italic",children:K.notes})]})]}),n.jsx("div",{className:"text-right text-xs text-gray-400",children:new Date(K.created_at).toLocaleString()})]})},K.id))}):n.jsxs("div",{className:"text-center py-8 text-gray-500",children:[n.jsx(Rr,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),n.jsx("p",{children:"No transactions found for this product"})]})})})]})})}const V7="modulepreload",W7=function(e){return"/"+e},B5={},Bv=function(t,r,a){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(r.map(c=>{if(c=W7(c),c in B5)return;B5[c]=!0;const d=c.endsWith(".css"),u=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const f=document.createElement("link");if(f.rel=d?"stylesheet":V7,d||(f.as="script"),f.crossOrigin="",f.href=c,l&&f.setAttribute("nonce",l),document.head.appendChild(f),d)return new Promise((h,A)=>{f.addEventListener("load",h),f.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return s.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return t().catch(i)})};function zr(e){"@babel/helpers - typeof";return zr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zr(e)}var bo=Uint8Array,pi=Uint16Array,Zw=Int32Array,e2=new bo([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),t2=new bo([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),E5=new bo([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),PE=function(e,t){for(var r=new pi(31),a=0;a<31;++a)r[a]=t+=1<<e[a-1];for(var s=new Zw(r[30]),a=1;a<30;++a)for(var i=r[a];i<r[a+1];++i)s[i]=i-r[a]<<5|a;return{b:r,r:s}},OE=PE(e2,2),z7=OE.b,n_=OE.r;z7[28]=258,n_[258]=28;var G7=PE(t2,0),F5=G7.r,a_=new pi(32768);for(var pn=0;pn<32768;++pn){var uc=(pn&43690)>>1|(pn&21845)<<1;uc=(uc&52428)>>2|(uc&13107)<<2,uc=(uc&61680)>>4|(uc&3855)<<4,a_[pn]=((uc&65280)>>8|(uc&255)<<8)>>1}var Cf=function(e,t,r){for(var a=e.length,s=0,i=new pi(t);s<a;++s)e[s]&&++i[e[s]-1];var o=new pi(t);for(s=1;s<t;++s)o[s]=o[s-1]+i[s-1]<<1;var l;if(r){l=new pi(1<<t);var c=15-t;for(s=0;s<a;++s)if(e[s])for(var d=s<<4|e[s],u=t-e[s],f=o[e[s]-1]++<<u,h=f|(1<<u)-1;f<=h;++f)l[a_[f]>>c]=d}else for(l=new pi(a),s=0;s<a;++s)e[s]&&(l[s]=a_[o[e[s]-1]++]>>15-e[s]);return l},Xd=new bo(288);for(var pn=0;pn<144;++pn)Xd[pn]=8;for(var pn=144;pn<256;++pn)Xd[pn]=9;for(var pn=256;pn<280;++pn)Xd[pn]=7;for(var pn=280;pn<288;++pn)Xd[pn]=8;var Hg=new bo(32);for(var pn=0;pn<32;++pn)Hg[pn]=5;var X7=Cf(Xd,9,0),Y7=Cf(Hg,5,0),UE=function(e){return(e+7)/8|0},J7=function(e,t,r){return(r==null||r>e.length)&&(r=e.length),new bo(e.subarray(t,r))},xl=function(e,t,r){r<<=t&7;var a=t/8|0;e[a]|=r,e[a+1]|=r>>8},Uh=function(e,t,r){r<<=t&7;var a=t/8|0;e[a]|=r,e[a+1]|=r>>8,e[a+2]|=r>>16},Ev=function(e,t){for(var r=[],a=0;a<e.length;++a)e[a]&&r.push({s:a,f:e[a]});var s=r.length,i=r.slice();if(!s)return{t:ME,l:0};if(s==1){var o=new bo(r[0].s+1);return o[r[0].s]=1,{t:o,l:1}}r.sort(function(_,j){return _.f-j.f}),r.push({s:-1,f:25001});var l=r[0],c=r[1],d=0,u=1,f=2;for(r[0]={s:-1,f:l.f+c.f,l,r:c};u!=s-1;)l=r[r[d].f<r[f].f?d++:f++],c=r[d!=u&&r[d].f<r[f].f?d++:f++],r[u++]={s:-1,f:l.f+c.f,l,r:c};for(var h=i[0].s,a=1;a<s;++a)i[a].s>h&&(h=i[a].s);var A=new pi(h+1),x=s_(r[u-1],A,0);if(x>t){var a=0,p=0,b=x-t,m=1<<b;for(i.sort(function(j,N){return A[N.s]-A[j.s]||j.f-N.f});a<s;++a){var g=i[a].s;if(A[g]>t)p+=m-(1<<x-A[g]),A[g]=t;else break}for(p>>=b;p>0;){var y=i[a].s;A[y]<t?p-=1<<t-A[y]++-1:++a}for(;a>=0&&p;--a){var v=i[a].s;A[v]==t&&(--A[v],++p)}x=t}return{t:new bo(A),l:x}},s_=function(e,t,r){return e.s==-1?Math.max(s_(e.l,t,r+1),s_(e.r,t,r+1)):t[e.s]=r},T5=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new pi(++t),a=0,s=e[0],i=1,o=function(c){r[a++]=c},l=1;l<=t;++l)if(e[l]==s&&l!=t)++i;else{if(!s&&i>2){for(;i>138;i-=138)o(32754);i>2&&(o(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(o(s),--i;i>6;i-=6)o(8304);i>2&&(o(i-3<<5|8208),i=0)}for(;i--;)o(s);i=1,s=e[l]}return{c:r.subarray(0,a),n:t}},Rh=function(e,t){for(var r=0,a=0;a<t.length;++a)r+=e[a]*t[a];return r},RE=function(e,t,r){var a=r.length,s=UE(t+2);e[s]=a&255,e[s+1]=a>>8,e[s+2]=e[s]^255,e[s+3]=e[s+1]^255;for(var i=0;i<a;++i)e[s+i+4]=r[i];return(s+4+a)*8},I5=function(e,t,r,a,s,i,o,l,c,d,u){xl(t,u++,r),++s[256];for(var f=Ev(s,15),h=f.t,A=f.l,x=Ev(i,15),p=x.t,b=x.l,m=T5(h),g=m.c,y=m.n,v=T5(p),_=v.c,j=v.n,N=new pi(19),B=0;B<g.length;++B)++N[g[B]&31];for(var B=0;B<_.length;++B)++N[_[B]&31];for(var E=Ev(N,7),C=E.t,k=E.l,w=19;w>4&&!C[E5[w-1]];--w);var T=d+5<<3,R=Rh(s,Xd)+Rh(i,Hg)+o,q=Rh(s,h)+Rh(i,p)+o+14+3*w+Rh(N,C)+2*N[16]+3*N[17]+7*N[18];if(c>=0&&T<=R&&T<=q)return RE(t,u,e.subarray(c,c+d));var z,ee,Y,G;if(xl(t,u,1+(q<R)),u+=2,q<R){z=Cf(h,A,0),ee=h,Y=Cf(p,b,0),G=p;var re=Cf(C,k,0);xl(t,u,y-257),xl(t,u+5,j-1),xl(t,u+10,w-4),u+=14;for(var B=0;B<w;++B)xl(t,u+3*B,C[E5[B]]);u+=3*w;for(var U=[g,_],S=0;S<2;++S)for(var D=U[S],B=0;B<D.length;++B){var L=D[B]&31;xl(t,u,re[L]),u+=C[L],L>15&&(xl(t,u,D[B]>>5&127),u+=D[B]>>12)}}else z=X7,ee=Xd,Y=Y7,G=Hg;for(var B=0;B<l;++B){var P=a[B];if(P>255){var L=P>>18&31;Uh(t,u,z[L+257]),u+=ee[L+257],L>7&&(xl(t,u,P>>23&31),u+=e2[L]);var I=P&31;Uh(t,u,Y[I]),u+=G[I],I>3&&(Uh(t,u,P>>5&8191),u+=t2[I])}else Uh(t,u,z[P]),u+=ee[P]}return Uh(t,u,z[256]),u+ee[256]},Z7=new Zw([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),ME=new bo(0),eR=function(e,t,r,a,s,i){var o=i.z||e.length,l=new bo(a+o+5*(1+Math.ceil(o/7e3))+s),c=l.subarray(a,l.length-s),d=i.l,u=(i.r||0)&7;if(t){u&&(c[0]=i.r>>3);for(var f=Z7[t-1],h=f>>13,A=f&8191,x=(1<<r)-1,p=i.p||new pi(32768),b=i.h||new pi(x+1),m=Math.ceil(r/3),g=2*m,y=function(ne){return(e[ne]^e[ne+1]<<m^e[ne+2]<<g)&x},v=new Zw(25e3),_=new pi(288),j=new pi(32),N=0,B=0,E=i.i||0,C=0,k=i.w||0,w=0;E+2<o;++E){var T=y(E),R=E&32767,q=b[T];if(p[R]=q,b[T]=R,k<=E){var z=o-E;if((N>7e3||C>24576)&&(z>423||!d)){u=I5(e,c,0,v,_,j,B,C,w,E-w,u),C=N=B=0,w=E;for(var ee=0;ee<286;++ee)_[ee]=0;for(var ee=0;ee<30;++ee)j[ee]=0}var Y=2,G=0,re=A,U=R-q&32767;if(z>2&&T==y(E-U))for(var S=Math.min(h,z)-1,D=Math.min(32767,E),L=Math.min(258,z);U<=D&&--re&&R!=q;){if(e[E+Y]==e[E+Y-U]){for(var P=0;P<L&&e[E+P]==e[E+P-U];++P);if(P>Y){if(Y=P,G=U,P>S)break;for(var I=Math.min(U,P-2),H=0,ee=0;ee<I;++ee){var V=E-U+ee&32767,W=p[V],M=V-W&32767;M>H&&(H=M,q=V)}}}R=q,q=p[R],U+=R-q&32767}if(G){v[C++]=268435456|n_[Y]<<18|F5[G];var se=n_[Y]&31,K=F5[G]&31;B+=e2[se]+t2[K],++_[257+se],++j[K],k=E+Y,++N}else v[C++]=e[E],++_[e[E]]}}for(E=Math.max(E,k);E<o;++E)v[C++]=e[E],++_[e[E]];u=I5(e,c,d,v,_,j,B,C,w,E-w,u),d||(i.r=u&7|c[u/8|0]<<3,u-=7,i.h=b,i.p=p,i.i=E,i.w=k)}else{for(var E=i.w||0;E<o+d;E+=65535){var he=E+65535;he>=o&&(c[u/8|0]=d,he=o),u=RE(c,u+1,e.subarray(E,he))}i.i=o}return J7(l,0,a+UE(u)+s)},QE=function(){var e=1,t=0;return{p:function(r){for(var a=e,s=t,i=r.length|0,o=0;o!=i;){for(var l=Math.min(o+2655,i);o<l;++o)s+=a+=r[o];a=(a&65535)+15*(a>>16),s=(s&65535)+15*(s>>16)}e=a,t=s},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},tR=function(e,t,r,a,s){if(!s&&(s={l:1},t.dictionary)){var i=t.dictionary.subarray(-32768),o=new bo(i.length+e.length);o.set(i),o.set(e,i.length),e=o,s.w=i.length}return eR(e,t.level==null?6:t.level,t.mem==null?s.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,r,a,s)},HE=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},rR=function(e,t){var r=t.level,a=r==0?0:r<6?1:r==9?3:2;if(e[0]=120,e[1]=a<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var s=QE();s.p(t.dictionary),HE(e,2,s.d())}};function i_(e,t){t||(t={});var r=QE();r.p(e);var a=tR(e,t,t.dictionary?6:2,4);return rR(a,t),HE(a,a.length-4,r.d()),a}var nR=typeof TextDecoder<"u"&&new TextDecoder,aR=0;try{nR.decode(ME,{stream:!0}),aR=1}catch{}function sR(e){if(Array.isArray(e))return e}function iR(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var a,s,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(a=i.call(r)).done)&&(l.push(a.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw s}}return l}}function D5(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=Array(t);r<t;r++)a[r]=e[r];return a}function oR(e,t){if(e){if(typeof e=="string")return D5(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?D5(e,t):void 0}}function lR(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function L5(e,t){return sR(e)||iR(e,t)||oR(e,t)||lR()}function P5(e,t="utf8"){return new TextDecoder(t).decode(e)}const cR=new TextEncoder;function dR(e){return cR.encode(e)}const uR=1024*8,AR=(()=>{const e=new Uint8Array(4),t=new Uint32Array(e.buffer);return!((t[0]=1)&e[0])})(),Fv={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class r2{constructor(t=uR,r={}){Kr(this,"buffer");Kr(this,"byteLength");Kr(this,"byteOffset");Kr(this,"length");Kr(this,"offset");Kr(this,"lastWrittenByte");Kr(this,"littleEndian");Kr(this,"_data");Kr(this,"_mark");Kr(this,"_marks");let a=!1;typeof t=="number"?t=new ArrayBuffer(t):(a=!0,this.lastWrittenByte=t.byteLength);const s=r.offset?r.offset>>>0:0,i=t.byteLength-s;let o=s;(ArrayBuffer.isView(t)||t instanceof r2)&&(t.byteLength!==t.buffer.byteLength&&(o=t.byteOffset+s),t=t.buffer),a?this.lastWrittenByte=i:this.lastWrittenByte=0,this.buffer=t,this.length=i,this.byteLength=i,this.byteOffset=o,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,o,i),this._mark=0,this._marks=[]}available(t=1){return this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(t=1){return this.offset+=t,this}back(t=1){return this.offset-=t,this}seek(t){return this.offset=t,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const t=this._marks.pop();if(t===void 0)throw new Error("Mark stack empty");return this.seek(t),this}rewind(){return this.offset=0,this}ensureAvailable(t=1){if(!this.available(t)){const a=(this.offset+t)*2,s=new Uint8Array(a);s.set(new Uint8Array(this.buffer)),this.buffer=s.buffer,this.length=a,this.byteLength=a,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t=1){return this.readArray(t,"uint8")}readArray(t,r){const a=Fv[r].BYTES_PER_ELEMENT*t,s=this.byteOffset+this.offset,i=this.buffer.slice(s,s+a);if(this.littleEndian===AR&&r!=="uint8"&&r!=="int8"){const l=new Uint8Array(this.buffer.slice(s,s+a));l.reverse();const c=new Fv[r](l.buffer);return this.offset+=a,c.reverse(),c}const o=new Fv[r](i);return this.offset+=a,o}readInt16(){const t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){const t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){const t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){const t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){const t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){const t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readBigInt64(){const t=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,t}readBigUint64(){const t=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t=1){let r="";for(let a=0;a<t;a++)r+=this.readChar();return r}readUtf8(t=1){return P5(this.readBytes(t))}decodeText(t=1,r="utf8"){return P5(this.readBytes(t),r)}writeBoolean(t){return this.writeUint8(t?255:0),this}writeInt8(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this}writeUint8(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this}writeByte(t){return this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(let r=0;r<t.length;r++)this._data.setUint8(this.offset++,t[r]);return this._updateLastWrittenByte(),this}writeInt16(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(t){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(t){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(t){return this.writeUint8(t.charCodeAt(0))}writeChars(t){for(let r=0;r<t.length;r++)this.writeUint8(t.charCodeAt(r));return this}writeUtf8(t){return this.writeBytes(dR(t))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function VA(e){let t=e.length;for(;--t>=0;)e[t]=0}const hR=3,fR=258,qE=29,pR=256,mR=pR+1+qE,$E=30,gR=512,xR=new Array((mR+2)*2);VA(xR);const yR=new Array($E*2);VA(yR);const vR=new Array(gR);VA(vR);const bR=new Array(fR-hR+1);VA(bR);const _R=new Array(qE);VA(_R);const wR=new Array($E);VA(wR);const NR=(e,t,r,a)=>{let s=e&65535|0,i=e>>>16&65535|0,o=0;for(;r!==0;){o=r>2e3?2e3:r,r-=o;do s=s+t[a++]|0,i=i+s|0;while(--o);s%=65521,i%=65521}return s|i<<16|0};var o_=NR;const jR=()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var a=0;a<8;a++)e=e&1?3988292384^e>>>1:e>>>1;t[r]=e}return t},kR=new Uint32Array(jR()),CR=(e,t,r,a)=>{const s=kR,i=a+r;e^=-1;for(let o=a;o<i;o++)e=e>>>8^s[(e^t[o])&255];return e^-1};var Fo=CR,l_={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},KE={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const SR=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var BR=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const r=t.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const a in r)SR(r,a)&&(e[a]=r[a])}}return e},ER=e=>{let t=0;for(let a=0,s=e.length;a<s;a++)t+=e[a].length;const r=new Uint8Array(t);for(let a=0,s=0,i=e.length;a<i;a++){let o=e[a];r.set(o,s),s+=o.length}return r},VE={assign:BR,flattenChunks:ER};let WE=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{WE=!1}const A0=new Uint8Array(256);for(let e=0;e<256;e++)A0[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;A0[254]=A0[254]=1;var FR=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,r,a,s,i,o=e.length,l=0;for(s=0;s<o;s++)r=e.charCodeAt(s),(r&64512)===55296&&s+1<o&&(a=e.charCodeAt(s+1),(a&64512)===56320&&(r=65536+(r-55296<<10)+(a-56320),s++)),l+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(l),i=0,s=0;i<l;s++)r=e.charCodeAt(s),(r&64512)===55296&&s+1<o&&(a=e.charCodeAt(s+1),(a&64512)===56320&&(r=65536+(r-55296<<10)+(a-56320),s++)),r<128?t[i++]=r:r<2048?(t[i++]=192|r>>>6,t[i++]=128|r&63):r<65536?(t[i++]=224|r>>>12,t[i++]=128|r>>>6&63,t[i++]=128|r&63):(t[i++]=240|r>>>18,t[i++]=128|r>>>12&63,t[i++]=128|r>>>6&63,t[i++]=128|r&63);return t};const TR=(e,t)=>{if(t<65534&&e.subarray&&WE)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let r="";for(let a=0;a<t;a++)r+=String.fromCharCode(e[a]);return r};var IR=(e,t)=>{const r=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let a,s;const i=new Array(r*2);for(s=0,a=0;a<r;){let o=e[a++];if(o<128){i[s++]=o;continue}let l=A0[o];if(l>4){i[s++]=65533,a+=l-1;continue}for(o&=l===2?31:l===3?15:7;l>1&&a<r;)o=o<<6|e[a++]&63,l--;if(l>1){i[s++]=65533;continue}o<65536?i[s++]=o:(o-=65536,i[s++]=55296|o>>10&1023,i[s++]=56320|o&1023)}return TR(i,s)},DR=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let r=t-1;for(;r>=0&&(e[r]&192)===128;)r--;return r<0||r===0?t:r+A0[e[r]]>t?r:t},c_={string2buf:FR,buf2string:IR,utf8border:DR};function LR(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var PR=LR;const Gp=16209,OR=16191;var UR=function(t,r){let a,s,i,o,l,c,d,u,f,h,A,x,p,b,m,g,y,v,_,j,N,B,E,C;const k=t.state;a=t.next_in,E=t.input,s=a+(t.avail_in-5),i=t.next_out,C=t.output,o=i-(r-t.avail_out),l=i+(t.avail_out-257),c=k.dmax,d=k.wsize,u=k.whave,f=k.wnext,h=k.window,A=k.hold,x=k.bits,p=k.lencode,b=k.distcode,m=(1<<k.lenbits)-1,g=(1<<k.distbits)-1;e:do{x<15&&(A+=E[a++]<<x,x+=8,A+=E[a++]<<x,x+=8),y=p[A&m];t:for(;;){if(v=y>>>24,A>>>=v,x-=v,v=y>>>16&255,v===0)C[i++]=y&65535;else if(v&16){_=y&65535,v&=15,v&&(x<v&&(A+=E[a++]<<x,x+=8),_+=A&(1<<v)-1,A>>>=v,x-=v),x<15&&(A+=E[a++]<<x,x+=8,A+=E[a++]<<x,x+=8),y=b[A&g];r:for(;;){if(v=y>>>24,A>>>=v,x-=v,v=y>>>16&255,v&16){if(j=y&65535,v&=15,x<v&&(A+=E[a++]<<x,x+=8,x<v&&(A+=E[a++]<<x,x+=8)),j+=A&(1<<v)-1,j>c){t.msg="invalid distance too far back",k.mode=Gp;break e}if(A>>>=v,x-=v,v=i-o,j>v){if(v=j-v,v>u&&k.sane){t.msg="invalid distance too far back",k.mode=Gp;break e}if(N=0,B=h,f===0){if(N+=d-v,v<_){_-=v;do C[i++]=h[N++];while(--v);N=i-j,B=C}}else if(f<v){if(N+=d+f-v,v-=f,v<_){_-=v;do C[i++]=h[N++];while(--v);if(N=0,f<_){v=f,_-=v;do C[i++]=h[N++];while(--v);N=i-j,B=C}}}else if(N+=f-v,v<_){_-=v;do C[i++]=h[N++];while(--v);N=i-j,B=C}for(;_>2;)C[i++]=B[N++],C[i++]=B[N++],C[i++]=B[N++],_-=3;_&&(C[i++]=B[N++],_>1&&(C[i++]=B[N++]))}else{N=i-j;do C[i++]=C[N++],C[i++]=C[N++],C[i++]=C[N++],_-=3;while(_>2);_&&(C[i++]=C[N++],_>1&&(C[i++]=C[N++]))}}else if(v&64){t.msg="invalid distance code",k.mode=Gp;break e}else{y=b[(y&65535)+(A&(1<<v)-1)];continue r}break}}else if(v&64)if(v&32){k.mode=OR;break e}else{t.msg="invalid literal/length code",k.mode=Gp;break e}else{y=p[(y&65535)+(A&(1<<v)-1)];continue t}break}}while(a<s&&i<l);_=x>>3,a-=_,x-=_<<3,A&=(1<<x)-1,t.next_in=a,t.next_out=i,t.avail_in=a<s?5+(s-a):5-(a-s),t.avail_out=i<l?257+(l-i):257-(i-l),k.hold=A,k.bits=x};const Fu=15,O5=852,U5=592,R5=0,Tv=1,M5=2,RR=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),MR=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),QR=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),HR=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),qR=(e,t,r,a,s,i,o,l)=>{const c=l.bits;let d=0,u=0,f=0,h=0,A=0,x=0,p=0,b=0,m=0,g=0,y,v,_,j,N,B=null,E;const C=new Uint16Array(Fu+1),k=new Uint16Array(Fu+1);let w=null,T,R,q;for(d=0;d<=Fu;d++)C[d]=0;for(u=0;u<a;u++)C[t[r+u]]++;for(A=c,h=Fu;h>=1&&C[h]===0;h--);if(A>h&&(A=h),h===0)return s[i++]=1<<24|64<<16|0,s[i++]=1<<24|64<<16|0,l.bits=1,0;for(f=1;f<h&&C[f]===0;f++);for(A<f&&(A=f),b=1,d=1;d<=Fu;d++)if(b<<=1,b-=C[d],b<0)return-1;if(b>0&&(e===R5||h!==1))return-1;for(k[1]=0,d=1;d<Fu;d++)k[d+1]=k[d]+C[d];for(u=0;u<a;u++)t[r+u]!==0&&(o[k[t[r+u]]++]=u);if(e===R5?(B=w=o,E=20):e===Tv?(B=RR,w=MR,E=257):(B=QR,w=HR,E=0),g=0,u=0,d=f,N=i,x=A,p=0,_=-1,m=1<<A,j=m-1,e===Tv&&m>O5||e===M5&&m>U5)return 1;for(;;){T=d-p,o[u]+1<E?(R=0,q=o[u]):o[u]>=E?(R=w[o[u]-E],q=B[o[u]-E]):(R=96,q=0),y=1<<d-p,v=1<<x,f=v;do v-=y,s[N+(g>>p)+v]=T<<24|R<<16|q|0;while(v!==0);for(y=1<<d-1;g&y;)y>>=1;if(y!==0?(g&=y-1,g+=y):g=0,u++,--C[d]===0){if(d===h)break;d=t[r+o[u]]}if(d>A&&(g&j)!==_){for(p===0&&(p=A),N+=f,x=d-p,b=1<<x;x+p<h&&(b-=C[x+p],!(b<=0));)x++,b<<=1;if(m+=1<<x,e===Tv&&m>O5||e===M5&&m>U5)return 1;_=g&j,s[_]=A<<24|x<<16|N-i|0}}return g!==0&&(s[N+g]=d-p<<24|64<<16|0),l.bits=A,0};var Sf=qR;const $R=0,zE=1,GE=2,{Z_FINISH:Q5,Z_BLOCK:KR,Z_TREES:Xp,Z_OK:Yd,Z_STREAM_END:VR,Z_NEED_DICT:WR,Z_STREAM_ERROR:Ki,Z_DATA_ERROR:XE,Z_MEM_ERROR:YE,Z_BUF_ERROR:zR,Z_DEFLATED:H5}=KE,Qx=16180,q5=16181,$5=16182,K5=16183,V5=16184,W5=16185,z5=16186,G5=16187,X5=16188,Y5=16189,qg=16190,yl=16191,Iv=16192,J5=16193,Dv=16194,Z5=16195,e4=16196,t4=16197,r4=16198,Yp=16199,Jp=16200,n4=16201,a4=16202,s4=16203,i4=16204,o4=16205,Lv=16206,l4=16207,c4=16208,vn=16209,JE=16210,ZE=16211,GR=852,XR=592,YR=15,JR=YR,d4=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function ZR(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const iu=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<Qx||t.mode>ZE?1:0},e6=e=>{if(iu(e))return Ki;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=Qx,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(GR),t.distcode=t.distdyn=new Int32Array(XR),t.sane=1,t.back=-1,Yd},t6=e=>{if(iu(e))return Ki;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,e6(e)},r6=(e,t)=>{let r;if(iu(e))return Ki;const a=e.state;return t<0?(r=0,t=-t):(r=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?Ki:(a.window!==null&&a.wbits!==t&&(a.window=null),a.wrap=r,a.wbits=t,t6(e))},n6=(e,t)=>{if(!e)return Ki;const r=new ZR;e.state=r,r.strm=e,r.window=null,r.mode=Qx;const a=r6(e,t);return a!==Yd&&(e.state=null),a},e9=e=>n6(e,JR);let u4=!0,Pv,Ov;const t9=e=>{if(u4){Pv=new Int32Array(512),Ov=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(Sf(zE,e.lens,0,288,Pv,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;Sf(GE,e.lens,0,32,Ov,0,e.work,{bits:5}),u4=!1}e.lencode=Pv,e.lenbits=9,e.distcode=Ov,e.distbits=5},a6=(e,t,r,a)=>{let s;const i=e.state;return i.window===null&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new Uint8Array(i.wsize)),a>=i.wsize?(i.window.set(t.subarray(r-i.wsize,r),0),i.wnext=0,i.whave=i.wsize):(s=i.wsize-i.wnext,s>a&&(s=a),i.window.set(t.subarray(r-a,r-a+s),i.wnext),a-=s,a?(i.window.set(t.subarray(r-a,r),0),i.wnext=a,i.whave=i.wsize):(i.wnext+=s,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=s))),0},r9=(e,t)=>{let r,a,s,i,o,l,c,d,u,f,h,A,x,p,b=0,m,g,y,v,_,j,N,B;const E=new Uint8Array(4);let C,k;const w=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(iu(e)||!e.output||!e.input&&e.avail_in!==0)return Ki;r=e.state,r.mode===yl&&(r.mode=Iv),o=e.next_out,s=e.output,c=e.avail_out,i=e.next_in,a=e.input,l=e.avail_in,d=r.hold,u=r.bits,f=l,h=c,B=Yd;e:for(;;)switch(r.mode){case Qx:if(r.wrap===0){r.mode=Iv;break}for(;u<16;){if(l===0)break e;l--,d+=a[i++]<<u,u+=8}if(r.wrap&2&&d===35615){r.wbits===0&&(r.wbits=15),r.check=0,E[0]=d&255,E[1]=d>>>8&255,r.check=Fo(r.check,E,2,0),d=0,u=0,r.mode=q5;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((d&255)<<8)+(d>>8))%31){e.msg="incorrect header check",r.mode=vn;break}if((d&15)!==H5){e.msg="unknown compression method",r.mode=vn;break}if(d>>>=4,u-=4,N=(d&15)+8,r.wbits===0&&(r.wbits=N),N>15||N>r.wbits){e.msg="invalid window size",r.mode=vn;break}r.dmax=1<<r.wbits,r.flags=0,e.adler=r.check=1,r.mode=d&512?Y5:yl,d=0,u=0;break;case q5:for(;u<16;){if(l===0)break e;l--,d+=a[i++]<<u,u+=8}if(r.flags=d,(r.flags&255)!==H5){e.msg="unknown compression method",r.mode=vn;break}if(r.flags&57344){e.msg="unknown header flags set",r.mode=vn;break}r.head&&(r.head.text=d>>8&1),r.flags&512&&r.wrap&4&&(E[0]=d&255,E[1]=d>>>8&255,r.check=Fo(r.check,E,2,0)),d=0,u=0,r.mode=$5;case $5:for(;u<32;){if(l===0)break e;l--,d+=a[i++]<<u,u+=8}r.head&&(r.head.time=d),r.flags&512&&r.wrap&4&&(E[0]=d&255,E[1]=d>>>8&255,E[2]=d>>>16&255,E[3]=d>>>24&255,r.check=Fo(r.check,E,4,0)),d=0,u=0,r.mode=K5;case K5:for(;u<16;){if(l===0)break e;l--,d+=a[i++]<<u,u+=8}r.head&&(r.head.xflags=d&255,r.head.os=d>>8),r.flags&512&&r.wrap&4&&(E[0]=d&255,E[1]=d>>>8&255,r.check=Fo(r.check,E,2,0)),d=0,u=0,r.mode=V5;case V5:if(r.flags&1024){for(;u<16;){if(l===0)break e;l--,d+=a[i++]<<u,u+=8}r.length=d,r.head&&(r.head.extra_len=d),r.flags&512&&r.wrap&4&&(E[0]=d&255,E[1]=d>>>8&255,r.check=Fo(r.check,E,2,0)),d=0,u=0}else r.head&&(r.head.extra=null);r.mode=W5;case W5:if(r.flags&1024&&(A=r.length,A>l&&(A=l),A&&(r.head&&(N=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(a.subarray(i,i+A),N)),r.flags&512&&r.wrap&4&&(r.check=Fo(r.check,a,A,i)),l-=A,i+=A,r.length-=A),r.length))break e;r.length=0,r.mode=z5;case z5:if(r.flags&2048){if(l===0)break e;A=0;do N=a[i+A++],r.head&&N&&r.length<65536&&(r.head.name+=String.fromCharCode(N));while(N&&A<l);if(r.flags&512&&r.wrap&4&&(r.check=Fo(r.check,a,A,i)),l-=A,i+=A,N)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=G5;case G5:if(r.flags&4096){if(l===0)break e;A=0;do N=a[i+A++],r.head&&N&&r.length<65536&&(r.head.comment+=String.fromCharCode(N));while(N&&A<l);if(r.flags&512&&r.wrap&4&&(r.check=Fo(r.check,a,A,i)),l-=A,i+=A,N)break e}else r.head&&(r.head.comment=null);r.mode=X5;case X5:if(r.flags&512){for(;u<16;){if(l===0)break e;l--,d+=a[i++]<<u,u+=8}if(r.wrap&4&&d!==(r.check&65535)){e.msg="header crc mismatch",r.mode=vn;break}d=0,u=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=yl;break;case Y5:for(;u<32;){if(l===0)break e;l--,d+=a[i++]<<u,u+=8}e.adler=r.check=d4(d),d=0,u=0,r.mode=qg;case qg:if(r.havedict===0)return e.next_out=o,e.avail_out=c,e.next_in=i,e.avail_in=l,r.hold=d,r.bits=u,WR;e.adler=r.check=1,r.mode=yl;case yl:if(t===KR||t===Xp)break e;case Iv:if(r.last){d>>>=u&7,u-=u&7,r.mode=Lv;break}for(;u<3;){if(l===0)break e;l--,d+=a[i++]<<u,u+=8}switch(r.last=d&1,d>>>=1,u-=1,d&3){case 0:r.mode=J5;break;case 1:if(t9(r),r.mode=Yp,t===Xp){d>>>=2,u-=2;break e}break;case 2:r.mode=e4;break;case 3:e.msg="invalid block type",r.mode=vn}d>>>=2,u-=2;break;case J5:for(d>>>=u&7,u-=u&7;u<32;){if(l===0)break e;l--,d+=a[i++]<<u,u+=8}if((d&65535)!==(d>>>16^65535)){e.msg="invalid stored block lengths",r.mode=vn;break}if(r.length=d&65535,d=0,u=0,r.mode=Dv,t===Xp)break e;case Dv:r.mode=Z5;case Z5:if(A=r.length,A){if(A>l&&(A=l),A>c&&(A=c),A===0)break e;s.set(a.subarray(i,i+A),o),l-=A,i+=A,c-=A,o+=A,r.length-=A;break}r.mode=yl;break;case e4:for(;u<14;){if(l===0)break e;l--,d+=a[i++]<<u,u+=8}if(r.nlen=(d&31)+257,d>>>=5,u-=5,r.ndist=(d&31)+1,d>>>=5,u-=5,r.ncode=(d&15)+4,d>>>=4,u-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=vn;break}r.have=0,r.mode=t4;case t4:for(;r.have<r.ncode;){for(;u<3;){if(l===0)break e;l--,d+=a[i++]<<u,u+=8}r.lens[w[r.have++]]=d&7,d>>>=3,u-=3}for(;r.have<19;)r.lens[w[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,C={bits:r.lenbits},B=Sf($R,r.lens,0,19,r.lencode,0,r.work,C),r.lenbits=C.bits,B){e.msg="invalid code lengths set",r.mode=vn;break}r.have=0,r.mode=r4;case r4:for(;r.have<r.nlen+r.ndist;){for(;b=r.lencode[d&(1<<r.lenbits)-1],m=b>>>24,g=b>>>16&255,y=b&65535,!(m<=u);){if(l===0)break e;l--,d+=a[i++]<<u,u+=8}if(y<16)d>>>=m,u-=m,r.lens[r.have++]=y;else{if(y===16){for(k=m+2;u<k;){if(l===0)break e;l--,d+=a[i++]<<u,u+=8}if(d>>>=m,u-=m,r.have===0){e.msg="invalid bit length repeat",r.mode=vn;break}N=r.lens[r.have-1],A=3+(d&3),d>>>=2,u-=2}else if(y===17){for(k=m+3;u<k;){if(l===0)break e;l--,d+=a[i++]<<u,u+=8}d>>>=m,u-=m,N=0,A=3+(d&7),d>>>=3,u-=3}else{for(k=m+7;u<k;){if(l===0)break e;l--,d+=a[i++]<<u,u+=8}d>>>=m,u-=m,N=0,A=11+(d&127),d>>>=7,u-=7}if(r.have+A>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=vn;break}for(;A--;)r.lens[r.have++]=N}}if(r.mode===vn)break;if(r.lens[256]===0){e.msg="invalid code -- missing end-of-block",r.mode=vn;break}if(r.lenbits=9,C={bits:r.lenbits},B=Sf(zE,r.lens,0,r.nlen,r.lencode,0,r.work,C),r.lenbits=C.bits,B){e.msg="invalid literal/lengths set",r.mode=vn;break}if(r.distbits=6,r.distcode=r.distdyn,C={bits:r.distbits},B=Sf(GE,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,C),r.distbits=C.bits,B){e.msg="invalid distances set",r.mode=vn;break}if(r.mode=Yp,t===Xp)break e;case Yp:r.mode=Jp;case Jp:if(l>=6&&c>=258){e.next_out=o,e.avail_out=c,e.next_in=i,e.avail_in=l,r.hold=d,r.bits=u,UR(e,h),o=e.next_out,s=e.output,c=e.avail_out,i=e.next_in,a=e.input,l=e.avail_in,d=r.hold,u=r.bits,r.mode===yl&&(r.back=-1);break}for(r.back=0;b=r.lencode[d&(1<<r.lenbits)-1],m=b>>>24,g=b>>>16&255,y=b&65535,!(m<=u);){if(l===0)break e;l--,d+=a[i++]<<u,u+=8}if(g&&!(g&240)){for(v=m,_=g,j=y;b=r.lencode[j+((d&(1<<v+_)-1)>>v)],m=b>>>24,g=b>>>16&255,y=b&65535,!(v+m<=u);){if(l===0)break e;l--,d+=a[i++]<<u,u+=8}d>>>=v,u-=v,r.back+=v}if(d>>>=m,u-=m,r.back+=m,r.length=y,g===0){r.mode=o4;break}if(g&32){r.back=-1,r.mode=yl;break}if(g&64){e.msg="invalid literal/length code",r.mode=vn;break}r.extra=g&15,r.mode=n4;case n4:if(r.extra){for(k=r.extra;u<k;){if(l===0)break e;l--,d+=a[i++]<<u,u+=8}r.length+=d&(1<<r.extra)-1,d>>>=r.extra,u-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=a4;case a4:for(;b=r.distcode[d&(1<<r.distbits)-1],m=b>>>24,g=b>>>16&255,y=b&65535,!(m<=u);){if(l===0)break e;l--,d+=a[i++]<<u,u+=8}if(!(g&240)){for(v=m,_=g,j=y;b=r.distcode[j+((d&(1<<v+_)-1)>>v)],m=b>>>24,g=b>>>16&255,y=b&65535,!(v+m<=u);){if(l===0)break e;l--,d+=a[i++]<<u,u+=8}d>>>=v,u-=v,r.back+=v}if(d>>>=m,u-=m,r.back+=m,g&64){e.msg="invalid distance code",r.mode=vn;break}r.offset=y,r.extra=g&15,r.mode=s4;case s4:if(r.extra){for(k=r.extra;u<k;){if(l===0)break e;l--,d+=a[i++]<<u,u+=8}r.offset+=d&(1<<r.extra)-1,d>>>=r.extra,u-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=vn;break}r.mode=i4;case i4:if(c===0)break e;if(A=h-c,r.offset>A){if(A=r.offset-A,A>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=vn;break}A>r.wnext?(A-=r.wnext,x=r.wsize-A):x=r.wnext-A,A>r.length&&(A=r.length),p=r.window}else p=s,x=o-r.offset,A=r.length;A>c&&(A=c),c-=A,r.length-=A;do s[o++]=p[x++];while(--A);r.length===0&&(r.mode=Jp);break;case o4:if(c===0)break e;s[o++]=r.length,c--,r.mode=Jp;break;case Lv:if(r.wrap){for(;u<32;){if(l===0)break e;l--,d|=a[i++]<<u,u+=8}if(h-=c,e.total_out+=h,r.total+=h,r.wrap&4&&h&&(e.adler=r.check=r.flags?Fo(r.check,s,h,o-h):o_(r.check,s,h,o-h)),h=c,r.wrap&4&&(r.flags?d:d4(d))!==r.check){e.msg="incorrect data check",r.mode=vn;break}d=0,u=0}r.mode=l4;case l4:if(r.wrap&&r.flags){for(;u<32;){if(l===0)break e;l--,d+=a[i++]<<u,u+=8}if(r.wrap&4&&d!==(r.total&4294967295)){e.msg="incorrect length check",r.mode=vn;break}d=0,u=0}r.mode=c4;case c4:B=VR;break e;case vn:B=XE;break e;case JE:return YE;case ZE:default:return Ki}return e.next_out=o,e.avail_out=c,e.next_in=i,e.avail_in=l,r.hold=d,r.bits=u,(r.wsize||h!==e.avail_out&&r.mode<vn&&(r.mode<Lv||t!==Q5))&&a6(e,e.output,e.next_out,h-e.avail_out),f-=e.avail_in,h-=e.avail_out,e.total_in+=f,e.total_out+=h,r.total+=h,r.wrap&4&&h&&(e.adler=r.check=r.flags?Fo(r.check,s,h,e.next_out-h):o_(r.check,s,h,e.next_out-h)),e.data_type=r.bits+(r.last?64:0)+(r.mode===yl?128:0)+(r.mode===Yp||r.mode===Dv?256:0),(f===0&&h===0||t===Q5)&&B===Yd&&(B=zR),B},n9=e=>{if(iu(e))return Ki;let t=e.state;return t.window&&(t.window=null),e.state=null,Yd},a9=(e,t)=>{if(iu(e))return Ki;const r=e.state;return r.wrap&2?(r.head=t,t.done=!1,Yd):Ki},s9=(e,t)=>{const r=t.length;let a,s,i;return iu(e)||(a=e.state,a.wrap!==0&&a.mode!==qg)?Ki:a.mode===qg&&(s=1,s=o_(s,t,r,0),s!==a.check)?XE:(i=a6(e,t,r,r),i?(a.mode=JE,YE):(a.havedict=1,Yd))};var i9=t6,o9=r6,l9=e6,c9=e9,d9=n6,u9=r9,A9=n9,h9=a9,f9=s9,p9="pako inflate (from Nodeca project)",jl={inflateReset:i9,inflateReset2:o9,inflateResetKeep:l9,inflateInit:c9,inflateInit2:d9,inflate:u9,inflateEnd:A9,inflateGetHeader:h9,inflateSetDictionary:f9,inflateInfo:p9};function m9(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var g9=m9;const s6=Object.prototype.toString,{Z_NO_FLUSH:x9,Z_FINISH:y9,Z_OK:h0,Z_STREAM_END:Uv,Z_NEED_DICT:Rv,Z_STREAM_ERROR:v9,Z_DATA_ERROR:A4,Z_MEM_ERROR:b9}=KE;function R0(e){this.options=VE.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new PR,this.strm.avail_out=0;let r=jl.inflateInit2(this.strm,t.windowBits);if(r!==h0)throw new Error(l_[r]);if(this.header=new g9,jl.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=c_.string2buf(t.dictionary):s6.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=jl.inflateSetDictionary(this.strm,t.dictionary),r!==h0)))throw new Error(l_[r])}R0.prototype.push=function(e,t){const r=this.strm,a=this.options.chunkSize,s=this.options.dictionary;let i,o,l;if(this.ended)return!1;for(t===~~t?o=t:o=t===!0?y9:x9,s6.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(a),r.next_out=0,r.avail_out=a),i=jl.inflate(r,o),i===Rv&&s&&(i=jl.inflateSetDictionary(r,s),i===h0?i=jl.inflate(r,o):i===A4&&(i=Rv));r.avail_in>0&&i===Uv&&r.state.wrap>0&&e[r.next_in]!==0;)jl.inflateReset(r),i=jl.inflate(r,o);switch(i){case v9:case A4:case Rv:case b9:return this.onEnd(i),this.ended=!0,!1}if(l=r.avail_out,r.next_out&&(r.avail_out===0||i===Uv))if(this.options.to==="string"){let c=c_.utf8border(r.output,r.next_out),d=r.next_out-c,u=c_.buf2string(r.output,c);r.next_out=d,r.avail_out=a-d,d&&r.output.set(r.output.subarray(c,c+d),0),this.onData(u)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(i===h0&&l===0)){if(i===Uv)return i=jl.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};R0.prototype.onData=function(e){this.chunks.push(e)};R0.prototype.onEnd=function(e){e===h0&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=VE.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function _9(e,t){const r=new R0(t);if(r.push(e),r.err)throw r.msg||l_[r.err];return r.result}var w9=R0,N9=_9,j9={Inflate:w9,inflate:N9};const{Inflate:k9,inflate:C9}=j9;var h4=k9,S9=C9;const i6=[];for(let e=0;e<256;e++){let t=e;for(let r=0;r<8;r++)t&1?t=3988292384^t>>>1:t=t>>>1;i6[e]=t}const f4=4294967295;function B9(e,t,r){let a=e;for(let s=0;s<r;s++)a=i6[(a^t[s])&255]^a>>>8;return a}function E9(e,t){return(B9(f4,e,t)^f4)>>>0}function p4(e,t,r){const a=e.readUint32(),s=E9(new Uint8Array(e.buffer,e.byteOffset+e.offset-t-4,t),t);if(s!==a)throw new Error(`CRC mismatch for chunk ${r}. Expected ${a}, found ${s}`)}function o6(e,t,r){for(let a=0;a<r;a++)t[a]=e[a]}function l6(e,t,r,a){let s=0;for(;s<a;s++)t[s]=e[s];for(;s<r;s++)t[s]=e[s]+t[s-a]&255}function c6(e,t,r,a){let s=0;if(r.length===0)for(;s<a;s++)t[s]=e[s];else for(;s<a;s++)t[s]=e[s]+r[s]&255}function d6(e,t,r,a,s){let i=0;if(r.length===0){for(;i<s;i++)t[i]=e[i];for(;i<a;i++)t[i]=e[i]+(t[i-s]>>1)&255}else{for(;i<s;i++)t[i]=e[i]+(r[i]>>1)&255;for(;i<a;i++)t[i]=e[i]+(t[i-s]+r[i]>>1)&255}}function u6(e,t,r,a,s){let i=0;if(r.length===0){for(;i<s;i++)t[i]=e[i];for(;i<a;i++)t[i]=e[i]+t[i-s]&255}else{for(;i<s;i++)t[i]=e[i]+r[i]&255;for(;i<a;i++)t[i]=e[i]+F9(t[i-s],r[i],r[i-s])&255}}function F9(e,t,r){const a=e+t-r,s=Math.abs(a-e),i=Math.abs(a-t),o=Math.abs(a-r);return s<=i&&s<=o?e:i<=o?t:r}function T9(e,t,r,a,s,i){switch(e){case 0:o6(t,r,s);break;case 1:l6(t,r,s,i);break;case 2:c6(t,r,a,s);break;case 3:d6(t,r,a,s,i);break;case 4:u6(t,r,a,s,i);break;default:throw new Error(`Unsupported filter: ${e}`)}}const I9=new Uint16Array([255]),D9=new Uint8Array(I9.buffer),L9=D9[0]===255;function P9(e){const{data:t,width:r,height:a,channels:s,depth:i}=e,o=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],l=Math.ceil(i/8)*s,c=new Uint8Array(a*r*l);let d=0;for(let u=0;u<7;u++){const f=o[u],h=Math.ceil((r-f.x)/f.xStep),A=Math.ceil((a-f.y)/f.yStep);if(h<=0||A<=0)continue;const x=h*l,p=new Uint8Array(x);for(let b=0;b<A;b++){const m=t[d++],g=t.subarray(d,d+x);d+=x;const y=new Uint8Array(x);T9(m,g,y,p,x,l),p.set(y);for(let v=0;v<h;v++){const _=f.x+v*f.xStep,j=f.y+b*f.yStep;if(!(_>=r||j>=a))for(let N=0;N<l;N++)c[(j*r+_)*l+N]=y[v*l+N]}}}if(i===16){const u=new Uint16Array(c.buffer);if(L9)for(let f=0;f<u.length;f++)u[f]=O9(u[f]);return u}else return c}function O9(e){return(e&255)<<8|e>>8&255}const U9=new Uint16Array([255]),R9=new Uint8Array(U9.buffer),M9=R9[0]===255,Q9=new Uint8Array(0);function m4(e){const{data:t,width:r,height:a,channels:s,depth:i}=e,o=Math.ceil(i/8)*s,l=Math.ceil(i/8*s*r),c=new Uint8Array(a*l);let d=Q9,u=0,f,h;for(let A=0;A<a;A++){switch(f=t.subarray(u+1,u+1+l),h=c.subarray(A*l,(A+1)*l),t[u]){case 0:o6(f,h,l);break;case 1:l6(f,h,l,o);break;case 2:c6(f,h,d,l);break;case 3:d6(f,h,d,l,o);break;case 4:u6(f,h,d,l,o);break;default:throw new Error(`Unsupported filter: ${t[u]}`)}d=h,u+=l+1}if(i===16){const A=new Uint16Array(c.buffer);if(M9)for(let x=0;x<A.length;x++)A[x]=H9(A[x]);return A}else return c}function H9(e){return(e&255)<<8|e>>8&255}const tg=Uint8Array.of(137,80,78,71,13,10,26,10);function g4(e){if(!q9(e.readBytes(tg.length)))throw new Error("wrong PNG signature")}function q9(e){if(e.length<tg.length)return!1;for(let t=0;t<tg.length;t++)if(e[t]!==tg[t])return!1;return!0}const $9="tEXt",K9=0,A6=new TextDecoder("latin1");function V9(e){if(z9(e),e.length===0||e.length>79)throw new Error("keyword length must be between 1 and 79")}const W9=/^[\u0000-\u00FF]*$/;function z9(e){if(!W9.test(e))throw new Error("invalid latin1 text")}function G9(e,t,r){const a=h6(t);e[a]=X9(t,r-a.length-1)}function h6(e){for(e.mark();e.readByte()!==K9;);const t=e.offset;e.reset();const r=A6.decode(e.readBytes(t-e.offset-1));return e.skip(1),V9(r),r}function X9(e,t){return A6.decode(e.readBytes(t))}const ai={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},Mv={UNKNOWN:-1,DEFLATE:0},x4={UNKNOWN:-1,ADAPTIVE:0},Qv={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},Zp={NONE:0,BACKGROUND:1,PREVIOUS:2},Hv={SOURCE:0,OVER:1};class Y9 extends r2{constructor(r,a={}){super(r);Kr(this,"_checkCrc");Kr(this,"_inflator");Kr(this,"_png");Kr(this,"_apng");Kr(this,"_end");Kr(this,"_hasPalette");Kr(this,"_palette");Kr(this,"_hasTransparency");Kr(this,"_transparency");Kr(this,"_compressionMethod");Kr(this,"_filterMethod");Kr(this,"_interlaceMethod");Kr(this,"_colorType");Kr(this,"_isAnimated");Kr(this,"_numberOfFrames");Kr(this,"_numberOfPlays");Kr(this,"_frames");Kr(this,"_writingDataChunks");const{checkCrc:s=!1}=a;this._checkCrc=s,this._inflator=new h4,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=Mv.UNKNOWN,this._filterMethod=x4.UNKNOWN,this._interlaceMethod=Qv.UNKNOWN,this._colorType=ai.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(g4(this);!this._end;){const r=this.readUint32(),a=this.readChars(4);this.decodeChunk(r,a)}return this.decodeImage(),this._png}decodeApng(){for(g4(this);!this._end;){const r=this.readUint32(),a=this.readChars(4);this.decodeApngChunk(r,a)}return this.decodeApngImage(),this._apng}decodeChunk(r,a){const s=this.offset;switch(a){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(r);break;case"IDAT":this.decodeIDAT(r);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(r);break;case"iCCP":this.decodeiCCP(r);break;case $9:G9(this._png.text,this,r);break;case"pHYs":this.decodepHYs();break;default:this.skip(r);break}if(this.offset-s!==r)throw new Error(`Length mismatch while decoding chunk ${a}`);this._checkCrc?p4(this,r+4,a):this.skip(4)}decodeApngChunk(r,a){const s=this.offset;switch(a!=="fdAT"&&a!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),a){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(r);break;default:this.decodeChunk(r,a),this.offset=s+r;break}if(this.offset-s!==r)throw new Error(`Length mismatch while decoding chunk ${a}`);this._checkCrc?p4(this,r+4,a):this.skip(4)}decodeIHDR(){const r=this._png;r.width=this.readUint32(),r.height=this.readUint32(),r.depth=J9(this.readUint8());const a=this.readUint8();this._colorType=a;let s;switch(a){case ai.GREYSCALE:s=1;break;case ai.TRUECOLOUR:s=3;break;case ai.INDEXED_COLOUR:s=1;break;case ai.GREYSCALE_ALPHA:s=2;break;case ai.TRUECOLOUR_ALPHA:s=4;break;case ai.UNKNOWN:default:throw new Error(`Unknown color type: ${a}`)}if(this._png.channels=s,this._compressionMethod=this.readUint8(),this._compressionMethod!==Mv.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const r={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(r)}decodePLTE(r){if(r%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${r}`);const a=r/3;this._hasPalette=!0;const s=[];this._palette=s;for(let i=0;i<a;i++)s.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(r){this._writingDataChunks=!0;const a=r,s=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,s,a)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodeFDAT(r){this._writingDataChunks=!0;let a=r,s=this.offset+this.byteOffset;if(s+=4,a-=4,this._inflator.push(new Uint8Array(this.buffer,s,a)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodetRNS(r){switch(this._colorType){case ai.GREYSCALE:case ai.TRUECOLOUR:{if(r%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${r}`);if(r/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${r/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(r/2);for(let a=0;a<r/2;a++)this._transparency[a]=this.readUint16();break}case ai.INDEXED_COLOUR:{if(r>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${r} vs ${this._palette.length})`);let a=0;for(;a<r;a++){const s=this.readByte();this._palette[a].push(s)}for(;a<this._palette.length;a++)this._palette[a].push(255);break}case ai.UNKNOWN:case ai.GREYSCALE_ALPHA:case ai.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(r){const a=h6(this),s=this.readUint8();if(s!==Mv.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${s}`);const i=this.readBytes(r-a.length-2);this._png.iccEmbeddedProfile={name:a,profile:S9(i)}}decodepHYs(){const r=this.readUint32(),a=this.readUint32(),s=this.readByte();this._png.resolution={x:r,y:a,unit:s}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let r=0;r<this._numberOfFrames;r++){const a={sequenceNumber:this._frames[r].sequenceNumber,delayNumber:this._frames[r].delayNumber,delayDenominator:this._frames[r].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},s=this._frames.at(r);if(s){if(s.data=m4({data:s.data,width:s.width,height:s.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),r===0||s.xOffset===0&&s.yOffset===0&&s.width===this._png.width&&s.height===this._png.height)a.data=s.data;else{const i=this._apng.frames.at(r-1);this.disposeFrame(s,i,a),this.addFrameDataToCanvas(a,s)}this._apng.frames.push(a)}}return this._apng}disposeFrame(r,a,s){switch(r.disposeOp){case Zp.NONE:break;case Zp.BACKGROUND:for(let i=0;i<this._png.height;i++)for(let o=0;o<this._png.width;o++){const l=(i*r.width+o)*this._png.channels;for(let c=0;c<this._png.channels;c++)s.data[l+c]=0}break;case Zp.PREVIOUS:s.data.set(a.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(r,a){const s=1<<this._png.depth,i=(o,l)=>{const c=((o+a.yOffset)*this._png.width+a.xOffset+l)*this._png.channels,d=(o*a.width+l)*this._png.channels;return{index:c,frameIndex:d}};switch(a.blendOp){case Hv.SOURCE:for(let o=0;o<a.height;o++)for(let l=0;l<a.width;l++){const{index:c,frameIndex:d}=i(o,l);for(let u=0;u<this._png.channels;u++)r.data[c+u]=a.data[d+u]}break;case Hv.OVER:for(let o=0;o<a.height;o++)for(let l=0;l<a.width;l++){const{index:c,frameIndex:d}=i(o,l);for(let u=0;u<this._png.channels;u++){const f=a.data[d+this._png.channels-1]/s,h=u%(this._png.channels-1)===0?1:a.data[d+u],A=Math.floor(f*h+(1-f)*r.data[c+u]);r.data[c+u]+=A}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var a;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const r=this._isAnimated?((a=this._frames)==null?void 0:a.at(0)).data:this._inflator.result;if(this._filterMethod!==x4.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===Qv.NO_INTERLACE)this._png.data=m4({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===Qv.ADAM7)this._png.data=P9({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const r=this._inflator.result,a=this._frames.at(-1);a?a.data=r:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:Zp.NONE,blendOp:Hv.SOURCE,data:r}),this._inflator=new h4,this._writingDataChunks=!1}}function J9(e){if(e!==1&&e!==2&&e!==4&&e!==8&&e!==16)throw new Error(`invalid bit depth: ${e}`);return e}var y4;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.METRE=1]="METRE"})(y4||(y4={}));function Z9(e,t){return new Y9(e,t).decode()}var lr=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function qv(){lr.console&&typeof lr.console.log=="function"&&lr.console.log.apply(lr.console,arguments)}var rn={log:qv,warn:function(e){lr.console&&(typeof lr.console.warn=="function"?lr.console.warn.apply(lr.console,arguments):qv.call(null,arguments))},error:function(e){lr.console&&(typeof lr.console.error=="function"?lr.console.error.apply(lr.console,arguments):qv(e))}};function $v(e,t,r){var a=new XMLHttpRequest;a.open("GET",e),a.responseType="blob",a.onload=function(){_d(a.response,t,r)},a.onerror=function(){rn.error("could not download file")},a.send()}function v4(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function em(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var _d=lr.saveAs||((typeof window>"u"?"undefined":zr(window))!=="object"||window!==lr?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,r){var a=lr.URL||lr.webkitURL,s=document.createElement("a");t=t||e.name||"download",s.download=t,s.rel="noopener",typeof e=="string"?(s.href=e,s.origin!==location.origin?v4(s.href)?$v(e,t,r):em(s,s.target="_blank"):em(s)):(s.href=a.createObjectURL(e),setTimeout(function(){a.revokeObjectURL(s.href)},4e4),setTimeout(function(){em(s)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,r){if(t=t||e.name||"download",typeof e=="string")if(v4(e))$v(e,t,r);else{var a=document.createElement("a");a.href=e,a.target="_blank",setTimeout(function(){em(a)})}else navigator.msSaveOrOpenBlob(function(s,i){return i===void 0?i={autoBom:!1}:zr(i)!=="object"&&(rn.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(s.type)?new Blob(["\uFEFF",s],{type:s.type}):s}(e,r),t)}:function(e,t,r,a){if((a=a||open("","_blank"))&&(a.document.title=a.document.body.innerText="downloading..."),typeof e=="string")return $v(e,t,r);var s=e.type==="application/octet-stream",i=/constructor/i.test(lr.HTMLElement)||lr.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||s&&i)&&(typeof FileReader>"u"?"undefined":zr(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var u=l.result;u=o?u:u.replace(/^data:[^;]*;/,"data:attachment/file;"),a?a.location.href=u:location=u,a=null},l.readAsDataURL(e)}else{var c=lr.URL||lr.webkitURL,d=c.createObjectURL(e);a?a.location=d:location.href=d,a=null,setTimeout(function(){c.revokeObjectURL(d)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function f6(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],a=0;a<r.length;a++){var s=r[a].re,i=r[a].process,o=s.exec(e);o&&(t=i(o),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),d=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),d.length==1&&(d="0"+d),"#"+l+c+d}}var rg=lr.atob.bind(lr),b4=lr.btoa.bind(lr);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function Kv(e,t){var r=e[0],a=e[1],s=e[2],i=e[3];r=es(r,a,s,i,t[0],7,-680876936),i=es(i,r,a,s,t[1],12,-389564586),s=es(s,i,r,a,t[2],17,606105819),a=es(a,s,i,r,t[3],22,-1044525330),r=es(r,a,s,i,t[4],7,-176418897),i=es(i,r,a,s,t[5],12,1200080426),s=es(s,i,r,a,t[6],17,-1473231341),a=es(a,s,i,r,t[7],22,-45705983),r=es(r,a,s,i,t[8],7,1770035416),i=es(i,r,a,s,t[9],12,-1958414417),s=es(s,i,r,a,t[10],17,-42063),a=es(a,s,i,r,t[11],22,-1990404162),r=es(r,a,s,i,t[12],7,1804603682),i=es(i,r,a,s,t[13],12,-40341101),s=es(s,i,r,a,t[14],17,-1502002290),r=ts(r,a=es(a,s,i,r,t[15],22,1236535329),s,i,t[1],5,-165796510),i=ts(i,r,a,s,t[6],9,-1069501632),s=ts(s,i,r,a,t[11],14,643717713),a=ts(a,s,i,r,t[0],20,-373897302),r=ts(r,a,s,i,t[5],5,-701558691),i=ts(i,r,a,s,t[10],9,38016083),s=ts(s,i,r,a,t[15],14,-660478335),a=ts(a,s,i,r,t[4],20,-405537848),r=ts(r,a,s,i,t[9],5,568446438),i=ts(i,r,a,s,t[14],9,-1019803690),s=ts(s,i,r,a,t[3],14,-187363961),a=ts(a,s,i,r,t[8],20,1163531501),r=ts(r,a,s,i,t[13],5,-1444681467),i=ts(i,r,a,s,t[2],9,-51403784),s=ts(s,i,r,a,t[7],14,1735328473),r=rs(r,a=ts(a,s,i,r,t[12],20,-1926607734),s,i,t[5],4,-378558),i=rs(i,r,a,s,t[8],11,-2022574463),s=rs(s,i,r,a,t[11],16,1839030562),a=rs(a,s,i,r,t[14],23,-35309556),r=rs(r,a,s,i,t[1],4,-1530992060),i=rs(i,r,a,s,t[4],11,1272893353),s=rs(s,i,r,a,t[7],16,-155497632),a=rs(a,s,i,r,t[10],23,-1094730640),r=rs(r,a,s,i,t[13],4,681279174),i=rs(i,r,a,s,t[0],11,-358537222),s=rs(s,i,r,a,t[3],16,-722521979),a=rs(a,s,i,r,t[6],23,76029189),r=rs(r,a,s,i,t[9],4,-640364487),i=rs(i,r,a,s,t[12],11,-421815835),s=rs(s,i,r,a,t[15],16,530742520),r=ns(r,a=rs(a,s,i,r,t[2],23,-995338651),s,i,t[0],6,-198630844),i=ns(i,r,a,s,t[7],10,1126891415),s=ns(s,i,r,a,t[14],15,-1416354905),a=ns(a,s,i,r,t[5],21,-57434055),r=ns(r,a,s,i,t[12],6,1700485571),i=ns(i,r,a,s,t[3],10,-1894986606),s=ns(s,i,r,a,t[10],15,-1051523),a=ns(a,s,i,r,t[1],21,-2054922799),r=ns(r,a,s,i,t[8],6,1873313359),i=ns(i,r,a,s,t[15],10,-30611744),s=ns(s,i,r,a,t[6],15,-1560198380),a=ns(a,s,i,r,t[13],21,1309151649),r=ns(r,a,s,i,t[4],6,-145523070),i=ns(i,r,a,s,t[11],10,-1120210379),s=ns(s,i,r,a,t[2],15,718787259),a=ns(a,s,i,r,t[9],21,-343485551),e[0]=jc(r,e[0]),e[1]=jc(a,e[1]),e[2]=jc(s,e[2]),e[3]=jc(i,e[3])}function Hx(e,t,r,a,s,i){return t=jc(jc(t,e),jc(a,i)),jc(t<<s|t>>>32-s,r)}function es(e,t,r,a,s,i,o){return Hx(t&r|~t&a,e,t,s,i,o)}function ts(e,t,r,a,s,i,o){return Hx(t&a|r&~a,e,t,s,i,o)}function rs(e,t,r,a,s,i,o){return Hx(t^r^a,e,t,s,i,o)}function ns(e,t,r,a,s,i,o){return Hx(r^(t|~a),e,t,s,i,o)}function p6(e){var t,r=e.length,a=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)Kv(a,eM(e.substring(t-64,t)));e=e.substring(t-64);var s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)s[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(s[t>>2]|=128<<(t%4<<3),t>55)for(Kv(a,s),t=0;t<16;t++)s[t]=0;return s[14]=8*r,Kv(a,s),a}function eM(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}var _4="0123456789abcdef".split("");function tM(e){for(var t="",r=0;r<4;r++)t+=_4[e>>8*r+4&15]+_4[e>>8*r&15];return t}function rM(e){return String.fromCharCode(255&e,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function d_(e){return p6(e).map(rM).join("")}var nM=function(e){for(var t=0;t<e.length;t++)e[t]=tM(e[t]);return e.join("")}(p6("hello"))!="5d41402abc4b2a76b9719d911017c592";function jc(e,t){if(nM){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function u_(e,t){var r,a,s,i;if(e!==r){for(var o=(s=e,i=1+(256/e.length|0),new Array(i+1).join(s)),l=[],c=0;c<256;c++)l[c]=c;var d=0;for(c=0;c<256;c++){var u=l[c];d=(d+u+o.charCodeAt(c))%256,l[c]=l[d],l[d]=u}r=e,a=l}else l=a;var f=t.length,h=0,A=0,x="";for(c=0;c<f;c++)A=(A+(u=l[h=(h+1)%256]))%256,l[h]=l[A],l[A]=u,o=l[(l[h]+l[A])%256],x+=String.fromCharCode(t.charCodeAt(c)^o);return x}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var w4={print:4,modify:8,copy:16,"annot-forms":32};function Vu(e,t,r,a){this.v=1,this.r=2;var s=192;e.forEach(function(l){if(w4.perm!==void 0)throw new Error("Invalid permission: "+l);s+=w4[l]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var i=(t+this.padding).substr(0,32),o=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(i,o),this.P=-(1+(255^s)),this.encryptionKey=d_(i+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(a)).substr(0,5),this.U=u_(this.encryptionKey,this.padding)}function Wu(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",r=e.length,a=0;a<r;a++){var s=e.charCodeAt(a);t+=s<33||s===35||s===37||s===40||s===41||s===47||s===60||s===62||s===91||s===93||s===123||s===125||s>126?"#"+("0"+s.toString(16)).slice(-2):e[a]}return t}function N4(e){if(zr(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(r,a,s){if(s=s||!1,typeof r!="string"||typeof a!="function"||typeof s!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(r)||(t[r]={});var i=Math.random().toString(35);return t[r][i]=[a,!!s],i},this.unsubscribe=function(r){for(var a in t)if(t[a][r])return delete t[a][r],Object.keys(t[a]).length===0&&delete t[a],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var a=Array.prototype.slice.call(arguments,1),s=[];for(var i in t[r]){var o=t[r][i];try{o[0].apply(e,a)}catch(l){lr.console&&rn.error("jsPDF PubSub Error",l.message,l)}o[1]&&s.push(i)}s.length&&s.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function $g(e){if(!(this instanceof $g))return new $g(e);var t="opacity,stroke-opacity".split(",");for(var r in e)e.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=e[r]);this.id="",this.objectNumber=-1}function m6(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function kd(e,t,r,a,s){if(!(this instanceof kd))return new kd(e,t,r,a,s);this.type=e==="axial"?2:3,this.coords=t,this.colors=r,m6.call(this,a,s)}function dA(e,t,r,a,s){if(!(this instanceof dA))return new dA(e,t,r,a,s);this.boundingBox=e,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,m6.call(this,a,s)}function Ut(e){var t,r=typeof arguments[0]=="string"?arguments[0]:"p",a=arguments[1],s=arguments[2],i=arguments[3],o=[],l=1,c=16,d="S",u=null;zr(e=e||{})==="object"&&(r=e.orientation,a=e.unit||a,s=e.format||s,i=e.compress||e.compressPdf||i,(u=e.encryption||null)!==null&&(u.userPassword=u.userPassword||"",u.ownerPassword=u.ownerPassword||"",u.userPermissions=u.userPermissions||[]),l=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(c=e.floatPrecision),d=e.defaultPathOperation||"S"),o=e.filters||(i===!0?["FlateEncode"]:o),a=a||"mm",r=(""+(r||"P")).toLowerCase();var f=e.putOnlyUsedFonts||!1,h={},A={internal:{},__private__:{}};A.__private__.PubSub=N4;var x="1.3",p=A.__private__.getPdfVersion=function(){return x};A.__private__.setPdfVersion=function(X){x=X};var b={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};A.__private__.getPageFormats=function(){return b};var m=A.__private__.getPageFormat=function(X){return b[X]};s=s||"a4";var g="compat",y="advanced",v=g;function _(){this.saveGraphicsState(),te(new ht(Ue,0,0,-Ue,0,id()*Ue).toString()+" cm"),this.setFontSize(this.getFontSize()/Ue),d="n",v=y}function j(){this.restoreGraphicsState(),d="S",v=g}var N=A.__private__.combineFontStyleAndFontWeight=function(X,fe){if(X=="bold"&&fe=="normal"||X=="bold"&&fe==400||X=="normal"&&fe=="italic"||X=="bold"&&fe=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return fe&&(X=fe==400||fe==="normal"?X==="italic"?"italic":"normal":fe!=700&&fe!=="bold"||X!=="normal"?(fe==700?"bold":fe)+""+X:"bold"),X};A.advancedAPI=function(X){var fe=v===g;return fe&&_.call(this),typeof X!="function"||(X(this),fe&&j.call(this)),this},A.compatAPI=function(X){var fe=v===y;return fe&&j.call(this),typeof X!="function"||(X(this),fe&&_.call(this)),this},A.isAdvancedAPI=function(){return v===y};var B,E=function(X){if(v!==y)throw new Error(X+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},C=A.roundToPrecision=A.__private__.roundToPrecision=function(X,fe){var De=t||fe;if(isNaN(X)||isNaN(De))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return X.toFixed(De).replace(/0+$/,"")};B=A.hpf=A.__private__.hpf=typeof c=="number"?function(X){if(isNaN(X))throw new Error("Invalid argument passed to jsPDF.hpf");return C(X,c)}:c==="smart"?function(X){if(isNaN(X))throw new Error("Invalid argument passed to jsPDF.hpf");return C(X,X>-1&&X<1?16:5)}:function(X){if(isNaN(X))throw new Error("Invalid argument passed to jsPDF.hpf");return C(X,16)};var k=A.f2=A.__private__.f2=function(X){if(isNaN(X))throw new Error("Invalid argument passed to jsPDF.f2");return C(X,2)},w=A.__private__.f3=function(X){if(isNaN(X))throw new Error("Invalid argument passed to jsPDF.f3");return C(X,3)},T=A.scale=A.__private__.scale=function(X){if(isNaN(X))throw new Error("Invalid argument passed to jsPDF.scale");return v===g?X*Ue:v===y?X:void 0},R=function(X){return T(function(fe){return v===g?id()-fe:v===y?fe:void 0}(X))};A.__private__.setPrecision=A.setPrecision=function(X){typeof parseInt(X,10)=="number"&&(t=parseInt(X,10))};var q,z="00000000000000000000000000000000",ee=A.__private__.getFileId=function(){return z},Y=A.__private__.setFileId=function(X){return z=X!==void 0&&/^[a-fA-F0-9]{32}$/.test(X)?X.toUpperCase():z.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),u!==null&&(ha=new Vu(u.userPermissions,u.userPassword,u.ownerPassword,z)),z};A.setFileId=function(X){return Y(X),this},A.getFileId=function(){return ee()};var G=A.__private__.convertDateToPDFDate=function(X){var fe=X.getTimezoneOffset(),De=fe<0?"+":"-",He=Math.floor(Math.abs(fe/60)),Ze=Math.abs(fe%60),ft=[De,L(He),"'",L(Ze),"'"].join("");return["D:",X.getFullYear(),L(X.getMonth()+1),L(X.getDate()),L(X.getHours()),L(X.getMinutes()),L(X.getSeconds()),ft].join("")},re=A.__private__.convertPDFDateToDate=function(X){var fe=parseInt(X.substr(2,4),10),De=parseInt(X.substr(6,2),10)-1,He=parseInt(X.substr(8,2),10),Ze=parseInt(X.substr(10,2),10),ft=parseInt(X.substr(12,2),10),vt=parseInt(X.substr(14,2),10);return new Date(fe,De,He,Ze,ft,vt,0)},U=A.__private__.setCreationDate=function(X){var fe;if(X===void 0&&(X=new Date),X instanceof Date)fe=G(X);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(X))throw new Error("Invalid argument passed to jsPDF.setCreationDate");fe=X}return q=fe},S=A.__private__.getCreationDate=function(X){var fe=q;return X==="jsDate"&&(fe=re(q)),fe};A.setCreationDate=function(X){return U(X),this},A.getCreationDate=function(X){return S(X)};var D,L=A.__private__.padd2=function(X){return("0"+parseInt(X)).slice(-2)},P=A.__private__.padd2Hex=function(X){return("00"+(X=X.toString())).substr(X.length)},I=0,H=[],V=[],W=0,M=[],se=[],K=!1,he=V;A.__private__.setCustomOutputDestination=function(X){K=!0,he=X};var ne=function(X){K||(he=X)};A.__private__.resetCustomOutputDestination=function(){K=!1,he=V};var te=A.__private__.out=function(X){return X=X.toString(),W+=X.length+1,he.push(X),he},ce=A.__private__.write=function(X){return te(arguments.length===1?X.toString():Array.prototype.join.call(arguments," "))},_e=A.__private__.getArrayBuffer=function(X){for(var fe=X.length,De=new ArrayBuffer(fe),He=new Uint8Array(De);fe--;)He[fe]=X.charCodeAt(fe);return De},de=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];A.__private__.getStandardFonts=function(){return de};var ye=e.fontSize||16;A.__private__.setFontSize=A.setFontSize=function(X){return ye=v===y?X/Ue:X,this};var Le,we=A.__private__.getFontSize=A.getFontSize=function(){return v===g?ye:ye*Ue},ge=e.R2L||!1;A.__private__.setR2L=A.setR2L=function(X){return ge=X,this},A.__private__.getR2L=A.getR2L=function(){return ge};var Re,et=A.__private__.setZoomMode=function(X){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(X))Le=X;else if(isNaN(X)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(X)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+X+'" is not recognized.');Le=X}else Le=parseInt(X,10)};A.__private__.getZoomMode=function(){return Le};var Ye,Be=A.__private__.setPageMode=function(X){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(X)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+X+'" is not recognized.');Re=X};A.__private__.getPageMode=function(){return Re};var Fe=A.__private__.setLayoutMode=function(X){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(X)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+X+'" is not recognized.');Ye=X};A.__private__.getLayoutMode=function(){return Ye},A.__private__.setDisplayMode=A.setDisplayMode=function(X,fe,De){return et(X),Fe(fe),Be(De),this};var oe={title:"",subject:"",author:"",keywords:"",creator:""};A.__private__.getDocumentProperty=function(X){if(Object.keys(oe).indexOf(X)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return oe[X]},A.__private__.getDocumentProperties=function(){return oe},A.__private__.setDocumentProperties=A.setProperties=A.setDocumentProperties=function(X){for(var fe in oe)oe.hasOwnProperty(fe)&&X[fe]&&(oe[fe]=X[fe]);return this},A.__private__.setDocumentProperty=function(X,fe){if(Object.keys(oe).indexOf(X)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return oe[X]=fe};var ke,Ue,qe,$e,Ne,Ee={},ze={},rt=[],nt={},mt={},gt={},Nt={},yt=null,Et=0,It=[],ir=new N4(A),Oe=e.hotfixes||[],tt={},At={},wt=[],ht=function X(fe,De,He,Ze,ft,vt){if(!(this instanceof X))return new X(fe,De,He,Ze,ft,vt);isNaN(fe)&&(fe=1),isNaN(De)&&(De=0),isNaN(He)&&(He=0),isNaN(Ze)&&(Ze=1),isNaN(ft)&&(ft=0),isNaN(vt)&&(vt=0),this._matrix=[fe,De,He,Ze,ft,vt]};Object.defineProperty(ht.prototype,"sx",{get:function(){return this._matrix[0]},set:function(X){this._matrix[0]=X}}),Object.defineProperty(ht.prototype,"shy",{get:function(){return this._matrix[1]},set:function(X){this._matrix[1]=X}}),Object.defineProperty(ht.prototype,"shx",{get:function(){return this._matrix[2]},set:function(X){this._matrix[2]=X}}),Object.defineProperty(ht.prototype,"sy",{get:function(){return this._matrix[3]},set:function(X){this._matrix[3]=X}}),Object.defineProperty(ht.prototype,"tx",{get:function(){return this._matrix[4]},set:function(X){this._matrix[4]=X}}),Object.defineProperty(ht.prototype,"ty",{get:function(){return this._matrix[5]},set:function(X){this._matrix[5]=X}}),Object.defineProperty(ht.prototype,"a",{get:function(){return this._matrix[0]},set:function(X){this._matrix[0]=X}}),Object.defineProperty(ht.prototype,"b",{get:function(){return this._matrix[1]},set:function(X){this._matrix[1]=X}}),Object.defineProperty(ht.prototype,"c",{get:function(){return this._matrix[2]},set:function(X){this._matrix[2]=X}}),Object.defineProperty(ht.prototype,"d",{get:function(){return this._matrix[3]},set:function(X){this._matrix[3]=X}}),Object.defineProperty(ht.prototype,"e",{get:function(){return this._matrix[4]},set:function(X){this._matrix[4]=X}}),Object.defineProperty(ht.prototype,"f",{get:function(){return this._matrix[5]},set:function(X){this._matrix[5]=X}}),Object.defineProperty(ht.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(ht.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(ht.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(ht.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),ht.prototype.join=function(X){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(B).join(X)},ht.prototype.multiply=function(X){var fe=X.sx*this.sx+X.shy*this.shx,De=X.sx*this.shy+X.shy*this.sy,He=X.shx*this.sx+X.sy*this.shx,Ze=X.shx*this.shy+X.sy*this.sy,ft=X.tx*this.sx+X.ty*this.shx+this.tx,vt=X.tx*this.shy+X.ty*this.sy+this.ty;return new ht(fe,De,He,Ze,ft,vt)},ht.prototype.decompose=function(){var X=this.sx,fe=this.shy,De=this.shx,He=this.sy,Ze=this.tx,ft=this.ty,vt=Math.sqrt(X*X+fe*fe),qt=(X/=vt)*De+(fe/=vt)*He;De-=X*qt,He-=fe*qt;var zt=Math.sqrt(De*De+He*He);return qt/=zt,X*(He/=zt)<fe*(De/=zt)&&(X=-X,fe=-fe,qt=-qt,vt=-vt),{scale:new ht(vt,0,0,zt,0,0),translate:new ht(1,0,0,1,Ze,ft),rotate:new ht(X,fe,-fe,X,0,0),skew:new ht(1,0,qt,1,0,0)}},ht.prototype.toString=function(X){return this.join(" ")},ht.prototype.inversed=function(){var X=this.sx,fe=this.shy,De=this.shx,He=this.sy,Ze=this.tx,ft=this.ty,vt=1/(X*He-fe*De),qt=He*vt,zt=-fe*vt,cr=-De*vt,hr=X*vt;return new ht(qt,zt,cr,hr,-qt*Ze-cr*ft,-zt*Ze-hr*ft)},ht.prototype.applyToPoint=function(X){var fe=X.x*this.sx+X.y*this.shx+this.tx,De=X.x*this.shy+X.y*this.sy+this.ty;return new ol(fe,De)},ht.prototype.applyToRectangle=function(X){var fe=this.applyToPoint(X),De=this.applyToPoint(new ol(X.x+X.w,X.y+X.h));return new ch(fe.x,fe.y,De.x-fe.x,De.y-fe.y)},ht.prototype.clone=function(){var X=this.sx,fe=this.shy,De=this.shx,He=this.sy,Ze=this.tx,ft=this.ty;return new ht(X,fe,De,He,Ze,ft)},A.Matrix=ht;var Ft=A.matrixMult=function(X,fe){return fe.multiply(X)},Ht=new ht(1,0,0,1,0,0);A.unitMatrix=A.identityMatrix=Ht;var vr=function(X,fe){if(!mt[X]){var De=(fe instanceof kd?"Sh":"P")+(Object.keys(nt).length+1).toString(10);fe.id=De,mt[X]=De,nt[De]=fe,ir.publish("addPattern",fe)}};A.ShadingPattern=kd,A.TilingPattern=dA,A.addShadingPattern=function(X,fe){return E("addShadingPattern()"),vr(X,fe),this},A.beginTilingPattern=function(X){E("beginTilingPattern()"),dh(X.boundingBox[0],X.boundingBox[1],X.boundingBox[2]-X.boundingBox[0],X.boundingBox[3]-X.boundingBox[1],X.matrix)},A.endTilingPattern=function(X,fe){E("endTilingPattern()"),fe.stream=se[D].join(`
`),vr(X,fe),ir.publish("endTilingPattern",fe),wt.pop().restore()};var xr,Jt=A.__private__.newObject=function(){var X=Wt();return ue(X,!0),X},Wt=A.__private__.newObjectDeferred=function(){return I++,H[I]=function(){return W},I},ue=function(X,fe){return fe=typeof fe=="boolean"&&fe,H[X]=W,fe&&te(X+" 0 obj"),X},ie=A.__private__.newAdditionalObject=function(){var X={objId:Wt(),content:""};return M.push(X),X},Ae=Wt(),le=Wt(),ve=A.__private__.decodeColorString=function(X){var fe=X.split(" ");if(fe.length!==2||fe[1]!=="g"&&fe[1]!=="G")fe.length!==5||fe[4]!=="k"&&fe[4]!=="K"||(fe=[(1-fe[0])*(1-fe[3]),(1-fe[1])*(1-fe[3]),(1-fe[2])*(1-fe[3]),"r"]);else{var De=parseFloat(fe[0]);fe=[De,De,De,"r"]}for(var He="#",Ze=0;Ze<3;Ze++)He+=("0"+Math.floor(255*parseFloat(fe[Ze])).toString(16)).slice(-2);return He},me=A.__private__.encodeColorString=function(X){var fe;typeof X=="string"&&(X={ch1:X});var De=X.ch1,He=X.ch2,Ze=X.ch3,ft=X.ch4,vt=X.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof De=="string"&&De.charAt(0)!=="#"){var qt=new f6(De);if(qt.ok)De=qt.toHex();else if(!/^\d*\.?\d*$/.test(De))throw new Error('Invalid color "'+De+'" passed to jsPDF.encodeColorString.')}if(typeof De=="string"&&/^#[0-9A-Fa-f]{3}$/.test(De)&&(De="#"+De[1]+De[1]+De[2]+De[2]+De[3]+De[3]),typeof De=="string"&&/^#[0-9A-Fa-f]{6}$/.test(De)){var zt=parseInt(De.substr(1),16);De=zt>>16&255,He=zt>>8&255,Ze=255&zt}if(He===void 0||ft===void 0&&De===He&&He===Ze)fe=typeof De=="string"?De+" "+vt[0]:X.precision===2?k(De/255)+" "+vt[0]:w(De/255)+" "+vt[0];else if(ft===void 0||zr(ft)==="object"){if(ft&&!isNaN(ft.a)&&ft.a===0)return["1.","1.","1.",vt[1]].join(" ");fe=typeof De=="string"?[De,He,Ze,vt[1]].join(" "):X.precision===2?[k(De/255),k(He/255),k(Ze/255),vt[1]].join(" "):[w(De/255),w(He/255),w(Ze/255),vt[1]].join(" ")}else fe=typeof De=="string"?[De,He,Ze,ft,vt[2]].join(" "):X.precision===2?[k(De),k(He),k(Ze),k(ft),vt[2]].join(" "):[w(De),w(He),w(Ze),w(ft),vt[2]].join(" ");return fe},Pe=A.__private__.getFilters=function(){return o},Qe=A.__private__.putStream=function(X){var fe=(X=X||{}).data||"",De=X.filters||Pe(),He=X.alreadyAppliedFilters||[],Ze=X.addLength1||!1,ft=fe.length,vt=X.objectId,qt=function(fa){return fa};if(u!==null&&vt===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");u!==null&&(qt=ha.encryptor(vt,0));var zt={};De===!0&&(De=["FlateEncode"]);var cr=X.additionalKeyValues||[],hr=(zt=Ut.API.processDataByFilters!==void 0?Ut.API.processDataByFilters(fe,De):{data:fe,reverseChain:[]}).reverseChain+(Array.isArray(He)?He.join(" "):He.toString());if(zt.data.length!==0&&(cr.push({key:"Length",value:zt.data.length}),Ze===!0&&cr.push({key:"Length1",value:ft})),hr.length!=0)if(hr.split("/").length-1==1)cr.push({key:"Filter",value:hr});else{cr.push({key:"Filter",value:"["+hr+"]"});for(var Fr=0;Fr<cr.length;Fr+=1)if(cr[Fr].key==="DecodeParms"){for(var Nn=[],ra=0;ra<zt.reverseChain.split("/").length-1;ra+=1)Nn.push("null");Nn.push(cr[Fr].value),cr[Fr].value="["+Nn.join(" ")+"]"}}te("<<");for(var nn=0;nn<cr.length;nn++)te("/"+cr[nn].key+" "+cr[nn].value);te(">>"),zt.data.length!==0&&(te("stream"),te(qt(zt.data)),te("endstream"))},Ke=A.__private__.putPage=function(X){var fe=X.number,De=X.data,He=X.objId,Ze=X.contentsObjId;ue(He,!0),te("<</Type /Page"),te("/Parent "+X.rootDictionaryObjId+" 0 R"),te("/Resources "+X.resourceDictionaryObjId+" 0 R"),te("/MediaBox ["+parseFloat(B(X.mediaBox.bottomLeftX))+" "+parseFloat(B(X.mediaBox.bottomLeftY))+" "+B(X.mediaBox.topRightX)+" "+B(X.mediaBox.topRightY)+"]"),X.cropBox!==null&&te("/CropBox ["+B(X.cropBox.bottomLeftX)+" "+B(X.cropBox.bottomLeftY)+" "+B(X.cropBox.topRightX)+" "+B(X.cropBox.topRightY)+"]"),X.bleedBox!==null&&te("/BleedBox ["+B(X.bleedBox.bottomLeftX)+" "+B(X.bleedBox.bottomLeftY)+" "+B(X.bleedBox.topRightX)+" "+B(X.bleedBox.topRightY)+"]"),X.trimBox!==null&&te("/TrimBox ["+B(X.trimBox.bottomLeftX)+" "+B(X.trimBox.bottomLeftY)+" "+B(X.trimBox.topRightX)+" "+B(X.trimBox.topRightY)+"]"),X.artBox!==null&&te("/ArtBox ["+B(X.artBox.bottomLeftX)+" "+B(X.artBox.bottomLeftY)+" "+B(X.artBox.topRightX)+" "+B(X.artBox.topRightY)+"]"),typeof X.userUnit=="number"&&X.userUnit!==1&&te("/UserUnit "+X.userUnit),ir.publish("putPage",{objId:He,pageContext:It[fe],pageNumber:fe,page:De}),te("/Contents "+Ze+" 0 R"),te(">>"),te("endobj");var ft=De.join(`
`);return v===y&&(ft+=`
Q`),ue(Ze,!0),Qe({data:ft,filters:Pe(),objectId:Ze}),te("endobj"),He},Xe=A.__private__.putPages=function(){var X,fe,De=[];for(X=1;X<=Et;X++)It[X].objId=Wt(),It[X].contentsObjId=Wt();for(X=1;X<=Et;X++)De.push(Ke({number:X,data:se[X],objId:It[X].objId,contentsObjId:It[X].contentsObjId,mediaBox:It[X].mediaBox,cropBox:It[X].cropBox,bleedBox:It[X].bleedBox,trimBox:It[X].trimBox,artBox:It[X].artBox,userUnit:It[X].userUnit,rootDictionaryObjId:Ae,resourceDictionaryObjId:le}));ue(Ae,!0),te("<</Type /Pages");var He="/Kids [";for(fe=0;fe<Et;fe++)He+=De[fe]+" 0 R ";te(He+"]"),te("/Count "+Et),te(">>"),te("endobj"),ir.publish("postPutPages")},Me=function(X){ir.publish("putFont",{font:X,out:te,newObject:Jt,putStream:Qe}),X.isAlreadyPutted!==!0&&(X.objectNumber=Jt(),te("<<"),te("/Type /Font"),te("/BaseFont /"+Wu(X.postScriptName)),te("/Subtype /Type1"),typeof X.encoding=="string"&&te("/Encoding /"+X.encoding),te("/FirstChar 32"),te("/LastChar 255"),te(">>"),te("endobj"))},Ce=function(X){X.objectNumber=Jt();var fe=[];fe.push({key:"Type",value:"/XObject"}),fe.push({key:"Subtype",value:"/Form"}),fe.push({key:"BBox",value:"["+[B(X.x),B(X.y),B(X.x+X.width),B(X.y+X.height)].join(" ")+"]"}),fe.push({key:"Matrix",value:"["+X.matrix.toString()+"]"});var De=X.pages[1].join(`
`);Qe({data:De,additionalKeyValues:fe,objectId:X.objectNumber}),te("endobj")},We=function(X,fe){fe||(fe=21);var De=Jt(),He=function(vt,qt){var zt,cr=[],hr=1/(qt-1);for(zt=0;zt<1;zt+=hr)cr.push(zt);if(cr.push(1),vt[0].offset!=0){var Fr={offset:0,color:vt[0].color};vt.unshift(Fr)}if(vt[vt.length-1].offset!=1){var Nn={offset:1,color:vt[vt.length-1].color};vt.push(Nn)}for(var ra="",nn=0,fa=0;fa<cr.length;fa++){for(zt=cr[fa];zt>vt[nn+1].offset;)nn++;var na=vt[nn].offset,La=(zt-na)/(vt[nn+1].offset-na),dl=vt[nn].color,Xi=vt[nn+1].color;ra+=P(Math.round((1-La)*dl[0]+La*Xi[0]).toString(16))+P(Math.round((1-La)*dl[1]+La*Xi[1]).toString(16))+P(Math.round((1-La)*dl[2]+La*Xi[2]).toString(16))}return ra.trim()}(X.colors,fe),Ze=[];Ze.push({key:"FunctionType",value:"0"}),Ze.push({key:"Domain",value:"[0.0 1.0]"}),Ze.push({key:"Size",value:"["+fe+"]"}),Ze.push({key:"BitsPerSample",value:"8"}),Ze.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ze.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Qe({data:He,additionalKeyValues:Ze,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:De}),te("endobj"),X.objectNumber=Jt(),te("<< /ShadingType "+X.type),te("/ColorSpace /DeviceRGB");var ft="/Coords ["+B(parseFloat(X.coords[0]))+" "+B(parseFloat(X.coords[1]))+" ";X.type===2?ft+=B(parseFloat(X.coords[2]))+" "+B(parseFloat(X.coords[3])):ft+=B(parseFloat(X.coords[2]))+" "+B(parseFloat(X.coords[3]))+" "+B(parseFloat(X.coords[4]))+" "+B(parseFloat(X.coords[5])),te(ft+="]"),X.matrix&&te("/Matrix ["+X.matrix.toString()+"]"),te("/Function "+De+" 0 R"),te("/Extend [true true]"),te(">>"),te("endobj")},Je=function(X,fe){var De=Wt(),He=Jt();fe.push({resourcesOid:De,objectOid:He}),X.objectNumber=He;var Ze=[];Ze.push({key:"Type",value:"/Pattern"}),Ze.push({key:"PatternType",value:"1"}),Ze.push({key:"PaintType",value:"1"}),Ze.push({key:"TilingType",value:"1"}),Ze.push({key:"BBox",value:"["+X.boundingBox.map(B).join(" ")+"]"}),Ze.push({key:"XStep",value:B(X.xStep)}),Ze.push({key:"YStep",value:B(X.yStep)}),Ze.push({key:"Resources",value:De+" 0 R"}),X.matrix&&Ze.push({key:"Matrix",value:"["+X.matrix.toString()+"]"}),Qe({data:X.stream,additionalKeyValues:Ze,objectId:X.objectNumber}),te("endobj")},ot=function(X){for(var fe in X.objectNumber=Jt(),te("<<"),X)switch(fe){case"opacity":te("/ca "+k(X[fe]));break;case"stroke-opacity":te("/CA "+k(X[fe]))}te(">>"),te("endobj")},lt=function(X){ue(X.resourcesOid,!0),te("<<"),te("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var fe in te("/Font <<"),Ee)Ee.hasOwnProperty(fe)&&(f===!1||f===!0&&h.hasOwnProperty(fe))&&te("/"+fe+" "+Ee[fe].objectNumber+" 0 R");te(">>")}(),function(){if(Object.keys(nt).length>0){for(var fe in te("/Shading <<"),nt)nt.hasOwnProperty(fe)&&nt[fe]instanceof kd&&nt[fe].objectNumber>=0&&te("/"+fe+" "+nt[fe].objectNumber+" 0 R");ir.publish("putShadingPatternDict"),te(">>")}}(),function(fe){if(Object.keys(nt).length>0){for(var De in te("/Pattern <<"),nt)nt.hasOwnProperty(De)&&nt[De]instanceof A.TilingPattern&&nt[De].objectNumber>=0&&nt[De].objectNumber<fe&&te("/"+De+" "+nt[De].objectNumber+" 0 R");ir.publish("putTilingPatternDict"),te(">>")}}(X.objectOid),function(){if(Object.keys(gt).length>0){var fe;for(fe in te("/ExtGState <<"),gt)gt.hasOwnProperty(fe)&&gt[fe].objectNumber>=0&&te("/"+fe+" "+gt[fe].objectNumber+" 0 R");ir.publish("putGStateDict"),te(">>")}}(),function(){for(var fe in te("/XObject <<"),tt)tt.hasOwnProperty(fe)&&tt[fe].objectNumber>=0&&te("/"+fe+" "+tt[fe].objectNumber+" 0 R");ir.publish("putXobjectDict"),te(">>")}(),te(">>"),te("endobj")},kt=function(X){ze[X.fontName]=ze[X.fontName]||{},ze[X.fontName][X.fontStyle]=X.id},Xt=function(X,fe,De,He,Ze){var ft={id:"F"+(Object.keys(Ee).length+1).toString(10),postScriptName:X,fontName:fe,fontStyle:De,encoding:He,isStandardFont:Ze||!1,metadata:{}};return ir.publish("addFont",{font:ft,instance:this}),Ee[ft.id]=ft,kt(ft),ft.id},$t=A.__private__.pdfEscape=A.pdfEscape=function(X,fe){return function(De,He){var Ze,ft,vt,qt,zt,cr,hr,Fr,Nn;if(vt=(He=He||{}).sourceEncoding||"Unicode",zt=He.outputEncoding,(He.autoencode||zt)&&Ee[ke].metadata&&Ee[ke].metadata[vt]&&Ee[ke].metadata[vt].encoding&&(qt=Ee[ke].metadata[vt].encoding,!zt&&Ee[ke].encoding&&(zt=Ee[ke].encoding),!zt&&qt.codePages&&(zt=qt.codePages[0]),typeof zt=="string"&&(zt=qt[zt]),zt)){for(hr=!1,cr=[],Ze=0,ft=De.length;Ze<ft;Ze++)(Fr=zt[De.charCodeAt(Ze)])?cr.push(String.fromCharCode(Fr)):cr.push(De[Ze]),cr[Ze].charCodeAt(0)>>8&&(hr=!0);De=cr.join("")}for(Ze=De.length;hr===void 0&&Ze!==0;)De.charCodeAt(Ze-1)>>8&&(hr=!0),Ze--;if(!hr)return De;for(cr=He.noBOM?[]:[254,255],Ze=0,ft=De.length;Ze<ft;Ze++){if((Nn=(Fr=De.charCodeAt(Ze))>>8)>>8)throw new Error("Character at position "+Ze+" of string '"+De+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");cr.push(Nn),cr.push(Fr-(Nn<<8))}return String.fromCharCode.apply(void 0,cr)}(X,fe).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Pt=A.__private__.beginPage=function(X){se[++Et]=[],It[Et]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(X[0]),topRightY:Number(X[1])}},Er(Et),ne(se[D])},jr=function(X,fe){var De,He,Ze;switch(r=fe||r,typeof X=="string"&&(De=m(X.toLowerCase()),Array.isArray(De)&&(He=De[0],Ze=De[1])),Array.isArray(X)&&(He=X[0]*Ue,Ze=X[1]*Ue),isNaN(He)&&(He=s[0],Ze=s[1]),(He>14400||Ze>14400)&&(rn.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),He=Math.min(14400,He),Ze=Math.min(14400,Ze)),s=[He,Ze],r.substr(0,1)){case"l":Ze>He&&(s=[Ze,He]);break;case"p":He>Ze&&(s=[Ze,He])}Pt(s),dr(sh),te(gu),oh!==0&&te(oh+" J"),lh!==0&&te(lh+" j"),ir.publish("addPage",{pageNumber:Et})},tr=function(X){X>0&&X<=Et&&(se.splice(X,1),It.splice(X,1),Et--,D>Et&&(D=Et),this.setPage(D))},Er=function(X){X>0&&X<=Et&&(D=X)},Hr=A.__private__.getNumberOfPages=A.getNumberOfPages=function(){return se.length-1},Gs=function(X,fe,De){var He,Ze=void 0;return De=De||{},X=X!==void 0?X:Ee[ke].fontName,fe=fe!==void 0?fe:Ee[ke].fontStyle,He=X.toLowerCase(),ze[He]!==void 0&&ze[He][fe]!==void 0?Ze=ze[He][fe]:ze[X]!==void 0&&ze[X][fe]!==void 0?Ze=ze[X][fe]:De.disableWarning===!1&&rn.warn("Unable to look up font label for font '"+X+"', '"+fe+"'. Refer to getFontList() for available fonts."),Ze||De.noFallback||(Ze=ze.times[fe])==null&&(Ze=ze.times.normal),Ze},Fn=A.__private__.putInfo=function(){var X=Jt(),fe=function(He){return He};for(var De in u!==null&&(fe=ha.encryptor(X,0)),te("<<"),te("/Producer ("+$t(fe("jsPDF "+Ut.version))+")"),oe)oe.hasOwnProperty(De)&&oe[De]&&te("/"+De.substr(0,1).toUpperCase()+De.substr(1)+" ("+$t(fe(oe[De]))+")");te("/CreationDate ("+$t(fe(q))+")"),te(">>"),te("endobj")},fu=A.__private__.putCatalog=function(X){var fe=(X=X||{}).rootDictionaryObjId||Ae;switch(Jt(),te("<<"),te("/Type /Catalog"),te("/Pages "+fe+" 0 R"),Le||(Le="fullwidth"),Le){case"fullwidth":te("/OpenAction [3 0 R /FitH null]");break;case"fullheight":te("/OpenAction [3 0 R /FitV null]");break;case"fullpage":te("/OpenAction [3 0 R /Fit]");break;case"original":te("/OpenAction [3 0 R /XYZ null null 1]");break;default:var De=""+Le;De.substr(De.length-1)==="%"&&(Le=parseInt(Le)/100),typeof Le=="number"&&te("/OpenAction [3 0 R /XYZ null null "+k(Le)+"]")}switch(Ye||(Ye="continuous"),Ye){case"continuous":te("/PageLayout /OneColumn");break;case"single":te("/PageLayout /SinglePage");break;case"two":case"twoleft":te("/PageLayout /TwoColumnLeft");break;case"tworight":te("/PageLayout /TwoColumnRight")}Re&&te("/PageMode /"+Re),ir.publish("putCatalog"),te(">>"),te("endobj")},py=A.__private__.putTrailer=function(){te("trailer"),te("<<"),te("/Size "+(I+1)),te("/Root "+I+" 0 R"),te("/Info "+(I-1)+" 0 R"),u!==null&&te("/Encrypt "+ha.oid+" 0 R"),te("/ID [ <"+z+"> <"+z+"> ]"),te(">>")},ta=A.__private__.putHeader=function(){te("%PDF-"+x),te("%")},X0=A.__private__.putXRef=function(){var X="0000000000";te("xref"),te("0 "+(I+1)),te("0000000000 65535 f ");for(var fe=1;fe<=I;fe++)typeof H[fe]=="function"?te((X+H[fe]()).slice(-10)+" 00000 n "):H[fe]!==void 0?te((X+H[fe]).slice(-10)+" 00000 n "):te("0000000000 00000 n ")},jo=A.__private__.buildDocument=function(){var X;I=0,W=0,V=[],H=[],M=[],Ae=Wt(),le=Wt(),ne(V),ir.publish("buildDocument"),ta(),Xe(),function(){ir.publish("putAdditionalObjects");for(var De=0;De<M.length;De++){var He=M[De];ue(He.objId,!0),te(He.content),te("endobj")}ir.publish("postPutAdditionalObjects")}(),X=[],function(){for(var De in Ee)Ee.hasOwnProperty(De)&&(f===!1||f===!0&&h.hasOwnProperty(De))&&Me(Ee[De])}(),function(){var De;for(De in gt)gt.hasOwnProperty(De)&&ot(gt[De])}(),function(){for(var De in tt)tt.hasOwnProperty(De)&&Ce(tt[De])}(),function(De){var He;for(He in nt)nt.hasOwnProperty(He)&&(nt[He]instanceof kd?We(nt[He]):nt[He]instanceof dA&&Je(nt[He],De))}(X),ir.publish("putResources"),X.forEach(lt),lt({resourcesOid:le,objectOid:Number.MAX_SAFE_INTEGER}),ir.publish("postPutResources"),u!==null&&(ha.oid=Jt(),te("<<"),te("/Filter /Standard"),te("/V "+ha.v),te("/R "+ha.r),te("/U <"+ha.toHexString(ha.U)+">"),te("/O <"+ha.toHexString(ha.O)+">"),te("/P "+ha.P),te(">>"),te("endobj")),Fn(),fu();var fe=W;return X0(),py(),te("startxref"),te(""+fe),te("%%EOF"),ne(se[D]),V.join(`
`)},pu=A.__private__.getBlob=function(X){return new Blob([_e(X)],{type:"application/pdf"})},Y0=A.output=A.__private__.output=(xr=function(X,fe){switch(typeof(fe=fe||{})=="string"?fe={filename:fe}:fe.filename=fe.filename||"generated.pdf",X){case void 0:return jo();case"save":A.save(fe.filename);break;case"arraybuffer":return _e(jo());case"blob":return pu(jo());case"bloburi":case"bloburl":if(lr.URL!==void 0&&typeof lr.URL.createObjectURL=="function")return lr.URL&&lr.URL.createObjectURL(pu(jo()))||void 0;rn.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var De="",He=jo();try{De=b4(He)}catch{De=b4(unescape(encodeURIComponent(He)))}return"data:application/pdf;filename="+fe.filename+";base64,"+De;case"pdfobjectnewwindow":if(Object.prototype.toString.call(lr)==="[object Window]"){var Ze="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",ft=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';fe.pdfObjectUrl&&(Ze=fe.pdfObjectUrl,ft="");var vt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Ze+'"'+ft+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(fe)+");<\/script></body></html>",qt=lr.open();return qt!==null&&qt.document.write(vt),qt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(lr)==="[object Window]"){var zt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(fe.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+fe.filename+'" width="500px" height="400px" /></body></html>',cr=lr.open();if(cr!==null){cr.document.write(zt);var hr=this;cr.document.documentElement.querySelector("#pdfViewer").onload=function(){cr.document.title=fe.filename,cr.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(hr.output("bloburl"))}}return cr}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(lr)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Fr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",fe)+'"></iframe></body></html>',Nn=lr.open();if(Nn!==null&&(Nn.document.write(Fr),Nn.document.title=fe.filename),Nn||typeof safari>"u")return Nn;break;case"datauri":case"dataurl":return lr.document.location.href=this.output("datauristring",fe);default:return null}},xr.foo=function(){try{return xr.apply(this,arguments)}catch(De){var X=De.stack||"";~X.indexOf(" at ")&&(X=X.split(" at ")[1]);var fe="Error in function "+X.split(`
`)[0].split("<")[0]+": "+De.message;if(!lr.console)throw new Error(fe);lr.console.error(fe,De),lr.alert&&alert(fe)}},xr.foo.bar=xr,xr.foo),_i=function(X){return Array.isArray(Oe)===!0&&Oe.indexOf(X)>-1};switch(a){case"pt":Ue=1;break;case"mm":Ue=72/25.4;break;case"cm":Ue=72/2.54;break;case"in":Ue=72;break;case"px":Ue=_i("px_scaling")==1?.75:96/72;break;case"pc":case"em":Ue=12;break;case"ex":Ue=6;break;default:if(typeof a!="number")throw new Error("Invalid unit: "+a);Ue=a}var ha=null;U(),Y();var nl=A.__private__.getPageInfo=A.getPageInfo=function(X){if(isNaN(X)||X%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:It[X].objId,pageNumber:X,pageContext:It[X]}},J0=A.__private__.getPageInfoByObjId=function(X){if(isNaN(X)||X%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var fe in It)if(It[fe].objId===X)break;return nl(fe)},my=A.__private__.getCurrentPageInfo=A.getCurrentPageInfo=function(){return{objId:It[D].objId,pageNumber:D,pageContext:It[D]}};A.addPage=function(){return jr.apply(this,arguments),this},A.setPage=function(){return Er.apply(this,arguments),ne.call(this,se[D]),this},A.insertPage=function(X){return this.addPage(),this.movePage(D,X),this},A.movePage=function(X,fe){var De,He;if(X>fe){De=se[X],He=It[X];for(var Ze=X;Ze>fe;Ze--)se[Ze]=se[Ze-1],It[Ze]=It[Ze-1];se[fe]=De,It[fe]=He,this.setPage(fe)}else if(X<fe){De=se[X],He=It[X];for(var ft=X;ft<fe;ft++)se[ft]=se[ft+1],It[ft]=It[ft+1];se[fe]=De,It[fe]=He,this.setPage(fe)}return this},A.deletePage=function(){return tr.apply(this,arguments),this},A.__private__.text=A.text=function(X,fe,De,He,Ze){var ft,vt,qt,zt,cr,hr,Fr,Nn,ra,nn=(He=He||{}).scope||this;if(typeof X=="number"&&typeof fe=="number"&&(typeof De=="string"||Array.isArray(De))){var fa=De;De=fe,fe=X,X=fa}if(arguments[3]instanceof ht==0?(qt=arguments[4],zt=arguments[5],zr(Fr=arguments[3])==="object"&&Fr!==null||(typeof qt=="string"&&(zt=qt,qt=null),typeof Fr=="string"&&(zt=Fr,Fr=null),typeof Fr=="number"&&(qt=Fr,Fr=null),He={flags:Fr,angle:qt,align:zt})):(E("The transform parameter of text() with a Matrix value"),ra=Ze),isNaN(fe)||isNaN(De)||X==null)throw new Error("Invalid arguments passed to jsPDF.text");if(X.length===0)return nn;var na,La="",dl=typeof He.lineHeightFactor=="number"?He.lineHeightFactor:nd,Xi=nn.internal.scaleFactor;function ul(Mr){return Mr=Mr.split("	").join(Array(He.TabLen||9).join(" ")),$t(Mr,Fr)}function Ah(Mr){for(var en,Hn=Mr.concat(),pa=[],fl=Hn.length;fl--;)typeof(en=Hn.shift())=="string"?pa.push(en):Array.isArray(Mr)&&(en.length===1||en[1]===void 0&&en[2]===void 0)?pa.push(en[0]):pa.push([en[0],en[1],en[2]]);return pa}function yu(Mr,en){var Hn;if(typeof Mr=="string")Hn=en(Mr)[0];else if(Array.isArray(Mr)){for(var pa,fl,_h=Mr.concat(),_u=[],cp=_h.length;cp--;)typeof(pa=_h.shift())=="string"?_u.push(en(pa)[0]):Array.isArray(pa)&&typeof pa[0]=="string"&&(fl=en(pa[0],pa[1],pa[2]),_u.push([fl[0],fl[1],fl[2]]));Hn=_u}return Hn}var Gl=!1,od=!0;if(typeof X=="string")Gl=!0;else if(Array.isArray(X)){var ld=X.concat();vt=[];for(var Xl,Pa=ld.length;Pa--;)(typeof(Xl=ld.shift())!="string"||Array.isArray(Xl)&&typeof Xl[0]!="string")&&(od=!1);Gl=od}if(Gl===!1)throw new Error('Type of text must be string or Array. "'+X+'" is not recognized.');typeof X=="string"&&(X=X.match(/[\r?\n]/)?X.split(/\r\n|\r|\n/g):[X]);var cd=ye/nn.internal.scaleFactor,dd=cd*(dl-1);switch(He.baseline){case"bottom":De-=dd;break;case"top":De+=cd-dd;break;case"hanging":De+=cd-2*dd;break;case"middle":De+=cd/2-dd}if((hr=He.maxWidth||0)>0&&(typeof X=="string"?X=nn.splitTextToSize(X,hr):Object.prototype.toString.call(X)==="[object Array]"&&(X=X.reduce(function(Mr,en){return Mr.concat(nn.splitTextToSize(en,hr))},[]))),ft={text:X,x:fe,y:De,options:He,mutex:{pdfEscape:$t,activeFontKey:ke,fonts:Ee,activeFontSize:ye}},ir.publish("preProcessText",ft),X=ft.text,qt=(He=ft.options).angle,ra instanceof ht==0&&qt&&typeof qt=="number"){qt*=Math.PI/180,He.rotationDirection===0&&(qt=-qt),v===y&&(qt=-qt);var hh=Math.cos(qt),fh=Math.sin(qt);ra=new ht(hh,fh,-fh,hh,0,0)}else qt&&qt instanceof ht&&(ra=qt);v!==y||ra||(ra=Ht),(cr=He.charSpace||il)!==void 0&&(La+=B(T(cr))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Nn=He.horizontalScale)!==void 0&&(La+=B(100*Nn)+` Tz
`),He.lang;var gs=-1,Al=He.renderingMode!==void 0?He.renderingMode:He.stroke,vu=nn.internal.getCurrentPageInfo().pageContext;switch(Al){case 0:case!1:case"fill":gs=0;break;case 1:case!0:case"stroke":gs=1;break;case 2:case"fillThenStroke":gs=2;break;case 3:case"invisible":gs=3;break;case 4:case"fillAndAddForClipping":gs=4;break;case 5:case"strokeAndAddPathForClipping":gs=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":gs=6;break;case 7:case"addToPathForClipping":gs=7}var op=vu.usedRenderingMode!==void 0?vu.usedRenderingMode:-1;gs!==-1?La+=gs+` Tr
`:op!==-1&&(La+=`0 Tr
`),gs!==-1&&(vu.usedRenderingMode=gs),zt=He.align||"left";var wi,ud=ye*dl,ph=nn.internal.pageSize.getWidth(),mh=Ee[ke];cr=He.charSpace||il,hr=He.maxWidth||0,Fr=Object.assign({autoencode:!0,noBOM:!0},He.flags);var Yl=[],Ad=function(Mr){return nn.getStringUnitWidth(Mr,{font:mh,charSpace:cr,fontSize:ye,doKerning:!1})*ye/Xi};if(Object.prototype.toString.call(X)==="[object Array]"){var Xs;vt=Ah(X),zt!=="left"&&(wi=vt.map(Ad));var Ys,Jl=0;if(zt==="right"){fe-=wi[0],X=[],Pa=vt.length;for(var hl=0;hl<Pa;hl++)hl===0?(Ys=al(fe),Xs=sl(De)):(Ys=T(Jl-wi[hl]),Xs=-ud),X.push([vt[hl],Ys,Xs]),Jl=wi[hl]}else if(zt==="center"){fe-=wi[0]/2,X=[],Pa=vt.length;for(var Zl=0;Zl<Pa;Zl++)Zl===0?(Ys=al(fe),Xs=sl(De)):(Ys=T((Jl-wi[Zl])/2),Xs=-ud),X.push([vt[Zl],Ys,Xs]),Jl=wi[Zl]}else if(zt==="left"){X=[],Pa=vt.length;for(var gh=0;gh<Pa;gh++)X.push(vt[gh])}else if(zt==="justify"&&mh.encoding==="Identity-H"){X=[],Pa=vt.length,hr=hr!==0?hr:ph;for(var bu=0,Qn=0;Qn<Pa;Qn++)if(Xs=Qn===0?sl(De):-ud,Ys=Qn===0?al(fe):bu,Qn<Pa-1){var lp=T((hr-wi[Qn])/(vt[Qn].split(" ").length-1)),Co=vt[Qn].split(" ");X.push([Co[0]+" ",Ys,Xs]),bu=0;for(var So=1;So<Co.length;So++){var xh=(Ad(Co[So-1]+" "+Co[So])-Ad(Co[So]))*Xi+lp;So==Co.length-1?X.push([Co[So],xh,0]):X.push([Co[So]+" ",xh,0]),bu-=xh}}else X.push([vt[Qn],Ys,Xs]);X.push(["",bu,0])}else{if(zt!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(X=[],Pa=vt.length,hr=hr!==0?hr:ph,Qn=0;Qn<Pa;Qn++){Xs=Qn===0?sl(De):-ud,Ys=Qn===0?al(fe):0;var yh=vt[Qn].split(" ").length-1,vh=yh>0?(hr-wi[Qn])/yh:0;Qn<Pa-1?Yl.push(B(T(vh))):Yl.push(0),X.push([vt[Qn],Ys,Xs])}}}(typeof He.R2L=="boolean"?He.R2L:ge)===!0&&(X=yu(X,function(Mr,en,Hn){return[Mr.split("").reverse().join(""),en,Hn]})),ft={text:X,x:fe,y:De,options:He,mutex:{pdfEscape:$t,activeFontKey:ke,fonts:Ee,activeFontSize:ye}},ir.publish("postProcessText",ft),X=ft.text,na=ft.mutex.isHex||!1;var bh=Ee[ke].encoding;bh!=="WinAnsiEncoding"&&bh!=="StandardEncoding"||(X=yu(X,function(Mr,en,Hn){return[ul(Mr),en,Hn]})),vt=Ah(X),X=[];for(var ec,tc,rc,hd=Array.isArray(vt[0])?1:0,nc="",fd=function(Mr,en,Hn){var pa="";return Hn instanceof ht?(Hn=typeof He.angle=="number"?Ft(Hn,new ht(1,0,0,1,Mr,en)):Ft(new ht(1,0,0,1,Mr,en),Hn),v===y&&(Hn=Ft(new ht(1,0,0,-1,0,0),Hn)),pa=Hn.join(" ")+` Tm
`):pa=B(Mr)+" "+B(en)+` Td
`,pa},Ni=0;Ni<vt.length;Ni++){switch(nc="",hd){case 1:rc=(na?"<":"(")+vt[Ni][0]+(na?">":")"),ec=parseFloat(vt[Ni][1]),tc=parseFloat(vt[Ni][2]);break;case 0:rc=(na?"<":"(")+vt[Ni]+(na?">":")"),ec=al(fe),tc=sl(De)}Yl!==void 0&&Yl[Ni]!==void 0&&(nc=Yl[Ni]+` Tw
`),Ni===0?X.push(nc+fd(ec,tc,ra)+rc):hd===0?X.push(nc+rc):hd===1&&X.push(nc+fd(ec,tc,ra)+rc)}X=hd===0?X.join(` Tj
T* `):X.join(` Tj
`),X+=` Tj
`;var Bo=`BT
/`;return Bo+=ke+" "+ye+` Tf
`,Bo+=B(ye*dl)+` TL
`,Bo+=ad+`
`,Bo+=La,Bo+=X,te(Bo+="ET"),h[ke]=!0,nn};var gy=A.__private__.clip=A.clip=function(X){return te(X==="evenodd"?"W*":"W"),this};A.clipEvenOdd=function(){return gy("evenodd")},A.__private__.discardPath=A.discardPath=function(){return te("n"),this};var ko=A.__private__.isValidStyle=function(X){var fe=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(X)!==-1&&(fe=!0),fe};A.__private__.setDefaultPathOperation=A.setDefaultPathOperation=function(X){return ko(X)&&(d=X),this};var Z0=A.__private__.getStyle=A.getStyle=function(X){var fe=d;switch(X){case"D":case"S":fe="S";break;case"F":fe="f";break;case"FD":case"DF":fe="B";break;case"f":case"f*":case"B":case"B*":fe=X}return fe},ep=A.close=function(){return te("h"),this};A.stroke=function(){return te("S"),this},A.fill=function(X){return mu("f",X),this},A.fillEvenOdd=function(X){return mu("f*",X),this},A.fillStroke=function(X){return mu("B",X),this},A.fillStrokeEvenOdd=function(X){return mu("B*",X),this};var mu=function(X,fe){zr(fe)==="object"?yy(fe,X):te(X)},rd=function(X){X===null||v===y&&X===void 0||(X=Z0(X),te(X))};function xy(X,fe,De,He,Ze){var ft=new dA(fe||this.boundingBox,De||this.xStep,He||this.yStep,this.gState,Ze||this.matrix);ft.stream=this.stream;var vt=X+"$$"+this.cloneIndex+++"$$";return vr(vt,ft),ft}var yy=function(X,fe){var De=mt[X.key],He=nt[De];if(He instanceof kd)te("q"),te(vy(fe)),He.gState&&A.setGState(He.gState),te(X.matrix.toString()+" cm"),te("/"+De+" sh"),te("Q");else if(He instanceof dA){var Ze=new ht(1,0,0,-1,0,id());X.matrix&&(Ze=Ze.multiply(X.matrix||Ht),De=xy.call(He,X.key,X.boundingBox,X.xStep,X.yStep,Ze).id),te("q"),te("/Pattern cs"),te("/"+De+" scn"),He.gState&&A.setGState(He.gState),te(fe),te("Q")}},vy=function(X){switch(X){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},ah=A.moveTo=function(X,fe){return te(B(T(X))+" "+B(R(fe))+" m"),this},tp=A.lineTo=function(X,fe){return te(B(T(X))+" "+B(R(fe))+" l"),this},Gi=A.curveTo=function(X,fe,De,He,Ze,ft){return te([B(T(X)),B(R(fe)),B(T(De)),B(R(He)),B(T(Ze)),B(R(ft)),"c"].join(" ")),this};A.__private__.line=A.line=function(X,fe,De,He,Ze){if(isNaN(X)||isNaN(fe)||isNaN(De)||isNaN(He)||!ko(Ze))throw new Error("Invalid arguments passed to jsPDF.line");return v===g?this.lines([[De-X,He-fe]],X,fe,[1,1],Ze||"S"):this.lines([[De-X,He-fe]],X,fe,[1,1]).stroke()},A.__private__.lines=A.lines=function(X,fe,De,He,Ze,ft){var vt,qt,zt,cr,hr,Fr,Nn,ra,nn,fa,na,La;if(typeof X=="number"&&(La=De,De=fe,fe=X,X=La),He=He||[1,1],ft=ft||!1,isNaN(fe)||isNaN(De)||!Array.isArray(X)||!Array.isArray(He)||!ko(Ze)||typeof ft!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(ah(fe,De),vt=He[0],qt=He[1],cr=X.length,fa=fe,na=De,zt=0;zt<cr;zt++)(hr=X[zt]).length===2?(fa=hr[0]*vt+fa,na=hr[1]*qt+na,tp(fa,na)):(Fr=hr[0]*vt+fa,Nn=hr[1]*qt+na,ra=hr[2]*vt+fa,nn=hr[3]*qt+na,fa=hr[4]*vt+fa,na=hr[5]*qt+na,Gi(Fr,Nn,ra,nn,fa,na));return ft&&ep(),rd(Ze),this},A.path=function(X){for(var fe=0;fe<X.length;fe++){var De=X[fe],He=De.c;switch(De.op){case"m":ah(He[0],He[1]);break;case"l":tp(He[0],He[1]);break;case"c":Gi.apply(this,He);break;case"h":ep()}}return this},A.__private__.rect=A.rect=function(X,fe,De,He,Ze){if(isNaN(X)||isNaN(fe)||isNaN(De)||isNaN(He)||!ko(Ze))throw new Error("Invalid arguments passed to jsPDF.rect");return v===g&&(He=-He),te([B(T(X)),B(R(fe)),B(T(De)),B(T(He)),"re"].join(" ")),rd(Ze),this},A.__private__.triangle=A.triangle=function(X,fe,De,He,Ze,ft,vt){if(isNaN(X)||isNaN(fe)||isNaN(De)||isNaN(He)||isNaN(Ze)||isNaN(ft)||!ko(vt))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[De-X,He-fe],[Ze-De,ft-He],[X-Ze,fe-ft]],X,fe,[1,1],vt,!0),this},A.__private__.roundedRect=A.roundedRect=function(X,fe,De,He,Ze,ft,vt){if(isNaN(X)||isNaN(fe)||isNaN(De)||isNaN(He)||isNaN(Ze)||isNaN(ft)||!ko(vt))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var qt=4/3*(Math.SQRT2-1);return Ze=Math.min(Ze,.5*De),ft=Math.min(ft,.5*He),this.lines([[De-2*Ze,0],[Ze*qt,0,Ze,ft-ft*qt,Ze,ft],[0,He-2*ft],[0,ft*qt,-Ze*qt,ft,-Ze,ft],[2*Ze-De,0],[-Ze*qt,0,-Ze,-ft*qt,-Ze,-ft],[0,2*ft-He],[0,-ft*qt,Ze*qt,-ft,Ze,-ft]],X+Ze,fe,[1,1],vt,!0),this},A.__private__.ellipse=A.ellipse=function(X,fe,De,He,Ze){if(isNaN(X)||isNaN(fe)||isNaN(De)||isNaN(He)||!ko(Ze))throw new Error("Invalid arguments passed to jsPDF.ellipse");var ft=4/3*(Math.SQRT2-1)*De,vt=4/3*(Math.SQRT2-1)*He;return ah(X+De,fe),Gi(X+De,fe-vt,X+ft,fe-He,X,fe-He),Gi(X-ft,fe-He,X-De,fe-vt,X-De,fe),Gi(X-De,fe+vt,X-ft,fe+He,X,fe+He),Gi(X+ft,fe+He,X+De,fe+vt,X+De,fe),rd(Ze),this},A.__private__.circle=A.circle=function(X,fe,De,He){if(isNaN(X)||isNaN(fe)||isNaN(De)||!ko(He))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(X,fe,De,De,He)},A.setFont=function(X,fe,De){return De&&(fe=N(fe,De)),ke=Gs(X,fe,{disableWarning:!1}),this};var by=A.__private__.getFont=A.getFont=function(){return Ee[Gs.apply(A,arguments)]};A.__private__.getFontList=A.getFontList=function(){var X,fe,De={};for(X in ze)if(ze.hasOwnProperty(X))for(fe in De[X]=[],ze[X])ze[X].hasOwnProperty(fe)&&De[X].push(fe);return De},A.addFont=function(X,fe,De,He,Ze){var ft=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&ft.indexOf(arguments[3])!==-1?Ze=arguments[3]:arguments[3]&&ft.indexOf(arguments[3])==-1&&(De=N(De,He)),Xt.call(this,X,fe,De,Ze=Ze||"Identity-H")};var nd,sh=e.lineWidth||.200025,_y=A.__private__.getLineWidth=A.getLineWidth=function(){return sh},dr=A.__private__.setLineWidth=A.setLineWidth=function(X){return sh=X,te(B(T(X))+" w"),this};A.__private__.setLineDash=Ut.API.setLineDash=Ut.API.setLineDashPattern=function(X,fe){if(X=X||[],fe=fe||0,isNaN(fe)||!Array.isArray(X))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return X=X.map(function(De){return B(T(De))}).join(" "),fe=B(T(fe)),te("["+X+"] "+fe+" d"),this};var wy=A.__private__.getLineHeight=A.getLineHeight=function(){return ye*nd};A.__private__.getLineHeight=A.getLineHeight=function(){return ye*nd};var Ny=A.__private__.setLineHeightFactor=A.setLineHeightFactor=function(X){return typeof(X=X||1.15)=="number"&&(nd=X),this},jy=A.__private__.getLineHeightFactor=A.getLineHeightFactor=function(){return nd};Ny(e.lineHeight);var al=A.__private__.getHorizontalCoordinate=function(X){return T(X)},sl=A.__private__.getVerticalCoordinate=function(X){return v===y?X:It[D].mediaBox.topRightY-It[D].mediaBox.bottomLeftY-T(X)},ky=A.__private__.getHorizontalCoordinateString=A.getHorizontalCoordinateString=function(X){return B(al(X))},Cy=A.__private__.getVerticalCoordinateString=A.getVerticalCoordinateString=function(X){return B(sl(X))},gu=e.strokeColor||"0 G";A.__private__.getStrokeColor=A.getDrawColor=function(){return ve(gu)},A.__private__.setStrokeColor=A.setDrawColor=function(X,fe,De,He){return gu=me({ch1:X,ch2:fe,ch3:De,ch4:He,pdfColorType:"draw",precision:2}),te(gu),this};var ih=e.fillColor||"0 g";A.__private__.getFillColor=A.getFillColor=function(){return ve(ih)},A.__private__.setFillColor=A.setFillColor=function(X,fe,De,He){return ih=me({ch1:X,ch2:fe,ch3:De,ch4:He,pdfColorType:"fill",precision:2}),te(ih),this};var ad=e.textColor||"0 g",Sy=A.__private__.getTextColor=A.getTextColor=function(){return ve(ad)};A.__private__.setTextColor=A.setTextColor=function(X,fe,De,He){return ad=me({ch1:X,ch2:fe,ch3:De,ch4:He,pdfColorType:"text",precision:3}),this};var il=e.charSpace,By=A.__private__.getCharSpace=A.getCharSpace=function(){return parseFloat(il||0)};A.__private__.setCharSpace=A.setCharSpace=function(X){if(isNaN(X))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return il=X,this};var oh=0;A.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},A.__private__.setLineCap=A.setLineCap=function(X){var fe=A.CapJoinStyles[X];if(fe===void 0)throw new Error("Line cap style of '"+X+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return oh=fe,te(fe+" J"),this};var lh=0;A.__private__.setLineJoin=A.setLineJoin=function(X){var fe=A.CapJoinStyles[X];if(fe===void 0)throw new Error("Line join style of '"+X+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return lh=fe,te(fe+" j"),this},A.__private__.setLineMiterLimit=A.__private__.setMiterLimit=A.setLineMiterLimit=A.setMiterLimit=function(X){if(X=X||0,isNaN(X))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return te(B(T(X))+" M"),this},A.GState=$g,A.setGState=function(X){(X=typeof X=="string"?gt[Nt[X]]:rp(null,X)).equals(yt)||(te("/"+X.id+" gs"),yt=X)};var rp=function(X,fe){if(!X||!Nt[X]){var De=!1;for(var He in gt)if(gt.hasOwnProperty(He)&&gt[He].equals(fe)){De=!0;break}if(De)fe=gt[He];else{var Ze="GS"+(Object.keys(gt).length+1).toString(10);gt[Ze]=fe,fe.id=Ze}return X&&(Nt[X]=fe.id),ir.publish("addGState",fe),fe}};A.addGState=function(X,fe){return rp(X,fe),this},A.saveGraphicsState=function(){return te("q"),rt.push({key:ke,size:ye,color:ad}),this},A.restoreGraphicsState=function(){te("Q");var X=rt.pop();return ke=X.key,ye=X.size,ad=X.color,yt=null,this},A.setCurrentTransformationMatrix=function(X){return te(X.toString()+" cm"),this},A.comment=function(X){return te("#"+X),this};var ol=function(X,fe){var De=X||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return De},set:function(ft){isNaN(ft)||(De=parseFloat(ft))}});var He=fe||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return He},set:function(ft){isNaN(ft)||(He=parseFloat(ft))}});var Ze="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Ze},set:function(ft){Ze=ft.toString()}}),this},ch=function(X,fe,De,He){ol.call(this,X,fe),this.type="rect";var Ze=De||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Ze},set:function(vt){isNaN(vt)||(Ze=parseFloat(vt))}});var ft=He||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return ft},set:function(vt){isNaN(vt)||(ft=parseFloat(vt))}}),this},xu=function(){this.page=Et,this.currentPage=D,this.pages=se.slice(0),this.pagesContext=It.slice(0),this.x=qe,this.y=$e,this.matrix=Ne,this.width=uh(D),this.height=ap(D),this.outputDestination=he,this.id="",this.objectNumber=-1};xu.prototype.restore=function(){Et=this.page,D=this.currentPage,It=this.pagesContext,se=this.pages,qe=this.x,$e=this.y,Ne=this.matrix,np(D,this.width),ll(D,this.height),he=this.outputDestination};var dh=function(X,fe,De,He,Ze){wt.push(new xu),Et=D=0,se=[],qe=X,$e=fe,Ne=Ze,Pt([De,He])};for(var sd in A.beginFormObject=function(X,fe,De,He,Ze){return dh(X,fe,De,He,Ze),this},A.endFormObject=function(X){return function(fe){if(At[fe])wt.pop().restore();else{var De=new xu,He="Xo"+(Object.keys(tt).length+1).toString(10);De.id=He,At[fe]=He,tt[He]=De,ir.publish("addFormObject",De),wt.pop().restore()}}(X),this},A.doFormObject=function(X,fe){var De=tt[At[X]];return te("q"),te(fe.toString()+" cm"),te("/"+De.id+" Do"),te("Q"),this},A.getFormObject=function(X){var fe=tt[At[X]];return{x:fe.x,y:fe.y,width:fe.width,height:fe.height,matrix:fe.matrix}},A.save=function(X,fe){return X=X||"generated.pdf",(fe=fe||{}).returnPromise=fe.returnPromise||!1,fe.returnPromise===!1?(_d(pu(jo()),X),typeof _d.unload=="function"&&lr.setTimeout&&setTimeout(_d.unload,911),this):new Promise(function(De,He){try{var Ze=_d(pu(jo()),X);typeof _d.unload=="function"&&lr.setTimeout&&setTimeout(_d.unload,911),De(Ze)}catch(ft){He(ft.message)}})},Ut.API)Ut.API.hasOwnProperty(sd)&&(sd==="events"&&Ut.API.events.length?function(X,fe){var De,He,Ze;for(Ze=fe.length-1;Ze!==-1;Ze--)De=fe[Ze][0],He=fe[Ze][1],X.subscribe.apply(X,[De].concat(typeof He=="function"?[He]:He))}(ir,Ut.API.events):A[sd]=Ut.API[sd]);function uh(X){return It[X].mediaBox.topRightX-It[X].mediaBox.bottomLeftX}function np(X,fe){It[X].mediaBox.topRightX=fe+It[X].mediaBox.bottomLeftX}function ap(X){return It[X].mediaBox.topRightY-It[X].mediaBox.bottomLeftY}function ll(X,fe){It[X].mediaBox.topRightY=fe+It[X].mediaBox.bottomLeftY}var cl=A.getPageWidth=function(X){return uh(X=X||D)/Ue},sp=A.setPageWidth=function(X,fe){np(X,fe*Ue)},id=A.getPageHeight=function(X){return ap(X=X||D)/Ue},ip=A.setPageHeight=function(X,fe){ll(X,fe*Ue)};return A.internal={pdfEscape:$t,getStyle:Z0,getFont:by,getFontSize:we,getCharSpace:By,getTextColor:Sy,getLineHeight:wy,getLineHeightFactor:jy,getLineWidth:_y,write:ce,getHorizontalCoordinate:al,getVerticalCoordinate:sl,getCoordinateString:ky,getVerticalCoordinateString:Cy,collections:{},newObject:Jt,newAdditionalObject:ie,newObjectDeferred:Wt,newObjectDeferredBegin:ue,getFilters:Pe,putStream:Qe,events:ir,scaleFactor:Ue,pageSize:{getWidth:function(){return cl(D)},setWidth:function(X){sp(D,X)},getHeight:function(){return id(D)},setHeight:function(X){ip(D,X)}},encryptionOptions:u,encryption:ha,getEncryptor:function(X){return u!==null?ha.encryptor(X,0):function(fe){return fe}},output:Y0,getNumberOfPages:Hr,get pages(){return se},out:te,f2:k,f3:w,getPageInfo:nl,getPageInfoByObjId:J0,getCurrentPageInfo:my,getPDFVersion:p,Point:ol,Rectangle:ch,Matrix:ht,hasHotfix:_i},Object.defineProperty(A.internal.pageSize,"width",{get:function(){return cl(D)},set:function(X){sp(D,X)},enumerable:!0,configurable:!0}),Object.defineProperty(A.internal.pageSize,"height",{get:function(){return id(D)},set:function(X){ip(D,X)},enumerable:!0,configurable:!0}),(function(X){for(var fe=0,De=de.length;fe<De;fe++){var He=Xt.call(this,X[fe][0],X[fe][1],X[fe][2],de[fe][3],!0);f===!1&&(h[He]=!0);var Ze=X[fe][0].split("-");kt({id:He,fontName:Ze[0],fontStyle:Ze[1]||""})}ir.publish("addFonts",{fonts:Ee,dictionary:ze})}).call(A,de),ke="F1",jr(s,r),ir.publish("initialized"),A}Vu.prototype.lsbFirstWord=function(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)},Vu.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Vu.prototype.hexToBytes=function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},Vu.prototype.processOwnerPassword=function(e,t){return u_(d_(t).substr(0,5),e)},Vu.prototype.encryptor=function(e,t){var r=d_(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(a){return u_(r,a)}},$g.prototype.equals=function(e){var t,r="id,objectNumber,equals";if(!e||zr(e)!==zr(this))return!1;var a=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;a++}for(t in e)e.hasOwnProperty(t)&&r.indexOf(t)<0&&a--;return a===0},Ut.API={events:[]},Ut.version="3.0.4";var Dn=Ut.API,n2=1,ou=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Tu=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},ur=function(e){return e.toFixed(2)},Ac=function(e){return e.toFixed(5)};Dn.__acroform__={};var zs=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},j4=function(e){return e*n2},Lo=function(e){var t=new x6,r=Qt.internal.getHeight(e)||0,a=Qt.internal.getWidth(e)||0;return t.BBox=[0,0,Number(ur(a)),Number(ur(r))],t},aM=Dn.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|1<<t},sM=Dn.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&~(1<<t)},iM=Dn.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},Gn=Dn.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return iM(e,t-1)},Xn=Dn.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return aM(e,t-1)},Yn=Dn.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return sM(e,t-1)},oM=Dn.__acroform__.calculateCoordinates=function(e,t){var r=t.internal.getHorizontalCoordinate,a=t.internal.getVerticalCoordinate,s=e[0],i=e[1],o=e[2],l=e[3],c={};return c.lowerLeft_X=r(s)||0,c.lowerLeft_Y=a(i+l)||0,c.upperRight_X=r(s+o)||0,c.upperRight_Y=a(i)||0,[Number(ur(c.lowerLeft_X)),Number(ur(c.lowerLeft_Y)),Number(ur(c.upperRight_X)),Number(ur(c.upperRight_Y))]},lM=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],r=e._V||e.DV,a=A_(e,r),s=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+s+" "+ur(a.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(a.text),t.push("ET"),t.push("Q"),t.push("EMC");var i=Lo(e);return i.scope=e.scope,i.stream=t.join(`
`),i}},A_=function(e,t){var r=e.fontSize===0?e.maxFontSize:e.fontSize,a={text:"",fontSize:""},s=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");s=e.multiline?s.map(function(k){return k.split(`
`)}):s.map(function(k){return[k]});var i=r,o=Qt.internal.getHeight(e)||0;o=o<0?-o:o;var l=Qt.internal.getWidth(e)||0;l=l<0?-l:l;var c=function(k,w,T){if(k+1<s.length){var R=w+" "+s[k+1][0];return tm(R,e,T).width<=l-4}return!1};i++;e:for(;i>0;){t="",i--;var d,u,f=tm("3",e,i).height,h=e.multiline?o-i:(o-f)/2,A=h+=2,x=0,p=0,b=0;if(i<=0){t=`(...) Tj
`,t+="% Width of Text: "+tm(t,e,i=12).width+", FieldWidth:"+l+`
`;break}for(var m="",g=0,y=0;y<s.length;y++)if(s.hasOwnProperty(y)){var v=!1;if(s[y].length!==1&&b!==s[y].length-1){if((f+2)*(g+2)+2>o)continue e;m+=s[y][b],v=!0,p=y,y--}else{m=(m+=s[y][b]+" ").substr(m.length-1)==" "?m.substr(0,m.length-1):m;var _=parseInt(y),j=c(_,m,i),N=y>=s.length-1;if(j&&!N){m+=" ",b=0;continue}if(j||N){if(N)p=_;else if(e.multiline&&(f+2)*(g+2)+2>o)continue e}else{if(!e.multiline||(f+2)*(g+2)+2>o)continue e;p=_}}for(var B="",E=x;E<=p;E++){var C=s[E];if(e.multiline){if(E===p){B+=C[b]+" ",b=(b+1)%C.length;continue}if(E===x){B+=C[C.length-1]+" ";continue}}B+=C[0]+" "}switch(B=B.substr(B.length-1)==" "?B.substr(0,B.length-1):B,u=tm(B,e,i).width,e.textAlign){case"right":d=l-u-2;break;case"center":d=(l-u)/2;break;default:d=2}t+=ur(d)+" "+ur(A)+` Td
`,t+="("+ou(B)+`) Tj
`,t+=-ur(d)+` 0 Td
`,A=-(i+2),u=0,x=v?p:p+1,g++,m=""}break}return a.text=t,a.fontSize=i,a},tm=function(e,t,r){var a=t.scope.internal.getFont(t.fontName,t.fontStyle),s=t.scope.getStringUnitWidth(e,{font:a,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:a,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:s}},cM={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},dM=function(e,t){var r={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(a){return a.type===r.type&&a.object===r.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(r)},uM=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(_o.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(cM)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");n2=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new y6,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var a=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var s in a)if(a.hasOwnProperty(s)){var i=a[s];i.objId=void 0,i.hasAnnotation&&dM(i,r)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(r){(function(a,s){var i=!a;for(var o in a||(s.internal.newObjectDeferredBegin(s.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),s.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),a=a||s.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(a.hasOwnProperty(o)){var l=a[o],c=[],d=l.Rect;if(l.Rect&&(l.Rect=oM(l.Rect,s)),s.internal.newObjectDeferredBegin(l.objId,!0),l.DA=Qt.createDefaultAppearanceStream(l),zr(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=d,l.hasAppearanceStream&&!l.appearanceStreamContent){var u=lM(l);c.push({key:"AP",value:"<</N "+u+">>"}),s.internal.acroformPlugin.xForms.push(u)}if(l.appearanceStreamContent){var f="";for(var h in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(h)){var A=l.appearanceStreamContent[h];if(f+="/"+h+" ",f+="<<",Object.keys(A).length>=1||Array.isArray(A)){for(var o in A)if(A.hasOwnProperty(o)){var x=A[o];typeof x=="function"&&(x=x.call(s,l)),f+="/"+o+" "+x+" ",s.internal.acroformPlugin.xForms.indexOf(x)>=0||s.internal.acroformPlugin.xForms.push(x)}}else typeof(x=A)=="function"&&(x=x.call(s,l)),f+="/"+o+" "+x,s.internal.acroformPlugin.xForms.indexOf(x)>=0||s.internal.acroformPlugin.xForms.push(x);f+=">>"}c.push({key:"AP",value:`<<
`+f+">>"})}s.internal.putStream({additionalKeyValues:c,objectId:l.objId}),s.internal.out("endobj")}i&&function(p,b){for(var m in p)if(p.hasOwnProperty(m)){var g=m,y=p[m];b.internal.newObjectDeferredBegin(y.objId,!0),zr(y)==="object"&&typeof y.putStream=="function"&&y.putStream(),delete p[g]}}(s.internal.acroformPlugin.xForms,s)})(r,e)}),e.internal.acroformPlugin.isInitialized=!0}},g6=Dn.__acroform__.arrayToPdfArray=function(e,t,r){var a=function(o){return o};if(Array.isArray(e)){for(var s="[",i=0;i<e.length;i++)switch(i!==0&&(s+=" "),zr(e[i])){case"boolean":case"number":case"object":s+=e[i].toString();break;case"string":e[i].substr(0,1)!=="/"?(t!==void 0&&r&&(a=r.internal.getEncryptor(t)),s+="("+ou(a(e[i].toString()))+")"):s+=e[i].toString()}return s+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Vv=function(e,t,r){var a=function(s){return s};return t!==void 0&&r&&(a=r.internal.getEncryptor(t)),(e=e||"").toString(),"("+ou(a(e))+")"},Ho=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Ho.prototype.toString=function(){return this.objId+" 0 R"},Ho.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},Ho.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(i){return i!="content"&&i!="appearanceStreamContent"&&i!="scope"&&i!="objId"&&i.substring(0,1)!="_"});for(var r in t)if(Object.getOwnPropertyDescriptor(this,t[r]).configurable===!1){var a=t[r],s=this[a];s&&(Array.isArray(s)?e.push({key:a,value:g6(s,this.objId,this.scope)}):s instanceof Ho?(s.scope=this.scope,e.push({key:a,value:s.objId+" 0 R"})):typeof s!="function"&&e.push({key:a,value:s}))}return e};var x6=function(){Ho.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){e=r.trim()},get:function(){return e||null}})};zs(x6,Ho);var y6=function(){Ho.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var r=function(a){return a};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+ou(r(e))+")"}},set:function(r){e=r}})};zs(y6,Ho);var _o=function e(){Ho.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(m){if(isNaN(m))throw new Error('Invalid value "'+m+'" for attribute F supplied.');t=m}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Gn(t,3)},set:function(m){m?this.F=Xn(t,3):this.F=Yn(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(m){if(isNaN(m))throw new Error('Invalid value "'+m+'" for attribute Ff supplied.');r=m}});var a=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(a.length!==0)return a},set:function(m){a=m!==void 0?m:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[0])?0:a[0]},set:function(m){a[0]=m}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[1])?0:a[1]},set:function(m){a[1]=m}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[2])?0:a[2]},set:function(m){a[2]=m}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[3])?0:a[3]},set:function(m){a[3]=m}});var s="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return s},set:function(m){switch(m){case"/Btn":case"/Tx":case"/Ch":case"/Sig":s=m;break;default:throw new Error('Invalid value "'+m+'" for attribute FT supplied.')}}});var i=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!i||i.length<1){if(this instanceof Kg)return;i="FieldObject"+e.FieldNum++}var m=function(g){return g};return this.scope&&(m=this.scope.internal.getEncryptor(this.objId)),"("+ou(m(i))+")"},set:function(m){i=m.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return i},set:function(m){i=m}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(m){o=m}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(m){l=m}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(m){c=m}});var d=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return d===void 0?50/n2:d},set:function(m){d=m}});var u="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return u},set:function(m){u=m}});var f="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!f||this instanceof Kg||this instanceof Od))return Vv(f,this.objId,this.scope)},set:function(m){m=m.toString(),f=m}});var h=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof Fa==0?Vv(h,this.objId,this.scope):h},set:function(m){m=m.toString(),h=this instanceof Fa==0?m.substr(0,1)==="("?Tu(m.substr(1,m.length-2)):Tu(m):m}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Fa==1?Tu(h.substr(1,h.length-1)):h},set:function(m){m=m.toString(),h=this instanceof Fa==1?"/"+m:m}});var A=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(A)return A},set:function(m){this.V=m}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(A)return this instanceof Fa==0?Vv(A,this.objId,this.scope):A},set:function(m){m=m.toString(),A=this instanceof Fa==0?m.substr(0,1)==="("?Tu(m.substr(1,m.length-2)):Tu(m):m}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Fa==1?Tu(A.substr(1,A.length-1)):A},set:function(m){m=m.toString(),A=this instanceof Fa==1?"/"+m:m}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var x,p=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return p},set:function(m){m=!!m,p=m}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(x)return x},set:function(m){x=m}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Gn(this.Ff,1)},set:function(m){m?this.Ff=Xn(this.Ff,1):this.Ff=Yn(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Gn(this.Ff,2)},set:function(m){m?this.Ff=Xn(this.Ff,2):this.Ff=Yn(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Gn(this.Ff,3)},set:function(m){m?this.Ff=Xn(this.Ff,3):this.Ff=Yn(this.Ff,3)}});var b=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(b!==null)return b},set:function(m){if([0,1,2].indexOf(m)===-1)throw new Error('Invalid value "'+m+'" for attribute Q supplied.');b=m}}),Object.defineProperty(this,"textAlign",{get:function(){var m;switch(b){case 0:default:m="left";break;case 1:m="center";break;case 2:m="right"}return m},configurable:!0,enumerable:!0,set:function(m){switch(m){case"right":case 2:b=2;break;case"center":case 1:b=1;break;default:b=0}}})};zs(_o,Ho);var bA=function(){_o.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){e=r}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return g6(t,this.objId,this.scope)},set:function(r){var a,s;s=[],typeof(a=r)=="string"&&(s=function(i,o,l){l||(l=1);for(var c,d=[];c=o.exec(i);)d.push(c[l]);return d}(a,/\((.*?)\)/g)),t=s}}),this.getOptions=function(){return t},this.setOptions=function(r){t=r,this.sort&&t.sort()},this.addOption=function(r){r=(r=r||"").toString(),t.push(r),this.sort&&t.sort()},this.removeOption=function(r,a){for(a=a||!1,r=(r=r||"").toString();t.indexOf(r)!==-1&&(t.splice(t.indexOf(r),1),a!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Gn(this.Ff,18)},set:function(r){r?this.Ff=Xn(this.Ff,18):this.Ff=Yn(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Gn(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=Xn(this.Ff,19):this.Ff=Yn(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Gn(this.Ff,20)},set:function(r){r?(this.Ff=Xn(this.Ff,20),t.sort()):this.Ff=Yn(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Gn(this.Ff,22)},set:function(r){r?this.Ff=Xn(this.Ff,22):this.Ff=Yn(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Gn(this.Ff,23)},set:function(r){r?this.Ff=Xn(this.Ff,23):this.Ff=Yn(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Gn(this.Ff,27)},set:function(r){r?this.Ff=Xn(this.Ff,27):this.Ff=Yn(this.Ff,27)}}),this.hasAppearanceStream=!1};zs(bA,_o);var _A=function(){bA.call(this),this.fontName="helvetica",this.combo=!1};zs(_A,bA);var wA=function(){_A.call(this),this.combo=!0};zs(wA,_A);var ng=function(){wA.call(this),this.edit=!0};zs(ng,wA);var Fa=function(){_o.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Gn(this.Ff,15)},set:function(r){r?this.Ff=Xn(this.Ff,15):this.Ff=Yn(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Gn(this.Ff,16)},set:function(r){r?this.Ff=Xn(this.Ff,16):this.Ff=Yn(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Gn(this.Ff,17)},set:function(r){r?this.Ff=Xn(this.Ff,17):this.Ff=Yn(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Gn(this.Ff,26)},set:function(r){r?this.Ff=Xn(this.Ff,26):this.Ff=Yn(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(i){return i};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var a,s=[];for(a in s.push("<<"),t)s.push("/"+a+" ("+ou(r(t[a]))+")");return s.push(">>"),s.join(`
`)}},set:function(r){zr(r)==="object"&&(t=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(r){typeof r=="string"&&(t.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(r){e="/"+r}})};zs(Fa,_o);var ag=function(){Fa.call(this),this.pushButton=!0};zs(ag,Fa);var NA=function(){Fa.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};zs(NA,Fa);var Kg=function(){var e,t;_o.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(s){e=s}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(s){t=s}});var r,a={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var s=function(l){return l};this.scope&&(s=this.scope.internal.getEncryptor(this.objId));var i,o=[];for(i in o.push("<<"),a)o.push("/"+i+" ("+ou(s(a[i]))+")");return o.push(">>"),o.join(`
`)},set:function(s){zr(s)==="object"&&(a=s)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return a.CA||""},set:function(s){typeof s=="string"&&(a.CA=s)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(s){r=s}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(s){r="/"+s}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Qt.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};zs(Kg,_o),NA.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=e.createAppearanceStream(r.optionName),r.caption=e.getCA()}},NA.prototype.createOption=function(e){var t=new Kg;return t.Parent=this,t.optionName=e,this.Kids.push(t),AM.call(this.scope,t),t};var sg=function(){Fa.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Qt.CheckBox.createAppearanceStream()};zs(sg,Fa);var Od=function(){_o.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Gn(this.Ff,13)},set:function(t){t?this.Ff=Xn(this.Ff,13):this.Ff=Yn(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Gn(this.Ff,21)},set:function(t){t?this.Ff=Xn(this.Ff,21):this.Ff=Yn(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Gn(this.Ff,23)},set:function(t){t?this.Ff=Xn(this.Ff,23):this.Ff=Yn(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Gn(this.Ff,24)},set:function(t){t?this.Ff=Xn(this.Ff,24):this.Ff=Yn(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Gn(this.Ff,25)},set:function(t){t?this.Ff=Xn(this.Ff,25):this.Ff=Yn(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Gn(this.Ff,26)},set:function(t){t?this.Ff=Xn(this.Ff,26):this.Ff=Yn(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};zs(Od,_o);var ig=function(){Od.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Gn(this.Ff,14)},set:function(e){e?this.Ff=Xn(this.Ff,14):this.Ff=Yn(this.Ff,14)}}),this.password=!0};zs(ig,Od);var Qt={CheckBox:{createAppearanceStream:function(){return{N:{On:Qt.CheckBox.YesNormal},D:{On:Qt.CheckBox.YesPushDown,Off:Qt.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=Lo(e);t.scope=e.scope;var r=[],a=e.scope.internal.getFont(e.fontName,e.fontStyle).id,s=e.scope.__private__.encodeColorString(e.color),i=A_(e,e.caption);return r.push("0.749023 g"),r.push("0 0 "+ur(Qt.internal.getWidth(e))+" "+ur(Qt.internal.getHeight(e))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+a+" "+ur(i.fontSize)+" Tf "+s),r.push("BT"),r.push(i.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join(`
`),t},YesNormal:function(e){var t=Lo(e);t.scope=e.scope;var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,a=e.scope.__private__.encodeColorString(e.color),s=[],i=Qt.internal.getHeight(e),o=Qt.internal.getWidth(e),l=A_(e,e.caption);return s.push("1 g"),s.push("0 0 "+ur(o)+" "+ur(i)+" re"),s.push("f"),s.push("q"),s.push("0 0 1 rg"),s.push("0 0 "+ur(o-1)+" "+ur(i-1)+" re"),s.push("W"),s.push("n"),s.push("0 g"),s.push("BT"),s.push("/"+r+" "+ur(l.fontSize)+" Tf "+a),s.push(l.text),s.push("ET"),s.push("Q"),t.stream=s.join(`
`),t},OffPushDown:function(e){var t=Lo(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+ur(Qt.internal.getWidth(e))+" "+ur(Qt.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:Qt.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=Qt.RadioButton.Circle.YesNormal,t.D[e]=Qt.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=Lo(e);t.scope=e.scope;var r=[],a=Qt.internal.getWidth(e)<=Qt.internal.getHeight(e)?Qt.internal.getWidth(e)/4:Qt.internal.getHeight(e)/4;a=Number((.9*a).toFixed(5));var s=Qt.internal.Bezier_C,i=Number((a*s).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+Ac(Qt.internal.getWidth(e)/2)+" "+Ac(Qt.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),r.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),r.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),r.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=Lo(e);t.scope=e.scope;var r=[],a=Qt.internal.getWidth(e)<=Qt.internal.getHeight(e)?Qt.internal.getWidth(e)/4:Qt.internal.getHeight(e)/4;a=Number((.9*a).toFixed(5));var s=Number((2*a).toFixed(5)),i=Number((s*Qt.internal.Bezier_C).toFixed(5)),o=Number((a*Qt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Ac(Qt.internal.getWidth(e)/2)+" "+Ac(Qt.internal.getHeight(e)/2)+" cm"),r.push(s+" 0 m"),r.push(s+" "+i+" "+i+" "+s+" 0 "+s+" c"),r.push("-"+i+" "+s+" -"+s+" "+i+" -"+s+" 0 c"),r.push("-"+s+" -"+i+" -"+i+" -"+s+" 0 -"+s+" c"),r.push(i+" -"+s+" "+s+" -"+i+" "+s+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+Ac(Qt.internal.getWidth(e)/2)+" "+Ac(Qt.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+o+" "+o+" "+a+" 0 "+a+" c"),r.push("-"+o+" "+a+" -"+a+" "+o+" -"+a+" 0 c"),r.push("-"+a+" -"+o+" -"+o+" -"+a+" 0 -"+a+" c"),r.push(o+" -"+a+" "+a+" -"+o+" "+a+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=Lo(e);t.scope=e.scope;var r=[],a=Qt.internal.getWidth(e)<=Qt.internal.getHeight(e)?Qt.internal.getWidth(e)/4:Qt.internal.getHeight(e)/4;a=Number((.9*a).toFixed(5));var s=Number((2*a).toFixed(5)),i=Number((s*Qt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Ac(Qt.internal.getWidth(e)/2)+" "+Ac(Qt.internal.getHeight(e)/2)+" cm"),r.push(s+" 0 m"),r.push(s+" "+i+" "+i+" "+s+" 0 "+s+" c"),r.push("-"+i+" "+s+" -"+s+" "+i+" -"+s+" 0 c"),r.push("-"+s+" -"+i+" -"+i+" -"+s+" 0 -"+s+" c"),r.push(i+" -"+s+" "+s+" -"+i+" "+s+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:Qt.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=Qt.RadioButton.Cross.YesNormal,t.D[e]=Qt.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=Lo(e);t.scope=e.scope;var r=[],a=Qt.internal.calculateCross(e);return r.push("q"),r.push("1 1 "+ur(Qt.internal.getWidth(e)-2)+" "+ur(Qt.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(ur(a.x1.x)+" "+ur(a.x1.y)+" m"),r.push(ur(a.x2.x)+" "+ur(a.x2.y)+" l"),r.push(ur(a.x4.x)+" "+ur(a.x4.y)+" m"),r.push(ur(a.x3.x)+" "+ur(a.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=Lo(e);t.scope=e.scope;var r=Qt.internal.calculateCross(e),a=[];return a.push("0.749023 g"),a.push("0 0 "+ur(Qt.internal.getWidth(e))+" "+ur(Qt.internal.getHeight(e))+" re"),a.push("f"),a.push("q"),a.push("1 1 "+ur(Qt.internal.getWidth(e)-2)+" "+ur(Qt.internal.getHeight(e)-2)+" re"),a.push("W"),a.push("n"),a.push(ur(r.x1.x)+" "+ur(r.x1.y)+" m"),a.push(ur(r.x2.x)+" "+ur(r.x2.y)+" l"),a.push(ur(r.x4.x)+" "+ur(r.x4.y)+" m"),a.push(ur(r.x3.x)+" "+ur(r.x3.y)+" l"),a.push("s"),a.push("Q"),t.stream=a.join(`
`),t},OffPushDown:function(e){var t=Lo(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+ur(Qt.internal.getWidth(e))+" "+ur(Qt.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+r}};Qt.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=Qt.internal.getWidth(e),r=Qt.internal.getHeight(e),a=Math.min(t,r);return{x1:{x:(t-a)/2,y:(r-a)/2+a},x2:{x:(t-a)/2+a,y:(r-a)/2},x3:{x:(t-a)/2,y:(r-a)/2},x4:{x:(t-a)/2+a,y:(r-a)/2+a}}}},Qt.internal.getWidth=function(e){var t=0;return zr(e)==="object"&&(t=j4(e.Rect[2])),t},Qt.internal.getHeight=function(e){var t=0;return zr(e)==="object"&&(t=j4(e.Rect[3])),t};var AM=Dn.addField=function(e){if(uM(this,e),!(e instanceof _o))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};Dn.AcroFormChoiceField=bA,Dn.AcroFormListBox=_A,Dn.AcroFormComboBox=wA,Dn.AcroFormEditBox=ng,Dn.AcroFormButton=Fa,Dn.AcroFormPushButton=ag,Dn.AcroFormRadioButton=NA,Dn.AcroFormCheckBox=sg,Dn.AcroFormTextField=Od,Dn.AcroFormPasswordField=ig,Dn.AcroFormAppearance=Qt,Dn.AcroForm={ChoiceField:bA,ListBox:_A,ComboBox:wA,EditBox:ng,Button:Fa,PushButton:ag,RadioButton:NA,CheckBox:sg,TextField:Od,PasswordField:ig,Appearance:Qt},Ut.AcroForm={ChoiceField:bA,ListBox:_A,ComboBox:wA,EditBox:ng,Button:Fa,PushButton:ag,RadioButton:NA,CheckBox:sg,TextField:Od,PasswordField:ig,Appearance:Qt};Ut.AcroForm;function v6(e){return e.reduce(function(t,r,a){return t[r]=a,t},{})}(function(e){var t="addImage_";e.__addimage__={};var r="UNKNOWN",a={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},s=e.__addimage__.getImageFileTypeByImageData=function(k,w){var T,R,q,z,ee,Y=r;if((w=w||r)==="RGBA"||k.data!==void 0&&k.data instanceof Uint8ClampedArray&&"height"in k&&"width"in k)return"RGBA";if(j(k))for(ee in a)for(q=a[ee],T=0;T<q.length;T+=1){for(z=!0,R=0;R<q[T].length;R+=1)if(q[T][R]!==void 0&&q[T][R]!==k[R]){z=!1;break}if(z===!0){Y=ee;break}}else for(ee in a)for(q=a[ee],T=0;T<q.length;T+=1){for(z=!0,R=0;R<q[T].length;R+=1)if(q[T][R]!==void 0&&q[T][R]!==k.charCodeAt(R)){z=!1;break}if(z===!0){Y=ee;break}}return Y===r&&w!==r&&(Y=w),Y},i=function k(w){for(var T=this.internal.write,R=this.internal.putStream,q=(0,this.internal.getFilters)();q.indexOf("FlateEncode")!==-1;)q.splice(q.indexOf("FlateEncode"),1);w.objectId=this.internal.newObject();var z=[];if(z.push({key:"Type",value:"/XObject"}),z.push({key:"Subtype",value:"/Image"}),z.push({key:"Width",value:w.width}),z.push({key:"Height",value:w.height}),w.colorSpace===m.INDEXED?z.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(w.palette.length/3-1)+" "+("sMask"in w&&w.sMask!==void 0?w.objectId+2:w.objectId+1)+" 0 R]"}):(z.push({key:"ColorSpace",value:"/"+w.colorSpace}),w.colorSpace===m.DEVICE_CMYK&&z.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),z.push({key:"BitsPerComponent",value:w.bitsPerComponent}),"decodeParameters"in w&&w.decodeParameters!==void 0&&z.push({key:"DecodeParms",value:"<<"+w.decodeParameters+">>"}),"transparency"in w&&Array.isArray(w.transparency)&&w.transparency.length>0){for(var ee="",Y=0,G=w.transparency.length;Y<G;Y++)ee+=w.transparency[Y]+" "+w.transparency[Y]+" ";z.push({key:"Mask",value:"["+ee+"]"})}w.sMask!==void 0&&z.push({key:"SMask",value:w.objectId+1+" 0 R"});var re=w.filter!==void 0?["/"+w.filter]:void 0;if(R({data:w.data,additionalKeyValues:z,alreadyAppliedFilters:re,objectId:w.objectId}),T("endobj"),"sMask"in w&&w.sMask!==void 0){var U,S=(U=w.sMaskBitsPerComponent)!==null&&U!==void 0?U:w.bitsPerComponent,D={width:w.width,height:w.height,colorSpace:"DeviceGray",bitsPerComponent:S,data:w.sMask};"filter"in w&&(D.decodeParameters="/Predictor ".concat(w.predictor," /Colors 1 /BitsPerComponent ").concat(S," /Columns ").concat(w.width),D.filter=w.filter),k.call(this,D)}if(w.colorSpace===m.INDEXED){var L=this.internal.newObject();R({data:B(new Uint8Array(w.palette)),objectId:L}),T("endobj")}},o=function(){var k=this.internal.collections[t+"images"];for(var w in k)i.call(this,k[w])},l=function(){var k,w=this.internal.collections[t+"images"],T=this.internal.write;for(var R in w)T("/I"+(k=w[R]).index,k.objectId,"0","R")},c=function(){this.internal.collections[t+"images"]||(this.internal.collections[t+"images"]={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",l))},d=function(){var k=this.internal.collections[t+"images"];return c.call(this),k},u=function(){return Object.keys(this.internal.collections[t+"images"]).length},f=function(k){return typeof e["process"+k.toUpperCase()]=="function"},h=function(k){return zr(k)==="object"&&k.nodeType===1},A=function(k,w){if(k.nodeName==="IMG"&&k.hasAttribute("src")){var T=""+k.getAttribute("src");if(T.indexOf("data:image/")===0)return rg(unescape(T).split("base64,").pop());var R=e.loadFile(T,!0);if(R!==void 0)return R}if(k.nodeName==="CANVAS"){if(k.width===0||k.height===0)throw new Error("Given canvas must have data. Canvas width: "+k.width+", height: "+k.height);var q;switch(w){case"PNG":q="image/png";break;case"WEBP":q="image/webp";break;default:q="image/jpeg"}return rg(k.toDataURL(q,1).split("base64,").pop())}},x=function(k){var w=this.internal.collections[t+"images"];if(w){for(var T in w)if(k===w[T].alias)return w[T]}},p=function(k,w,T){return k||w||(k=-96,w=-96),k<0&&(k=-1*T.width*72/k/this.internal.scaleFactor),w<0&&(w=-1*T.height*72/w/this.internal.scaleFactor),k===0&&(k=w*T.width/T.height),w===0&&(w=k*T.height/T.width),[k,w]},b=function(k,w,T,R,q,z){var ee=p.call(this,T,R,q),Y=this.internal.getCoordinateString,G=this.internal.getVerticalCoordinateString,re=d.call(this);if(T=ee[0],R=ee[1],re[q.index]=q,z){z*=Math.PI/180;var U=Math.cos(z),S=Math.sin(z),D=function(P){return P.toFixed(4)},L=[D(U),D(S),D(-1*S),D(U),0,0,"cm"]}this.internal.write("q"),z?(this.internal.write([1,"0","0",1,Y(k),G(w+R),"cm"].join(" ")),this.internal.write(L.join(" ")),this.internal.write([Y(T),"0","0",Y(R),"0","0","cm"].join(" "))):this.internal.write([Y(T),"0","0",Y(R),Y(k),G(w+R),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+q.index+" Do"),this.internal.write("Q")},m=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var g=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},y=e.__addimage__.sHashCode=function(k){var w,T,R=0;if(typeof k=="string")for(T=k.length,w=0;w<T;w++)R=(R<<5)-R+k.charCodeAt(w),R|=0;else if(j(k))for(T=k.byteLength/2,w=0;w<T;w++)R=(R<<5)-R+k[w],R|=0;return R},v=e.__addimage__.validateStringAsBase64=function(k){(k=k||"").toString().trim();var w=!0;return k.length===0&&(w=!1),k.length%4!=0&&(w=!1),/^[A-Za-z0-9+/]+$/.test(k.substr(0,k.length-2))===!1&&(w=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(k.substr(-2))===!1&&(w=!1),w},_=e.__addimage__.extractImageFromDataUrl=function(k){if(k==null||!(k=k.trim()).startsWith("data:"))return null;var w=k.indexOf(",");return w<0?null:k.substring(0,w).trim().endsWith("base64")?k.substring(w+1):null};e.__addimage__.isArrayBuffer=function(k){return k instanceof ArrayBuffer};var j=e.__addimage__.isArrayBufferView=function(k){return k instanceof Int8Array||k instanceof Uint8Array||k instanceof Uint8ClampedArray||k instanceof Int16Array||k instanceof Uint16Array||k instanceof Int32Array||k instanceof Uint32Array||k instanceof Float32Array||k instanceof Float64Array},N=e.__addimage__.binaryStringToUint8Array=function(k){for(var w=k.length,T=new Uint8Array(w),R=0;R<w;R++)T[R]=k.charCodeAt(R);return T},B=e.__addimage__.arrayBufferToBinaryString=function(k){for(var w="",T=j(k)?k:new Uint8Array(k),R=0;R<T.length;R+=8192)w+=String.fromCharCode.apply(null,T.subarray(R,R+8192));return w};e.addImage=function(){var k,w,T,R,q,z,ee,Y,G;if(typeof arguments[1]=="number"?(w=r,T=arguments[1],R=arguments[2],q=arguments[3],z=arguments[4],ee=arguments[5],Y=arguments[6],G=arguments[7]):(w=arguments[1],T=arguments[2],R=arguments[3],q=arguments[4],z=arguments[5],ee=arguments[6],Y=arguments[7],G=arguments[8]),zr(k=arguments[0])==="object"&&!h(k)&&"imageData"in k){var re=k;k=re.imageData,w=re.format||w||r,T=re.x||T||0,R=re.y||R||0,q=re.w||re.width||q,z=re.h||re.height||z,ee=re.alias||ee,Y=re.compression||Y,G=re.rotation||re.angle||G}var U=this.internal.getFilters();if(Y===void 0&&U.indexOf("FlateEncode")!==-1&&(Y="SLOW"),isNaN(T)||isNaN(R))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var S=E.call(this,k,w,ee,Y);return b.call(this,T,R,q,z,S,G),this};var E=function(k,w,T,R){var q,z,ee;if(typeof k=="string"&&s(k)===r){k=unescape(k);var Y=C(k,!1);(Y!==""||(Y=e.loadFile(k,!0))!==void 0)&&(k=Y)}if(h(k)&&(k=A(k,w)),w=s(k,w),!f(w))throw new Error("addImage does not support files of type '"+w+"', please ensure that a plugin for '"+w+"' support is added.");if(((ee=T)==null||ee.length===0)&&(T=function(G){return typeof G=="string"||j(G)?y(G):j(G.data)?y(G.data):null}(k)),(q=x.call(this,T))||(k instanceof Uint8Array||w==="RGBA"||(z=k,k=N(k)),q=this["process"+w.toUpperCase()](k,u.call(this),T,function(G){return G&&typeof G=="string"&&(G=G.toUpperCase()),G in e.image_compression?G:g.NONE}(R),z)),!q)throw new Error("An unknown error occurred whilst processing the image.");return q},C=e.__addimage__.convertBase64ToBinaryString=function(k,w){w=typeof w!="boolean"||w;var T,R="";if(typeof k=="string"){var q;T=(q=_(k))!==null&&q!==void 0?q:k;try{R=rg(T)}catch(z){if(w)throw v(T)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+z.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return R};e.getImageProperties=function(k){var w,T,R="";if(h(k)&&(k=A(k)),typeof k=="string"&&s(k)===r&&((R=C(k,!1))===""&&(R=e.loadFile(k)||""),k=R),T=s(k),!f(T))throw new Error("addImage does not support files of type '"+T+"', please ensure that a plugin for '"+T+"' support is added.");if(k instanceof Uint8Array||(k=N(k)),!(w=this["process"+T.toUpperCase()](k)))throw new Error("An unknown error occurred whilst processing the image");return w.fileType=T,w}})(Ut.API),function(e){var t=function(r){if(r!==void 0&&r!="")return!0};Ut.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(r){for(var a,s,i,o=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),d=r.pageContext.annotations,u=!1,f=0;f<d.length&&!u;f++)switch((a=d[f]).type){case"link":(t(a.options.url)||t(a.options.pageNumber))&&(u=!0);break;case"reference":case"text":case"freetext":u=!0}if(u!=0){this.internal.write("/Annots [");for(var h=0;h<d.length;h++){a=d[h];var A=this.internal.pdfEscape,x=this.internal.getEncryptor(r.objId);switch(a.type){case"reference":this.internal.write(" "+a.object.objId+" 0 R ");break;case"text":var p=this.internal.newAdditionalObject(),b=this.internal.newAdditionalObject(),m=this.internal.getEncryptor(p.objId),g=a.title||"Note";i="<</Type /Annot /Subtype /Text "+(s="/Rect ["+o(a.bounds.x)+" "+l(a.bounds.y+a.bounds.h)+" "+o(a.bounds.x+a.bounds.w)+" "+l(a.bounds.y)+"] ")+"/Contents ("+A(m(a.contents))+")",i+=" /Popup "+b.objId+" 0 R",i+=" /P "+c.objId+" 0 R",i+=" /T ("+A(m(g))+") >>",p.content=i;var y=p.objId+" 0 R";i="<</Type /Annot /Subtype /Popup "+(s="/Rect ["+o(a.bounds.x+30)+" "+l(a.bounds.y+a.bounds.h)+" "+o(a.bounds.x+a.bounds.w+30)+" "+l(a.bounds.y)+"] ")+" /Parent "+y,a.open&&(i+=" /Open true"),i+=" >>",b.content=i,this.internal.write(p.objId,"0 R",b.objId,"0 R");break;case"freetext":s="/Rect ["+o(a.bounds.x)+" "+l(a.bounds.y)+" "+o(a.bounds.x+a.bounds.w)+" "+l(a.bounds.y+a.bounds.h)+"] ";var v=a.color||"#000000";i="<</Type /Annot /Subtype /FreeText "+s+"/Contents ("+A(x(a.contents))+")",i+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+v+")",i+=" /Border [0 0 0]",i+=" >>",this.internal.write(i);break;case"link":if(a.options.name){var _=this.annotations._nameMap[a.options.name];a.options.pageNumber=_.page,a.options.top=_.y}else a.options.top||(a.options.top=0);if(s="/Rect ["+a.finalBounds.x+" "+a.finalBounds.y+" "+a.finalBounds.w+" "+a.finalBounds.h+"] ",i="",a.options.url)i="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /A <</S /URI /URI ("+A(x(a.options.url))+") >>";else if(a.options.pageNumber)switch(i="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(a.options.pageNumber).objId+" 0 R",a.options.magFactor=a.options.magFactor||"XYZ",a.options.magFactor){case"Fit":i+=" /Fit]";break;case"FitH":i+=" /FitH "+a.options.top+"]";break;case"FitV":a.options.left=a.options.left||0,i+=" /FitV "+a.options.left+"]";break;default:var j=l(a.options.top);a.options.left=a.options.left||0,a.options.zoom===void 0&&(a.options.zoom=0),i+=" /XYZ "+a.options.left+" "+j+" "+a.options.zoom+"]"}i!=""&&(i+=" >>",this.internal.write(i))}}this.internal.write("]")}}]),e.createAnnotation=function(r){var a=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":a.pageContext.annotations.push(r)}},e.link=function(r,a,s,i,o){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,d=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(r),y:d(a),w:c(r+s),h:d(a+i)},options:o,type:"link"})},e.textWithLink=function(r,a,s,i){var o,l,c=this.getTextWidth(r),d=this.internal.getLineHeight()/this.internal.scaleFactor;if(i.maxWidth!==void 0){l=i.maxWidth;var u=this.splitTextToSize(r,l).length;o=Math.ceil(d*u)}else l=c,o=d;return this.text(r,a,s,i),s+=.2*d,i.align==="center"&&(a-=c/2),i.align==="right"&&(a-=c),this.link(a,s-d,l,o,i),c},e.getTextWidth=function(r){var a=this.internal.getFontSize();return this.getStringUnitWidth(r)*a/this.internal.scaleFactor}}(Ut.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},a={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},s=[1570,1571,1573,1575];e.__arabicParser__={};var i=e.__arabicParser__.isInArabicSubstitutionA=function(p){return t[p.charCodeAt(0)]!==void 0},o=e.__arabicParser__.isArabicLetter=function(p){return typeof p=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(p)},l=e.__arabicParser__.isArabicEndLetter=function(p){return o(p)&&i(p)&&t[p.charCodeAt(0)].length<=2},c=e.__arabicParser__.isArabicAlfLetter=function(p){return o(p)&&s.indexOf(p.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(p){return o(p)&&i(p)&&t[p.charCodeAt(0)].length>=1};var d=e.__arabicParser__.arabicLetterHasFinalForm=function(p){return o(p)&&i(p)&&t[p.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(p){return o(p)&&i(p)&&t[p.charCodeAt(0)].length>=3};var u=e.__arabicParser__.arabicLetterHasMedialForm=function(p){return o(p)&&i(p)&&t[p.charCodeAt(0)].length==4},f=e.__arabicParser__.resolveLigatures=function(p){var b=0,m=r,g="",y=0;for(b=0;b<p.length;b+=1)m[p.charCodeAt(b)]!==void 0?(y++,typeof(m=m[p.charCodeAt(b)])=="number"&&(g+=String.fromCharCode(m),m=r,y=0),b===p.length-1&&(m=r,g+=p.charAt(b-(y-1)),b-=y-1,y=0)):(m=r,g+=p.charAt(b-y),b-=y,y=0);return g};e.__arabicParser__.isArabicDiacritic=function(p){return p!==void 0&&a[p.charCodeAt(0)]!==void 0};var h=e.__arabicParser__.getCorrectForm=function(p,b,m){return o(p)?i(p)===!1?-1:!d(p)||!o(b)&&!o(m)||!o(m)&&l(b)||l(p)&&!o(b)||l(p)&&c(b)||l(p)&&l(b)?0:u(p)&&o(b)&&!l(b)&&o(m)&&d(m)?3:l(p)||!o(m)?1:2:-1},A=function(p){var b=0,m=0,g=0,y="",v="",_="",j=(p=p||"").split("\\s+"),N=[];for(b=0;b<j.length;b+=1){for(N.push(""),m=0;m<j[b].length;m+=1)y=j[b][m],v=j[b][m-1],_=j[b][m+1],o(y)?(g=h(y,v,_),N[b]+=g!==-1?String.fromCharCode(t[y.charCodeAt(0)][g]):y):N[b]+=y;N[b]=f(N[b])}return N.join(" ")},x=e.__arabicParser__.processArabic=e.processArabic=function(){var p,b=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,m=[];if(Array.isArray(b)){var g=0;for(m=[],g=0;g<b.length;g+=1)Array.isArray(b[g])?m.push([A(b[g][0]),b[g][1],b[g][2]]):m.push([A(b[g])]);p=m}else p=A(b);return typeof arguments[0]=="string"?p:(arguments[0].text=p,arguments[0])};e.events.push(["preProcessText",x])}(Ut.API),Ut.API.autoPrint=function(e){var t;return(e=e||{}).variant=e.variant||"non-conform",e.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})),this},function(e){var t=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(l){r=l}});var a=150;Object.defineProperty(this,"width",{get:function(){return a},set:function(l){a=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=a+1)}});var s=300;Object.defineProperty(this,"height",{get:function(){return s},set:function(l){s=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=s+1)}});var i=[];Object.defineProperty(this,"childNodes",{get:function(){return i},set:function(l){i=l}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(l){o=l}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(r,a){var s;if((r=r||"2d")!=="2d")return null;for(s in a)this.pdf.context2d.hasOwnProperty(s)&&(this.pdf.context2d[s]=a[s]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(Ut.API),function(e){var t={left:0,top:0,bottom:0,right:0},r=!1,a=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),s.call(this))},s=function(){this.internal.__cell__.lastCell=new i,this.internal.__cell__.pages=1},i=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(p){c=p}});var d=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return d},set:function(p){d=p}});var u=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return u},set:function(p){u=p}});var f=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return f},set:function(p){f=p}});var h=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return h},set:function(p){h=p}});var A=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return A},set:function(p){A=p}});var x=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return x},set:function(p){x=p}}),this};i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},i.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(c){return a.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},e.getTextDimensions=function(c,d){a.call(this);var u=(d=d||{}).fontSize||this.getFontSize(),f=d.font||this.getFont(),h=d.scaleFactor||this.internal.scaleFactor,A=0,x=0,p=0,b=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var m=d.maxWidth;m>0?typeof c=="string"?c=this.splitTextToSize(c,m):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(y,v){return y.concat(b.splitTextToSize(v,m))},[])):c=Array.isArray(c)?c:[c];for(var g=0;g<c.length;g++)A<(p=this.getStringUnitWidth(c[g],{font:f})*u)&&(A=p);return A!==0&&(x=c.length),{w:A/=h,h:Math.max((x*u*this.getLineHeightFactor()-u*(this.getLineHeightFactor()-1))/h,0)}},e.cellAddPage=function(){a.call(this),this.addPage();var c=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new i(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=e.cell=function(){var c;c=arguments[0]instanceof i?arguments[0]:new i(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),a.call(this);var d=this.internal.__cell__.lastCell,u=this.internal.__cell__.padding,f=this.internal.__cell__.margins||t,h=this.internal.__cell__.tableHeaderRow,A=this.internal.__cell__.printHeaders;return d.lineNumber!==void 0&&(d.lineNumber===c.lineNumber?(c.x=(d.x||0)+(d.width||0),c.y=d.y||0):d.y+d.height+c.height+f.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=f.top,A&&h&&(this.printHeaderRow(c.lineNumber,!0),c.y+=h[0].height)):c.y=d.y+d.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-u,c.y+u,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+u,{align:"center",baseline:"top",maxWidth:c.width-u-u}):this.text(c.text,c.x+u,c.y+u,{align:"left",baseline:"top",maxWidth:c.width-u-u})),this.internal.__cell__.lastCell=c,this};e.table=function(c,d,u,f,h){if(a.call(this),!u)throw new Error("No data for PDF table.");var A,x,p,b,m=[],g=[],y=[],v={},_={},j=[],N=[],B=(h=h||{}).autoSize||!1,E=h.printHeaders!==!1,C=h.css&&h.css["font-size"]!==void 0?16*h.css["font-size"]:h.fontSize||12,k=h.margins||Object.assign({width:this.getPageWidth()},t),w=typeof h.padding=="number"?h.padding:3,T=h.headerBackgroundColor||"#c8c8c8",R=h.headerTextColor||"#000";if(s.call(this),this.internal.__cell__.printHeaders=E,this.internal.__cell__.margins=k,this.internal.__cell__.table_font_size=C,this.internal.__cell__.padding=w,this.internal.__cell__.headerBackgroundColor=T,this.internal.__cell__.headerTextColor=R,this.setFontSize(C),f==null)g=m=Object.keys(u[0]),y=m.map(function(){return"left"});else if(Array.isArray(f)&&zr(f[0])==="object")for(m=f.map(function(re){return re.name}),g=f.map(function(re){return re.prompt||re.name||""}),y=f.map(function(re){return re.align||"left"}),A=0;A<f.length;A+=1)_[f[A].name]=.7499990551181103*f[A].width;else Array.isArray(f)&&typeof f[0]=="string"&&(g=m=f,y=m.map(function(){return"left"}));if(B||Array.isArray(f)&&typeof f[0]=="string")for(A=0;A<m.length;A+=1){for(v[b=m[A]]=u.map(function(re){return re[b]}),this.setFont(void 0,"bold"),j.push(this.getTextDimensions(g[A],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),x=v[b],this.setFont(void 0,"normal"),p=0;p<x.length;p+=1)j.push(this.getTextDimensions(x[p],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);_[b]=Math.max.apply(null,j)+w+w,j=[]}if(E){var q={};for(A=0;A<m.length;A+=1)q[m[A]]={},q[m[A]].text=g[A],q[m[A]].align=y[A];var z=l.call(this,q,_);N=m.map(function(re){return new i(c,d,_[re],z,q[re].text,void 0,q[re].align)}),this.setTableHeaderRow(N),this.printHeaderRow(1,!1)}var ee=f.reduce(function(re,U){return re[U.name]=U.align,re},{});for(A=0;A<u.length;A+=1){"rowStart"in h&&h.rowStart instanceof Function&&h.rowStart({row:A,data:u[A]},this);var Y=l.call(this,u[A],_);for(p=0;p<m.length;p+=1){var G=u[A][m[p]];"cellStart"in h&&h.cellStart instanceof Function&&h.cellStart({row:A,col:p,data:G},this),o.call(this,new i(c,d,_[m[p]],Y,G,A+2,ee[m[p]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=d,this};var l=function(c,d){var u=this.internal.__cell__.padding,f=this.internal.__cell__.table_font_size,h=this.internal.scaleFactor;return Object.keys(c).map(function(A){var x=c[A];return this.splitTextToSize(x.hasOwnProperty("text")?x.text:x,d[A]-u-u)},this).map(function(A){return this.getLineHeightFactor()*A.length*f/h+u+u},this).reduce(function(A,x){return Math.max(A,x)},0)};e.setTableHeaderRow=function(c){a.call(this),this.internal.__cell__.tableHeaderRow=c},e.printHeaderRow=function(c,d){if(a.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var u;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var f=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new i(f[0],f[1],f[2],f[3],void 0,-1)}this.setFont(void 0,"bold");for(var h=[],A=0;A<this.internal.__cell__.tableHeaderRow.length;A+=1){u=this.internal.__cell__.tableHeaderRow[A].clone(),d&&(u.y=this.internal.__cell__.margins.top||0,h.push(u)),u.lineNumber=c;var x=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,u),this.setTextColor(x)}h.length>0&&this.setTableHeaderRow(h),this.setFont(void 0,"normal"),r=!1}}(Ut.API);var b6={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},_6=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],h_=v6(_6),w6=[100,200,300,400,500,600,700,800,900],hM=v6(w6);function Wv(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),r=function(i){return b6[i=i||"normal"]?i:"normal"}(e.style),a=function(i){return i?typeof i=="number"?i>=100&&i<=900&&i%100==0?i:400:/^\d00$/.test(i)?parseInt(i):i==="bold"?700:400:400}(e.weight),s=function(i){return typeof h_[i=i||"normal"]=="number"?i:"normal"}(e.stretch);return{family:t,style:r,weight:a,stretch:s,src:e.src||[],ref:e.ref||{name:t,style:[s,r,a].join(" ")}}}function k4(e,t,r,a){var s;for(s=r;s>=0&&s<t.length;s+=a)if(e[t[s]])return e[t[s]];for(s=r;s>=0&&s<t.length;s-=a)if(e[t[s]])return e[t[s]]}var fM={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},C4={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function S4(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function B4(e){return e.trimLeft()}function pM(e,t){for(var r=0;r<e.length;){if(e.charAt(r)===t)return[e.substring(0,r),e.substring(r+1)];r+=1}return null}function mM(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var rm,E4,F4,Iu,nm,T4,I4,D4,zv=["times"];function L4(e,t,r,a,s){var i=4,o=O4;switch(s){case Ut.API.image_compression.FAST:i=1,o=P4;break;case Ut.API.image_compression.MEDIUM:i=6,o=U4;break;case Ut.API.image_compression.SLOW:i=9,o=R4}e=function(c,d,u,f){for(var h,A=c.length/d,x=new Uint8Array(c.length+A),p=[gM,P4,O4,U4,R4],b=0;b<A;b+=1){var m=b*d,g=c.subarray(m,m+d);if(f)x.set(f(g,u,h),m+b);else{for(var y=p.length,v=[],_=0;_<y;_+=1)v[_]=p[_](g,u,h);var j=yM(v.concat());x.set(v[j],m+b)}h=g}return x}(e,t,Math.ceil(r*a/8),o);var l=i_(e,{level:i});return Ut.API.__addimage__.arrayBufferToBinaryString(l)}function gM(e){var t=Array.apply([],e);return t.unshift(0),t}function P4(e,t){var r=e.length,a=[];a[0]=1;for(var s=0;s<r;s+=1){var i=e[s-t]||0;a[s+1]=e[s]-i+256&255}return a}function O4(e,t,r){var a=e.length,s=[];s[0]=2;for(var i=0;i<a;i+=1){var o=r&&r[i]||0;s[i+1]=e[i]-o+256&255}return s}function U4(e,t,r){var a=e.length,s=[];s[0]=3;for(var i=0;i<a;i+=1){var o=e[i-t]||0,l=r&&r[i]||0;s[i+1]=e[i]+256-(o+l>>>1)&255}return s}function R4(e,t,r){var a=e.length,s=[];s[0]=4;for(var i=0;i<a;i+=1){var o=xM(e[i-t]||0,r&&r[i]||0,r&&r[i-t]||0);s[i+1]=e[i]-o+256&255}return s}function xM(e,t,r){if(e===t&&t===r)return e;var a=Math.abs(t-r),s=Math.abs(e-r),i=Math.abs(e+t-r-r);return a<=s&&a<=i?e:s<=i?t:r}function yM(e){var t=e.map(function(r){return r.reduce(function(a,s){return a+Math.abs(s)},0)});return t.indexOf(Math.min.apply(null,t))}function Gv(e,t,r){var a=t*r,s=Math.floor(a/8),i=16-(a-8*s+r),o=(1<<r)-1;return N6(e,s)>>i&o}function M4(e,t,r,a){var s=r*a,i=Math.floor(s/8),o=16-(s-8*i+a),l=(1<<a)-1,c=(t&l)<<o;(function(d,u,f){if(u+1<d.byteLength)d.setUint16(u,f,!1);else{var h=f>>8&255;d.setUint8(u,h)}})(e,i,N6(e,i)&~(l<<o)&65535|c)}function N6(e,t){return t+1<e.byteLength?e.getUint16(t,!1):e.getUint8(t)<<8}function vM(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,a=e[t++]|e[t++]<<8,s=e[t++],i=s>>7,o=1<<1+(7&s);e[t++],e[t++];var l=null,c=null;i&&(l=t,c=o,t+=3*o);var d=!0,u=[],f=0,h=null,A=0,x=null;for(this.width=r,this.height=a;d&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,x=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((k=e[t++])>=0))throw Error("Invalid block size");if(k===0)break;t+=k}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var p=e[t++];f=e[t++]|e[t++]<<8,h=e[t++],1&p||(h=null),A=p>>2&7,t++;break;case 254:for(;;){if(!((k=e[t++])>=0))throw Error("Invalid block size");if(k===0)break;t+=k}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var b=e[t++]|e[t++]<<8,m=e[t++]|e[t++]<<8,g=e[t++]|e[t++]<<8,y=e[t++]|e[t++]<<8,v=e[t++],_=v>>6&1,j=1<<1+(7&v),N=l,B=c,E=!1;v>>7&&(E=!0,N=t,B=j,t+=3*j);var C=t;for(t++;;){var k;if(!((k=e[t++])>=0))throw Error("Invalid block size");if(k===0)break;t+=k}u.push({x:b,y:m,width:g,height:y,has_local_palette:E,palette_offset:N,palette_size:B,data_offset:C,data_length:t-C,transparent_index:h,interlaced:!!_,delay:f,disposal:A});break;case 59:d=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return u.length},this.loopCount=function(){return x},this.frameInfo=function(w){if(w<0||w>=u.length)throw new Error("Frame index out of range.");return u[w]},this.decodeAndBlitFrameBGRA=function(w,T){var R=this.frameInfo(w),q=R.width*R.height,z=new Uint8Array(q);Q4(e,R.data_offset,z,q);var ee=R.palette_offset,Y=R.transparent_index;Y===null&&(Y=256);var G=R.width,re=r-G,U=G,S=4*(R.y*r+R.x),D=4*((R.y+R.height)*r+R.x),L=S,P=4*re;R.interlaced===!0&&(P+=4*r*7);for(var I=8,H=0,V=z.length;H<V;++H){var W=z[H];if(U===0&&(U=G,(L+=P)>=D&&(P=4*re+4*r*(I-1),L=S+(G+re)*(I<<1),I>>=1)),W===Y)L+=4;else{var M=e[ee+3*W],se=e[ee+3*W+1],K=e[ee+3*W+2];T[L++]=K,T[L++]=se,T[L++]=M,T[L++]=255}--U}},this.decodeAndBlitFrameRGBA=function(w,T){var R=this.frameInfo(w),q=R.width*R.height,z=new Uint8Array(q);Q4(e,R.data_offset,z,q);var ee=R.palette_offset,Y=R.transparent_index;Y===null&&(Y=256);var G=R.width,re=r-G,U=G,S=4*(R.y*r+R.x),D=4*((R.y+R.height)*r+R.x),L=S,P=4*re;R.interlaced===!0&&(P+=4*r*7);for(var I=8,H=0,V=z.length;H<V;++H){var W=z[H];if(U===0&&(U=G,(L+=P)>=D&&(P=4*re+4*r*(I-1),L=S+(G+re)*(I<<1),I>>=1)),W===Y)L+=4;else{var M=e[ee+3*W],se=e[ee+3*W+1],K=e[ee+3*W+2];T[L++]=M,T[L++]=se,T[L++]=K,T[L++]=255}--U}}}function Q4(e,t,r,a){for(var s=e[t++],i=1<<s,o=i+1,l=o+1,c=s+1,d=(1<<c)-1,u=0,f=0,h=0,A=e[t++],x=new Int32Array(4096),p=null;;){for(;u<16&&A!==0;)f|=e[t++]<<u,u+=8,A===1?A=e[t++]:--A;if(u<c)break;var b=f&d;if(f>>=c,u-=c,b!==i){if(b===o)break;for(var m=b<l?b:p,g=0,y=m;y>i;)y=x[y]>>8,++g;var v=y;if(h+g+(m!==b?1:0)>a)return void rn.log("Warning, gif stream longer than expected.");r[h++]=v;var _=h+=g;for(m!==b&&(r[h++]=v),y=m;g--;)y=x[y],r[--_]=255&y,y>>=8;p!==null&&l<4096&&(x[l++]=p<<8|v,l>=d+1&&c<12&&(++c,d=d<<1|1)),p=b}else l=o+1,d=(1<<(c=s+1))-1,p=null}return h!==a&&rn.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function Xv(e){var t,r,a,s,i,o=Math.floor,l=new Array(64),c=new Array(64),d=new Array(64),u=new Array(64),f=new Array(65535),h=new Array(65535),A=new Array(64),x=new Array(64),p=[],b=0,m=7,g=new Array(64),y=new Array(64),v=new Array(64),_=new Array(256),j=new Array(2048),N=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],B=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],E=[0,1,2,3,4,5,6,7,8,9,10,11],C=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],k=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],w=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],T=[0,1,2,3,4,5,6,7,8,9,10,11],R=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],q=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function z(S,D){for(var L=0,P=0,I=new Array,H=1;H<=16;H++){for(var V=1;V<=S[H];V++)I[D[P]]=[],I[D[P]][0]=L,I[D[P]][1]=H,P++,L++;L*=2}return I}function ee(S){for(var D=S[0],L=S[1]-1;L>=0;)D&1<<L&&(b|=1<<m),L--,--m<0&&(b==255?(Y(255),Y(0)):Y(b),m=7,b=0)}function Y(S){p.push(S)}function G(S){Y(S>>8&255),Y(255&S)}function re(S,D,L,P,I){for(var H,V=I[0],W=I[240],M=function(ye,Le){var we,ge,Re,et,Ye,Be,Fe,oe,ke,Ue,qe=0;for(ke=0;ke<8;++ke){we=ye[qe],ge=ye[qe+1],Re=ye[qe+2],et=ye[qe+3],Ye=ye[qe+4],Be=ye[qe+5],Fe=ye[qe+6];var $e=we+(oe=ye[qe+7]),Ne=we-oe,Ee=ge+Fe,ze=ge-Fe,rt=Re+Be,nt=Re-Be,mt=et+Ye,gt=et-Ye,Nt=$e+mt,yt=$e-mt,Et=Ee+rt,It=Ee-rt;ye[qe]=Nt+Et,ye[qe+4]=Nt-Et;var ir=.707106781*(It+yt);ye[qe+2]=yt+ir,ye[qe+6]=yt-ir;var Oe=.382683433*((Nt=gt+nt)-(It=ze+Ne)),tt=.5411961*Nt+Oe,At=1.306562965*It+Oe,wt=.707106781*(Et=nt+ze),ht=Ne+wt,Ft=Ne-wt;ye[qe+5]=Ft+tt,ye[qe+3]=Ft-tt,ye[qe+1]=ht+At,ye[qe+7]=ht-At,qe+=8}for(qe=0,ke=0;ke<8;++ke){we=ye[qe],ge=ye[qe+8],Re=ye[qe+16],et=ye[qe+24],Ye=ye[qe+32],Be=ye[qe+40],Fe=ye[qe+48];var Ht=we+(oe=ye[qe+56]),vr=we-oe,xr=ge+Fe,Jt=ge-Fe,Wt=Re+Be,ue=Re-Be,ie=et+Ye,Ae=et-Ye,le=Ht+ie,ve=Ht-ie,me=xr+Wt,Pe=xr-Wt;ye[qe]=le+me,ye[qe+32]=le-me;var Qe=.707106781*(Pe+ve);ye[qe+16]=ve+Qe,ye[qe+48]=ve-Qe;var Ke=.382683433*((le=Ae+ue)-(Pe=Jt+vr)),Xe=.5411961*le+Ke,Me=1.306562965*Pe+Ke,Ce=.707106781*(me=ue+Jt),We=vr+Ce,Je=vr-Ce;ye[qe+40]=Je+Xe,ye[qe+24]=Je-Xe,ye[qe+8]=We+Me,ye[qe+56]=We-Me,qe++}for(ke=0;ke<64;++ke)Ue=ye[ke]*Le[ke],A[ke]=Ue>0?Ue+.5|0:Ue-.5|0;return A}(S,D),se=0;se<64;++se)x[N[se]]=M[se];var K=x[0]-L;L=x[0],K==0?ee(P[0]):(ee(P[h[H=32767+K]]),ee(f[H]));for(var he=63;he>0&&x[he]==0;)he--;if(he==0)return ee(V),L;for(var ne,te=1;te<=he;){for(var ce=te;x[te]==0&&te<=he;)++te;var _e=te-ce;if(_e>=16){ne=_e>>4;for(var de=1;de<=ne;++de)ee(W);_e&=15}H=32767+x[te],ee(I[(_e<<4)+h[H]]),ee(f[H]),te++}return he!=63&&ee(V),L}function U(S){S=Math.min(Math.max(S,1),100),i!=S&&(function(D){for(var L=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],P=0;P<64;P++){var I=o((L[P]*D+50)/100);I=Math.min(Math.max(I,1),255),l[N[P]]=I}for(var H=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],V=0;V<64;V++){var W=o((H[V]*D+50)/100);W=Math.min(Math.max(W,1),255),c[N[V]]=W}for(var M=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],se=0,K=0;K<8;K++)for(var he=0;he<8;he++)d[se]=1/(l[N[se]]*M[K]*M[he]*8),u[se]=1/(c[N[se]]*M[K]*M[he]*8),se++}(S<50?Math.floor(5e3/S):Math.floor(200-2*S)),i=S)}this.encode=function(S,D){D&&U(D),p=new Array,b=0,m=7,G(65496),G(65504),G(16),Y(74),Y(70),Y(73),Y(70),Y(0),Y(1),Y(1),Y(0),G(1),G(1),Y(0),Y(0),function(){G(65499),G(132),Y(0);for(var ge=0;ge<64;ge++)Y(l[ge]);Y(1);for(var Re=0;Re<64;Re++)Y(c[Re])}(),function(ge,Re){G(65472),G(17),Y(8),G(Re),G(ge),Y(3),Y(1),Y(17),Y(0),Y(2),Y(17),Y(1),Y(3),Y(17),Y(1)}(S.width,S.height),function(){G(65476),G(418),Y(0);for(var ge=0;ge<16;ge++)Y(B[ge+1]);for(var Re=0;Re<=11;Re++)Y(E[Re]);Y(16);for(var et=0;et<16;et++)Y(C[et+1]);for(var Ye=0;Ye<=161;Ye++)Y(k[Ye]);Y(1);for(var Be=0;Be<16;Be++)Y(w[Be+1]);for(var Fe=0;Fe<=11;Fe++)Y(T[Fe]);Y(17);for(var oe=0;oe<16;oe++)Y(R[oe+1]);for(var ke=0;ke<=161;ke++)Y(q[ke])}(),G(65498),G(12),Y(3),Y(1),Y(0),Y(2),Y(17),Y(3),Y(17),Y(0),Y(63),Y(0);var L=0,P=0,I=0;b=0,m=7,this.encode.displayName="_encode_";for(var H,V,W,M,se,K,he,ne,te,ce=S.data,_e=S.width,de=S.height,ye=4*_e,Le=0;Le<de;){for(H=0;H<ye;){for(se=ye*Le+H,he=-1,ne=0,te=0;te<64;te++)K=se+(ne=te>>3)*ye+(he=4*(7&te)),Le+ne>=de&&(K-=ye*(Le+1+ne-de)),H+he>=ye&&(K-=H+he-ye+4),V=ce[K++],W=ce[K++],M=ce[K++],g[te]=(j[V]+j[W+256|0]+j[M+512|0]>>16)-128,y[te]=(j[V+768|0]+j[W+1024|0]+j[M+1280|0]>>16)-128,v[te]=(j[V+1280|0]+j[W+1536|0]+j[M+1792|0]>>16)-128;L=re(g,d,L,t,a),P=re(y,u,P,r,s),I=re(v,u,I,r,s),H+=32}Le+=8}if(m>=0){var we=[];we[1]=m+1,we[0]=(1<<m+1)-1,ee(we)}return G(65497),new Uint8Array(p)},e=e||50,function(){for(var S=String.fromCharCode,D=0;D<256;D++)_[D]=S(D)}(),t=z(B,E),r=z(w,T),a=z(C,k),s=z(R,q),function(){for(var S=1,D=2,L=1;L<=15;L++){for(var P=S;P<D;P++)h[32767+P]=L,f[32767+P]=[],f[32767+P][1]=L,f[32767+P][0]=P;for(var I=-(D-1);I<=-S;I++)h[32767+I]=L,f[32767+I]=[],f[32767+I][1]=L,f[32767+I][0]=D-1+I;S<<=1,D<<=1}}(),function(){for(var S=0;S<256;S++)j[S]=19595*S,j[S+256|0]=38470*S,j[S+512|0]=7471*S+32768,j[S+768|0]=-11059*S,j[S+1024|0]=-21709*S,j[S+1280|0]=32768*S+8421375,j[S+1536|0]=-27439*S,j[S+1792|0]=-5329*S}(),U(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function to(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function H4(e){function t(E){if(!E)throw Error("assert :P")}function r(E,C,k){for(var w=0;4>w;w++)if(E[C+w]!=k.charCodeAt(w))return!0;return!1}function a(E,C,k,w,T){for(var R=0;R<T;R++)E[C+R]=k[w+R]}function s(E,C,k,w){for(var T=0;T<w;T++)E[C+T]=k}function i(E){return new Int32Array(E)}function o(E,C){for(var k=[],w=0;w<E;w++)k.push(new C);return k}function l(E,C){var k=[];return function w(T,R,q){for(var z=q[R],ee=0;ee<z&&(T.push(q.length>R+1?[]:new C),!(q.length<R+1));ee++)w(T[ee],R+1,q)}(k,0,E),k}var c=function(){var E=this;function C(F,O){for(var J=1<<O-1>>>0;F&J;)J>>>=1;return J?(F&J-1)+J:F}function k(F,O,J,ae,pe){t(!(ae%J));do F[O+(ae-=J)]=pe;while(0<ae)}function w(F,O,J,ae,pe){if(t(2328>=pe),512>=pe)var xe=i(512);else if((xe=i(pe))==null)return 0;return function(be,je,Se,Te,Ve,it){var Ie,Ge,at=je,dt=1<<Se,st=i(16),ut=i(16);for(t(Ve!=0),t(Te!=null),t(be!=null),t(0<Se),Ge=0;Ge<Ve;++Ge){if(15<Te[Ge])return 0;++st[Te[Ge]]}if(st[0]==Ve)return 0;for(ut[1]=0,Ie=1;15>Ie;++Ie){if(st[Ie]>1<<Ie)return 0;ut[Ie+1]=ut[Ie]+st[Ie]}for(Ge=0;Ge<Ve;++Ge)Ie=Te[Ge],0<Te[Ge]&&(it[ut[Ie]++]=Ge);if(ut[15]==1)return(Te=new T).g=0,Te.value=it[0],k(be,at,1,dt,Te),dt;var pt,jt=-1,bt=dt-1,Yt=0,Mt=1,pr=1,Kt=1<<Se;for(Ge=0,Ie=1,Ve=2;Ie<=Se;++Ie,Ve<<=1){if(Mt+=pr<<=1,0>(pr-=st[Ie]))return 0;for(;0<st[Ie];--st[Ie])(Te=new T).g=Ie,Te.value=it[Ge++],k(be,at+Yt,Ve,Kt,Te),Yt=C(Yt,Ie)}for(Ie=Se+1,Ve=2;15>=Ie;++Ie,Ve<<=1){if(Mt+=pr<<=1,0>(pr-=st[Ie]))return 0;for(;0<st[Ie];--st[Ie]){if(Te=new T,(Yt&bt)!=jt){for(at+=Kt,pt=1<<(jt=Ie)-Se;15>jt&&!(0>=(pt-=st[jt]));)++jt,pt<<=1;dt+=Kt=1<<(pt=jt-Se),be[je+(jt=Yt&bt)].g=pt+Se,be[je+jt].value=at-je-jt}Te.g=Ie-Se,Te.value=it[Ge++],k(be,at+(Yt>>Se),Ve,Kt,Te),Yt=C(Yt,Ie)}}return Mt!=2*ut[15]-1?0:dt}(F,O,J,ae,pe,xe)}function T(){this.value=this.g=0}function R(){this.value=this.g=0}function q(){this.G=o(5,T),this.H=i(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(Ad,R)}function z(F,O,J,ae){t(F!=null),t(O!=null),t(2147483648>ae),F.Ca=254,F.I=0,F.b=-8,F.Ka=0,F.oa=O,F.pa=J,F.Jd=O,F.Yc=J+ae,F.Zc=4<=ae?J+ae-4+1:J,V(F)}function ee(F,O){for(var J=0;0<O--;)J|=M(F,128)<<O;return J}function Y(F,O){var J=ee(F,O);return W(F)?-J:J}function G(F,O,J,ae){var pe,xe=0;for(t(F!=null),t(O!=null),t(4294967288>ae),F.Sb=ae,F.Ra=0,F.u=0,F.h=0,4<ae&&(ae=4),pe=0;pe<ae;++pe)xe+=O[J+pe]<<8*pe;F.Ra=xe,F.bb=ae,F.oa=O,F.pa=J}function re(F){for(;8<=F.u&&F.bb<F.Sb;)F.Ra>>>=8,F.Ra+=F.oa[F.pa+F.bb]<<Jl-8>>>0,++F.bb,F.u-=8;P(F)&&(F.h=1,F.u=0)}function U(F,O){if(t(0<=O),!F.h&&O<=Ys){var J=L(F)&Xs[O];return F.u+=O,re(F),J}return F.h=1,F.u=0}function S(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function D(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function L(F){return F.Ra>>>(F.u&Jl-1)>>>0}function P(F){return t(F.bb<=F.Sb),F.h||F.bb==F.Sb&&F.u>Jl}function I(F,O){F.u=O,F.h=P(F)}function H(F){F.u>=hl&&(t(F.u>=hl),re(F))}function V(F){t(F!=null&&F.oa!=null),F.pa<F.Zc?(F.I=(F.oa[F.pa++]|F.I<<8)>>>0,F.b+=8):(t(F!=null&&F.oa!=null),F.pa<F.Yc?(F.b+=8,F.I=F.oa[F.pa++]|F.I<<8):F.Ka?F.b=0:(F.I<<=8,F.b+=8,F.Ka=1))}function W(F){return ee(F,1)}function M(F,O){var J=F.Ca;0>F.b&&V(F);var ae=F.b,pe=J*O>>>8,xe=(F.I>>>ae>pe)+0;for(xe?(J-=pe,F.I-=pe+1<<ae>>>0):J=pe+1,ae=J,pe=0;256<=ae;)pe+=8,ae>>=8;return ae=7^pe+Zl[ae],F.b-=ae,F.Ca=(J<<ae)-1,xe}function se(F,O,J){F[O+0]=J>>24&255,F[O+1]=J>>16&255,F[O+2]=J>>8&255,F[O+3]=255&J}function K(F,O){return F[O+0]|F[O+1]<<8}function he(F,O){return K(F,O)|F[O+2]<<16}function ne(F,O){return K(F,O)|K(F,O+2)<<16}function te(F,O){var J=1<<O;return t(F!=null),t(0<O),F.X=i(J),F.X==null?0:(F.Mb=32-O,F.Xa=O,1)}function ce(F,O){t(F!=null),t(O!=null),t(F.Xa==O.Xa),a(O.X,0,F.X,0,1<<O.Xa)}function _e(){this.X=[],this.Xa=this.Mb=0}function de(F,O,J,ae){t(J!=null),t(ae!=null);var pe=J[0],xe=ae[0];return pe==0&&(pe=(F*xe+O/2)/O),xe==0&&(xe=(O*pe+F/2)/F),0>=pe||0>=xe?0:(J[0]=pe,ae[0]=xe,1)}function ye(F,O){return F+(1<<O)-1>>>O}function Le(F,O){return((4278255360&F)+(4278255360&O)>>>0&4278255360)+((16711935&F)+(16711935&O)>>>0&16711935)>>>0}function we(F,O){E[O]=function(J,ae,pe,xe,be,je,Se){var Te;for(Te=0;Te<be;++Te){var Ve=E[F](je[Se+Te-1],pe,xe+Te);je[Se+Te]=Le(J[ae+Te],Ve)}}}function ge(){this.ud=this.hd=this.jd=0}function Re(F,O){return((4278124286&(F^O))>>>1)+(F&O)>>>0}function et(F){return 0<=F&&256>F?F:0>F?0:255<F?255:void 0}function Ye(F,O){return et(F+(F-O+.5>>1))}function Be(F,O,J){return Math.abs(O-J)-Math.abs(F-J)}function Fe(F,O,J,ae,pe,xe,be){for(ae=xe[be-1],J=0;J<pe;++J)xe[be+J]=ae=Le(F[O+J],ae)}function oe(F,O,J,ae,pe){var xe;for(xe=0;xe<J;++xe){var be=F[O+xe],je=be>>8&255,Se=16711935&(Se=(Se=16711935&be)+((je<<16)+je));ae[pe+xe]=(4278255360&be)+Se>>>0}}function ke(F,O){O.jd=255&F,O.hd=F>>8&255,O.ud=F>>16&255}function Ue(F,O,J,ae,pe,xe){var be;for(be=0;be<ae;++be){var je=O[J+be],Se=je>>>8,Te=je,Ve=255&(Ve=(Ve=je>>>16)+((F.jd<<24>>24)*(Se<<24>>24)>>>5));Te=255&(Te=(Te+=(F.hd<<24>>24)*(Se<<24>>24)>>>5)+((F.ud<<24>>24)*(Ve<<24>>24)>>>5)),pe[xe+be]=(4278255360&je)+(Ve<<16)+Te}}function qe(F,O,J,ae,pe){E[O]=function(xe,be,je,Se,Te,Ve,it,Ie,Ge){for(Se=it;Se<Ie;++Se)for(it=0;it<Ge;++it)Te[Ve++]=pe(je[ae(xe[be++])])},E[F]=function(xe,be,je,Se,Te,Ve,it){var Ie=8>>xe.b,Ge=xe.Ea,at=xe.K[0],dt=xe.w;if(8>Ie)for(xe=(1<<xe.b)-1,dt=(1<<Ie)-1;be<je;++be){var st,ut=0;for(st=0;st<Ge;++st)st&xe||(ut=ae(Se[Te++])),Ve[it++]=pe(at[ut&dt]),ut>>=Ie}else E["VP8LMapColor"+J](Se,Te,at,dt,Ve,it,be,je,Ge)}}function $e(F,O,J,ae,pe){for(J=O+J;O<J;){var xe=F[O++];ae[pe++]=xe>>16&255,ae[pe++]=xe>>8&255,ae[pe++]=255&xe}}function Ne(F,O,J,ae,pe){for(J=O+J;O<J;){var xe=F[O++];ae[pe++]=xe>>16&255,ae[pe++]=xe>>8&255,ae[pe++]=255&xe,ae[pe++]=xe>>24&255}}function Ee(F,O,J,ae,pe){for(J=O+J;O<J;){var xe=(be=F[O++])>>16&240|be>>12&15,be=240&be|be>>28&15;ae[pe++]=xe,ae[pe++]=be}}function ze(F,O,J,ae,pe){for(J=O+J;O<J;){var xe=(be=F[O++])>>16&248|be>>13&7,be=be>>5&224|be>>3&31;ae[pe++]=xe,ae[pe++]=be}}function rt(F,O,J,ae,pe){for(J=O+J;O<J;){var xe=F[O++];ae[pe++]=255&xe,ae[pe++]=xe>>8&255,ae[pe++]=xe>>16&255}}function nt(F,O,J,ae,pe,xe){if(xe==0)for(J=O+J;O<J;)se(ae,((xe=F[O++])[0]>>24|xe[1]>>8&65280|xe[2]<<8&16711680|xe[3]<<24)>>>0),pe+=32;else a(ae,pe,F,O,J)}function mt(F,O){E[O][0]=E[F+"0"],E[O][1]=E[F+"1"],E[O][2]=E[F+"2"],E[O][3]=E[F+"3"],E[O][4]=E[F+"4"],E[O][5]=E[F+"5"],E[O][6]=E[F+"6"],E[O][7]=E[F+"7"],E[O][8]=E[F+"8"],E[O][9]=E[F+"9"],E[O][10]=E[F+"10"],E[O][11]=E[F+"11"],E[O][12]=E[F+"12"],E[O][13]=E[F+"13"],E[O][14]=E[F+"0"],E[O][15]=E[F+"0"]}function gt(F){return F==Ty||F==Iy||F==pp||F==Dy}function Nt(){this.eb=[],this.size=this.A=this.fb=0}function yt(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Et(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Nt,this.f.kb=new yt,this.sd=null}function It(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function ir(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Oe(F){return alert("todo:WebPSamplerProcessPlane"),F.T}function tt(F,O){var J=F.T,ae=O.ba.f.RGBA,pe=ae.eb,xe=ae.fb+F.ka*ae.A,be=ki[O.ba.S],je=F.y,Se=F.O,Te=F.f,Ve=F.N,it=F.ea,Ie=F.W,Ge=O.cc,at=O.dc,dt=O.Mc,st=O.Nc,ut=F.ka,pt=F.ka+F.T,jt=F.U,bt=jt+1>>1;for(ut==0?be(je,Se,null,null,Te,Ve,it,Ie,Te,Ve,it,Ie,pe,xe,null,null,jt):(be(O.ec,O.fc,je,Se,Ge,at,dt,st,Te,Ve,it,Ie,pe,xe-ae.A,pe,xe,jt),++J);ut+2<pt;ut+=2)Ge=Te,at=Ve,dt=it,st=Ie,Ve+=F.Rc,Ie+=F.Rc,xe+=2*ae.A,be(je,(Se+=2*F.fa)-F.fa,je,Se,Ge,at,dt,st,Te,Ve,it,Ie,pe,xe-ae.A,pe,xe,jt);return Se+=F.fa,F.j+pt<F.o?(a(O.ec,O.fc,je,Se,jt),a(O.cc,O.dc,Te,Ve,bt),a(O.Mc,O.Nc,it,Ie,bt),J--):1&pt||be(je,Se,null,null,Te,Ve,it,Ie,Te,Ve,it,Ie,pe,xe+ae.A,null,null,jt),J}function At(F,O,J){var ae=F.F,pe=[F.J];if(ae!=null){var xe=F.U,be=O.ba.S,je=be==fp||be==pp;O=O.ba.f.RGBA;var Se=[0],Te=F.ka;Se[0]=F.T,F.Kb&&(Te==0?--Se[0]:(--Te,pe[0]-=F.width),F.j+F.ka+F.T==F.o&&(Se[0]=F.o-F.j-Te));var Ve=O.eb;Te=O.fb+Te*O.A,F=cN(ae,pe[0],F.width,xe,Se,Ve,Te+(je?0:3),O.A),t(J==Se),F&&gt(be)&&wh(Ve,Te,je,xe,Se,O.A)}return 0}function wt(F){var O=F.ma,J=O.ba.S,ae=11>J,pe=J==Ap||J==hp||J==fp||J==Fy||J==12||gt(J);if(O.memory=null,O.Ib=null,O.Jb=null,O.Nd=null,!ph(O.Oa,F,pe?11:12))return 0;if(pe&&gt(J)&&Ah(),F.da)alert("todo:use_scaling");else{if(ae){if(O.Ib=Oe,F.Kb){if(J=F.U+1>>1,O.memory=i(F.U+2*J),O.memory==null)return 0;O.ec=O.memory,O.fc=0,O.cc=O.ec,O.dc=O.fc+F.U,O.Mc=O.cc,O.Nc=O.dc+J,O.Ib=tt,Ah()}}else alert("todo:EmitYUV");pe&&(O.Jb=At,ae&&Xi())}if(ae&&!jN){for(F=0;256>F;++F)ED[F]=89858*(F-128)+gp>>mp,ID[F]=-22014*(F-128)+gp,TD[F]=-45773*(F-128),FD[F]=113618*(F-128)+gp>>mp;for(F=jh;F<Oy;++F)O=76283*(F-16)+gp>>mp,DD[F-jh]=Fn(O,255),LD[F-jh]=Fn(O+8>>4,15);jN=1}return 1}function ht(F){var O=F.ma,J=F.U,ae=F.T;return t(!(1&F.ka)),0>=J||0>=ae?0:(J=O.Ib(F,O),O.Jb!=null&&O.Jb(F,O,J),O.Dc+=J,1)}function Ft(F){F.ma.memory=null}function Ht(F,O,J,ae){return U(F,8)!=47?0:(O[0]=U(F,14)+1,J[0]=U(F,14)+1,ae[0]=U(F,1),U(F,3)!=0?0:!F.h)}function vr(F,O){if(4>F)return F+1;var J=F-2>>1;return(2+(1&F)<<J)+U(O,J)+1}function xr(F,O){return 120<O?O-120:1<=(J=((J=mD[O-1])>>4)*F+(8-(15&J)))?J:1;var J}function Jt(F,O,J){var ae=L(J),pe=F[O+=255&ae].g-8;return 0<pe&&(I(J,J.u+8),ae=L(J),O+=F[O].value,O+=ae&(1<<pe)-1),I(J,J.u+F[O].g),F[O].value}function Wt(F,O,J){return J.g+=F.g,J.value+=F.value<<O>>>0,t(8>=J.g),F.g}function ue(F,O,J){var ae=F.xc;return t((O=ae==0?0:F.vc[F.md*(J>>ae)+(O>>ae)])<F.Wb),F.Ya[O]}function ie(F,O,J,ae){var pe=F.ab,xe=F.c*O,be=F.C;O=be+O;var je=J,Se=ae;for(ae=F.Ta,J=F.Ua;0<pe--;){var Te=F.gc[pe],Ve=be,it=O,Ie=je,Ge=Se,at=(Se=ae,je=J,Te.Ea);switch(t(Ve<it),t(it<=Te.nc),Te.hc){case 2:Qn(Ie,Ge,(it-Ve)*at,Se,je);break;case 0:var dt=Ve,st=it,ut=Se,pt=je,jt=(Kt=Te).Ea;dt==0&&(gh(Ie,Ge,null,null,1,ut,pt),Fe(Ie,Ge+1,0,0,jt-1,ut,pt+1),Ge+=jt,pt+=jt,++dt);for(var bt=1<<Kt.b,Yt=bt-1,Mt=ye(jt,Kt.b),pr=Kt.K,Kt=Kt.w+(dt>>Kt.b)*Mt;dt<st;){var Sr=pr,ma=Kt,mr=1;for(bu(Ie,Ge,ut,pt-jt,1,ut,pt);mr<jt;){var Vt=(mr&~Yt)+bt;Vt>jt&&(Vt=jt),(0,yh[Sr[ma++]>>8&15])(Ie,Ge+ +mr,ut,pt+mr-jt,Vt-mr,ut,pt+mr),mr=Vt}Ge+=jt,pt+=jt,++dt&Yt||(Kt+=Mt)}it!=Te.nc&&a(Se,je-at,Se,je+(it-Ve-1)*at,at);break;case 1:for(at=Ie,st=Ge,jt=(Ie=Te.Ea)-(pt=Ie&~(ut=(Ge=1<<Te.b)-1)),dt=ye(Ie,Te.b),bt=Te.K,Te=Te.w+(Ve>>Te.b)*dt;Ve<it;){for(Yt=bt,Mt=Te,pr=new ge,Kt=st+pt,Sr=st+Ie;st<Kt;)ke(Yt[Mt++],pr),vh(pr,at,st,Ge,Se,je),st+=Ge,je+=Ge;st<Sr&&(ke(Yt[Mt++],pr),vh(pr,at,st,jt,Se,je),st+=jt,je+=jt),++Ve&ut||(Te+=dt)}break;case 3:if(Ie==Se&&Ge==je&&0<Te.b){for(st=Se,Ie=at=je+(it-Ve)*at-(pt=(it-Ve)*ye(Te.Ea,Te.b)),Ge=Se,ut=je,dt=[],pt=(jt=pt)-1;0<=pt;--pt)dt[pt]=Ge[ut+pt];for(pt=jt-1;0<=pt;--pt)st[Ie+pt]=dt[pt];lp(Te,Ve,it,Se,at,Se,je)}else lp(Te,Ve,it,Ie,Ge,Se,je)}je=ae,Se=J}Se!=J&&a(ae,J,je,Se,xe)}function Ae(F,O){var J=F.V,ae=F.Ba+F.c*F.C,pe=O-F.C;if(t(O<=F.l.o),t(16>=pe),0<pe){var xe=F.l,be=F.Ta,je=F.Ua,Se=xe.width;if(ie(F,pe,J,ae),pe=je=[je],t((J=F.C)<(ae=O)),t(xe.v<xe.va),ae>xe.o&&(ae=xe.o),J<xe.j){var Te=xe.j-J;J=xe.j,pe[0]+=Te*Se}if(J>=ae?J=0:(pe[0]+=4*xe.v,xe.ka=J-xe.j,xe.U=xe.va-xe.v,xe.T=ae-J,J=1),J){if(je=je[0],11>(J=F.ca).S){var Ve=J.f.RGBA,it=(ae=J.S,pe=xe.U,xe=xe.T,Te=Ve.eb,Ve.A),Ie=xe;for(Ve=Ve.fb+F.Ma*Ve.A;0<Ie--;){var Ge=be,at=je,dt=pe,st=Te,ut=Ve;switch(ae){case up:bh(Ge,at,dt,st,ut);break;case Ap:ec(Ge,at,dt,st,ut);break;case Ty:ec(Ge,at,dt,st,ut),wh(st,ut,0,dt,1,0);break;case mN:hd(Ge,at,dt,st,ut);break;case hp:nt(Ge,at,dt,st,ut,1);break;case Iy:nt(Ge,at,dt,st,ut,1),wh(st,ut,0,dt,1,0);break;case fp:nt(Ge,at,dt,st,ut,0);break;case pp:nt(Ge,at,dt,st,ut,0),wh(st,ut,1,dt,1,0);break;case Fy:tc(Ge,at,dt,st,ut);break;case Dy:tc(Ge,at,dt,st,ut),lN(st,ut,dt,1,0);break;case gN:rc(Ge,at,dt,st,ut);break;default:t(0)}je+=Se,Ve+=it}F.Ma+=xe}else alert("todo:EmitRescaledRowsYUVA");t(F.Ma<=J.height)}}F.C=O,t(F.C<=F.i)}function le(F){var O;if(0<F.ua)return 0;for(O=0;O<F.Wb;++O){var J=F.Ya[O].G,ae=F.Ya[O].H;if(0<J[1][ae[1]+0].g||0<J[2][ae[2]+0].g||0<J[3][ae[3]+0].g)return 0}return 1}function ve(F,O,J,ae,pe,xe){if(F.Z!=0){var be=F.qd,je=F.rd;for(t(sc[F.Z]!=null);O<J;++O)sc[F.Z](be,je,ae,pe,ae,pe,xe),be=ae,je=pe,pe+=xe;F.qd=be,F.rd=je}}function me(F,O){var J=F.l.ma,ae=J.Z==0||J.Z==1?F.l.j:F.C;if(ae=F.C<ae?ae:F.C,t(O<=F.l.o),O>ae){var pe=F.l.width,xe=J.ca,be=J.tb+pe*ae,je=F.V,Se=F.Ba+F.c*ae,Te=F.gc;t(F.ab==1),t(Te[0].hc==3),So(Te[0],ae,O,je,Se,xe,be),ve(J,ae,O,xe,be,pe)}F.C=F.Ma=O}function Pe(F,O,J,ae,pe,xe,be){var je=F.$/ae,Se=F.$%ae,Te=F.m,Ve=F.s,it=J+F.$,Ie=it;pe=J+ae*pe;var Ge=J+ae*xe,at=280+Ve.ua,dt=F.Pb?je:16777216,st=0<Ve.ua?Ve.Wa:null,ut=Ve.wc,pt=it<Ge?ue(Ve,Se,je):null;t(F.C<xe),t(Ge<=pe);var jt=!1;e:for(;;){for(;jt||it<Ge;){var bt=0;if(je>=dt){var Yt=it-J;t((dt=F).Pb),dt.wd=dt.m,dt.xd=Yt,0<dt.s.ua&&ce(dt.s.Wa,dt.s.vb),dt=je+xD}if(Se&ut||(pt=ue(Ve,Se,je)),t(pt!=null),pt.Qb&&(O[it]=pt.qb,jt=!0),!jt)if(H(Te),pt.jc){bt=Te,Yt=O;var Mt=it,pr=pt.pd[L(bt)&Ad-1];t(pt.jc),256>pr.g?(I(bt,bt.u+pr.g),Yt[Mt]=pr.value,bt=0):(I(bt,bt.u+pr.g-256),t(256<=pr.value),bt=pr.value),bt==0&&(jt=!0)}else bt=Jt(pt.G[0],pt.H[0],Te);if(Te.h)break;if(jt||256>bt){if(!jt)if(pt.nd)O[it]=(pt.qb|bt<<8)>>>0;else{if(H(Te),jt=Jt(pt.G[1],pt.H[1],Te),H(Te),Yt=Jt(pt.G[2],pt.H[2],Te),Mt=Jt(pt.G[3],pt.H[3],Te),Te.h)break;O[it]=(Mt<<24|jt<<16|bt<<8|Yt)>>>0}if(jt=!1,++it,++Se>=ae&&(Se=0,++je,be!=null&&je<=xe&&!(je%16)&&be(F,je),st!=null))for(;Ie<it;)bt=O[Ie++],st.X[(506832829*bt&4294967295)>>>st.Mb]=bt}else if(280>bt){if(bt=vr(bt-256,Te),Yt=Jt(pt.G[4],pt.H[4],Te),H(Te),Yt=xr(ae,Yt=vr(Yt,Te)),Te.h)break;if(it-J<Yt||pe-it<bt)break e;for(Mt=0;Mt<bt;++Mt)O[it+Mt]=O[it+Mt-Yt];for(it+=bt,Se+=bt;Se>=ae;)Se-=ae,++je,be!=null&&je<=xe&&!(je%16)&&be(F,je);if(t(it<=pe),Se&ut&&(pt=ue(Ve,Se,je)),st!=null)for(;Ie<it;)bt=O[Ie++],st.X[(506832829*bt&4294967295)>>>st.Mb]=bt}else{if(!(bt<at))break e;for(jt=bt-280,t(st!=null);Ie<it;)bt=O[Ie++],st.X[(506832829*bt&4294967295)>>>st.Mb]=bt;bt=it,t(!(jt>>>(Yt=st).Xa)),O[bt]=Yt.X[jt],jt=!0}jt||t(Te.h==P(Te))}if(F.Pb&&Te.h&&it<pe)t(F.m.h),F.a=5,F.m=F.wd,F.$=F.xd,0<F.s.ua&&ce(F.s.vb,F.s.Wa);else{if(Te.h)break e;be!=null&&be(F,je>xe?xe:je),F.a=0,F.$=it-J}return 1}return F.a=3,0}function Qe(F){t(F!=null),F.vc=null,F.yc=null,F.Ya=null;var O=F.Wa;O!=null&&(O.X=null),F.vb=null,t(F!=null)}function Ke(){var F=new cr;return F==null?null:(F.a=0,F.xb=vN,mt("Predictor","VP8LPredictors"),mt("Predictor","VP8LPredictors_C"),mt("PredictorAdd","VP8LPredictorsAdd"),mt("PredictorAdd","VP8LPredictorsAdd_C"),Qn=oe,vh=Ue,bh=$e,ec=Ne,tc=Ee,rc=ze,hd=rt,E.VP8LMapColor32b=Co,E.VP8LMapColor8b=xh,F)}function Xe(F,O,J,ae,pe){var xe=1,be=[F],je=[O],Se=ae.m,Te=ae.s,Ve=null,it=0;e:for(;;){if(J)for(;xe&&U(Se,1);){var Ie=be,Ge=je,at=ae,dt=1,st=at.m,ut=at.gc[at.ab],pt=U(st,2);if(at.Oc&1<<pt)xe=0;else{switch(at.Oc|=1<<pt,ut.hc=pt,ut.Ea=Ie[0],ut.nc=Ge[0],ut.K=[null],++at.ab,t(4>=at.ab),pt){case 0:case 1:ut.b=U(st,3)+2,dt=Xe(ye(ut.Ea,ut.b),ye(ut.nc,ut.b),0,at,ut.K),ut.K=ut.K[0];break;case 3:var jt,bt=U(st,8)+1,Yt=16<bt?0:4<bt?1:2<bt?2:3;if(Ie[0]=ye(ut.Ea,Yt),ut.b=Yt,jt=dt=Xe(bt,1,0,at,ut.K)){var Mt,pr=bt,Kt=ut,Sr=1<<(8>>Kt.b),ma=i(Sr);if(ma==null)jt=0;else{var mr=Kt.K[0],Vt=Kt.w;for(ma[0]=Kt.K[0][0],Mt=1;Mt<1*pr;++Mt)ma[Mt]=Le(mr[Vt+Mt],ma[Mt-1]);for(;Mt<4*Sr;++Mt)ma[Mt]=0;Kt.K[0]=null,Kt.K[0]=ma,jt=1}}dt=jt;break;case 2:break;default:t(0)}xe=dt}}if(be=be[0],je=je[0],xe&&U(Se,1)&&!(xe=1<=(it=U(Se,4))&&11>=it)){ae.a=3;break e}var Tt;if(Tt=xe)t:{var qn,Ar,Br,dn=ae,Oa=be,xs=je,Tn=it,Ya=J,ys=dn.m,ga=dn.s,Tr=[null],qr=1,In=0,$r=gD[Tn];r:for(;;){if(Ya&&U(ys,1)){var Ua=U(ys,3)+2,Ji=ye(Oa,Ua),$n=ye(xs,Ua),Ps=Ji*$n;if(!Xe(Ji,$n,0,dn,Tr))break r;for(Tr=Tr[0],ga.xc=Ua,qn=0;qn<Ps;++qn){var tn=Tr[qn]>>8&65535;Tr[qn]=tn,tn>=qr&&(qr=tn+1)}}if(ys.h)break r;for(Ar=0;5>Ar;++Ar){var xa=xN[Ar];!Ar&&0<Tn&&(xa+=1<<Tn),In<xa&&(In=xa)}var Zs=o(qr*$r,T),vs=qr,ei=o(vs,q);if(ei==null)var ti=null;else t(65536>=vs),ti=ei;var Os=i(In);if(ti==null||Os==null||Zs==null){dn.a=1;break r}var ri=Zs;for(qn=Br=0;qn<qr;++qn){var an=ti[qn],ni=an.G,Zi=an.H,pd=0,ml=1,Ra=0;for(Ar=0;5>Ar;++Ar){xa=xN[Ar],ni[Ar]=ri,Zi[Ar]=Br,!Ar&&0<Tn&&(xa+=1<<Tn);a:{var yp,Uy=xa,vp=dn,kh=Os,UD=ri,RD=Br,Ry=0,ic=vp.m,MD=U(ic,1);if(s(kh,0,0,Uy),MD){var QD=U(ic,1)+1,HD=U(ic,1),SN=U(ic,HD==0?1:8);kh[SN]=1,QD==2&&(kh[SN=U(ic,8)]=1);var bp=1}else{var BN=i(19),EN=U(ic,4)+4;if(19<EN){vp.a=3;var _p=0;break a}for(yp=0;yp<EN;++yp)BN[pD[yp]]=U(ic,3);var My=void 0,Ch=void 0,FN=vp,qD=BN,wp=Uy,TN=kh,Qy=0,oc=FN.m,IN=8,DN=o(128,T);n:for(;w(DN,0,7,qD,19);){if(U(oc,1)){var $D=2+2*U(oc,3);if((My=2+U(oc,$D))>wp)break n}else My=wp;for(Ch=0;Ch<wp&&My--;){H(oc);var LN=DN[0+(127&L(oc))];I(oc,oc.u+LN.g);var wu=LN.value;if(16>wu)TN[Ch++]=wu,wu!=0&&(IN=wu);else{var KD=wu==16,PN=wu-16,VD=hD[PN],ON=U(oc,AD[PN])+VD;if(Ch+ON>wp)break n;for(var WD=KD?IN:0;0<ON--;)TN[Ch++]=WD}}Qy=1;break n}Qy||(FN.a=3),bp=Qy}(bp=bp&&!ic.h)&&(Ry=w(UD,RD,8,kh,Uy)),bp&&Ry!=0?_p=Ry:(vp.a=3,_p=0)}if(_p==0)break r;if(ml&&fD[Ar]==1&&(ml=ri[Br].g==0),pd+=ri[Br].g,Br+=_p,3>=Ar){var Sh,Hy=Os[0];for(Sh=1;Sh<xa;++Sh)Os[Sh]>Hy&&(Hy=Os[Sh]);Ra+=Hy}}if(an.nd=ml,an.Qb=0,ml&&(an.qb=(ni[3][Zi[3]+0].value<<24|ni[1][Zi[1]+0].value<<16|ni[2][Zi[2]+0].value)>>>0,pd==0&&256>ni[0][Zi[0]+0].value&&(an.Qb=1,an.qb+=ni[0][Zi[0]+0].value<<8)),an.jc=!an.Qb&&6>Ra,an.jc){var Np,gl=an;for(Np=0;Np<Ad;++Np){var lc=Np,cc=gl.pd[lc],jp=gl.G[0][gl.H[0]+lc];256<=jp.value?(cc.g=jp.g+256,cc.value=jp.value):(cc.g=0,cc.value=0,lc>>=Wt(jp,8,cc),lc>>=Wt(gl.G[1][gl.H[1]+lc],16,cc),lc>>=Wt(gl.G[2][gl.H[2]+lc],0,cc),Wt(gl.G[3][gl.H[3]+lc],24,cc))}}}ga.vc=Tr,ga.Wb=qr,ga.Ya=ti,ga.yc=Zs,Tt=1;break t}Tt=0}if(!(xe=Tt)){ae.a=3;break e}if(0<it){if(Te.ua=1<<it,!te(Te.Wa,it)){ae.a=1,xe=0;break e}}else Te.ua=0;var qy=ae,UN=be,zD=je,$y=qy.s,Ky=$y.xc;if(qy.c=UN,qy.i=zD,$y.md=ye(UN,Ky),$y.wc=Ky==0?-1:(1<<Ky)-1,J){ae.xb=jD;break e}if((Ve=i(be*je))==null){ae.a=1,xe=0;break e}xe=(xe=Pe(ae,Ve,0,be,je,je,null))&&!Se.h;break e}return xe?(pe!=null?pe[0]=Ve:(t(Ve==null),t(J)),ae.$=0,J||Qe(Te)):Qe(Te),xe}function Me(F,O){var J=F.c*F.i,ae=J+O+16*O;return t(F.c<=O),F.V=i(ae),F.V==null?(F.Ta=null,F.Ua=0,F.a=1,0):(F.Ta=F.V,F.Ua=F.Ba+J+O,1)}function Ce(F,O){var J=F.C,ae=O-J,pe=F.V,xe=F.Ba+F.c*J;for(t(O<=F.l.o);0<ae;){var be=16<ae?16:ae,je=F.l.ma,Se=F.l.width,Te=Se*be,Ve=je.ca,it=je.tb+Se*J,Ie=F.Ta,Ge=F.Ua;ie(F,be,pe,xe),dN(Ie,Ge,Ve,it,Te),ve(je,J,J+be,Ve,it,Se),ae-=be,pe+=be*F.c,J+=be}t(J==O),F.C=F.Ma=O}function We(){this.ub=this.yd=this.td=this.Rb=0}function Je(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function ot(){this.Fb=this.Bb=this.Cb=0,this.Zb=i(4),this.Lb=i(4)}function lt(){this.Yb=function(){var F=[];return function O(J,ae,pe){for(var xe=pe[ae],be=0;be<xe&&(J.push(pe.length>ae+1?[]:0),!(pe.length<ae+1));be++)O(J[be],ae+1,pe)}(F,0,[3,11]),F}()}function kt(){this.jb=i(3),this.Wc=l([4,8],lt),this.Xc=l([4,17],lt)}function Xt(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new i(4),this.od=new i(4)}function $t(){this.ld=this.La=this.dd=this.tc=0}function Pt(){this.Na=this.la=0}function jr(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function tr(){this.ad=i(384),this.Za=0,this.Ob=i(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Er(){this.uc=this.M=this.Nb=0,this.wa=Array(new $t),this.Y=0,this.ya=Array(new tr),this.aa=0,this.l=new fu}function Hr(){this.y=i(16),this.f=i(8),this.ea=i(8)}function Gs(){this.cb=this.a=0,this.sc="",this.m=new S,this.Od=new We,this.Kc=new Je,this.ed=new Xt,this.Qa=new ot,this.Ic=this.$c=this.Aa=0,this.D=new Er,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,S),this.ia=0,this.pb=o(4,jr),this.Pa=new kt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Hr),this.Hd=0,this.rb=Array(new Pt),this.sb=0,this.wa=Array(new $t),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new tr),this.L=this.aa=0,this.gd=l([4,2],$t),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Fn(F,O){return 0>F?0:F>O?O:F}function fu(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function py(){var F=new Gs;return F!=null&&(F.a=0,F.sc="OK",F.cb=0,F.Xb=0,Nh||(Nh=pu)),F}function ta(F,O,J){return F.a==0&&(F.a=O,F.sc=J,F.cb=0),0}function X0(F,O,J){return 3<=J&&F[O+0]==157&&F[O+1]==1&&F[O+2]==42}function jo(F,O){if(F==null)return 0;if(F.a=0,F.sc="OK",O==null)return ta(F,2,"null VP8Io passed to VP8GetHeaders()");var J=O.data,ae=O.w,pe=O.ha;if(4>pe)return ta(F,7,"Truncated header.");var xe=J[ae+0]|J[ae+1]<<8|J[ae+2]<<16,be=F.Od;if(be.Rb=!(1&xe),be.td=xe>>1&7,be.yd=xe>>4&1,be.ub=xe>>5,3<be.td)return ta(F,3,"Incorrect keyframe parameters.");if(!be.yd)return ta(F,4,"Frame not displayable.");ae+=3,pe-=3;var je=F.Kc;if(be.Rb){if(7>pe)return ta(F,7,"cannot parse picture header");if(!X0(J,ae,pe))return ta(F,3,"Bad code word");je.c=16383&(J[ae+4]<<8|J[ae+3]),je.Td=J[ae+4]>>6,je.i=16383&(J[ae+6]<<8|J[ae+5]),je.Ud=J[ae+6]>>6,ae+=7,pe-=7,F.za=je.c+15>>4,F.Ub=je.i+15>>4,O.width=je.c,O.height=je.i,O.Da=0,O.j=0,O.v=0,O.va=O.width,O.o=O.height,O.da=0,O.ib=O.width,O.hb=O.height,O.U=O.width,O.T=O.height,s((xe=F.Pa).jb,0,255,xe.jb.length),t((xe=F.Qa)!=null),xe.Cb=0,xe.Bb=0,xe.Fb=1,s(xe.Zb,0,0,xe.Zb.length),s(xe.Lb,0,0,xe.Lb)}if(be.ub>pe)return ta(F,7,"bad partition length");z(xe=F.m,J,ae,be.ub),ae+=be.ub,pe-=be.ub,be.Rb&&(je.Ld=W(xe),je.Kd=W(xe)),je=F.Qa;var Se,Te=F.Pa;if(t(xe!=null),t(je!=null),je.Cb=W(xe),je.Cb){if(je.Bb=W(xe),W(xe)){for(je.Fb=W(xe),Se=0;4>Se;++Se)je.Zb[Se]=W(xe)?Y(xe,7):0;for(Se=0;4>Se;++Se)je.Lb[Se]=W(xe)?Y(xe,6):0}if(je.Bb)for(Se=0;3>Se;++Se)Te.jb[Se]=W(xe)?ee(xe,8):255}else je.Bb=0;if(xe.Ka)return ta(F,3,"cannot parse segment header");if((je=F.ed).zd=W(xe),je.Tb=ee(xe,6),je.wb=ee(xe,3),je.Pc=W(xe),je.Pc&&W(xe)){for(Te=0;4>Te;++Te)W(xe)&&(je.vd[Te]=Y(xe,6));for(Te=0;4>Te;++Te)W(xe)&&(je.od[Te]=Y(xe,6))}if(F.L=je.Tb==0?0:je.zd?1:2,xe.Ka)return ta(F,3,"cannot parse filter header");var Ve=pe;if(pe=Se=ae,ae=Se+Ve,je=Ve,F.Xb=(1<<ee(F.m,2))-1,Ve<3*(Te=F.Xb))J=7;else{for(Se+=3*Te,je-=3*Te,Ve=0;Ve<Te;++Ve){var it=J[pe+0]|J[pe+1]<<8|J[pe+2]<<16;it>je&&(it=je),z(F.Jc[+Ve],J,Se,it),Se+=it,je-=it,pe+=3}z(F.Jc[+Te],J,Se,je),J=Se<ae?0:5}if(J!=0)return ta(F,J,"cannot parse partitions");for(J=ee(Se=F.m,7),pe=W(Se)?Y(Se,4):0,ae=W(Se)?Y(Se,4):0,je=W(Se)?Y(Se,4):0,Te=W(Se)?Y(Se,4):0,Se=W(Se)?Y(Se,4):0,Ve=F.Qa,it=0;4>it;++it){if(Ve.Cb){var Ie=Ve.Zb[it];Ve.Fb||(Ie+=J)}else{if(0<it){F.pb[it]=F.pb[0];continue}Ie=J}var Ge=F.pb[it];Ge.Sc[0]=Ly[Fn(Ie+pe,127)],Ge.Sc[1]=Py[Fn(Ie+0,127)],Ge.Eb[0]=2*Ly[Fn(Ie+ae,127)],Ge.Eb[1]=101581*Py[Fn(Ie+je,127)]>>16,8>Ge.Eb[1]&&(Ge.Eb[1]=8),Ge.Qc[0]=Ly[Fn(Ie+Te,117)],Ge.Qc[1]=Py[Fn(Ie+Se,127)],Ge.lc=Ie+Se}if(!be.Rb)return ta(F,4,"Not a key frame.");for(W(xe),be=F.Pa,J=0;4>J;++J){for(pe=0;8>pe;++pe)for(ae=0;3>ae;++ae)for(je=0;11>je;++je)Te=M(xe,wD[J][pe][ae][je])?ee(xe,8):bD[J][pe][ae][je],be.Wc[J][pe].Yb[ae][je]=Te;for(pe=0;17>pe;++pe)be.Xc[J][pe]=be.Wc[J][ND[pe]]}return F.kc=W(xe),F.kc&&(F.Bd=ee(xe,8)),F.cb=1}function pu(F,O,J,ae,pe,xe,be){var je=O[pe].Yb[J];for(J=0;16>pe;++pe){if(!M(F,je[J+0]))return pe;for(;!M(F,je[J+1]);)if(je=O[++pe].Yb[0],J=0,pe==16)return 16;var Se=O[pe+1].Yb;if(M(F,je[J+2])){var Te=F,Ve=0;if(M(Te,(Ie=je)[(it=J)+3]))if(M(Te,Ie[it+6])){for(je=0,it=2*(Ve=M(Te,Ie[it+8]))+(Ie=M(Te,Ie[it+9+Ve])),Ve=0,Ie=yD[it];Ie[je];++je)Ve+=Ve+M(Te,Ie[je]);Ve+=3+(8<<it)}else M(Te,Ie[it+7])?(Ve=7+2*M(Te,165),Ve+=M(Te,145)):Ve=5+M(Te,159);else Ve=M(Te,Ie[it+4])?3+M(Te,Ie[it+5]):2;je=Se[2]}else Ve=1,je=Se[1];Se=be+vD[pe],0>(Te=F).b&&V(Te);var it,Ie=Te.b,Ge=(it=Te.Ca>>1)-(Te.I>>Ie)>>31;--Te.b,Te.Ca+=Ge,Te.Ca|=1,Te.I-=(it+1&Ge)<<Ie,xe[Se]=((Ve^Ge)-Ge)*ae[(0<pe)+0]}return 16}function Y0(F){var O=F.rb[F.sb-1];O.la=0,O.Na=0,s(F.zc,0,0,F.zc.length),F.ja=0}function _i(F,O,J,ae,pe){pe=F[O+J+32*ae]+(pe>>3),F[O+J+32*ae]=-256&pe?0>pe?0:255:pe}function ha(F,O,J,ae,pe,xe){_i(F,O,0,J,ae+pe),_i(F,O,1,J,ae+xe),_i(F,O,2,J,ae-xe),_i(F,O,3,J,ae-pe)}function nl(F){return(20091*F>>16)+F}function J0(F,O,J,ae){var pe,xe=0,be=i(16);for(pe=0;4>pe;++pe){var je=F[O+0]+F[O+8],Se=F[O+0]-F[O+8],Te=(35468*F[O+4]>>16)-nl(F[O+12]),Ve=nl(F[O+4])+(35468*F[O+12]>>16);be[xe+0]=je+Ve,be[xe+1]=Se+Te,be[xe+2]=Se-Te,be[xe+3]=je-Ve,xe+=4,O++}for(pe=xe=0;4>pe;++pe)je=(F=be[xe+0]+4)+be[xe+8],Se=F-be[xe+8],Te=(35468*be[xe+4]>>16)-nl(be[xe+12]),_i(J,ae,0,0,je+(Ve=nl(be[xe+4])+(35468*be[xe+12]>>16))),_i(J,ae,1,0,Se+Te),_i(J,ae,2,0,Se-Te),_i(J,ae,3,0,je-Ve),xe++,ae+=32}function my(F,O,J,ae){var pe=F[O+0]+4,xe=35468*F[O+4]>>16,be=nl(F[O+4]),je=35468*F[O+1]>>16;ha(J,ae,0,pe+be,F=nl(F[O+1]),je),ha(J,ae,1,pe+xe,F,je),ha(J,ae,2,pe-xe,F,je),ha(J,ae,3,pe-be,F,je)}function gy(F,O,J,ae,pe){J0(F,O,J,ae),pe&&J0(F,O+16,J,ae+4)}function ko(F,O,J,ae){fd(F,O+0,J,ae,1),fd(F,O+32,J,ae+128,1)}function Z0(F,O,J,ae){var pe;for(F=F[O+0]+4,pe=0;4>pe;++pe)for(O=0;4>O;++O)_i(J,ae,O,pe,F)}function ep(F,O,J,ae){F[O+0]&&Mr(F,O+0,J,ae),F[O+16]&&Mr(F,O+16,J,ae+4),F[O+32]&&Mr(F,O+32,J,ae+128),F[O+48]&&Mr(F,O+48,J,ae+128+4)}function mu(F,O,J,ae){var pe,xe=i(16);for(pe=0;4>pe;++pe){var be=F[O+0+pe]+F[O+12+pe],je=F[O+4+pe]+F[O+8+pe],Se=F[O+4+pe]-F[O+8+pe],Te=F[O+0+pe]-F[O+12+pe];xe[0+pe]=be+je,xe[8+pe]=be-je,xe[4+pe]=Te+Se,xe[12+pe]=Te-Se}for(pe=0;4>pe;++pe)be=(F=xe[0+4*pe]+3)+xe[3+4*pe],je=xe[1+4*pe]+xe[2+4*pe],Se=xe[1+4*pe]-xe[2+4*pe],Te=F-xe[3+4*pe],J[ae+0]=be+je>>3,J[ae+16]=Te+Se>>3,J[ae+32]=be-je>>3,J[ae+48]=Te-Se>>3,ae+=64}function rd(F,O,J){var ae,pe=O-32,xe=Js,be=255-F[pe-1];for(ae=0;ae<J;++ae){var je,Se=xe,Te=be+F[O-1];for(je=0;je<J;++je)F[O+je]=Se[Te+F[pe+je]];O+=32}}function xy(F,O){rd(F,O,4)}function yy(F,O){rd(F,O,8)}function vy(F,O){rd(F,O,16)}function ah(F,O){var J;for(J=0;16>J;++J)a(F,O+32*J,F,O-32,16)}function tp(F,O){var J;for(J=16;0<J;--J)s(F,O,F[O-1],16),O+=32}function Gi(F,O,J){var ae;for(ae=0;16>ae;++ae)s(O,J+32*ae,F,16)}function by(F,O){var J,ae=16;for(J=0;16>J;++J)ae+=F[O-1+32*J]+F[O+J-32];Gi(ae>>5,F,O)}function nd(F,O){var J,ae=8;for(J=0;16>J;++J)ae+=F[O-1+32*J];Gi(ae>>4,F,O)}function sh(F,O){var J,ae=8;for(J=0;16>J;++J)ae+=F[O+J-32];Gi(ae>>4,F,O)}function _y(F,O){Gi(128,F,O)}function dr(F,O,J){return F+2*O+J+2>>2}function wy(F,O){var J,ae=O-32;for(ae=new Uint8Array([dr(F[ae-1],F[ae+0],F[ae+1]),dr(F[ae+0],F[ae+1],F[ae+2]),dr(F[ae+1],F[ae+2],F[ae+3]),dr(F[ae+2],F[ae+3],F[ae+4])]),J=0;4>J;++J)a(F,O+32*J,ae,0,ae.length)}function Ny(F,O){var J=F[O-1],ae=F[O-1+32],pe=F[O-1+64],xe=F[O-1+96];se(F,O+0,16843009*dr(F[O-1-32],J,ae)),se(F,O+32,16843009*dr(J,ae,pe)),se(F,O+64,16843009*dr(ae,pe,xe)),se(F,O+96,16843009*dr(pe,xe,xe))}function jy(F,O){var J,ae=4;for(J=0;4>J;++J)ae+=F[O+J-32]+F[O-1+32*J];for(ae>>=3,J=0;4>J;++J)s(F,O+32*J,ae,4)}function al(F,O){var J=F[O-1+0],ae=F[O-1+32],pe=F[O-1+64],xe=F[O-1-32],be=F[O+0-32],je=F[O+1-32],Se=F[O+2-32],Te=F[O+3-32];F[O+0+96]=dr(ae,pe,F[O-1+96]),F[O+1+96]=F[O+0+64]=dr(J,ae,pe),F[O+2+96]=F[O+1+64]=F[O+0+32]=dr(xe,J,ae),F[O+3+96]=F[O+2+64]=F[O+1+32]=F[O+0+0]=dr(be,xe,J),F[O+3+64]=F[O+2+32]=F[O+1+0]=dr(je,be,xe),F[O+3+32]=F[O+2+0]=dr(Se,je,be),F[O+3+0]=dr(Te,Se,je)}function sl(F,O){var J=F[O+1-32],ae=F[O+2-32],pe=F[O+3-32],xe=F[O+4-32],be=F[O+5-32],je=F[O+6-32],Se=F[O+7-32];F[O+0+0]=dr(F[O+0-32],J,ae),F[O+1+0]=F[O+0+32]=dr(J,ae,pe),F[O+2+0]=F[O+1+32]=F[O+0+64]=dr(ae,pe,xe),F[O+3+0]=F[O+2+32]=F[O+1+64]=F[O+0+96]=dr(pe,xe,be),F[O+3+32]=F[O+2+64]=F[O+1+96]=dr(xe,be,je),F[O+3+64]=F[O+2+96]=dr(be,je,Se),F[O+3+96]=dr(je,Se,Se)}function ky(F,O){var J=F[O-1+0],ae=F[O-1+32],pe=F[O-1+64],xe=F[O-1-32],be=F[O+0-32],je=F[O+1-32],Se=F[O+2-32],Te=F[O+3-32];F[O+0+0]=F[O+1+64]=xe+be+1>>1,F[O+1+0]=F[O+2+64]=be+je+1>>1,F[O+2+0]=F[O+3+64]=je+Se+1>>1,F[O+3+0]=Se+Te+1>>1,F[O+0+96]=dr(pe,ae,J),F[O+0+64]=dr(ae,J,xe),F[O+0+32]=F[O+1+96]=dr(J,xe,be),F[O+1+32]=F[O+2+96]=dr(xe,be,je),F[O+2+32]=F[O+3+96]=dr(be,je,Se),F[O+3+32]=dr(je,Se,Te)}function Cy(F,O){var J=F[O+0-32],ae=F[O+1-32],pe=F[O+2-32],xe=F[O+3-32],be=F[O+4-32],je=F[O+5-32],Se=F[O+6-32],Te=F[O+7-32];F[O+0+0]=J+ae+1>>1,F[O+1+0]=F[O+0+64]=ae+pe+1>>1,F[O+2+0]=F[O+1+64]=pe+xe+1>>1,F[O+3+0]=F[O+2+64]=xe+be+1>>1,F[O+0+32]=dr(J,ae,pe),F[O+1+32]=F[O+0+96]=dr(ae,pe,xe),F[O+2+32]=F[O+1+96]=dr(pe,xe,be),F[O+3+32]=F[O+2+96]=dr(xe,be,je),F[O+3+64]=dr(be,je,Se),F[O+3+96]=dr(je,Se,Te)}function gu(F,O){var J=F[O-1+0],ae=F[O-1+32],pe=F[O-1+64],xe=F[O-1+96];F[O+0+0]=J+ae+1>>1,F[O+2+0]=F[O+0+32]=ae+pe+1>>1,F[O+2+32]=F[O+0+64]=pe+xe+1>>1,F[O+1+0]=dr(J,ae,pe),F[O+3+0]=F[O+1+32]=dr(ae,pe,xe),F[O+3+32]=F[O+1+64]=dr(pe,xe,xe),F[O+3+64]=F[O+2+64]=F[O+0+96]=F[O+1+96]=F[O+2+96]=F[O+3+96]=xe}function ih(F,O){var J=F[O-1+0],ae=F[O-1+32],pe=F[O-1+64],xe=F[O-1+96],be=F[O-1-32],je=F[O+0-32],Se=F[O+1-32],Te=F[O+2-32];F[O+0+0]=F[O+2+32]=J+be+1>>1,F[O+0+32]=F[O+2+64]=ae+J+1>>1,F[O+0+64]=F[O+2+96]=pe+ae+1>>1,F[O+0+96]=xe+pe+1>>1,F[O+3+0]=dr(je,Se,Te),F[O+2+0]=dr(be,je,Se),F[O+1+0]=F[O+3+32]=dr(J,be,je),F[O+1+32]=F[O+3+64]=dr(ae,J,be),F[O+1+64]=F[O+3+96]=dr(pe,ae,J),F[O+1+96]=dr(xe,pe,ae)}function ad(F,O){var J;for(J=0;8>J;++J)a(F,O+32*J,F,O-32,8)}function Sy(F,O){var J;for(J=0;8>J;++J)s(F,O,F[O-1],8),O+=32}function il(F,O,J){var ae;for(ae=0;8>ae;++ae)s(O,J+32*ae,F,8)}function By(F,O){var J,ae=8;for(J=0;8>J;++J)ae+=F[O+J-32]+F[O-1+32*J];il(ae>>4,F,O)}function oh(F,O){var J,ae=4;for(J=0;8>J;++J)ae+=F[O+J-32];il(ae>>3,F,O)}function lh(F,O){var J,ae=4;for(J=0;8>J;++J)ae+=F[O-1+32*J];il(ae>>3,F,O)}function rp(F,O){il(128,F,O)}function ol(F,O,J){var ae=F[O-J],pe=F[O+0],xe=3*(pe-ae)+Ey[1020+F[O-2*J]-F[O+J]],be=dp[112+(xe+4>>3)];F[O-J]=Js[255+ae+dp[112+(xe+3>>3)]],F[O+0]=Js[255+pe-be]}function ch(F,O,J,ae){var pe=F[O+0],xe=F[O+J];return ji[255+F[O-2*J]-F[O-J]]>ae||ji[255+xe-pe]>ae}function xu(F,O,J,ae){return 4*ji[255+F[O-J]-F[O+0]]+ji[255+F[O-2*J]-F[O+J]]<=ae}function dh(F,O,J,ae,pe){var xe=F[O-3*J],be=F[O-2*J],je=F[O-J],Se=F[O+0],Te=F[O+J],Ve=F[O+2*J],it=F[O+3*J];return 4*ji[255+je-Se]+ji[255+be-Te]>ae?0:ji[255+F[O-4*J]-xe]<=pe&&ji[255+xe-be]<=pe&&ji[255+be-je]<=pe&&ji[255+it-Ve]<=pe&&ji[255+Ve-Te]<=pe&&ji[255+Te-Se]<=pe}function sd(F,O,J,ae){var pe=2*ae+1;for(ae=0;16>ae;++ae)xu(F,O+ae,J,pe)&&ol(F,O+ae,J)}function uh(F,O,J,ae){var pe=2*ae+1;for(ae=0;16>ae;++ae)xu(F,O+ae*J,1,pe)&&ol(F,O+ae*J,1)}function np(F,O,J,ae){var pe;for(pe=3;0<pe;--pe)sd(F,O+=4*J,J,ae)}function ap(F,O,J,ae){var pe;for(pe=3;0<pe;--pe)uh(F,O+=4,J,ae)}function ll(F,O,J,ae,pe,xe,be,je){for(xe=2*xe+1;0<pe--;){if(dh(F,O,J,xe,be))if(ch(F,O,J,je))ol(F,O,J);else{var Se=F,Te=O,Ve=J,it=Se[Te-2*Ve],Ie=Se[Te-Ve],Ge=Se[Te+0],at=Se[Te+Ve],dt=Se[Te+2*Ve],st=27*(pt=Ey[1020+3*(Ge-Ie)+Ey[1020+it-at]])+63>>7,ut=18*pt+63>>7,pt=9*pt+63>>7;Se[Te-3*Ve]=Js[255+Se[Te-3*Ve]+pt],Se[Te-2*Ve]=Js[255+it+ut],Se[Te-Ve]=Js[255+Ie+st],Se[Te+0]=Js[255+Ge-st],Se[Te+Ve]=Js[255+at-ut],Se[Te+2*Ve]=Js[255+dt-pt]}O+=ae}}function cl(F,O,J,ae,pe,xe,be,je){for(xe=2*xe+1;0<pe--;){if(dh(F,O,J,xe,be))if(ch(F,O,J,je))ol(F,O,J);else{var Se=F,Te=O,Ve=J,it=Se[Te-Ve],Ie=Se[Te+0],Ge=Se[Te+Ve],at=dp[112+(4+(dt=3*(Ie-it))>>3)],dt=dp[112+(dt+3>>3)],st=at+1>>1;Se[Te-2*Ve]=Js[255+Se[Te-2*Ve]+st],Se[Te-Ve]=Js[255+it+dt],Se[Te+0]=Js[255+Ie-at],Se[Te+Ve]=Js[255+Ge-st]}O+=ae}}function sp(F,O,J,ae,pe,xe){ll(F,O,J,1,16,ae,pe,xe)}function id(F,O,J,ae,pe,xe){ll(F,O,1,J,16,ae,pe,xe)}function ip(F,O,J,ae,pe,xe){var be;for(be=3;0<be;--be)cl(F,O+=4*J,J,1,16,ae,pe,xe)}function X(F,O,J,ae,pe,xe){var be;for(be=3;0<be;--be)cl(F,O+=4,1,J,16,ae,pe,xe)}function fe(F,O,J,ae,pe,xe,be,je){ll(F,O,pe,1,8,xe,be,je),ll(J,ae,pe,1,8,xe,be,je)}function De(F,O,J,ae,pe,xe,be,je){ll(F,O,1,pe,8,xe,be,je),ll(J,ae,1,pe,8,xe,be,je)}function He(F,O,J,ae,pe,xe,be,je){cl(F,O+4*pe,pe,1,8,xe,be,je),cl(J,ae+4*pe,pe,1,8,xe,be,je)}function Ze(F,O,J,ae,pe,xe,be,je){cl(F,O+4,1,pe,8,xe,be,je),cl(J,ae+4,1,pe,8,xe,be,je)}function ft(){this.ba=new Et,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new ir,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function vt(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function qt(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function zt(){this.ua=0,this.Wa=new _e,this.vb=new _e,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new q,this.yc=new T}function cr(){this.xb=this.a=0,this.l=new fu,this.ca=new Et,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new D,this.Pb=0,this.wd=new D,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new zt,this.ab=0,this.gc=o(4,qt),this.Oc=0}function hr(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new fu,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Fr(F,O,J,ae,pe,xe,be){for(F=F==null?0:F[O+0],O=0;O<be;++O)pe[xe+O]=F+J[ae+O]&255,F=pe[xe+O]}function Nn(F,O,J,ae,pe,xe,be){var je;if(F==null)Fr(null,null,J,ae,pe,xe,be);else for(je=0;je<be;++je)pe[xe+je]=F[O+je]+J[ae+je]&255}function ra(F,O,J,ae,pe,xe,be){if(F==null)Fr(null,null,J,ae,pe,xe,be);else{var je,Se=F[O+0],Te=Se,Ve=Se;for(je=0;je<be;++je)Te=Ve+(Se=F[O+je])-Te,Ve=J[ae+je]+(-256&Te?0>Te?0:255:Te)&255,Te=Se,pe[xe+je]=Ve}}function nn(F,O,J,ae){var pe=O.width,xe=O.o;if(t(F!=null&&O!=null),0>J||0>=ae||J+ae>xe)return null;if(!F.Cc){if(F.ga==null){var be;if(F.ga=new hr,(be=F.ga==null)||(be=O.width*O.o,t(F.Gb.length==0),F.Gb=i(be),F.Uc=0,F.Gb==null?be=0:(F.mb=F.Gb,F.nb=F.Uc,F.rc=null,be=1),be=!be),!be){be=F.ga;var je=F.Fa,Se=F.P,Te=F.qc,Ve=F.mb,it=F.nb,Ie=Se+1,Ge=Te-1,at=be.l;if(t(je!=null&&Ve!=null&&O!=null),sc[0]=null,sc[1]=Fr,sc[2]=Nn,sc[3]=ra,be.ca=Ve,be.tb=it,be.c=O.width,be.i=O.height,t(0<be.c&&0<be.i),1>=Te)O=0;else if(be.$a=3&je[Se+0],be.Z=je[Se+0]>>2&3,be.Lc=je[Se+0]>>4&3,Se=je[Se+0]>>6&3,0>be.$a||1<be.$a||4<=be.Z||1<be.Lc||Se)O=0;else if(at.put=ht,at.ac=wt,at.bc=Ft,at.ma=be,at.width=O.width,at.height=O.height,at.Da=O.Da,at.v=O.v,at.va=O.va,at.j=O.j,at.o=O.o,be.$a)e:{t(be.$a==1),O=Ke();t:for(;;){if(O==null){O=0;break e}if(t(be!=null),be.mc=O,O.c=be.c,O.i=be.i,O.l=be.l,O.l.ma=be,O.l.width=be.c,O.l.height=be.i,O.a=0,G(O.m,je,Ie,Ge),!Xe(be.c,be.i,1,O,null)||(O.ab==1&&O.gc[0].hc==3&&le(O.s)?(be.ic=1,je=O.c*O.i,O.Ta=null,O.Ua=0,O.V=i(je),O.Ba=0,O.V==null?(O.a=1,O=0):O=1):(be.ic=0,O=Me(O,be.c)),!O))break t;O=1;break e}be.mc=null,O=0}else O=Ge>=be.c*be.i;be=!O}if(be)return null;F.ga.Lc!=1?F.Ga=0:ae=xe-J}t(F.ga!=null),t(J+ae<=xe);e:{if(O=(je=F.ga).c,xe=je.l.o,je.$a==0){if(Ie=F.rc,Ge=F.Vc,at=F.Fa,Se=F.P+1+J*O,Te=F.mb,Ve=F.nb+J*O,t(Se<=F.P+F.qc),je.Z!=0)for(t(sc[je.Z]!=null),be=0;be<ae;++be)sc[je.Z](Ie,Ge,at,Se,Te,Ve,O),Ie=Te,Ge=Ve,Ve+=O,Se+=O;else for(be=0;be<ae;++be)a(Te,Ve,at,Se,O),Ie=Te,Ge=Ve,Ve+=O,Se+=O;F.rc=Ie,F.Vc=Ge}else{if(t(je.mc!=null),O=J+ae,t((be=je.mc)!=null),t(O<=be.i),be.C>=O)O=1;else if(je.ic||Xi(),je.ic){je=be.V,Ie=be.Ba,Ge=be.c;var dt=be.i,st=(at=1,Se=be.$/Ge,Te=be.$%Ge,Ve=be.m,it=be.s,be.$),ut=Ge*dt,pt=Ge*O,jt=it.wc,bt=st<pt?ue(it,Te,Se):null;t(st<=ut),t(O<=dt),t(le(it));t:for(;;){for(;!Ve.h&&st<pt;){if(Te&jt||(bt=ue(it,Te,Se)),t(bt!=null),H(Ve),256>(dt=Jt(bt.G[0],bt.H[0],Ve)))je[Ie+st]=dt,++st,++Te>=Ge&&(Te=0,++Se<=O&&!(Se%16)&&me(be,Se));else{if(!(280>dt)){at=0;break t}dt=vr(dt-256,Ve);var Yt,Mt=Jt(bt.G[4],bt.H[4],Ve);if(H(Ve),!(st>=(Mt=xr(Ge,Mt=vr(Mt,Ve)))&&ut-st>=dt)){at=0;break t}for(Yt=0;Yt<dt;++Yt)je[Ie+st+Yt]=je[Ie+st+Yt-Mt];for(st+=dt,Te+=dt;Te>=Ge;)Te-=Ge,++Se<=O&&!(Se%16)&&me(be,Se);st<pt&&Te&jt&&(bt=ue(it,Te,Se))}t(Ve.h==P(Ve))}me(be,Se>O?O:Se);break t}!at||Ve.h&&st<ut?(at=0,be.a=Ve.h?5:3):be.$=st,O=at}else O=Pe(be,be.V,be.Ba,be.c,be.i,O,Ce);if(!O){ae=0;break e}}J+ae>=xe&&(F.Cc=1),ae=1}if(!ae)return null;if(F.Cc&&((ae=F.ga)!=null&&(ae.mc=null),F.ga=null,0<F.Ga))return alert("todo:WebPDequantizeLevels"),null}return F.nb+J*pe}function fa(F,O,J,ae,pe,xe){for(;0<pe--;){var be,je=F,Se=O+(J?1:0),Te=F,Ve=O+(J?0:3);for(be=0;be<ae;++be){var it=Te[Ve+4*be];it!=255&&(it*=32897,je[Se+4*be+0]=je[Se+4*be+0]*it>>23,je[Se+4*be+1]=je[Se+4*be+1]*it>>23,je[Se+4*be+2]=je[Se+4*be+2]*it>>23)}O+=xe}}function na(F,O,J,ae,pe){for(;0<ae--;){var xe;for(xe=0;xe<J;++xe){var be=F[O+2*xe+0],je=15&(Te=F[O+2*xe+1]),Se=4369*je,Te=(240&Te|Te>>4)*Se>>16;F[O+2*xe+0]=(240&be|be>>4)*Se>>16&240|(15&be|be<<4)*Se>>16>>4&15,F[O+2*xe+1]=240&Te|je}O+=pe}}function La(F,O,J,ae,pe,xe,be,je){var Se,Te,Ve=255;for(Te=0;Te<pe;++Te){for(Se=0;Se<ae;++Se){var it=F[O+Se];xe[be+4*Se]=it,Ve&=it}O+=J,be+=je}return Ve!=255}function dl(F,O,J,ae,pe){var xe;for(xe=0;xe<pe;++xe)J[ae+xe]=F[O+xe]>>8}function Xi(){wh=fa,lN=na,cN=La,dN=dl}function ul(F,O,J){E[F]=function(ae,pe,xe,be,je,Se,Te,Ve,it,Ie,Ge,at,dt,st,ut,pt,jt){var bt,Yt=jt-1>>1,Mt=je[Se+0]|Te[Ve+0]<<16,pr=it[Ie+0]|Ge[at+0]<<16;t(ae!=null);var Kt=3*Mt+pr+131074>>2;for(O(ae[pe+0],255&Kt,Kt>>16,dt,st),xe!=null&&(Kt=3*pr+Mt+131074>>2,O(xe[be+0],255&Kt,Kt>>16,ut,pt)),bt=1;bt<=Yt;++bt){var Sr=je[Se+bt]|Te[Ve+bt]<<16,ma=it[Ie+bt]|Ge[at+bt]<<16,mr=Mt+Sr+pr+ma+524296,Vt=mr+2*(Sr+pr)>>3;Kt=Vt+Mt>>1,Mt=(mr=mr+2*(Mt+ma)>>3)+Sr>>1,O(ae[pe+2*bt-1],255&Kt,Kt>>16,dt,st+(2*bt-1)*J),O(ae[pe+2*bt-0],255&Mt,Mt>>16,dt,st+(2*bt-0)*J),xe!=null&&(Kt=mr+pr>>1,Mt=Vt+ma>>1,O(xe[be+2*bt-1],255&Kt,Kt>>16,ut,pt+(2*bt-1)*J),O(xe[be+2*bt+0],255&Mt,Mt>>16,ut,pt+(2*bt+0)*J)),Mt=Sr,pr=ma}1&jt||(Kt=3*Mt+pr+131074>>2,O(ae[pe+jt-1],255&Kt,Kt>>16,dt,st+(jt-1)*J),xe!=null&&(Kt=3*pr+Mt+131074>>2,O(xe[be+jt-1],255&Kt,Kt>>16,ut,pt+(jt-1)*J)))}}function Ah(){ki[up]=kD,ki[Ap]=bN,ki[mN]=CD,ki[hp]=_N,ki[fp]=wN,ki[Fy]=NN,ki[gN]=SD,ki[Ty]=bN,ki[Iy]=_N,ki[pp]=wN,ki[Dy]=NN}function yu(F){return F&-16384?0>F?0:255:F>>BD}function Gl(F,O){return yu((19077*F>>8)+(26149*O>>8)-14234)}function od(F,O,J){return yu((19077*F>>8)-(6419*O>>8)-(13320*J>>8)+8708)}function ld(F,O){return yu((19077*F>>8)+(33050*O>>8)-17685)}function Xl(F,O,J,ae,pe){ae[pe+0]=Gl(F,J),ae[pe+1]=od(F,O,J),ae[pe+2]=ld(F,O)}function Pa(F,O,J,ae,pe){ae[pe+0]=ld(F,O),ae[pe+1]=od(F,O,J),ae[pe+2]=Gl(F,J)}function cd(F,O,J,ae,pe){var xe=od(F,O,J);O=xe<<3&224|ld(F,O)>>3,ae[pe+0]=248&Gl(F,J)|xe>>5,ae[pe+1]=O}function dd(F,O,J,ae,pe){var xe=240&ld(F,O)|15;ae[pe+0]=240&Gl(F,J)|od(F,O,J)>>4,ae[pe+1]=xe}function hh(F,O,J,ae,pe){ae[pe+0]=255,Xl(F,O,J,ae,pe+1)}function fh(F,O,J,ae,pe){Pa(F,O,J,ae,pe),ae[pe+3]=255}function gs(F,O,J,ae,pe){Xl(F,O,J,ae,pe),ae[pe+3]=255}function Al(F,O,J){E[F]=function(ae,pe,xe,be,je,Se,Te,Ve,it){for(var Ie=Ve+(-2&it)*J;Ve!=Ie;)O(ae[pe+0],xe[be+0],je[Se+0],Te,Ve),O(ae[pe+1],xe[be+0],je[Se+0],Te,Ve+J),pe+=2,++be,++Se,Ve+=2*J;1&it&&O(ae[pe+0],xe[be+0],je[Se+0],Te,Ve)}}function vu(F,O,J){return J==0?F==0?O==0?6:5:O==0?4:0:J}function op(F,O,J,ae,pe){switch(F>>>30){case 3:fd(O,J,ae,pe,0);break;case 2:Ni(O,J,ae,pe);break;case 1:Mr(O,J,ae,pe)}}function wi(F,O){var J,ae,pe=O.M,xe=O.Nb,be=F.oc,je=F.pc+40,Se=F.oc,Te=F.pc+584,Ve=F.oc,it=F.pc+600;for(J=0;16>J;++J)be[je+32*J-1]=129;for(J=0;8>J;++J)Se[Te+32*J-1]=129,Ve[it+32*J-1]=129;for(0<pe?be[je-1-32]=Se[Te-1-32]=Ve[it-1-32]=129:(s(be,je-32-1,127,21),s(Se,Te-32-1,127,9),s(Ve,it-32-1,127,9)),ae=0;ae<F.za;++ae){var Ie=O.ya[O.aa+ae];if(0<ae){for(J=-1;16>J;++J)a(be,je+32*J-4,be,je+32*J+12,4);for(J=-1;8>J;++J)a(Se,Te+32*J-4,Se,Te+32*J+4,4),a(Ve,it+32*J-4,Ve,it+32*J+4,4)}var Ge=F.Gd,at=F.Hd+ae,dt=Ie.ad,st=Ie.Hc;if(0<pe&&(a(be,je-32,Ge[at].y,0,16),a(Se,Te-32,Ge[at].f,0,8),a(Ve,it-32,Ge[at].ea,0,8)),Ie.Za){var ut=be,pt=je-32+16;for(0<pe&&(ae>=F.za-1?s(ut,pt,Ge[at].y[15],4):a(ut,pt,Ge[at+1].y,0,4)),J=0;4>J;J++)ut[pt+128+J]=ut[pt+256+J]=ut[pt+384+J]=ut[pt+0+J];for(J=0;16>J;++J,st<<=2)ut=be,pt=je+kN[J],Yi[Ie.Ob[J]](ut,pt),op(st,dt,16*+J,ut,pt)}else if(ut=vu(ae,pe,Ie.Ob[0]),ac[ut](be,je),st!=0)for(J=0;16>J;++J,st<<=2)op(st,dt,16*+J,be,je+kN[J]);for(J=Ie.Gc,ut=vu(ae,pe,Ie.Dd),pl[ut](Se,Te),pl[ut](Ve,it),st=dt,ut=Se,pt=Te,255&(Ie=0|J)&&(170&Ie?Bo(st,256,ut,pt):en(st,256,ut,pt)),Ie=Ve,st=it,255&(J>>=8)&&(170&J?Bo(dt,320,Ie,st):en(dt,320,Ie,st)),pe<F.Ub-1&&(a(Ge[at].y,0,be,je+480,16),a(Ge[at].f,0,Se,Te+224,8),a(Ge[at].ea,0,Ve,it+224,8)),J=8*xe*F.B,Ge=F.sa,at=F.ta+16*ae+16*xe*F.R,dt=F.qa,Ie=F.ra+8*ae+J,st=F.Ha,ut=F.Ia+8*ae+J,J=0;16>J;++J)a(Ge,at+J*F.R,be,je+32*J,16);for(J=0;8>J;++J)a(dt,Ie+J*F.B,Se,Te+32*J,8),a(st,ut+J*F.B,Ve,it+32*J,8)}}function ud(F,O,J,ae,pe,xe,be,je,Se){var Te=[0],Ve=[0],it=0,Ie=Se!=null?Se.kd:0,Ge=Se??new vt;if(F==null||12>J)return 7;Ge.data=F,Ge.w=O,Ge.ha=J,O=[O],J=[J],Ge.gb=[Ge.gb];e:{var at=O,dt=J,st=Ge.gb;if(t(F!=null),t(dt!=null),t(st!=null),st[0]=0,12<=dt[0]&&!r(F,at[0],"RIFF")){if(r(F,at[0]+8,"WEBP")){st=3;break e}var ut=ne(F,at[0]+4);if(12>ut||4294967286<ut){st=3;break e}if(Ie&&ut>dt[0]-8){st=7;break e}st[0]=ut,at[0]+=12,dt[0]-=12}st=0}if(st!=0)return st;for(ut=0<Ge.gb[0],J=J[0];;){e:{var pt=F;dt=O,st=J;var jt=Te,bt=Ve,Yt=at=[0];if((Kt=it=[it])[0]=0,8>st[0])st=7;else{if(!r(pt,dt[0],"VP8X")){if(ne(pt,dt[0]+4)!=10){st=3;break e}if(18>st[0]){st=7;break e}var Mt=ne(pt,dt[0]+8),pr=1+he(pt,dt[0]+12);if(2147483648<=pr*(pt=1+he(pt,dt[0]+15))){st=3;break e}Yt!=null&&(Yt[0]=Mt),jt!=null&&(jt[0]=pr),bt!=null&&(bt[0]=pt),dt[0]+=18,st[0]-=18,Kt[0]=1}st=0}}if(it=it[0],at=at[0],st!=0)return st;if(dt=!!(2&at),!ut&&it)return 3;if(xe!=null&&(xe[0]=!!(16&at)),be!=null&&(be[0]=dt),je!=null&&(je[0]=0),be=Te[0],at=Ve[0],it&&dt&&Se==null){st=0;break}if(4>J){st=7;break}if(ut&&it||!ut&&!it&&!r(F,O[0],"ALPH")){J=[J],Ge.na=[Ge.na],Ge.P=[Ge.P],Ge.Sa=[Ge.Sa];e:{Mt=F,st=O,ut=J;var Kt=Ge.gb;jt=Ge.na,bt=Ge.P,Yt=Ge.Sa,pr=22,t(Mt!=null),t(ut!=null),pt=st[0];var Sr=ut[0];for(t(jt!=null),t(Yt!=null),jt[0]=null,bt[0]=null,Yt[0]=0;;){if(st[0]=pt,ut[0]=Sr,8>Sr){st=7;break e}var ma=ne(Mt,pt+4);if(4294967286<ma){st=3;break e}var mr=8+ma+1&-2;if(pr+=mr,0<Kt&&pr>Kt){st=3;break e}if(!r(Mt,pt,"VP8 ")||!r(Mt,pt,"VP8L")){st=0;break e}if(Sr[0]<mr){st=7;break e}r(Mt,pt,"ALPH")||(jt[0]=Mt,bt[0]=pt+8,Yt[0]=ma),pt+=mr,Sr-=mr}}if(J=J[0],Ge.na=Ge.na[0],Ge.P=Ge.P[0],Ge.Sa=Ge.Sa[0],st!=0)break}J=[J],Ge.Ja=[Ge.Ja],Ge.xa=[Ge.xa];e:if(Kt=F,st=O,ut=J,jt=Ge.gb[0],bt=Ge.Ja,Yt=Ge.xa,Mt=st[0],pt=!r(Kt,Mt,"VP8 "),pr=!r(Kt,Mt,"VP8L"),t(Kt!=null),t(ut!=null),t(bt!=null),t(Yt!=null),8>ut[0])st=7;else{if(pt||pr){if(Kt=ne(Kt,Mt+4),12<=jt&&Kt>jt-12){st=3;break e}if(Ie&&Kt>ut[0]-8){st=7;break e}bt[0]=Kt,st[0]+=8,ut[0]-=8,Yt[0]=pr}else Yt[0]=5<=ut[0]&&Kt[Mt+0]==47&&!(Kt[Mt+4]>>5),bt[0]=ut[0];st=0}if(J=J[0],Ge.Ja=Ge.Ja[0],Ge.xa=Ge.xa[0],O=O[0],st!=0)break;if(4294967286<Ge.Ja)return 3;if(je==null||dt||(je[0]=Ge.xa?2:1),be=[be],at=[at],Ge.xa){if(5>J){st=7;break}je=be,Ie=at,dt=xe,F==null||5>J?F=0:5<=J&&F[O+0]==47&&!(F[O+4]>>5)?(ut=[0],Kt=[0],jt=[0],G(bt=new D,F,O,J),Ht(bt,ut,Kt,jt)?(je!=null&&(je[0]=ut[0]),Ie!=null&&(Ie[0]=Kt[0]),dt!=null&&(dt[0]=jt[0]),F=1):F=0):F=0}else{if(10>J){st=7;break}je=at,F==null||10>J||!X0(F,O+3,J-3)?F=0:(Ie=F[O+0]|F[O+1]<<8|F[O+2]<<16,dt=16383&(F[O+7]<<8|F[O+6]),F=16383&(F[O+9]<<8|F[O+8]),1&Ie||3<(Ie>>1&7)||!(Ie>>4&1)||Ie>>5>=Ge.Ja||!dt||!F?F=0:(be&&(be[0]=dt),je&&(je[0]=F),F=1))}if(!F||(be=be[0],at=at[0],it&&(Te[0]!=be||Ve[0]!=at)))return 3;Se!=null&&(Se[0]=Ge,Se.offset=O-Se.w,t(4294967286>O-Se.w),t(Se.offset==Se.ha-J));break}return st==0||st==7&&it&&Se==null?(xe!=null&&(xe[0]|=Ge.na!=null&&0<Ge.na.length),ae!=null&&(ae[0]=be),pe!=null&&(pe[0]=at),0):st}function ph(F,O,J){var ae=O.width,pe=O.height,xe=0,be=0,je=ae,Se=pe;if(O.Da=F!=null&&0<F.Da,O.Da&&(je=F.cd,Se=F.bd,xe=F.v,be=F.j,11>J||(xe&=-2,be&=-2),0>xe||0>be||0>=je||0>=Se||xe+je>ae||be+Se>pe))return 0;if(O.v=xe,O.j=be,O.va=xe+je,O.o=be+Se,O.U=je,O.T=Se,O.da=F!=null&&0<F.da,O.da){if(!de(je,Se,J=[F.ib],xe=[F.hb]))return 0;O.ib=J[0],O.hb=xe[0]}return O.ob=F!=null&&F.ob,O.Kb=F==null||!F.Sd,O.da&&(O.ob=O.ib<3*ae/4&&O.hb<3*pe/4,O.Kb=0),1}function mh(F){if(F==null)return 2;if(11>F.S){var O=F.f.RGBA;O.fb+=(F.height-1)*O.A,O.A=-O.A}else O=F.f.kb,F=F.height,O.O+=(F-1)*O.fa,O.fa=-O.fa,O.N+=(F-1>>1)*O.Ab,O.Ab=-O.Ab,O.W+=(F-1>>1)*O.Db,O.Db=-O.Db,O.F!=null&&(O.J+=(F-1)*O.lb,O.lb=-O.lb);return 0}function Yl(F,O,J,ae){if(ae==null||0>=F||0>=O)return 2;if(J!=null){if(J.Da){var pe=J.cd,xe=J.bd,be=-2&J.v,je=-2&J.j;if(0>be||0>je||0>=pe||0>=xe||be+pe>F||je+xe>O)return 2;F=pe,O=xe}if(J.da){if(!de(F,O,pe=[J.ib],xe=[J.hb]))return 2;F=pe[0],O=xe[0]}}ae.width=F,ae.height=O;e:{var Se=ae.width,Te=ae.height;if(F=ae.S,0>=Se||0>=Te||!(F>=up&&13>F))F=2;else{if(0>=ae.Rd&&ae.sd==null){be=xe=pe=O=0;var Ve=(je=Se*CN[F])*Te;if(11>F||(xe=(Te+1)/2*(O=(Se+1)/2),F==12&&(be=(pe=Se)*Te)),(Te=i(Ve+2*xe+be))==null){F=1;break e}ae.sd=Te,11>F?((Se=ae.f.RGBA).eb=Te,Se.fb=0,Se.A=je,Se.size=Ve):((Se=ae.f.kb).y=Te,Se.O=0,Se.fa=je,Se.Fd=Ve,Se.f=Te,Se.N=0+Ve,Se.Ab=O,Se.Cd=xe,Se.ea=Te,Se.W=0+Ve+xe,Se.Db=O,Se.Ed=xe,F==12&&(Se.F=Te,Se.J=0+Ve+2*xe),Se.Tc=be,Se.lb=pe)}if(O=1,pe=ae.S,xe=ae.width,be=ae.height,pe>=up&&13>pe)if(11>pe)F=ae.f.RGBA,O&=(je=Math.abs(F.A))*(be-1)+xe<=F.size,O&=je>=xe*CN[pe],O&=F.eb!=null;else{F=ae.f.kb,je=(xe+1)/2,Ve=(be+1)/2,Se=Math.abs(F.fa),Te=Math.abs(F.Ab);var it=Math.abs(F.Db),Ie=Math.abs(F.lb),Ge=Ie*(be-1)+xe;O&=Se*(be-1)+xe<=F.Fd,O&=Te*(Ve-1)+je<=F.Cd,O=(O&=it*(Ve-1)+je<=F.Ed)&Se>=xe&Te>=je&it>=je,O&=F.y!=null,O&=F.f!=null,O&=F.ea!=null,pe==12&&(O&=Ie>=xe,O&=Ge<=F.Tc,O&=F.F!=null)}else O=0;F=O?0:2}}return F!=0||J!=null&&J.fd&&(F=mh(ae)),F}var Ad=64,Xs=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Ys=24,Jl=32,hl=8,Zl=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];we("Predictor0","PredictorAdd0"),E.Predictor0=function(){return 4278190080},E.Predictor1=function(F){return F},E.Predictor2=function(F,O,J){return O[J+0]},E.Predictor3=function(F,O,J){return O[J+1]},E.Predictor4=function(F,O,J){return O[J-1]},E.Predictor5=function(F,O,J){return Re(Re(F,O[J+1]),O[J+0])},E.Predictor6=function(F,O,J){return Re(F,O[J-1])},E.Predictor7=function(F,O,J){return Re(F,O[J+0])},E.Predictor8=function(F,O,J){return Re(O[J-1],O[J+0])},E.Predictor9=function(F,O,J){return Re(O[J+0],O[J+1])},E.Predictor10=function(F,O,J){return Re(Re(F,O[J-1]),Re(O[J+0],O[J+1]))},E.Predictor11=function(F,O,J){var ae=O[J+0];return 0>=Be(ae>>24&255,F>>24&255,(O=O[J-1])>>24&255)+Be(ae>>16&255,F>>16&255,O>>16&255)+Be(ae>>8&255,F>>8&255,O>>8&255)+Be(255&ae,255&F,255&O)?ae:F},E.Predictor12=function(F,O,J){var ae=O[J+0];return(et((F>>24&255)+(ae>>24&255)-((O=O[J-1])>>24&255))<<24|et((F>>16&255)+(ae>>16&255)-(O>>16&255))<<16|et((F>>8&255)+(ae>>8&255)-(O>>8&255))<<8|et((255&F)+(255&ae)-(255&O)))>>>0},E.Predictor13=function(F,O,J){var ae=O[J-1];return(Ye((F=Re(F,O[J+0]))>>24&255,ae>>24&255)<<24|Ye(F>>16&255,ae>>16&255)<<16|Ye(F>>8&255,ae>>8&255)<<8|Ye(255&F,255&ae))>>>0};var gh=E.PredictorAdd0;E.PredictorAdd1=Fe,we("Predictor2","PredictorAdd2"),we("Predictor3","PredictorAdd3"),we("Predictor4","PredictorAdd4"),we("Predictor5","PredictorAdd5"),we("Predictor6","PredictorAdd6"),we("Predictor7","PredictorAdd7"),we("Predictor8","PredictorAdd8"),we("Predictor9","PredictorAdd9"),we("Predictor10","PredictorAdd10"),we("Predictor11","PredictorAdd11"),we("Predictor12","PredictorAdd12"),we("Predictor13","PredictorAdd13");var bu=E.PredictorAdd2;qe("ColorIndexInverseTransform","MapARGB","32b",function(F){return F>>8&255},function(F){return F}),qe("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(F){return F},function(F){return F>>8&255});var Qn,lp=E.ColorIndexInverseTransform,Co=E.MapARGB,So=E.VP8LColorIndexInverseTransformAlpha,xh=E.MapAlpha,yh=E.VP8LPredictorsAdd=[];yh.length=16,(E.VP8LPredictors=[]).length=16,(E.VP8LPredictorsAdd_C=[]).length=16,(E.VP8LPredictors_C=[]).length=16;var vh,bh,ec,tc,rc,hd,nc,fd,Ni,Bo,Mr,en,Hn,pa,fl,_h,_u,cp,rN,nN,aN,sN,iN,oN,wh,lN,cN,dN,uN=i(511),AN=i(2041),hN=i(225),fN=i(767),pN=0,Ey=AN,dp=hN,Js=fN,ji=uN,up=0,Ap=1,mN=2,hp=3,fp=4,Fy=5,gN=6,Ty=7,Iy=8,pp=9,Dy=10,AD=[2,3,7],hD=[3,3,11],xN=[280,256,256,256,40],fD=[0,1,1,1,0],pD=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],mD=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],gD=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],xD=8,Ly=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Py=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Nh=null,yD=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],vD=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],yN=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],bD=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],_D=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],wD=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],ND=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],ac=[],Yi=[],pl=[],jD=1,vN=2,sc=[],ki=[];ul("UpsampleRgbLinePair",Xl,3),ul("UpsampleBgrLinePair",Pa,3),ul("UpsampleRgbaLinePair",gs,4),ul("UpsampleBgraLinePair",fh,4),ul("UpsampleArgbLinePair",hh,4),ul("UpsampleRgba4444LinePair",dd,2),ul("UpsampleRgb565LinePair",cd,2);var kD=E.UpsampleRgbLinePair,CD=E.UpsampleBgrLinePair,bN=E.UpsampleRgbaLinePair,_N=E.UpsampleBgraLinePair,wN=E.UpsampleArgbLinePair,NN=E.UpsampleRgba4444LinePair,SD=E.UpsampleRgb565LinePair,mp=16,gp=1<<mp-1,jh=-227,Oy=482,BD=6,jN=0,ED=i(256),FD=i(256),TD=i(256),ID=i(256),DD=i(Oy-jh),LD=i(Oy-jh);Al("YuvToRgbRow",Xl,3),Al("YuvToBgrRow",Pa,3),Al("YuvToRgbaRow",gs,4),Al("YuvToBgraRow",fh,4),Al("YuvToArgbRow",hh,4),Al("YuvToRgba4444Row",dd,2),Al("YuvToRgb565Row",cd,2);var kN=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],xp=[0,2,8],PD=[8,7,6,4,4,2,2,2,1,1,1,1],OD=1;this.WebPDecodeRGBA=function(F,O,J,ae,pe){var xe=Ap,be=new ft,je=new Et;be.ba=je,je.S=xe,je.width=[je.width],je.height=[je.height];var Se=je.width,Te=je.height,Ve=new It;if(Ve==null||F==null)var it=2;else t(Ve!=null),it=ud(F,O,J,Ve.width,Ve.height,Ve.Pd,Ve.Qd,Ve.format,null);if(it!=0?Se=0:(Se!=null&&(Se[0]=Ve.width[0]),Te!=null&&(Te[0]=Ve.height[0]),Se=1),Se){je.width=je.width[0],je.height=je.height[0],ae!=null&&(ae[0]=je.width),pe!=null&&(pe[0]=je.height);e:{if(ae=new fu,(pe=new vt).data=F,pe.w=O,pe.ha=J,pe.kd=1,O=[0],t(pe!=null),((F=ud(pe.data,pe.w,pe.ha,null,null,null,O,null,pe))==0||F==7)&&O[0]&&(F=4),(O=F)==0){if(t(be!=null),ae.data=pe.data,ae.w=pe.w+pe.offset,ae.ha=pe.ha-pe.offset,ae.put=ht,ae.ac=wt,ae.bc=Ft,ae.ma=be,pe.xa){if((F=Ke())==null){be=1;break e}if(function(Ie,Ge){var at=[0],dt=[0],st=[0];t:for(;;){if(Ie==null)return 0;if(Ge==null)return Ie.a=2,0;if(Ie.l=Ge,Ie.a=0,G(Ie.m,Ge.data,Ge.w,Ge.ha),!Ht(Ie.m,at,dt,st)){Ie.a=3;break t}if(Ie.xb=vN,Ge.width=at[0],Ge.height=dt[0],!Xe(at[0],dt[0],1,Ie,null))break t;return 1}return t(Ie.a!=0),0}(F,ae)){if(ae=(O=Yl(ae.width,ae.height,be.Oa,be.ba))==0){t:{ae=F;r:for(;;){if(ae==null){ae=0;break t}if(t(ae.s.yc!=null),t(ae.s.Ya!=null),t(0<ae.s.Wb),t((J=ae.l)!=null),t((pe=J.ma)!=null),ae.xb!=0){if(ae.ca=pe.ba,ae.tb=pe.tb,t(ae.ca!=null),!ph(pe.Oa,J,hp)){ae.a=2;break r}if(!Me(ae,J.width)||J.da)break r;if((J.da||gt(ae.ca.S))&&Xi(),11>ae.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),ae.ca.f.kb.F!=null&&Xi()),ae.Pb&&0<ae.s.ua&&ae.s.vb.X==null&&!te(ae.s.vb,ae.s.Wa.Xa)){ae.a=1;break r}ae.xb=0}if(!Pe(ae,ae.V,ae.Ba,ae.c,ae.i,J.o,Ae))break r;pe.Dc=ae.Ma,ae=1;break t}t(ae.a!=0),ae=0}ae=!ae}ae&&(O=F.a)}else O=F.a}else{if((F=new py)==null){be=1;break e}if(F.Fa=pe.na,F.P=pe.P,F.qc=pe.Sa,jo(F,ae)){if((O=Yl(ae.width,ae.height,be.Oa,be.ba))==0){if(F.Aa=0,J=be.Oa,t((pe=F)!=null),J!=null){if(0<(Se=0>(Se=J.Md)?0:100<Se?255:255*Se/100)){for(Te=Ve=0;4>Te;++Te)12>(it=pe.pb[Te]).lc&&(it.ia=Se*PD[0>it.lc?0:it.lc]>>3),Ve|=it.ia;Ve&&(alert("todo:VP8InitRandom"),pe.ia=1)}pe.Ga=J.Id,100<pe.Ga?pe.Ga=100:0>pe.Ga&&(pe.Ga=0)}(function(Ie,Ge){if(Ie==null)return 0;if(Ge==null)return ta(Ie,2,"NULL VP8Io parameter in VP8Decode().");if(!Ie.cb&&!jo(Ie,Ge))return 0;if(t(Ie.cb),Ge.ac==null||Ge.ac(Ge)){Ge.ob&&(Ie.L=0);var at=xp[Ie.L];if(Ie.L==2?(Ie.yb=0,Ie.zb=0):(Ie.yb=Ge.v-at>>4,Ie.zb=Ge.j-at>>4,0>Ie.yb&&(Ie.yb=0),0>Ie.zb&&(Ie.zb=0)),Ie.Va=Ge.o+15+at>>4,Ie.Hb=Ge.va+15+at>>4,Ie.Hb>Ie.za&&(Ie.Hb=Ie.za),Ie.Va>Ie.Ub&&(Ie.Va=Ie.Ub),0<Ie.L){var dt=Ie.ed;for(at=0;4>at;++at){var st;if(Ie.Qa.Cb){var ut=Ie.Qa.Lb[at];Ie.Qa.Fb||(ut+=dt.Tb)}else ut=dt.Tb;for(st=0;1>=st;++st){var pt=Ie.gd[at][st],jt=ut;if(dt.Pc&&(jt+=dt.vd[0],st&&(jt+=dt.od[0])),0<(jt=0>jt?0:63<jt?63:jt)){var bt=jt;0<dt.wb&&(bt=4<dt.wb?bt>>2:bt>>1)>9-dt.wb&&(bt=9-dt.wb),1>bt&&(bt=1),pt.dd=bt,pt.tc=2*jt+bt,pt.ld=40<=jt?2:15<=jt?1:0}else pt.tc=0;pt.La=st}}}at=0}else ta(Ie,6,"Frame setup failed"),at=Ie.a;if(at=at==0){if(at){Ie.$c=0,0<Ie.Aa||(Ie.Ic=OD);t:{at=Ie.Ic,dt=4*(bt=Ie.za);var Yt=32*bt,Mt=bt+1,pr=0<Ie.L?bt*(0<Ie.Aa?2:1):0,Kt=(Ie.Aa==2?2:1)*bt;if((pt=dt+832+(st=3*(16*at+xp[Ie.L])/2*Yt)+(ut=Ie.Fa!=null&&0<Ie.Fa.length?Ie.Kc.c*Ie.Kc.i:0))!=pt)at=0;else{if(pt>Ie.Vb){if(Ie.Vb=0,Ie.Ec=i(pt),Ie.Fc=0,Ie.Ec==null){at=ta(Ie,1,"no memory during frame initialization.");break t}Ie.Vb=pt}pt=Ie.Ec,jt=Ie.Fc,Ie.Ac=pt,Ie.Bc=jt,jt+=dt,Ie.Gd=o(Yt,Hr),Ie.Hd=0,Ie.rb=o(Mt+1,Pt),Ie.sb=1,Ie.wa=pr?o(pr,$t):null,Ie.Y=0,Ie.D.Nb=0,Ie.D.wa=Ie.wa,Ie.D.Y=Ie.Y,0<Ie.Aa&&(Ie.D.Y+=bt),t(!0),Ie.oc=pt,Ie.pc=jt,jt+=832,Ie.ya=o(Kt,tr),Ie.aa=0,Ie.D.ya=Ie.ya,Ie.D.aa=Ie.aa,Ie.Aa==2&&(Ie.D.aa+=bt),Ie.R=16*bt,Ie.B=8*bt,bt=(Yt=xp[Ie.L])*Ie.R,Yt=Yt/2*Ie.B,Ie.sa=pt,Ie.ta=jt+bt,Ie.qa=Ie.sa,Ie.ra=Ie.ta+16*at*Ie.R+Yt,Ie.Ha=Ie.qa,Ie.Ia=Ie.ra+8*at*Ie.B+Yt,Ie.$c=0,jt+=st,Ie.mb=ut?pt:null,Ie.nb=ut?jt:null,t(jt+ut<=Ie.Fc+Ie.Vb),Y0(Ie),s(Ie.Ac,Ie.Bc,0,dt),at=1}}if(at){if(Ge.ka=0,Ge.y=Ie.sa,Ge.O=Ie.ta,Ge.f=Ie.qa,Ge.N=Ie.ra,Ge.ea=Ie.Ha,Ge.Vd=Ie.Ia,Ge.fa=Ie.R,Ge.Rc=Ie.B,Ge.F=null,Ge.J=0,!pN){for(at=-255;255>=at;++at)uN[255+at]=0>at?-at:at;for(at=-1020;1020>=at;++at)AN[1020+at]=-128>at?-128:127<at?127:at;for(at=-112;112>=at;++at)hN[112+at]=-16>at?-16:15<at?15:at;for(at=-255;510>=at;++at)fN[255+at]=0>at?0:255<at?255:at;pN=1}nc=mu,fd=gy,Bo=ko,Mr=Z0,en=ep,Ni=my,Hn=sp,pa=id,fl=fe,_h=De,_u=ip,cp=X,rN=He,nN=Ze,aN=sd,sN=uh,iN=np,oN=ap,Yi[0]=jy,Yi[1]=xy,Yi[2]=wy,Yi[3]=Ny,Yi[4]=al,Yi[5]=ky,Yi[6]=sl,Yi[7]=Cy,Yi[8]=ih,Yi[9]=gu,ac[0]=by,ac[1]=vy,ac[2]=ah,ac[3]=tp,ac[4]=nd,ac[5]=sh,ac[6]=_y,pl[0]=By,pl[1]=yy,pl[2]=ad,pl[3]=Sy,pl[4]=lh,pl[5]=oh,pl[6]=rp,at=1}else at=0}at&&(at=function(Sr,ma){for(Sr.M=0;Sr.M<Sr.Va;++Sr.M){var mr,Vt=Sr.Jc[Sr.M&Sr.Xb],Tt=Sr.m,qn=Sr;for(mr=0;mr<qn.za;++mr){var Ar=Tt,Br=qn,dn=Br.Ac,Oa=Br.Bc+4*mr,xs=Br.zc,Tn=Br.ya[Br.aa+mr];if(Br.Qa.Bb?Tn.$b=M(Ar,Br.Pa.jb[0])?2+M(Ar,Br.Pa.jb[2]):M(Ar,Br.Pa.jb[1]):Tn.$b=0,Br.kc&&(Tn.Ad=M(Ar,Br.Bd)),Tn.Za=!M(Ar,145)+0,Tn.Za){var Ya=Tn.Ob,ys=0;for(Br=0;4>Br;++Br){var ga,Tr=xs[0+Br];for(ga=0;4>ga;++ga){Tr=_D[dn[Oa+ga]][Tr];for(var qr=yN[M(Ar,Tr[0])];0<qr;)qr=yN[2*qr+M(Ar,Tr[qr])];Tr=-qr,dn[Oa+ga]=Tr}a(Ya,ys,dn,Oa,4),ys+=4,xs[0+Br]=Tr}}else Tr=M(Ar,156)?M(Ar,128)?1:3:M(Ar,163)?2:0,Tn.Ob[0]=Tr,s(dn,Oa,Tr,4),s(xs,0,Tr,4);Tn.Dd=M(Ar,142)?M(Ar,114)?M(Ar,183)?1:3:2:0}if(qn.m.Ka)return ta(Sr,7,"Premature end-of-partition0 encountered.");for(;Sr.ja<Sr.za;++Sr.ja){if(qn=Vt,Ar=(Tt=Sr).rb[Tt.sb-1],dn=Tt.rb[Tt.sb+Tt.ja],mr=Tt.ya[Tt.aa+Tt.ja],Oa=Tt.kc?mr.Ad:0)Ar.la=dn.la=0,mr.Za||(Ar.Na=dn.Na=0),mr.Hc=0,mr.Gc=0,mr.ia=0;else{var In,$r;if(Ar=dn,dn=qn,Oa=Tt.Pa.Xc,xs=Tt.ya[Tt.aa+Tt.ja],Tn=Tt.pb[xs.$b],Br=xs.ad,Ya=0,ys=Tt.rb[Tt.sb-1],Tr=ga=0,s(Br,Ya,0,384),xs.Za)var Ua=0,Ji=Oa[3];else{qr=i(16);var $n=Ar.Na+ys.Na;if($n=Nh(dn,Oa[1],$n,Tn.Eb,0,qr,0),Ar.Na=ys.Na=(0<$n)+0,1<$n)nc(qr,0,Br,Ya);else{var Ps=qr[0]+3>>3;for(qr=0;256>qr;qr+=16)Br[Ya+qr]=Ps}Ua=1,Ji=Oa[0]}var tn=15&Ar.la,xa=15&ys.la;for(qr=0;4>qr;++qr){var Zs=1&xa;for(Ps=$r=0;4>Ps;++Ps)tn=tn>>1|(Zs=($n=Nh(dn,Ji,$n=Zs+(1&tn),Tn.Sc,Ua,Br,Ya))>Ua)<<7,$r=$r<<2|(3<$n?3:1<$n?2:Br[Ya+0]!=0),Ya+=16;tn>>=4,xa=xa>>1|Zs<<7,ga=(ga<<8|$r)>>>0}for(Ji=tn,Ua=xa>>4,In=0;4>In;In+=2){for($r=0,tn=Ar.la>>4+In,xa=ys.la>>4+In,qr=0;2>qr;++qr){for(Zs=1&xa,Ps=0;2>Ps;++Ps)$n=Zs+(1&tn),tn=tn>>1|(Zs=0<($n=Nh(dn,Oa[2],$n,Tn.Qc,0,Br,Ya)))<<3,$r=$r<<2|(3<$n?3:1<$n?2:Br[Ya+0]!=0),Ya+=16;tn>>=2,xa=xa>>1|Zs<<5}Tr|=$r<<4*In,Ji|=tn<<4<<In,Ua|=(240&xa)<<In}Ar.la=Ji,ys.la=Ua,xs.Hc=ga,xs.Gc=Tr,xs.ia=43690&Tr?0:Tn.ia,Oa=!(ga|Tr)}if(0<Tt.L&&(Tt.wa[Tt.Y+Tt.ja]=Tt.gd[mr.$b][mr.Za],Tt.wa[Tt.Y+Tt.ja].La|=!Oa),qn.Ka)return ta(Sr,7,"Premature end-of-file encountered.")}if(Y0(Sr),Tt=ma,qn=1,mr=(Vt=Sr).D,Ar=0<Vt.L&&Vt.M>=Vt.zb&&Vt.M<=Vt.Va,Vt.Aa==0)t:{if(mr.M=Vt.M,mr.uc=Ar,wi(Vt,mr),qn=1,mr=($r=Vt.D).Nb,Ar=(Tr=xp[Vt.L])*Vt.R,dn=Tr/2*Vt.B,qr=16*mr*Vt.R,Ps=8*mr*Vt.B,Oa=Vt.sa,xs=Vt.ta-Ar+qr,Tn=Vt.qa,Br=Vt.ra-dn+Ps,Ya=Vt.Ha,ys=Vt.Ia-dn+Ps,xa=(tn=$r.M)==0,ga=tn>=Vt.Va-1,Vt.Aa==2&&wi(Vt,$r),$r.uc)for(Zs=($n=Vt).D.M,t($n.D.uc),$r=$n.yb;$r<$n.Hb;++$r){Ua=$r,Ji=Zs;var vs=(ei=(Ra=$n).D).Nb;In=Ra.R;var ei=ei.wa[ei.Y+Ua],ti=Ra.sa,Os=Ra.ta+16*vs*In+16*Ua,ri=ei.dd,an=ei.tc;if(an!=0)if(t(3<=an),Ra.L==1)0<Ua&&sN(ti,Os,In,an+4),ei.La&&oN(ti,Os,In,an),0<Ji&&aN(ti,Os,In,an+4),ei.La&&iN(ti,Os,In,an);else{var ni=Ra.B,Zi=Ra.qa,pd=Ra.ra+8*vs*ni+8*Ua,ml=Ra.Ha,Ra=Ra.Ia+8*vs*ni+8*Ua;vs=ei.ld,0<Ua&&(pa(ti,Os,In,an+4,ri,vs),_h(Zi,pd,ml,Ra,ni,an+4,ri,vs)),ei.La&&(cp(ti,Os,In,an,ri,vs),nN(Zi,pd,ml,Ra,ni,an,ri,vs)),0<Ji&&(Hn(ti,Os,In,an+4,ri,vs),fl(Zi,pd,ml,Ra,ni,an+4,ri,vs)),ei.La&&(_u(ti,Os,In,an,ri,vs),rN(Zi,pd,ml,Ra,ni,an,ri,vs))}}if(Vt.ia&&alert("todo:DitherRow"),Tt.put!=null){if($r=16*tn,tn=16*(tn+1),xa?(Tt.y=Vt.sa,Tt.O=Vt.ta+qr,Tt.f=Vt.qa,Tt.N=Vt.ra+Ps,Tt.ea=Vt.Ha,Tt.W=Vt.Ia+Ps):($r-=Tr,Tt.y=Oa,Tt.O=xs,Tt.f=Tn,Tt.N=Br,Tt.ea=Ya,Tt.W=ys),ga||(tn-=Tr),tn>Tt.o&&(tn=Tt.o),Tt.F=null,Tt.J=null,Vt.Fa!=null&&0<Vt.Fa.length&&$r<tn&&(Tt.J=nn(Vt,Tt,$r,tn-$r),Tt.F=Vt.mb,Tt.F==null&&Tt.F.length==0)){qn=ta(Vt,3,"Could not decode alpha data.");break t}$r<Tt.j&&(Tr=Tt.j-$r,$r=Tt.j,t(!(1&Tr)),Tt.O+=Vt.R*Tr,Tt.N+=Vt.B*(Tr>>1),Tt.W+=Vt.B*(Tr>>1),Tt.F!=null&&(Tt.J+=Tt.width*Tr)),$r<tn&&(Tt.O+=Tt.v,Tt.N+=Tt.v>>1,Tt.W+=Tt.v>>1,Tt.F!=null&&(Tt.J+=Tt.v),Tt.ka=$r-Tt.j,Tt.U=Tt.va-Tt.v,Tt.T=tn-$r,qn=Tt.put(Tt))}mr+1!=Vt.Ic||ga||(a(Vt.sa,Vt.ta-Ar,Oa,xs+16*Vt.R,Ar),a(Vt.qa,Vt.ra-dn,Tn,Br+8*Vt.B,dn),a(Vt.Ha,Vt.Ia-dn,Ya,ys+8*Vt.B,dn))}if(!qn)return ta(Sr,6,"Output aborted.")}return 1}(Ie,Ge)),Ge.bc!=null&&Ge.bc(Ge),at&=1}return at?(Ie.cb=0,at):0})(F,ae)||(O=F.a)}}else O=F.a}O==0&&be.Oa!=null&&be.Oa.fd&&(O=mh(be.ba))}be=O}xe=be!=0?null:11>xe?je.f.RGBA.eb:je.f.kb.y}else xe=null;return xe};var CN=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function d(E,C){for(var k="",w=0;w<4;w++)k+=String.fromCharCode(E[C++]);return k}function u(E,C){return E[C+0]|E[C+1]<<8}function f(E,C){return(E[C+0]|E[C+1]<<8|E[C+2]<<16)>>>0}function h(E,C){return(E[C+0]|E[C+1]<<8|E[C+2]<<16|E[C+3]<<24)>>>0}new c;var A=[0],x=[0],p=[],b=new c,m=e,g=function(E,C){var k={},w=0,T=!1,R=0,q=0;if(k.frames=[],!function(S,D){for(var L=0;L<4;L++)if(S[D+L]!="RIFF".charCodeAt(L))return!0;return!1}(E,C)){for(h(E,C+=4),C+=8;C<E.length;){var z=d(E,C),ee=h(E,C+=4);C+=4;var Y=ee+(1&ee);switch(z){case"VP8 ":case"VP8L":k.frames[w]===void 0&&(k.frames[w]={}),(U=k.frames[w]).src_off=T?q:C-8,U.src_size=R+ee+8,w++,T&&(T=!1,R=0,q=0);break;case"VP8X":(U=k.header={}).feature_flags=E[C];var G=C+4;U.canvas_width=1+f(E,G),G+=3,U.canvas_height=1+f(E,G),G+=3;break;case"ALPH":T=!0,R=Y+8,q=C-8;break;case"ANIM":(U=k.header).bgcolor=h(E,C),G=C+4,U.loop_count=u(E,G),G+=2;break;case"ANMF":var re,U;(U=k.frames[w]={}).offset_x=2*f(E,C),C+=3,U.offset_y=2*f(E,C),C+=3,U.width=1+f(E,C),C+=3,U.height=1+f(E,C),C+=3,U.duration=f(E,C),C+=3,re=E[C++],U.dispose=1&re,U.blend=re>>1&1}z!="ANMF"&&(C+=Y)}return k}}(m,0);g.response=m,g.rgbaoutput=!0,g.dataurl=!1;var y=g.header?g.header:null,v=g.frames?g.frames:null;if(y){y.loop_counter=y.loop_count,A=[y.canvas_height],x=[y.canvas_width];for(var _=0;_<v.length&&v[_].blend!=0;_++);}var j=v[0],N=b.WebPDecodeRGBA(m,j.src_off,j.src_size,x,A);j.rgba=N,j.imgwidth=x[0],j.imgheight=A[0];for(var B=0;B<x[0]*A[0]*4;B++)p[B]=N[B];return this.width=x,this.height=A,this.data=p,this}(function(e){var t,r,a,s,i,o,l,c,d,u=function(S){return S=S||{},this.isStrokeTransparent=S.isStrokeTransparent||!1,this.strokeOpacity=S.strokeOpacity||1,this.strokeStyle=S.strokeStyle||"#000000",this.fillStyle=S.fillStyle||"#000000",this.isFillTransparent=S.isFillTransparent||!1,this.fillOpacity=S.fillOpacity||1,this.font=S.font||"10px sans-serif",this.textBaseline=S.textBaseline||"alphabetic",this.textAlign=S.textAlign||"left",this.lineWidth=S.lineWidth||1,this.lineJoin=S.lineJoin||"miter",this.lineCap=S.lineCap||"butt",this.path=S.path||[],this.transform=S.transform!==void 0?S.transform.clone():new c,this.globalCompositeOperation=S.globalCompositeOperation||"normal",this.globalAlpha=S.globalAlpha||1,this.clip_path=S.clip_path||[],this.currentPoint=S.currentPoint||new o,this.miterLimit=S.miterLimit||10,this.lastPoint=S.lastPoint||new o,this.lineDashOffset=S.lineDashOffset||0,this.lineDash=S.lineDash||[],this.margin=S.margin||[0,0,0,0],this.prevPageLastElemOffset=S.prevPageLastElemOffset||0,this.ignoreClearRect=typeof S.ignoreClearRect!="boolean"||S.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new f(this),t=this.internal.f2,r=this.internal.getCoordinateString,a=this.internal.getVerticalCoordinateString,s=this.internal.getHorizontalCoordinate,i=this.internal.getVerticalCoordinate,o=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,d=new u}]);var f=function(S){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var D=S;Object.defineProperty(this,"pdf",{get:function(){return D}});var L=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return L},set:function(te){L=!!te}});var P=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return P},set:function(te){P=!!te}});var I=0;Object.defineProperty(this,"posX",{get:function(){return I},set:function(te){isNaN(te)||(I=te)}});var H=0;Object.defineProperty(this,"posY",{get:function(){return H},set:function(te){isNaN(te)||(H=te)}}),Object.defineProperty(this,"margin",{get:function(){return d.margin},set:function(te){var ce;typeof te=="number"?ce=[te,te,te,te]:((ce=new Array(4))[0]=te[0],ce[1]=te.length>=2?te[1]:ce[0],ce[2]=te.length>=3?te[2]:ce[0],ce[3]=te.length>=4?te[3]:ce[1]),d.margin=ce}});var V=!1;Object.defineProperty(this,"autoPaging",{get:function(){return V},set:function(te){V=te}});var W=0;Object.defineProperty(this,"lastBreak",{get:function(){return W},set:function(te){W=te}});var M=[];Object.defineProperty(this,"pageBreaks",{get:function(){return M},set:function(te){M=te}}),Object.defineProperty(this,"ctx",{get:function(){return d},set:function(te){te instanceof u&&(d=te)}}),Object.defineProperty(this,"path",{get:function(){return d.path},set:function(te){d.path=te}});var se=[];Object.defineProperty(this,"ctxStack",{get:function(){return se},set:function(te){se=te}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(te){var ce;ce=h(te),this.ctx.fillStyle=ce.style,this.ctx.isFillTransparent=ce.a===0,this.ctx.fillOpacity=ce.a,this.pdf.setFillColor(ce.r,ce.g,ce.b,{a:ce.a}),this.pdf.setTextColor(ce.r,ce.g,ce.b,{a:ce.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(te){var ce=h(te);this.ctx.strokeStyle=ce.style,this.ctx.isStrokeTransparent=ce.a===0,this.ctx.strokeOpacity=ce.a,ce.a===0?this.pdf.setDrawColor(255,255,255):(ce.a,this.pdf.setDrawColor(ce.r,ce.g,ce.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(te){["butt","round","square"].indexOf(te)!==-1&&(this.ctx.lineCap=te,this.pdf.setLineCap(te))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(te){isNaN(te)||(this.ctx.lineWidth=te,this.pdf.setLineWidth(te))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(te){["bevel","round","miter"].indexOf(te)!==-1&&(this.ctx.lineJoin=te,this.pdf.setLineJoin(te))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(te){isNaN(te)||(this.ctx.miterLimit=te,this.pdf.setMiterLimit(te))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(te){this.ctx.textBaseline=te}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(te){["right","end","center","left","start"].indexOf(te)!==-1&&(this.ctx.textAlign=te)}});var K=null,he=null,ne=null;Object.defineProperty(this,"fontFaces",{get:function(){return ne},set:function(te){K=null,he=null,ne=te}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(te){var ce;if(this.ctx.font=te,(ce=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(te))!==null){var _e=ce[1];ce[2];var de=ce[3],ye=ce[4];ce[5];var Le=ce[6],we=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(ye)[2];ye=Math.floor(we==="px"?parseFloat(ye)*this.pdf.internal.scaleFactor:we==="em"?parseFloat(ye)*this.pdf.getFontSize():parseFloat(ye)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(ye);var ge=function(qe){var $e,Ne,Ee=[],ze=qe.trim();if(ze==="")return zv;if(ze in C4)return[C4[ze]];for(;ze!=="";){switch(Ne=null,$e=(ze=B4(ze)).charAt(0)){case'"':case"'":Ne=pM(ze.substring(1),$e);break;default:Ne=mM(ze)}if(Ne===null||(Ee.push(Ne[0]),(ze=B4(Ne[1]))!==""&&ze.charAt(0)!==","))return zv;ze=ze.replace(/^,/,"")}return Ee}(Le);if(this.fontFaces){var Re=function(qe,$e){var Ne=qe.getFontList(),Ee=JSON.stringify(Ne);if(K===null||he!==Ee){var ze=function(rt){var nt=[];return Object.keys(rt).forEach(function(mt){rt[mt].forEach(function(gt){var Nt=null;switch(gt){case"bold":Nt={family:mt,weight:"bold"};break;case"italic":Nt={family:mt,style:"italic"};break;case"bolditalic":Nt={family:mt,weight:"bold",style:"italic"};break;case"":case"normal":Nt={family:mt}}Nt!==null&&(Nt.ref={name:mt,style:gt},nt.push(Nt))})}),nt}(Ne);K=function(rt){for(var nt={},mt=0;mt<rt.length;++mt){var gt=Wv(rt[mt]),Nt=gt.family,yt=gt.stretch,Et=gt.style,It=gt.weight;nt[Nt]=nt[Nt]||{},nt[Nt][yt]=nt[Nt][yt]||{},nt[Nt][yt][Et]=nt[Nt][yt][Et]||{},nt[Nt][yt][Et][It]=gt}return nt}(ze.concat($e)),he=Ee}return K}(this.pdf,this.fontFaces),et=ge.map(function(qe){return{family:qe,stretch:"normal",weight:de,style:_e}}),Ye=function(qe,$e,Ne){for(var Ee=(Ne=Ne||{}).defaultFontFamily||"times",ze=Object.assign({},fM,Ne.genericFontFamilies||{}),rt=null,nt=null,mt=0;mt<$e.length;++mt)if(ze[(rt=Wv($e[mt])).family]&&(rt.family=ze[rt.family]),qe.hasOwnProperty(rt.family)){nt=qe[rt.family];break}if(!(nt=nt||qe[Ee]))throw new Error("Could not find a font-family for the rule '"+S4(rt)+"' and default family '"+Ee+"'.");if(nt=function(gt,Nt){if(Nt[gt])return Nt[gt];var yt=h_[gt],Et=yt<=h_.normal?-1:1,It=k4(Nt,_6,yt,Et);if(!It)throw new Error("Could not find a matching font-stretch value for "+gt);return It}(rt.stretch,nt),nt=function(gt,Nt){if(Nt[gt])return Nt[gt];for(var yt=b6[gt],Et=0;Et<yt.length;++Et)if(Nt[yt[Et]])return Nt[yt[Et]];throw new Error("Could not find a matching font-style for "+gt)}(rt.style,nt),!(nt=function(gt,Nt){if(Nt[gt])return Nt[gt];if(gt===400&&Nt[500])return Nt[500];if(gt===500&&Nt[400])return Nt[400];var yt=hM[gt],Et=k4(Nt,w6,yt,gt<400?-1:1);if(!Et)throw new Error("Could not find a matching font-weight for value "+gt);return Et}(rt.weight,nt)))throw new Error("Failed to resolve a font for the rule '"+S4(rt)+"'.");return nt}(Re,et);this.pdf.setFont(Ye.ref.name,Ye.ref.style)}else{var Be="";(de==="bold"||parseInt(de,10)>=700||_e==="bold")&&(Be="bold"),_e==="italic"&&(Be+="italic"),Be.length===0&&(Be="normal");for(var Fe="",oe={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},ke=0;ke<ge.length;ke++){if(this.pdf.internal.getFont(ge[ke],Be,{noFallback:!0,disableWarning:!0})!==void 0){Fe=ge[ke];break}if(Be==="bolditalic"&&this.pdf.internal.getFont(ge[ke],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Fe=ge[ke],Be="bold";else if(this.pdf.internal.getFont(ge[ke],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Fe=ge[ke],Be="normal";break}}if(Fe===""){for(var Ue=0;Ue<ge.length;Ue++)if(oe[ge[Ue]]){Fe=oe[ge[Ue]];break}}Fe=Fe===""?"Times":Fe,this.pdf.setFont(Fe,Be)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(te){this.ctx.globalCompositeOperation=te}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(te){this.ctx.globalAlpha=te}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(te){this.ctx.lineDashOffset=te,U.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(te){this.ctx.lineDash=te,U.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(te){this.ctx.ignoreClearRect=!!te}})};f.prototype.setLineDash=function(S){this.lineDash=S},f.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},f.prototype.fill=function(){v.call(this,"fill",!1)},f.prototype.stroke=function(){v.call(this,"stroke",!1)},f.prototype.beginPath=function(){this.path=[{type:"begin"}]},f.prototype.moveTo=function(S,D){if(isNaN(S)||isNaN(D))throw rn.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var L=this.ctx.transform.applyToPoint(new o(S,D));this.path.push({type:"mt",x:L.x,y:L.y}),this.ctx.lastPoint=new o(S,D)},f.prototype.closePath=function(){var S=new o(0,0),D=0;for(D=this.path.length-1;D!==-1;D--)if(this.path[D].type==="begin"&&zr(this.path[D+1])==="object"&&typeof this.path[D+1].x=="number"){S=new o(this.path[D+1].x,this.path[D+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(S.x,S.y)},f.prototype.lineTo=function(S,D){if(isNaN(S)||isNaN(D))throw rn.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var L=this.ctx.transform.applyToPoint(new o(S,D));this.path.push({type:"lt",x:L.x,y:L.y}),this.ctx.lastPoint=new o(L.x,L.y)},f.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),v.call(this,null,!0)},f.prototype.quadraticCurveTo=function(S,D,L,P){if(isNaN(L)||isNaN(P)||isNaN(S)||isNaN(D))throw rn.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var I=this.ctx.transform.applyToPoint(new o(L,P)),H=this.ctx.transform.applyToPoint(new o(S,D));this.path.push({type:"qct",x1:H.x,y1:H.y,x:I.x,y:I.y}),this.ctx.lastPoint=new o(I.x,I.y)},f.prototype.bezierCurveTo=function(S,D,L,P,I,H){if(isNaN(I)||isNaN(H)||isNaN(S)||isNaN(D)||isNaN(L)||isNaN(P))throw rn.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var V=this.ctx.transform.applyToPoint(new o(I,H)),W=this.ctx.transform.applyToPoint(new o(S,D)),M=this.ctx.transform.applyToPoint(new o(L,P));this.path.push({type:"bct",x1:W.x,y1:W.y,x2:M.x,y2:M.y,x:V.x,y:V.y}),this.ctx.lastPoint=new o(V.x,V.y)},f.prototype.arc=function(S,D,L,P,I,H){if(isNaN(S)||isNaN(D)||isNaN(L)||isNaN(P)||isNaN(I))throw rn.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(H=!!H,!this.ctx.transform.isIdentity){var V=this.ctx.transform.applyToPoint(new o(S,D));S=V.x,D=V.y;var W=this.ctx.transform.applyToPoint(new o(0,L)),M=this.ctx.transform.applyToPoint(new o(0,0));L=Math.sqrt(Math.pow(W.x-M.x,2)+Math.pow(W.y-M.y,2))}Math.abs(I-P)>=2*Math.PI&&(P=0,I=2*Math.PI),this.path.push({type:"arc",x:S,y:D,radius:L,startAngle:P,endAngle:I,counterclockwise:H})},f.prototype.arcTo=function(S,D,L,P,I){throw new Error("arcTo not implemented.")},f.prototype.rect=function(S,D,L,P){if(isNaN(S)||isNaN(D)||isNaN(L)||isNaN(P))throw rn.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(S,D),this.lineTo(S+L,D),this.lineTo(S+L,D+P),this.lineTo(S,D+P),this.lineTo(S,D),this.lineTo(S+L,D),this.lineTo(S,D)},f.prototype.fillRect=function(S,D,L,P){if(isNaN(S)||isNaN(D)||isNaN(L)||isNaN(P))throw rn.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!A.call(this)){var I={};this.lineCap!=="butt"&&(I.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(I.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(S,D,L,P),this.fill(),I.hasOwnProperty("lineCap")&&(this.lineCap=I.lineCap),I.hasOwnProperty("lineJoin")&&(this.lineJoin=I.lineJoin)}},f.prototype.strokeRect=function(S,D,L,P){if(isNaN(S)||isNaN(D)||isNaN(L)||isNaN(P))throw rn.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");x.call(this)||(this.beginPath(),this.rect(S,D,L,P),this.stroke())},f.prototype.clearRect=function(S,D,L,P){if(isNaN(S)||isNaN(D)||isNaN(L)||isNaN(P))throw rn.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(S,D,L,P))},f.prototype.save=function(S){S=typeof S!="boolean"||S;for(var D=this.pdf.internal.getCurrentPageInfo().pageNumber,L=0;L<this.pdf.internal.getNumberOfPages();L++)this.pdf.setPage(L+1),this.pdf.internal.out("q");if(this.pdf.setPage(D),S){this.ctx.fontSize=this.pdf.internal.getFontSize();var P=new u(this.ctx);this.ctxStack.push(this.ctx),this.ctx=P}},f.prototype.restore=function(S){S=typeof S!="boolean"||S;for(var D=this.pdf.internal.getCurrentPageInfo().pageNumber,L=0;L<this.pdf.internal.getNumberOfPages();L++)this.pdf.setPage(L+1),this.pdf.internal.out("Q");this.pdf.setPage(D),S&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},f.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var h=function(S){var D,L,P,I;if(S.isCanvasGradient===!0&&(S=S.getColor()),!S)return{r:0,g:0,b:0,a:0,style:S};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(S))D=0,L=0,P=0,I=0;else{var H=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(S);if(H!==null)D=parseInt(H[1]),L=parseInt(H[2]),P=parseInt(H[3]),I=1;else if((H=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(S))!==null)D=parseInt(H[1]),L=parseInt(H[2]),P=parseInt(H[3]),I=parseFloat(H[4]);else{if(I=1,typeof S=="string"&&S.charAt(0)!=="#"){var V=new f6(S);S=V.ok?V.toHex():"#000000"}S.length===4?(D=S.substring(1,2),D+=D,L=S.substring(2,3),L+=L,P=S.substring(3,4),P+=P):(D=S.substring(1,3),L=S.substring(3,5),P=S.substring(5,7)),D=parseInt(D,16),L=parseInt(L,16),P=parseInt(P,16)}}return{r:D,g:L,b:P,a:I,style:S}},A=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},x=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};f.prototype.fillText=function(S,D,L,P){if(isNaN(D)||isNaN(L)||typeof S!="string")throw rn.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(P=isNaN(P)?void 0:P,!A.call(this)){var I=Y(this.ctx.transform.rotation),H=this.ctx.transform.scaleX;w.call(this,{text:S,x:D,y:L,scale:H,angle:I,align:this.textAlign,maxWidth:P})}},f.prototype.strokeText=function(S,D,L,P){if(isNaN(D)||isNaN(L)||typeof S!="string")throw rn.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!x.call(this)){P=isNaN(P)?void 0:P;var I=Y(this.ctx.transform.rotation),H=this.ctx.transform.scaleX;w.call(this,{text:S,x:D,y:L,scale:H,renderingMode:"stroke",angle:I,align:this.textAlign,maxWidth:P})}},f.prototype.measureText=function(S){if(typeof S!="string")throw rn.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var D=this.pdf,L=this.pdf.internal.scaleFactor,P=D.internal.getFontSize(),I=D.getStringUnitWidth(S)*P/D.internal.scaleFactor;return new function(H){var V=(H=H||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return V}}),this}({width:I*=Math.round(96*L/72*1e4)/1e4})},f.prototype.scale=function(S,D){if(isNaN(S)||isNaN(D))throw rn.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var L=new c(S,0,0,D,0,0);this.ctx.transform=this.ctx.transform.multiply(L)},f.prototype.rotate=function(S){if(isNaN(S))throw rn.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var D=new c(Math.cos(S),Math.sin(S),-Math.sin(S),Math.cos(S),0,0);this.ctx.transform=this.ctx.transform.multiply(D)},f.prototype.translate=function(S,D){if(isNaN(S)||isNaN(D))throw rn.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var L=new c(1,0,0,1,S,D);this.ctx.transform=this.ctx.transform.multiply(L)},f.prototype.transform=function(S,D,L,P,I,H){if(isNaN(S)||isNaN(D)||isNaN(L)||isNaN(P)||isNaN(I)||isNaN(H))throw rn.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var V=new c(S,D,L,P,I,H);this.ctx.transform=this.ctx.transform.multiply(V)},f.prototype.setTransform=function(S,D,L,P,I,H){S=isNaN(S)?1:S,D=isNaN(D)?0:D,L=isNaN(L)?0:L,P=isNaN(P)?1:P,I=isNaN(I)?0:I,H=isNaN(H)?0:H,this.ctx.transform=new c(S,D,L,P,I,H)};var p=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};f.prototype.drawImage=function(S,D,L,P,I,H,V,W,M){var se=this.pdf.getImageProperties(S),K=1,he=1,ne=1,te=1;P!==void 0&&W!==void 0&&(ne=W/P,te=M/I,K=se.width/P*W/P,he=se.height/I*M/I),H===void 0&&(H=D,V=L,D=0,L=0),P!==void 0&&W===void 0&&(W=P,M=I),P===void 0&&W===void 0&&(W=se.width,M=se.height);var ce=this.ctx.transform.decompose(),_e=Y(ce.rotate.shx),de=new c,ye=(de=(de=(de=de.multiply(ce.translate)).multiply(ce.skew)).multiply(ce.scale)).applyToRectangle(new l(H-D*ne,V-L*te,P*K,I*he));if(this.autoPaging){for(var Le,we=b.call(this,ye),ge=[],Re=0;Re<we.length;Re+=1)ge.indexOf(we[Re])===-1&&ge.push(we[Re]);y(ge);for(var et=ge[0],Ye=ge[ge.length-1],Be=et;Be<Ye+1;Be++){this.pdf.setPage(Be);var Fe=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],oe=Be===1?this.posY+this.margin[0]:this.margin[0],ke=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ue=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],qe=Be===1?0:ke+(Be-2)*Ue;if(this.ctx.clip_path.length!==0){var $e=this.path;Le=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=g(Le,this.posX+this.margin[3],-qe+oe+this.ctx.prevPageLastElemOffset),_.call(this,"fill",!0),this.path=$e}var Ne=JSON.parse(JSON.stringify(ye));Ne=g([Ne],this.posX+this.margin[3],-qe+oe+this.ctx.prevPageLastElemOffset)[0];var Ee=(Be>et||Be<Ye)&&p.call(this);Ee&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Fe,Ue,null).clip().discardPath()),this.pdf.addImage(S,"JPEG",Ne.x,Ne.y,Ne.w,Ne.h,null,null,_e),Ee&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(S,"JPEG",ye.x,ye.y,ye.w,ye.h,null,null,_e)};var b=function(S,D,L){var P=[];D=D||this.pdf.internal.pageSize.width,L=L||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var I=this.posY+this.ctx.prevPageLastElemOffset;switch(S.type){default:case"mt":case"lt":P.push(Math.floor((S.y+I)/L)+1);break;case"arc":P.push(Math.floor((S.y+I-S.radius)/L)+1),P.push(Math.floor((S.y+I+S.radius)/L)+1);break;case"qct":var H=G(this.ctx.lastPoint.x,this.ctx.lastPoint.y,S.x1,S.y1,S.x,S.y);P.push(Math.floor((H.y+I)/L)+1),P.push(Math.floor((H.y+H.h+I)/L)+1);break;case"bct":var V=re(this.ctx.lastPoint.x,this.ctx.lastPoint.y,S.x1,S.y1,S.x2,S.y2,S.x,S.y);P.push(Math.floor((V.y+I)/L)+1),P.push(Math.floor((V.y+V.h+I)/L)+1);break;case"rect":P.push(Math.floor((S.y+I)/L)+1),P.push(Math.floor((S.y+S.h+I)/L)+1)}for(var W=0;W<P.length;W+=1)for(;this.pdf.internal.getNumberOfPages()<P[W];)m.call(this);return P},m=function(){var S=this.fillStyle,D=this.strokeStyle,L=this.font,P=this.lineCap,I=this.lineWidth,H=this.lineJoin;this.pdf.addPage(),this.fillStyle=S,this.strokeStyle=D,this.font=L,this.lineCap=P,this.lineWidth=I,this.lineJoin=H},g=function(S,D,L){for(var P=0;P<S.length;P++)switch(S[P].type){case"bct":S[P].x2+=D,S[P].y2+=L;case"qct":S[P].x1+=D,S[P].y1+=L;default:S[P].x+=D,S[P].y+=L}return S},y=function(S){return S.sort(function(D,L){return D-L})},v=function(S,D){var L=this.fillStyle,P=this.strokeStyle,I=this.lineCap,H=this.lineWidth,V=Math.abs(H*this.ctx.transform.scaleX),W=this.lineJoin;if(this.autoPaging){for(var M,se,K=JSON.parse(JSON.stringify(this.path)),he=JSON.parse(JSON.stringify(this.path)),ne=[],te=0;te<he.length;te++)if(he[te].x!==void 0)for(var ce=b.call(this,he[te]),_e=0;_e<ce.length;_e+=1)ne.indexOf(ce[_e])===-1&&ne.push(ce[_e]);for(var de=0;de<ne.length;de++)for(;this.pdf.internal.getNumberOfPages()<ne[de];)m.call(this);y(ne);for(var ye=ne[0],Le=ne[ne.length-1],we=ye;we<Le+1;we++){this.pdf.setPage(we),this.fillStyle=L,this.strokeStyle=P,this.lineCap=I,this.lineWidth=V,this.lineJoin=W;var ge=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Re=we===1?this.posY+this.margin[0]:this.margin[0],et=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ye=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Be=we===1?0:et+(we-2)*Ye;if(this.ctx.clip_path.length!==0){var Fe=this.path;M=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=g(M,this.posX+this.margin[3],-Be+Re+this.ctx.prevPageLastElemOffset),_.call(this,S,!0),this.path=Fe}if(se=JSON.parse(JSON.stringify(K)),this.path=g(se,this.posX+this.margin[3],-Be+Re+this.ctx.prevPageLastElemOffset),D===!1||we===0){var oe=(we>ye||we<Le)&&p.call(this);oe&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],ge,Ye,null).clip().discardPath()),_.call(this,S,D),oe&&this.pdf.restoreGraphicsState()}this.lineWidth=H}this.path=K}else this.lineWidth=V,_.call(this,S,D),this.lineWidth=H},_=function(S,D){if((S!=="stroke"||D||!x.call(this))&&(S==="stroke"||D||!A.call(this))){for(var L,P,I=[],H=this.path,V=0;V<H.length;V++){var W=H[V];switch(W.type){case"begin":I.push({begin:!0});break;case"close":I.push({close:!0});break;case"mt":I.push({start:W,deltas:[],abs:[]});break;case"lt":var M=I.length;if(H[V-1]&&!isNaN(H[V-1].x)&&(L=[W.x-H[V-1].x,W.y-H[V-1].y],M>0)){for(;M>=0;M--)if(I[M-1].close!==!0&&I[M-1].begin!==!0){I[M-1].deltas.push(L),I[M-1].abs.push(W);break}}break;case"bct":L=[W.x1-H[V-1].x,W.y1-H[V-1].y,W.x2-H[V-1].x,W.y2-H[V-1].y,W.x-H[V-1].x,W.y-H[V-1].y],I[I.length-1].deltas.push(L);break;case"qct":var se=H[V-1].x+2/3*(W.x1-H[V-1].x),K=H[V-1].y+2/3*(W.y1-H[V-1].y),he=W.x+2/3*(W.x1-W.x),ne=W.y+2/3*(W.y1-W.y),te=W.x,ce=W.y;L=[se-H[V-1].x,K-H[V-1].y,he-H[V-1].x,ne-H[V-1].y,te-H[V-1].x,ce-H[V-1].y],I[I.length-1].deltas.push(L);break;case"arc":I.push({deltas:[],abs:[],arc:!0}),Array.isArray(I[I.length-1].abs)&&I[I.length-1].abs.push(W)}}P=D?null:S==="stroke"?"stroke":"fill";for(var _e=!1,de=0;de<I.length;de++)if(I[de].arc)for(var ye=I[de].abs,Le=0;Le<ye.length;Le++){var we=ye[Le];we.type==="arc"?B.call(this,we.x,we.y,we.radius,we.startAngle,we.endAngle,we.counterclockwise,void 0,D,!_e):T.call(this,we.x,we.y),_e=!0}else if(I[de].close===!0)this.pdf.internal.out("h"),_e=!1;else if(I[de].begin!==!0){var ge=I[de].start.x,Re=I[de].start.y;R.call(this,I[de].deltas,ge,Re),_e=!0}P&&E.call(this,P),D&&C.call(this)}},j=function(S){var D=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,L=D*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return S-L;case"top":return S+D-L;case"hanging":return S+D-2*L;case"middle":return S+D/2-L;default:return S}},N=function(S){return S+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};f.prototype.createLinearGradient=function(){var S=function(){};return S.colorStops=[],S.addColorStop=function(D,L){this.colorStops.push([D,L])},S.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},S.isCanvasGradient=!0,S},f.prototype.createPattern=function(){return this.createLinearGradient()},f.prototype.createRadialGradient=function(){return this.createLinearGradient()};var B=function(S,D,L,P,I,H,V,W,M){for(var se=z.call(this,L,P,I,H),K=0;K<se.length;K++){var he=se[K];K===0&&(M?k.call(this,he.x1+S,he.y1+D):T.call(this,he.x1+S,he.y1+D)),q.call(this,S,D,he.x2,he.y2,he.x3,he.y3,he.x4,he.y4)}W?C.call(this):E.call(this,V)},E=function(S){switch(S){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},C=function(){this.pdf.clip(),this.pdf.discardPath()},k=function(S,D){this.pdf.internal.out(r(S)+" "+a(D)+" m")},w=function(S){var D;switch(S.align){case"right":case"end":D="right";break;case"center":D="center";break;default:D="left"}var L,P,I,H=this.pdf.getTextDimensions(S.text),V=j.call(this,S.y),W=N.call(this,V)-H.h,M=this.ctx.transform.applyToPoint(new o(S.x,V));if(this.autoPaging){var se=this.ctx.transform.decompose(),K=new c;K=(K=(K=K.multiply(se.translate)).multiply(se.skew)).multiply(se.scale);for(var he=this.ctx.transform.applyToRectangle(new l(S.x,V,H.w,H.h)),ne=K.applyToRectangle(new l(S.x,W,H.w,H.h)),te=b.call(this,ne),ce=[],_e=0;_e<te.length;_e+=1)ce.indexOf(te[_e])===-1&&ce.push(te[_e]);y(ce);for(var de=ce[0],ye=ce[ce.length-1],Le=de;Le<ye+1;Le++){this.pdf.setPage(Le);var we=Le===1?this.posY+this.margin[0]:this.margin[0],ge=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Re=this.pdf.internal.pageSize.height-this.margin[2],et=Re-this.margin[0],Ye=this.pdf.internal.pageSize.width-this.margin[1],Be=Ye-this.margin[3],Fe=Le===1?0:ge+(Le-2)*et;if(this.ctx.clip_path.length!==0){var oe=this.path;L=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=g(L,this.posX+this.margin[3],-1*Fe+we),_.call(this,"fill",!0),this.path=oe}var ke=g([JSON.parse(JSON.stringify(ne))],this.posX+this.margin[3],-Fe+we+this.ctx.prevPageLastElemOffset)[0];S.scale>=.01&&(P=this.pdf.internal.getFontSize(),this.pdf.setFontSize(P*S.scale),I=this.lineWidth,this.lineWidth=I*S.scale);var Ue=this.autoPaging!=="text";if(Ue||ke.y+ke.h<=Re){if(Ue||ke.y>=we&&ke.x<=Ye){var qe=Ue?S.text:this.pdf.splitTextToSize(S.text,S.maxWidth||Ye-ke.x)[0],$e=g([JSON.parse(JSON.stringify(he))],this.posX+this.margin[3],-Fe+we+this.ctx.prevPageLastElemOffset)[0],Ne=Ue&&(Le>de||Le<ye)&&p.call(this);Ne&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Be,et,null).clip().discardPath()),this.pdf.text(qe,$e.x,$e.y,{angle:S.angle,align:D,renderingMode:S.renderingMode}),Ne&&this.pdf.restoreGraphicsState()}}else ke.y<Re&&(this.ctx.prevPageLastElemOffset+=Re-ke.y);S.scale>=.01&&(this.pdf.setFontSize(P),this.lineWidth=I)}}else S.scale>=.01&&(P=this.pdf.internal.getFontSize(),this.pdf.setFontSize(P*S.scale),I=this.lineWidth,this.lineWidth=I*S.scale),this.pdf.text(S.text,M.x+this.posX,M.y+this.posY,{angle:S.angle,align:D,renderingMode:S.renderingMode,maxWidth:S.maxWidth}),S.scale>=.01&&(this.pdf.setFontSize(P),this.lineWidth=I)},T=function(S,D,L,P){L=L||0,P=P||0,this.pdf.internal.out(r(S+L)+" "+a(D+P)+" l")},R=function(S,D,L){return this.pdf.lines(S,D,L,null,null)},q=function(S,D,L,P,I,H,V,W){this.pdf.internal.out([t(s(L+S)),t(i(P+D)),t(s(I+S)),t(i(H+D)),t(s(V+S)),t(i(W+D)),"c"].join(" "))},z=function(S,D,L,P){for(var I=2*Math.PI,H=Math.PI/2;D>L;)D-=I;var V=Math.abs(L-D);V<I&&P&&(V=I-V);for(var W=[],M=P?-1:1,se=D;V>1e-5;){var K=se+M*Math.min(V,H);W.push(ee.call(this,S,se,K)),V-=Math.abs(K-se),se=K}return W},ee=function(S,D,L){var P=(L-D)/2,I=S*Math.cos(P),H=S*Math.sin(P),V=I,W=-H,M=V*V+W*W,se=M+V*I+W*H,K=4/3*(Math.sqrt(2*M*se)-se)/(V*H-W*I),he=V-K*W,ne=W+K*V,te=he,ce=-ne,_e=P+D,de=Math.cos(_e),ye=Math.sin(_e);return{x1:S*Math.cos(D),y1:S*Math.sin(D),x2:he*de-ne*ye,y2:he*ye+ne*de,x3:te*de-ce*ye,y3:te*ye+ce*de,x4:S*Math.cos(L),y4:S*Math.sin(L)}},Y=function(S){return 180*S/Math.PI},G=function(S,D,L,P,I,H){var V=S+.5*(L-S),W=D+.5*(P-D),M=I+.5*(L-I),se=H+.5*(P-H),K=Math.min(S,I,V,M),he=Math.max(S,I,V,M),ne=Math.min(D,H,W,se),te=Math.max(D,H,W,se);return new l(K,ne,he-K,te-ne)},re=function(S,D,L,P,I,H,V,W){var M,se,K,he,ne,te,ce,_e,de,ye,Le,we,ge,Re,et=L-S,Ye=P-D,Be=I-L,Fe=H-P,oe=V-I,ke=W-H;for(se=0;se<41;se++)de=(ce=(K=S+(M=se/40)*et)+M*((ne=L+M*Be)-K))+M*(ne+M*(I+M*oe-ne)-ce),ye=(_e=(he=D+M*Ye)+M*((te=P+M*Fe)-he))+M*(te+M*(H+M*ke-te)-_e),se==0?(Le=de,we=ye,ge=de,Re=ye):(Le=Math.min(Le,de),we=Math.min(we,ye),ge=Math.max(ge,de),Re=Math.max(Re,ye));return new l(Math.round(Le),Math.round(we),Math.round(ge-Le),Math.round(Re-we))},U=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var S,D,L=(S=this.ctx.lineDash,D=this.ctx.lineDashOffset,JSON.stringify({lineDash:S,lineDashOffset:D}));this.prevLineDash!==L&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=L)}}})(Ut.API),function(e){var t=function(o){var l,c,d,u,f,h,A,x,p,b;for(c=[],d=0,u=(o+=l="\0\0\0\0".slice(o.length%4||4)).length;u>d;d+=4)(f=(o.charCodeAt(d)<<24)+(o.charCodeAt(d+1)<<16)+(o.charCodeAt(d+2)<<8)+o.charCodeAt(d+3))!==0?(h=(f=((f=((f=((f=(f-(b=f%85))/85)-(p=f%85))/85)-(x=f%85))/85)-(A=f%85))/85)%85,c.push(h+33,A+33,x+33,p+33,b+33)):c.push(122);return function(m,g){for(var y=g;y>0;y--)m.pop()}(c,l.length),String.fromCharCode.apply(String,c)+"~>"},r=function(o){var l,c,d,u,f,h=String,A="length",x=255,p="charCodeAt",b="slice",m="replace";for(o[b](-2),o=o[b](0,-2)[m](/\s/g,"")[m]("z","!!!!!"),d=[],u=0,f=(o+=l="uuuuu"[b](o[A]%5||5))[A];f>u;u+=5)c=52200625*(o[p](u)-33)+614125*(o[p](u+1)-33)+7225*(o[p](u+2)-33)+85*(o[p](u+3)-33)+(o[p](u+4)-33),d.push(x&c>>24,x&c>>16,x&c>>8,x&c);return function(g,y){for(var v=y;v>0;v--)g.pop()}(d,l[A]),h.fromCharCode.apply(h,d)},a=function(o){return o.split("").map(function(l){return("0"+l.charCodeAt().toString(16)).slice(-2)}).join("")+">"},s=function(o){var l=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),l.test(o)===!1)return"";for(var c="",d=0;d<o.length;d+=2)c+=String.fromCharCode("0x"+(o[d]+o[d+1]));return c},i=function(o){for(var l=new Uint8Array(o.length),c=o.length;c--;)l[c]=o.charCodeAt(c);return(l=i_(l)).reduce(function(d,u){return d+String.fromCharCode(u)},"")};e.processDataByFilters=function(o,l){var c=0,d=o||"",u=[];for(typeof(l=l||[])=="string"&&(l=[l]),c=0;c<l.length;c+=1)switch(l[c]){case"ASCII85Decode":case"/ASCII85Decode":d=r(d),u.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":d=t(d),u.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":d=s(d),u.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":d=a(d),u.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":d=i(d),u.push("/FlateDecode");break;default:throw new Error('The filter: "'+l[c]+'" is not implemented')}return{data:d,reverseChain:u.reverse().join(" ")}}}(Ut.API),function(e){e.loadFile=function(t,r,a){return function(s,i,o){i=i!==!1,o=typeof o=="function"?o:function(){};var l=void 0;try{l=function(c,d,u){var f=new XMLHttpRequest,h=0,A=function(x){var p=x.length,b=[],m=String.fromCharCode;for(h=0;h<p;h+=1)b.push(m(255&x.charCodeAt(h)));return b.join("")};if(f.open("GET",c,!d),f.overrideMimeType("text/plain; charset=x-user-defined"),d===!1&&(f.onload=function(){f.status===200?u(A(this.responseText)):u(void 0)}),f.send(null),d&&f.status===200)return A(f.responseText)}(s,i,o)}catch{}return l}(t,r,a)},e.loadImageFile=e.loadFile}(Ut.API),function(e){function t(){return(lr.html2canvas?Promise.resolve(lr.html2canvas):Bv(()=>Promise.resolve().then(()=>iV),void 0)).catch(function(l){return Promise.reject(new Error("Could not load html2canvas: "+l))}).then(function(l){return l.default?l.default:l})}function r(){return(lr.DOMPurify?Promise.resolve(lr.DOMPurify):Bv(()=>Promise.resolve().then(()=>hZ),void 0)).catch(function(l){return Promise.reject(new Error("Could not load dompurify: "+l))}).then(function(l){return l.default?l.default:l})}var a=function(l){var c=zr(l);return c==="undefined"?"undefined":c==="string"||l instanceof String?"string":c==="number"||l instanceof Number?"number":c==="function"||l instanceof Function?"function":l&&l.constructor===Array?"array":l&&l.nodeType===1?"element":c==="object"?"object":"unknown"},s=function(l,c){var d=document.createElement(l);for(var u in c.className&&(d.className=c.className),c.innerHTML&&c.dompurify&&(d.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)d.style[u]=c.style[u];return d},i=function l(c,d){for(var u=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),f=c.firstChild;f;f=f.nextSibling)d!==!0&&f.nodeType===1&&f.nodeName==="SCRIPT"||u.appendChild(l(f,d));return c.nodeType===1&&(c.nodeName==="CANVAS"?(u.width=c.width,u.height=c.height,u.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(u.value=c.value),u.addEventListener("load",function(){u.scrollTop=c.scrollTop,u.scrollLeft=c.scrollLeft},!0)),u},o=function l(c){var d=Object.assign(l.convert(Promise.resolve()),JSON.parse(JSON.stringify(l.template))),u=l.convert(Promise.resolve(),d);return(u=u.setProgress(1,l,1,[l])).set(c)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(l,c){return l.__proto__=c||o.prototype,l},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(l,c){return this.then(function(){switch(c=c||function(d){switch(a(d)){case"string":return"string";case"element":return d.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(l),c){case"string":return this.then(r).then(function(d){return this.set({src:s("div",{innerHTML:l,dompurify:d})})});case"element":return this.set({src:l});case"canvas":return this.set({canvas:l});case"img":return this.set({img:l});default:return this.error("Unknown source type.")}})},o.prototype.to=function(l){switch(l){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var l={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=i(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(l.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=s("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=s("div",{className:"html2pdf__container",style:l}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(s("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(t).then(function(c){var d=Object.assign({},this.opt.html2canvas);return delete d.onrendered,c(this.prop.container,d)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(t).then(function(c){var d=this.opt.jsPDF,u=this.opt.fontFaces,f=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,h=Object.assign({async:!0,allowTaint:!0,scale:f,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete h.onrendered,d.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,d.context2d.posX=this.opt.x,d.context2d.posY=this.opt.y,d.context2d.margin=this.opt.margin,d.context2d.fontFaces=u,u)for(var A=0;A<u.length;++A){var x=u[A],p=x.src.find(function(b){return b.format==="truetype"});p&&d.addFont(p.url,x.ref.name,x.ref.style)}return h.windowHeight=h.windowHeight||0,h.windowHeight=h.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):h.windowHeight,d.context2d.save(!0),c(this.prop.container,h)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var l=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=l})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(l,c,d){return(d=d||"pdf").toLowerCase()==="img"||d.toLowerCase()==="image"?this.outputImg(l,c):this.outputPdf(l,c)},o.prototype.outputPdf=function(l,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(l,c)})},o.prototype.outputImg=function(l){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(l){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+l+'" is not supported.'}})},o.prototype.save=function(l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(l?{filename:l}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(l){if(a(l)!=="object")return this;var c=Object.keys(l||{}).map(function(d){if(d in o.template.prop)return function(){this.prop[d]=l[d]};switch(d){case"margin":return this.setMargin.bind(this,l.margin);case"jsPDF":return function(){return this.opt.jsPDF=l.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,l.pageSize);default:return function(){this.opt[d]=l[d]}}},this);return this.then(function(){return this.thenList(c)})},o.prototype.get=function(l,c){return this.then(function(){var d=l in o.template.prop?this.prop[l]:this.opt[l];return c?c(d):d})},o.prototype.setMargin=function(l){return this.then(function(){switch(a(l)){case"number":l=[l,l,l,l];case"array":if(l.length===2&&(l=[l[0],l[1],l[0],l[1]]),l.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=l}).then(this.setPageSize)},o.prototype.setPageSize=function(l){function c(d,u){return Math.floor(d*u/72*96)}return this.then(function(){(l=l||Ut.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(l.inner={width:l.width-this.opt.margin[1]-this.opt.margin[3],height:l.height-this.opt.margin[0]-this.opt.margin[2]},l.inner.px={width:c(l.inner.width,l.k),height:c(l.inner.height,l.k)},l.inner.ratio=l.inner.height/l.inner.width),this.prop.pageSize=l})},o.prototype.setProgress=function(l,c,d,u){return l!=null&&(this.progress.val=l),c!=null&&(this.progress.state=c),d!=null&&(this.progress.n=d),u!=null&&(this.progress.stack=u),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(l,c,d,u){return this.setProgress(l?this.progress.val+l:null,c||null,d?this.progress.n+d:null,u?this.progress.stack.concat(u):null)},o.prototype.then=function(l,c){var d=this;return this.thenCore(l,c,function(u,f){return d.updateProgress(null,null,1,[u]),Promise.prototype.then.call(this,function(h){return d.updateProgress(null,u),h}).then(u,f).then(function(h){return d.updateProgress(1),h})})},o.prototype.thenCore=function(l,c,d){d=d||Promise.prototype.then;var u=this;l&&(l=l.bind(u)),c&&(c=c.bind(u));var f=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?u:o.convert(Object.assign({},u),Promise.prototype),h=d.call(f,l,c);return o.convert(h,u.__proto__)},o.prototype.thenExternal=function(l,c){return Promise.prototype.then.call(this,l,c)},o.prototype.thenList=function(l){var c=this;return l.forEach(function(d){c=c.thenCore(d)}),c},o.prototype.catch=function(l){l&&(l=l.bind(this));var c=Promise.prototype.catch.call(this,l);return o.convert(c,this)},o.prototype.catchExternal=function(l){return Promise.prototype.catch.call(this,l)},o.prototype.error=function(l){return this.then(function(){throw new Error(l)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,Ut.getPageSize=function(l,c,d){if(zr(l)==="object"){var u=l;l=u.orientation,c=u.unit||c,d=u.format||d}c=c||"mm",d=d||"a4",l=(""+(l||"P")).toLowerCase();var f,h=(""+d).toLowerCase(),A={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":f=1;break;case"mm":f=72/25.4;break;case"cm":f=72/2.54;break;case"in":f=72;break;case"px":f=.75;break;case"pc":case"em":f=12;break;case"ex":f=6;break;default:throw"Invalid unit: "+c}var x,p=0,b=0;if(A.hasOwnProperty(h))p=A[h][1]/f,b=A[h][0]/f;else try{p=d[1],b=d[0]}catch{throw new Error("Invalid format: "+d)}if(l==="p"||l==="portrait")l="p",b>p&&(x=b,b=p,p=x);else{if(l!=="l"&&l!=="landscape")throw"Invalid orientation: "+l;l="l",p>b&&(x=b,b=p,p=x)}return{width:b,height:p,unit:c,k:f,orientation:l}},e.html=function(l,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map(Wv):null;var d=new o(c);return c.worker?d:d.from(l).doCallback()}}(Ut.API),Ut.API.addJS=function(e){return F4=e,this.internal.events.subscribe("postPutResources",function(){rm=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(rm+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),E4=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+F4+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){rm!==void 0&&E4!==void 0&&this.internal.out("/Names <</JavaScript "+rm+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var r=this,a=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var s=r.outline.render().split(/\r\n/),i=0;i<s.length;i++){var o=s[i],l=a.exec(o);if(l!=null){var c=l[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(o)}if(this.outline.createNamedDestinations){var d=this.internal.pages.length,u=[];for(i=0;i<d;i++){var f=r.internal.newObject();u.push(f);var h=r.internal.getPageInfo(i+1);r.internal.write("<< /D["+h.objId+" 0 R /XYZ null null null]>> endobj")}var A=r.internal.newObject();for(r.internal.write("<< /Names [ "),i=0;i<u.length;i++)r.internal.write("(page_"+(i+1)+")"+u[i]+" 0 R");r.internal.write(" ] >>","endobj"),t=r.internal.newObject(),r.internal.write("<< /Dests "+A+" 0 R"),r.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(a,s,i){var o={title:s,options:i,children:[]};return a==null&&(a=this.root),a.children.push(o),o},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(a){a.id=r.internal.newObjectDeferred();for(var s=0;s<a.children.length;s++)this.genIds_r(a.children[s])},r.outline.renderRoot=function(a){this.objStart(a),this.line("/Type /Outlines"),a.children.length>0&&(this.line("/First "+this.makeRef(a.children[0])),this.line("/Last "+this.makeRef(a.children[a.children.length-1]))),this.line("/Count "+this.count_r({count:0},a)),this.objEnd()},r.outline.renderItems=function(a){for(var s=this.ctx.pdf.internal.getVerticalCoordinateString,i=0;i<a.children.length;i++){var o=a.children[i];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(a)),i>0&&this.line("/Prev "+this.makeRef(a.children[i-1])),i<a.children.length-1&&this.line("/Next "+this.makeRef(a.children[i+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var l=this.count=this.count_r({count:0},o);if(l>0&&this.line("/Count "+l),o.options&&o.options.pageNumber){var c=r.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+s(0)+" 0]")}this.objEnd()}for(var d=0;d<a.children.length;d++)this.renderItems(a.children[d])},r.outline.line=function(a){this.ctx.val+=a+`\r
`},r.outline.makeRef=function(a){return a.id+" 0 R"},r.outline.makeString=function(a){return"("+r.internal.pdfEscape(a)+")"},r.outline.objStart=function(a){this.ctx.val+=`\r
`+a.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(a,s){for(var i=0;i<s.children.length;i++)a.count++,this.count_r(a,s.children[i]);return a.count}}])}(Ut.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(r,a,s,i,o,l){var c,d=this.decode.DCT_DECODE,u=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=o||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,c=function(f){for(var h,A=256*f.charCodeAt(4)+f.charCodeAt(5),x=f.length,p={width:0,height:0,numcomponents:1},b=4;b<x;b+=2){if(b+=A,t.indexOf(f.charCodeAt(b+1))!==-1){h=256*f.charCodeAt(b+5)+f.charCodeAt(b+6),p={width:256*f.charCodeAt(b+7)+f.charCodeAt(b+8),height:h,numcomponents:f.charCodeAt(b+9)};break}A=256*f.charCodeAt(b+2)+f.charCodeAt(b+3)}return p}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),c.numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}u={data:r,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:d,index:a,alias:s}}return u}}(Ut.API),Ut.API.processPNG=function(e,t,r,a){if(this.__addimage__.isArrayBuffer(e)&&(e=new Uint8Array(e)),this.__addimage__.isArrayBufferView(e)){var s,i=Z9(e,{checkCrc:!0}),o=i.width,l=i.height,c=i.channels,d=i.palette,u=i.depth;s=d&&c===1?function(B){for(var E=B.width,C=B.height,k=B.data,w=B.palette,T=B.depth,R=!1,q=[],z=[],ee=void 0,Y=!1,G=0,re=0;re<w.length;re++){var U=L5(w[re],4),S=U[0],D=U[1],L=U[2],P=U[3];q.push(S,D,L),P!=null&&(P===0?(G++,z.length<1&&z.push(re)):P<255&&(Y=!0))}if(Y||G>1){R=!0,z=void 0;var I=E*C;ee=new Uint8Array(I);for(var H=new DataView(k.buffer),V=0;V<I;V++){var W=Gv(H,V,T),M=L5(w[W],4)[3];ee[V]=M}}else G===0&&(z=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:R?8:void 0,colorBytes:k,alphaBytes:ee,needSMask:R,palette:q,mask:z}}(i):c===2||c===4?function(B){for(var E=B.data,C=B.width,k=B.height,w=B.channels,T=B.depth,R=w===2?"DeviceGray":"DeviceRGB",q=w-1,z=C*k,ee=q,Y=z*ee,G=1*z,re=Math.ceil(Y*T/8),U=Math.ceil(G*T/8),S=new Uint8Array(re),D=new Uint8Array(U),L=new DataView(E.buffer),P=new DataView(S.buffer),I=new DataView(D.buffer),H=!1,V=0;V<z;V++){for(var W=V*w,M=0;M<ee;M++)M4(P,Gv(L,W+M,T),V*ee+M,T);var se=Gv(L,W+ee,T);se<(1<<T)-1&&(H=!0),M4(I,se,1*V,T)}return{colorSpace:R,colorsPerPixel:q,sMaskBitsPerComponent:H?T:void 0,colorBytes:S,alphaBytes:D,needSMask:H}}(i):function(B){var E=B.data,C=B.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:C,colorsPerPixel:C==="DeviceGray"?1:3,colorBytes:E instanceof Uint16Array?function(k){for(var w=k.length,T=new Uint8Array(2*w),R=new DataView(T.buffer,T.byteOffset,T.byteLength),q=0;q<w;q++)R.setUint16(2*q,k[q],!1);return T}(E):E,needSMask:!1}}(i);var f,h,A,x=s,p=x.colorSpace,b=x.colorsPerPixel,m=x.sMaskBitsPerComponent,g=x.colorBytes,y=x.alphaBytes,v=x.needSMask,_=x.palette,j=x.mask,N=null;return a!==Ut.API.image_compression.NONE&&typeof i_=="function"?(N=function(B){var E;switch(B){case Ut.API.image_compression.FAST:E=11;break;case Ut.API.image_compression.MEDIUM:E=13;break;case Ut.API.image_compression.SLOW:E=14;break;default:E=12}return E}(a),f=this.decode.FLATE_DECODE,h="/Predictor ".concat(N," /Colors ").concat(b," /BitsPerComponent ").concat(u," /Columns ").concat(o),e=L4(g,Math.ceil(o*b*u/8),b,u,a),v&&(A=L4(y,Math.ceil(o*m/8),1,m,a))):(f=void 0,h=void 0,e=g,v&&(A=y)),(this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e))&&(e=this.__addimage__.arrayBufferToBinaryString(e)),(A&&this.__addimage__.isArrayBuffer(A)||this.__addimage__.isArrayBufferView(A))&&(A=this.__addimage__.arrayBufferToBinaryString(A)),{alias:r,data:e,index:t,filter:f,decodeParameters:h,transparency:j,palette:_,sMask:A,predictor:N,width:o,height:l,bitsPerComponent:u,sMaskBitsPerComponent:m,colorSpace:p}}},function(e){e.processGIF89A=function(t,r,a,s){var i=new vM(t),o=i.width,l=i.height,c=[];i.decodeAndBlitFrameRGBA(0,c);var d={data:c,width:o,height:l},u=new Xv(100).encode(d,100);return e.processJPEG.call(this,u,r,a,s)},e.processGIF87A=e.processGIF89A}(Ut.API),to.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:s,green:a,blue:r,quad:i}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},to.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(r){rn.log("bit decode error:"+r)}},to.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),r=t%4;for(e=this.height-1;e>=0;e--){for(var a=this.bottom_up?e:this.height-1-e,s=0;s<t;s++)for(var i=this.datav.getUint8(this.pos++,!0),o=a*this.width*4+8*s*4,l=0;l<8&&8*s+l<this.width;l++){var c=this.palette[i>>7-l&1];this.data[o+4*l]=c.blue,this.data[o+4*l+1]=c.green,this.data[o+4*l+2]=c.red,this.data[o+4*l+3]=255}r!==0&&(this.pos+=4-r)}},to.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,r=this.height-1;r>=0;r--){for(var a=this.bottom_up?r:this.height-1-r,s=0;s<e;s++){var i=this.datav.getUint8(this.pos++,!0),o=a*this.width*4+2*s*4,l=i>>4,c=15&i,d=this.palette[l];if(this.data[o]=d.blue,this.data[o+1]=d.green,this.data[o+2]=d.red,this.data[o+3]=255,2*s+1>=this.width)break;d=this.palette[c],this.data[o+4]=d.blue,this.data[o+4+1]=d.green,this.data[o+4+2]=d.red,this.data[o+4+3]=255}t!==0&&(this.pos+=4-t)}},to.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,a=0;a<this.width;a++){var s=this.datav.getUint8(this.pos++,!0),i=r*this.width*4+4*a;if(s<this.palette.length){var o=this.palette[s];this.data[i]=o.red,this.data[i+1]=o.green,this.data[i+2]=o.blue,this.data[i+3]=255}else this.data[i]=255,this.data[i+1]=255,this.data[i+2]=255,this.data[i+3]=255}e!==0&&(this.pos+=4-e)}},to.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var a=this.bottom_up?r:this.height-1-r,s=0;s<this.width;s++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(i&t)/t*255|0,l=(i>>5&t)/t*255|0,c=(i>>10&t)/t*255|0,d=i>>15?255:0,u=a*this.width*4+4*s;this.data[u]=c,this.data[u+1]=l,this.data[u+2]=o,this.data[u+3]=d}this.pos+=e}},to.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),a=this.height-1;a>=0;a--){for(var s=this.bottom_up?a:this.height-1-a,i=0;i<this.width;i++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(o&t)/t*255|0,c=(o>>5&r)/r*255|0,d=(o>>11)/t*255|0,u=s*this.width*4+4*i;this.data[u]=d,this.data[u+1]=c,this.data[u+2]=l,this.data[u+3]=255}this.pos+=e}},to.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*r;this.data[o]=i,this.data[o+1]=s,this.data[o+2]=a,this.data[o+3]=255}this.pos+=this.width%4}},to.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=t*this.width*4+4*r;this.data[l]=i,this.data[l+1]=s,this.data[l+2]=a,this.data[l+3]=o}},to.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,r,a,s){var i=new to(t,!1),o=i.width,l=i.height,c={data:i.getData(),width:o,height:l},d=new Xv(100).encode(c,100);return e.processJPEG.call(this,d,r,a,s)}}(Ut.API),H4.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,r,a,s){var i=new H4(t),o=i.width,l=i.height,c={data:i.getData(),width:o,height:l},d=new Xv(100).encode(c,100);return e.processJPEG.call(this,d,r,a,s)}}(Ut.API),Ut.API.processRGBA=function(e,t,r){for(var a=e.data,s=a.length,i=new Uint8Array(s/4*3),o=new Uint8Array(s/4),l=0,c=0,d=0;d<s;d+=4){var u=a[d],f=a[d+1],h=a[d+2],A=a[d+3];i[l++]=u,i[l++]=f,i[l++]=h,o[c++]=A}var x=this.__addimage__.arrayBufferToBinaryString(i);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:x,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},Ut.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Iu=Ut.API,nm=Iu.getCharWidthsArray=function(e,t){var r,a,s=(t=t||{}).font||this.internal.getFont(),i=t.fontSize||this.internal.getFontSize(),o=t.charSpace||this.internal.getCharSpace(),l=t.widths?t.widths:s.metadata.Unicode.widths,c=l.fof?l.fof:1,d=t.kerning?t.kerning:s.metadata.Unicode.kerning,u=d.fof?d.fof:1,f=t.doKerning!==!1,h=0,A=e.length,x=0,p=l[0]||c,b=[];for(r=0;r<A;r++)a=e.charCodeAt(r),typeof s.metadata.widthOfString=="function"?b.push((s.metadata.widthOfGlyph(s.metadata.characterToGlyph(a))+o*(1e3/i)||0)/1e3):(h=f&&zr(d[a])==="object"&&!isNaN(parseInt(d[a][x],10))?d[a][x]/u:0,b.push((l[a]||p)/c+h)),x=a;return b},T4=Iu.getStringUnitWidth=function(e,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),a=t.font||this.internal.getFont(),s=t.charSpace||this.internal.getCharSpace();return Iu.processArabic&&(e=Iu.processArabic(e)),typeof a.metadata.widthOfString=="function"?a.metadata.widthOfString(e,r,s)/r:nm.apply(this,arguments).reduce(function(i,o){return i+o},0)},I4=function(e,t,r,a){for(var s=[],i=0,o=e.length,l=0;i!==o&&l+t[i]<r;)l+=t[i],i++;s.push(e.slice(0,i));var c=i;for(l=0;i!==o;)l+t[i]>a&&(s.push(e.slice(c,i)),l=0,c=i),l+=t[i],i++;return c!==i&&s.push(e.slice(c,i)),s},D4=function(e,t,r){r||(r={});var a,s,i,o,l,c,d,u=[],f=[u],h=r.textIndent||0,A=0,x=0,p=e.split(" "),b=nm.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?p[0].length+2:r.lineIndent||0){var m=Array(c).join(" "),g=[];p.map(function(v){(v=v.split(/\s*\n/)).length>1?g=g.concat(v.map(function(_,j){return(j&&_.length?`
`:"")+_})):g.push(v[0])}),p=g,c=T4.apply(this,[m,r])}for(i=0,o=p.length;i<o;i++){var y=0;if(a=p[i],c&&a[0]==`
`&&(a=a.substr(1),y=1),h+A+(x=(s=nm.apply(this,[a,r])).reduce(function(v,_){return v+_},0))>t||y){if(x>t){for(l=I4.apply(this,[a,s,t-(h+A),t]),u.push(l.shift()),u=[l.pop()];l.length;)f.push([l.shift()]);x=s.slice(a.length-(u[0]?u[0].length:0)).reduce(function(v,_){return v+_},0)}else u=[a];f.push(u),h=x+c,A=b}else u.push(a),h+=A+x,A=b}return d=c?function(v,_){return(_?m:"")+v.join(" ")}:function(v){return v.join(" ")},f.map(d)},Iu.splitTextToSize=function(e,t,r){var a,s=(r=r||{}).fontSize||this.internal.getFontSize(),i=(function(u){if(u.widths&&u.kerning)return{widths:u.widths,kerning:u.kerning};var f=this.internal.getFont(u.fontName,u.fontStyle),h="Unicode";return f.metadata[h]?{widths:f.metadata[h].widths||{0:1},kerning:f.metadata[h].kerning||{}}:{font:f.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);a=Array.isArray(e)?e:String(e).split(/\r?\n/);var o=1*this.internal.scaleFactor*t/s;i.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/s:0,i.lineIndent=r.lineIndent;var l,c,d=[];for(l=0,c=a.length;l<c;l++)d=d.concat(D4.apply(this,[a[l],o,i]));return d},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="0123456789abcdef",r="klmnopqrstuvwxyz",a={},s={},i=0;i<16;i++)a[r[i]]=t[i],s[t[i]]=r[i];var o=function(h){return"0x"+parseInt(h,10).toString(16)},l=e.__fontmetrics__.compress=function(h){var A,x,p,b,m=["{"];for(var g in h){if(A=h[g],isNaN(parseInt(g,10))?x="'"+g+"'":(g=parseInt(g,10),x=(x=o(g).slice(2)).slice(0,-1)+s[x.slice(-1)]),typeof A=="number")A<0?(p=o(A).slice(3),b="-"):(p=o(A).slice(2),b=""),p=b+p.slice(0,-1)+s[p.slice(-1)];else{if(zr(A)!=="object")throw new Error("Don't know what to do with value type "+zr(A)+".");p=l(A)}m.push(x+p)}return m.push("}"),m.join("")},c=e.__fontmetrics__.uncompress=function(h){if(typeof h!="string")throw new Error("Invalid argument passed to uncompress.");for(var A,x,p,b,m={},g=1,y=m,v=[],_="",j="",N=h.length-1,B=1;B<N;B+=1)(b=h[B])=="'"?A?(p=A.join(""),A=void 0):A=[]:A?A.push(b):b=="{"?(v.push([y,p]),y={},p=void 0):b=="}"?((x=v.pop())[0][x[1]]=y,p=void 0,y=x[0]):b=="-"?g=-1:p===void 0?a.hasOwnProperty(b)?(_+=a[b],p=parseInt(_,16)*g,g=1,_=""):_+=b:a.hasOwnProperty(b)?(j+=a[b],y[p]=parseInt(j,16)*g,g=1,p=void 0,j=""):j+=b;return m},d={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},u={Unicode:{Courier:d,"Courier-Bold":d,"Courier-BoldOblique":d,"Courier-Oblique":d,Helvetica:d,"Helvetica-Bold":d,"Helvetica-BoldOblique":d,"Helvetica-Oblique":d,"Times-Roman":d,"Times-Bold":d,"Times-BoldItalic":d,"Times-Italic":d}},f={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(h){var A=h.font,x=f.Unicode[A.postScriptName];x&&(A.metadata.Unicode={},A.metadata.Unicode.widths=x.widths,A.metadata.Unicode.kerning=x.kerning);var p=u.Unicode[A.postScriptName];p&&(A.metadata.Unicode.encoding=p,A.encoding=p.codePages[0])}])}(Ut.API),function(e){var t=function(r){for(var a=r.length,s=new Uint8Array(a),i=0;i<a;i++)s[i]=r.charCodeAt(i);return s};e.API.events.push(["addFont",function(r){var a=void 0,s=r.font,i=r.instance;if(!s.isStandardFont){if(i===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");if(typeof(a=i.existsFileInVFS(s.postScriptName)===!1?i.loadFile(s.postScriptName):i.getFileFromVFS(s.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");(function(o,l){l=/^\x00\x01\x00\x00/.test(l)?t(l):t(rg(l)),o.metadata=e.API.TTFFont.open(l),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(s,a)}}])}(Ut),Ut.API.addSvgAsImage=function(e,t,r,a,s,i,o,l){if(isNaN(t)||isNaN(r))throw rn.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(a)||isNaN(s))throw rn.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=a,c.height=s;var d=c.getContext("2d");d.fillStyle="#fff",d.fillRect(0,0,c.width,c.height);var u={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},f=this;return(lr.canvg?Promise.resolve(lr.canvg):Bv(()=>import("./index.es-Dz_zvRwu.js"),[])).catch(function(h){return Promise.reject(new Error("Could not load canvg: "+h))}).then(function(h){return h.default?h.default:h}).then(function(h){return h.fromString(d,e,u)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(h){return h.render(u)}).then(function(){f.addImage(c.toDataURL("image/jpeg",1),t,r,a,s,o,l)})},Ut.API.putTotalPages=function(e){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var a=1;a<=this.internal.getNumberOfPages();a++)for(var s=0;s<this.internal.pages[a].length;s++)this.internal.pages[a][s]=this.internal.pages[a][s].replace(t,r);return this},Ut.API.viewerPreferences=function(e,t){var r;e=e||{},t=t||!1;var a,s,i,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(o),c=[],d=0,u=0,f=0;function h(x,p){var b,m=!1;for(b=0;b<x.length;b+=1)x[b]===p&&(m=!0);return m}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var A=l.length;for(f=0;f<A;f+=1)r[l[f]].value=r[l[f]].defaultValue,r[l[f]].explicitSet=!1}if(zr(e)==="object"){for(s in e)if(i=e[s],h(l,s)&&i!==void 0){if(r[s].type==="boolean"&&typeof i=="boolean")r[s].value=i;else if(r[s].type==="name"&&h(r[s].valueSet,i))r[s].value=i;else if(r[s].type==="integer"&&Number.isInteger(i))r[s].value=i;else if(r[s].type==="array"){for(d=0;d<i.length;d+=1)if(a=!0,i[d].length===1&&typeof i[d][0]=="number")c.push(String(i[d]-1));else if(i[d].length>1){for(u=0;u<i[d].length;u+=1)typeof i[d][u]!="number"&&(a=!1);a===!0&&c.push([i[d][0]-1,i[d][1]-1].join(" "))}r[s].value="["+c.join(" ")+"]"}else r[s].value=r[s].defaultValue;r[s].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var x,p=[];for(x in r)r[x].explicitSet===!0&&(r[x].type==="name"?p.push("/"+x+" /"+r[x].value):p.push("/"+x+" "+r[x].value));p.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+p.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(e){var t=function(){var a='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',s=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),i=unescape(encodeURIComponent(a)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),l=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),d=i.length+o.length+l.length+s.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+d+" >>"),this.internal.write("stream"),this.internal.write(s+i+o+l+c),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(a,s){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:a,namespaceuri:s||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",t)),this}}(Ut.API),function(e){var t=e.API,r=t.pdfEscape16=function(i,o){for(var l,c=o.metadata.Unicode.widths,d=["","0","00","000","0000"],u=[""],f=0,h=i.length;f<h;++f){if(l=o.metadata.characterToGlyph(i.charCodeAt(f)),o.metadata.glyIdsUsed.push(l),o.metadata.toUnicode[l]=i.charCodeAt(f),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(o.metadata.widthOfGlyph(l),10)])),l=="0")return u.join("");l=l.toString(16),u.push(d[4-l.length],l)}return u.join("")},a=function(i){var o,l,c,d,u,f,h;for(u=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],f=0,h=(l=Object.keys(i).sort(function(A,x){return A-x})).length;f<h;f++)o=l[f],c.length>=100&&(u+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),i[o]!==void 0&&i[o]!==null&&typeof i[o].toString=="function"&&(d=("0000"+i[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),c.push("<"+o+"><"+d+">"));return c.length&&(u+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),u+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(i){(function(o){var l=o.font,c=o.out,d=o.newObject,u=o.putStream;if(l.metadata instanceof e.API.TTFFont&&l.encoding==="Identity-H"){for(var f=l.metadata.Unicode.widths,h=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),A="",x=0;x<h.length;x++)A+=String.fromCharCode(h[x]);var p=d();u({data:A,addLength1:!0,objectId:p}),c("endobj");var b=d();u({data:a(l.metadata.toUnicode),addLength1:!0,objectId:b}),c("endobj");var m=d();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+Wu(l.fontName)),c("/FontFile2 "+p+" 0 R"),c("/FontBBox "+e.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var g=d();c("<<"),c("/Type /Font"),c("/BaseFont /"+Wu(l.fontName)),c("/FontDescriptor "+m+" 0 R"),c("/W "+e.API.PDFObject.convert(f)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=d(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+b+" 0 R"),c("/BaseFont /"+Wu(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+g+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(i)}]),t.events.push(["putFont",function(i){(function(o){var l=o.font,c=o.out,d=o.newObject,u=o.putStream;if(l.metadata instanceof e.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var f=l.metadata.rawData,h="",A=0;A<f.length;A++)h+=String.fromCharCode(f[A]);var x=d();u({data:h,addLength1:!0,objectId:x}),c("endobj");var p=d();u({data:a(l.metadata.toUnicode),addLength1:!0,objectId:p}),c("endobj");var b=d();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+x+" 0 R"),c("/Flags 96"),c("/FontBBox "+e.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+Wu(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=d();for(var m=0;m<l.metadata.hmtx.widths.length;m++)l.metadata.hmtx.widths[m]=parseInt(l.metadata.hmtx.widths[m]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+p+" 0 R/BaseFont/"+Wu(l.fontName)+"/FontDescriptor "+b+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(i)}]);var s=function(i){var o,l=i.text||"",c=i.x,d=i.y,u=i.options||{},f=i.mutex||{},h=f.pdfEscape,A=f.activeFontKey,x=f.fonts,p=A,b="",m=0,g="",y=x[p].encoding;if(x[p].encoding!=="Identity-H")return{text:l,x:c,y:d,options:u,mutex:f};for(g=l,p=A,Array.isArray(l)&&(g=l[0]),m=0;m<g.length;m+=1)x[p].metadata.hasOwnProperty("cmap")&&(o=x[p].metadata.cmap.unicode.codeMap[g[m].charCodeAt(0)]),o||g[m].charCodeAt(0)<256&&x[p].metadata.hasOwnProperty("Unicode")?b+=g[m]:b+="";var v="";return parseInt(p.slice(1))<14||y==="WinAnsiEncoding"?v=h(b,p).split("").map(function(_){return _.charCodeAt(0).toString(16)}).join(""):y==="Identity-H"&&(v=r(b,x[p])),f.isHex=!0,{text:v,x:c,y:d,options:u,mutex:f}};t.events.push(["postProcessText",function(i){var o=i.text||"",l=[],c={text:o,x:i.x,y:i.y,options:i.options,mutex:i.mutex};if(Array.isArray(o)){var d=0;for(d=0;d<o.length;d+=1)Array.isArray(o[d])&&o[d].length===3?l.push([s(Object.assign({},c,{text:o[d][0]})).text,o[d][1],o[d][2]]):l.push(s(Object.assign({},c,{text:o[d]})).text);i.text=l}else i.text=s(Object.assign({},c,{text:o})).text}])}(Ut),function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0},e.addFileToVFS=function(r,a){return t.call(this),this.internal.vFS[r]=a,this},e.getFileFromVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(Ut.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(a){var s,i,o,l,c,d,u,f=t,h=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],A=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],x={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},p={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},b=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],m=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),g=!1,y=0;this.__bidiEngine__={};var v=function(k){var w=k.charCodeAt(),T=w>>8,R=p[T];return R!==void 0?f[256*R+(255&w)]:T===252||T===253?"AL":m.test(T)?"L":T===8?"R":"N"},_=function(k){for(var w,T=0;T<k.length;T++){if((w=v(k.charAt(T)))==="L")return!1;if(w==="R")return!0}return!1},j=function(k,w,T,R){var q,z,ee,Y,G=w[R];switch(G){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":g=!1;break;case"N":case"AN":break;case"EN":g&&(G="AN");break;case"AL":g=!0,G="R";break;case"WS":case"BN":G="N";break;case"CS":R<1||R+1>=w.length||(q=T[R-1])!=="EN"&&q!=="AN"||(z=w[R+1])!=="EN"&&z!=="AN"?G="N":g&&(z="AN"),G=z===q?z:"N";break;case"ES":G=(q=R>0?T[R-1]:"B")==="EN"&&R+1<w.length&&w[R+1]==="EN"?"EN":"N";break;case"ET":if(R>0&&T[R-1]==="EN"){G="EN";break}if(g){G="N";break}for(ee=R+1,Y=w.length;ee<Y&&w[ee]==="ET";)ee++;G=ee<Y&&w[ee]==="EN"?"EN":"N";break;case"NSM":if(o&&!l){for(Y=w.length,ee=R+1;ee<Y&&w[ee]==="NSM";)ee++;if(ee<Y){var re=k[R],U=re>=1425&&re<=2303||re===64286;if(q=w[ee],U&&(q==="R"||q==="AL")){G="R";break}}}G=R<1||(q=w[R-1])==="B"?"N":T[R-1];break;case"B":g=!1,s=!0,G=y;break;case"S":i=!0,G="N"}return G},N=function(k,w,T){var R=k.split("");return T&&B(R,T,{hiLevel:y}),R.reverse(),w&&w.reverse(),R.join("")},B=function(k,w,T){var R,q,z,ee,Y,G=-1,re=k.length,U=0,S=[],D=y?A:h,L=[];for(g=!1,s=!1,i=!1,q=0;q<re;q++)L[q]=v(k[q]);for(z=0;z<re;z++){if(Y=U,S[z]=j(k,L,S,z),R=240&(U=D[Y][x[S[z]]]),U&=15,w[z]=ee=D[U][5],R>0)if(R===16){for(q=G;q<z;q++)w[q]=1;G=-1}else G=-1;if(D[U][6])G===-1&&(G=z);else if(G>-1){for(q=G;q<z;q++)w[q]=ee;G=-1}L[z]==="B"&&(w[z]=0),T.hiLevel|=ee}i&&function(P,I,H){for(var V=0;V<H;V++)if(P[V]==="S"){I[V]=y;for(var W=V-1;W>=0&&P[W]==="WS";W--)I[W]=y}}(L,w,re)},E=function(k,w,T,R,q){if(!(q.hiLevel<k)){if(k===1&&y===1&&!s)return w.reverse(),void(T&&T.reverse());for(var z,ee,Y,G,re=w.length,U=0;U<re;){if(R[U]>=k){for(Y=U+1;Y<re&&R[Y]>=k;)Y++;for(G=U,ee=Y-1;G<ee;G++,ee--)z=w[G],w[G]=w[ee],w[ee]=z,T&&(z=T[G],T[G]=T[ee],T[ee]=z);U=Y}U++}}},C=function(k,w,T){var R=k.split(""),q={hiLevel:y};return T||(T=[]),B(R,T,q),function(z,ee,Y){if(Y.hiLevel!==0&&u)for(var G,re=0;re<z.length;re++)ee[re]===1&&(G=b.indexOf(z[re]))>=0&&(z[re]=b[G+1])}(R,T,q),E(2,R,w,T,q),E(1,R,w,T,q),R.join("")};return this.__bidiEngine__.doBidiReorder=function(k,w,T){if(function(q,z){if(z)for(var ee=0;ee<q.length;ee++)z[ee]=ee;l===void 0&&(l=_(q)),d===void 0&&(d=_(q))}(k,w),o||!c||d)if(o&&c&&l^d)y=l?1:0,k=N(k,w,T);else if(!o&&c&&d)y=l?1:0,k=C(k,w,T),k=N(k,w);else if(!o||l||c||d){if(o&&!c&&l^d)k=N(k,w),l?(y=0,k=C(k,w,T)):(y=1,k=C(k,w,T),k=N(k,w));else if(o&&l&&!c&&d)y=1,k=C(k,w,T),k=N(k,w);else if(!o&&!c&&l^d){var R=u;l?(y=1,k=C(k,w,T),y=0,u=!1,k=C(k,w,T),u=R):(y=0,k=C(k,w,T),k=N(k,w),y=1,u=!1,k=C(k,w,T),u=R,k=N(k,w))}}else y=0,k=C(k,w,T);else y=l?1:0,k=C(k,w,T);return k},this.__bidiEngine__.setOptions=function(k){k&&(o=k.isInputVisual,c=k.isOutputVisual,l=k.isInputRtl,d=k.isOutputRtl,u=k.isSymmetricSwapping)},this.__bidiEngine__.setOptions(a),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(a){var s=a.text;a.x,a.y;var i=a.options||{};a.mutex,i.lang;var o=[];if(i.isInputVisual=typeof i.isInputVisual!="boolean"||i.isInputVisual,r.setOptions(i),Object.prototype.toString.call(s)==="[object Array]"){var l=0;for(o=[],l=0;l<s.length;l+=1)Object.prototype.toString.call(s[l])==="[object Array]"?o.push([r.doBidiReorder(s[l][0]),s[l][1],s[l][2]]):o.push([r.doBidiReorder(s[l])]);a.text=o}else a.text=r.doBidiReorder(s);r.setOptions({isInputVisual:!0})}])}(Ut),Ut.API.TTFFont=function(){function e(t){var r;if(this.rawData=t,r=this.contents=new $c(t),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new LM(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new bM(this.contents),this.head=new wM(this),this.name=new SM(this),this.cmap=new j6(this),this.toUnicode={},this.hhea=new NM(this),this.maxp=new BM(this),this.hmtx=new EM(this),this.post=new kM(this),this.os2=new jM(this),this.loca=new DM(this),this.glyf=new FM(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,r,a,s,i;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,l,c,d;for(d=[],o=0,l=(c=this.bbox).length;o<l;o++)t=c[o],d.push(Math.round(t*this.scaleFactor));return d}).call(this),this.stemV=0,this.post.exists?(a=255&(s=this.post.italic_angle),32768&(r=s>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+a)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(i=this.familyClass)===1||i===2||i===3||i===4||i===5||i===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var r;return((r=this.cmap.unicode)!=null?r.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*r},e.prototype.widthOfString=function(t,r,a){var s,i,o,l;for(o=0,i=0,l=(t=""+t).length;0<=l?i<l:i>l;i=0<=l?++i:--i)s=t.charCodeAt(i),o+=this.widthOfGlyph(this.characterToGlyph(s))+a*(1e3/r)||0;return o*(r/1e3)},e.prototype.lineHeight=function(t,r){var a;return r==null&&(r=!1),a=r?this.lineGap:0,(this.ascender+a-this.decender)/1e3*t},e}();var wo,$c=function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var r,a;for(a=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)a[r]=String.fromCharCode(this.readByte());return a.join("")},e.prototype.writeString=function(t){var r,a,s;for(s=[],r=0,a=t.length;0<=a?r<a:r>a;r=0<=a?++r:--r)s.push(this.writeByte(t.charCodeAt(r)));return s},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,r,a,s,i,o,l,c;return t=this.readByte(),r=this.readByte(),a=this.readByte(),s=this.readByte(),i=this.readByte(),o=this.readByte(),l=this.readByte(),c=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^r)+1099511627776*(255^a)+4294967296*(255^s)+16777216*(255^i)+65536*(255^o)+256*(255^l)+(255^c)+1):72057594037927940*t+281474976710656*r+1099511627776*a+4294967296*s+16777216*i+65536*o+256*l+c},e.prototype.writeLongLong=function(t){var r,a;return r=Math.floor(t/4294967296),a=4294967295&t,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(a>>24&255),this.writeByte(a>>16&255),this.writeByte(a>>8&255),this.writeByte(255&a)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var r,a;for(r=[],a=0;0<=t?a<t:a>t;a=0<=t?++a:--a)r.push(this.readByte());return r},e.prototype.write=function(t){var r,a,s,i;for(i=[],a=0,s=t.length;a<s;a++)r=t[a],i.push(this.writeByte(r));return i},e}(),bM=function(){var e;function t(r){var a,s,i;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},s=0,i=this.tableCount;0<=i?s<i:s>i;s=0<=i?++s:--s)a={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[a.tag]=a}return t.prototype.encode=function(r){var a,s,i,o,l,c,d,u,f,h,A,x,p;for(p in A=Object.keys(r).length,c=Math.log(2),f=16*Math.floor(Math.log(A)/c),o=Math.floor(f/c),u=16*A-f,(s=new $c).writeInt(this.scalarType),s.writeShort(A),s.writeShort(f),s.writeShort(o),s.writeShort(u),i=16*A,d=s.pos+i,l=null,x=[],r)for(h=r[p],s.writeString(p),s.writeInt(e(h)),s.writeInt(d),s.writeInt(h.length),x=x.concat(h),p==="head"&&(l=d),d+=h.length;d%4;)x.push(0),d++;return s.write(x),a=2981146554-e(s.data),s.pos=l+8,s.writeUInt32(a),s.data},e=function(r){var a,s,i,o;for(r=k6.call(r);r.length%4;)r.push(0);for(i=new $c(r),s=0,a=0,o=r.length;a<o;a=a+=4)s+=i.readUInt32();return 4294967295&s},t}(),_M={}.hasOwnProperty,Xo=function(e,t){for(var r in t)_M.call(t,r)&&(e[r]=t[r]);function a(){this.constructor=e}return a.prototype=t.prototype,e.prototype=new a,e.__super__=t.prototype,e};wo=function(){function e(t){var r;this.file=t,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var wM=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Xo(e,wo),e.prototype.tag="head",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},e.prototype.encode=function(t){var r;return(r=new $c).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(t),r.writeShort(this.glyphDataFormat),r.data},e}(),q4=function(){function e(t,r){var a,s,i,o,l,c,d,u,f,h,A,x,p,b,m,g,y;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=r+t.readInt(),f=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=t.readByte();break;case 4:for(A=t.readUInt16(),h=A/2,t.pos+=6,i=function(){var v,_;for(_=[],c=v=0;0<=h?v<h:v>h;c=0<=h?++v:--v)_.push(t.readUInt16());return _}(),t.pos+=2,p=function(){var v,_;for(_=[],c=v=0;0<=h?v<h:v>h;c=0<=h?++v:--v)_.push(t.readUInt16());return _}(),d=function(){var v,_;for(_=[],c=v=0;0<=h?v<h:v>h;c=0<=h?++v:--v)_.push(t.readUInt16());return _}(),u=function(){var v,_;for(_=[],c=v=0;0<=h?v<h:v>h;c=0<=h?++v:--v)_.push(t.readUInt16());return _}(),s=(this.length-t.pos+this.offset)/2,l=function(){var v,_;for(_=[],c=v=0;0<=s?v<s:v>s;c=0<=s?++v:--v)_.push(t.readUInt16());return _}(),c=m=0,y=i.length;m<y;c=++m)for(b=i[c],a=g=x=p[c];x<=b?g<=b:g>=b;a=x<=b?++g:--g)u[c]===0?o=a+d[c]:(o=l[u[c]/2+(a-x)-(h-c)]||0)!==0&&(o+=d[c]),this.codeMap[a]=65535&o}t.pos=f}return e.encode=function(t,r){var a,s,i,o,l,c,d,u,f,h,A,x,p,b,m,g,y,v,_,j,N,B,E,C,k,w,T,R,q,z,ee,Y,G,re,U,S,D,L,P,I,H,V,W,M,se,K;switch(R=new $c,o=Object.keys(t).sort(function(he,ne){return he-ne}),r){case"macroman":for(p=0,b=function(){var he=[];for(x=0;x<256;++x)he.push(0);return he}(),g={0:0},i={},q=0,G=o.length;q<G;q++)g[W=t[s=o[q]]]==null&&(g[W]=++p),i[s]={old:t[s],new:g[t[s]]},b[s]=g[t[s]];return R.writeUInt16(1),R.writeUInt16(0),R.writeUInt32(12),R.writeUInt16(0),R.writeUInt16(262),R.writeUInt16(0),R.write(b),{charMap:i,subtable:R.data,maxGlyphID:p+1};case"unicode":for(w=[],f=[],y=0,g={},a={},m=d=null,z=0,re=o.length;z<re;z++)g[_=t[s=o[z]]]==null&&(g[_]=++y),a[s]={old:_,new:g[_]},l=g[_]-s,m!=null&&l===d||(m&&f.push(m),w.push(s),d=l),m=s;for(m&&f.push(m),f.push(65535),w.push(65535),C=2*(E=w.length),B=2*Math.pow(Math.log(E)/Math.LN2,2),h=Math.log(B/2)/Math.LN2,N=2*E-B,c=[],j=[],A=[],x=ee=0,U=w.length;ee<U;x=++ee){if(k=w[x],u=f[x],k===65535){c.push(0),j.push(0);break}if(k-(T=a[k].new)>=32768)for(c.push(0),j.push(2*(A.length+E-x)),s=Y=k;k<=u?Y<=u:Y>=u;s=k<=u?++Y:--Y)A.push(a[s].new);else c.push(T-k),j.push(0)}for(R.writeUInt16(3),R.writeUInt16(1),R.writeUInt32(12),R.writeUInt16(4),R.writeUInt16(16+8*E+2*A.length),R.writeUInt16(0),R.writeUInt16(C),R.writeUInt16(B),R.writeUInt16(h),R.writeUInt16(N),H=0,S=f.length;H<S;H++)s=f[H],R.writeUInt16(s);for(R.writeUInt16(0),V=0,D=w.length;V<D;V++)s=w[V],R.writeUInt16(s);for(M=0,L=c.length;M<L;M++)l=c[M],R.writeUInt16(l);for(se=0,P=j.length;se<P;se++)v=j[se],R.writeUInt16(v);for(K=0,I=A.length;K<I;K++)p=A[K],R.writeUInt16(p);return{charMap:a,subtable:R.data,maxGlyphID:y+1}}},e}(),j6=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Xo(e,wo),e.prototype.tag="cmap",e.prototype.parse=function(t){var r,a,s;for(t.pos=this.offset,this.version=t.readUInt16(),s=t.readUInt16(),this.tables=[],this.unicode=null,a=0;0<=s?a<s:a>s;a=0<=s?++a:--a)r=new q4(t,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},e.encode=function(t,r){var a,s;return r==null&&(r="macroman"),a=q4.encode(t,r),(s=new $c).writeUInt16(0),s.writeUInt16(1),a.table=s.data.concat(a.subtable),a},e}(),NM=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Xo(e,wo),e.prototype.tag="hhea",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},e}(),jM=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Xo(e,wo),e.prototype.tag="OS/2",e.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var r,a;for(a=[],r=0;r<10;++r)a.push(t.readByte());return a}(),this.charRange=function(){var r,a;for(a=[],r=0;r<4;++r)a.push(t.readInt());return a}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var r,a;for(a=[],r=0;r<2;r=++r)a.push(t.readInt());return a}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},e}(),kM=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Xo(e,wo),e.prototype.tag="post",e.prototype.parse=function(t){var r,a,s;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:case 196608:break;case 131072:var i;for(a=t.readUInt16(),this.glyphNameIndex=[],i=0;0<=a?i<a:i>a;i=0<=a?++i:--i)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],s=[];t.pos<this.offset+this.length;)r=t.readByte(),s.push(this.names.push(t.readString(r)));return s;case 151552:return a=t.readUInt16(),this.offsets=t.read(a);case 262144:return this.map=(function(){var o,l,c;for(c=[],i=o=0,l=this.file.maxp.numGlyphs;0<=l?o<l:o>l;i=0<=l?++o:--o)c.push(t.readUInt32());return c}).call(this)}},e}(),CM=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},SM=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Xo(e,wo),e.prototype.tag="name",e.prototype.parse=function(t){var r,a,s,i,o,l,c,d,u,f,h;for(t.pos=this.offset,t.readShort(),r=t.readShort(),l=t.readShort(),a=[],i=0;0<=r?i<r:i>r;i=0<=r?++i:--i)a.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+l+t.readShort()});for(c={},i=u=0,f=a.length;u<f;i=++u)s=a[i],t.pos=s.offset,d=t.readString(s.length),o=new CM(d,s),c[h=s.nameID]==null&&(c[h]=[]),c[s.nameID].push(o);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},e}(),BM=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Xo(e,wo),e.prototype.tag="maxp",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},e}(),EM=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Xo(e,wo),e.prototype.tag="hmtx",e.prototype.parse=function(t){var r,a,s,i,o,l,c;for(t.pos=this.offset,this.metrics=[],r=0,l=this.file.hhea.numberOfMetrics;0<=l?r<l:r>l;r=0<=l?++r:--r)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(s=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var d,u;for(u=[],r=d=0;0<=s?d<s:d>s;r=0<=s?++d:--d)u.push(t.readInt16());return u}(),this.widths=(function(){var d,u,f,h;for(h=[],d=0,u=(f=this.metrics).length;d<u;d++)i=f[d],h.push(i.advance);return h}).call(this),a=this.widths[this.widths.length-1],c=[],r=o=0;0<=s?o<s:o>s;r=0<=s?++o:--o)c.push(this.widths.push(a));return c},e.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},e}(),k6=[].slice,FM=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Xo(e,wo),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(t){var r,a,s,i,o,l,c,d,u,f;return t in this.cache?this.cache[t]:(i=this.file.loca,r=this.file.contents,a=i.indexOf(t),(s=i.lengthOf(t))===0?this.cache[t]=null:(r.pos=this.offset+a,o=(l=new $c(r.read(s))).readShort(),d=l.readShort(),f=l.readShort(),c=l.readShort(),u=l.readShort(),this.cache[t]=o===-1?new IM(l,d,f,c,u):new TM(l,o,d,f,c,u),this.cache[t]))},e.prototype.encode=function(t,r,a){var s,i,o,l,c;for(o=[],i=[],l=0,c=r.length;l<c;l++)s=t[r[l]],i.push(o.length),s&&(o=o.concat(s.encode(a)));return i.push(o.length),{table:o,offsets:i}},e}(),TM=function(){function e(t,r,a,s,i,o){this.raw=t,this.numberOfContours=r,this.xMin=a,this.yMin=s,this.xMax=i,this.yMax=o,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),IM=function(){function e(t,r,a,s,i){var o,l;for(this.raw=t,this.xMin=r,this.yMin=a,this.xMax=s,this.yMax=i,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;l=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&l;)o.pos+=1&l?4:2,128&l?o.pos+=8:64&l?o.pos+=4:8&l&&(o.pos+=2)}return e.prototype.encode=function(){var t,r,a;for(r=new $c(k6.call(this.raw.data)),t=0,a=this.glyphIDs.length;t<a;++t)r.pos=this.glyphOffsets[t];return r.data},e}(),DM=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Xo(e,wo),e.prototype.tag="loca",e.prototype.parse=function(t){var r,a;return t.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var s,i;for(i=[],a=0,s=this.length;a<s;a+=2)i.push(2*t.readUInt16());return i}).call(this):(function(){var s,i;for(i=[],a=0,s=this.length;a<s;a+=4)i.push(t.readUInt32());return i}).call(this)},e.prototype.indexOf=function(t){return this.offsets[t]},e.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},e.prototype.encode=function(t,r){for(var a=new Uint32Array(this.offsets.length),s=0,i=0,o=0;o<a.length;++o)if(a[o]=s,i<r.length&&r[i]==o){++i,a[o]=s;var l=this.offsets[o],c=this.offsets[o+1]-l;c>0&&(s+=c)}for(var d=new Array(4*a.length),u=0;u<a.length;++u)d[4*u+3]=255&a[u],d[4*u+2]=(65280&a[u])>>8,d[4*u+1]=(16711680&a[u])>>16,d[4*u]=(4278190080&a[u])>>24;return d},e}(),LM=function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,r,a,s,i;for(r in s=this.font.cmap.tables[0].codeMap,t={},i=this.subset)a=i[r],t[r]=s[a];return t},e.prototype.glyphsFor=function(t){var r,a,s,i,o,l,c;for(s={},o=0,l=t.length;o<l;o++)s[i=t[o]]=this.font.glyf.glyphFor(i);for(i in r=[],s)(a=s[i])!=null&&a.compound&&r.push.apply(r,a.glyphIDs);if(r.length>0)for(i in c=this.glyphsFor(r))a=c[i],s[i]=a;return s},e.prototype.encode=function(t,r){var a,s,i,o,l,c,d,u,f,h,A,x,p,b,m;for(s in a=j6.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(t),A={0:0},m=a.charMap)A[(c=m[s]).old]=c.new;for(x in h=a.maxGlyphID,o)x in A||(A[x]=h++);return u=function(g){var y,v;for(y in v={},g)v[g[y]]=y;return v}(A),f=Object.keys(u).sort(function(g,y){return g-y}),p=function(){var g,y,v;for(v=[],g=0,y=f.length;g<y;g++)l=f[g],v.push(u[l]);return v}(),i=this.font.glyf.encode(o,p,A),d=this.font.loca.encode(i.offsets,p),b={cmap:this.font.cmap.raw(),glyf:i.table,loca:d,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(b["OS/2"]=this.font.os2.raw()),this.font.directory.encode(b)},e}();Ut.API.PDFObject=function(){var e;function t(){}return e=function(r,a){return(Array(a+1).join("0")+r).slice(-a)},t.convert=function(r){var a,s,i,o;if(Array.isArray(r))return"["+function(){var l,c,d;for(d=[],l=0,c=r.length;l<c;l++)a=r[l],d.push(t.convert(a));return d}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+e(r.getUTCFullYear(),4)+e(r.getUTCMonth(),2)+e(r.getUTCDate(),2)+e(r.getUTCHours(),2)+e(r.getUTCMinutes(),2)+e(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(s in i=["<<"],r)o=r[s],i.push("/"+s+" "+t.convert(o));return i.push(">>"),i.join(`
`)}return""+r},t}();/*!
 * html2canvas 1.4.1 <https://html2canvas.hertzen.com>
 * Copyright (c) 2022 Niklas von Hertzen <https://hertzen.com>
 * Released under MIT License
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var f_=function(e,t){return f_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(r[s]=a[s])},f_(e,t)};function No(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");f_(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var p_=function(){return p_=Object.assign||function(t){for(var r,a=1,s=arguments.length;a<s;a++){r=arguments[a];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},p_.apply(this,arguments)};function ws(e,t,r,a){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(u){try{d(a.next(u))}catch(f){o(f)}}function c(u){try{d(a.throw(u))}catch(f){o(f)}}function d(u){u.done?i(u.value):s(u.value).then(l,c)}d((a=a.apply(e,[])).next())})}function ss(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},a,s,i,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(d){return function(u){return c([d,u])}}function c(d){if(a)throw new TypeError("Generator is already executing.");for(;r;)try{if(a=1,s&&(i=d[0]&2?s.return:d[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,d[1])).done)return i;switch(s=0,i&&(d=[d[0]&2,i.value]),d[0]){case 0:case 1:i=d;break;case 4:return r.label++,{value:d[1],done:!1};case 5:r.label++,s=d[1],d=[0];continue;case 7:d=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(d[0]===6||d[0]===2)){r=0;continue}if(d[0]===3&&(!i||d[1]>i[0]&&d[1]<i[3])){r.label=d[1];break}if(d[0]===6&&r.label<i[1]){r.label=i[1],i=d;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(d);break}i[2]&&r.ops.pop(),r.trys.pop();continue}d=t.call(e,r)}catch(u){d=[6,u],s=0}finally{a=i=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}function am(e,t,r){if(arguments.length===2)for(var a=0,s=t.length,i;a<s;a++)(i||!(a in t))&&(i||(i=Array.prototype.slice.call(t,0,a)),i[a]=t[a]);return e.concat(i||t)}var Ml=function(){function e(t,r,a,s){this.left=t,this.top=r,this.width=a,this.height=s}return e.prototype.add=function(t,r,a,s){return new e(this.left+t,this.top+r,this.width+a,this.height+s)},e.fromClientRect=function(t,r){return new e(r.left+t.windowBounds.left,r.top+t.windowBounds.top,r.width,r.height)},e.fromDOMRectList=function(t,r){var a=Array.from(r).find(function(s){return s.width!==0});return a?new e(a.left+t.windowBounds.left,a.top+t.windowBounds.top,a.width,a.height):e.EMPTY},e.EMPTY=new e(0,0,0,0),e}(),qx=function(e,t){return Ml.fromClientRect(e,t.getBoundingClientRect())},PM=function(e){var t=e.body,r=e.documentElement;if(!t||!r)throw new Error("Unable to get document size");var a=Math.max(Math.max(t.scrollWidth,r.scrollWidth),Math.max(t.offsetWidth,r.offsetWidth),Math.max(t.clientWidth,r.clientWidth)),s=Math.max(Math.max(t.scrollHeight,r.scrollHeight),Math.max(t.offsetHeight,r.offsetHeight),Math.max(t.clientHeight,r.clientHeight));return new Ml(0,0,a,s)},$x=function(e){for(var t=[],r=0,a=e.length;r<a;){var s=e.charCodeAt(r++);if(s>=55296&&s<=56319&&r<a){var i=e.charCodeAt(r++);(i&64512)===56320?t.push(((s&1023)<<10)+(i&1023)+65536):(t.push(s),r--)}else t.push(s)}return t},Wn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(String.fromCodePoint)return String.fromCodePoint.apply(String,e);var r=e.length;if(!r)return"";for(var a=[],s=-1,i="";++s<r;){var o=e[s];o<=65535?a.push(o):(o-=65536,a.push((o>>10)+55296,o%1024+56320)),(s+1===r||a.length>16384)&&(i+=String.fromCharCode.apply(String,a),a.length=0)}return i},$4="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",OM=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var sm=0;sm<$4.length;sm++)OM[$4.charCodeAt(sm)]=sm;var K4="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",sf=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var im=0;im<K4.length;im++)sf[K4.charCodeAt(im)]=im;var UM=function(e){var t=e.length*.75,r=e.length,a,s=0,i,o,l,c;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);var d=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(t):new Array(t),u=Array.isArray(d)?d:new Uint8Array(d);for(a=0;a<r;a+=4)i=sf[e.charCodeAt(a)],o=sf[e.charCodeAt(a+1)],l=sf[e.charCodeAt(a+2)],c=sf[e.charCodeAt(a+3)],u[s++]=i<<2|o>>4,u[s++]=(o&15)<<4|l>>2,u[s++]=(l&3)<<6|c&63;return d},RM=function(e){for(var t=e.length,r=[],a=0;a<t;a+=2)r.push(e[a+1]<<8|e[a]);return r},MM=function(e){for(var t=e.length,r=[],a=0;a<t;a+=4)r.push(e[a+3]<<24|e[a+2]<<16|e[a+1]<<8|e[a]);return r},Ud=5,a2=11,Yv=2,QM=a2-Ud,C6=65536>>Ud,HM=1<<Ud,Jv=HM-1,qM=1024>>Ud,$M=C6+qM,KM=$M,VM=32,WM=KM+VM,zM=65536>>a2,GM=1<<QM,XM=GM-1,V4=function(e,t,r){return e.slice?e.slice(t,r):new Uint16Array(Array.prototype.slice.call(e,t,r))},YM=function(e,t,r){return e.slice?e.slice(t,r):new Uint32Array(Array.prototype.slice.call(e,t,r))},JM=function(e,t){var r=UM(e),a=Array.isArray(r)?MM(r):new Uint32Array(r),s=Array.isArray(r)?RM(r):new Uint16Array(r),i=24,o=V4(s,i/2,a[4]/2),l=a[5]===2?V4(s,(i+a[4])/2):YM(a,Math.ceil((i+a[4])/4));return new ZM(a[0],a[1],a[2],a[3],o,l)},ZM=function(){function e(t,r,a,s,i,o){this.initialValue=t,this.errorValue=r,this.highStart=a,this.highValueIndex=s,this.index=i,this.data=o}return e.prototype.get=function(t){var r;if(t>=0){if(t<55296||t>56319&&t<=65535)return r=this.index[t>>Ud],r=(r<<Yv)+(t&Jv),this.data[r];if(t<=65535)return r=this.index[C6+(t-55296>>Ud)],r=(r<<Yv)+(t&Jv),this.data[r];if(t<this.highStart)return r=WM-zM+(t>>a2),r=this.index[r],r+=t>>Ud&XM,r=this.index[r],r=(r<<Yv)+(t&Jv),this.data[r];if(t<=1114111)return this.data[this.highValueIndex]}return this.errorValue},e}(),W4="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",eQ=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var om=0;om<W4.length;om++)eQ[W4.charCodeAt(om)]=om;var tQ="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",z4=50,rQ=1,S6=2,B6=3,nQ=4,aQ=5,G4=7,E6=8,X4=9,kc=10,m_=11,Y4=12,g_=13,sQ=14,of=15,x_=16,lm=17,Mh=18,iQ=19,J4=20,y_=21,Qh=22,Zv=23,Du=24,ii=25,lf=26,cf=27,Lu=28,oQ=29,Cd=30,lQ=31,cm=32,dm=33,v_=34,b_=35,__=36,f0=37,w_=38,og=39,lg=40,e1=41,F6=42,cQ=43,dQ=[9001,65288],T6="!",kr="",um="",N_=JM(tQ),vl=[Cd,__],j_=[rQ,S6,B6,aQ],I6=[kc,E6],Z4=[cf,lf],uQ=j_.concat(I6),ek=[w_,og,lg,v_,b_],AQ=[of,g_],hQ=function(e,t){t===void 0&&(t="strict");var r=[],a=[],s=[];return e.forEach(function(i,o){var l=N_.get(i);if(l>z4?(s.push(!0),l-=z4):s.push(!1),["normal","auto","loose"].indexOf(t)!==-1&&[8208,8211,12316,12448].indexOf(i)!==-1)return a.push(o),r.push(x_);if(l===nQ||l===m_){if(o===0)return a.push(o),r.push(Cd);var c=r[o-1];return uQ.indexOf(c)===-1?(a.push(a[o-1]),r.push(c)):(a.push(o),r.push(Cd))}if(a.push(o),l===lQ)return r.push(t==="strict"?y_:f0);if(l===F6||l===oQ)return r.push(Cd);if(l===cQ)return i>=131072&&i<=196605||i>=196608&&i<=262141?r.push(f0):r.push(Cd);r.push(l)}),[a,r,s]},t1=function(e,t,r,a){var s=a[r];if(Array.isArray(e)?e.indexOf(s)!==-1:e===s)for(var i=r;i<=a.length;){i++;var o=a[i];if(o===t)return!0;if(o!==kc)break}if(s===kc)for(var i=r;i>0;){i--;var l=a[i];if(Array.isArray(e)?e.indexOf(l)!==-1:e===l)for(var c=r;c<=a.length;){c++;var o=a[c];if(o===t)return!0;if(o!==kc)break}if(l!==kc)break}return!1},tk=function(e,t){for(var r=e;r>=0;){var a=t[r];if(a===kc)r--;else return a}return 0},fQ=function(e,t,r,a,s){if(r[a]===0)return kr;var i=a-1;if(Array.isArray(s)&&s[i]===!0)return kr;var o=i-1,l=i+1,c=t[i],d=o>=0?t[o]:0,u=t[l];if(c===S6&&u===B6)return kr;if(j_.indexOf(c)!==-1)return T6;if(j_.indexOf(u)!==-1||I6.indexOf(u)!==-1)return kr;if(tk(i,t)===E6)return um;if(N_.get(e[i])===m_||(c===cm||c===dm)&&N_.get(e[l])===m_||c===G4||u===G4||c===X4||[kc,g_,of].indexOf(c)===-1&&u===X4||[lm,Mh,iQ,Du,Lu].indexOf(u)!==-1||tk(i,t)===Qh||t1(Zv,Qh,i,t)||t1([lm,Mh],y_,i,t)||t1(Y4,Y4,i,t))return kr;if(c===kc)return um;if(c===Zv||u===Zv)return kr;if(u===x_||c===x_)return um;if([g_,of,y_].indexOf(u)!==-1||c===sQ||d===__&&AQ.indexOf(c)!==-1||c===Lu&&u===__||u===J4||vl.indexOf(u)!==-1&&c===ii||vl.indexOf(c)!==-1&&u===ii||c===cf&&[f0,cm,dm].indexOf(u)!==-1||[f0,cm,dm].indexOf(c)!==-1&&u===lf||vl.indexOf(c)!==-1&&Z4.indexOf(u)!==-1||Z4.indexOf(c)!==-1&&vl.indexOf(u)!==-1||[cf,lf].indexOf(c)!==-1&&(u===ii||[Qh,of].indexOf(u)!==-1&&t[l+1]===ii)||[Qh,of].indexOf(c)!==-1&&u===ii||c===ii&&[ii,Lu,Du].indexOf(u)!==-1)return kr;if([ii,Lu,Du,lm,Mh].indexOf(u)!==-1)for(var f=i;f>=0;){var h=t[f];if(h===ii)return kr;if([Lu,Du].indexOf(h)!==-1)f--;else break}if([cf,lf].indexOf(u)!==-1)for(var f=[lm,Mh].indexOf(c)!==-1?o:i;f>=0;){var h=t[f];if(h===ii)return kr;if([Lu,Du].indexOf(h)!==-1)f--;else break}if(w_===c&&[w_,og,v_,b_].indexOf(u)!==-1||[og,v_].indexOf(c)!==-1&&[og,lg].indexOf(u)!==-1||[lg,b_].indexOf(c)!==-1&&u===lg||ek.indexOf(c)!==-1&&[J4,lf].indexOf(u)!==-1||ek.indexOf(u)!==-1&&c===cf||vl.indexOf(c)!==-1&&vl.indexOf(u)!==-1||c===Du&&vl.indexOf(u)!==-1||vl.concat(ii).indexOf(c)!==-1&&u===Qh&&dQ.indexOf(e[l])===-1||vl.concat(ii).indexOf(u)!==-1&&c===Mh)return kr;if(c===e1&&u===e1){for(var A=r[i],x=1;A>0&&(A--,t[A]===e1);)x++;if(x%2!==0)return kr}return c===cm&&u===dm?kr:um},pQ=function(e,t){t||(t={lineBreak:"normal",wordBreak:"normal"});var r=hQ(e,t.lineBreak),a=r[0],s=r[1],i=r[2];(t.wordBreak==="break-all"||t.wordBreak==="break-word")&&(s=s.map(function(l){return[ii,Cd,F6].indexOf(l)!==-1?f0:l}));var o=t.wordBreak==="keep-all"?i.map(function(l,c){return l&&e[c]>=19968&&e[c]<=40959}):void 0;return[a,s,o]},mQ=function(){function e(t,r,a,s){this.codePoints=t,this.required=r===T6,this.start=a,this.end=s}return e.prototype.slice=function(){return Wn.apply(void 0,this.codePoints.slice(this.start,this.end))},e}(),gQ=function(e,t){var r=$x(e),a=pQ(r,t),s=a[0],i=a[1],o=a[2],l=r.length,c=0,d=0;return{next:function(){if(d>=l)return{done:!0,value:null};for(var u=kr;d<l&&(u=fQ(r,i,s,++d,o))===kr;);if(u!==kr||d===l){var f=new mQ(r,u,c,d);return c=d,{value:f,done:!1}}return{done:!0,value:null}}}},xQ=1,yQ=2,M0=4,rk=8,Vg=10,nk=47,Bf=92,vQ=9,bQ=32,Am=34,Hh=61,_Q=35,wQ=36,NQ=37,hm=39,fm=40,qh=41,jQ=95,Rs=45,kQ=33,CQ=60,SQ=62,BQ=64,EQ=91,FQ=93,TQ=61,IQ=123,pm=63,DQ=125,ak=124,LQ=126,PQ=128,sk=65533,r1=42,Id=43,OQ=44,UQ=58,RQ=59,p0=46,MQ=0,QQ=8,HQ=11,qQ=14,$Q=31,KQ=127,To=-1,D6=48,L6=97,P6=101,VQ=102,WQ=117,zQ=122,O6=65,U6=69,R6=70,GQ=85,XQ=90,os=function(e){return e>=D6&&e<=57},YQ=function(e){return e>=55296&&e<=57343},Pu=function(e){return os(e)||e>=O6&&e<=R6||e>=L6&&e<=VQ},JQ=function(e){return e>=L6&&e<=zQ},ZQ=function(e){return e>=O6&&e<=XQ},eH=function(e){return JQ(e)||ZQ(e)},tH=function(e){return e>=PQ},mm=function(e){return e===Vg||e===vQ||e===bQ},Wg=function(e){return eH(e)||tH(e)||e===jQ},ik=function(e){return Wg(e)||os(e)||e===Rs},rH=function(e){return e>=MQ&&e<=QQ||e===HQ||e>=qQ&&e<=$Q||e===KQ},yc=function(e,t){return e!==Bf?!1:t!==Vg},gm=function(e,t,r){return e===Rs?Wg(t)||yc(t,r):Wg(e)?!0:!!(e===Bf&&yc(e,t))},n1=function(e,t,r){return e===Id||e===Rs?os(t)?!0:t===p0&&os(r):os(e===p0?t:e)},nH=function(e){var t=0,r=1;(e[t]===Id||e[t]===Rs)&&(e[t]===Rs&&(r=-1),t++);for(var a=[];os(e[t]);)a.push(e[t++]);var s=a.length?parseInt(Wn.apply(void 0,a),10):0;e[t]===p0&&t++;for(var i=[];os(e[t]);)i.push(e[t++]);var o=i.length,l=o?parseInt(Wn.apply(void 0,i),10):0;(e[t]===U6||e[t]===P6)&&t++;var c=1;(e[t]===Id||e[t]===Rs)&&(e[t]===Rs&&(c=-1),t++);for(var d=[];os(e[t]);)d.push(e[t++]);var u=d.length?parseInt(Wn.apply(void 0,d),10):0;return r*(s+l*Math.pow(10,-o))*Math.pow(10,c*u)},aH={type:2},sH={type:3},iH={type:4},oH={type:13},lH={type:8},cH={type:21},dH={type:9},uH={type:10},AH={type:11},hH={type:12},fH={type:14},xm={type:23},pH={type:1},mH={type:25},gH={type:24},xH={type:26},yH={type:27},vH={type:28},bH={type:29},_H={type:31},k_={type:32},M6=function(){function e(){this._value=[]}return e.prototype.write=function(t){this._value=this._value.concat($x(t))},e.prototype.read=function(){for(var t=[],r=this.consumeToken();r!==k_;)t.push(r),r=this.consumeToken();return t},e.prototype.consumeToken=function(){var t=this.consumeCodePoint();switch(t){case Am:return this.consumeStringToken(Am);case _Q:var r=this.peekCodePoint(0),a=this.peekCodePoint(1),s=this.peekCodePoint(2);if(ik(r)||yc(a,s)){var i=gm(r,a,s)?yQ:xQ,o=this.consumeName();return{type:5,value:o,flags:i}}break;case wQ:if(this.peekCodePoint(0)===Hh)return this.consumeCodePoint(),oH;break;case hm:return this.consumeStringToken(hm);case fm:return aH;case qh:return sH;case r1:if(this.peekCodePoint(0)===Hh)return this.consumeCodePoint(),fH;break;case Id:if(n1(t,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();break;case OQ:return iH;case Rs:var l=t,c=this.peekCodePoint(0),d=this.peekCodePoint(1);if(n1(l,c,d))return this.reconsumeCodePoint(t),this.consumeNumericToken();if(gm(l,c,d))return this.reconsumeCodePoint(t),this.consumeIdentLikeToken();if(c===Rs&&d===SQ)return this.consumeCodePoint(),this.consumeCodePoint(),gH;break;case p0:if(n1(t,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();break;case nk:if(this.peekCodePoint(0)===r1)for(this.consumeCodePoint();;){var u=this.consumeCodePoint();if(u===r1&&(u=this.consumeCodePoint(),u===nk))return this.consumeToken();if(u===To)return this.consumeToken()}break;case UQ:return xH;case RQ:return yH;case CQ:if(this.peekCodePoint(0)===kQ&&this.peekCodePoint(1)===Rs&&this.peekCodePoint(2)===Rs)return this.consumeCodePoint(),this.consumeCodePoint(),mH;break;case BQ:var f=this.peekCodePoint(0),h=this.peekCodePoint(1),A=this.peekCodePoint(2);if(gm(f,h,A)){var o=this.consumeName();return{type:7,value:o}}break;case EQ:return vH;case Bf:if(yc(t,this.peekCodePoint(0)))return this.reconsumeCodePoint(t),this.consumeIdentLikeToken();break;case FQ:return bH;case TQ:if(this.peekCodePoint(0)===Hh)return this.consumeCodePoint(),lH;break;case IQ:return AH;case DQ:return hH;case WQ:case GQ:var x=this.peekCodePoint(0),p=this.peekCodePoint(1);return x===Id&&(Pu(p)||p===pm)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(t),this.consumeIdentLikeToken();case ak:if(this.peekCodePoint(0)===Hh)return this.consumeCodePoint(),dH;if(this.peekCodePoint(0)===ak)return this.consumeCodePoint(),cH;break;case LQ:if(this.peekCodePoint(0)===Hh)return this.consumeCodePoint(),uH;break;case To:return k_}return mm(t)?(this.consumeWhiteSpace(),_H):os(t)?(this.reconsumeCodePoint(t),this.consumeNumericToken()):Wg(t)?(this.reconsumeCodePoint(t),this.consumeIdentLikeToken()):{type:6,value:Wn(t)}},e.prototype.consumeCodePoint=function(){var t=this._value.shift();return typeof t>"u"?-1:t},e.prototype.reconsumeCodePoint=function(t){this._value.unshift(t)},e.prototype.peekCodePoint=function(t){return t>=this._value.length?-1:this._value[t]},e.prototype.consumeUnicodeRangeToken=function(){for(var t=[],r=this.consumeCodePoint();Pu(r)&&t.length<6;)t.push(r),r=this.consumeCodePoint();for(var a=!1;r===pm&&t.length<6;)t.push(r),r=this.consumeCodePoint(),a=!0;if(a){var s=parseInt(Wn.apply(void 0,t.map(function(c){return c===pm?D6:c})),16),i=parseInt(Wn.apply(void 0,t.map(function(c){return c===pm?R6:c})),16);return{type:30,start:s,end:i}}var o=parseInt(Wn.apply(void 0,t),16);if(this.peekCodePoint(0)===Rs&&Pu(this.peekCodePoint(1))){this.consumeCodePoint(),r=this.consumeCodePoint();for(var l=[];Pu(r)&&l.length<6;)l.push(r),r=this.consumeCodePoint();var i=parseInt(Wn.apply(void 0,l),16);return{type:30,start:o,end:i}}else return{type:30,start:o,end:o}},e.prototype.consumeIdentLikeToken=function(){var t=this.consumeName();return t.toLowerCase()==="url"&&this.peekCodePoint(0)===fm?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===fm?(this.consumeCodePoint(),{type:19,value:t}):{type:20,value:t}},e.prototype.consumeUrlToken=function(){var t=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===To)return{type:22,value:""};var r=this.peekCodePoint(0);if(r===hm||r===Am){var a=this.consumeStringToken(this.consumeCodePoint());return a.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===To||this.peekCodePoint(0)===qh)?(this.consumeCodePoint(),{type:22,value:a.value}):(this.consumeBadUrlRemnants(),xm)}for(;;){var s=this.consumeCodePoint();if(s===To||s===qh)return{type:22,value:Wn.apply(void 0,t)};if(mm(s))return this.consumeWhiteSpace(),this.peekCodePoint(0)===To||this.peekCodePoint(0)===qh?(this.consumeCodePoint(),{type:22,value:Wn.apply(void 0,t)}):(this.consumeBadUrlRemnants(),xm);if(s===Am||s===hm||s===fm||rH(s))return this.consumeBadUrlRemnants(),xm;if(s===Bf)if(yc(s,this.peekCodePoint(0)))t.push(this.consumeEscapedCodePoint());else return this.consumeBadUrlRemnants(),xm;else t.push(s)}},e.prototype.consumeWhiteSpace=function(){for(;mm(this.peekCodePoint(0));)this.consumeCodePoint()},e.prototype.consumeBadUrlRemnants=function(){for(;;){var t=this.consumeCodePoint();if(t===qh||t===To)return;yc(t,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},e.prototype.consumeStringSlice=function(t){for(var r=5e4,a="";t>0;){var s=Math.min(r,t);a+=Wn.apply(void 0,this._value.splice(0,s)),t-=s}return this._value.shift(),a},e.prototype.consumeStringToken=function(t){var r="",a=0;do{var s=this._value[a];if(s===To||s===void 0||s===t)return r+=this.consumeStringSlice(a),{type:0,value:r};if(s===Vg)return this._value.splice(0,a),pH;if(s===Bf){var i=this._value[a+1];i!==To&&i!==void 0&&(i===Vg?(r+=this.consumeStringSlice(a),a=-1,this._value.shift()):yc(s,i)&&(r+=this.consumeStringSlice(a),r+=Wn(this.consumeEscapedCodePoint()),a=-1))}a++}while(!0)},e.prototype.consumeNumber=function(){var t=[],r=M0,a=this.peekCodePoint(0);for((a===Id||a===Rs)&&t.push(this.consumeCodePoint());os(this.peekCodePoint(0));)t.push(this.consumeCodePoint());a=this.peekCodePoint(0);var s=this.peekCodePoint(1);if(a===p0&&os(s))for(t.push(this.consumeCodePoint(),this.consumeCodePoint()),r=rk;os(this.peekCodePoint(0));)t.push(this.consumeCodePoint());a=this.peekCodePoint(0),s=this.peekCodePoint(1);var i=this.peekCodePoint(2);if((a===U6||a===P6)&&((s===Id||s===Rs)&&os(i)||os(s)))for(t.push(this.consumeCodePoint(),this.consumeCodePoint()),r=rk;os(this.peekCodePoint(0));)t.push(this.consumeCodePoint());return[nH(t),r]},e.prototype.consumeNumericToken=function(){var t=this.consumeNumber(),r=t[0],a=t[1],s=this.peekCodePoint(0),i=this.peekCodePoint(1),o=this.peekCodePoint(2);if(gm(s,i,o)){var l=this.consumeName();return{type:15,number:r,flags:a,unit:l}}return s===NQ?(this.consumeCodePoint(),{type:16,number:r,flags:a}):{type:17,number:r,flags:a}},e.prototype.consumeEscapedCodePoint=function(){var t=this.consumeCodePoint();if(Pu(t)){for(var r=Wn(t);Pu(this.peekCodePoint(0))&&r.length<6;)r+=Wn(this.consumeCodePoint());mm(this.peekCodePoint(0))&&this.consumeCodePoint();var a=parseInt(r,16);return a===0||YQ(a)||a>1114111?sk:a}return t===To?sk:t},e.prototype.consumeName=function(){for(var t="";;){var r=this.consumeCodePoint();if(ik(r))t+=Wn(r);else if(yc(r,this.peekCodePoint(0)))t+=Wn(this.consumeEscapedCodePoint());else return this.reconsumeCodePoint(r),t}},e}(),Q6=function(){function e(t){this._tokens=t}return e.create=function(t){var r=new M6;return r.write(t),new e(r.read())},e.parseValue=function(t){return e.create(t).parseComponentValue()},e.parseValues=function(t){return e.create(t).parseComponentValues()},e.prototype.parseComponentValue=function(){for(var t=this.consumeToken();t.type===31;)t=this.consumeToken();if(t.type===32)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(t);var r=this.consumeComponentValue();do t=this.consumeToken();while(t.type===31);if(t.type===32)return r;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},e.prototype.parseComponentValues=function(){for(var t=[];;){var r=this.consumeComponentValue();if(r.type===32)return t;t.push(r),t.push()}},e.prototype.consumeComponentValue=function(){var t=this.consumeToken();switch(t.type){case 11:case 28:case 2:return this.consumeSimpleBlock(t.type);case 19:return this.consumeFunction(t)}return t},e.prototype.consumeSimpleBlock=function(t){for(var r={type:t,values:[]},a=this.consumeToken();;){if(a.type===32||NH(a,t))return r;this.reconsumeToken(a),r.values.push(this.consumeComponentValue()),a=this.consumeToken()}},e.prototype.consumeFunction=function(t){for(var r={name:t.value,values:[],type:18};;){var a=this.consumeToken();if(a.type===32||a.type===3)return r;this.reconsumeToken(a),r.values.push(this.consumeComponentValue())}},e.prototype.consumeToken=function(){var t=this._tokens.shift();return typeof t>"u"?k_:t},e.prototype.reconsumeToken=function(t){this._tokens.unshift(t)},e}(),Q0=function(e){return e.type===15},WA=function(e){return e.type===17},Yr=function(e){return e.type===20},wH=function(e){return e.type===0},C_=function(e,t){return Yr(e)&&e.value===t},H6=function(e){return e.type!==31},UA=function(e){return e.type!==31&&e.type!==4},Yo=function(e){var t=[],r=[];return e.forEach(function(a){if(a.type===4){if(r.length===0)throw new Error("Error parsing function args, zero tokens for arg");t.push(r),r=[];return}a.type!==31&&r.push(a)}),r.length&&t.push(r),t},NH=function(e,t){return t===11&&e.type===12||t===28&&e.type===29?!0:t===2&&e.type===3},Kc=function(e){return e.type===17||e.type===15},la=function(e){return e.type===16||Kc(e)},q6=function(e){return e.length>1?[e[0],e[1]]:[e[0]]},Wa={type:17,number:0,flags:M0},s2={type:16,number:50,flags:M0},Cc={type:16,number:100,flags:M0},df=function(e,t,r){var a=e[0],s=e[1];return[on(a,t),on(typeof s<"u"?s:a,r)]},on=function(e,t){if(e.type===16)return e.number/100*t;if(Q0(e))switch(e.unit){case"rem":case"em":return 16*e.number;case"px":default:return e.number}return e.number},$6="deg",K6="grad",V6="rad",W6="turn",Kx={name:"angle",parse:function(e,t){if(t.type===15)switch(t.unit){case $6:return Math.PI*t.number/180;case K6:return Math.PI/200*t.number;case V6:return t.number;case W6:return Math.PI*2*t.number}throw new Error("Unsupported angle type")}},z6=function(e){return e.type===15&&(e.unit===$6||e.unit===K6||e.unit===V6||e.unit===W6)},G6=function(e){var t=e.filter(Yr).map(function(r){return r.value}).join(" ");switch(t){case"to bottom right":case"to right bottom":case"left top":case"top left":return[Wa,Wa];case"to top":case"bottom":return Ui(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[Wa,Cc];case"to right":case"left":return Ui(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[Cc,Cc];case"to bottom":case"top":return Ui(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[Cc,Wa];case"to left":case"right":return Ui(270)}return 0},Ui=function(e){return Math.PI*e/180},Mc={name:"color",parse:function(e,t){if(t.type===18){var r=jH[t.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported color function "'+t.name+'"');return r(e,t.values)}if(t.type===5){if(t.value.length===3){var a=t.value.substring(0,1),s=t.value.substring(1,2),i=t.value.substring(2,3);return Sc(parseInt(a+a,16),parseInt(s+s,16),parseInt(i+i,16),1)}if(t.value.length===4){var a=t.value.substring(0,1),s=t.value.substring(1,2),i=t.value.substring(2,3),o=t.value.substring(3,4);return Sc(parseInt(a+a,16),parseInt(s+s,16),parseInt(i+i,16),parseInt(o+o,16)/255)}if(t.value.length===6){var a=t.value.substring(0,2),s=t.value.substring(2,4),i=t.value.substring(4,6);return Sc(parseInt(a,16),parseInt(s,16),parseInt(i,16),1)}if(t.value.length===8){var a=t.value.substring(0,2),s=t.value.substring(2,4),i=t.value.substring(4,6),o=t.value.substring(6,8);return Sc(parseInt(a,16),parseInt(s,16),parseInt(i,16),parseInt(o,16)/255)}}if(t.type===20){var l=El[t.value.toUpperCase()];if(typeof l<"u")return l}return El.TRANSPARENT}},Qc=function(e){return(255&e)===0},Sa=function(e){var t=255&e,r=255&e>>8,a=255&e>>16,s=255&e>>24;return t<255?"rgba("+s+","+a+","+r+","+t/255+")":"rgb("+s+","+a+","+r+")"},Sc=function(e,t,r,a){return(e<<24|t<<16|r<<8|Math.round(a*255)<<0)>>>0},ok=function(e,t){if(e.type===17)return e.number;if(e.type===16){var r=t===3?1:255;return t===3?e.number/100*r:Math.round(e.number/100*r)}return 0},lk=function(e,t){var r=t.filter(UA);if(r.length===3){var a=r.map(ok),s=a[0],i=a[1],o=a[2];return Sc(s,i,o,1)}if(r.length===4){var l=r.map(ok),s=l[0],i=l[1],o=l[2],c=l[3];return Sc(s,i,o,c)}return 0};function a1(e,t,r){return r<0&&(r+=1),r>=1&&(r-=1),r<1/6?(t-e)*r*6+e:r<1/2?t:r<2/3?(t-e)*6*(2/3-r)+e:e}var ck=function(e,t){var r=t.filter(UA),a=r[0],s=r[1],i=r[2],o=r[3],l=(a.type===17?Ui(a.number):Kx.parse(e,a))/(Math.PI*2),c=la(s)?s.number/100:0,d=la(i)?i.number/100:0,u=typeof o<"u"&&la(o)?on(o,1):1;if(c===0)return Sc(d*255,d*255,d*255,1);var f=d<=.5?d*(c+1):d+c-d*c,h=d*2-f,A=a1(h,f,l+1/3),x=a1(h,f,l),p=a1(h,f,l-1/3);return Sc(A*255,x*255,p*255,u)},jH={hsl:ck,hsla:ck,rgb:lk,rgba:lk},Ef=function(e,t){return Mc.parse(e,Q6.create(t).parseComponentValue())},El={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},kH={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(e,t){return t.map(function(r){if(Yr(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},CH={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Vx=function(e,t){var r=Mc.parse(e,t[0]),a=t[1];return a&&la(a)?{color:r,stop:a}:{color:r,stop:null}},dk=function(e,t){var r=e[0],a=e[e.length-1];r.stop===null&&(r.stop=Wa),a.stop===null&&(a.stop=Cc);for(var s=[],i=0,o=0;o<e.length;o++){var l=e[o].stop;if(l!==null){var c=on(l,t);c>i?s.push(c):s.push(i),i=c}else s.push(null)}for(var d=null,o=0;o<s.length;o++){var u=s[o];if(u===null)d===null&&(d=o);else if(d!==null){for(var f=o-d,h=s[d-1],A=(u-h)/(f+1),x=1;x<=f;x++)s[d+x-1]=A*x;d=null}}return e.map(function(p,b){var m=p.color;return{color:m,stop:Math.max(Math.min(1,s[b]/t),0)}})},SH=function(e,t,r){var a=t/2,s=r/2,i=on(e[0],t)-a,o=s-on(e[1],r);return(Math.atan2(o,i)+Math.PI*2)%(Math.PI*2)},BH=function(e,t,r){var a=typeof e=="number"?e:SH(e,t,r),s=Math.abs(t*Math.sin(a))+Math.abs(r*Math.cos(a)),i=t/2,o=r/2,l=s/2,c=Math.sin(a-Math.PI/2)*l,d=Math.cos(a-Math.PI/2)*l;return[s,i-d,i+d,o-c,o+c]},ao=function(e,t){return Math.sqrt(e*e+t*t)},uk=function(e,t,r,a,s){var i=[[0,0],[0,t],[e,0],[e,t]];return i.reduce(function(o,l){var c=l[0],d=l[1],u=ao(r-c,a-d);return(s?u<o.optimumDistance:u>o.optimumDistance)?{optimumCorner:l,optimumDistance:u}:o},{optimumDistance:s?1/0:-1/0,optimumCorner:null}).optimumCorner},EH=function(e,t,r,a,s){var i=0,o=0;switch(e.size){case 0:e.shape===0?i=o=Math.min(Math.abs(t),Math.abs(t-a),Math.abs(r),Math.abs(r-s)):e.shape===1&&(i=Math.min(Math.abs(t),Math.abs(t-a)),o=Math.min(Math.abs(r),Math.abs(r-s)));break;case 2:if(e.shape===0)i=o=Math.min(ao(t,r),ao(t,r-s),ao(t-a,r),ao(t-a,r-s));else if(e.shape===1){var l=Math.min(Math.abs(r),Math.abs(r-s))/Math.min(Math.abs(t),Math.abs(t-a)),c=uk(a,s,t,r,!0),d=c[0],u=c[1];i=ao(d-t,(u-r)/l),o=l*i}break;case 1:e.shape===0?i=o=Math.max(Math.abs(t),Math.abs(t-a),Math.abs(r),Math.abs(r-s)):e.shape===1&&(i=Math.max(Math.abs(t),Math.abs(t-a)),o=Math.max(Math.abs(r),Math.abs(r-s)));break;case 3:if(e.shape===0)i=o=Math.max(ao(t,r),ao(t,r-s),ao(t-a,r),ao(t-a,r-s));else if(e.shape===1){var l=Math.max(Math.abs(r),Math.abs(r-s))/Math.max(Math.abs(t),Math.abs(t-a)),f=uk(a,s,t,r,!1),d=f[0],u=f[1];i=ao(d-t,(u-r)/l),o=l*i}break}return Array.isArray(e.size)&&(i=on(e.size[0],a),o=e.size.length===2?on(e.size[1],s):i),[i,o]},FH=function(e,t){var r=Ui(180),a=[];return Yo(t).forEach(function(s,i){if(i===0){var o=s[0];if(o.type===20&&o.value==="to"){r=G6(s);return}else if(z6(o)){r=Kx.parse(e,o);return}}var l=Vx(e,s);a.push(l)}),{angle:r,stops:a,type:1}},ym=function(e,t){var r=Ui(180),a=[];return Yo(t).forEach(function(s,i){if(i===0){var o=s[0];if(o.type===20&&["top","left","right","bottom"].indexOf(o.value)!==-1){r=G6(s);return}else if(z6(o)){r=(Kx.parse(e,o)+Ui(270))%Ui(360);return}}var l=Vx(e,s);a.push(l)}),{angle:r,stops:a,type:1}},TH=function(e,t){var r=Ui(180),a=[],s=1,i=0,o=3,l=[];return Yo(t).forEach(function(c,d){var u=c[0];if(d===0){if(Yr(u)&&u.value==="linear"){s=1;return}else if(Yr(u)&&u.value==="radial"){s=2;return}}if(u.type===18){if(u.name==="from"){var f=Mc.parse(e,u.values[0]);a.push({stop:Wa,color:f})}else if(u.name==="to"){var f=Mc.parse(e,u.values[0]);a.push({stop:Cc,color:f})}else if(u.name==="color-stop"){var h=u.values.filter(UA);if(h.length===2){var f=Mc.parse(e,h[1]),A=h[0];WA(A)&&a.push({stop:{type:16,number:A.number*100,flags:A.flags},color:f})}}}}),s===1?{angle:(r+Ui(180))%Ui(360),stops:a,type:s}:{size:o,shape:i,stops:a,position:l,type:s}},X6="closest-side",Y6="farthest-side",J6="closest-corner",Z6="farthest-corner",eF="circle",tF="ellipse",rF="cover",nF="contain",IH=function(e,t){var r=0,a=3,s=[],i=[];return Yo(t).forEach(function(o,l){var c=!0;if(l===0){var d=!1;c=o.reduce(function(f,h){if(d)if(Yr(h))switch(h.value){case"center":return i.push(s2),f;case"top":case"left":return i.push(Wa),f;case"right":case"bottom":return i.push(Cc),f}else(la(h)||Kc(h))&&i.push(h);else if(Yr(h))switch(h.value){case eF:return r=0,!1;case tF:return r=1,!1;case"at":return d=!0,!1;case X6:return a=0,!1;case rF:case Y6:return a=1,!1;case nF:case J6:return a=2,!1;case Z6:return a=3,!1}else if(Kc(h)||la(h))return Array.isArray(a)||(a=[]),a.push(h),!1;return f},c)}if(c){var u=Vx(e,o);s.push(u)}}),{size:a,shape:r,stops:s,position:i,type:2}},vm=function(e,t){var r=0,a=3,s=[],i=[];return Yo(t).forEach(function(o,l){var c=!0;if(l===0?c=o.reduce(function(u,f){if(Yr(f))switch(f.value){case"center":return i.push(s2),!1;case"top":case"left":return i.push(Wa),!1;case"right":case"bottom":return i.push(Cc),!1}else if(la(f)||Kc(f))return i.push(f),!1;return u},c):l===1&&(c=o.reduce(function(u,f){if(Yr(f))switch(f.value){case eF:return r=0,!1;case tF:return r=1,!1;case nF:case X6:return a=0,!1;case Y6:return a=1,!1;case J6:return a=2,!1;case rF:case Z6:return a=3,!1}else if(Kc(f)||la(f))return Array.isArray(a)||(a=[]),a.push(f),!1;return u},c)),c){var d=Vx(e,o);s.push(d)}}),{size:a,shape:r,stops:s,position:i,type:2}},DH=function(e){return e.type===1},LH=function(e){return e.type===2},i2={name:"image",parse:function(e,t){if(t.type===22){var r={url:t.value,type:0};return e.cache.addImage(t.value),r}if(t.type===18){var a=aF[t.name];if(typeof a>"u")throw new Error('Attempting to parse an unsupported image function "'+t.name+'"');return a(e,t.values)}throw new Error("Unsupported image type "+t.type)}};function PH(e){return!(e.type===20&&e.value==="none")&&(e.type!==18||!!aF[e.name])}var aF={"linear-gradient":FH,"-moz-linear-gradient":ym,"-ms-linear-gradient":ym,"-o-linear-gradient":ym,"-webkit-linear-gradient":ym,"radial-gradient":IH,"-moz-radial-gradient":vm,"-ms-radial-gradient":vm,"-o-radial-gradient":vm,"-webkit-radial-gradient":vm,"-webkit-gradient":TH},OH={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(e,t){if(t.length===0)return[];var r=t[0];return r.type===20&&r.value==="none"?[]:t.filter(function(a){return UA(a)&&PH(a)}).map(function(a){return i2.parse(e,a)})}},UH={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(e,t){return t.map(function(r){if(Yr(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},RH={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(e,t){return Yo(t).map(function(r){return r.filter(la)}).map(q6)}},MH={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(e,t){return Yo(t).map(function(r){return r.filter(Yr).map(function(a){return a.value}).join(" ")}).map(QH)}},QH=function(e){switch(e){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;case"repeat":default:return 0}},jA;(function(e){e.AUTO="auto",e.CONTAIN="contain",e.COVER="cover"})(jA||(jA={}));var HH={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(e,t){return Yo(t).map(function(r){return r.filter(qH)})}},qH=function(e){return Yr(e)||la(e)},Wx=function(e){return{name:"border-"+e+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},$H=Wx("top"),KH=Wx("right"),VH=Wx("bottom"),WH=Wx("left"),zx=function(e){return{name:"border-radius-"+e,initialValue:"0 0",prefix:!1,type:1,parse:function(t,r){return q6(r.filter(la))}}},zH=zx("top-left"),GH=zx("top-right"),XH=zx("bottom-right"),YH=zx("bottom-left"),Gx=function(e){return{name:"border-"+e+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(t,r){switch(r){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},JH=Gx("top"),ZH=Gx("right"),eq=Gx("bottom"),tq=Gx("left"),Xx=function(e){return{name:"border-"+e+"-width",initialValue:"0",type:0,prefix:!1,parse:function(t,r){return Q0(r)?r.number:0}}},rq=Xx("top"),nq=Xx("right"),aq=Xx("bottom"),sq=Xx("left"),iq={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},oq={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(e,t){switch(t){case"rtl":return 1;case"ltr":default:return 0}}},lq={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(e,t){return t.filter(Yr).reduce(function(r,a){return r|cq(a.value)},0)}},cq=function(e){switch(e){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},dq={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},uq={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(e,t){return t.type===20&&t.value==="normal"?0:t.type===17||t.type===15?t.number:0}},zg;(function(e){e.NORMAL="normal",e.STRICT="strict"})(zg||(zg={}));var Aq={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"strict":return zg.STRICT;case"normal":default:return zg.NORMAL}}},hq={name:"line-height",initialValue:"normal",prefix:!1,type:4},Ak=function(e,t){return Yr(e)&&e.value==="normal"?1.2*t:e.type===17?t*e.number:la(e)?on(e,t):t},fq={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(e,t){return t.type===20&&t.value==="none"?null:i2.parse(e,t)}},pq={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(e,t){switch(t){case"inside":return 0;case"outside":default:return 1}}},S_={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":return 22;case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;case"none":default:return-1}}},Yx=function(e){return{name:"margin-"+e,initialValue:"0",prefix:!1,type:4}},mq=Yx("top"),gq=Yx("right"),xq=Yx("bottom"),yq=Yx("left"),vq={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(e,t){return t.filter(Yr).map(function(r){switch(r.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;case"visible":default:return 0}})}},bq={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"break-word":return"break-word";case"normal":default:return"normal"}}},Jx=function(e){return{name:"padding-"+e,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},_q=Jx("top"),wq=Jx("right"),Nq=Jx("bottom"),jq=Jx("left"),kq={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(e,t){switch(t){case"right":return 2;case"center":case"justify":return 1;case"left":default:return 0}}},Cq={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(e,t){switch(t){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},Sq={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return t.length===1&&C_(t[0],"none")?[]:Yo(t).map(function(r){for(var a={color:El.TRANSPARENT,offsetX:Wa,offsetY:Wa,blur:Wa},s=0,i=0;i<r.length;i++){var o=r[i];Kc(o)?(s===0?a.offsetX=o:s===1?a.offsetY=o:a.blur=o,s++):a.color=Mc.parse(e,o)}return a})}},Bq={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},Eq={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(e,t){if(t.type===20&&t.value==="none")return null;if(t.type===18){var r=Iq[t.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported transform function "'+t.name+'"');return r(t.values)}return null}},Fq=function(e){var t=e.filter(function(r){return r.type===17}).map(function(r){return r.number});return t.length===6?t:null},Tq=function(e){var t=e.filter(function(c){return c.type===17}).map(function(c){return c.number}),r=t[0],a=t[1];t[2],t[3];var s=t[4],i=t[5];t[6],t[7],t[8],t[9],t[10],t[11];var o=t[12],l=t[13];return t[14],t[15],t.length===16?[r,a,s,i,o,l]:null},Iq={matrix:Fq,matrix3d:Tq},hk={type:16,number:50,flags:M0},Dq=[hk,hk],Lq={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(e,t){var r=t.filter(la);return r.length!==2?Dq:[r[0],r[1]]}},Pq={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(e,t){switch(t){case"hidden":return 1;case"collapse":return 2;case"visible":default:return 0}}},Ff;(function(e){e.NORMAL="normal",e.BREAK_ALL="break-all",e.KEEP_ALL="keep-all"})(Ff||(Ff={}));var Oq={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"break-all":return Ff.BREAK_ALL;case"keep-all":return Ff.KEEP_ALL;case"normal":default:return Ff.NORMAL}}},Uq={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(e,t){if(t.type===20)return{auto:!0,order:0};if(WA(t))return{auto:!1,order:t.number};throw new Error("Invalid z-index number parsed")}},sF={name:"time",parse:function(e,t){if(t.type===15)switch(t.unit.toLowerCase()){case"s":return 1e3*t.number;case"ms":return t.number}throw new Error("Unsupported time type")}},Rq={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(e,t){return WA(t)?t.number:1}},Mq={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Qq={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(e,t){return t.filter(Yr).map(function(r){switch(r.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(r){return r!==0})}},Hq={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(e,t){var r=[],a=[];return t.forEach(function(s){switch(s.type){case 20:case 0:r.push(s.value);break;case 17:r.push(s.number.toString());break;case 4:a.push(r.join(" ")),r.length=0;break}}),r.length&&a.push(r.join(" ")),a.map(function(s){return s.indexOf(" ")===-1?s:"'"+s+"'"})}},qq={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},$q={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(e,t){if(WA(t))return t.number;if(Yr(t))switch(t.value){case"bold":return 700;case"normal":default:return 400}return 400}},Kq={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return t.filter(Yr).map(function(r){return r.value})}},Vq={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(e,t){switch(t){case"oblique":return"oblique";case"italic":return"italic";case"normal":default:return"normal"}}},_a=function(e,t){return(e&t)!==0},Wq={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(e,t){if(t.length===0)return[];var r=t[0];return r.type===20&&r.value==="none"?[]:t}},zq={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(t.length===0)return null;var r=t[0];if(r.type===20&&r.value==="none")return null;for(var a=[],s=t.filter(H6),i=0;i<s.length;i++){var o=s[i],l=s[i+1];if(o.type===20){var c=l&&WA(l)?l.number:1;a.push({counter:o.value,increment:c})}}return a}},Gq={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(t.length===0)return[];for(var r=[],a=t.filter(H6),s=0;s<a.length;s++){var i=a[s],o=a[s+1];if(Yr(i)&&i.value!=="none"){var l=o&&WA(o)?o.number:0;r.push({counter:i.value,reset:l})}}return r}},Xq={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(e,t){return t.filter(Q0).map(function(r){return sF.parse(e,r)})}},Yq={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(e,t){if(t.length===0)return null;var r=t[0];if(r.type===20&&r.value==="none")return null;var a=[],s=t.filter(wH);if(s.length%2!==0)return null;for(var i=0;i<s.length;i+=2){var o=s[i].value,l=s[i+1].value;a.push({open:o,close:l})}return a}},fk=function(e,t,r){if(!e)return"";var a=e[Math.min(t,e.length-1)];return a?r?a.open:a.close:""},Jq={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(e,t){return t.length===1&&C_(t[0],"none")?[]:Yo(t).map(function(r){for(var a={color:255,offsetX:Wa,offsetY:Wa,blur:Wa,spread:Wa,inset:!1},s=0,i=0;i<r.length;i++){var o=r[i];C_(o,"inset")?a.inset=!0:Kc(o)?(s===0?a.offsetX=o:s===1?a.offsetY=o:s===2?a.blur=o:a.spread=o,s++):a.color=Mc.parse(e,o)}return a})}},Zq={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(e,t){var r=[0,1,2],a=[];return t.filter(Yr).forEach(function(s){switch(s.value){case"stroke":a.push(1);break;case"fill":a.push(0);break;case"markers":a.push(2);break}}),r.forEach(function(s){a.indexOf(s)===-1&&a.push(s)}),a}},e$={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},t$={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(e,t){return Q0(t)?t.number:0}},r$=function(){function e(t,r){var a,s;this.animationDuration=Lt(t,Xq,r.animationDuration),this.backgroundClip=Lt(t,kH,r.backgroundClip),this.backgroundColor=Lt(t,CH,r.backgroundColor),this.backgroundImage=Lt(t,OH,r.backgroundImage),this.backgroundOrigin=Lt(t,UH,r.backgroundOrigin),this.backgroundPosition=Lt(t,RH,r.backgroundPosition),this.backgroundRepeat=Lt(t,MH,r.backgroundRepeat),this.backgroundSize=Lt(t,HH,r.backgroundSize),this.borderTopColor=Lt(t,$H,r.borderTopColor),this.borderRightColor=Lt(t,KH,r.borderRightColor),this.borderBottomColor=Lt(t,VH,r.borderBottomColor),this.borderLeftColor=Lt(t,WH,r.borderLeftColor),this.borderTopLeftRadius=Lt(t,zH,r.borderTopLeftRadius),this.borderTopRightRadius=Lt(t,GH,r.borderTopRightRadius),this.borderBottomRightRadius=Lt(t,XH,r.borderBottomRightRadius),this.borderBottomLeftRadius=Lt(t,YH,r.borderBottomLeftRadius),this.borderTopStyle=Lt(t,JH,r.borderTopStyle),this.borderRightStyle=Lt(t,ZH,r.borderRightStyle),this.borderBottomStyle=Lt(t,eq,r.borderBottomStyle),this.borderLeftStyle=Lt(t,tq,r.borderLeftStyle),this.borderTopWidth=Lt(t,rq,r.borderTopWidth),this.borderRightWidth=Lt(t,nq,r.borderRightWidth),this.borderBottomWidth=Lt(t,aq,r.borderBottomWidth),this.borderLeftWidth=Lt(t,sq,r.borderLeftWidth),this.boxShadow=Lt(t,Jq,r.boxShadow),this.color=Lt(t,iq,r.color),this.direction=Lt(t,oq,r.direction),this.display=Lt(t,lq,r.display),this.float=Lt(t,dq,r.cssFloat),this.fontFamily=Lt(t,Hq,r.fontFamily),this.fontSize=Lt(t,qq,r.fontSize),this.fontStyle=Lt(t,Vq,r.fontStyle),this.fontVariant=Lt(t,Kq,r.fontVariant),this.fontWeight=Lt(t,$q,r.fontWeight),this.letterSpacing=Lt(t,uq,r.letterSpacing),this.lineBreak=Lt(t,Aq,r.lineBreak),this.lineHeight=Lt(t,hq,r.lineHeight),this.listStyleImage=Lt(t,fq,r.listStyleImage),this.listStylePosition=Lt(t,pq,r.listStylePosition),this.listStyleType=Lt(t,S_,r.listStyleType),this.marginTop=Lt(t,mq,r.marginTop),this.marginRight=Lt(t,gq,r.marginRight),this.marginBottom=Lt(t,xq,r.marginBottom),this.marginLeft=Lt(t,yq,r.marginLeft),this.opacity=Lt(t,Rq,r.opacity);var i=Lt(t,vq,r.overflow);this.overflowX=i[0],this.overflowY=i[i.length>1?1:0],this.overflowWrap=Lt(t,bq,r.overflowWrap),this.paddingTop=Lt(t,_q,r.paddingTop),this.paddingRight=Lt(t,wq,r.paddingRight),this.paddingBottom=Lt(t,Nq,r.paddingBottom),this.paddingLeft=Lt(t,jq,r.paddingLeft),this.paintOrder=Lt(t,Zq,r.paintOrder),this.position=Lt(t,Cq,r.position),this.textAlign=Lt(t,kq,r.textAlign),this.textDecorationColor=Lt(t,Mq,(a=r.textDecorationColor)!==null&&a!==void 0?a:r.color),this.textDecorationLine=Lt(t,Qq,(s=r.textDecorationLine)!==null&&s!==void 0?s:r.textDecoration),this.textShadow=Lt(t,Sq,r.textShadow),this.textTransform=Lt(t,Bq,r.textTransform),this.transform=Lt(t,Eq,r.transform),this.transformOrigin=Lt(t,Lq,r.transformOrigin),this.visibility=Lt(t,Pq,r.visibility),this.webkitTextStrokeColor=Lt(t,e$,r.webkitTextStrokeColor),this.webkitTextStrokeWidth=Lt(t,t$,r.webkitTextStrokeWidth),this.wordBreak=Lt(t,Oq,r.wordBreak),this.zIndex=Lt(t,Uq,r.zIndex)}return e.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===0},e.prototype.isTransparent=function(){return Qc(this.backgroundColor)},e.prototype.isTransformed=function(){return this.transform!==null},e.prototype.isPositioned=function(){return this.position!==0},e.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},e.prototype.isFloating=function(){return this.float!==0},e.prototype.isInlineLevel=function(){return _a(this.display,4)||_a(this.display,33554432)||_a(this.display,268435456)||_a(this.display,536870912)||_a(this.display,67108864)||_a(this.display,134217728)},e}(),n$=function(){function e(t,r){this.content=Lt(t,Wq,r.content),this.quotes=Lt(t,Yq,r.quotes)}return e}(),pk=function(){function e(t,r){this.counterIncrement=Lt(t,zq,r.counterIncrement),this.counterReset=Lt(t,Gq,r.counterReset)}return e}(),Lt=function(e,t,r){var a=new M6,s=r!==null&&typeof r<"u"?r.toString():t.initialValue;a.write(s);var i=new Q6(a.read());switch(t.type){case 2:var o=i.parseComponentValue();return t.parse(e,Yr(o)?o.value:t.initialValue);case 0:return t.parse(e,i.parseComponentValue());case 1:return t.parse(e,i.parseComponentValues());case 4:return i.parseComponentValue();case 3:switch(t.format){case"angle":return Kx.parse(e,i.parseComponentValue());case"color":return Mc.parse(e,i.parseComponentValue());case"image":return i2.parse(e,i.parseComponentValue());case"length":var l=i.parseComponentValue();return Kc(l)?l:Wa;case"length-percentage":var c=i.parseComponentValue();return la(c)?c:Wa;case"time":return sF.parse(e,i.parseComponentValue())}break}},a$="data-html2canvas-debug",s$=function(e){var t=e.getAttribute(a$);switch(t){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},B_=function(e,t){var r=s$(e);return r===1||t===r},Jo=function(){function e(t,r){if(this.context=t,this.textNodes=[],this.elements=[],this.flags=0,B_(r,3))debugger;this.styles=new r$(t,window.getComputedStyle(r,null)),T_(r)&&(this.styles.animationDuration.some(function(a){return a>0})&&(r.style.animationDuration="0s"),this.styles.transform!==null&&(r.style.transform="none")),this.bounds=qx(this.context,r),B_(r,4)&&(this.flags|=16)}return e}(),i$="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",mk="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",uf=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var bm=0;bm<mk.length;bm++)uf[mk.charCodeAt(bm)]=bm;var o$=function(e){var t=e.length*.75,r=e.length,a,s=0,i,o,l,c;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);var d=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(t):new Array(t),u=Array.isArray(d)?d:new Uint8Array(d);for(a=0;a<r;a+=4)i=uf[e.charCodeAt(a)],o=uf[e.charCodeAt(a+1)],l=uf[e.charCodeAt(a+2)],c=uf[e.charCodeAt(a+3)],u[s++]=i<<2|o>>4,u[s++]=(o&15)<<4|l>>2,u[s++]=(l&3)<<6|c&63;return d},l$=function(e){for(var t=e.length,r=[],a=0;a<t;a+=2)r.push(e[a+1]<<8|e[a]);return r},c$=function(e){for(var t=e.length,r=[],a=0;a<t;a+=4)r.push(e[a+3]<<24|e[a+2]<<16|e[a+1]<<8|e[a]);return r},Rd=5,o2=11,s1=2,d$=o2-Rd,iF=65536>>Rd,u$=1<<Rd,i1=u$-1,A$=1024>>Rd,h$=iF+A$,f$=h$,p$=32,m$=f$+p$,g$=65536>>o2,x$=1<<d$,y$=x$-1,gk=function(e,t,r){return e.slice?e.slice(t,r):new Uint16Array(Array.prototype.slice.call(e,t,r))},v$=function(e,t,r){return e.slice?e.slice(t,r):new Uint32Array(Array.prototype.slice.call(e,t,r))},b$=function(e,t){var r=o$(e),a=Array.isArray(r)?c$(r):new Uint32Array(r),s=Array.isArray(r)?l$(r):new Uint16Array(r),i=24,o=gk(s,i/2,a[4]/2),l=a[5]===2?gk(s,(i+a[4])/2):v$(a,Math.ceil((i+a[4])/4));return new _$(a[0],a[1],a[2],a[3],o,l)},_$=function(){function e(t,r,a,s,i,o){this.initialValue=t,this.errorValue=r,this.highStart=a,this.highValueIndex=s,this.index=i,this.data=o}return e.prototype.get=function(t){var r;if(t>=0){if(t<55296||t>56319&&t<=65535)return r=this.index[t>>Rd],r=(r<<s1)+(t&i1),this.data[r];if(t<=65535)return r=this.index[iF+(t-55296>>Rd)],r=(r<<s1)+(t&i1),this.data[r];if(t<this.highStart)return r=m$-g$+(t>>o2),r=this.index[r],r+=t>>Rd&y$,r=this.index[r],r=(r<<s1)+(t&i1),this.data[r];if(t<=1114111)return this.data[this.highValueIndex]}return this.errorValue},e}(),xk="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",w$=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var _m=0;_m<xk.length;_m++)w$[xk.charCodeAt(_m)]=_m;var N$=1,o1=2,l1=3,yk=4,vk=5,j$=7,bk=8,c1=9,d1=10,_k=11,wk=12,Nk=13,jk=14,u1=15,k$=function(e){for(var t=[],r=0,a=e.length;r<a;){var s=e.charCodeAt(r++);if(s>=55296&&s<=56319&&r<a){var i=e.charCodeAt(r++);(i&64512)===56320?t.push(((s&1023)<<10)+(i&1023)+65536):(t.push(s),r--)}else t.push(s)}return t},C$=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(String.fromCodePoint)return String.fromCodePoint.apply(String,e);var r=e.length;if(!r)return"";for(var a=[],s=-1,i="";++s<r;){var o=e[s];o<=65535?a.push(o):(o-=65536,a.push((o>>10)+55296,o%1024+56320)),(s+1===r||a.length>16384)&&(i+=String.fromCharCode.apply(String,a),a.length=0)}return i},S$=b$(i$),Fi="",A1="",B$=function(e){return S$.get(e)},E$=function(e,t,r){var a=r-2,s=t[a],i=t[r-1],o=t[r];if(i===o1&&o===l1)return Fi;if(i===o1||i===l1||i===yk||o===o1||o===l1||o===yk)return A1;if(i===bk&&[bk,c1,_k,wk].indexOf(o)!==-1||(i===_k||i===c1)&&(o===c1||o===d1)||(i===wk||i===d1)&&o===d1||o===Nk||o===vk||o===j$||i===N$)return Fi;if(i===Nk&&o===jk){for(;s===vk;)s=t[--a];if(s===jk)return Fi}if(i===u1&&o===u1){for(var l=0;s===u1;)l++,s=t[--a];if(l%2===0)return Fi}return A1},F$=function(e){var t=k$(e),r=t.length,a=0,s=0,i=t.map(B$);return{next:function(){if(a>=r)return{done:!0,value:null};for(var o=Fi;a<r&&(o=E$(t,i,++a))===Fi;);if(o!==Fi||a===r){var l=C$.apply(null,t.slice(s,a));return s=a,{value:l,done:!1}}return{done:!0,value:null}}}},T$=function(e){for(var t=F$(e),r=[],a;!(a=t.next()).done;)a.value&&r.push(a.value.slice());return r},I$=function(e){var t=123;if(e.createRange){var r=e.createRange();if(r.getBoundingClientRect){var a=e.createElement("boundtest");a.style.height=t+"px",a.style.display="block",e.body.appendChild(a),r.selectNode(a);var s=r.getBoundingClientRect(),i=Math.round(s.height);if(e.body.removeChild(a),i===t)return!0}}return!1},D$=function(e){var t=e.createElement("boundtest");t.style.width="50px",t.style.display="block",t.style.fontSize="12px",t.style.letterSpacing="0px",t.style.wordSpacing="0px",e.body.appendChild(t);var r=e.createRange();t.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";var a=t.firstChild,s=$x(a.data).map(function(c){return Wn(c)}),i=0,o={},l=s.every(function(c,d){r.setStart(a,i),r.setEnd(a,i+c.length);var u=r.getBoundingClientRect();i+=c.length;var f=u.x>o.x||u.y>o.y;return o=u,d===0?!0:f});return e.body.removeChild(t),l},L$=function(){return typeof new Image().crossOrigin<"u"},P$=function(){return typeof new XMLHttpRequest().responseType=="string"},O$=function(e){var t=new Image,r=e.createElement("canvas"),a=r.getContext("2d");if(!a)return!1;t.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{a.drawImage(t,0,0),r.toDataURL()}catch{return!1}return!0},kk=function(e){return e[0]===0&&e[1]===255&&e[2]===0&&e[3]===255},U$=function(e){var t=e.createElement("canvas"),r=100;t.width=r,t.height=r;var a=t.getContext("2d");if(!a)return Promise.reject(!1);a.fillStyle="rgb(0, 255, 0)",a.fillRect(0,0,r,r);var s=new Image,i=t.toDataURL();s.src=i;var o=E_(r,r,0,0,s);return a.fillStyle="red",a.fillRect(0,0,r,r),Ck(o).then(function(l){a.drawImage(l,0,0);var c=a.getImageData(0,0,r,r).data;a.fillStyle="red",a.fillRect(0,0,r,r);var d=e.createElement("div");return d.style.backgroundImage="url("+i+")",d.style.height=r+"px",kk(c)?Ck(E_(r,r,0,0,d)):Promise.reject(!1)}).then(function(l){return a.drawImage(l,0,0),kk(a.getImageData(0,0,r,r).data)}).catch(function(){return!1})},E_=function(e,t,r,a,s){var i="http://www.w3.org/2000/svg",o=document.createElementNS(i,"svg"),l=document.createElementNS(i,"foreignObject");return o.setAttributeNS(null,"width",e.toString()),o.setAttributeNS(null,"height",t.toString()),l.setAttributeNS(null,"width","100%"),l.setAttributeNS(null,"height","100%"),l.setAttributeNS(null,"x",r.toString()),l.setAttributeNS(null,"y",a.toString()),l.setAttributeNS(null,"externalResourcesRequired","true"),o.appendChild(l),l.appendChild(s),o},Ck=function(e){return new Promise(function(t,r){var a=new Image;a.onload=function(){return t(a)},a.onerror=r,a.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(e))})},$a={get SUPPORT_RANGE_BOUNDS(){var e=I$(document);return Object.defineProperty($a,"SUPPORT_RANGE_BOUNDS",{value:e}),e},get SUPPORT_WORD_BREAKING(){var e=$a.SUPPORT_RANGE_BOUNDS&&D$(document);return Object.defineProperty($a,"SUPPORT_WORD_BREAKING",{value:e}),e},get SUPPORT_SVG_DRAWING(){var e=O$(document);return Object.defineProperty($a,"SUPPORT_SVG_DRAWING",{value:e}),e},get SUPPORT_FOREIGNOBJECT_DRAWING(){var e=typeof Array.from=="function"&&typeof window.fetch=="function"?U$(document):Promise.resolve(!1);return Object.defineProperty($a,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:e}),e},get SUPPORT_CORS_IMAGES(){var e=L$();return Object.defineProperty($a,"SUPPORT_CORS_IMAGES",{value:e}),e},get SUPPORT_RESPONSE_TYPE(){var e=P$();return Object.defineProperty($a,"SUPPORT_RESPONSE_TYPE",{value:e}),e},get SUPPORT_CORS_XHR(){var e="withCredentials"in new XMLHttpRequest;return Object.defineProperty($a,"SUPPORT_CORS_XHR",{value:e}),e},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var e=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty($a,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:e}),e}},Tf=function(){function e(t,r){this.text=t,this.bounds=r}return e}(),R$=function(e,t,r,a){var s=H$(t,r),i=[],o=0;return s.forEach(function(l){if(r.textDecorationLine.length||l.trim().length>0)if($a.SUPPORT_RANGE_BOUNDS){var c=Sk(a,o,l.length).getClientRects();if(c.length>1){var d=l2(l),u=0;d.forEach(function(h){i.push(new Tf(h,Ml.fromDOMRectList(e,Sk(a,u+o,h.length).getClientRects()))),u+=h.length})}else i.push(new Tf(l,Ml.fromDOMRectList(e,c)))}else{var f=a.splitText(l.length);i.push(new Tf(l,M$(e,a))),a=f}else $a.SUPPORT_RANGE_BOUNDS||(a=a.splitText(l.length));o+=l.length}),i},M$=function(e,t){var r=t.ownerDocument;if(r){var a=r.createElement("html2canvaswrapper");a.appendChild(t.cloneNode(!0));var s=t.parentNode;if(s){s.replaceChild(a,t);var i=qx(e,a);return a.firstChild&&s.replaceChild(a.firstChild,a),i}}return Ml.EMPTY},Sk=function(e,t,r){var a=e.ownerDocument;if(!a)throw new Error("Node has no owner document");var s=a.createRange();return s.setStart(e,t),s.setEnd(e,t+r),s},l2=function(e){if($a.SUPPORT_NATIVE_TEXT_SEGMENTATION){var t=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(t.segment(e)).map(function(r){return r.segment})}return T$(e)},Q$=function(e,t){if($a.SUPPORT_NATIVE_TEXT_SEGMENTATION){var r=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(r.segment(e)).map(function(a){return a.segment})}return $$(e,t)},H$=function(e,t){return t.letterSpacing!==0?l2(e):Q$(e,t)},q$=[32,160,4961,65792,65793,4153,4241],$$=function(e,t){for(var r=gQ(e,{lineBreak:t.lineBreak,wordBreak:t.overflowWrap==="break-word"?"break-word":t.wordBreak}),a=[],s,i=function(){if(s.value){var o=s.value.slice(),l=$x(o),c="";l.forEach(function(d){q$.indexOf(d)===-1?c+=Wn(d):(c.length&&a.push(c),a.push(Wn(d)),c="")}),c.length&&a.push(c)}};!(s=r.next()).done;)i();return a},K$=function(){function e(t,r,a){this.text=V$(r.data,a.textTransform),this.textBounds=R$(t,this.text,a,r)}return e}(),V$=function(e,t){switch(t){case 1:return e.toLowerCase();case 3:return e.replace(W$,z$);case 2:return e.toUpperCase();default:return e}},W$=/(^|\s|:|-|\(|\))([a-z])/g,z$=function(e,t,r){return e.length>0?t+r.toUpperCase():e},oF=function(e){No(t,e);function t(r,a){var s=e.call(this,r,a)||this;return s.src=a.currentSrc||a.src,s.intrinsicWidth=a.naturalWidth,s.intrinsicHeight=a.naturalHeight,s.context.cache.addImage(s.src),s}return t}(Jo),lF=function(e){No(t,e);function t(r,a){var s=e.call(this,r,a)||this;return s.canvas=a,s.intrinsicWidth=a.width,s.intrinsicHeight=a.height,s}return t}(Jo),cF=function(e){No(t,e);function t(r,a){var s=e.call(this,r,a)||this,i=new XMLSerializer,o=qx(r,a);return a.setAttribute("width",o.width+"px"),a.setAttribute("height",o.height+"px"),s.svg="data:image/svg+xml,"+encodeURIComponent(i.serializeToString(a)),s.intrinsicWidth=a.width.baseVal.value,s.intrinsicHeight=a.height.baseVal.value,s.context.cache.addImage(s.svg),s}return t}(Jo),dF=function(e){No(t,e);function t(r,a){var s=e.call(this,r,a)||this;return s.value=a.value,s}return t}(Jo),F_=function(e){No(t,e);function t(r,a){var s=e.call(this,r,a)||this;return s.start=a.start,s.reversed=typeof a.reversed=="boolean"&&a.reversed===!0,s}return t}(Jo),G$=[{type:15,flags:0,unit:"px",number:3}],X$=[{type:16,flags:0,number:50}],Y$=function(e){return e.width>e.height?new Ml(e.left+(e.width-e.height)/2,e.top,e.height,e.height):e.width<e.height?new Ml(e.left,e.top+(e.height-e.width)/2,e.width,e.width):e},J$=function(e){var t=e.type===Z$?new Array(e.value.length+1).join(""):e.value;return t.length===0?e.placeholder||"":t},Gg="checkbox",Xg="radio",Z$="password",Bk=707406591,c2=function(e){No(t,e);function t(r,a){var s=e.call(this,r,a)||this;switch(s.type=a.type.toLowerCase(),s.checked=a.checked,s.value=J$(a),(s.type===Gg||s.type===Xg)&&(s.styles.backgroundColor=3739148031,s.styles.borderTopColor=s.styles.borderRightColor=s.styles.borderBottomColor=s.styles.borderLeftColor=2779096575,s.styles.borderTopWidth=s.styles.borderRightWidth=s.styles.borderBottomWidth=s.styles.borderLeftWidth=1,s.styles.borderTopStyle=s.styles.borderRightStyle=s.styles.borderBottomStyle=s.styles.borderLeftStyle=1,s.styles.backgroundClip=[0],s.styles.backgroundOrigin=[0],s.bounds=Y$(s.bounds)),s.type){case Gg:s.styles.borderTopRightRadius=s.styles.borderTopLeftRadius=s.styles.borderBottomRightRadius=s.styles.borderBottomLeftRadius=G$;break;case Xg:s.styles.borderTopRightRadius=s.styles.borderTopLeftRadius=s.styles.borderBottomRightRadius=s.styles.borderBottomLeftRadius=X$;break}return s}return t}(Jo),uF=function(e){No(t,e);function t(r,a){var s=e.call(this,r,a)||this,i=a.options[a.selectedIndex||0];return s.value=i&&i.text||"",s}return t}(Jo),AF=function(e){No(t,e);function t(r,a){var s=e.call(this,r,a)||this;return s.value=a.value,s}return t}(Jo),hF=function(e){No(t,e);function t(r,a){var s=e.call(this,r,a)||this;s.src=a.src,s.width=parseInt(a.width,10)||0,s.height=parseInt(a.height,10)||0,s.backgroundColor=s.styles.backgroundColor;try{if(a.contentWindow&&a.contentWindow.document&&a.contentWindow.document.documentElement){s.tree=pF(r,a.contentWindow.document.documentElement);var i=a.contentWindow.document.documentElement?Ef(r,getComputedStyle(a.contentWindow.document.documentElement).backgroundColor):El.TRANSPARENT,o=a.contentWindow.document.body?Ef(r,getComputedStyle(a.contentWindow.document.body).backgroundColor):El.TRANSPARENT;s.backgroundColor=Qc(i)?Qc(o)?s.styles.backgroundColor:o:i}}catch{}return s}return t}(Jo),eK=["OL","UL","MENU"],cg=function(e,t,r,a){for(var s=t.firstChild,i=void 0;s;s=i)if(i=s.nextSibling,mF(s)&&s.data.trim().length>0)r.textNodes.push(new K$(e,s,r.styles));else if(uA(s))if(vF(s)&&s.assignedNodes)s.assignedNodes().forEach(function(l){return cg(e,l,r,a)});else{var o=fF(e,s);o.styles.isVisible()&&(tK(s,o,a)?o.flags|=4:rK(o.styles)&&(o.flags|=2),eK.indexOf(s.tagName)!==-1&&(o.flags|=8),r.elements.push(o),s.slot,s.shadowRoot?cg(e,s.shadowRoot,o,a):!Yg(s)&&!gF(s)&&!Jg(s)&&cg(e,s,o,a))}},fF=function(e,t){return I_(t)?new oF(e,t):xF(t)?new lF(e,t):gF(t)?new cF(e,t):nK(t)?new dF(e,t):aK(t)?new F_(e,t):sK(t)?new c2(e,t):Jg(t)?new uF(e,t):Yg(t)?new AF(e,t):yF(t)?new hF(e,t):new Jo(e,t)},pF=function(e,t){var r=fF(e,t);return r.flags|=4,cg(e,t,r,r),r},tK=function(e,t,r){return t.styles.isPositionedWithZIndex()||t.styles.opacity<1||t.styles.isTransformed()||d2(e)&&r.styles.isTransparent()},rK=function(e){return e.isPositioned()||e.isFloating()},mF=function(e){return e.nodeType===Node.TEXT_NODE},uA=function(e){return e.nodeType===Node.ELEMENT_NODE},T_=function(e){return uA(e)&&typeof e.style<"u"&&!dg(e)},dg=function(e){return typeof e.className=="object"},nK=function(e){return e.tagName==="LI"},aK=function(e){return e.tagName==="OL"},sK=function(e){return e.tagName==="INPUT"},iK=function(e){return e.tagName==="HTML"},gF=function(e){return e.tagName==="svg"},d2=function(e){return e.tagName==="BODY"},xF=function(e){return e.tagName==="CANVAS"},Ek=function(e){return e.tagName==="VIDEO"},I_=function(e){return e.tagName==="IMG"},yF=function(e){return e.tagName==="IFRAME"},Fk=function(e){return e.tagName==="STYLE"},oK=function(e){return e.tagName==="SCRIPT"},Yg=function(e){return e.tagName==="TEXTAREA"},Jg=function(e){return e.tagName==="SELECT"},vF=function(e){return e.tagName==="SLOT"},Tk=function(e){return e.tagName.indexOf("-")>0},lK=function(){function e(){this.counters={}}return e.prototype.getCounterValue=function(t){var r=this.counters[t];return r&&r.length?r[r.length-1]:1},e.prototype.getCounterValues=function(t){var r=this.counters[t];return r||[]},e.prototype.pop=function(t){var r=this;t.forEach(function(a){return r.counters[a].pop()})},e.prototype.parse=function(t){var r=this,a=t.counterIncrement,s=t.counterReset,i=!0;a!==null&&a.forEach(function(l){var c=r.counters[l.counter];c&&l.increment!==0&&(i=!1,c.length||c.push(1),c[Math.max(0,c.length-1)]+=l.increment)});var o=[];return i&&s.forEach(function(l){var c=r.counters[l.counter];o.push(l.counter),c||(c=r.counters[l.counter]=[]),c.push(l.reset)}),o},e}(),Ik={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},Dk={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},cK={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},dK={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},Ou=function(e,t,r,a,s,i){return e<t||e>r?m0(e,s,i.length>0):a.integers.reduce(function(o,l,c){for(;e>=l;)e-=l,o+=a.values[c];return o},"")+i},bF=function(e,t,r,a){var s="";do r||e--,s=a(e)+s,e/=t;while(e*t>=t);return s},Kn=function(e,t,r,a,s){var i=r-t+1;return(e<0?"-":"")+(bF(Math.abs(e),i,a,function(o){return Wn(Math.floor(o%i)+t)})+s)},xd=function(e,t,r){r===void 0&&(r=". ");var a=t.length;return bF(Math.abs(e),a,!1,function(s){return t[Math.floor(s%a)]})+r},zu=1,fc=2,pc=4,Af=8,bl=function(e,t,r,a,s,i){if(e<-9999||e>9999)return m0(e,4,s.length>0);var o=Math.abs(e),l=s;if(o===0)return t[0]+l;for(var c=0;o>0&&c<=4;c++){var d=o%10;d===0&&_a(i,zu)&&l!==""?l=t[d]+l:d>1||d===1&&c===0||d===1&&c===1&&_a(i,fc)||d===1&&c===1&&_a(i,pc)&&e>100||d===1&&c>1&&_a(i,Af)?l=t[d]+(c>0?r[c-1]:"")+l:d===1&&c>0&&(l=r[c-1]+l),o=Math.floor(o/10)}return(e<0?a:"")+l},Lk="",Pk="",Ok="",h1="",m0=function(e,t,r){var a=r?". ":"",s=r?"":"",i=r?", ":"",o=r?" ":"";switch(t){case 0:return""+o;case 1:return""+o;case 2:return""+o;case 5:var l=Kn(e,48,57,!0,a);return l.length<4?"0"+l:l;case 4:return xd(e,"",s);case 6:return Ou(e,1,3999,Ik,3,a).toLowerCase();case 7:return Ou(e,1,3999,Ik,3,a);case 8:return Kn(e,945,969,!1,a);case 9:return Kn(e,97,122,!1,a);case 10:return Kn(e,65,90,!1,a);case 11:return Kn(e,1632,1641,!0,a);case 12:case 49:return Ou(e,1,9999,Dk,3,a);case 35:return Ou(e,1,9999,Dk,3,a).toLowerCase();case 13:return Kn(e,2534,2543,!0,a);case 14:case 30:return Kn(e,6112,6121,!0,a);case 15:return xd(e,"",s);case 16:return xd(e,"",s);case 17:case 48:return bl(e,"",Lk,"",s,fc|pc|Af);case 47:return bl(e,"",Pk,"",s,zu|fc|pc|Af);case 42:return bl(e,"",Lk,"",s,fc|pc|Af);case 41:return bl(e,"",Pk,"",s,zu|fc|pc|Af);case 26:return bl(e,"","",Ok,s,0);case 25:return bl(e,"","",Ok,s,zu|fc|pc);case 31:return bl(e,"","",h1,i,zu|fc|pc);case 33:return bl(e,"","",h1,i,0);case 32:return bl(e,"","",h1,i,zu|fc|pc);case 18:return Kn(e,2406,2415,!0,a);case 20:return Ou(e,1,19999,dK,3,a);case 21:return Kn(e,2790,2799,!0,a);case 22:return Kn(e,2662,2671,!0,a);case 22:return Ou(e,1,10999,cK,3,a);case 23:return xd(e,"");case 24:return xd(e,"");case 27:return Kn(e,3302,3311,!0,a);case 28:return xd(e,"",s);case 29:return xd(e,"",s);case 34:return Kn(e,3792,3801,!0,a);case 37:return Kn(e,6160,6169,!0,a);case 38:return Kn(e,4160,4169,!0,a);case 39:return Kn(e,2918,2927,!0,a);case 40:return Kn(e,1776,1785,!0,a);case 43:return Kn(e,3046,3055,!0,a);case 44:return Kn(e,3174,3183,!0,a);case 45:return Kn(e,3664,3673,!0,a);case 46:return Kn(e,3872,3881,!0,a);case 3:default:return Kn(e,48,57,!0,a)}},_F="data-html2canvas-ignore",Uk=function(){function e(t,r,a){if(this.context=t,this.options=a,this.scrolledElements=[],this.referenceElement=r,this.counters=new lK,this.quoteDepth=0,!r.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(r.ownerDocument.documentElement,!1)}return e.prototype.toIFrame=function(t,r){var a=this,s=uK(t,r);if(!s.contentWindow)return Promise.reject("Unable to find iframe window");var i=t.defaultView.pageXOffset,o=t.defaultView.pageYOffset,l=s.contentWindow,c=l.document,d=fK(s).then(function(){return ws(a,void 0,void 0,function(){var u,f;return ss(this,function(h){switch(h.label){case 0:return this.scrolledElements.forEach(xK),l&&(l.scrollTo(r.left,r.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(l.scrollY!==r.top||l.scrollX!==r.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(l.scrollX-r.left,l.scrollY-r.top,0,0))),u=this.options.onclone,f=this.clonedReferenceElement,typeof f>"u"?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:c.fonts&&c.fonts.ready?[4,c.fonts.ready]:[3,2];case 1:h.sent(),h.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,hK(c)]:[3,4];case 3:h.sent(),h.label=4;case 4:return typeof u=="function"?[2,Promise.resolve().then(function(){return u(c,f)}).then(function(){return s})]:[2,s]}})})});return c.open(),c.write(mK(document.doctype)+"<html></html>"),gK(this.referenceElement.ownerDocument,i,o),c.replaceChild(c.adoptNode(this.documentElement),c.documentElement),c.close(),d},e.prototype.createElementClone=function(t){if(B_(t,2))debugger;if(xF(t))return this.createCanvasClone(t);if(Ek(t))return this.createVideoClone(t);if(Fk(t))return this.createStyleClone(t);var r=t.cloneNode(!1);return I_(r)&&(I_(t)&&t.currentSrc&&t.currentSrc!==t.src&&(r.src=t.currentSrc,r.srcset=""),r.loading==="lazy"&&(r.loading="eager")),Tk(r)?this.createCustomElementClone(r):r},e.prototype.createCustomElementClone=function(t){var r=document.createElement("html2canvascustomelement");return f1(t.style,r),r},e.prototype.createStyleClone=function(t){try{var r=t.sheet;if(r&&r.cssRules){var a=[].slice.call(r.cssRules,0).reduce(function(i,o){return o&&typeof o.cssText=="string"?i+o.cssText:i},""),s=t.cloneNode(!1);return s.textContent=a,s}}catch(i){if(this.context.logger.error("Unable to access cssRules property",i),i.name!=="SecurityError")throw i}return t.cloneNode(!1)},e.prototype.createCanvasClone=function(t){var r;if(this.options.inlineImages&&t.ownerDocument){var a=t.ownerDocument.createElement("img");try{return a.src=t.toDataURL(),a}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",t)}}var s=t.cloneNode(!1);try{s.width=t.width,s.height=t.height;var i=t.getContext("2d"),o=s.getContext("2d");if(o)if(!this.options.allowTaint&&i)o.putImageData(i.getImageData(0,0,t.width,t.height),0,0);else{var l=(r=t.getContext("webgl2"))!==null&&r!==void 0?r:t.getContext("webgl");if(l){var c=l.getContextAttributes();(c==null?void 0:c.preserveDrawingBuffer)===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",t)}o.drawImage(t,0,0)}return s}catch{this.context.logger.info("Unable to clone canvas as it is tainted",t)}return s},e.prototype.createVideoClone=function(t){var r=t.ownerDocument.createElement("canvas");r.width=t.offsetWidth,r.height=t.offsetHeight;var a=r.getContext("2d");try{return a&&(a.drawImage(t,0,0,r.width,r.height),this.options.allowTaint||a.getImageData(0,0,r.width,r.height)),r}catch{this.context.logger.info("Unable to clone video as it is tainted",t)}var s=t.ownerDocument.createElement("canvas");return s.width=t.offsetWidth,s.height=t.offsetHeight,s},e.prototype.appendChildNode=function(t,r,a){(!uA(r)||!oK(r)&&!r.hasAttribute(_F)&&(typeof this.options.ignoreElements!="function"||!this.options.ignoreElements(r)))&&(!this.options.copyStyles||!uA(r)||!Fk(r))&&t.appendChild(this.cloneNode(r,a))},e.prototype.cloneChildNodes=function(t,r,a){for(var s=this,i=t.shadowRoot?t.shadowRoot.firstChild:t.firstChild;i;i=i.nextSibling)if(uA(i)&&vF(i)&&typeof i.assignedNodes=="function"){var o=i.assignedNodes();o.length&&o.forEach(function(l){return s.appendChildNode(r,l,a)})}else this.appendChildNode(r,i,a)},e.prototype.cloneNode=function(t,r){if(mF(t))return document.createTextNode(t.data);if(!t.ownerDocument)return t.cloneNode(!1);var a=t.ownerDocument.defaultView;if(a&&uA(t)&&(T_(t)||dg(t))){var s=this.createElementClone(t);s.style.transitionProperty="none";var i=a.getComputedStyle(t),o=a.getComputedStyle(t,":before"),l=a.getComputedStyle(t,":after");this.referenceElement===t&&T_(s)&&(this.clonedReferenceElement=s),d2(s)&&bK(s);var c=this.counters.parse(new pk(this.context,i)),d=this.resolvePseudoContent(t,s,o,If.BEFORE);Tk(t)&&(r=!0),Ek(t)||this.cloneChildNodes(t,s,r),d&&s.insertBefore(d,s.firstChild);var u=this.resolvePseudoContent(t,s,l,If.AFTER);return u&&s.appendChild(u),this.counters.pop(c),(i&&(this.options.copyStyles||dg(t))&&!yF(t)||r)&&f1(i,s),(t.scrollTop!==0||t.scrollLeft!==0)&&this.scrolledElements.push([s,t.scrollLeft,t.scrollTop]),(Yg(t)||Jg(t))&&(Yg(s)||Jg(s))&&(s.value=t.value),s}return t.cloneNode(!1)},e.prototype.resolvePseudoContent=function(t,r,a,s){var i=this;if(a){var o=a.content,l=r.ownerDocument;if(!(!l||!o||o==="none"||o==="-moz-alt-content"||a.display==="none")){this.counters.parse(new pk(this.context,a));var c=new n$(this.context,a),d=l.createElement("html2canvaspseudoelement");f1(a,d),c.content.forEach(function(f){if(f.type===0)d.appendChild(l.createTextNode(f.value));else if(f.type===22){var h=l.createElement("img");h.src=f.value,h.style.opacity="1",d.appendChild(h)}else if(f.type===18){if(f.name==="attr"){var A=f.values.filter(Yr);A.length&&d.appendChild(l.createTextNode(t.getAttribute(A[0].value)||""))}else if(f.name==="counter"){var x=f.values.filter(UA),p=x[0],b=x[1];if(p&&Yr(p)){var m=i.counters.getCounterValue(p.value),g=b&&Yr(b)?S_.parse(i.context,b.value):3;d.appendChild(l.createTextNode(m0(m,g,!1)))}}else if(f.name==="counters"){var y=f.values.filter(UA),p=y[0],v=y[1],b=y[2];if(p&&Yr(p)){var _=i.counters.getCounterValues(p.value),j=b&&Yr(b)?S_.parse(i.context,b.value):3,N=v&&v.type===0?v.value:"",B=_.map(function(k){return m0(k,j,!1)}).join(N);d.appendChild(l.createTextNode(B))}}}else if(f.type===20)switch(f.value){case"open-quote":d.appendChild(l.createTextNode(fk(c.quotes,i.quoteDepth++,!0)));break;case"close-quote":d.appendChild(l.createTextNode(fk(c.quotes,--i.quoteDepth,!1)));break;default:d.appendChild(l.createTextNode(f.value))}}),d.className=D_+" "+L_;var u=s===If.BEFORE?" "+D_:" "+L_;return dg(r)?r.className.baseValue+=u:r.className+=u,d}}},e.destroy=function(t){return t.parentNode?(t.parentNode.removeChild(t),!0):!1},e}(),If;(function(e){e[e.BEFORE=0]="BEFORE",e[e.AFTER=1]="AFTER"})(If||(If={}));var uK=function(e,t){var r=e.createElement("iframe");return r.className="html2canvas-container",r.style.visibility="hidden",r.style.position="fixed",r.style.left="-10000px",r.style.top="0px",r.style.border="0",r.width=t.width.toString(),r.height=t.height.toString(),r.scrolling="no",r.setAttribute(_F,"true"),e.body.appendChild(r),r},AK=function(e){return new Promise(function(t){if(e.complete){t();return}if(!e.src){t();return}e.onload=t,e.onerror=t})},hK=function(e){return Promise.all([].slice.call(e.images,0).map(AK))},fK=function(e){return new Promise(function(t,r){var a=e.contentWindow;if(!a)return r("No window assigned for iframe");var s=a.document;a.onload=e.onload=function(){a.onload=e.onload=null;var i=setInterval(function(){s.body.childNodes.length>0&&s.readyState==="complete"&&(clearInterval(i),t(e))},50)}})},pK=["all","d","content"],f1=function(e,t){for(var r=e.length-1;r>=0;r--){var a=e.item(r);pK.indexOf(a)===-1&&t.style.setProperty(a,e.getPropertyValue(a))}return t},mK=function(e){var t="";return e&&(t+="<!DOCTYPE ",e.name&&(t+=e.name),e.internalSubset&&(t+=e.internalSubset),e.publicId&&(t+='"'+e.publicId+'"'),e.systemId&&(t+='"'+e.systemId+'"'),t+=">"),t},gK=function(e,t,r){e&&e.defaultView&&(t!==e.defaultView.pageXOffset||r!==e.defaultView.pageYOffset)&&e.defaultView.scrollTo(t,r)},xK=function(e){var t=e[0],r=e[1],a=e[2];t.scrollLeft=r,t.scrollTop=a},yK=":before",vK=":after",D_="___html2canvas___pseudoelement_before",L_="___html2canvas___pseudoelement_after",Rk=`{
    content: "" !important;
    display: none !important;
}`,bK=function(e){_K(e,"."+D_+yK+Rk+`
         .`+L_+vK+Rk)},_K=function(e,t){var r=e.ownerDocument;if(r){var a=r.createElement("style");a.textContent=t,e.appendChild(a)}},wF=function(){function e(){}return e.getOrigin=function(t){var r=e._link;return r?(r.href=t,r.href=r.href,r.protocol+r.hostname+r.port):"about:blank"},e.isSameOrigin=function(t){return e.getOrigin(t)===e._origin},e.setContext=function(t){e._link=t.document.createElement("a"),e._origin=e.getOrigin(t.location.href)},e._origin="about:blank",e}(),wK=function(){function e(t,r){this.context=t,this._options=r,this._cache={}}return e.prototype.addImage=function(t){var r=Promise.resolve();return this.has(t)||(m1(t)||CK(t))&&(this._cache[t]=this.loadImage(t)).catch(function(){}),r},e.prototype.match=function(t){return this._cache[t]},e.prototype.loadImage=function(t){return ws(this,void 0,void 0,function(){var r,a,s,i,o=this;return ss(this,function(l){switch(l.label){case 0:return r=wF.isSameOrigin(t),a=!p1(t)&&this._options.useCORS===!0&&$a.SUPPORT_CORS_IMAGES&&!r,s=!p1(t)&&!r&&!m1(t)&&typeof this._options.proxy=="string"&&$a.SUPPORT_CORS_XHR&&!a,!r&&this._options.allowTaint===!1&&!p1(t)&&!m1(t)&&!s&&!a?[2]:(i=t,s?[4,this.proxy(i)]:[3,2]);case 1:i=l.sent(),l.label=2;case 2:return this.context.logger.debug("Added image "+t.substring(0,256)),[4,new Promise(function(c,d){var u=new Image;u.onload=function(){return c(u)},u.onerror=d,(SK(i)||a)&&(u.crossOrigin="anonymous"),u.src=i,u.complete===!0&&setTimeout(function(){return c(u)},500),o._options.imageTimeout>0&&setTimeout(function(){return d("Timed out ("+o._options.imageTimeout+"ms) loading image")},o._options.imageTimeout)})];case 3:return[2,l.sent()]}})})},e.prototype.has=function(t){return typeof this._cache[t]<"u"},e.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},e.prototype.proxy=function(t){var r=this,a=this._options.proxy;if(!a)throw new Error("No proxy defined");var s=t.substring(0,256);return new Promise(function(i,o){var l=$a.SUPPORT_RESPONSE_TYPE?"blob":"text",c=new XMLHttpRequest;c.onload=function(){if(c.status===200)if(l==="text")i(c.response);else{var f=new FileReader;f.addEventListener("load",function(){return i(f.result)},!1),f.addEventListener("error",function(h){return o(h)},!1),f.readAsDataURL(c.response)}else o("Failed to proxy resource "+s+" with status code "+c.status)},c.onerror=o;var d=a.indexOf("?")>-1?"&":"?";if(c.open("GET",""+a+d+"url="+encodeURIComponent(t)+"&responseType="+l),l!=="text"&&c instanceof XMLHttpRequest&&(c.responseType=l),r._options.imageTimeout){var u=r._options.imageTimeout;c.timeout=u,c.ontimeout=function(){return o("Timed out ("+u+"ms) proxying "+s)}}c.send()})},e}(),NK=/^data:image\/svg\+xml/i,jK=/^data:image\/.*;base64,/i,kK=/^data:image\/.*/i,CK=function(e){return $a.SUPPORT_SVG_DRAWING||!BK(e)},p1=function(e){return kK.test(e)},SK=function(e){return jK.test(e)},m1=function(e){return e.substr(0,4)==="blob"},BK=function(e){return e.substr(-3).toLowerCase()==="svg"||NK.test(e)},Dt=function(){function e(t,r){this.type=0,this.x=t,this.y=r}return e.prototype.add=function(t,r){return new e(this.x+t,this.y+r)},e}(),Uu=function(e,t,r){return new Dt(e.x+(t.x-e.x)*r,e.y+(t.y-e.y)*r)},wm=function(){function e(t,r,a,s){this.type=1,this.start=t,this.startControl=r,this.endControl=a,this.end=s}return e.prototype.subdivide=function(t,r){var a=Uu(this.start,this.startControl,t),s=Uu(this.startControl,this.endControl,t),i=Uu(this.endControl,this.end,t),o=Uu(a,s,t),l=Uu(s,i,t),c=Uu(o,l,t);return r?new e(this.start,a,o,c):new e(c,l,i,this.end)},e.prototype.add=function(t,r){return new e(this.start.add(t,r),this.startControl.add(t,r),this.endControl.add(t,r),this.end.add(t,r))},e.prototype.reverse=function(){return new e(this.end,this.endControl,this.startControl,this.start)},e}(),Pi=function(e){return e.type===1},EK=function(){function e(t){var r=t.styles,a=t.bounds,s=df(r.borderTopLeftRadius,a.width,a.height),i=s[0],o=s[1],l=df(r.borderTopRightRadius,a.width,a.height),c=l[0],d=l[1],u=df(r.borderBottomRightRadius,a.width,a.height),f=u[0],h=u[1],A=df(r.borderBottomLeftRadius,a.width,a.height),x=A[0],p=A[1],b=[];b.push((i+c)/a.width),b.push((x+f)/a.width),b.push((o+p)/a.height),b.push((d+h)/a.height);var m=Math.max.apply(Math,b);m>1&&(i/=m,o/=m,c/=m,d/=m,f/=m,h/=m,x/=m,p/=m);var g=a.width-c,y=a.height-h,v=a.width-f,_=a.height-p,j=r.borderTopWidth,N=r.borderRightWidth,B=r.borderBottomWidth,E=r.borderLeftWidth,C=on(r.paddingTop,t.bounds.width),k=on(r.paddingRight,t.bounds.width),w=on(r.paddingBottom,t.bounds.width),T=on(r.paddingLeft,t.bounds.width);this.topLeftBorderDoubleOuterBox=i>0||o>0?bn(a.left+E/3,a.top+j/3,i-E/3,o-j/3,Qr.TOP_LEFT):new Dt(a.left+E/3,a.top+j/3),this.topRightBorderDoubleOuterBox=i>0||o>0?bn(a.left+g,a.top+j/3,c-N/3,d-j/3,Qr.TOP_RIGHT):new Dt(a.left+a.width-N/3,a.top+j/3),this.bottomRightBorderDoubleOuterBox=f>0||h>0?bn(a.left+v,a.top+y,f-N/3,h-B/3,Qr.BOTTOM_RIGHT):new Dt(a.left+a.width-N/3,a.top+a.height-B/3),this.bottomLeftBorderDoubleOuterBox=x>0||p>0?bn(a.left+E/3,a.top+_,x-E/3,p-B/3,Qr.BOTTOM_LEFT):new Dt(a.left+E/3,a.top+a.height-B/3),this.topLeftBorderDoubleInnerBox=i>0||o>0?bn(a.left+E*2/3,a.top+j*2/3,i-E*2/3,o-j*2/3,Qr.TOP_LEFT):new Dt(a.left+E*2/3,a.top+j*2/3),this.topRightBorderDoubleInnerBox=i>0||o>0?bn(a.left+g,a.top+j*2/3,c-N*2/3,d-j*2/3,Qr.TOP_RIGHT):new Dt(a.left+a.width-N*2/3,a.top+j*2/3),this.bottomRightBorderDoubleInnerBox=f>0||h>0?bn(a.left+v,a.top+y,f-N*2/3,h-B*2/3,Qr.BOTTOM_RIGHT):new Dt(a.left+a.width-N*2/3,a.top+a.height-B*2/3),this.bottomLeftBorderDoubleInnerBox=x>0||p>0?bn(a.left+E*2/3,a.top+_,x-E*2/3,p-B*2/3,Qr.BOTTOM_LEFT):new Dt(a.left+E*2/3,a.top+a.height-B*2/3),this.topLeftBorderStroke=i>0||o>0?bn(a.left+E/2,a.top+j/2,i-E/2,o-j/2,Qr.TOP_LEFT):new Dt(a.left+E/2,a.top+j/2),this.topRightBorderStroke=i>0||o>0?bn(a.left+g,a.top+j/2,c-N/2,d-j/2,Qr.TOP_RIGHT):new Dt(a.left+a.width-N/2,a.top+j/2),this.bottomRightBorderStroke=f>0||h>0?bn(a.left+v,a.top+y,f-N/2,h-B/2,Qr.BOTTOM_RIGHT):new Dt(a.left+a.width-N/2,a.top+a.height-B/2),this.bottomLeftBorderStroke=x>0||p>0?bn(a.left+E/2,a.top+_,x-E/2,p-B/2,Qr.BOTTOM_LEFT):new Dt(a.left+E/2,a.top+a.height-B/2),this.topLeftBorderBox=i>0||o>0?bn(a.left,a.top,i,o,Qr.TOP_LEFT):new Dt(a.left,a.top),this.topRightBorderBox=c>0||d>0?bn(a.left+g,a.top,c,d,Qr.TOP_RIGHT):new Dt(a.left+a.width,a.top),this.bottomRightBorderBox=f>0||h>0?bn(a.left+v,a.top+y,f,h,Qr.BOTTOM_RIGHT):new Dt(a.left+a.width,a.top+a.height),this.bottomLeftBorderBox=x>0||p>0?bn(a.left,a.top+_,x,p,Qr.BOTTOM_LEFT):new Dt(a.left,a.top+a.height),this.topLeftPaddingBox=i>0||o>0?bn(a.left+E,a.top+j,Math.max(0,i-E),Math.max(0,o-j),Qr.TOP_LEFT):new Dt(a.left+E,a.top+j),this.topRightPaddingBox=c>0||d>0?bn(a.left+Math.min(g,a.width-N),a.top+j,g>a.width+N?0:Math.max(0,c-N),Math.max(0,d-j),Qr.TOP_RIGHT):new Dt(a.left+a.width-N,a.top+j),this.bottomRightPaddingBox=f>0||h>0?bn(a.left+Math.min(v,a.width-E),a.top+Math.min(y,a.height-B),Math.max(0,f-N),Math.max(0,h-B),Qr.BOTTOM_RIGHT):new Dt(a.left+a.width-N,a.top+a.height-B),this.bottomLeftPaddingBox=x>0||p>0?bn(a.left+E,a.top+Math.min(_,a.height-B),Math.max(0,x-E),Math.max(0,p-B),Qr.BOTTOM_LEFT):new Dt(a.left+E,a.top+a.height-B),this.topLeftContentBox=i>0||o>0?bn(a.left+E+T,a.top+j+C,Math.max(0,i-(E+T)),Math.max(0,o-(j+C)),Qr.TOP_LEFT):new Dt(a.left+E+T,a.top+j+C),this.topRightContentBox=c>0||d>0?bn(a.left+Math.min(g,a.width+E+T),a.top+j+C,g>a.width+E+T?0:c-E+T,d-(j+C),Qr.TOP_RIGHT):new Dt(a.left+a.width-(N+k),a.top+j+C),this.bottomRightContentBox=f>0||h>0?bn(a.left+Math.min(v,a.width-(E+T)),a.top+Math.min(y,a.height+j+C),Math.max(0,f-(N+k)),h-(B+w),Qr.BOTTOM_RIGHT):new Dt(a.left+a.width-(N+k),a.top+a.height-(B+w)),this.bottomLeftContentBox=x>0||p>0?bn(a.left+E+T,a.top+_,Math.max(0,x-(E+T)),p-(B+w),Qr.BOTTOM_LEFT):new Dt(a.left+E+T,a.top+a.height-(B+w))}return e}(),Qr;(function(e){e[e.TOP_LEFT=0]="TOP_LEFT",e[e.TOP_RIGHT=1]="TOP_RIGHT",e[e.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",e[e.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(Qr||(Qr={}));var bn=function(e,t,r,a,s){var i=4*((Math.sqrt(2)-1)/3),o=r*i,l=a*i,c=e+r,d=t+a;switch(s){case Qr.TOP_LEFT:return new wm(new Dt(e,d),new Dt(e,d-l),new Dt(c-o,t),new Dt(c,t));case Qr.TOP_RIGHT:return new wm(new Dt(e,t),new Dt(e+o,t),new Dt(c,d-l),new Dt(c,d));case Qr.BOTTOM_RIGHT:return new wm(new Dt(c,t),new Dt(c,t+l),new Dt(e+o,d),new Dt(e,d));case Qr.BOTTOM_LEFT:default:return new wm(new Dt(c,d),new Dt(c-o,d),new Dt(e,t+l),new Dt(e,t))}},Zg=function(e){return[e.topLeftBorderBox,e.topRightBorderBox,e.bottomRightBorderBox,e.bottomLeftBorderBox]},FK=function(e){return[e.topLeftContentBox,e.topRightContentBox,e.bottomRightContentBox,e.bottomLeftContentBox]},ex=function(e){return[e.topLeftPaddingBox,e.topRightPaddingBox,e.bottomRightPaddingBox,e.bottomLeftPaddingBox]},TK=function(){function e(t,r,a){this.offsetX=t,this.offsetY=r,this.matrix=a,this.type=0,this.target=6}return e}(),Nm=function(){function e(t,r){this.path=t,this.target=r,this.type=1}return e}(),IK=function(){function e(t){this.opacity=t,this.type=2,this.target=6}return e}(),DK=function(e){return e.type===0},NF=function(e){return e.type===1},LK=function(e){return e.type===2},Mk=function(e,t){return e.length===t.length?e.some(function(r,a){return r===t[a]}):!1},PK=function(e,t,r,a,s){return e.map(function(i,o){switch(o){case 0:return i.add(t,r);case 1:return i.add(t+a,r);case 2:return i.add(t+a,r+s);case 3:return i.add(t,r+s)}return i})},jF=function(){function e(t){this.element=t,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return e}(),kF=function(){function e(t,r){if(this.container=t,this.parent=r,this.effects=[],this.curves=new EK(this.container),this.container.styles.opacity<1&&this.effects.push(new IK(this.container.styles.opacity)),this.container.styles.transform!==null){var a=this.container.bounds.left+this.container.styles.transformOrigin[0].number,s=this.container.bounds.top+this.container.styles.transformOrigin[1].number,i=this.container.styles.transform;this.effects.push(new TK(a,s,i))}if(this.container.styles.overflowX!==0){var o=Zg(this.curves),l=ex(this.curves);Mk(o,l)?this.effects.push(new Nm(o,6)):(this.effects.push(new Nm(o,2)),this.effects.push(new Nm(l,4)))}}return e.prototype.getEffects=function(t){for(var r=[2,3].indexOf(this.container.styles.position)===-1,a=this.parent,s=this.effects.slice(0);a;){var i=a.effects.filter(function(c){return!NF(c)});if(r||a.container.styles.position!==0||!a.parent){if(s.unshift.apply(s,i),r=[2,3].indexOf(a.container.styles.position)===-1,a.container.styles.overflowX!==0){var o=Zg(a.curves),l=ex(a.curves);Mk(o,l)||s.unshift(new Nm(l,6))}}else s.unshift.apply(s,i);a=a.parent}return s.filter(function(c){return _a(c.target,t)})},e}(),P_=function(e,t,r,a){e.container.elements.forEach(function(s){var i=_a(s.flags,4),o=_a(s.flags,2),l=new kF(s,e);_a(s.styles.display,2048)&&a.push(l);var c=_a(s.flags,8)?[]:a;if(i||o){var d=i||s.styles.isPositioned()?r:t,u=new jF(l);if(s.styles.isPositioned()||s.styles.opacity<1||s.styles.isTransformed()){var f=s.styles.zIndex.order;if(f<0){var h=0;d.negativeZIndex.some(function(x,p){return f>x.element.container.styles.zIndex.order?(h=p,!1):h>0}),d.negativeZIndex.splice(h,0,u)}else if(f>0){var A=0;d.positiveZIndex.some(function(x,p){return f>=x.element.container.styles.zIndex.order?(A=p+1,!1):A>0}),d.positiveZIndex.splice(A,0,u)}else d.zeroOrAutoZIndexOrTransformedOrOpacity.push(u)}else s.styles.isFloating()?d.nonPositionedFloats.push(u):d.nonPositionedInlineLevel.push(u);P_(l,u,i?u:r,c)}else s.styles.isInlineLevel()?t.inlineLevel.push(l):t.nonInlineLevel.push(l),P_(l,t,r,c);_a(s.flags,8)&&CF(s,c)})},CF=function(e,t){for(var r=e instanceof F_?e.start:1,a=e instanceof F_?e.reversed:!1,s=0;s<t.length;s++){var i=t[s];i.container instanceof dF&&typeof i.container.value=="number"&&i.container.value!==0&&(r=i.container.value),i.listValue=m0(r,i.container.styles.listStyleType,!0),r+=a?-1:1}},OK=function(e){var t=new kF(e,null),r=new jF(t),a=[];return P_(t,r,r,a),CF(t.container,a),r},Qk=function(e,t){switch(t){case 0:return Ri(e.topLeftBorderBox,e.topLeftPaddingBox,e.topRightBorderBox,e.topRightPaddingBox);case 1:return Ri(e.topRightBorderBox,e.topRightPaddingBox,e.bottomRightBorderBox,e.bottomRightPaddingBox);case 2:return Ri(e.bottomRightBorderBox,e.bottomRightPaddingBox,e.bottomLeftBorderBox,e.bottomLeftPaddingBox);case 3:default:return Ri(e.bottomLeftBorderBox,e.bottomLeftPaddingBox,e.topLeftBorderBox,e.topLeftPaddingBox)}},UK=function(e,t){switch(t){case 0:return Ri(e.topLeftBorderBox,e.topLeftBorderDoubleOuterBox,e.topRightBorderBox,e.topRightBorderDoubleOuterBox);case 1:return Ri(e.topRightBorderBox,e.topRightBorderDoubleOuterBox,e.bottomRightBorderBox,e.bottomRightBorderDoubleOuterBox);case 2:return Ri(e.bottomRightBorderBox,e.bottomRightBorderDoubleOuterBox,e.bottomLeftBorderBox,e.bottomLeftBorderDoubleOuterBox);case 3:default:return Ri(e.bottomLeftBorderBox,e.bottomLeftBorderDoubleOuterBox,e.topLeftBorderBox,e.topLeftBorderDoubleOuterBox)}},RK=function(e,t){switch(t){case 0:return Ri(e.topLeftBorderDoubleInnerBox,e.topLeftPaddingBox,e.topRightBorderDoubleInnerBox,e.topRightPaddingBox);case 1:return Ri(e.topRightBorderDoubleInnerBox,e.topRightPaddingBox,e.bottomRightBorderDoubleInnerBox,e.bottomRightPaddingBox);case 2:return Ri(e.bottomRightBorderDoubleInnerBox,e.bottomRightPaddingBox,e.bottomLeftBorderDoubleInnerBox,e.bottomLeftPaddingBox);case 3:default:return Ri(e.bottomLeftBorderDoubleInnerBox,e.bottomLeftPaddingBox,e.topLeftBorderDoubleInnerBox,e.topLeftPaddingBox)}},MK=function(e,t){switch(t){case 0:return jm(e.topLeftBorderStroke,e.topRightBorderStroke);case 1:return jm(e.topRightBorderStroke,e.bottomRightBorderStroke);case 2:return jm(e.bottomRightBorderStroke,e.bottomLeftBorderStroke);case 3:default:return jm(e.bottomLeftBorderStroke,e.topLeftBorderStroke)}},jm=function(e,t){var r=[];return Pi(e)?r.push(e.subdivide(.5,!1)):r.push(e),Pi(t)?r.push(t.subdivide(.5,!0)):r.push(t),r},Ri=function(e,t,r,a){var s=[];return Pi(e)?s.push(e.subdivide(.5,!1)):s.push(e),Pi(r)?s.push(r.subdivide(.5,!0)):s.push(r),Pi(a)?s.push(a.subdivide(.5,!0).reverse()):s.push(a),Pi(t)?s.push(t.subdivide(.5,!1).reverse()):s.push(t),s},SF=function(e){var t=e.bounds,r=e.styles;return t.add(r.borderLeftWidth,r.borderTopWidth,-(r.borderRightWidth+r.borderLeftWidth),-(r.borderTopWidth+r.borderBottomWidth))},tx=function(e){var t=e.styles,r=e.bounds,a=on(t.paddingLeft,r.width),s=on(t.paddingRight,r.width),i=on(t.paddingTop,r.width),o=on(t.paddingBottom,r.width);return r.add(a+t.borderLeftWidth,i+t.borderTopWidth,-(t.borderRightWidth+t.borderLeftWidth+a+s),-(t.borderTopWidth+t.borderBottomWidth+i+o))},QK=function(e,t){return e===0?t.bounds:e===2?tx(t):SF(t)},HK=function(e,t){return e===0?t.bounds:e===2?tx(t):SF(t)},g1=function(e,t,r){var a=QK(Gu(e.styles.backgroundOrigin,t),e),s=HK(Gu(e.styles.backgroundClip,t),e),i=qK(Gu(e.styles.backgroundSize,t),r,a),o=i[0],l=i[1],c=df(Gu(e.styles.backgroundPosition,t),a.width-o,a.height-l),d=$K(Gu(e.styles.backgroundRepeat,t),c,i,a,s),u=Math.round(a.left+c[0]),f=Math.round(a.top+c[1]);return[d,u,f,o,l]},Ru=function(e){return Yr(e)&&e.value===jA.AUTO},km=function(e){return typeof e=="number"},qK=function(e,t,r){var a=t[0],s=t[1],i=t[2],o=e[0],l=e[1];if(!o)return[0,0];if(la(o)&&l&&la(l))return[on(o,r.width),on(l,r.height)];var c=km(i);if(Yr(o)&&(o.value===jA.CONTAIN||o.value===jA.COVER)){if(km(i)){var d=r.width/r.height;return d<i!=(o.value===jA.COVER)?[r.width,r.width/i]:[r.height*i,r.height]}return[r.width,r.height]}var u=km(a),f=km(s),h=u||f;if(Ru(o)&&(!l||Ru(l))){if(u&&f)return[a,s];if(!c&&!h)return[r.width,r.height];if(h&&c){var A=u?a:s*i,x=f?s:a/i;return[A,x]}var p=u?a:r.width,b=f?s:r.height;return[p,b]}if(c){var m=0,g=0;return la(o)?m=on(o,r.width):la(l)&&(g=on(l,r.height)),Ru(o)?m=g*i:(!l||Ru(l))&&(g=m/i),[m,g]}var y=null,v=null;if(la(o)?y=on(o,r.width):l&&la(l)&&(v=on(l,r.height)),y!==null&&(!l||Ru(l))&&(v=u&&f?y/a*s:r.height),v!==null&&Ru(o)&&(y=u&&f?v/s*a:r.width),y!==null&&v!==null)return[y,v];throw new Error("Unable to calculate background-size for element")},Gu=function(e,t){var r=e[t];return typeof r>"u"?e[0]:r},$K=function(e,t,r,a,s){var i=t[0],o=t[1],l=r[0],c=r[1];switch(e){case 2:return[new Dt(Math.round(a.left),Math.round(a.top+o)),new Dt(Math.round(a.left+a.width),Math.round(a.top+o)),new Dt(Math.round(a.left+a.width),Math.round(c+a.top+o)),new Dt(Math.round(a.left),Math.round(c+a.top+o))];case 3:return[new Dt(Math.round(a.left+i),Math.round(a.top)),new Dt(Math.round(a.left+i+l),Math.round(a.top)),new Dt(Math.round(a.left+i+l),Math.round(a.height+a.top)),new Dt(Math.round(a.left+i),Math.round(a.height+a.top))];case 1:return[new Dt(Math.round(a.left+i),Math.round(a.top+o)),new Dt(Math.round(a.left+i+l),Math.round(a.top+o)),new Dt(Math.round(a.left+i+l),Math.round(a.top+o+c)),new Dt(Math.round(a.left+i),Math.round(a.top+o+c))];default:return[new Dt(Math.round(s.left),Math.round(s.top)),new Dt(Math.round(s.left+s.width),Math.round(s.top)),new Dt(Math.round(s.left+s.width),Math.round(s.height+s.top)),new Dt(Math.round(s.left),Math.round(s.height+s.top))]}},KK="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",Hk="Hidden Text",VK=function(){function e(t){this._data={},this._document=t}return e.prototype.parseMetrics=function(t,r){var a=this._document.createElement("div"),s=this._document.createElement("img"),i=this._document.createElement("span"),o=this._document.body;a.style.visibility="hidden",a.style.fontFamily=t,a.style.fontSize=r,a.style.margin="0",a.style.padding="0",a.style.whiteSpace="nowrap",o.appendChild(a),s.src=KK,s.width=1,s.height=1,s.style.margin="0",s.style.padding="0",s.style.verticalAlign="baseline",i.style.fontFamily=t,i.style.fontSize=r,i.style.margin="0",i.style.padding="0",i.appendChild(this._document.createTextNode(Hk)),a.appendChild(i),a.appendChild(s);var l=s.offsetTop-i.offsetTop+2;a.removeChild(i),a.appendChild(this._document.createTextNode(Hk)),a.style.lineHeight="normal",s.style.verticalAlign="super";var c=s.offsetTop-a.offsetTop+2;return o.removeChild(a),{baseline:l,middle:c}},e.prototype.getMetrics=function(t,r){var a=t+" "+r;return typeof this._data[a]>"u"&&(this._data[a]=this.parseMetrics(t,r)),this._data[a]},e}(),BF=function(){function e(t,r){this.context=t,this.options=r}return e}(),WK=1e4,zK=function(e){No(t,e);function t(r,a){var s=e.call(this,r,a)||this;return s._activeEffects=[],s.canvas=a.canvas?a.canvas:document.createElement("canvas"),s.ctx=s.canvas.getContext("2d"),a.canvas||(s.canvas.width=Math.floor(a.width*a.scale),s.canvas.height=Math.floor(a.height*a.scale),s.canvas.style.width=a.width+"px",s.canvas.style.height=a.height+"px"),s.fontMetrics=new VK(document),s.ctx.scale(s.options.scale,s.options.scale),s.ctx.translate(-a.x,-a.y),s.ctx.textBaseline="bottom",s._activeEffects=[],s.context.logger.debug("Canvas renderer initialized ("+a.width+"x"+a.height+") with scale "+a.scale),s}return t.prototype.applyEffects=function(r){for(var a=this;this._activeEffects.length;)this.popEffect();r.forEach(function(s){return a.applyEffect(s)})},t.prototype.applyEffect=function(r){this.ctx.save(),LK(r)&&(this.ctx.globalAlpha=r.opacity),DK(r)&&(this.ctx.translate(r.offsetX,r.offsetY),this.ctx.transform(r.matrix[0],r.matrix[1],r.matrix[2],r.matrix[3],r.matrix[4],r.matrix[5]),this.ctx.translate(-r.offsetX,-r.offsetY)),NF(r)&&(this.path(r.path),this.ctx.clip()),this._activeEffects.push(r)},t.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},t.prototype.renderStack=function(r){return ws(this,void 0,void 0,function(){var a;return ss(this,function(s){switch(s.label){case 0:return a=r.element.container.styles,a.isVisible()?[4,this.renderStackContent(r)]:[3,2];case 1:s.sent(),s.label=2;case 2:return[2]}})})},t.prototype.renderNode=function(r){return ws(this,void 0,void 0,function(){return ss(this,function(a){switch(a.label){case 0:if(_a(r.container.flags,16))debugger;return r.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(r)]:[3,3];case 1:return a.sent(),[4,this.renderNodeContent(r)];case 2:a.sent(),a.label=3;case 3:return[2]}})})},t.prototype.renderTextWithLetterSpacing=function(r,a,s){var i=this;if(a===0)this.ctx.fillText(r.text,r.bounds.left,r.bounds.top+s);else{var o=l2(r.text);o.reduce(function(l,c){return i.ctx.fillText(c,l,r.bounds.top+s),l+i.ctx.measureText(c).width},r.bounds.left)}},t.prototype.createFontStyle=function(r){var a=r.fontVariant.filter(function(o){return o==="normal"||o==="small-caps"}).join(""),s=ZK(r.fontFamily).join(", "),i=Q0(r.fontSize)?""+r.fontSize.number+r.fontSize.unit:r.fontSize.number+"px";return[[r.fontStyle,a,r.fontWeight,i,s].join(" "),s,i]},t.prototype.renderTextNode=function(r,a){return ws(this,void 0,void 0,function(){var s,i,o,l,c,d,u,f,h=this;return ss(this,function(A){return s=this.createFontStyle(a),i=s[0],o=s[1],l=s[2],this.ctx.font=i,this.ctx.direction=a.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",c=this.fontMetrics.getMetrics(o,l),d=c.baseline,u=c.middle,f=a.paintOrder,r.textBounds.forEach(function(x){f.forEach(function(p){switch(p){case 0:h.ctx.fillStyle=Sa(a.color),h.renderTextWithLetterSpacing(x,a.letterSpacing,d);var b=a.textShadow;b.length&&x.text.trim().length&&(b.slice(0).reverse().forEach(function(m){h.ctx.shadowColor=Sa(m.color),h.ctx.shadowOffsetX=m.offsetX.number*h.options.scale,h.ctx.shadowOffsetY=m.offsetY.number*h.options.scale,h.ctx.shadowBlur=m.blur.number,h.renderTextWithLetterSpacing(x,a.letterSpacing,d)}),h.ctx.shadowColor="",h.ctx.shadowOffsetX=0,h.ctx.shadowOffsetY=0,h.ctx.shadowBlur=0),a.textDecorationLine.length&&(h.ctx.fillStyle=Sa(a.textDecorationColor||a.color),a.textDecorationLine.forEach(function(m){switch(m){case 1:h.ctx.fillRect(x.bounds.left,Math.round(x.bounds.top+d),x.bounds.width,1);break;case 2:h.ctx.fillRect(x.bounds.left,Math.round(x.bounds.top),x.bounds.width,1);break;case 3:h.ctx.fillRect(x.bounds.left,Math.ceil(x.bounds.top+u),x.bounds.width,1);break}}));break;case 1:a.webkitTextStrokeWidth&&x.text.trim().length&&(h.ctx.strokeStyle=Sa(a.webkitTextStrokeColor),h.ctx.lineWidth=a.webkitTextStrokeWidth,h.ctx.lineJoin=window.chrome?"miter":"round",h.ctx.strokeText(x.text,x.bounds.left,x.bounds.top+d)),h.ctx.strokeStyle="",h.ctx.lineWidth=0,h.ctx.lineJoin="miter";break}})}),[2]})})},t.prototype.renderReplacedElement=function(r,a,s){if(s&&r.intrinsicWidth>0&&r.intrinsicHeight>0){var i=tx(r),o=ex(a);this.path(o),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(s,0,0,r.intrinsicWidth,r.intrinsicHeight,i.left,i.top,i.width,i.height),this.ctx.restore()}},t.prototype.renderNodeContent=function(r){return ws(this,void 0,void 0,function(){var a,s,i,o,l,c,g,g,d,u,f,h,v,A,x,_,p,b,m,g,y,v,_;return ss(this,function(j){switch(j.label){case 0:this.applyEffects(r.getEffects(4)),a=r.container,s=r.curves,i=a.styles,o=0,l=a.textNodes,j.label=1;case 1:return o<l.length?(c=l[o],[4,this.renderTextNode(c,i)]):[3,4];case 2:j.sent(),j.label=3;case 3:return o++,[3,1];case 4:if(!(a instanceof oF))return[3,8];j.label=5;case 5:return j.trys.push([5,7,,8]),[4,this.context.cache.match(a.src)];case 6:return g=j.sent(),this.renderReplacedElement(a,s,g),[3,8];case 7:return j.sent(),this.context.logger.error("Error loading image "+a.src),[3,8];case 8:if(a instanceof lF&&this.renderReplacedElement(a,s,a.canvas),!(a instanceof cF))return[3,12];j.label=9;case 9:return j.trys.push([9,11,,12]),[4,this.context.cache.match(a.svg)];case 10:return g=j.sent(),this.renderReplacedElement(a,s,g),[3,12];case 11:return j.sent(),this.context.logger.error("Error loading svg "+a.svg.substring(0,255)),[3,12];case 12:return a instanceof hF&&a.tree?(d=new t(this.context,{scale:this.options.scale,backgroundColor:a.backgroundColor,x:0,y:0,width:a.width,height:a.height}),[4,d.render(a.tree)]):[3,14];case 13:u=j.sent(),a.width&&a.height&&this.ctx.drawImage(u,0,0,a.width,a.height,a.bounds.left,a.bounds.top,a.bounds.width,a.bounds.height),j.label=14;case 14:if(a instanceof c2&&(f=Math.min(a.bounds.width,a.bounds.height),a.type===Gg?a.checked&&(this.ctx.save(),this.path([new Dt(a.bounds.left+f*.39363,a.bounds.top+f*.79),new Dt(a.bounds.left+f*.16,a.bounds.top+f*.5549),new Dt(a.bounds.left+f*.27347,a.bounds.top+f*.44071),new Dt(a.bounds.left+f*.39694,a.bounds.top+f*.5649),new Dt(a.bounds.left+f*.72983,a.bounds.top+f*.23),new Dt(a.bounds.left+f*.84,a.bounds.top+f*.34085),new Dt(a.bounds.left+f*.39363,a.bounds.top+f*.79)]),this.ctx.fillStyle=Sa(Bk),this.ctx.fill(),this.ctx.restore()):a.type===Xg&&a.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(a.bounds.left+f/2,a.bounds.top+f/2,f/4,0,Math.PI*2,!0),this.ctx.fillStyle=Sa(Bk),this.ctx.fill(),this.ctx.restore())),GK(a)&&a.value.length){switch(h=this.createFontStyle(i),v=h[0],A=h[1],x=this.fontMetrics.getMetrics(v,A).baseline,this.ctx.font=v,this.ctx.fillStyle=Sa(i.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=YK(a.styles.textAlign),_=tx(a),p=0,a.styles.textAlign){case 1:p+=_.width/2;break;case 2:p+=_.width;break}b=_.add(p,0,0,-_.height/2+1),this.ctx.save(),this.path([new Dt(_.left,_.top),new Dt(_.left+_.width,_.top),new Dt(_.left+_.width,_.top+_.height),new Dt(_.left,_.top+_.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new Tf(a.value,b),i.letterSpacing,x),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!_a(a.styles.display,2048))return[3,20];if(a.styles.listStyleImage===null)return[3,19];if(m=a.styles.listStyleImage,m.type!==0)return[3,18];g=void 0,y=m.url,j.label=15;case 15:return j.trys.push([15,17,,18]),[4,this.context.cache.match(y)];case 16:return g=j.sent(),this.ctx.drawImage(g,a.bounds.left-(g.width+10),a.bounds.top),[3,18];case 17:return j.sent(),this.context.logger.error("Error loading list-style-image "+y),[3,18];case 18:return[3,20];case 19:r.listValue&&a.styles.listStyleType!==-1&&(v=this.createFontStyle(i)[0],this.ctx.font=v,this.ctx.fillStyle=Sa(i.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",_=new Ml(a.bounds.left,a.bounds.top+on(a.styles.paddingTop,a.bounds.width),a.bounds.width,Ak(i.lineHeight,i.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new Tf(r.listValue,_),i.letterSpacing,Ak(i.lineHeight,i.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),j.label=20;case 20:return[2]}})})},t.prototype.renderStackContent=function(r){return ws(this,void 0,void 0,function(){var a,s,m,i,o,m,l,c,m,d,u,m,f,h,m,A,x,m,p,b,m;return ss(this,function(g){switch(g.label){case 0:if(_a(r.element.container.flags,16))debugger;return[4,this.renderNodeBackgroundAndBorders(r.element)];case 1:g.sent(),a=0,s=r.negativeZIndex,g.label=2;case 2:return a<s.length?(m=s[a],[4,this.renderStack(m)]):[3,5];case 3:g.sent(),g.label=4;case 4:return a++,[3,2];case 5:return[4,this.renderNodeContent(r.element)];case 6:g.sent(),i=0,o=r.nonInlineLevel,g.label=7;case 7:return i<o.length?(m=o[i],[4,this.renderNode(m)]):[3,10];case 8:g.sent(),g.label=9;case 9:return i++,[3,7];case 10:l=0,c=r.nonPositionedFloats,g.label=11;case 11:return l<c.length?(m=c[l],[4,this.renderStack(m)]):[3,14];case 12:g.sent(),g.label=13;case 13:return l++,[3,11];case 14:d=0,u=r.nonPositionedInlineLevel,g.label=15;case 15:return d<u.length?(m=u[d],[4,this.renderStack(m)]):[3,18];case 16:g.sent(),g.label=17;case 17:return d++,[3,15];case 18:f=0,h=r.inlineLevel,g.label=19;case 19:return f<h.length?(m=h[f],[4,this.renderNode(m)]):[3,22];case 20:g.sent(),g.label=21;case 21:return f++,[3,19];case 22:A=0,x=r.zeroOrAutoZIndexOrTransformedOrOpacity,g.label=23;case 23:return A<x.length?(m=x[A],[4,this.renderStack(m)]):[3,26];case 24:g.sent(),g.label=25;case 25:return A++,[3,23];case 26:p=0,b=r.positiveZIndex,g.label=27;case 27:return p<b.length?(m=b[p],[4,this.renderStack(m)]):[3,30];case 28:g.sent(),g.label=29;case 29:return p++,[3,27];case 30:return[2]}})})},t.prototype.mask=function(r){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(r.slice(0).reverse()),this.ctx.closePath()},t.prototype.path=function(r){this.ctx.beginPath(),this.formatPath(r),this.ctx.closePath()},t.prototype.formatPath=function(r){var a=this;r.forEach(function(s,i){var o=Pi(s)?s.start:s;i===0?a.ctx.moveTo(o.x,o.y):a.ctx.lineTo(o.x,o.y),Pi(s)&&a.ctx.bezierCurveTo(s.startControl.x,s.startControl.y,s.endControl.x,s.endControl.y,s.end.x,s.end.y)})},t.prototype.renderRepeat=function(r,a,s,i){this.path(r),this.ctx.fillStyle=a,this.ctx.translate(s,i),this.ctx.fill(),this.ctx.translate(-s,-i)},t.prototype.resizeImage=function(r,a,s){var i;if(r.width===a&&r.height===s)return r;var o=(i=this.canvas.ownerDocument)!==null&&i!==void 0?i:document,l=o.createElement("canvas");l.width=Math.max(1,a),l.height=Math.max(1,s);var c=l.getContext("2d");return c.drawImage(r,0,0,r.width,r.height,0,0,a,s),l},t.prototype.renderBackgroundImage=function(r){return ws(this,void 0,void 0,function(){var a,s,i,o,l,c;return ss(this,function(d){switch(d.label){case 0:a=r.styles.backgroundImage.length-1,s=function(u){var f,h,A,C,z,ee,T,R,B,x,C,z,ee,T,R,p,b,m,g,y,v,_,j,N,B,E,C,k,w,T,R,q,z,ee,Y,G,re,U,S,D,L,P;return ss(this,function(I){switch(I.label){case 0:if(u.type!==0)return[3,5];f=void 0,h=u.url,I.label=1;case 1:return I.trys.push([1,3,,4]),[4,i.context.cache.match(h)];case 2:return f=I.sent(),[3,4];case 3:return I.sent(),i.context.logger.error("Error loading background-image "+h),[3,4];case 4:return f&&(A=g1(r,a,[f.width,f.height,f.width/f.height]),C=A[0],z=A[1],ee=A[2],T=A[3],R=A[4],B=i.ctx.createPattern(i.resizeImage(f,T,R),"repeat"),i.renderRepeat(C,B,z,ee)),[3,6];case 5:DH(u)?(x=g1(r,a,[null,null,null]),C=x[0],z=x[1],ee=x[2],T=x[3],R=x[4],p=BH(u.angle,T,R),b=p[0],m=p[1],g=p[2],y=p[3],v=p[4],_=document.createElement("canvas"),_.width=T,_.height=R,j=_.getContext("2d"),N=j.createLinearGradient(m,y,g,v),dk(u.stops,b).forEach(function(H){return N.addColorStop(H.stop,Sa(H.color))}),j.fillStyle=N,j.fillRect(0,0,T,R),T>0&&R>0&&(B=i.ctx.createPattern(_,"repeat"),i.renderRepeat(C,B,z,ee))):LH(u)&&(E=g1(r,a,[null,null,null]),C=E[0],k=E[1],w=E[2],T=E[3],R=E[4],q=u.position.length===0?[s2]:u.position,z=on(q[0],T),ee=on(q[q.length-1],R),Y=EH(u,z,ee,T,R),G=Y[0],re=Y[1],G>0&&re>0&&(U=i.ctx.createRadialGradient(k+z,w+ee,0,k+z,w+ee,G),dk(u.stops,G*2).forEach(function(H){return U.addColorStop(H.stop,Sa(H.color))}),i.path(C),i.ctx.fillStyle=U,G!==re?(S=r.bounds.left+.5*r.bounds.width,D=r.bounds.top+.5*r.bounds.height,L=re/G,P=1/L,i.ctx.save(),i.ctx.translate(S,D),i.ctx.transform(1,0,0,L,0,0),i.ctx.translate(-S,-D),i.ctx.fillRect(k,P*(w-D)+D,T,R*P),i.ctx.restore()):i.ctx.fill())),I.label=6;case 6:return a--,[2]}})},i=this,o=0,l=r.styles.backgroundImage.slice(0).reverse(),d.label=1;case 1:return o<l.length?(c=l[o],[5,s(c)]):[3,4];case 2:d.sent(),d.label=3;case 3:return o++,[3,1];case 4:return[2]}})})},t.prototype.renderSolidBorder=function(r,a,s){return ws(this,void 0,void 0,function(){return ss(this,function(i){return this.path(Qk(s,a)),this.ctx.fillStyle=Sa(r),this.ctx.fill(),[2]})})},t.prototype.renderDoubleBorder=function(r,a,s,i){return ws(this,void 0,void 0,function(){var o,l;return ss(this,function(c){switch(c.label){case 0:return a<3?[4,this.renderSolidBorder(r,s,i)]:[3,2];case 1:return c.sent(),[2];case 2:return o=UK(i,s),this.path(o),this.ctx.fillStyle=Sa(r),this.ctx.fill(),l=RK(i,s),this.path(l),this.ctx.fill(),[2]}})})},t.prototype.renderNodeBackgroundAndBorders=function(r){return ws(this,void 0,void 0,function(){var a,s,i,o,l,c,d,u,f=this;return ss(this,function(h){switch(h.label){case 0:return this.applyEffects(r.getEffects(2)),a=r.container.styles,s=!Qc(a.backgroundColor)||a.backgroundImage.length,i=[{style:a.borderTopStyle,color:a.borderTopColor,width:a.borderTopWidth},{style:a.borderRightStyle,color:a.borderRightColor,width:a.borderRightWidth},{style:a.borderBottomStyle,color:a.borderBottomColor,width:a.borderBottomWidth},{style:a.borderLeftStyle,color:a.borderLeftColor,width:a.borderLeftWidth}],o=XK(Gu(a.backgroundClip,0),r.curves),s||a.boxShadow.length?(this.ctx.save(),this.path(o),this.ctx.clip(),Qc(a.backgroundColor)||(this.ctx.fillStyle=Sa(a.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(r.container)]):[3,2];case 1:h.sent(),this.ctx.restore(),a.boxShadow.slice(0).reverse().forEach(function(A){f.ctx.save();var x=Zg(r.curves),p=A.inset?0:WK,b=PK(x,-p+(A.inset?1:-1)*A.spread.number,(A.inset?1:-1)*A.spread.number,A.spread.number*(A.inset?-2:2),A.spread.number*(A.inset?-2:2));A.inset?(f.path(x),f.ctx.clip(),f.mask(b)):(f.mask(x),f.ctx.clip(),f.path(b)),f.ctx.shadowOffsetX=A.offsetX.number+p,f.ctx.shadowOffsetY=A.offsetY.number,f.ctx.shadowColor=Sa(A.color),f.ctx.shadowBlur=A.blur.number,f.ctx.fillStyle=A.inset?Sa(A.color):"rgba(0,0,0,1)",f.ctx.fill(),f.ctx.restore()}),h.label=2;case 2:l=0,c=0,d=i,h.label=3;case 3:return c<d.length?(u=d[c],u.style!==0&&!Qc(u.color)&&u.width>0?u.style!==2?[3,5]:[4,this.renderDashedDottedBorder(u.color,u.width,l,r.curves,2)]:[3,11]):[3,13];case 4:return h.sent(),[3,11];case 5:return u.style!==3?[3,7]:[4,this.renderDashedDottedBorder(u.color,u.width,l,r.curves,3)];case 6:return h.sent(),[3,11];case 7:return u.style!==4?[3,9]:[4,this.renderDoubleBorder(u.color,u.width,l,r.curves)];case 8:return h.sent(),[3,11];case 9:return[4,this.renderSolidBorder(u.color,l,r.curves)];case 10:h.sent(),h.label=11;case 11:l++,h.label=12;case 12:return c++,[3,3];case 13:return[2]}})})},t.prototype.renderDashedDottedBorder=function(r,a,s,i,o){return ws(this,void 0,void 0,function(){var l,c,d,u,f,h,A,x,p,b,m,g,y,v,_,j,_,j;return ss(this,function(N){return this.ctx.save(),l=MK(i,s),c=Qk(i,s),o===2&&(this.path(c),this.ctx.clip()),Pi(c[0])?(d=c[0].start.x,u=c[0].start.y):(d=c[0].x,u=c[0].y),Pi(c[1])?(f=c[1].end.x,h=c[1].end.y):(f=c[1].x,h=c[1].y),s===0||s===2?A=Math.abs(d-f):A=Math.abs(u-h),this.ctx.beginPath(),o===3?this.formatPath(l):this.formatPath(c.slice(0,2)),x=a<3?a*3:a*2,p=a<3?a*2:a,o===3&&(x=a,p=a),b=!0,A<=x*2?b=!1:A<=x*2+p?(m=A/(2*x+p),x*=m,p*=m):(g=Math.floor((A+p)/(x+p)),y=(A-g*x)/(g-1),v=(A-(g+1)*x)/g,p=v<=0||Math.abs(p-y)<Math.abs(p-v)?y:v),b&&(o===3?this.ctx.setLineDash([0,x+p]):this.ctx.setLineDash([x,p])),o===3?(this.ctx.lineCap="round",this.ctx.lineWidth=a):this.ctx.lineWidth=a*2+1.1,this.ctx.strokeStyle=Sa(r),this.ctx.stroke(),this.ctx.setLineDash([]),o===2&&(Pi(c[0])&&(_=c[3],j=c[0],this.ctx.beginPath(),this.formatPath([new Dt(_.end.x,_.end.y),new Dt(j.start.x,j.start.y)]),this.ctx.stroke()),Pi(c[1])&&(_=c[1],j=c[2],this.ctx.beginPath(),this.formatPath([new Dt(_.end.x,_.end.y),new Dt(j.start.x,j.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},t.prototype.render=function(r){return ws(this,void 0,void 0,function(){var a;return ss(this,function(s){switch(s.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=Sa(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),a=OK(r),[4,this.renderStack(a)];case 1:return s.sent(),this.applyEffects([]),[2,this.canvas]}})})},t}(BF),GK=function(e){return e instanceof AF||e instanceof uF?!0:e instanceof c2&&e.type!==Xg&&e.type!==Gg},XK=function(e,t){switch(e){case 0:return Zg(t);case 2:return FK(t);case 1:default:return ex(t)}},YK=function(e){switch(e){case 1:return"center";case 2:return"right";case 0:default:return"left"}},JK=["-apple-system","system-ui"],ZK=function(e){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?e.filter(function(t){return JK.indexOf(t)===-1}):e},eV=function(e){No(t,e);function t(r,a){var s=e.call(this,r,a)||this;return s.canvas=a.canvas?a.canvas:document.createElement("canvas"),s.ctx=s.canvas.getContext("2d"),s.options=a,s.canvas.width=Math.floor(a.width*a.scale),s.canvas.height=Math.floor(a.height*a.scale),s.canvas.style.width=a.width+"px",s.canvas.style.height=a.height+"px",s.ctx.scale(s.options.scale,s.options.scale),s.ctx.translate(-a.x,-a.y),s.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+a.width+"x"+a.height+" at "+a.x+","+a.y+") with scale "+a.scale),s}return t.prototype.render=function(r){return ws(this,void 0,void 0,function(){var a,s;return ss(this,function(i){switch(i.label){case 0:return a=E_(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,r),[4,tV(a)];case 1:return s=i.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=Sa(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(s,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},t}(BF),tV=function(e){return new Promise(function(t,r){var a=new Image;a.onload=function(){t(a)},a.onerror=r,a.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(e))})},rV=function(){function e(t){var r=t.id,a=t.enabled;this.id=r,this.enabled=a,this.start=Date.now()}return e.prototype.debug=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,am([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},e.prototype.getTime=function(){return Date.now()-this.start},e.prototype.info=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info.apply(console,am([this.id,this.getTime()+"ms"],t))},e.prototype.warn=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,am([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},e.prototype.error=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error.apply(console,am([this.id,this.getTime()+"ms"],t)):this.info.apply(this,t))},e.instances={},e}(),nV=function(){function e(t,r){var a;this.windowBounds=r,this.instanceName="#"+e.instanceCount++,this.logger=new rV({id:this.instanceName,enabled:t.logging}),this.cache=(a=t.cache)!==null&&a!==void 0?a:new wK(this,t)}return e.instanceCount=1,e}(),Zo=function(e,t){return t===void 0&&(t={}),aV(e,t)};typeof window<"u"&&wF.setContext(window);var aV=function(e,t){return ws(void 0,void 0,void 0,function(){var r,a,s,i,o,l,c,d,u,f,h,A,x,p,b,m,g,y,v,_,N,j,N,B,E,C,k,w,T,R,q,z,ee,Y,G,re,U,S,D,L;return ss(this,function(P){switch(P.label){case 0:if(!e||typeof e!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(r=e.ownerDocument,!r)throw new Error("Element is not attached to a Document");if(a=r.defaultView,!a)throw new Error("Document is not attached to a Window");return s={allowTaint:(B=t.allowTaint)!==null&&B!==void 0?B:!1,imageTimeout:(E=t.imageTimeout)!==null&&E!==void 0?E:15e3,proxy:t.proxy,useCORS:(C=t.useCORS)!==null&&C!==void 0?C:!1},i=p_({logging:(k=t.logging)!==null&&k!==void 0?k:!0,cache:t.cache},s),o={windowWidth:(w=t.windowWidth)!==null&&w!==void 0?w:a.innerWidth,windowHeight:(T=t.windowHeight)!==null&&T!==void 0?T:a.innerHeight,scrollX:(R=t.scrollX)!==null&&R!==void 0?R:a.pageXOffset,scrollY:(q=t.scrollY)!==null&&q!==void 0?q:a.pageYOffset},l=new Ml(o.scrollX,o.scrollY,o.windowWidth,o.windowHeight),c=new nV(i,l),d=(z=t.foreignObjectRendering)!==null&&z!==void 0?z:!1,u={allowTaint:(ee=t.allowTaint)!==null&&ee!==void 0?ee:!1,onclone:t.onclone,ignoreElements:t.ignoreElements,inlineImages:d,copyStyles:d},c.logger.debug("Starting document clone with size "+l.width+"x"+l.height+" scrolled to "+-l.left+","+-l.top),f=new Uk(c,e,u),h=f.clonedReferenceElement,h?[4,f.toIFrame(r,l)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return A=P.sent(),x=d2(h)||iK(h)?PM(h.ownerDocument):qx(c,h),p=x.width,b=x.height,m=x.left,g=x.top,y=sV(c,h,t.backgroundColor),v={canvas:t.canvas,backgroundColor:y,scale:(G=(Y=t.scale)!==null&&Y!==void 0?Y:a.devicePixelRatio)!==null&&G!==void 0?G:1,x:((re=t.x)!==null&&re!==void 0?re:0)+m,y:((U=t.y)!==null&&U!==void 0?U:0)+g,width:(S=t.width)!==null&&S!==void 0?S:Math.ceil(p),height:(D=t.height)!==null&&D!==void 0?D:Math.ceil(b)},d?(c.logger.debug("Document cloned, using foreign object rendering"),N=new eV(c,v),[4,N.render(h)]):[3,3];case 2:return _=P.sent(),[3,5];case 3:return c.logger.debug("Document cloned, element located at "+m+","+g+" with size "+p+"x"+b+" using computed rendering"),c.logger.debug("Starting DOM parsing"),j=pF(c,h),y===j.styles.backgroundColor&&(j.styles.backgroundColor=El.TRANSPARENT),c.logger.debug("Starting renderer for element at "+v.x+","+v.y+" with size "+v.width+"x"+v.height),N=new zK(c,v),[4,N.render(j)];case 4:_=P.sent(),P.label=5;case 5:return(!((L=t.removeContainer)!==null&&L!==void 0)||L)&&(Uk.destroy(A)||c.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),c.logger.debug("Finished rendering"),[2,_]}})})},sV=function(e,t,r){var a=t.ownerDocument,s=a.documentElement?Ef(e,getComputedStyle(a.documentElement).backgroundColor):El.TRANSPARENT,i=a.body?Ef(e,getComputedStyle(a.body).backgroundColor):El.TRANSPARENT,o=typeof r=="string"?Ef(e,r):r===null?El.TRANSPARENT:4294967295;return t===a.documentElement?Qc(s)?Qc(i)?o:i:s:o};const iV=Object.freeze(Object.defineProperty({__proto__:null,default:Zo},Symbol.toStringTag,{value:"Module"}));function oV({materialReturn:e,items:t,onClose:r}){const a=Q.useRef(null),s=d=>{const u=new Date(d),f=u.getDate(),h=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][u.getMonth()],A=u.getFullYear();return`${f} ${h} ${A}`},i=d=>d==null?"Rp 0,00":`Rp ${d.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})}`,o=()=>{window.print()},l=async()=>{if(a.current)try{const d=await Zo(a.current,{scale:2,useCORS:!0,allowTaint:!0,logging:!1,backgroundColor:"#ffffff",windowWidth:a.current.scrollWidth,windowHeight:a.current.scrollHeight,onclone:g=>{const y=g.getElementById("return-print-content");y&&(y.style.width="210mm")}}),u=d.toDataURL("image/png",1),f=new Ut("p","mm","a4"),h=f.internal.pageSize.getWidth(),A=f.internal.pageSize.getHeight(),x=d.width,p=d.height,b=h/x,m=p*b;if(m>A){let g=0,y=m;for(;y>0;)f.addImage(u,"PNG",0,g,h,m),y-=A,g-=A,y>0&&f.addPage()}else f.addImage(u,"PNG",0,0,h,m);f.save(`MaterialReturn-${e.return_number}.pdf`)}catch(d){console.error("Error generating PDF:",d),alert("Failed to generate PDF. Please try again.")}},c=e.customers;return n.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto bg-gray-900 bg-opacity-75 print:static print:bg-white print:overflow-visible",children:[n.jsx("div",{className:"flex min-h-screen items-start justify-center p-4 pt-10 print:p-0 print:min-h-0 print:block",children:n.jsxs("div",{className:"relative w-full max-w-5xl bg-white shadow-xl print:shadow-none print:max-w-full",children:[n.jsxs("div",{className:"sticky top-0 z-10 flex items-center justify-between border-b bg-white px-6 py-4 print:hidden",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:["Material Return ",e.return_number]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("button",{onClick:o,className:"flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-2 text-white hover:bg-blue-700",children:[n.jsx($l,{className:"h-4 w-4"}),"Print"]}),n.jsxs("button",{onClick:l,className:"flex items-center gap-2 rounded-lg bg-green-600 px-4 py-2 text-white hover:bg-green-700",children:[n.jsx(Zn,{className:"h-4 w-4"}),"PDF"]}),n.jsx("button",{onClick:r,className:"rounded-lg bg-gray-100 p-2 text-gray-600 hover:bg-gray-200",children:n.jsx(wr,{className:"h-5 w-5"})})]})]}),n.jsxs("div",{id:"return-print-content",ref:a,className:"p-8",children:[n.jsxs("div",{className:"mb-3 border-2 border-black p-3 print:mb-2 print:p-2",children:[n.jsxs("div",{className:"mb-2 flex items-start justify-between",children:[n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"h-16 w-16 flex items-center justify-center print:h-12 print:w-12",style:{backgroundColor:"#fff"},children:n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",xmlSpace:"preserve",width:"100%",height:"100%",viewBox:"0 0 15686.55 15480.24",style:{shapeRendering:"geometricPrecision",fillRule:"evenodd",clipRule:"evenodd"},children:n.jsxs("g",{children:[n.jsx("path",{fill:"#FDB763",d:"M69.94 10438.12l10353.39 0 0 -1798.67 1665.92 0 0 1868.6 0 320.44 0 4552.28c0,38.48 -31.45,69.94 -69.94,69.94l-11949.38 0c-38.48,0 -69.94,-31.45 -69.94,-69.94l0 -4872.72c0,-38.48 31.45,-69.94 69.94,-69.94zm1605.9 1710.15l8737.57 0c13.58,0 24.68,11.11 24.68,24.68l0 1719.84c0,13.58 -11.11,24.68 -24.68,24.68l-8737.57 0c-13.58,0 -24.68,-11.11 -24.68,-24.68l0 -1719.84c0,-13.58 11.11,-24.68 24.68,-24.68z"}),n.jsx("path",{fill:"#FDB763",d:"M15587.15 5136.67l-10353.49 0 0 1822.07 -1665.92 0 0 -1892.9 0 -324.61 0 -4611.43c0,-39 31.45,-70.87 69.94,-70.87l11949.47 0c38.48,0 69.94,31.87 69.94,70.87l0 4936.04c0,39 -31.45,70.83 -69.94,70.83zm-1605.9 -1732.36l-8737.67 0c-13.58,0 -24.68,-11.27 -24.68,-25l0 -1742.21c0,-13.74 11.11,-25 24.68,-25l8737.67 0c13.58,0 24.68,11.27 24.68,25l0 1742.21c0,13.74 -11.11,25 -24.68,25z"}),n.jsx("polygon",{fill:"#FD6D26",points:"-0,0 1651.16,0 1651.16,6929.27 15657.09,6929.27 15657.09,6958.74 15686.55,6958.74 15686.55,15480.24 14022.85,15480.24 14022.85,8639.45 1651.16,8639.45 -0,8639.45 -0,6929.27"})]})})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-base font-bold print:text-sm",children:"PT. SHUBHAM ANZEN PHARMA JAYA"}),n.jsx("p",{className:"text-xs print:text-[10px]",children:"Komplek Ruko Metro Sunter Blok A1 NO.15, Jl. Metro Indah Raya,"}),n.jsx("p",{className:"text-xs print:text-[10px]",children:"Kelurahan Papanggo, Kec. Tanjung Priok, Jakarta Utara - 14340"}),n.jsx("p",{className:"text-xs print:text-[10px]",children:"Telp: (+62 21) 65832426"})]})]}),n.jsx("div",{className:"text-right",children:n.jsx("h2",{className:"text-3xl font-bold text-orange-600 print:text-2xl",children:"MATERIAL RETURN"})})]}),n.jsxs("div",{className:"text-xs space-y-0.5 print:text-[10px] print:space-y-0",children:[n.jsxs("div",{children:[n.jsx("span",{className:"font-semibold",children:"No izin PBF"}),n.jsx("span",{className:"ml-16",children:": 27092400534390007"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"font-semibold",children:"No Sertifikasi CDOB"}),n.jsx("span",{className:"ml-4",children:": 270924005343900070001"})]})]})]}),n.jsx("div",{className:"mb-3 border-2 border-black p-3 print:mb-2 print:p-2",children:n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("div",{className:"space-y-1 text-xs print:text-[10px] print:space-y-0 flex-1",children:[n.jsxs("div",{children:[n.jsx("span",{className:"font-bold",children:"Customer:"}),n.jsxs("span",{className:"font-semibold",children:[" ",(c==null?void 0:c.company_name)||""]})]}),n.jsxs("div",{className:"pt-1 flex",children:[n.jsx("span",{className:"font-bold",style:{minWidth:"72px"},children:"Address:"}),n.jsxs("div",{children:[n.jsx("p",{children:(c==null?void 0:c.address)||""}),n.jsx("p",{children:(c==null?void 0:c.city)||""})]})]}),n.jsxs("div",{className:"flex pt-1",children:[n.jsx("span",{className:"font-bold",style:{minWidth:"72px"},children:"Phone:"}),n.jsx("span",{children:(c==null?void 0:c.phone)||""})]})]}),n.jsxs("div",{className:"space-y-1 text-xs print:text-[10px] print:space-y-0 text-right",style:{minWidth:"220px"},children:[n.jsxs("div",{children:[n.jsx("span",{className:"font-bold",children:"Return No:"}),n.jsx("span",{className:"ml-2",children:e.return_number})]}),n.jsxs("div",{children:[n.jsx("span",{className:"font-bold",children:"Return Date:"}),n.jsx("span",{className:"ml-2",children:s(e.return_date)})]}),e.delivery_challans&&n.jsxs("div",{className:"pt-1",children:[n.jsx("span",{className:"font-bold",children:"Original DC:"}),n.jsx("span",{className:"ml-2",children:e.delivery_challans.challan_number})]}),n.jsxs("div",{className:"pt-1",children:[n.jsx("span",{className:"font-bold",children:"Return Type:"}),n.jsx("span",{className:"ml-2",children:e.return_type.replace("_"," ").toUpperCase()})]}),n.jsxs("div",{children:[n.jsx("span",{className:"font-bold",children:"Status:"}),n.jsx("span",{className:`ml-2 px-2 py-0.5 rounded text-xs font-semibold ${e.status==="approved"?"bg-green-100 text-green-800":e.status==="rejected"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:e.status.replace("_"," ").toUpperCase()})]})]})]})}),n.jsx("div",{children:n.jsxs("table",{className:"w-full border-2 border-black text-xs print:text-[10px]",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"border-b-2 border-black bg-white",children:[n.jsx("th",{className:"border-r border-black p-1.5 text-center font-bold print:p-1",children:"No."}),n.jsx("th",{className:"border-r border-black p-1.5 text-left font-bold print:p-1",children:"Product Name"}),n.jsx("th",{className:"border-r border-black p-1.5 text-center font-bold print:p-1",children:"Batch No."}),n.jsx("th",{className:"border-r border-black p-1.5 text-center font-bold print:p-1",children:"Original Qty"}),n.jsx("th",{className:"border-r border-black p-1.5 text-center font-bold print:p-1",children:"Return Qty"}),n.jsx("th",{className:"border-r border-black p-1.5 text-center font-bold print:p-1",children:"Condition"}),n.jsx("th",{className:"border-r border-black p-1.5 text-right font-bold print:p-1",children:"Unit Price"}),n.jsx("th",{className:"p-1.5 text-right font-bold print:p-1",children:"Total"})]})}),n.jsxs("tbody",{children:[t.map((d,u)=>{var h,A;const f=d.quantity_returned*d.unit_price;return n.jsxs("tr",{className:"border-b border-black",children:[n.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:u+1}),n.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:((h=d.products)==null?void 0:h.product_name)||"Unknown Product"}),n.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:((A=d.batches)==null?void 0:A.batch_number)||"N/A"}),n.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:d.original_quantity.toLocaleString()}),n.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:d.quantity_returned.toLocaleString()}),n.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:d.condition.toUpperCase()}),n.jsx("td",{className:"border-r border-black p-1.5 text-right print:p-1",children:i(d.unit_price)}),n.jsx("td",{className:"p-1.5 text-right print:p-1",children:i(f)})]},d.id||u)}),t.length<2&&Array.from({length:2-t.length}).map((d,u)=>n.jsxs("tr",{className:"border-b border-black",children:[n.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:""}),n.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),n.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),n.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),n.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),n.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),n.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),n.jsx("td",{className:"p-1.5 print:p-1",children:""})]},`empty-${u}`))]})]})}),n.jsxs("div",{className:"border-2 border-black border-t-0",children:[n.jsxs("div",{className:"flex items-stretch border-b-2 border-black",children:[n.jsxs("div",{className:"flex-1 p-2 border-r-2 border-black print:p-1.5",children:[n.jsx("p",{className:"text-xs font-bold print:text-[10px]",children:"Return Reason:"}),n.jsx("p",{className:"text-xs mt-0.5 print:text-[10px] print:mt-0",children:e.return_reason})]}),n.jsx("div",{className:"w-64 text-xs p-2 print:text-[10px] print:p-1.5",children:n.jsxs("div",{className:"flex justify-between border-t-2 border-black py-1 print:py-0.5",children:[n.jsx("span",{className:"font-bold",children:"Total Value"}),n.jsx("span",{className:"font-bold text-sm text-orange-600 print:text-xs",children:i(e.financial_impact||0)})]})})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-0 text-xs print:text-[10px]",children:[n.jsxs("div",{className:"p-3 border-r-2 border-black print:p-2 text-center",children:[n.jsx("p",{className:"font-semibold mb-12 print:mb-10",children:"Prepared By"}),n.jsx("div",{className:"border-t border-black pt-1 mx-4",children:"Name & Signature"})]}),n.jsxs("div",{className:"p-3 border-r-2 border-black print:p-2 text-center",children:[n.jsx("p",{className:"font-semibold mb-12 print:mb-10",children:"Checked By"}),n.jsx("div",{className:"border-t border-black pt-1 mx-4",children:"QC / Manager"})]}),n.jsxs("div",{className:"p-3 print:p-2 text-center",children:[n.jsx("p",{className:"font-semibold mb-1",children:"Approved By"}),n.jsx("p",{className:"font-semibold mb-9 print:mb-7",children:"PT. SHUBHAM ANZEN PHARMA JAYA"}),n.jsx("div",{className:"border-t border-black pt-1 mx-4",children:"Pharmacist"})]})]})]}),e.notes&&n.jsx("div",{className:"mt-3 border-2 border-black p-2 print:mt-2 print:p-1.5",children:n.jsxs("p",{className:"text-xs print:text-[10px]",children:[n.jsx("span",{className:"font-bold",children:"Additional Notes: "}),n.jsx("span",{children:e.notes})]})})]})]})}),n.jsx("style",{children:`
        @media print {
          @page {
            size: A4 portrait;
            margin: 8mm;
          }

          .sticky {
            display: none !important;
          }

          body {
            margin: 0;
            padding: 0;
          }

          body * {
            visibility: hidden;
          }

          #return-print-content,
          #return-print-content * {
            visibility: visible;
          }

          #return-print-content {
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            page-break-inside: avoid;
            page-break-after: auto;
          }

          #return-print-content > div {
            page-break-inside: avoid;
          }

          table {
            page-break-inside: auto;
          }

          tr {
            page-break-inside: avoid;
            page-break-after: auto;
          }

          thead {
            display: table-header-group;
          }

          tfoot {
            display: table-footer-group;
          }
        }
      `})]})}function EF(){const{user:e,profile:t}=Cr(),{t:r}=cn(),[a,s]=Q.useState([]),[i,o]=Q.useState(!0),[l,c]=Q.useState(!1),[d,u]=Q.useState(!1),[f,h]=Q.useState(null),[A,x]=Q.useState([]),[p,b]=Q.useState(!1),[m,g]=Q.useState(null),[y,v]=Q.useState([]),[_,j]=Q.useState([]),[N,B]=Q.useState([]),[E,C]=Q.useState([]),[k,w]=Q.useState({customer_id:"",original_dc_id:"",return_date:new Date().toISOString().split("T")[0],return_type:"quality_issue",return_reason:"",notes:""});Q.useEffect(()=>{T(),R()},[]);const T=async()=>{try{const{data:M,error:se}=await Z.from("material_returns").select(`
          *,
          customers(company_name, address, city, phone),
          delivery_challans(challan_number)
        `).order("created_at",{ascending:!1});if(se)throw se;s(M||[])}catch(M){console.error("Error loading returns:",M)}finally{o(!1)}},R=async()=>{try{const{data:M,error:se}=await Z.from("customers").select("id, company_name").eq("is_active",!0).order("company_name");if(se)throw se;v(M||[])}catch(M){console.error("Error loading customers:",M)}},q=async M=>{try{const{data:se,error:K}=await Z.from("sales_invoices").select("linked_challan_ids").not("linked_challan_ids","is",null);if(K)throw K;const he=new Set;(se||[]).forEach(_e=>{_e.linked_challan_ids&&Array.isArray(_e.linked_challan_ids)&&_e.linked_challan_ids.forEach(de=>he.add(de))});const{data:ne,error:te}=await Z.from("delivery_challans").select("id, challan_number, challan_date, customer_id").eq("customer_id",M).order("challan_date",{ascending:!1});if(te)throw te;const ce=(ne||[]).filter(_e=>!he.has(_e.id));j(ce)}catch(se){console.error("Error loading delivery challans:",se)}},z=async M=>{try{const{data:se,error:K}=await Z.from("delivery_challan_items").select(`
          product_id,
          batch_id,
          quantity,
          products(product_name, product_code),
          batches(batch_number, import_price, duty_charges, freight_charges, other_charges, import_quantity)
        `).eq("challan_id",M);if(K)throw K;B(se||[]);const he=(se||[]).map(ne=>{const te=ne.batches;let ce=0;return te&&te.import_quantity>0&&(ce=Math.round((te.import_price+te.duty_charges+te.freight_charges+te.other_charges)/te.import_quantity*1.25)),{product_id:ne.product_id,batch_id:ne.batch_id,quantity_returned:0,original_quantity:ne.quantity,unit_price:ce,condition:"good",disposition:"pending",notes:""}});C(he)}catch(se){console.error("Error loading challan items:",se)}},ee=M=>{w({...k,customer_id:M,original_dc_id:""}),B([]),C([]),M?q(M):j([])},Y=M=>{w({...k,original_dc_id:M}),M?z(M):(B([]),C([]))},G=(M,se,K)=>{const he=[...E];he[M]={...he[M],[se]:K},C(he)},re=async M=>{if(M.preventDefault(),!k.customer_id||!k.original_dc_id||!k.return_reason){alert("Please complete all required fields");return}const se=E.filter(he=>he.quantity_returned>0);if(se.length===0){alert("Please enter at least one item with return quantity");return}if(se.some(he=>he.quantity_returned>he.original_quantity)){alert("Return quantity cannot exceed original quantity");return}try{const he=se.reduce((ne,te)=>ne+te.quantity_returned*te.unit_price,0);if(p&&m){const{error:ne}=await Z.from("material_returns").update({customer_id:k.customer_id,original_dc_id:k.original_dc_id,return_date:k.return_date,return_type:k.return_type,return_reason:k.return_reason,notes:k.notes,financial_impact:he}).eq("id",m).eq("status","pending_approval");if(ne)throw ne;const{error:te}=await Z.from("material_return_items").delete().eq("return_id",m);if(te)throw te;const ce=se.map(de=>({return_id:m,product_id:de.product_id,batch_id:de.batch_id,quantity_returned:de.quantity_returned,original_quantity:de.original_quantity,unit_price:de.unit_price,condition:de.condition,disposition:de.disposition,notes:de.notes})),{error:_e}=await Z.from("material_return_items").insert(ce);if(_e)throw _e;alert("Material return updated successfully.")}else{const{data:ne,error:te}=await Z.from("material_returns").insert({customer_id:k.customer_id,original_dc_id:k.original_dc_id,return_date:k.return_date,return_type:k.return_type,return_reason:k.return_reason,notes:k.notes,financial_impact:he,status:"pending_approval",created_by:e==null?void 0:e.id}).select().single();if(te)throw te;const ce=se.map(de=>({return_id:ne.id,product_id:de.product_id,batch_id:de.batch_id,quantity_returned:de.quantity_returned,original_quantity:de.original_quantity,unit_price:de.unit_price,condition:de.condition,disposition:de.disposition,notes:de.notes})),{error:_e}=await Z.from("material_return_items").insert(ce);if(_e)throw _e;alert("Material return created successfully. Pending approval.")}c(!1),I(),T()}catch(he){console.error("Error saving return:",he),alert(he.message||"Failed to save material return")}},U=async M=>{try{const{data:se,error:K}=await Z.from("material_return_items").select(`
          *,
          products(product_name, product_code),
          batches(batch_number)
        `).eq("return_id",M.id);if(K)throw K;h(M),x(se||[]),u(!0)}catch(se){console.error("Error loading return items:",se),alert("Failed to load return details")}},S=async M=>{try{const{data:se,error:K}=await Z.from("material_return_items").select(`
          *,
          products(product_name, product_code),
          batches(batch_number, import_price, duty_charges, freight_charges, other_charges, import_quantity)
        `).eq("return_id",M.id);if(K)throw K;w({customer_id:M.customer_id,original_dc_id:M.original_dc_id,return_date:M.return_date,return_type:M.return_type,return_reason:M.return_reason,notes:M.notes||""}),await q(M.customer_id),await z(M.original_dc_id);const he=(se||[]).map(ne=>({product_id:ne.product_id,batch_id:ne.batch_id,quantity_returned:ne.quantity_returned,original_quantity:ne.original_quantity,unit_price:ne.unit_price,condition:ne.condition,disposition:ne.disposition,notes:ne.notes||""}));C(he),b(!0),g(M.id),c(!0)}catch(se){console.error("Error loading return for edit:",se),alert("Failed to load return for editing")}},D=async M=>{if(confirm("Approve this material return? Stock will be added back to inventory based on disposition."))try{const{error:se}=await Z.from("material_returns").update({status:"approved",approved_by:e==null?void 0:e.id,restocked:!0}).eq("id",M);if(se)throw se;alert("Material return approved successfully"),T()}catch(se){console.error("Error approving return:",se),alert(se.message||"Failed to approve material return")}},L=async M=>{const se=prompt("Enter reason for rejection:");if(se)try{const{error:K}=await Z.from("material_returns").update({status:"rejected",approved_by:e==null?void 0:e.id,notes:se}).eq("id",M);if(K)throw K;alert("Material return rejected"),T()}catch(K){console.error("Error rejecting return:",K),alert(K.message||"Failed to reject material return")}},P=async M=>{if(confirm("Are you sure you want to delete this material return?"))try{const{error:se}=await Z.from("material_returns").delete().eq("id",M);if(se)throw se;T()}catch(se){console.error("Error deleting return:",se),alert("Failed to delete material return")}},I=()=>{w({customer_id:"",original_dc_id:"",return_date:new Date().toISOString().split("T")[0],return_type:"quality_issue",return_reason:"",notes:""}),B([]),C([]),j([]),b(!1),g(null)},H=(t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="sales"||(t==null?void 0:t.role)==="manager",V=(t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="manager",W=[{key:"return_number",label:"Return #",render:(M,se)=>se.return_number||"Pending"},{key:"return_date",label:"Date",render:(M,se)=>new Date(se.return_date).toLocaleDateString()},{key:"customer",label:"Customer",render:(M,se)=>{var K;return((K=se.customers)==null?void 0:K.company_name)||"N/A"}},{key:"dc_number",label:"Original DC",render:(M,se)=>{var K;return((K=se.delivery_challans)==null?void 0:K.challan_number)||"N/A"}},{key:"return_type",label:"Type",render:(M,se)=>se.return_type.replace("_"," ")},{key:"status",label:"Status",render:(M,se)=>n.jsx("span",{className:`inline-block px-2 py-1 rounded-full text-xs font-medium ${se.status==="approved"?"bg-green-100 text-green-800":se.status==="rejected"?"bg-red-100 text-red-800":se.status==="completed"?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"}`,children:se.status.replace("_"," ")})}];return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Material Returns"}),n.jsx("p",{className:"text-gray-600 mt-1",children:"Manage physical returns before invoicing"})]}),H&&n.jsxs("button",{onClick:()=>{I(),c(!0)},className:"flex items-center gap-2 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition",children:[n.jsx(Pr,{className:"w-5 h-5"}),"Create Material Return"]})]}),n.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 flex gap-3",children:[n.jsx(Ga,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}),n.jsxs("div",{className:"text-sm text-yellow-800",children:[n.jsx("p",{className:"font-medium",children:"Material Returns vs Credit Notes:"}),n.jsx("p",{className:"mt-1",children:"Use Material Returns for physical goods returned BEFORE invoice is made (e.g., DC 100kg  return 20kg). For returns AFTER invoice filing, use Credit Notes."})]})]}),n.jsx(Fs,{columns:W,data:a,loading:i,actions:M=>n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>U(M),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",title:"View Return",children:n.jsx(bi,{className:"w-4 h-4"})}),H&&M.status==="pending_approval"&&n.jsx("button",{onClick:()=>S(M),className:"p-1 text-yellow-600 hover:bg-yellow-50 rounded",title:"Edit Return",children:n.jsx(Aa,{className:"w-4 h-4"})}),V&&M.status==="pending_approval"&&n.jsxs(n.Fragment,{children:[n.jsx("button",{onClick:()=>D(M.id),className:"p-1 text-green-600 hover:bg-green-50 rounded",title:"Approve Return",children:n.jsx(Zr,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>L(M.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Reject Return",children:n.jsx(gn,{className:"w-4 h-4"})})]}),H&&M.status==="pending_approval"&&n.jsx("button",{onClick:()=>P(M.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Delete Return",children:n.jsx(Lr,{className:"w-4 h-4"})})]})}),n.jsx(Ot,{isOpen:l,onClose:()=>{c(!1),I()},title:p?"Edit Material Return":"Create Material Return",size:"xl",children:n.jsxs("form",{onSubmit:re,className:"space-y-6",children:[n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx(N5,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),n.jsxs("div",{className:"text-sm text-blue-800",children:[n.jsx("p",{className:"font-medium",children:"How Material Returns Work:"}),n.jsxs("ol",{className:"mt-1 list-decimal list-inside space-y-1",children:[n.jsx("li",{children:"Select the customer who is returning goods"}),n.jsx("li",{children:"Choose the Delivery Challan that was originally dispatched"}),n.jsx("li",{children:"The system will show all products, batches, quantities, and prices from that DC"}),n.jsx("li",{children:"Enter the quantity being returned for each item"}),n.jsx("li",{children:"After approval, stock will be added back to inventory"})]})]})]})}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer *"}),n.jsxs("select",{value:k.customer_id,onChange:M=>ee(M.target.value),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[n.jsx("option",{value:"",children:"Select Customer"}),y.map(M=>n.jsx("option",{value:M.id,children:M.company_name},M.id))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Original Delivery Challan *"}),n.jsxs("select",{value:k.original_dc_id,onChange:M=>Y(M.target.value),required:!0,disabled:!k.customer_id,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent disabled:bg-gray-100",children:[n.jsx("option",{value:"",children:"Select Delivery Challan"}),_.map(M=>n.jsxs("option",{value:M.id,children:[M.challan_number," - ",new Date(M.challan_date).toLocaleDateString()]},M.id))]}),k.customer_id&&_.length===0&&n.jsx("p",{className:"text-xs text-orange-600 mt-1",children:"No uninvoiced delivery challans found. All DCs are already invoiced - use Credit Notes for returns after invoicing."})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Return Date *"}),n.jsx("input",{type:"date",value:k.return_date,onChange:M=>w({...k,return_date:M.target.value}),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Return Type *"}),n.jsxs("select",{value:k.return_type,onChange:M=>w({...k,return_type:M.target.value}),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[n.jsx("option",{value:"quality_issue",children:"Quality Issue"}),n.jsx("option",{value:"wrong_product",children:"Wrong Product"}),n.jsx("option",{value:"excess_quantity",children:"Excess Quantity"}),n.jsx("option",{value:"damaged",children:"Damaged"}),n.jsx("option",{value:"expired",children:"Expired"}),n.jsx("option",{value:"other",children:"Other"})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Return Reason *"}),n.jsx("textarea",{value:k.return_reason,onChange:M=>w({...k,return_reason:M.target.value}),required:!0,rows:3,placeholder:"Explain why the goods are being returned...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),N.length>0&&n.jsxs("div",{className:"border-t pt-6",children:[n.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-4",children:"Items from Delivery Challan"}),n.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Enter the quantity being returned for each item. Leave as 0 if not returning that item."}),n.jsx("div",{className:"space-y-3",children:N.map((M,se)=>{const K=E[se];return K?n.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg border border-gray-200",children:[n.jsxs("div",{className:"grid grid-cols-12 gap-4",children:[n.jsxs("div",{className:"col-span-3",children:[n.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Product"}),n.jsx("div",{className:"text-sm font-medium text-gray-900",children:M.products.product_name}),n.jsxs("div",{className:"text-xs text-gray-500",children:["Code: ",M.products.product_code]})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Batch"}),n.jsx("div",{className:"text-sm font-medium text-gray-900",children:M.batches.batch_number})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Dispatched Qty (Kg)"}),n.jsxs("div",{className:"text-sm font-medium text-blue-600",children:[M.quantity," Kg"]})]}),n.jsxs("div",{className:"col-span-1",children:[n.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Unit Price (per Kg)"}),n.jsx("div",{className:"text-sm font-medium text-gray-900",children:K.unit_price.toLocaleString()})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Return Qty (Kg) *"}),n.jsx("input",{type:"number",step:"0.01",value:K.quantity_returned||"",onChange:he=>G(se,"quantity_returned",parseFloat(he.target.value)||0),max:M.quantity,min:"0",className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-green-500",placeholder:"Enter Kg"}),K.quantity_returned>M.quantity&&n.jsxs("p",{className:"text-xs text-red-600 mt-1",children:["Cannot exceed ",M.quantity]})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Condition"}),n.jsxs("select",{value:K.condition,onChange:he=>G(se,"condition",he.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-green-500",children:[n.jsx("option",{value:"good",children:"Good"}),n.jsx("option",{value:"damaged",children:"Damaged"}),n.jsx("option",{value:"expired",children:"Expired"}),n.jsx("option",{value:"unusable",children:"Unusable"})]})]})]}),K.quantity_returned>0&&n.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Disposition"}),n.jsxs("select",{value:K.disposition,onChange:he=>G(se,"disposition",he.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-green-500",children:[n.jsx("option",{value:"pending",children:"Pending Decision"}),n.jsx("option",{value:"restock",children:"Restock"}),n.jsx("option",{value:"scrap",children:"Scrap"}),n.jsx("option",{value:"return_to_supplier",children:"Return to Supplier"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Notes (optional)"}),n.jsx("input",{type:"text",value:K.notes||"",onChange:he=>G(se,"notes",he.target.value),placeholder:"Any additional notes...",className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-green-500"})]})]})]},se):null})})]}),N.length===0&&k.original_dc_id&&n.jsxs("div",{className:"text-center py-8 text-gray-500",children:[n.jsx(N5,{className:"w-12 h-12 mx-auto mb-2 text-gray-400"}),n.jsx("p",{children:"No items found in the selected delivery challan"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Additional Notes"}),n.jsx("textarea",{value:k.notes,onChange:M=>w({...k,notes:M.target.value}),rows:2,placeholder:"Any additional information...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-6 border-t",children:[n.jsx("button",{type:"button",onClick:()=>{c(!1),I()},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),n.jsx("button",{type:"submit",className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition",children:p?"Update Material Return":"Create Material Return"})]})]})}),d&&f&&n.jsx(oV,{materialReturn:f,items:A,onClose:()=>{u(!1),h(null),x([])}})]})}function lV({rejection:e,onClose:t}){const r=Q.useRef(null),a=l=>{const c=new Date(l),d=c.getDate(),u=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][c.getMonth()],f=c.getFullYear();return`${d} ${u} ${f}`},s=l=>l==null?"Rp 0,00":`Rp ${l.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})}`,i=()=>{window.print()},o=async()=>{if(r.current)try{const l=await Zo(r.current,{scale:2,useCORS:!0,allowTaint:!0,logging:!1,backgroundColor:"#ffffff",windowWidth:r.current.scrollWidth,windowHeight:r.current.scrollHeight,onclone:b=>{const m=b.getElementById("rejection-print-content");m&&(m.style.width="210mm")}}),c=l.toDataURL("image/png",1),d=new Ut("p","mm","a4"),u=d.internal.pageSize.getWidth(),f=d.internal.pageSize.getHeight(),h=l.width,A=l.height,x=u/h,p=A*x;if(p>f){let b=0,m=p;for(;m>0;)d.addImage(c,"PNG",0,b,u,p),m-=f,b-=f,m>0&&d.addPage()}else d.addImage(c,"PNG",0,0,u,p);d.save(`StockRejection-${e.rejection_number}.pdf`)}catch(l){console.error("Error generating PDF:",l),alert("Failed to generate PDF. Please try again.")}};return n.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto bg-gray-900 bg-opacity-75 print:static print:bg-white print:overflow-visible",children:[n.jsx("div",{className:"flex min-h-screen items-start justify-center p-4 pt-10 print:p-0 print:min-h-0 print:block",children:n.jsxs("div",{className:"relative w-full max-w-5xl bg-white shadow-xl print:shadow-none print:max-w-full",children:[n.jsxs("div",{className:"sticky top-0 z-10 flex items-center justify-between border-b bg-white px-6 py-4 print:hidden",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:["Stock Rejection ",e.rejection_number]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("button",{onClick:i,className:"flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-2 text-white hover:bg-blue-700",children:[n.jsx($l,{className:"h-4 w-4"}),"Print"]}),n.jsxs("button",{onClick:o,className:"flex items-center gap-2 rounded-lg bg-green-600 px-4 py-2 text-white hover:bg-green-700",children:[n.jsx(Zn,{className:"h-4 w-4"}),"PDF"]}),n.jsx("button",{onClick:t,className:"rounded-lg bg-gray-100 p-2 text-gray-600 hover:bg-gray-200",children:n.jsx(wr,{className:"h-5 w-5"})})]})]}),n.jsxs("div",{id:"rejection-print-content",ref:r,className:"p-8",children:[n.jsxs("div",{className:"mb-3 border-2 border-black p-3 print:mb-2 print:p-2",children:[n.jsxs("div",{className:"mb-2 flex items-start justify-between",children:[n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"h-16 w-16 flex items-center justify-center print:h-12 print:w-12",style:{backgroundColor:"#fff"},children:n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",xmlSpace:"preserve",width:"100%",height:"100%",viewBox:"0 0 15686.55 15480.24",style:{shapeRendering:"geometricPrecision",fillRule:"evenodd",clipRule:"evenodd"},children:n.jsxs("g",{children:[n.jsx("path",{fill:"#FDB763",d:"M69.94 10438.12l10353.39 0 0 -1798.67 1665.92 0 0 1868.6 0 320.44 0 4552.28c0,38.48 -31.45,69.94 -69.94,69.94l-11949.38 0c-38.48,0 -69.94,-31.45 -69.94,-69.94l0 -4872.72c0,-38.48 31.45,-69.94 69.94,-69.94zm1605.9 1710.15l8737.57 0c13.58,0 24.68,11.11 24.68,24.68l0 1719.84c0,13.58 -11.11,24.68 -24.68,24.68l-8737.57 0c-13.58,0 -24.68,-11.11 -24.68,-24.68l0 -1719.84c0,-13.58 11.11,-24.68 24.68,-24.68z"}),n.jsx("path",{fill:"#FDB763",d:"M15587.15 5136.67l-10353.49 0 0 1822.07 -1665.92 0 0 -1892.9 0 -324.61 0 -4611.43c0,-39 31.45,-70.87 69.94,-70.87l11949.47 0c38.48,0 69.94,31.87 69.94,70.87l0 4936.04c0,39 -31.45,70.83 -69.94,70.83zm-1605.9 -1732.36l-8737.67 0c-13.58,0 -24.68,-11.27 -24.68,-25l0 -1742.21c0,-13.74 11.11,-25 24.68,-25l8737.67 0c13.58,0 24.68,11.27 24.68,25l0 1742.21c0,13.74 -11.11,25 -24.68,25z"}),n.jsx("polygon",{fill:"#FD6D26",points:"-0,0 1651.16,0 1651.16,6929.27 15657.09,6929.27 15657.09,6958.74 15686.55,6958.74 15686.55,15480.24 14022.85,15480.24 14022.85,8639.45 1651.16,8639.45 -0,8639.45 -0,6929.27"})]})})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-base font-bold print:text-sm",children:"PT. SHUBHAM ANZEN PHARMA JAYA"}),n.jsx("p",{className:"text-xs print:text-[10px]",children:"Komplek Ruko Metro Sunter Blok A1 NO.15, Jl. Metro Indah Raya,"}),n.jsx("p",{className:"text-xs print:text-[10px]",children:"Kelurahan Papanggo, Kec. Tanjung Priok, Jakarta Utara - 14340"}),n.jsx("p",{className:"text-xs print:text-[10px]",children:"Telp: (+62 21) 65832426"})]})]}),n.jsx("div",{className:"text-right",children:n.jsx("h2",{className:"text-3xl font-bold text-red-600 print:text-2xl",children:"STOCK REJECTION"})})]}),n.jsxs("div",{className:"text-xs space-y-0.5 print:text-[10px] print:space-y-0",children:[n.jsxs("div",{children:[n.jsx("span",{className:"font-semibold",children:"No izin PBF"}),n.jsx("span",{className:"ml-16",children:": 27092400534390007"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"font-semibold",children:"No Sertifikasi CDOB"}),n.jsx("span",{className:"ml-4",children:": 270924005343900070001"})]})]})]}),n.jsx("div",{className:"mb-3 border-2 border-black p-3 print:mb-2 print:p-2",children:n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("div",{className:"space-y-1 text-xs print:text-[10px] print:space-y-0 flex-1",children:[n.jsxs("div",{children:[n.jsx("span",{className:"font-bold",children:"Product:"}),n.jsxs("span",{className:"font-semibold",children:[" ",e.product.product_name]})]}),n.jsxs("div",{children:[n.jsx("span",{className:"font-bold",children:"Product Code:"}),n.jsx("span",{className:"ml-2",children:e.product.product_code})]}),n.jsxs("div",{className:"pt-1",children:[n.jsx("span",{className:"font-bold",children:"Batch Number:"}),n.jsx("span",{className:"ml-2",children:e.batch.batch_number})]}),n.jsxs("div",{children:[n.jsx("span",{className:"font-bold",children:"Batch Stock:"}),n.jsxs("span",{className:"ml-2",children:[e.batch.current_stock.toLocaleString()," ",e.product.unit]})]})]}),n.jsxs("div",{className:"space-y-1 text-xs print:text-[10px] print:space-y-0 text-right",style:{minWidth:"220px"},children:[n.jsxs("div",{children:[n.jsx("span",{className:"font-bold",children:"Rejection No:"}),n.jsx("span",{className:"ml-2",children:e.rejection_number})]}),n.jsxs("div",{children:[n.jsx("span",{className:"font-bold",children:"Date:"}),n.jsx("span",{className:"ml-2",children:a(e.rejection_date)})]}),n.jsxs("div",{className:"pt-1",children:[n.jsx("span",{className:"font-bold",children:"Qty Rejected:"}),n.jsxs("span",{className:"ml-2 text-red-600 font-semibold",children:[e.quantity_rejected.toLocaleString()," ",e.product.unit]})]}),n.jsxs("div",{children:[n.jsx("span",{className:"font-bold",children:"Status:"}),n.jsx("span",{className:`ml-2 px-2 py-0.5 rounded text-xs font-semibold ${e.status==="approved"?"bg-green-100 text-green-800":e.status==="rejected"?"bg-red-100 text-red-800":e.status==="disposed"?"bg-gray-100 text-gray-800":"bg-yellow-100 text-yellow-800"}`,children:e.status.replace("_"," ").toUpperCase()})]})]})]})}),n.jsx("div",{className:"mb-3 border-2 border-black print:mb-2",children:n.jsxs("table",{className:"w-full text-xs print:text-[10px]",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"border-b-2 border-black bg-white",children:[n.jsx("th",{className:"border-r border-black p-2 text-left font-bold print:p-1",children:"Rejection Details"}),n.jsx("th",{className:"p-2 text-left font-bold print:p-1",children:"Financial Impact"})]})}),n.jsx("tbody",{children:n.jsxs("tr",{children:[n.jsx("td",{className:"border-r border-black p-2 print:p-1 align-top",children:n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{children:[n.jsx("span",{className:"font-bold",children:"Reason: "}),n.jsx("span",{className:"uppercase",children:e.rejection_reason.replace("_"," ")})]}),n.jsxs("div",{children:[n.jsx("span",{className:"font-bold",children:"Details: "}),n.jsx("p",{className:"mt-1",children:e.rejection_details})]}),e.inspection_report&&n.jsxs("div",{children:[n.jsx("span",{className:"font-bold",children:"Inspection Report: "}),n.jsx("p",{className:"mt-1",children:e.inspection_report})]}),n.jsxs("div",{children:[n.jsx("span",{className:"font-bold",children:"Disposition: "}),n.jsx("span",{className:"uppercase",children:e.disposition.replace("_"," ")})]})]})}),n.jsx("td",{className:"p-2 print:p-1 align-top",children:n.jsxs("div",{className:"space-y-1",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{children:"Unit Cost:"}),n.jsx("span",{className:"font-semibold",children:s(e.unit_cost)})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{children:"Quantity:"}),n.jsxs("span",{className:"font-semibold",children:[e.quantity_rejected.toLocaleString()," ",e.product.unit]})]}),n.jsxs("div",{className:"flex justify-between pt-1 border-t-2 border-black",children:[n.jsx("span",{className:"font-bold",children:"Total Loss:"}),n.jsx("span",{className:"font-bold text-red-600",children:s(e.financial_loss)})]})]})})]})})]})}),e.photos&&e.photos.length>0&&n.jsxs("div",{className:"mb-3 border-2 border-black p-3 print:mb-2 print:p-2 print:hidden",children:[n.jsx("h3",{className:"text-sm font-bold mb-2",children:"Rejection Photos"}),n.jsx("div",{className:"grid grid-cols-3 gap-2",children:e.photos.map((l,c)=>n.jsxs("div",{className:"border border-gray-300 rounded overflow-hidden",children:[n.jsx("img",{src:l.url,alt:`Rejection photo ${c+1}`,className:"w-full h-32 object-cover"}),n.jsxs("div",{className:"text-xs p-1 bg-gray-50 text-center",children:["Photo ",c+1]})]},c))})]}),n.jsx("div",{className:"border-2 border-black",children:n.jsxs("div",{className:"grid grid-cols-3 gap-0 text-xs print:text-[10px]",children:[n.jsxs("div",{className:"p-3 border-r-2 border-black print:p-2 text-center",children:[n.jsx("p",{className:"font-semibold mb-12 print:mb-10",children:"Inspected By"}),n.jsx("div",{className:"border-t border-black pt-1 mx-4",children:"QC Inspector"})]}),n.jsxs("div",{className:"p-3 border-r-2 border-black print:p-2 text-center",children:[n.jsx("p",{className:"font-semibold mb-12 print:mb-10",children:"Reviewed By"}),n.jsx("div",{className:"border-t border-black pt-1 mx-4",children:"QC Manager"})]}),n.jsxs("div",{className:"p-3 print:p-2 text-center",children:[n.jsx("p",{className:"font-semibold mb-1",children:"Approved By"}),n.jsx("p",{className:"font-semibold mb-9 print:mb-7",children:"PT. SHUBHAM ANZEN PHARMA JAYA"}),n.jsx("div",{className:"border-t border-black pt-1 mx-4",children:"Management"})]})]})})]})]})}),n.jsx("style",{children:`
        @media print {
          @page {
            size: A4 portrait;
            margin: 8mm;
          }

          .sticky {
            display: none !important;
          }

          body {
            margin: 0;
            padding: 0;
          }

          body * {
            visibility: hidden;
          }

          #rejection-print-content,
          #rejection-print-content * {
            visibility: visible;
          }

          #rejection-print-content {
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            page-break-inside: avoid;
            page-break-after: auto;
          }

          #rejection-print-content > div {
            page-break-inside: avoid;
          }

          table {
            page-break-inside: auto;
          }

          tr {
            page-break-inside: avoid;
            page-break-after: auto;
          }

          thead {
            display: table-header-group;
          }

          tfoot {
            display: table-footer-group;
          }
        }
      `})]})}function cV(){const{user:e,userProfile:t}=Cr(),{t:r}=cn(),[a,s]=Q.useState([]),[i,o]=Q.useState([]),[l,c]=Q.useState(""),[d,u]=Q.useState("all"),[f,h]=Q.useState(!1),[A,x]=Q.useState(!1),[p,b]=Q.useState(null),[m,g]=Q.useState(!0),[y,v]=Q.useState(!1),[_,j]=Q.useState(null),[N,B]=Q.useState([]),[E,C]=Q.useState([]),[k,w]=Q.useState([]),[T,R]=Q.useState([]),[q,z]=Q.useState({product_id:"",batch_id:"",rejection_date:new Date().toISOString().split("T")[0],quantity_rejected:0,rejection_reason:"quality_failed",rejection_details:"",disposition:"pending",inspection_report:""});Q.useEffect(()=>{ee(),Y()},[]),Q.useEffect(()=>{re()},[l,d,a]);const ee=async()=>{try{g(!0);const{data:M,error:se}=await Z.from("stock_rejections").select(`
          *,
          product:products(product_name, product_code, unit),
          batch:batches(batch_number, current_stock)
        `).order("created_at",{ascending:!1});if(se)throw se;s(M||[])}catch(M){console.error("Error fetching rejections:",M),alert(r("errorFetchingRejections")||"Error fetching rejections")}finally{g(!1)}},Y=async()=>{const{data:M}=await Z.from("products").select("id, product_name, product_code").eq("is_active",!0).order("product_name");B(M||[])},G=async M=>{const{data:se}=await Z.from("batches").select("id, batch_number, current_stock, import_price").eq("product_id",M).gt("current_stock",0).order("batch_number");C(se||[])},re=()=>{let M=a;d!=="all"&&(M=M.filter(se=>se.status===d)),l&&(M=M.filter(se=>se.rejection_number.toLowerCase().includes(l.toLowerCase())||se.product.product_name.toLowerCase().includes(l.toLowerCase())||se.batch.batch_number.toLowerCase().includes(l.toLowerCase())||se.rejection_details.toLowerCase().includes(l.toLowerCase()))),o(M)},U=M=>{z({...q,product_id:M,batch_id:""}),M&&G(M)},S=M=>{if(M.target.files){const se=Array.from(M.target.files);w([...k,...se]),se.forEach(K=>{const he=new FileReader;he.onloadend=()=>{R(ne=>[...ne,he.result])},he.readAsDataURL(K)})}},D=M=>{w(k.filter((se,K)=>K!==M)),R(T.filter((se,K)=>K!==M))},L=async M=>{try{if(z({product_id:M.product_id,batch_id:M.batch_id,rejection_date:M.rejection_date,quantity_rejected:M.quantity_rejected,rejection_reason:M.rejection_reason,rejection_details:M.rejection_details,disposition:M.disposition,inspection_report:M.inspection_report||""}),await G(M.product_id),M.photos&&Array.isArray(M.photos)){const se=M.photos.map(K=>K.url);R(se)}v(!0),j(M.id),h(!0)}catch(se){console.error("Error loading rejection for edit:",se),alert("Failed to load rejection for editing")}},P=async(M,se)=>{if(confirm("Are you sure you want to delete this stock rejection? This action cannot be undone."))try{if(se&&Array.isArray(se)&&se.length>0){for(const he of se)if(he.url){const ne=he.url.split("/").pop();ne&&await Z.storage.from("rejection_photos").remove([`${M}/${ne}`])}}const{error:K}=await Z.from("stock_rejections").delete().eq("id",M).eq("status","pending_approval");if(K)throw K;alert("Stock rejection deleted successfully"),ee()}catch(K){console.error("Error deleting rejection:",K),alert(K.message||"Failed to delete stock rejection")}},I=async M=>{const se=[];for(const K of k){const he=`${M}/${Date.now()}_${K.name}`,{data:ne,error:te}=await Z.storage.from("rejection_photos").upload(he,K);if(te){console.error("Error uploading photo:",te);continue}const{data:ce}=Z.storage.from("rejection_photos").getPublicUrl(he);se.push({url:ce.publicUrl,filename:K.name,uploaded_at:new Date().toISOString()})}return se},H=async M=>{if(M.preventDefault(),!q.product_id||!q.batch_id||!q.rejection_details){alert(r("pleaseCompleteAllFields")||"Please complete all required fields");return}try{const se=E.find(ne=>ne.id===q.batch_id);if(!se){alert(r("invalidBatch")||"Invalid batch selected");return}if(q.quantity_rejected>se.current_stock){alert(r("quantityExceedsStock")||`Rejection quantity cannot exceed available stock (${se.current_stock})`);return}const K=se.import_price||0,he=q.quantity_rejected*K;if(y&&_){const{error:ne}=await Z.from("stock_rejections").update({...q,unit_cost:K,financial_loss:he,inspected_by:e==null?void 0:e.id}).eq("id",_).eq("status","pending_approval");if(ne)throw ne;let te=[];if(k.length>0){te=await I(_);const{data:ce}=await Z.from("stock_rejections").select("photos").eq("id",_).single(),de=[...(ce==null?void 0:ce.photos)||[],...te];await Z.from("stock_rejections").update({photos:de}).eq("id",_)}alert("Stock rejection updated successfully")}else{const{data:ne,error:te}=await Z.from("stock_rejections").insert({...q,unit_cost:K,financial_loss:he,created_by:e==null?void 0:e.id,inspected_by:e==null?void 0:e.id}).select().single();if(te)throw te;let ce=[];if(k.length>0&&(ce=await I(ne.id),await Z.from("stock_rejections").update({photos:ce}).eq("id",ne.id)),he>=100){const _e=he>=1e3?"admin":"manager";await Z.from("approval_workflows").insert({transaction_type:"stock_rejection",transaction_id:ne.id,requested_by:e==null?void 0:e.id,amount:he,quantity:q.quantity_rejected,status:"pending",metadata:{required_role:_e}})}alert(r("rejectionCreatedSuccessfully")||"Stock rejection created successfully")}h(!1),V(),ee()}catch(se){console.error("Error saving rejection:",se),alert(se.message||r("errorCreatingRejection")||"Error saving stock rejection")}},V=()=>{z({product_id:"",batch_id:"",rejection_date:new Date().toISOString().split("T")[0],quantity_rejected:0,rejection_reason:"quality_failed",rejection_details:"",disposition:"pending",inspection_report:""}),w([]),R([]),v(!1),j(null)},W=M=>{const se={pending_approval:"bg-yellow-100 text-yellow-800",approved:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800",disposed:"bg-gray-100 text-gray-800"},K={pending_approval:n.jsx(da,{className:"w-3 h-3 mr-1"}),approved:n.jsx(Zr,{className:"w-3 h-3 mr-1"}),rejected:n.jsx(gn,{className:"w-3 h-3 mr-1"}),disposed:n.jsx(Zr,{className:"w-3 h-3 mr-1"})};return n.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${se[M]||"bg-gray-100 text-gray-800"}`,children:[K[M],M.replace("_"," ").toUpperCase()]})};return m?n.jsx("div",{className:"flex items-center justify-center h-64",children:n.jsx("div",{className:"text-lg",children:r("loading")||"Loading..."})}):n.jsxs("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[n.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[n.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:r("stockRejections")||"Stock Rejections"}),n.jsxs("button",{onClick:()=>h(!0),className:"inline-flex items-center justify-center px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:[n.jsx(Ga,{className:"w-5 h-5 mr-2"}),r("newRejection")||"New Rejection"]})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[n.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-4",children:[n.jsxs("div",{className:"relative flex-1",children:[n.jsx(Ca,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),n.jsx("input",{type:"text",placeholder:r("searchRejections")||"Search rejections...",value:l,onChange:M=>c(M.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),n.jsxs("select",{value:d,onChange:M=>u(M.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{value:"all",children:r("allStatuses")||"All Statuses"}),n.jsx("option",{value:"pending_approval",children:r("pendingApproval")||"Pending Approval"}),n.jsx("option",{value:"approved",children:r("approved")||"Approved"}),n.jsx("option",{value:"rejected",children:r("rejected")||"Rejected"}),n.jsx("option",{value:"disposed",children:r("disposed")||"Disposed"})]})]}),n.jsxs("div",{className:"overflow-x-auto",children:[n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:r("rejectionNumber")||"Rejection #"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:r("date")||"Date"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:r("product")||"Product"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:r("batch")||"Batch"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:r("quantity")||"Quantity"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:r("reason")||"Reason"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:r("loss")||"Loss"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:r("status")||"Status"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:r("actions")||"Actions"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:i.map(M=>{var se;return n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:M.rejection_number}),n.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:new Date(M.rejection_date).toLocaleDateString()}),n.jsxs("td",{className:"px-4 py-3 text-sm text-gray-900",children:[n.jsx("div",{children:M.product.product_name}),n.jsx("div",{className:"text-xs text-gray-500",children:M.product.product_code})]}),n.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:M.batch.batch_number}),n.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:M.quantity_rejected}),n.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:M.rejection_reason.replace("_"," ")}),n.jsxs("td",{className:"px-4 py-3 text-sm text-red-600 font-medium",children:["$",((se=M.financial_loss)==null?void 0:se.toFixed(2))||"0.00"]}),n.jsx("td",{className:"px-4 py-3 text-sm",children:W(M.status)}),n.jsx("td",{className:"px-4 py-3 text-sm",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("button",{onClick:()=>{b(M),x(!0)},className:"text-blue-600 hover:text-blue-800 inline-flex items-center",children:[n.jsx(bi,{className:"w-4 h-4 mr-1"}),r("view")||"View"]}),M.status==="pending_approval"&&n.jsxs(n.Fragment,{children:[n.jsx("button",{onClick:()=>L(M),className:"text-yellow-600 hover:text-yellow-800 inline-flex items-center",title:"Edit Rejection",children:n.jsx(Aa,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>P(M.id,M.photos),className:"text-red-600 hover:text-red-800 inline-flex items-center",title:"Delete Rejection",children:n.jsx(Lr,{className:"w-4 h-4"})})]})]})})]},M.id)})})]}),i.length===0&&n.jsx("div",{className:"text-center py-8 text-gray-500",children:r("noRejectionsFound")||"No rejections found"})]})]}),f&&n.jsx(Ot,{isOpen:f,onClose:()=>{h(!1),V()},title:y?r("editStockRejection")||"Edit Stock Rejection":r("createStockRejection")||"Create Stock Rejection",children:n.jsxs("form",{onSubmit:H,className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r("product")||"Product"," *"]}),n.jsxs("select",{value:q.product_id,onChange:M=>U(M.target.value),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{value:"",children:r("selectProduct")||"Select Product"}),N.map(M=>n.jsxs("option",{value:M.id,children:[M.product_name," (",M.product_code,")"]},M.id))]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r("batch")||"Batch"," *"]}),n.jsxs("select",{value:q.batch_id,onChange:M=>z({...q,batch_id:M.target.value}),required:!0,disabled:!q.product_id,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100",children:[n.jsx("option",{value:"",children:r("selectBatch")||"Select Batch"}),E.map(M=>n.jsxs("option",{value:M.id,children:[M.batch_number," (Stock: ",M.current_stock,")"]},M.id))]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r("rejectionDate")||"Rejection Date"," *"]}),n.jsx("input",{type:"date",value:q.rejection_date,onChange:M=>z({...q,rejection_date:M.target.value}),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r("quantityRejected")||"Quantity Rejected (Kg)"," *"]}),n.jsx("input",{type:"number",step:"0.01",value:q.quantity_rejected||"",onChange:M=>z({...q,quantity_rejected:parseFloat(M.target.value)}),required:!0,min:"0.01",placeholder:"Enter quantity in Kg",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r("rejectionReason")||"Rejection Reason"," *"]}),n.jsxs("select",{value:q.rejection_reason,onChange:M=>z({...q,rejection_reason:M.target.value}),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{value:"quality_failed",children:r("qualityFailed")||"Quality Failed"}),n.jsx("option",{value:"expired",children:r("expired")||"Expired"}),n.jsx("option",{value:"damaged",children:r("damaged")||"Damaged"}),n.jsx("option",{value:"contaminated",children:r("contaminated")||"Contaminated"}),n.jsx("option",{value:"other",children:r("other")||"Other"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:r("disposition")||"Disposition"}),n.jsxs("select",{value:q.disposition,onChange:M=>z({...q,disposition:M.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{value:"pending",children:r("pending")||"Pending"}),n.jsx("option",{value:"scrap",children:r("scrap")||"Scrap"}),n.jsx("option",{value:"return_to_supplier",children:r("returnToSupplier")||"Return to Supplier"}),n.jsx("option",{value:"rework",children:r("rework")||"Rework"})]})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r("rejectionDetails")||"Rejection Details"," *"]}),n.jsx("textarea",{value:q.rejection_details,onChange:M=>z({...q,rejection_details:M.target.value}),required:!0,rows:3,placeholder:r("describeRejectionReason")||"Describe the reason for rejection in detail...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r("inspectionReport")||"Inspection Report"," (Optional)"]}),n.jsx("textarea",{value:q.inspection_report,onChange:M=>z({...q,inspection_report:M.target.value}),rows:3,placeholder:r("enterInspectionReport")||"Enter inspection report details...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[r("photos")||"Photos"," (",k.length,")"]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("label",{className:"flex items-center justify-center px-4 py-3 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:border-blue-400 transition-colors",children:[n.jsx(u7,{className:"w-5 h-5 mr-2 text-gray-400"}),n.jsx("span",{className:"text-sm text-gray-600",children:r("uploadPhotos")||"Upload Photos"}),n.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:S,className:"hidden"})]}),T.length>0&&n.jsx("div",{className:"grid grid-cols-3 gap-2",children:T.map((M,se)=>n.jsxs("div",{className:"relative",children:[n.jsx("img",{src:M,alt:`Photo ${se+1}`,className:"w-full h-24 object-cover rounded-lg"}),n.jsx("button",{type:"button",onClick:()=>D(se),className:"absolute top-1 right-1 bg-red-600 text-white rounded-full p-1 hover:bg-red-700",children:n.jsx(gn,{className:"w-4 h-4"})})]},se))})]})]}),n.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 flex items-start",children:[n.jsx(Ga,{className:"w-5 h-5 text-yellow-600 mr-2 flex-shrink-0 mt-0.5"}),n.jsxs("div",{className:"text-sm text-yellow-800",children:[n.jsx("p",{className:"font-medium",children:r("approvalRequired")||"Approval Required"}),n.jsx("p",{className:"mt-1",children:r("rejectionApprovalNote")||"Rejections under $100 require manager approval. Over $100 require manager approval. Over $1000 require admin approval."})]})]}),n.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[n.jsx("button",{type:"button",onClick:()=>{h(!1),V()},className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:r("cancel")||"Cancel"}),n.jsx("button",{type:"submit",className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:y?r("updateRejection")||"Update Rejection":r("createRejection")||"Create Rejection"})]})]})}),A&&p&&n.jsx(lV,{rejection:p,onClose:()=>{x(!1),b(null)}})]})}function dV(){const{t:e}=cn(),{profile:t}=Cr(),[r,a]=Q.useState("transactions"),[s,i]=Q.useState([]),[o,l]=Q.useState([]),[c,d]=Q.useState([]),[u,f]=Q.useState([]),[h,A]=Q.useState([]),[x,p]=Q.useState([]),[b,m]=Q.useState(!0),[g,y]=Q.useState(null),[v,_]=Q.useState(!1),[j,N]=Q.useState("transaction"),[B,E]=Q.useState({transaction_type:"adjustment",product_id:"",batch_id:"",quantity:0,reference_number:"",notes:"",transaction_date:new Date().toISOString().split("T")[0]}),[C,k]=Q.useState({customer_id:"",return_date:new Date().toISOString().split("T")[0],return_type:"quality_issue",return_reason:"",notes:""}),[w,T]=Q.useState({product_id:"",batch_id:"",rejection_date:new Date().toISOString().split("T")[0],quantity_rejected:0,rejection_reason:"quality_failed",rejection_details:"",unit_cost:0});Q.useEffect(()=>{R()},[r]);const R=async()=>{m(!0),y(null);try{await Y(),await G(),await re(),r==="transactions"?await q():r==="returns"?await z():r==="rejections"&&await ee()}catch{y("Failed to load inventory data. Please try again.")}m(!1)},q=async()=>{const{data:V,error:W}=await Z.from("inventory_transactions").select(`
        *,
        products(product_name, product_code),
        batches(batch_number),
        user_profiles(full_name)
      `).order("transaction_date",{ascending:!1}).order("created_at",{ascending:!1});if(W)throw W;i(V||[])},z=async()=>{const{data:V,error:W}=await Z.from("material_returns").select(`
        *,
        customer:customers(company_name)
      `).order("return_date",{ascending:!1});if(W)throw W;l(V||[])},ee=async()=>{const{data:V,error:W}=await Z.from("stock_rejections").select(`
        *,
        product:products(product_name, product_code),
        batch:batches(batch_number)
      `).order("rejection_date",{ascending:!1});if(W)throw W;d(V||[])},Y=async()=>{const{data:V,error:W}=await Z.from("products").select("id, product_name, product_code").eq("is_active",!0).order("product_name");if(W)throw W;f(V||[])},G=async()=>{const{data:V,error:W}=await Z.from("batches").select("id, batch_number, product_id, current_stock").eq("is_active",!0).gt("current_stock",0).order("import_date",{ascending:!1});if(W)throw W;A(V||[])},re=async()=>{const{data:V,error:W}=await Z.from("customers").select("id, company_name").eq("is_active",!0).order("company_name");if(W)throw W;p(V||[])},U=async V=>{V.preventDefault();try{const{data:{user:W}}=await Z.auth.getUser();if(!W)throw new Error("Not authenticated");if(B.batch_id){let M=B.quantity;B.transaction_type==="sale"&&(M=-M);const{error:se}=await Z.rpc("adjust_batch_stock_atomic",{p_batch_id:B.batch_id,p_quantity_change:M,p_transaction_type:B.transaction_type,p_reference_id:null,p_notes:B.notes||null,p_created_by:W.id});if(se)throw se}else{const{error:M}=await Z.from("inventory_transactions").insert([{...B,batch_id:null,reference_number:B.reference_number||null,notes:B.notes||null,created_by:W.id}]);if(M)throw M}_(!1),L(),R(),alert("Transaction added successfully")}catch(W){console.error("Error saving transaction:",W),alert("Failed to save transaction. Please try again.")}},S=async V=>{V.preventDefault();try{const{data:{user:W}}=await Z.auth.getUser();if(!W)throw new Error("Not authenticated");const{error:M}=await Z.from("material_returns").insert([{...C,created_by:W.id}]);if(M)throw M;_(!1),L(),R(),alert("Material return created successfully. Awaiting approval.")}catch(W){console.error("Error creating return:",W),alert("Failed to create return. Please try again.")}},D=async V=>{V.preventDefault();try{const{data:{user:W}}=await Z.auth.getUser();if(!W)throw new Error("Not authenticated");const{error:M}=await Z.from("stock_rejections").insert([{...w,created_by:W.id}]);if(M)throw M;_(!1),L(),R(),alert("Stock rejection created successfully. Awaiting approval.")}catch(W){console.error("Error creating rejection:",W),alert("Failed to create rejection. Please try again.")}},L=()=>{E({transaction_type:"adjustment",product_id:"",batch_id:"",quantity:0,reference_number:"",notes:"",transaction_date:new Date().toISOString().split("T")[0]}),k({customer_id:"",return_date:new Date().toISOString().split("T")[0],return_type:"quality_issue",return_reason:"",notes:""}),T({product_id:"",batch_id:"",rejection_date:new Date().toISOString().split("T")[0],quantity_rejected:0,rejection_reason:"quality_failed",rejection_details:"",unit_cost:0})},P=(t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="warehouse"||(t==null?void 0:t.role)==="manager",I=[{key:"transaction_date",label:"Date",render:(V,W)=>new Date(W.transaction_date).toLocaleDateString()},{key:"transaction_type",label:"Type",render:(V,W)=>n.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${W.transaction_type==="purchase"?"bg-green-100 text-green-800":W.transaction_type==="sale"?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"}`,children:[W.transaction_type==="purchase"&&n.jsx(zo,{className:"w-3 h-3"}),W.transaction_type==="sale"&&n.jsx(FE,{className:"w-3 h-3"}),W.transaction_type==="adjustment"&&n.jsx(Hs,{className:"w-3 h-3"}),W.transaction_type.charAt(0).toUpperCase()+W.transaction_type.slice(1)]})},{key:"product",label:"Product",render:(V,W)=>{var M,se;return n.jsxs("div",{children:[n.jsx("div",{className:"font-medium",children:(M=W.products)==null?void 0:M.product_name}),n.jsx("div",{className:"text-xs text-gray-500",children:(se=W.products)==null?void 0:se.product_code})]})}},{key:"batch_number",label:"Batch",render:(V,W)=>{var M;return((M=W.batches)==null?void 0:M.batch_number)||"N/A"}},{key:"quantity",label:"Quantity",render:(V,W)=>n.jsxs("span",{className:`font-semibold ${W.transaction_type==="purchase"?"text-green-600":W.transaction_type==="sale"?"text-red-600":"text-blue-600"}`,children:[W.transaction_type==="purchase"?"+":W.transaction_type==="sale"?"-":"",W.quantity]})},{key:"reference_number",label:"Reference",render:(V,W)=>W.reference_number||(W.transaction_type==="purchase"?"Batch Import":"-")}],H=h.filter(V=>r==="transactions"?V.product_id===B.product_id:r==="rejections"?V.product_id===w.product_id:!1);return n.jsx(Un,{children:n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Inventory Management"}),n.jsx("p",{className:"text-gray-600 mt-1",children:"Track transactions, returns, and rejections"})]}),P&&r==="transactions"&&n.jsxs("button",{onClick:()=>{L(),N("transaction"),_(!0)},className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition",children:[n.jsx(Pr,{className:"w-5 h-5"}),"Add Transaction"]})]}),n.jsx("div",{className:"border-b border-gray-200",children:n.jsxs("nav",{className:"flex gap-8",children:[n.jsxs("button",{onClick:()=>a("transactions"),className:`flex items-center gap-2 pb-4 border-b-2 transition ${r==="transactions"?"border-blue-600 text-blue-600 font-medium":"border-transparent text-gray-600 hover:text-gray-900"}`,children:[n.jsx(Rr,{className:"w-5 h-5"}),"Transactions"]}),n.jsxs("button",{onClick:()=>a("returns"),className:`flex items-center gap-2 pb-4 border-b-2 transition ${r==="returns"?"border-blue-600 text-blue-600 font-medium":"border-transparent text-gray-600 hover:text-gray-900"}`,children:[n.jsx(t_,{className:"w-5 h-5"}),"Material Returns"]}),n.jsxs("button",{onClick:()=>a("rejections"),className:`flex items-center gap-2 pb-4 border-b-2 transition ${r==="rejections"?"border-blue-600 text-blue-600 font-medium":"border-transparent text-gray-600 hover:text-gray-900"}`,children:[n.jsx(Ga,{className:"w-5 h-5"}),"Stock Rejections"]})]})}),g&&n.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4 flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Ga,{className:"w-5 h-5 text-red-500"}),n.jsx("p",{className:"text-red-700",children:g})]}),n.jsx("button",{onClick:R,className:"px-3 py-1 bg-red-600 text-white rounded-lg hover:bg-red-700 transition text-sm",children:"Retry"})]}),r==="transactions"&&n.jsx(Fs,{columns:I,data:s,loading:b}),r==="returns"&&n.jsx(EF,{}),r==="rejections"&&n.jsx(cV,{}),n.jsxs(Ot,{isOpen:v,onClose:()=>{_(!1),L()},title:j==="transaction"?"Add Inventory Transaction":j==="return"?"Create Material Return":"Report Stock Rejection",children:[j==="transaction"&&n.jsxs("form",{onSubmit:U,className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Transaction Type *"}),n.jsxs("select",{value:B.transaction_type,onChange:V=>E({...B,transaction_type:V.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[n.jsx("option",{value:"purchase",children:"Purchase"}),n.jsx("option",{value:"sale",children:"Sale"}),n.jsx("option",{value:"adjustment",children:"Adjustment"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Product *"}),n.jsxs("select",{value:B.product_id,onChange:V=>E({...B,product_id:V.target.value,batch_id:""}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[n.jsx("option",{value:"",children:"Select Product"}),u.map(V=>n.jsxs("option",{value:V.id,children:[V.product_name," (",V.product_code,")"]},V.id))]})]}),B.product_id&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Batch (Optional)"}),n.jsxs("select",{value:B.batch_id,onChange:V=>E({...B,batch_id:V.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"",children:"Select Batch"}),H.map(V=>n.jsxs("option",{value:V.id,children:[V.batch_number," (Stock: ",V.current_stock,")"]},V.id))]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Quantity *"}),n.jsx("input",{type:"number",value:B.quantity,onChange:V=>E({...B,quantity:Number(V.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,min:"1"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Transaction Date *"}),n.jsx("input",{type:"date",value:B.transaction_date,onChange:V=>E({...B,transaction_date:V.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reference Number"}),n.jsx("input",{type:"text",value:B.reference_number,onChange:V=>E({...B,reference_number:V.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"e.g., SAPJ-001, PO-002"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),n.jsx("textarea",{value:B.notes,onChange:V=>E({...B,notes:V.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:3})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[n.jsx("button",{type:"button",onClick:()=>{_(!1),L()},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),n.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:"Add Transaction"})]})]}),j==="return"&&n.jsxs("form",{onSubmit:S,className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer *"}),n.jsxs("select",{value:C.customer_id,onChange:V=>k({...C,customer_id:V.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[n.jsx("option",{value:"",children:"Select Customer"}),x.map(V=>n.jsx("option",{value:V.id,children:V.company_name},V.id))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Return Type *"}),n.jsxs("select",{value:C.return_type,onChange:V=>k({...C,return_type:V.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[n.jsx("option",{value:"quality_issue",children:"Quality Issue"}),n.jsx("option",{value:"wrong_product",children:"Wrong Product"}),n.jsx("option",{value:"excess_quantity",children:"Excess Quantity"}),n.jsx("option",{value:"damaged",children:"Damaged"}),n.jsx("option",{value:"expired",children:"Expired"}),n.jsx("option",{value:"other",children:"Other"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Return Date *"}),n.jsx("input",{type:"date",value:C.return_date,onChange:V=>k({...C,return_date:V.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Return Reason *"}),n.jsx("textarea",{value:C.return_reason,onChange:V=>k({...C,return_reason:V.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:3,required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Additional Notes"}),n.jsx("textarea",{value:C.notes,onChange:V=>k({...C,notes:V.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:2})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[n.jsx("button",{type:"button",onClick:()=>{_(!1),L()},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),n.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:"Create Return"})]})]}),j==="rejection"&&n.jsxs("form",{onSubmit:D,className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Product *"}),n.jsxs("select",{value:w.product_id,onChange:V=>T({...w,product_id:V.target.value,batch_id:""}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[n.jsx("option",{value:"",children:"Select Product"}),u.map(V=>n.jsxs("option",{value:V.id,children:[V.product_name," (",V.product_code,")"]},V.id))]})]}),w.product_id&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Batch *"}),n.jsxs("select",{value:w.batch_id,onChange:V=>T({...w,batch_id:V.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[n.jsx("option",{value:"",children:"Select Batch"}),H.map(V=>n.jsxs("option",{value:V.id,children:[V.batch_number," (Stock: ",V.current_stock,")"]},V.id))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rejection Reason *"}),n.jsxs("select",{value:w.rejection_reason,onChange:V=>T({...w,rejection_reason:V.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[n.jsx("option",{value:"quality_failed",children:"Quality Failed"}),n.jsx("option",{value:"expired",children:"Expired"}),n.jsx("option",{value:"damaged",children:"Damaged"}),n.jsx("option",{value:"contaminated",children:"Contaminated"}),n.jsx("option",{value:"other",children:"Other"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Quantity Rejected *"}),n.jsx("input",{type:"number",value:w.quantity_rejected,onChange:V=>T({...w,quantity_rejected:Number(V.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,min:"1"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Unit Cost *"}),n.jsx("input",{type:"number",step:"0.01",value:w.unit_cost,onChange:V=>T({...w,unit_cost:Number(V.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,min:"0"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rejection Date *"}),n.jsx("input",{type:"date",value:w.rejection_date,onChange:V=>T({...w,rejection_date:V.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Detailed Description *"}),n.jsx("textarea",{value:w.rejection_details,onChange:V=>T({...w,rejection_details:V.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:3,required:!0})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[n.jsx("button",{type:"button",onClick:()=>{_(!1),L()},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),n.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:"Report Rejection"})]})]})]})]})})}function uV(){this.__data__=[],this.size=0}var AV=uV;function hV(e,t){return e===t||e!==e&&t!==t}var FF=hV,fV=FF;function pV(e,t){for(var r=e.length;r--;)if(fV(e[r][0],t))return r;return-1}var Zx=pV,mV=Zx,gV=Array.prototype,xV=gV.splice;function yV(e){var t=this.__data__,r=mV(t,e);if(r<0)return!1;var a=t.length-1;return r==a?t.pop():xV.call(t,r,1),--this.size,!0}var vV=yV,bV=Zx;function _V(e){var t=this.__data__,r=bV(t,e);return r<0?void 0:t[r][1]}var wV=_V,NV=Zx;function jV(e){return NV(this.__data__,e)>-1}var kV=jV,CV=Zx;function SV(e,t){var r=this.__data__,a=CV(r,e);return a<0?(++this.size,r.push([e,t])):r[a][1]=t,this}var BV=SV,EV=AV,FV=vV,TV=wV,IV=kV,DV=BV;function zA(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var a=e[t];this.set(a[0],a[1])}}zA.prototype.clear=EV;zA.prototype.delete=FV;zA.prototype.get=TV;zA.prototype.has=IV;zA.prototype.set=DV;var ey=zA,LV=ey;function PV(){this.__data__=new LV,this.size=0}var OV=PV;function UV(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var RV=UV;function MV(e){return this.__data__.get(e)}var QV=MV;function HV(e){return this.__data__.has(e)}var qV=HV,$V=typeof hi=="object"&&hi&&hi.Object===Object&&hi,TF=$V,KV=TF,VV=typeof self=="object"&&self&&self.Object===Object&&self,WV=KV||VV||Function("return this")(),Kl=WV,zV=Kl,GV=zV.Symbol,u2=GV,qk=u2,IF=Object.prototype,XV=IF.hasOwnProperty,YV=IF.toString,$h=qk?qk.toStringTag:void 0;function JV(e){var t=XV.call(e,$h),r=e[$h];try{e[$h]=void 0;var a=!0}catch{}var s=YV.call(e);return a&&(t?e[$h]=r:delete e[$h]),s}var ZV=JV,eW=Object.prototype,tW=eW.toString;function rW(e){return tW.call(e)}var nW=rW,$k=u2,aW=ZV,sW=nW,iW="[object Null]",oW="[object Undefined]",Kk=$k?$k.toStringTag:void 0;function lW(e){return e==null?e===void 0?oW:iW:Kk&&Kk in Object(e)?aW(e):sW(e)}var ty=lW;function cW(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var DF=cW,dW=ty,uW=DF,AW="[object AsyncFunction]",hW="[object Function]",fW="[object GeneratorFunction]",pW="[object Proxy]";function mW(e){if(!uW(e))return!1;var t=dW(e);return t==hW||t==fW||t==AW||t==pW}var LF=mW,gW=Kl,xW=gW["__core-js_shared__"],yW=xW,x1=yW,Vk=function(){var e=/[^.]+$/.exec(x1&&x1.keys&&x1.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function vW(e){return!!Vk&&Vk in e}var bW=vW,_W=Function.prototype,wW=_W.toString;function NW(e){if(e!=null){try{return wW.call(e)}catch{}try{return e+""}catch{}}return""}var PF=NW,jW=LF,kW=bW,CW=DF,SW=PF,BW=/[\\^$.*+?()[\]{}|]/g,EW=/^\[object .+?Constructor\]$/,FW=Function.prototype,TW=Object.prototype,IW=FW.toString,DW=TW.hasOwnProperty,LW=RegExp("^"+IW.call(DW).replace(BW,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function PW(e){if(!CW(e)||kW(e))return!1;var t=jW(e)?LW:EW;return t.test(SW(e))}var OW=PW;function UW(e,t){return e==null?void 0:e[t]}var RW=UW,MW=OW,QW=RW;function HW(e,t){var r=QW(e,t);return MW(r)?r:void 0}var GA=HW,qW=GA,$W=Kl,KW=qW($W,"Map"),A2=KW,VW=GA,WW=VW(Object,"create"),ry=WW,Wk=ry;function zW(){this.__data__=Wk?Wk(null):{},this.size=0}var GW=zW;function XW(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var YW=XW,JW=ry,ZW="__lodash_hash_undefined__",ez=Object.prototype,tz=ez.hasOwnProperty;function rz(e){var t=this.__data__;if(JW){var r=t[e];return r===ZW?void 0:r}return tz.call(t,e)?t[e]:void 0}var nz=rz,az=ry,sz=Object.prototype,iz=sz.hasOwnProperty;function oz(e){var t=this.__data__;return az?t[e]!==void 0:iz.call(t,e)}var lz=oz,cz=ry,dz="__lodash_hash_undefined__";function uz(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=cz&&t===void 0?dz:t,this}var Az=uz,hz=GW,fz=YW,pz=nz,mz=lz,gz=Az;function XA(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var a=e[t];this.set(a[0],a[1])}}XA.prototype.clear=hz;XA.prototype.delete=fz;XA.prototype.get=pz;XA.prototype.has=mz;XA.prototype.set=gz;var xz=XA,zk=xz,yz=ey,vz=A2;function bz(){this.size=0,this.__data__={hash:new zk,map:new(vz||yz),string:new zk}}var _z=bz;function wz(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var Nz=wz,jz=Nz;function kz(e,t){var r=e.__data__;return jz(t)?r[typeof t=="string"?"string":"hash"]:r.map}var ny=kz,Cz=ny;function Sz(e){var t=Cz(this,e).delete(e);return this.size-=t?1:0,t}var Bz=Sz,Ez=ny;function Fz(e){return Ez(this,e).get(e)}var Tz=Fz,Iz=ny;function Dz(e){return Iz(this,e).has(e)}var Lz=Dz,Pz=ny;function Oz(e,t){var r=Pz(this,e),a=r.size;return r.set(e,t),this.size+=r.size==a?0:1,this}var Uz=Oz,Rz=_z,Mz=Bz,Qz=Tz,Hz=Lz,qz=Uz;function YA(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var a=e[t];this.set(a[0],a[1])}}YA.prototype.clear=Rz;YA.prototype.delete=Mz;YA.prototype.get=Qz;YA.prototype.has=Hz;YA.prototype.set=qz;var OF=YA,$z=ey,Kz=A2,Vz=OF,Wz=200;function zz(e,t){var r=this.__data__;if(r instanceof $z){var a=r.__data__;if(!Kz||a.length<Wz-1)return a.push([e,t]),this.size=++r.size,this;r=this.__data__=new Vz(a)}return r.set(e,t),this.size=r.size,this}var Gz=zz,Xz=ey,Yz=OV,Jz=RV,Zz=QV,eG=qV,tG=Gz;function JA(e){var t=this.__data__=new Xz(e);this.size=t.size}JA.prototype.clear=Yz;JA.prototype.delete=Jz;JA.prototype.get=Zz;JA.prototype.has=eG;JA.prototype.set=tG;var rG=JA,nG="__lodash_hash_undefined__";function aG(e){return this.__data__.set(e,nG),this}var sG=aG;function iG(e){return this.__data__.has(e)}var oG=iG,lG=OF,cG=sG,dG=oG;function rx(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new lG;++t<r;)this.add(e[t])}rx.prototype.add=rx.prototype.push=cG;rx.prototype.has=dG;var uG=rx;function AG(e,t){for(var r=-1,a=e==null?0:e.length;++r<a;)if(t(e[r],r,e))return!0;return!1}var hG=AG;function fG(e,t){return e.has(t)}var pG=fG,mG=uG,gG=hG,xG=pG,yG=1,vG=2;function bG(e,t,r,a,s,i){var o=r&yG,l=e.length,c=t.length;if(l!=c&&!(o&&c>l))return!1;var d=i.get(e),u=i.get(t);if(d&&u)return d==t&&u==e;var f=-1,h=!0,A=r&vG?new mG:void 0;for(i.set(e,t),i.set(t,e);++f<l;){var x=e[f],p=t[f];if(a)var b=o?a(p,x,f,t,e,i):a(x,p,f,e,t,i);if(b!==void 0){if(b)continue;h=!1;break}if(A){if(!gG(t,function(m,g){if(!xG(A,g)&&(x===m||s(x,m,r,a,i)))return A.push(g)})){h=!1;break}}else if(!(x===p||s(x,p,r,a,i))){h=!1;break}}return i.delete(e),i.delete(t),h}var UF=bG,_G=Kl,wG=_G.Uint8Array,NG=wG;function jG(e){var t=-1,r=Array(e.size);return e.forEach(function(a,s){r[++t]=[s,a]}),r}var kG=jG;function CG(e){var t=-1,r=Array(e.size);return e.forEach(function(a){r[++t]=a}),r}var SG=CG,Gk=u2,Xk=NG,BG=FF,EG=UF,FG=kG,TG=SG,IG=1,DG=2,LG="[object Boolean]",PG="[object Date]",OG="[object Error]",UG="[object Map]",RG="[object Number]",MG="[object RegExp]",QG="[object Set]",HG="[object String]",qG="[object Symbol]",$G="[object ArrayBuffer]",KG="[object DataView]",Yk=Gk?Gk.prototype:void 0,y1=Yk?Yk.valueOf:void 0;function VG(e,t,r,a,s,i,o){switch(r){case KG:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case $G:return!(e.byteLength!=t.byteLength||!i(new Xk(e),new Xk(t)));case LG:case PG:case RG:return BG(+e,+t);case OG:return e.name==t.name&&e.message==t.message;case MG:case HG:return e==t+"";case UG:var l=FG;case QG:var c=a&IG;if(l||(l=TG),e.size!=t.size&&!c)return!1;var d=o.get(e);if(d)return d==t;a|=DG,o.set(e,t);var u=EG(l(e),l(t),a,s,i,o);return o.delete(e),u;case qG:if(y1)return y1.call(e)==y1.call(t)}return!1}var WG=VG;function zG(e,t){for(var r=-1,a=t.length,s=e.length;++r<a;)e[s+r]=t[r];return e}var GG=zG,XG=Array.isArray,h2=XG,YG=GG,JG=h2;function ZG(e,t,r){var a=t(e);return JG(e)?a:YG(a,r(e))}var eX=ZG;function tX(e,t){for(var r=-1,a=e==null?0:e.length,s=0,i=[];++r<a;){var o=e[r];t(o,r,e)&&(i[s++]=o)}return i}var rX=tX;function nX(){return[]}var aX=nX,sX=rX,iX=aX,oX=Object.prototype,lX=oX.propertyIsEnumerable,Jk=Object.getOwnPropertySymbols,cX=Jk?function(e){return e==null?[]:(e=Object(e),sX(Jk(e),function(t){return lX.call(e,t)}))}:iX,dX=cX;function uX(e,t){for(var r=-1,a=Array(e);++r<e;)a[r]=t(r);return a}var AX=uX;function hX(e){return e!=null&&typeof e=="object"}var ay=hX,fX=ty,pX=ay,mX="[object Arguments]";function gX(e){return pX(e)&&fX(e)==mX}var xX=gX,Zk=xX,yX=ay,RF=Object.prototype,vX=RF.hasOwnProperty,bX=RF.propertyIsEnumerable,_X=Zk(function(){return arguments}())?Zk:function(e){return yX(e)&&vX.call(e,"callee")&&!bX.call(e,"callee")},wX=_X,nx={exports:{}};function NX(){return!1}var jX=NX;nx.exports;(function(e,t){var r=Kl,a=jX,s=t&&!t.nodeType&&t,i=s&&!0&&e&&!e.nodeType&&e,o=i&&i.exports===s,l=o?r.Buffer:void 0,c=l?l.isBuffer:void 0,d=c||a;e.exports=d})(nx,nx.exports);var MF=nx.exports,kX=9007199254740991,CX=/^(?:0|[1-9]\d*)$/;function SX(e,t){var r=typeof e;return t=t??kX,!!t&&(r=="number"||r!="symbol"&&CX.test(e))&&e>-1&&e%1==0&&e<t}var BX=SX,EX=9007199254740991;function FX(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=EX}var QF=FX,TX=ty,IX=QF,DX=ay,LX="[object Arguments]",PX="[object Array]",OX="[object Boolean]",UX="[object Date]",RX="[object Error]",MX="[object Function]",QX="[object Map]",HX="[object Number]",qX="[object Object]",$X="[object RegExp]",KX="[object Set]",VX="[object String]",WX="[object WeakMap]",zX="[object ArrayBuffer]",GX="[object DataView]",XX="[object Float32Array]",YX="[object Float64Array]",JX="[object Int8Array]",ZX="[object Int16Array]",eY="[object Int32Array]",tY="[object Uint8Array]",rY="[object Uint8ClampedArray]",nY="[object Uint16Array]",aY="[object Uint32Array]",An={};An[XX]=An[YX]=An[JX]=An[ZX]=An[eY]=An[tY]=An[rY]=An[nY]=An[aY]=!0;An[LX]=An[PX]=An[zX]=An[OX]=An[GX]=An[UX]=An[RX]=An[MX]=An[QX]=An[HX]=An[qX]=An[$X]=An[KX]=An[VX]=An[WX]=!1;function sY(e){return DX(e)&&IX(e.length)&&!!An[TX(e)]}var iY=sY;function oY(e){return function(t){return e(t)}}var lY=oY,ax={exports:{}};ax.exports;(function(e,t){var r=TF,a=t&&!t.nodeType&&t,s=a&&!0&&e&&!e.nodeType&&e,i=s&&s.exports===a,o=i&&r.process,l=function(){try{var c=s&&s.require&&s.require("util").types;return c||o&&o.binding&&o.binding("util")}catch{}}();e.exports=l})(ax,ax.exports);var cY=ax.exports,dY=iY,uY=lY,eC=cY,tC=eC&&eC.isTypedArray,AY=tC?uY(tC):dY,HF=AY,hY=AX,fY=wX,pY=h2,mY=MF,gY=BX,xY=HF,yY=Object.prototype,vY=yY.hasOwnProperty;function bY(e,t){var r=pY(e),a=!r&&fY(e),s=!r&&!a&&mY(e),i=!r&&!a&&!s&&xY(e),o=r||a||s||i,l=o?hY(e.length,String):[],c=l.length;for(var d in e)(t||vY.call(e,d))&&!(o&&(d=="length"||s&&(d=="offset"||d=="parent")||i&&(d=="buffer"||d=="byteLength"||d=="byteOffset")||gY(d,c)))&&l.push(d);return l}var _Y=bY,wY=Object.prototype;function NY(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||wY;return e===r}var jY=NY;function kY(e,t){return function(r){return e(t(r))}}var CY=kY,SY=CY,BY=SY(Object.keys,Object),EY=BY,FY=jY,TY=EY,IY=Object.prototype,DY=IY.hasOwnProperty;function LY(e){if(!FY(e))return TY(e);var t=[];for(var r in Object(e))DY.call(e,r)&&r!="constructor"&&t.push(r);return t}var PY=LY,OY=LF,UY=QF;function RY(e){return e!=null&&UY(e.length)&&!OY(e)}var MY=RY,QY=_Y,HY=PY,qY=MY;function $Y(e){return qY(e)?QY(e):HY(e)}var KY=$Y,VY=eX,WY=dX,zY=KY;function GY(e){return VY(e,zY,WY)}var XY=GY,rC=XY,YY=1,JY=Object.prototype,ZY=JY.hasOwnProperty;function eJ(e,t,r,a,s,i){var o=r&YY,l=rC(e),c=l.length,d=rC(t),u=d.length;if(c!=u&&!o)return!1;for(var f=c;f--;){var h=l[f];if(!(o?h in t:ZY.call(t,h)))return!1}var A=i.get(e),x=i.get(t);if(A&&x)return A==t&&x==e;var p=!0;i.set(e,t),i.set(t,e);for(var b=o;++f<c;){h=l[f];var m=e[h],g=t[h];if(a)var y=o?a(g,m,h,t,e,i):a(m,g,h,e,t,i);if(!(y===void 0?m===g||s(m,g,r,a,i):y)){p=!1;break}b||(b=h=="constructor")}if(p&&!b){var v=e.constructor,_=t.constructor;v!=_&&"constructor"in e&&"constructor"in t&&!(typeof v=="function"&&v instanceof v&&typeof _=="function"&&_ instanceof _)&&(p=!1)}return i.delete(e),i.delete(t),p}var tJ=eJ,rJ=GA,nJ=Kl,aJ=rJ(nJ,"DataView"),sJ=aJ,iJ=GA,oJ=Kl,lJ=iJ(oJ,"Promise"),cJ=lJ,dJ=GA,uJ=Kl,AJ=dJ(uJ,"Set"),hJ=AJ,fJ=GA,pJ=Kl,mJ=fJ(pJ,"WeakMap"),gJ=mJ,O_=sJ,U_=A2,R_=cJ,M_=hJ,Q_=gJ,qF=ty,ZA=PF,nC="[object Map]",xJ="[object Object]",aC="[object Promise]",sC="[object Set]",iC="[object WeakMap]",oC="[object DataView]",yJ=ZA(O_),vJ=ZA(U_),bJ=ZA(R_),_J=ZA(M_),wJ=ZA(Q_),wd=qF;(O_&&wd(new O_(new ArrayBuffer(1)))!=oC||U_&&wd(new U_)!=nC||R_&&wd(R_.resolve())!=aC||M_&&wd(new M_)!=sC||Q_&&wd(new Q_)!=iC)&&(wd=function(e){var t=qF(e),r=t==xJ?e.constructor:void 0,a=r?ZA(r):"";if(a)switch(a){case yJ:return oC;case vJ:return nC;case bJ:return aC;case _J:return sC;case wJ:return iC}return t});var NJ=wd,v1=rG,jJ=UF,kJ=WG,CJ=tJ,lC=NJ,cC=h2,dC=MF,SJ=HF,BJ=1,uC="[object Arguments]",AC="[object Array]",Cm="[object Object]",EJ=Object.prototype,hC=EJ.hasOwnProperty;function FJ(e,t,r,a,s,i){var o=cC(e),l=cC(t),c=o?AC:lC(e),d=l?AC:lC(t);c=c==uC?Cm:c,d=d==uC?Cm:d;var u=c==Cm,f=d==Cm,h=c==d;if(h&&dC(e)){if(!dC(t))return!1;o=!0,u=!1}if(h&&!u)return i||(i=new v1),o||SJ(e)?jJ(e,t,r,a,s,i):kJ(e,t,c,r,a,s,i);if(!(r&BJ)){var A=u&&hC.call(e,"__wrapped__"),x=f&&hC.call(t,"__wrapped__");if(A||x){var p=A?e.value():e,b=x?t.value():t;return i||(i=new v1),s(p,b,r,a,i)}}return h?(i||(i=new v1),CJ(e,t,r,a,s,i)):!1}var TJ=FJ,IJ=TJ,fC=ay;function $F(e,t,r,a,s){return e===t?!0:e==null||t==null||!fC(e)&&!fC(t)?e!==e&&t!==t:IJ(e,t,r,a,$F,s)}var DJ=$F,LJ=DJ;function PJ(e,t){return LJ(e,t)}var OJ=PJ,KF={exports:{}};/*!
 * Quill Editor v1.3.7
 * https://quilljs.com/
 * Copyright (c) 2014, Jason Chen
 * Copyright (c) 2013, salesforce.com
 */(function(e,t){(function(a,s){e.exports=s()})(typeof self<"u"?self:hi,function(){return function(r){var a={};function s(i){if(a[i])return a[i].exports;var o=a[i]={i,l:!1,exports:{}};return r[i].call(o.exports,o,o.exports,s),o.l=!0,o.exports}return s.m=r,s.c=a,s.d=function(i,o,l){s.o(i,o)||Object.defineProperty(i,o,{configurable:!1,enumerable:!0,get:l})},s.n=function(i){var o=i&&i.__esModule?function(){return i.default}:function(){return i};return s.d(o,"a",o),o},s.o=function(i,o){return Object.prototype.hasOwnProperty.call(i,o)},s.p="",s(s.s=109)}([function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0});var i=s(17),o=s(18),l=s(19),c=s(45),d=s(46),u=s(47),f=s(48),h=s(49),A=s(12),x=s(32),p=s(33),b=s(31),m=s(1),g={Scope:m.Scope,create:m.create,find:m.find,query:m.query,register:m.register,Container:i.default,Format:o.default,Leaf:l.default,Embed:f.default,Scroll:c.default,Block:u.default,Inline:d.default,Text:h.default,Attributor:{Attribute:A.default,Class:x.default,Style:p.default,Store:b.default}};a.default=g},function(r,a,s){var i=this&&this.__extends||function(){var b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,g){m.__proto__=g}||function(m,g){for(var y in g)g.hasOwnProperty(y)&&(m[y]=g[y])};return function(m,g){b(m,g);function y(){this.constructor=m}m.prototype=g===null?Object.create(g):(y.prototype=g.prototype,new y)}}();Object.defineProperty(a,"__esModule",{value:!0});var o=function(b){i(m,b);function m(g){var y=this;return g="[Parchment] "+g,y=b.call(this,g)||this,y.message=g,y.name=y.constructor.name,y}return m}(Error);a.ParchmentError=o;var l={},c={},d={},u={};a.DATA_KEY="__blot";var f;(function(b){b[b.TYPE=3]="TYPE",b[b.LEVEL=12]="LEVEL",b[b.ATTRIBUTE=13]="ATTRIBUTE",b[b.BLOT=14]="BLOT",b[b.INLINE=7]="INLINE",b[b.BLOCK=11]="BLOCK",b[b.BLOCK_BLOT=10]="BLOCK_BLOT",b[b.INLINE_BLOT=6]="INLINE_BLOT",b[b.BLOCK_ATTRIBUTE=9]="BLOCK_ATTRIBUTE",b[b.INLINE_ATTRIBUTE=5]="INLINE_ATTRIBUTE",b[b.ANY=15]="ANY"})(f=a.Scope||(a.Scope={}));function h(b,m){var g=x(b);if(g==null)throw new o("Unable to create "+b+" blot");var y=g,v=b instanceof Node||b.nodeType===Node.TEXT_NODE?b:y.create(m);return new y(v,m)}a.create=h;function A(b,m){return m===void 0&&(m=!1),b==null?null:b[a.DATA_KEY]!=null?b[a.DATA_KEY].blot:m?A(b.parentNode,m):null}a.find=A;function x(b,m){m===void 0&&(m=f.ANY);var g;if(typeof b=="string")g=u[b]||l[b];else if(b instanceof Text||b.nodeType===Node.TEXT_NODE)g=u.text;else if(typeof b=="number")b&f.LEVEL&f.BLOCK?g=u.block:b&f.LEVEL&f.INLINE&&(g=u.inline);else if(b instanceof HTMLElement){var y=(b.getAttribute("class")||"").split(/\s+/);for(var v in y)if(g=c[y[v]],g)break;g=g||d[b.tagName]}return g==null?null:m&f.LEVEL&g.scope&&m&f.TYPE&g.scope?g:null}a.query=x;function p(){for(var b=[],m=0;m<arguments.length;m++)b[m]=arguments[m];if(b.length>1)return b.map(function(v){return p(v)});var g=b[0];if(typeof g.blotName!="string"&&typeof g.attrName!="string")throw new o("Invalid definition");if(g.blotName==="abstract")throw new o("Cannot register abstract class");if(u[g.blotName||g.attrName]=g,typeof g.keyName=="string")l[g.keyName]=g;else if(g.className!=null&&(c[g.className]=g),g.tagName!=null){Array.isArray(g.tagName)?g.tagName=g.tagName.map(function(v){return v.toUpperCase()}):g.tagName=g.tagName.toUpperCase();var y=Array.isArray(g.tagName)?g.tagName:[g.tagName];y.forEach(function(v){(d[v]==null||g.className==null)&&(d[v]=g)})}return g}a.register=p},function(r,a,s){var i=s(51),o=s(11),l=s(3),c=s(20),d="\0",u=function(f){Array.isArray(f)?this.ops=f:f!=null&&Array.isArray(f.ops)?this.ops=f.ops:this.ops=[]};u.prototype.insert=function(f,h){var A={};return f.length===0?this:(A.insert=f,h!=null&&typeof h=="object"&&Object.keys(h).length>0&&(A.attributes=h),this.push(A))},u.prototype.delete=function(f){return f<=0?this:this.push({delete:f})},u.prototype.retain=function(f,h){if(f<=0)return this;var A={retain:f};return h!=null&&typeof h=="object"&&Object.keys(h).length>0&&(A.attributes=h),this.push(A)},u.prototype.push=function(f){var h=this.ops.length,A=this.ops[h-1];if(f=l(!0,{},f),typeof A=="object"){if(typeof f.delete=="number"&&typeof A.delete=="number")return this.ops[h-1]={delete:A.delete+f.delete},this;if(typeof A.delete=="number"&&f.insert!=null&&(h-=1,A=this.ops[h-1],typeof A!="object"))return this.ops.unshift(f),this;if(o(f.attributes,A.attributes)){if(typeof f.insert=="string"&&typeof A.insert=="string")return this.ops[h-1]={insert:A.insert+f.insert},typeof f.attributes=="object"&&(this.ops[h-1].attributes=f.attributes),this;if(typeof f.retain=="number"&&typeof A.retain=="number")return this.ops[h-1]={retain:A.retain+f.retain},typeof f.attributes=="object"&&(this.ops[h-1].attributes=f.attributes),this}}return h===this.ops.length?this.ops.push(f):this.ops.splice(h,0,f),this},u.prototype.chop=function(){var f=this.ops[this.ops.length-1];return f&&f.retain&&!f.attributes&&this.ops.pop(),this},u.prototype.filter=function(f){return this.ops.filter(f)},u.prototype.forEach=function(f){this.ops.forEach(f)},u.prototype.map=function(f){return this.ops.map(f)},u.prototype.partition=function(f){var h=[],A=[];return this.forEach(function(x){var p=f(x)?h:A;p.push(x)}),[h,A]},u.prototype.reduce=function(f,h){return this.ops.reduce(f,h)},u.prototype.changeLength=function(){return this.reduce(function(f,h){return h.insert?f+c.length(h):h.delete?f-h.delete:f},0)},u.prototype.length=function(){return this.reduce(function(f,h){return f+c.length(h)},0)},u.prototype.slice=function(f,h){f=f||0,typeof h!="number"&&(h=1/0);for(var A=[],x=c.iterator(this.ops),p=0;p<h&&x.hasNext();){var b;p<f?b=x.next(f-p):(b=x.next(h-p),A.push(b)),p+=c.length(b)}return new u(A)},u.prototype.compose=function(f){var h=c.iterator(this.ops),A=c.iterator(f.ops),x=[],p=A.peek();if(p!=null&&typeof p.retain=="number"&&p.attributes==null){for(var b=p.retain;h.peekType()==="insert"&&h.peekLength()<=b;)b-=h.peekLength(),x.push(h.next());p.retain-b>0&&A.next(p.retain-b)}for(var m=new u(x);h.hasNext()||A.hasNext();)if(A.peekType()==="insert")m.push(A.next());else if(h.peekType()==="delete")m.push(h.next());else{var g=Math.min(h.peekLength(),A.peekLength()),y=h.next(g),v=A.next(g);if(typeof v.retain=="number"){var _={};typeof y.retain=="number"?_.retain=g:_.insert=y.insert;var j=c.attributes.compose(y.attributes,v.attributes,typeof y.retain=="number");if(j&&(_.attributes=j),m.push(_),!A.hasNext()&&o(m.ops[m.ops.length-1],_)){var N=new u(h.rest());return m.concat(N).chop()}}else typeof v.delete=="number"&&typeof y.retain=="number"&&m.push(v)}return m.chop()},u.prototype.concat=function(f){var h=new u(this.ops.slice());return f.ops.length>0&&(h.push(f.ops[0]),h.ops=h.ops.concat(f.ops.slice(1))),h},u.prototype.diff=function(f,h){if(this.ops===f.ops)return new u;var A=[this,f].map(function(g){return g.map(function(y){if(y.insert!=null)return typeof y.insert=="string"?y.insert:d;var v=g===f?"on":"with";throw new Error("diff() called "+v+" non-document")}).join("")}),x=new u,p=i(A[0],A[1],h),b=c.iterator(this.ops),m=c.iterator(f.ops);return p.forEach(function(g){for(var y=g[1].length;y>0;){var v=0;switch(g[0]){case i.INSERT:v=Math.min(m.peekLength(),y),x.push(m.next(v));break;case i.DELETE:v=Math.min(y,b.peekLength()),b.next(v),x.delete(v);break;case i.EQUAL:v=Math.min(b.peekLength(),m.peekLength(),y);var _=b.next(v),j=m.next(v);o(_.insert,j.insert)?x.retain(v,c.attributes.diff(_.attributes,j.attributes)):x.push(j).delete(v);break}y-=v}}),x.chop()},u.prototype.eachLine=function(f,h){h=h||`
`;for(var A=c.iterator(this.ops),x=new u,p=0;A.hasNext();){if(A.peekType()!=="insert")return;var b=A.peek(),m=c.length(b)-A.peekLength(),g=typeof b.insert=="string"?b.insert.indexOf(h,m)-m:-1;if(g<0)x.push(A.next());else if(g>0)x.push(A.next(g));else{if(f(x,A.next(1).attributes||{},p)===!1)return;p+=1,x=new u}}x.length()>0&&f(x,{},p)},u.prototype.transform=function(f,h){if(h=!!h,typeof f=="number")return this.transformPosition(f,h);for(var A=c.iterator(this.ops),x=c.iterator(f.ops),p=new u;A.hasNext()||x.hasNext();)if(A.peekType()==="insert"&&(h||x.peekType()!=="insert"))p.retain(c.length(A.next()));else if(x.peekType()==="insert")p.push(x.next());else{var b=Math.min(A.peekLength(),x.peekLength()),m=A.next(b),g=x.next(b);if(m.delete)continue;g.delete?p.push(g):p.retain(b,c.attributes.transform(m.attributes,g.attributes,h))}return p.chop()},u.prototype.transformPosition=function(f,h){h=!!h;for(var A=c.iterator(this.ops),x=0;A.hasNext()&&x<=f;){var p=A.peekLength(),b=A.peekType();if(A.next(),b==="delete"){f-=Math.min(p,f-x);continue}else b==="insert"&&(x<f||!h)&&(f+=p);x+=p}return f},r.exports=u},function(r,a){var s=Object.prototype.hasOwnProperty,i=Object.prototype.toString,o=Object.defineProperty,l=Object.getOwnPropertyDescriptor,c=function(A){return typeof Array.isArray=="function"?Array.isArray(A):i.call(A)==="[object Array]"},d=function(A){if(!A||i.call(A)!=="[object Object]")return!1;var x=s.call(A,"constructor"),p=A.constructor&&A.constructor.prototype&&s.call(A.constructor.prototype,"isPrototypeOf");if(A.constructor&&!x&&!p)return!1;var b;for(b in A);return typeof b>"u"||s.call(A,b)},u=function(A,x){o&&x.name==="__proto__"?o(A,x.name,{enumerable:!0,configurable:!0,value:x.newValue,writable:!0}):A[x.name]=x.newValue},f=function(A,x){if(x==="__proto__")if(s.call(A,x)){if(l)return l(A,x).value}else return;return A[x]};r.exports=function h(){var A,x,p,b,m,g,y=arguments[0],v=1,_=arguments.length,j=!1;for(typeof y=="boolean"&&(j=y,y=arguments[1]||{},v=2),(y==null||typeof y!="object"&&typeof y!="function")&&(y={});v<_;++v)if(A=arguments[v],A!=null)for(x in A)p=f(y,x),b=f(A,x),y!==b&&(j&&b&&(d(b)||(m=c(b)))?(m?(m=!1,g=p&&c(p)?p:[]):g=p&&d(p)?p:{},u(y,{name:x,newValue:h(j,g,b)})):typeof b<"u"&&u(y,{name:x,newValue:b}));return y}},function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0}),a.default=a.BlockEmbed=a.bubbleFormats=void 0;var i=function(){function k(w,T){for(var R=0;R<T.length;R++){var q=T[R];q.enumerable=q.enumerable||!1,q.configurable=!0,"value"in q&&(q.writable=!0),Object.defineProperty(w,q.key,q)}}return function(w,T,R){return T&&k(w.prototype,T),R&&k(w,R),w}}(),o=function k(w,T,R){w===null&&(w=Function.prototype);var q=Object.getOwnPropertyDescriptor(w,T);if(q===void 0){var z=Object.getPrototypeOf(w);return z===null?void 0:k(z,T,R)}else{if("value"in q)return q.value;var ee=q.get;return ee===void 0?void 0:ee.call(R)}},l=s(3),c=y(l),d=s(2),u=y(d),f=s(0),h=y(f),A=s(16),x=y(A),p=s(6),b=y(p),m=s(7),g=y(m);function y(k){return k&&k.__esModule?k:{default:k}}function v(k,w){if(!(k instanceof w))throw new TypeError("Cannot call a class as a function")}function _(k,w){if(!k)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w&&(typeof w=="object"||typeof w=="function")?w:k}function j(k,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof w);k.prototype=Object.create(w&&w.prototype,{constructor:{value:k,enumerable:!1,writable:!0,configurable:!0}}),w&&(Object.setPrototypeOf?Object.setPrototypeOf(k,w):k.__proto__=w)}var N=1,B=function(k){j(w,k);function w(){return v(this,w),_(this,(w.__proto__||Object.getPrototypeOf(w)).apply(this,arguments))}return i(w,[{key:"attach",value:function(){o(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"attach",this).call(this),this.attributes=new h.default.Attributor.Store(this.domNode)}},{key:"delta",value:function(){return new u.default().insert(this.value(),(0,c.default)(this.formats(),this.attributes.values()))}},{key:"format",value:function(R,q){var z=h.default.query(R,h.default.Scope.BLOCK_ATTRIBUTE);z!=null&&this.attributes.attribute(z,q)}},{key:"formatAt",value:function(R,q,z,ee){this.format(z,ee)}},{key:"insertAt",value:function(R,q,z){if(typeof q=="string"&&q.endsWith(`
`)){var ee=h.default.create(E.blotName);this.parent.insertBefore(ee,R===0?this:this.next),ee.insertAt(0,q.slice(0,-1))}else o(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"insertAt",this).call(this,R,q,z)}}]),w}(h.default.Embed);B.scope=h.default.Scope.BLOCK_BLOT;var E=function(k){j(w,k);function w(T){v(this,w);var R=_(this,(w.__proto__||Object.getPrototypeOf(w)).call(this,T));return R.cache={},R}return i(w,[{key:"delta",value:function(){return this.cache.delta==null&&(this.cache.delta=this.descendants(h.default.Leaf).reduce(function(R,q){return q.length()===0?R:R.insert(q.value(),C(q))},new u.default).insert(`
`,C(this))),this.cache.delta}},{key:"deleteAt",value:function(R,q){o(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"deleteAt",this).call(this,R,q),this.cache={}}},{key:"formatAt",value:function(R,q,z,ee){q<=0||(h.default.query(z,h.default.Scope.BLOCK)?R+q===this.length()&&this.format(z,ee):o(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"formatAt",this).call(this,R,Math.min(q,this.length()-R-1),z,ee),this.cache={})}},{key:"insertAt",value:function(R,q,z){if(z!=null)return o(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"insertAt",this).call(this,R,q,z);if(q.length!==0){var ee=q.split(`
`),Y=ee.shift();Y.length>0&&(R<this.length()-1||this.children.tail==null?o(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"insertAt",this).call(this,Math.min(R,this.length()-1),Y):this.children.tail.insertAt(this.children.tail.length(),Y),this.cache={});var G=this;ee.reduce(function(re,U){return G=G.split(re,!0),G.insertAt(0,U),U.length},R+Y.length)}}},{key:"insertBefore",value:function(R,q){var z=this.children.head;o(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"insertBefore",this).call(this,R,q),z instanceof x.default&&z.remove(),this.cache={}}},{key:"length",value:function(){return this.cache.length==null&&(this.cache.length=o(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"length",this).call(this)+N),this.cache.length}},{key:"moveChildren",value:function(R,q){o(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"moveChildren",this).call(this,R,q),this.cache={}}},{key:"optimize",value:function(R){o(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"optimize",this).call(this,R),this.cache={}}},{key:"path",value:function(R){return o(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"path",this).call(this,R,!0)}},{key:"removeChild",value:function(R){o(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"removeChild",this).call(this,R),this.cache={}}},{key:"split",value:function(R){var q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(q&&(R===0||R>=this.length()-N)){var z=this.clone();return R===0?(this.parent.insertBefore(z,this),this):(this.parent.insertBefore(z,this.next),z)}else{var ee=o(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"split",this).call(this,R,q);return this.cache={},ee}}}]),w}(h.default.Block);E.blotName="block",E.tagName="P",E.defaultChild="break",E.allowedChildren=[b.default,h.default.Embed,g.default];function C(k){var w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return k==null||(typeof k.formats=="function"&&(w=(0,c.default)(w,k.formats())),k.parent==null||k.parent.blotName=="scroll"||k.parent.statics.scope!==k.statics.scope)?w:C(k.parent,w)}a.bubbleFormats=C,a.BlockEmbed=B,a.default=E},function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0}),a.default=a.overload=a.expandConfig=void 0;var i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(G){return typeof G}:function(G){return G&&typeof Symbol=="function"&&G.constructor===Symbol&&G!==Symbol.prototype?"symbol":typeof G},o=function(){function G(re,U){var S=[],D=!0,L=!1,P=void 0;try{for(var I=re[Symbol.iterator](),H;!(D=(H=I.next()).done)&&(S.push(H.value),!(U&&S.length===U));D=!0);}catch(V){L=!0,P=V}finally{try{!D&&I.return&&I.return()}finally{if(L)throw P}}return S}return function(re,U){if(Array.isArray(re))return re;if(Symbol.iterator in Object(re))return G(re,U);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function G(re,U){for(var S=0;S<U.length;S++){var D=U[S];D.enumerable=D.enumerable||!1,D.configurable=!0,"value"in D&&(D.writable=!0),Object.defineProperty(re,D.key,D)}}return function(re,U,S){return U&&G(re.prototype,U),S&&G(re,S),re}}();s(50);var c=s(2),d=C(c),u=s(14),f=C(u),h=s(8),A=C(h),x=s(9),p=C(x),b=s(0),m=C(b),g=s(15),y=C(g),v=s(3),_=C(v),j=s(10),N=C(j),B=s(34),E=C(B);function C(G){return G&&G.__esModule?G:{default:G}}function k(G,re,U){return re in G?Object.defineProperty(G,re,{value:U,enumerable:!0,configurable:!0,writable:!0}):G[re]=U,G}function w(G,re){if(!(G instanceof re))throw new TypeError("Cannot call a class as a function")}var T=(0,N.default)("quill"),R=function(){l(G,null,[{key:"debug",value:function(U){U===!0&&(U="log"),N.default.level(U)}},{key:"find",value:function(U){return U.__quill||m.default.find(U)}},{key:"import",value:function(U){return this.imports[U]==null&&T.error("Cannot import "+U+". Are you sure it was registered?"),this.imports[U]}},{key:"register",value:function(U,S){var D=this,L=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(typeof U!="string"){var P=U.attrName||U.blotName;typeof P=="string"?this.register("formats/"+P,U,S):Object.keys(U).forEach(function(I){D.register(I,U[I],S)})}else this.imports[U]!=null&&!L&&T.warn("Overwriting "+U+" with",S),this.imports[U]=S,(U.startsWith("blots/")||U.startsWith("formats/"))&&S.blotName!=="abstract"?m.default.register(S):U.startsWith("modules")&&typeof S.register=="function"&&S.register()}}]);function G(re){var U=this,S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(w(this,G),this.options=q(re,S),this.container=this.options.container,this.container==null)return T.error("Invalid Quill container",re);this.options.debug&&G.debug(this.options.debug);var D=this.container.innerHTML.trim();this.container.classList.add("ql-container"),this.container.innerHTML="",this.container.__quill=this,this.root=this.addContainer("ql-editor"),this.root.classList.add("ql-blank"),this.root.setAttribute("data-gramm",!1),this.scrollingContainer=this.options.scrollingContainer||this.root,this.emitter=new A.default,this.scroll=m.default.create(this.root,{emitter:this.emitter,whitelist:this.options.formats}),this.editor=new f.default(this.scroll),this.selection=new y.default(this.scroll,this.emitter),this.theme=new this.options.theme(this,this.options),this.keyboard=this.theme.addModule("keyboard"),this.clipboard=this.theme.addModule("clipboard"),this.history=this.theme.addModule("history"),this.theme.init(),this.emitter.on(A.default.events.EDITOR_CHANGE,function(P){P===A.default.events.TEXT_CHANGE&&U.root.classList.toggle("ql-blank",U.editor.isBlank())}),this.emitter.on(A.default.events.SCROLL_UPDATE,function(P,I){var H=U.selection.lastRange,V=H&&H.length===0?H.index:void 0;z.call(U,function(){return U.editor.update(null,I,V)},P)});var L=this.clipboard.convert(`<div class='ql-editor' style="white-space: normal;">`+D+"<p><br></p></div>");this.setContents(L),this.history.clear(),this.options.placeholder&&this.root.setAttribute("data-placeholder",this.options.placeholder),this.options.readOnly&&this.disable()}return l(G,[{key:"addContainer",value:function(U){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(typeof U=="string"){var D=U;U=document.createElement("div"),U.classList.add(D)}return this.container.insertBefore(U,S),U}},{key:"blur",value:function(){this.selection.setRange(null)}},{key:"deleteText",value:function(U,S,D){var L=this,P=ee(U,S,D),I=o(P,4);return U=I[0],S=I[1],D=I[3],z.call(this,function(){return L.editor.deleteText(U,S)},D,U,-1*S)}},{key:"disable",value:function(){this.enable(!1)}},{key:"enable",value:function(){var U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.scroll.enable(U),this.container.classList.toggle("ql-disabled",!U)}},{key:"focus",value:function(){var U=this.scrollingContainer.scrollTop;this.selection.focus(),this.scrollingContainer.scrollTop=U,this.scrollIntoView()}},{key:"format",value:function(U,S){var D=this,L=arguments.length>2&&arguments[2]!==void 0?arguments[2]:A.default.sources.API;return z.call(this,function(){var P=D.getSelection(!0),I=new d.default;if(P==null)return I;if(m.default.query(U,m.default.Scope.BLOCK))I=D.editor.formatLine(P.index,P.length,k({},U,S));else{if(P.length===0)return D.selection.format(U,S),I;I=D.editor.formatText(P.index,P.length,k({},U,S))}return D.setSelection(P,A.default.sources.SILENT),I},L)}},{key:"formatLine",value:function(U,S,D,L,P){var I=this,H=void 0,V=ee(U,S,D,L,P),W=o(V,4);return U=W[0],S=W[1],H=W[2],P=W[3],z.call(this,function(){return I.editor.formatLine(U,S,H)},P,U,0)}},{key:"formatText",value:function(U,S,D,L,P){var I=this,H=void 0,V=ee(U,S,D,L,P),W=o(V,4);return U=W[0],S=W[1],H=W[2],P=W[3],z.call(this,function(){return I.editor.formatText(U,S,H)},P,U,0)}},{key:"getBounds",value:function(U){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,D=void 0;typeof U=="number"?D=this.selection.getBounds(U,S):D=this.selection.getBounds(U.index,U.length);var L=this.container.getBoundingClientRect();return{bottom:D.bottom-L.top,height:D.height,left:D.left-L.left,right:D.right-L.left,top:D.top-L.top,width:D.width}}},{key:"getContents",value:function(){var U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-U,D=ee(U,S),L=o(D,2);return U=L[0],S=L[1],this.editor.getContents(U,S)}},{key:"getFormat",value:function(){var U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getSelection(!0),S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return typeof U=="number"?this.editor.getFormat(U,S):this.editor.getFormat(U.index,U.length)}},{key:"getIndex",value:function(U){return U.offset(this.scroll)}},{key:"getLength",value:function(){return this.scroll.length()}},{key:"getLeaf",value:function(U){return this.scroll.leaf(U)}},{key:"getLine",value:function(U){return this.scroll.line(U)}},{key:"getLines",value:function(){var U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE;return typeof U!="number"?this.scroll.lines(U.index,U.length):this.scroll.lines(U,S)}},{key:"getModule",value:function(U){return this.theme.modules[U]}},{key:"getSelection",value:function(){var U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return U&&this.focus(),this.update(),this.selection.getRange()[0]}},{key:"getText",value:function(){var U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-U,D=ee(U,S),L=o(D,2);return U=L[0],S=L[1],this.editor.getText(U,S)}},{key:"hasFocus",value:function(){return this.selection.hasFocus()}},{key:"insertEmbed",value:function(U,S,D){var L=this,P=arguments.length>3&&arguments[3]!==void 0?arguments[3]:G.sources.API;return z.call(this,function(){return L.editor.insertEmbed(U,S,D)},P,U)}},{key:"insertText",value:function(U,S,D,L,P){var I=this,H=void 0,V=ee(U,0,D,L,P),W=o(V,4);return U=W[0],H=W[2],P=W[3],z.call(this,function(){return I.editor.insertText(U,S,H)},P,U,S.length)}},{key:"isEnabled",value:function(){return!this.container.classList.contains("ql-disabled")}},{key:"off",value:function(){return this.emitter.off.apply(this.emitter,arguments)}},{key:"on",value:function(){return this.emitter.on.apply(this.emitter,arguments)}},{key:"once",value:function(){return this.emitter.once.apply(this.emitter,arguments)}},{key:"pasteHTML",value:function(U,S,D){this.clipboard.dangerouslyPasteHTML(U,S,D)}},{key:"removeFormat",value:function(U,S,D){var L=this,P=ee(U,S,D),I=o(P,4);return U=I[0],S=I[1],D=I[3],z.call(this,function(){return L.editor.removeFormat(U,S)},D,U)}},{key:"scrollIntoView",value:function(){this.selection.scrollIntoView(this.scrollingContainer)}},{key:"setContents",value:function(U){var S=this,D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:A.default.sources.API;return z.call(this,function(){U=new d.default(U);var L=S.getLength(),P=S.editor.deleteText(0,L),I=S.editor.applyDelta(U),H=I.ops[I.ops.length-1];H!=null&&typeof H.insert=="string"&&H.insert[H.insert.length-1]===`
`&&(S.editor.deleteText(S.getLength()-1,1),I.delete(1));var V=P.compose(I);return V},D)}},{key:"setSelection",value:function(U,S,D){if(U==null)this.selection.setRange(null,S||G.sources.API);else{var L=ee(U,S,D),P=o(L,4);U=P[0],S=P[1],D=P[3],this.selection.setRange(new g.Range(U,S),D),D!==A.default.sources.SILENT&&this.selection.scrollIntoView(this.scrollingContainer)}}},{key:"setText",value:function(U){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:A.default.sources.API,D=new d.default().insert(U);return this.setContents(D,S)}},{key:"update",value:function(){var U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:A.default.sources.USER,S=this.scroll.update(U);return this.selection.update(U),S}},{key:"updateContents",value:function(U){var S=this,D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:A.default.sources.API;return z.call(this,function(){return U=new d.default(U),S.editor.applyDelta(U,D)},D,!0)}}]),G}();R.DEFAULTS={bounds:null,formats:null,modules:{},placeholder:"",readOnly:!1,scrollingContainer:null,strict:!0,theme:"default"},R.events=A.default.events,R.sources=A.default.sources,R.version="1.3.7",R.imports={delta:d.default,parchment:m.default,"core/module":p.default,"core/theme":E.default};function q(G,re){if(re=(0,_.default)(!0,{container:G,modules:{clipboard:!0,keyboard:!0,history:!0}},re),!re.theme||re.theme===R.DEFAULTS.theme)re.theme=E.default;else if(re.theme=R.import("themes/"+re.theme),re.theme==null)throw new Error("Invalid theme "+re.theme+". Did you register it?");var U=(0,_.default)(!0,{},re.theme.DEFAULTS);[U,re].forEach(function(L){L.modules=L.modules||{},Object.keys(L.modules).forEach(function(P){L.modules[P]===!0&&(L.modules[P]={})})});var S=Object.keys(U.modules).concat(Object.keys(re.modules)),D=S.reduce(function(L,P){var I=R.import("modules/"+P);return I==null?T.error("Cannot load "+P+" module. Are you sure you registered it?"):L[P]=I.DEFAULTS||{},L},{});return re.modules!=null&&re.modules.toolbar&&re.modules.toolbar.constructor!==Object&&(re.modules.toolbar={container:re.modules.toolbar}),re=(0,_.default)(!0,{},R.DEFAULTS,{modules:D},U,re),["bounds","container","scrollingContainer"].forEach(function(L){typeof re[L]=="string"&&(re[L]=document.querySelector(re[L]))}),re.modules=Object.keys(re.modules).reduce(function(L,P){return re.modules[P]&&(L[P]=re.modules[P]),L},{}),re}function z(G,re,U,S){if(this.options.strict&&!this.isEnabled()&&re===A.default.sources.USER)return new d.default;var D=U==null?null:this.getSelection(),L=this.editor.delta,P=G();if(D!=null&&(U===!0&&(U=D.index),S==null?D=Y(D,P,re):S!==0&&(D=Y(D,U,S,re)),this.setSelection(D,A.default.sources.SILENT)),P.length()>0){var I,H=[A.default.events.TEXT_CHANGE,P,L,re];if((I=this.emitter).emit.apply(I,[A.default.events.EDITOR_CHANGE].concat(H)),re!==A.default.sources.SILENT){var V;(V=this.emitter).emit.apply(V,H)}}return P}function ee(G,re,U,S,D){var L={};return typeof G.index=="number"&&typeof G.length=="number"?typeof re!="number"?(D=S,S=U,U=re,re=G.length,G=G.index):(re=G.length,G=G.index):typeof re!="number"&&(D=S,S=U,U=re,re=0),(typeof U>"u"?"undefined":i(U))==="object"?(L=U,D=S):typeof U=="string"&&(S!=null?L[U]=S:D=U),D=D||A.default.sources.API,[G,re,L,D]}function Y(G,re,U,S){if(G==null)return null;var D=void 0,L=void 0;if(re instanceof d.default){var P=[G.index,G.index+G.length].map(function(W){return re.transformPosition(W,S!==A.default.sources.USER)}),I=o(P,2);D=I[0],L=I[1]}else{var H=[G.index,G.index+G.length].map(function(W){return W<re||W===re&&S===A.default.sources.USER?W:U>=0?W+U:Math.max(re,W+U)}),V=o(H,2);D=V[0],L=V[1]}return new g.Range(D,L-D)}a.expandConfig=q,a.overload=ee,a.default=R},function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0});var i=function(){function b(m,g){for(var y=0;y<g.length;y++){var v=g[y];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(m,v.key,v)}}return function(m,g,y){return g&&b(m.prototype,g),y&&b(m,y),m}}(),o=function b(m,g,y){m===null&&(m=Function.prototype);var v=Object.getOwnPropertyDescriptor(m,g);if(v===void 0){var _=Object.getPrototypeOf(m);return _===null?void 0:b(_,g,y)}else{if("value"in v)return v.value;var j=v.get;return j===void 0?void 0:j.call(y)}},l=s(7),c=f(l),d=s(0),u=f(d);function f(b){return b&&b.__esModule?b:{default:b}}function h(b,m){if(!(b instanceof m))throw new TypeError("Cannot call a class as a function")}function A(b,m){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m&&(typeof m=="object"||typeof m=="function")?m:b}function x(b,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof m);b.prototype=Object.create(m&&m.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),m&&(Object.setPrototypeOf?Object.setPrototypeOf(b,m):b.__proto__=m)}var p=function(b){x(m,b);function m(){return h(this,m),A(this,(m.__proto__||Object.getPrototypeOf(m)).apply(this,arguments))}return i(m,[{key:"formatAt",value:function(y,v,_,j){if(m.compare(this.statics.blotName,_)<0&&u.default.query(_,u.default.Scope.BLOT)){var N=this.isolate(y,v);j&&N.wrap(_,j)}else o(m.prototype.__proto__||Object.getPrototypeOf(m.prototype),"formatAt",this).call(this,y,v,_,j)}},{key:"optimize",value:function(y){if(o(m.prototype.__proto__||Object.getPrototypeOf(m.prototype),"optimize",this).call(this,y),this.parent instanceof m&&m.compare(this.statics.blotName,this.parent.statics.blotName)>0){var v=this.parent.isolate(this.offset(),this.length());this.moveChildren(v),v.wrap(this)}}}],[{key:"compare",value:function(y,v){var _=m.order.indexOf(y),j=m.order.indexOf(v);return _>=0||j>=0?_-j:y===v?0:y<v?-1:1}}]),m}(u.default.Inline);p.allowedChildren=[p,u.default.Embed,c.default],p.order=["cursor","inline","underline","strike","italic","bold","script","link","code"],a.default=p},function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0});var i=s(0),o=l(i);function l(h){return h&&h.__esModule?h:{default:h}}function c(h,A){if(!(h instanceof A))throw new TypeError("Cannot call a class as a function")}function d(h,A){if(!h)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return A&&(typeof A=="object"||typeof A=="function")?A:h}function u(h,A){if(typeof A!="function"&&A!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof A);h.prototype=Object.create(A&&A.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),A&&(Object.setPrototypeOf?Object.setPrototypeOf(h,A):h.__proto__=A)}var f=function(h){u(A,h);function A(){return c(this,A),d(this,(A.__proto__||Object.getPrototypeOf(A)).apply(this,arguments))}return A}(o.default.Text);a.default=f},function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0});var i=function(){function g(y,v){for(var _=0;_<v.length;_++){var j=v[_];j.enumerable=j.enumerable||!1,j.configurable=!0,"value"in j&&(j.writable=!0),Object.defineProperty(y,j.key,j)}}return function(y,v,_){return v&&g(y.prototype,v),_&&g(y,_),y}}(),o=function g(y,v,_){y===null&&(y=Function.prototype);var j=Object.getOwnPropertyDescriptor(y,v);if(j===void 0){var N=Object.getPrototypeOf(y);return N===null?void 0:g(N,v,_)}else{if("value"in j)return j.value;var B=j.get;return B===void 0?void 0:B.call(_)}},l=s(54),c=f(l),d=s(10),u=f(d);function f(g){return g&&g.__esModule?g:{default:g}}function h(g,y){if(!(g instanceof y))throw new TypeError("Cannot call a class as a function")}function A(g,y){if(!g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y&&(typeof y=="object"||typeof y=="function")?y:g}function x(g,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof y);g.prototype=Object.create(y&&y.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),y&&(Object.setPrototypeOf?Object.setPrototypeOf(g,y):g.__proto__=y)}var p=(0,u.default)("quill:events"),b=["selectionchange","mousedown","mouseup","click"];b.forEach(function(g){document.addEventListener(g,function(){for(var y=arguments.length,v=Array(y),_=0;_<y;_++)v[_]=arguments[_];[].slice.call(document.querySelectorAll(".ql-container")).forEach(function(j){if(j.__quill&&j.__quill.emitter){var N;(N=j.__quill.emitter).handleDOM.apply(N,v)}})})});var m=function(g){x(y,g);function y(){h(this,y);var v=A(this,(y.__proto__||Object.getPrototypeOf(y)).call(this));return v.listeners={},v.on("error",p.error),v}return i(y,[{key:"emit",value:function(){p.log.apply(p,arguments),o(y.prototype.__proto__||Object.getPrototypeOf(y.prototype),"emit",this).apply(this,arguments)}},{key:"handleDOM",value:function(_){for(var j=arguments.length,N=Array(j>1?j-1:0),B=1;B<j;B++)N[B-1]=arguments[B];(this.listeners[_.type]||[]).forEach(function(E){var C=E.node,k=E.handler;(_.target===C||C.contains(_.target))&&k.apply(void 0,[_].concat(N))})}},{key:"listenDOM",value:function(_,j,N){this.listeners[_]||(this.listeners[_]=[]),this.listeners[_].push({node:j,handler:N})}}]),y}(c.default);m.events={EDITOR_CHANGE:"editor-change",SCROLL_BEFORE_UPDATE:"scroll-before-update",SCROLL_OPTIMIZE:"scroll-optimize",SCROLL_UPDATE:"scroll-update",SELECTION_CHANGE:"selection-change",TEXT_CHANGE:"text-change"},m.sources={API:"api",SILENT:"silent",USER:"user"},a.default=m},function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0});function i(l,c){if(!(l instanceof c))throw new TypeError("Cannot call a class as a function")}var o=function l(c){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};i(this,l),this.quill=c,this.options=d};o.DEFAULTS={},a.default=o},function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0});var i=["error","warn","log","info"],o="warn";function l(d){if(i.indexOf(d)<=i.indexOf(o)){for(var u,f=arguments.length,h=Array(f>1?f-1:0),A=1;A<f;A++)h[A-1]=arguments[A];(u=console)[d].apply(u,h)}}function c(d){return i.reduce(function(u,f){return u[f]=l.bind(console,f,d),u},{})}l.level=c.level=function(d){o=d},a.default=c},function(r,a,s){var i=Array.prototype.slice,o=s(52),l=s(53),c=r.exports=function(h,A,x){return x||(x={}),h===A?!0:h instanceof Date&&A instanceof Date?h.getTime()===A.getTime():!h||!A||typeof h!="object"&&typeof A!="object"?x.strict?h===A:h==A:f(h,A,x)};function d(h){return h==null}function u(h){return!(!h||typeof h!="object"||typeof h.length!="number"||typeof h.copy!="function"||typeof h.slice!="function"||h.length>0&&typeof h[0]!="number")}function f(h,A,x){var p,b;if(d(h)||d(A)||h.prototype!==A.prototype)return!1;if(l(h))return l(A)?(h=i.call(h),A=i.call(A),c(h,A,x)):!1;if(u(h)){if(!u(A)||h.length!==A.length)return!1;for(p=0;p<h.length;p++)if(h[p]!==A[p])return!1;return!0}try{var m=o(h),g=o(A)}catch{return!1}if(m.length!=g.length)return!1;for(m.sort(),g.sort(),p=m.length-1;p>=0;p--)if(m[p]!=g[p])return!1;for(p=m.length-1;p>=0;p--)if(b=m[p],!c(h[b],A[b],x))return!1;return typeof h==typeof A}},function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0});var i=s(1),o=function(){function l(c,d,u){u===void 0&&(u={}),this.attrName=c,this.keyName=d;var f=i.Scope.TYPE&i.Scope.ATTRIBUTE;u.scope!=null?this.scope=u.scope&i.Scope.LEVEL|f:this.scope=i.Scope.ATTRIBUTE,u.whitelist!=null&&(this.whitelist=u.whitelist)}return l.keys=function(c){return[].map.call(c.attributes,function(d){return d.name})},l.prototype.add=function(c,d){return this.canAdd(c,d)?(c.setAttribute(this.keyName,d),!0):!1},l.prototype.canAdd=function(c,d){var u=i.query(c,i.Scope.BLOT&(this.scope|i.Scope.TYPE));return u==null?!1:this.whitelist==null?!0:typeof d=="string"?this.whitelist.indexOf(d.replace(/["']/g,""))>-1:this.whitelist.indexOf(d)>-1},l.prototype.remove=function(c){c.removeAttribute(this.keyName)},l.prototype.value=function(c){var d=c.getAttribute(this.keyName);return this.canAdd(c,d)&&d?d:""},l}();a.default=o},function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0}),a.default=a.Code=void 0;var i=function(){function B(E,C){var k=[],w=!0,T=!1,R=void 0;try{for(var q=E[Symbol.iterator](),z;!(w=(z=q.next()).done)&&(k.push(z.value),!(C&&k.length===C));w=!0);}catch(ee){T=!0,R=ee}finally{try{!w&&q.return&&q.return()}finally{if(T)throw R}}return k}return function(E,C){if(Array.isArray(E))return E;if(Symbol.iterator in Object(E))return B(E,C);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function B(E,C){for(var k=0;k<C.length;k++){var w=C[k];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(E,w.key,w)}}return function(E,C,k){return C&&B(E.prototype,C),k&&B(E,k),E}}(),l=function B(E,C,k){E===null&&(E=Function.prototype);var w=Object.getOwnPropertyDescriptor(E,C);if(w===void 0){var T=Object.getPrototypeOf(E);return T===null?void 0:B(T,C,k)}else{if("value"in w)return w.value;var R=w.get;return R===void 0?void 0:R.call(k)}},c=s(2),d=g(c),u=s(0),f=g(u),h=s(4),A=g(h),x=s(6),p=g(x),b=s(7),m=g(b);function g(B){return B&&B.__esModule?B:{default:B}}function y(B,E){if(!(B instanceof E))throw new TypeError("Cannot call a class as a function")}function v(B,E){if(!B)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return E&&(typeof E=="object"||typeof E=="function")?E:B}function _(B,E){if(typeof E!="function"&&E!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof E);B.prototype=Object.create(E&&E.prototype,{constructor:{value:B,enumerable:!1,writable:!0,configurable:!0}}),E&&(Object.setPrototypeOf?Object.setPrototypeOf(B,E):B.__proto__=E)}var j=function(B){_(E,B);function E(){return y(this,E),v(this,(E.__proto__||Object.getPrototypeOf(E)).apply(this,arguments))}return E}(p.default);j.blotName="code",j.tagName="CODE";var N=function(B){_(E,B);function E(){return y(this,E),v(this,(E.__proto__||Object.getPrototypeOf(E)).apply(this,arguments))}return o(E,[{key:"delta",value:function(){var k=this,w=this.domNode.textContent;return w.endsWith(`
`)&&(w=w.slice(0,-1)),w.split(`
`).reduce(function(T,R){return T.insert(R).insert(`
`,k.formats())},new d.default)}},{key:"format",value:function(k,w){if(!(k===this.statics.blotName&&w)){var T=this.descendant(m.default,this.length()-1),R=i(T,1),q=R[0];q!=null&&q.deleteAt(q.length()-1,1),l(E.prototype.__proto__||Object.getPrototypeOf(E.prototype),"format",this).call(this,k,w)}}},{key:"formatAt",value:function(k,w,T,R){if(w!==0&&!(f.default.query(T,f.default.Scope.BLOCK)==null||T===this.statics.blotName&&R===this.statics.formats(this.domNode))){var q=this.newlineIndex(k);if(!(q<0||q>=k+w)){var z=this.newlineIndex(k,!0)+1,ee=q-z+1,Y=this.isolate(z,ee),G=Y.next;Y.format(T,R),G instanceof E&&G.formatAt(0,k-z+w-ee,T,R)}}}},{key:"insertAt",value:function(k,w,T){if(T==null){var R=this.descendant(m.default,k),q=i(R,2),z=q[0],ee=q[1];z.insertAt(ee,w)}}},{key:"length",value:function(){var k=this.domNode.textContent.length;return this.domNode.textContent.endsWith(`
`)?k:k+1}},{key:"newlineIndex",value:function(k){var w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(w)return this.domNode.textContent.slice(0,k).lastIndexOf(`
`);var T=this.domNode.textContent.slice(k).indexOf(`
`);return T>-1?k+T:-1}},{key:"optimize",value:function(k){this.domNode.textContent.endsWith(`
`)||this.appendChild(f.default.create("text",`
`)),l(E.prototype.__proto__||Object.getPrototypeOf(E.prototype),"optimize",this).call(this,k);var w=this.next;w!=null&&w.prev===this&&w.statics.blotName===this.statics.blotName&&this.statics.formats(this.domNode)===w.statics.formats(w.domNode)&&(w.optimize(k),w.moveChildren(this),w.remove())}},{key:"replace",value:function(k){l(E.prototype.__proto__||Object.getPrototypeOf(E.prototype),"replace",this).call(this,k),[].slice.call(this.domNode.querySelectorAll("*")).forEach(function(w){var T=f.default.find(w);T==null?w.parentNode.removeChild(w):T instanceof f.default.Embed?T.remove():T.unwrap()})}}],[{key:"create",value:function(k){var w=l(E.__proto__||Object.getPrototypeOf(E),"create",this).call(this,k);return w.setAttribute("spellcheck",!1),w}},{key:"formats",value:function(){return!0}}]),E}(A.default);N.blotName="code-block",N.tagName="PRE",N.TAB="  ",a.Code=j,a.default=N},function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0});var i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(G){return typeof G}:function(G){return G&&typeof Symbol=="function"&&G.constructor===Symbol&&G!==Symbol.prototype?"symbol":typeof G},o=function(){function G(re,U){var S=[],D=!0,L=!1,P=void 0;try{for(var I=re[Symbol.iterator](),H;!(D=(H=I.next()).done)&&(S.push(H.value),!(U&&S.length===U));D=!0);}catch(V){L=!0,P=V}finally{try{!D&&I.return&&I.return()}finally{if(L)throw P}}return S}return function(re,U){if(Array.isArray(re))return re;if(Symbol.iterator in Object(re))return G(re,U);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function G(re,U){for(var S=0;S<U.length;S++){var D=U[S];D.enumerable=D.enumerable||!1,D.configurable=!0,"value"in D&&(D.writable=!0),Object.defineProperty(re,D.key,D)}}return function(re,U,S){return U&&G(re.prototype,U),S&&G(re,S),re}}(),c=s(2),d=w(c),u=s(20),f=w(u),h=s(0),A=w(h),x=s(13),p=w(x),b=s(24),m=w(b),g=s(4),y=w(g),v=s(16),_=w(v),j=s(21),N=w(j),B=s(11),E=w(B),C=s(3),k=w(C);function w(G){return G&&G.__esModule?G:{default:G}}function T(G,re,U){return re in G?Object.defineProperty(G,re,{value:U,enumerable:!0,configurable:!0,writable:!0}):G[re]=U,G}function R(G,re){if(!(G instanceof re))throw new TypeError("Cannot call a class as a function")}var q=/^[ -~]*$/,z=function(){function G(re){R(this,G),this.scroll=re,this.delta=this.getDelta()}return l(G,[{key:"applyDelta",value:function(U){var S=this,D=!1;this.scroll.update();var L=this.scroll.length();return this.scroll.batchStart(),U=Y(U),U.reduce(function(P,I){var H=I.retain||I.delete||I.insert.length||1,V=I.attributes||{};if(I.insert!=null){if(typeof I.insert=="string"){var W=I.insert;W.endsWith(`
`)&&D&&(D=!1,W=W.slice(0,-1)),P>=L&&!W.endsWith(`
`)&&(D=!0),S.scroll.insertAt(P,W);var M=S.scroll.line(P),se=o(M,2),K=se[0],he=se[1],ne=(0,k.default)({},(0,g.bubbleFormats)(K));if(K instanceof y.default){var te=K.descendant(A.default.Leaf,he),ce=o(te,1),_e=ce[0];ne=(0,k.default)(ne,(0,g.bubbleFormats)(_e))}V=f.default.attributes.diff(ne,V)||{}}else if(i(I.insert)==="object"){var de=Object.keys(I.insert)[0];if(de==null)return P;S.scroll.insertAt(P,de,I.insert[de])}L+=H}return Object.keys(V).forEach(function(ye){S.scroll.formatAt(P,H,ye,V[ye])}),P+H},0),U.reduce(function(P,I){return typeof I.delete=="number"?(S.scroll.deleteAt(P,I.delete),P):P+(I.retain||I.insert.length||1)},0),this.scroll.batchEnd(),this.update(U)}},{key:"deleteText",value:function(U,S){return this.scroll.deleteAt(U,S),this.update(new d.default().retain(U).delete(S))}},{key:"formatLine",value:function(U,S){var D=this,L=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.scroll.update(),Object.keys(L).forEach(function(P){if(!(D.scroll.whitelist!=null&&!D.scroll.whitelist[P])){var I=D.scroll.lines(U,Math.max(S,1)),H=S;I.forEach(function(V){var W=V.length();if(!(V instanceof p.default))V.format(P,L[P]);else{var M=U-V.offset(D.scroll),se=V.newlineIndex(M+H)-M+1;V.formatAt(M,se,P,L[P])}H-=W})}}),this.scroll.optimize(),this.update(new d.default().retain(U).retain(S,(0,N.default)(L)))}},{key:"formatText",value:function(U,S){var D=this,L=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Object.keys(L).forEach(function(P){D.scroll.formatAt(U,S,P,L[P])}),this.update(new d.default().retain(U).retain(S,(0,N.default)(L)))}},{key:"getContents",value:function(U,S){return this.delta.slice(U,U+S)}},{key:"getDelta",value:function(){return this.scroll.lines().reduce(function(U,S){return U.concat(S.delta())},new d.default)}},{key:"getFormat",value:function(U){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,D=[],L=[];S===0?this.scroll.path(U).forEach(function(I){var H=o(I,1),V=H[0];V instanceof y.default?D.push(V):V instanceof A.default.Leaf&&L.push(V)}):(D=this.scroll.lines(U,S),L=this.scroll.descendants(A.default.Leaf,U,S));var P=[D,L].map(function(I){if(I.length===0)return{};for(var H=(0,g.bubbleFormats)(I.shift());Object.keys(H).length>0;){var V=I.shift();if(V==null)return H;H=ee((0,g.bubbleFormats)(V),H)}return H});return k.default.apply(k.default,P)}},{key:"getText",value:function(U,S){return this.getContents(U,S).filter(function(D){return typeof D.insert=="string"}).map(function(D){return D.insert}).join("")}},{key:"insertEmbed",value:function(U,S,D){return this.scroll.insertAt(U,S,D),this.update(new d.default().retain(U).insert(T({},S,D)))}},{key:"insertText",value:function(U,S){var D=this,L=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return S=S.replace(/\r\n/g,`
`).replace(/\r/g,`
`),this.scroll.insertAt(U,S),Object.keys(L).forEach(function(P){D.scroll.formatAt(U,S.length,P,L[P])}),this.update(new d.default().retain(U).insert(S,(0,N.default)(L)))}},{key:"isBlank",value:function(){if(this.scroll.children.length==0)return!0;if(this.scroll.children.length>1)return!1;var U=this.scroll.children.head;return U.statics.blotName!==y.default.blotName||U.children.length>1?!1:U.children.head instanceof _.default}},{key:"removeFormat",value:function(U,S){var D=this.getText(U,S),L=this.scroll.line(U+S),P=o(L,2),I=P[0],H=P[1],V=0,W=new d.default;I!=null&&(I instanceof p.default?V=I.newlineIndex(H)-H+1:V=I.length()-H,W=I.delta().slice(H,H+V-1).insert(`
`));var M=this.getContents(U,S+V),se=M.diff(new d.default().insert(D).concat(W)),K=new d.default().retain(U).concat(se);return this.applyDelta(K)}},{key:"update",value:function(U){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],D=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,L=this.delta;if(S.length===1&&S[0].type==="characterData"&&S[0].target.data.match(q)&&A.default.find(S[0].target)){var P=A.default.find(S[0].target),I=(0,g.bubbleFormats)(P),H=P.offset(this.scroll),V=S[0].oldValue.replace(m.default.CONTENTS,""),W=new d.default().insert(V),M=new d.default().insert(P.value()),se=new d.default().retain(H).concat(W.diff(M,D));U=se.reduce(function(K,he){return he.insert?K.insert(he.insert,I):K.push(he)},new d.default),this.delta=L.compose(U)}else this.delta=this.getDelta(),(!U||!(0,E.default)(L.compose(U),this.delta))&&(U=L.diff(this.delta,D));return U}}]),G}();function ee(G,re){return Object.keys(re).reduce(function(U,S){return G[S]==null||(re[S]===G[S]?U[S]=re[S]:Array.isArray(re[S])?re[S].indexOf(G[S])<0&&(U[S]=re[S].concat([G[S]])):U[S]=[re[S],G[S]]),U},{})}function Y(G){return G.reduce(function(re,U){if(U.insert===1){var S=(0,N.default)(U.attributes);return delete S.image,re.insert({image:U.attributes.image},S)}if(U.attributes!=null&&(U.attributes.list===!0||U.attributes.bullet===!0)&&(U=(0,N.default)(U),U.attributes.list?U.attributes.list="ordered":(U.attributes.list="bullet",delete U.attributes.bullet)),typeof U.insert=="string"){var D=U.insert.replace(/\r\n/g,`
`).replace(/\r/g,`
`);return re.insert(D,U.attributes)}return re.push(U)},new d.default)}a.default=z},function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0}),a.default=a.Range=void 0;var i=function(){function B(E,C){var k=[],w=!0,T=!1,R=void 0;try{for(var q=E[Symbol.iterator](),z;!(w=(z=q.next()).done)&&(k.push(z.value),!(C&&k.length===C));w=!0);}catch(ee){T=!0,R=ee}finally{try{!w&&q.return&&q.return()}finally{if(T)throw R}}return k}return function(E,C){if(Array.isArray(E))return E;if(Symbol.iterator in Object(E))return B(E,C);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function B(E,C){for(var k=0;k<C.length;k++){var w=C[k];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(E,w.key,w)}}return function(E,C,k){return C&&B(E.prototype,C),k&&B(E,k),E}}(),l=s(0),c=m(l),d=s(21),u=m(d),f=s(11),h=m(f),A=s(8),x=m(A),p=s(10),b=m(p);function m(B){return B&&B.__esModule?B:{default:B}}function g(B){if(Array.isArray(B)){for(var E=0,C=Array(B.length);E<B.length;E++)C[E]=B[E];return C}else return Array.from(B)}function y(B,E){if(!(B instanceof E))throw new TypeError("Cannot call a class as a function")}var v=(0,b.default)("quill:selection"),_=function B(E){var C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;y(this,B),this.index=E,this.length=C},j=function(){function B(E,C){var k=this;y(this,B),this.emitter=C,this.scroll=E,this.composing=!1,this.mouseDown=!1,this.root=this.scroll.domNode,this.cursor=c.default.create("cursor",this),this.lastRange=this.savedRange=new _(0,0),this.handleComposition(),this.handleDragging(),this.emitter.listenDOM("selectionchange",document,function(){k.mouseDown||setTimeout(k.update.bind(k,x.default.sources.USER),1)}),this.emitter.on(x.default.events.EDITOR_CHANGE,function(w,T){w===x.default.events.TEXT_CHANGE&&T.length()>0&&k.update(x.default.sources.SILENT)}),this.emitter.on(x.default.events.SCROLL_BEFORE_UPDATE,function(){if(k.hasFocus()){var w=k.getNativeRange();w!=null&&w.start.node!==k.cursor.textNode&&k.emitter.once(x.default.events.SCROLL_UPDATE,function(){try{k.setNativeRange(w.start.node,w.start.offset,w.end.node,w.end.offset)}catch{}})}}),this.emitter.on(x.default.events.SCROLL_OPTIMIZE,function(w,T){if(T.range){var R=T.range,q=R.startNode,z=R.startOffset,ee=R.endNode,Y=R.endOffset;k.setNativeRange(q,z,ee,Y)}}),this.update(x.default.sources.SILENT)}return o(B,[{key:"handleComposition",value:function(){var C=this;this.root.addEventListener("compositionstart",function(){C.composing=!0}),this.root.addEventListener("compositionend",function(){if(C.composing=!1,C.cursor.parent){var k=C.cursor.restore();if(!k)return;setTimeout(function(){C.setNativeRange(k.startNode,k.startOffset,k.endNode,k.endOffset)},1)}})}},{key:"handleDragging",value:function(){var C=this;this.emitter.listenDOM("mousedown",document.body,function(){C.mouseDown=!0}),this.emitter.listenDOM("mouseup",document.body,function(){C.mouseDown=!1,C.update(x.default.sources.USER)})}},{key:"focus",value:function(){this.hasFocus()||(this.root.focus(),this.setRange(this.savedRange))}},{key:"format",value:function(C,k){if(!(this.scroll.whitelist!=null&&!this.scroll.whitelist[C])){this.scroll.update();var w=this.getNativeRange();if(!(w==null||!w.native.collapsed||c.default.query(C,c.default.Scope.BLOCK))){if(w.start.node!==this.cursor.textNode){var T=c.default.find(w.start.node,!1);if(T==null)return;if(T instanceof c.default.Leaf){var R=T.split(w.start.offset);T.parent.insertBefore(this.cursor,R)}else T.insertBefore(this.cursor,w.start.node);this.cursor.attach()}this.cursor.format(C,k),this.scroll.optimize(),this.setNativeRange(this.cursor.textNode,this.cursor.textNode.data.length),this.update()}}}},{key:"getBounds",value:function(C){var k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,w=this.scroll.length();C=Math.min(C,w-1),k=Math.min(C+k,w-1)-C;var T=void 0,R=this.scroll.leaf(C),q=i(R,2),z=q[0],ee=q[1];if(z==null)return null;var Y=z.position(ee,!0),G=i(Y,2);T=G[0],ee=G[1];var re=document.createRange();if(k>0){re.setStart(T,ee);var U=this.scroll.leaf(C+k),S=i(U,2);if(z=S[0],ee=S[1],z==null)return null;var D=z.position(ee,!0),L=i(D,2);return T=L[0],ee=L[1],re.setEnd(T,ee),re.getBoundingClientRect()}else{var P="left",I=void 0;return T instanceof Text?(ee<T.data.length?(re.setStart(T,ee),re.setEnd(T,ee+1)):(re.setStart(T,ee-1),re.setEnd(T,ee),P="right"),I=re.getBoundingClientRect()):(I=z.domNode.getBoundingClientRect(),ee>0&&(P="right")),{bottom:I.top+I.height,height:I.height,left:I[P],right:I[P],top:I.top,width:0}}}},{key:"getNativeRange",value:function(){var C=document.getSelection();if(C==null||C.rangeCount<=0)return null;var k=C.getRangeAt(0);if(k==null)return null;var w=this.normalizeNative(k);return v.info("getNativeRange",w),w}},{key:"getRange",value:function(){var C=this.getNativeRange();if(C==null)return[null,null];var k=this.normalizedToRange(C);return[k,C]}},{key:"hasFocus",value:function(){return document.activeElement===this.root}},{key:"normalizedToRange",value:function(C){var k=this,w=[[C.start.node,C.start.offset]];C.native.collapsed||w.push([C.end.node,C.end.offset]);var T=w.map(function(z){var ee=i(z,2),Y=ee[0],G=ee[1],re=c.default.find(Y,!0),U=re.offset(k.scroll);return G===0?U:re instanceof c.default.Container?U+re.length():U+re.index(Y,G)}),R=Math.min(Math.max.apply(Math,g(T)),this.scroll.length()-1),q=Math.min.apply(Math,[R].concat(g(T)));return new _(q,R-q)}},{key:"normalizeNative",value:function(C){if(!N(this.root,C.startContainer)||!C.collapsed&&!N(this.root,C.endContainer))return null;var k={start:{node:C.startContainer,offset:C.startOffset},end:{node:C.endContainer,offset:C.endOffset},native:C};return[k.start,k.end].forEach(function(w){for(var T=w.node,R=w.offset;!(T instanceof Text)&&T.childNodes.length>0;)if(T.childNodes.length>R)T=T.childNodes[R],R=0;else if(T.childNodes.length===R)T=T.lastChild,R=T instanceof Text?T.data.length:T.childNodes.length+1;else break;w.node=T,w.offset=R}),k}},{key:"rangeToNative",value:function(C){var k=this,w=C.collapsed?[C.index]:[C.index,C.index+C.length],T=[],R=this.scroll.length();return w.forEach(function(q,z){q=Math.min(R-1,q);var ee=void 0,Y=k.scroll.leaf(q),G=i(Y,2),re=G[0],U=G[1],S=re.position(U,z!==0),D=i(S,2);ee=D[0],U=D[1],T.push(ee,U)}),T.length<2&&(T=T.concat(T)),T}},{key:"scrollIntoView",value:function(C){var k=this.lastRange;if(k!=null){var w=this.getBounds(k.index,k.length);if(w!=null){var T=this.scroll.length()-1,R=this.scroll.line(Math.min(k.index,T)),q=i(R,1),z=q[0],ee=z;if(k.length>0){var Y=this.scroll.line(Math.min(k.index+k.length,T)),G=i(Y,1);ee=G[0]}if(!(z==null||ee==null)){var re=C.getBoundingClientRect();w.top<re.top?C.scrollTop-=re.top-w.top:w.bottom>re.bottom&&(C.scrollTop+=w.bottom-re.bottom)}}}}},{key:"setNativeRange",value:function(C,k){var w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:C,T=arguments.length>3&&arguments[3]!==void 0?arguments[3]:k,R=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(v.info("setNativeRange",C,k,w,T),!(C!=null&&(this.root.parentNode==null||C.parentNode==null||w.parentNode==null))){var q=document.getSelection();if(q!=null)if(C!=null){this.hasFocus()||this.root.focus();var z=(this.getNativeRange()||{}).native;if(z==null||R||C!==z.startContainer||k!==z.startOffset||w!==z.endContainer||T!==z.endOffset){C.tagName=="BR"&&(k=[].indexOf.call(C.parentNode.childNodes,C),C=C.parentNode),w.tagName=="BR"&&(T=[].indexOf.call(w.parentNode.childNodes,w),w=w.parentNode);var ee=document.createRange();ee.setStart(C,k),ee.setEnd(w,T),q.removeAllRanges(),q.addRange(ee)}}else q.removeAllRanges(),this.root.blur(),document.body.focus()}}},{key:"setRange",value:function(C){var k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:x.default.sources.API;if(typeof k=="string"&&(w=k,k=!1),v.info("setRange",C),C!=null){var T=this.rangeToNative(C);this.setNativeRange.apply(this,g(T).concat([k]))}else this.setNativeRange(null);this.update(w)}},{key:"update",value:function(){var C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:x.default.sources.USER,k=this.lastRange,w=this.getRange(),T=i(w,2),R=T[0],q=T[1];if(this.lastRange=R,this.lastRange!=null&&(this.savedRange=this.lastRange),!(0,h.default)(k,this.lastRange)){var z;!this.composing&&q!=null&&q.native.collapsed&&q.start.node!==this.cursor.textNode&&this.cursor.restore();var ee=[x.default.events.SELECTION_CHANGE,(0,u.default)(this.lastRange),(0,u.default)(k),C];if((z=this.emitter).emit.apply(z,[x.default.events.EDITOR_CHANGE].concat(ee)),C!==x.default.sources.SILENT){var Y;(Y=this.emitter).emit.apply(Y,ee)}}}}]),B}();function N(B,E){try{E.parentNode}catch{return!1}return E instanceof Text&&(E=E.parentNode),B.contains(E)}a.Range=_,a.default=j},function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0});var i=function(){function x(p,b){for(var m=0;m<b.length;m++){var g=b[m];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(p,g.key,g)}}return function(p,b,m){return b&&x(p.prototype,b),m&&x(p,m),p}}(),o=function x(p,b,m){p===null&&(p=Function.prototype);var g=Object.getOwnPropertyDescriptor(p,b);if(g===void 0){var y=Object.getPrototypeOf(p);return y===null?void 0:x(y,b,m)}else{if("value"in g)return g.value;var v=g.get;return v===void 0?void 0:v.call(m)}},l=s(0),c=d(l);function d(x){return x&&x.__esModule?x:{default:x}}function u(x,p){if(!(x instanceof p))throw new TypeError("Cannot call a class as a function")}function f(x,p){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p&&(typeof p=="object"||typeof p=="function")?p:x}function h(x,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof p);x.prototype=Object.create(p&&p.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(x,p):x.__proto__=p)}var A=function(x){h(p,x);function p(){return u(this,p),f(this,(p.__proto__||Object.getPrototypeOf(p)).apply(this,arguments))}return i(p,[{key:"insertInto",value:function(m,g){m.children.length===0?o(p.prototype.__proto__||Object.getPrototypeOf(p.prototype),"insertInto",this).call(this,m,g):this.remove()}},{key:"length",value:function(){return 0}},{key:"value",value:function(){return""}}],[{key:"value",value:function(){}}]),p}(c.default.Embed);A.blotName="break",A.tagName="BR",a.default=A},function(r,a,s){var i=this&&this.__extends||function(){var f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,A){h.__proto__=A}||function(h,A){for(var x in A)A.hasOwnProperty(x)&&(h[x]=A[x])};return function(h,A){f(h,A);function x(){this.constructor=h}h.prototype=A===null?Object.create(A):(x.prototype=A.prototype,new x)}}();Object.defineProperty(a,"__esModule",{value:!0});var o=s(44),l=s(30),c=s(1),d=function(f){i(h,f);function h(A){var x=f.call(this,A)||this;return x.build(),x}return h.prototype.appendChild=function(A){this.insertBefore(A)},h.prototype.attach=function(){f.prototype.attach.call(this),this.children.forEach(function(A){A.attach()})},h.prototype.build=function(){var A=this;this.children=new o.default,[].slice.call(this.domNode.childNodes).reverse().forEach(function(x){try{var p=u(x);A.insertBefore(p,A.children.head||void 0)}catch(b){if(b instanceof c.ParchmentError)return;throw b}})},h.prototype.deleteAt=function(A,x){if(A===0&&x===this.length())return this.remove();this.children.forEachAt(A,x,function(p,b,m){p.deleteAt(b,m)})},h.prototype.descendant=function(A,x){var p=this.children.find(x),b=p[0],m=p[1];return A.blotName==null&&A(b)||A.blotName!=null&&b instanceof A?[b,m]:b instanceof h?b.descendant(A,m):[null,-1]},h.prototype.descendants=function(A,x,p){x===void 0&&(x=0),p===void 0&&(p=Number.MAX_VALUE);var b=[],m=p;return this.children.forEachAt(x,p,function(g,y,v){(A.blotName==null&&A(g)||A.blotName!=null&&g instanceof A)&&b.push(g),g instanceof h&&(b=b.concat(g.descendants(A,y,m))),m-=v}),b},h.prototype.detach=function(){this.children.forEach(function(A){A.detach()}),f.prototype.detach.call(this)},h.prototype.formatAt=function(A,x,p,b){this.children.forEachAt(A,x,function(m,g,y){m.formatAt(g,y,p,b)})},h.prototype.insertAt=function(A,x,p){var b=this.children.find(A),m=b[0],g=b[1];if(m)m.insertAt(g,x,p);else{var y=p==null?c.create("text",x):c.create(x,p);this.appendChild(y)}},h.prototype.insertBefore=function(A,x){if(this.statics.allowedChildren!=null&&!this.statics.allowedChildren.some(function(p){return A instanceof p}))throw new c.ParchmentError("Cannot insert "+A.statics.blotName+" into "+this.statics.blotName);A.insertInto(this,x)},h.prototype.length=function(){return this.children.reduce(function(A,x){return A+x.length()},0)},h.prototype.moveChildren=function(A,x){this.children.forEach(function(p){A.insertBefore(p,x)})},h.prototype.optimize=function(A){if(f.prototype.optimize.call(this,A),this.children.length===0)if(this.statics.defaultChild!=null){var x=c.create(this.statics.defaultChild);this.appendChild(x),x.optimize(A)}else this.remove()},h.prototype.path=function(A,x){x===void 0&&(x=!1);var p=this.children.find(A,x),b=p[0],m=p[1],g=[[this,A]];return b instanceof h?g.concat(b.path(m,x)):(b!=null&&g.push([b,m]),g)},h.prototype.removeChild=function(A){this.children.remove(A)},h.prototype.replace=function(A){A instanceof h&&A.moveChildren(this),f.prototype.replace.call(this,A)},h.prototype.split=function(A,x){if(x===void 0&&(x=!1),!x){if(A===0)return this;if(A===this.length())return this.next}var p=this.clone();return this.parent.insertBefore(p,this.next),this.children.forEachAt(A,this.length(),function(b,m,g){b=b.split(m,x),p.appendChild(b)}),p},h.prototype.unwrap=function(){this.moveChildren(this.parent,this.next),this.remove()},h.prototype.update=function(A,x){var p=this,b=[],m=[];A.forEach(function(g){g.target===p.domNode&&g.type==="childList"&&(b.push.apply(b,g.addedNodes),m.push.apply(m,g.removedNodes))}),m.forEach(function(g){if(!(g.parentNode!=null&&g.tagName!=="IFRAME"&&document.body.compareDocumentPosition(g)&Node.DOCUMENT_POSITION_CONTAINED_BY)){var y=c.find(g);y!=null&&(y.domNode.parentNode==null||y.domNode.parentNode===p.domNode)&&y.detach()}}),b.filter(function(g){return g.parentNode==p.domNode}).sort(function(g,y){return g===y?0:g.compareDocumentPosition(y)&Node.DOCUMENT_POSITION_FOLLOWING?1:-1}).forEach(function(g){var y=null;g.nextSibling!=null&&(y=c.find(g.nextSibling));var v=u(g);(v.next!=y||v.next==null)&&(v.parent!=null&&v.parent.removeChild(p),p.insertBefore(v,y||void 0))})},h}(l.default);function u(f){var h=c.find(f);if(h==null)try{h=c.create(f)}catch{h=c.create(c.Scope.INLINE),[].slice.call(f.childNodes).forEach(function(x){h.domNode.appendChild(x)}),f.parentNode&&f.parentNode.replaceChild(h.domNode,f),h.attach()}return h}a.default=d},function(r,a,s){var i=this&&this.__extends||function(){var f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,A){h.__proto__=A}||function(h,A){for(var x in A)A.hasOwnProperty(x)&&(h[x]=A[x])};return function(h,A){f(h,A);function x(){this.constructor=h}h.prototype=A===null?Object.create(A):(x.prototype=A.prototype,new x)}}();Object.defineProperty(a,"__esModule",{value:!0});var o=s(12),l=s(31),c=s(17),d=s(1),u=function(f){i(h,f);function h(A){var x=f.call(this,A)||this;return x.attributes=new l.default(x.domNode),x}return h.formats=function(A){if(typeof this.tagName=="string")return!0;if(Array.isArray(this.tagName))return A.tagName.toLowerCase()},h.prototype.format=function(A,x){var p=d.query(A);p instanceof o.default?this.attributes.attribute(p,x):x&&p!=null&&(A!==this.statics.blotName||this.formats()[A]!==x)&&this.replaceWith(A,x)},h.prototype.formats=function(){var A=this.attributes.values(),x=this.statics.formats(this.domNode);return x!=null&&(A[this.statics.blotName]=x),A},h.prototype.replaceWith=function(A,x){var p=f.prototype.replaceWith.call(this,A,x);return this.attributes.copy(p),p},h.prototype.update=function(A,x){var p=this;f.prototype.update.call(this,A,x),A.some(function(b){return b.target===p.domNode&&b.type==="attributes"})&&this.attributes.build()},h.prototype.wrap=function(A,x){var p=f.prototype.wrap.call(this,A,x);return p instanceof h&&p.statics.scope===this.statics.scope&&this.attributes.move(p),p},h}(c.default);a.default=u},function(r,a,s){var i=this&&this.__extends||function(){var d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,f){u.__proto__=f}||function(u,f){for(var h in f)f.hasOwnProperty(h)&&(u[h]=f[h])};return function(u,f){d(u,f);function h(){this.constructor=u}u.prototype=f===null?Object.create(f):(h.prototype=f.prototype,new h)}}();Object.defineProperty(a,"__esModule",{value:!0});var o=s(30),l=s(1),c=function(d){i(u,d);function u(){return d!==null&&d.apply(this,arguments)||this}return u.value=function(f){return!0},u.prototype.index=function(f,h){return this.domNode===f||this.domNode.compareDocumentPosition(f)&Node.DOCUMENT_POSITION_CONTAINED_BY?Math.min(h,1):-1},u.prototype.position=function(f,h){var A=[].indexOf.call(this.parent.domNode.childNodes,this.domNode);return f>0&&(A+=1),[this.parent.domNode,A]},u.prototype.value=function(){var f;return f={},f[this.statics.blotName]=this.statics.value(this.domNode)||!0,f},u.scope=l.Scope.INLINE_BLOT,u}(o.default);a.default=c},function(r,a,s){var i=s(11),o=s(3),l={attributes:{compose:function(d,u,f){typeof d!="object"&&(d={}),typeof u!="object"&&(u={});var h=o(!0,{},u);f||(h=Object.keys(h).reduce(function(x,p){return h[p]!=null&&(x[p]=h[p]),x},{}));for(var A in d)d[A]!==void 0&&u[A]===void 0&&(h[A]=d[A]);return Object.keys(h).length>0?h:void 0},diff:function(d,u){typeof d!="object"&&(d={}),typeof u!="object"&&(u={});var f=Object.keys(d).concat(Object.keys(u)).reduce(function(h,A){return i(d[A],u[A])||(h[A]=u[A]===void 0?null:u[A]),h},{});return Object.keys(f).length>0?f:void 0},transform:function(d,u,f){if(typeof d!="object")return u;if(typeof u=="object"){if(!f)return u;var h=Object.keys(u).reduce(function(A,x){return d[x]===void 0&&(A[x]=u[x]),A},{});return Object.keys(h).length>0?h:void 0}}},iterator:function(d){return new c(d)},length:function(d){return typeof d.delete=="number"?d.delete:typeof d.retain=="number"?d.retain:typeof d.insert=="string"?d.insert.length:1}};function c(d){this.ops=d,this.index=0,this.offset=0}c.prototype.hasNext=function(){return this.peekLength()<1/0},c.prototype.next=function(d){d||(d=1/0);var u=this.ops[this.index];if(u){var f=this.offset,h=l.length(u);if(d>=h-f?(d=h-f,this.index+=1,this.offset=0):this.offset+=d,typeof u.delete=="number")return{delete:d};var A={};return u.attributes&&(A.attributes=u.attributes),typeof u.retain=="number"?A.retain=d:typeof u.insert=="string"?A.insert=u.insert.substr(f,d):A.insert=u.insert,A}else return{retain:1/0}},c.prototype.peek=function(){return this.ops[this.index]},c.prototype.peekLength=function(){return this.ops[this.index]?l.length(this.ops[this.index])-this.offset:1/0},c.prototype.peekType=function(){return this.ops[this.index]?typeof this.ops[this.index].delete=="number"?"delete":typeof this.ops[this.index].retain=="number"?"retain":"insert":"retain"},c.prototype.rest=function(){if(this.hasNext()){if(this.offset===0)return this.ops.slice(this.index);var d=this.offset,u=this.index,f=this.next(),h=this.ops.slice(this.index);return this.offset=d,this.index=u,[f].concat(h)}else return[]},r.exports=l},function(r,a){var s=function(){function i(p,b){return b!=null&&p instanceof b}var o;try{o=Map}catch{o=function(){}}var l;try{l=Set}catch{l=function(){}}var c;try{c=Promise}catch{c=function(){}}function d(p,b,m,g,y){typeof b=="object"&&(m=b.depth,g=b.prototype,y=b.includeNonEnumerable,b=b.circular);var v=[],_=[],j=typeof Buffer<"u";typeof b>"u"&&(b=!0),typeof m>"u"&&(m=1/0);function N(B,E){if(B===null)return null;if(E===0)return B;var C,k;if(typeof B!="object")return B;if(i(B,o))C=new o;else if(i(B,l))C=new l;else if(i(B,c))C=new c(function(re,U){B.then(function(S){re(N(S,E-1))},function(S){U(N(S,E-1))})});else if(d.__isArray(B))C=[];else if(d.__isRegExp(B))C=new RegExp(B.source,x(B)),B.lastIndex&&(C.lastIndex=B.lastIndex);else if(d.__isDate(B))C=new Date(B.getTime());else{if(j&&Buffer.isBuffer(B))return Buffer.allocUnsafe?C=Buffer.allocUnsafe(B.length):C=new Buffer(B.length),B.copy(C),C;i(B,Error)?C=Object.create(B):typeof g>"u"?(k=Object.getPrototypeOf(B),C=Object.create(k)):(C=Object.create(g),k=g)}if(b){var w=v.indexOf(B);if(w!=-1)return _[w];v.push(B),_.push(C)}i(B,o)&&B.forEach(function(re,U){var S=N(U,E-1),D=N(re,E-1);C.set(S,D)}),i(B,l)&&B.forEach(function(re){var U=N(re,E-1);C.add(U)});for(var T in B){var R;k&&(R=Object.getOwnPropertyDescriptor(k,T)),!(R&&R.set==null)&&(C[T]=N(B[T],E-1))}if(Object.getOwnPropertySymbols)for(var q=Object.getOwnPropertySymbols(B),T=0;T<q.length;T++){var z=q[T],ee=Object.getOwnPropertyDescriptor(B,z);ee&&!ee.enumerable&&!y||(C[z]=N(B[z],E-1),ee.enumerable||Object.defineProperty(C,z,{enumerable:!1}))}if(y)for(var Y=Object.getOwnPropertyNames(B),T=0;T<Y.length;T++){var G=Y[T],ee=Object.getOwnPropertyDescriptor(B,G);ee&&ee.enumerable||(C[G]=N(B[G],E-1),Object.defineProperty(C,G,{enumerable:!1}))}return C}return N(p,m)}d.clonePrototype=function(b){if(b===null)return null;var m=function(){};return m.prototype=b,new m};function u(p){return Object.prototype.toString.call(p)}d.__objToStr=u;function f(p){return typeof p=="object"&&u(p)==="[object Date]"}d.__isDate=f;function h(p){return typeof p=="object"&&u(p)==="[object Array]"}d.__isArray=h;function A(p){return typeof p=="object"&&u(p)==="[object RegExp]"}d.__isRegExp=A;function x(p){var b="";return p.global&&(b+="g"),p.ignoreCase&&(b+="i"),p.multiline&&(b+="m"),b}return d.__getRegExpFlags=x,d}();typeof r=="object"&&r.exports&&(r.exports=s)},function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0});var i=function(){function C(k,w){var T=[],R=!0,q=!1,z=void 0;try{for(var ee=k[Symbol.iterator](),Y;!(R=(Y=ee.next()).done)&&(T.push(Y.value),!(w&&T.length===w));R=!0);}catch(G){q=!0,z=G}finally{try{!R&&ee.return&&ee.return()}finally{if(q)throw z}}return T}return function(k,w){if(Array.isArray(k))return k;if(Symbol.iterator in Object(k))return C(k,w);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function C(k,w){for(var T=0;T<w.length;T++){var R=w[T];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(k,R.key,R)}}return function(k,w,T){return w&&C(k.prototype,w),T&&C(k,T),k}}(),l=function C(k,w,T){k===null&&(k=Function.prototype);var R=Object.getOwnPropertyDescriptor(k,w);if(R===void 0){var q=Object.getPrototypeOf(k);return q===null?void 0:C(q,w,T)}else{if("value"in R)return R.value;var z=R.get;return z===void 0?void 0:z.call(T)}},c=s(0),d=v(c),u=s(8),f=v(u),h=s(4),A=v(h),x=s(16),p=v(x),b=s(13),m=v(b),g=s(25),y=v(g);function v(C){return C&&C.__esModule?C:{default:C}}function _(C,k){if(!(C instanceof k))throw new TypeError("Cannot call a class as a function")}function j(C,k){if(!C)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return k&&(typeof k=="object"||typeof k=="function")?k:C}function N(C,k){if(typeof k!="function"&&k!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof k);C.prototype=Object.create(k&&k.prototype,{constructor:{value:C,enumerable:!1,writable:!0,configurable:!0}}),k&&(Object.setPrototypeOf?Object.setPrototypeOf(C,k):C.__proto__=k)}function B(C){return C instanceof A.default||C instanceof h.BlockEmbed}var E=function(C){N(k,C);function k(w,T){_(this,k);var R=j(this,(k.__proto__||Object.getPrototypeOf(k)).call(this,w));return R.emitter=T.emitter,Array.isArray(T.whitelist)&&(R.whitelist=T.whitelist.reduce(function(q,z){return q[z]=!0,q},{})),R.domNode.addEventListener("DOMNodeInserted",function(){}),R.optimize(),R.enable(),R}return o(k,[{key:"batchStart",value:function(){this.batch=!0}},{key:"batchEnd",value:function(){this.batch=!1,this.optimize()}},{key:"deleteAt",value:function(T,R){var q=this.line(T),z=i(q,2),ee=z[0],Y=z[1],G=this.line(T+R),re=i(G,1),U=re[0];if(l(k.prototype.__proto__||Object.getPrototypeOf(k.prototype),"deleteAt",this).call(this,T,R),U!=null&&ee!==U&&Y>0){if(ee instanceof h.BlockEmbed||U instanceof h.BlockEmbed){this.optimize();return}if(ee instanceof m.default){var S=ee.newlineIndex(ee.length(),!0);if(S>-1&&(ee=ee.split(S+1),ee===U)){this.optimize();return}}else if(U instanceof m.default){var D=U.newlineIndex(0);D>-1&&U.split(D+1)}var L=U.children.head instanceof p.default?null:U.children.head;ee.moveChildren(U,L),ee.remove()}this.optimize()}},{key:"enable",value:function(){var T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.domNode.setAttribute("contenteditable",T)}},{key:"formatAt",value:function(T,R,q,z){this.whitelist!=null&&!this.whitelist[q]||(l(k.prototype.__proto__||Object.getPrototypeOf(k.prototype),"formatAt",this).call(this,T,R,q,z),this.optimize())}},{key:"insertAt",value:function(T,R,q){if(!(q!=null&&this.whitelist!=null&&!this.whitelist[R])){if(T>=this.length())if(q==null||d.default.query(R,d.default.Scope.BLOCK)==null){var z=d.default.create(this.statics.defaultChild);this.appendChild(z),q==null&&R.endsWith(`
`)&&(R=R.slice(0,-1)),z.insertAt(0,R,q)}else{var ee=d.default.create(R,q);this.appendChild(ee)}else l(k.prototype.__proto__||Object.getPrototypeOf(k.prototype),"insertAt",this).call(this,T,R,q);this.optimize()}}},{key:"insertBefore",value:function(T,R){if(T.statics.scope===d.default.Scope.INLINE_BLOT){var q=d.default.create(this.statics.defaultChild);q.appendChild(T),T=q}l(k.prototype.__proto__||Object.getPrototypeOf(k.prototype),"insertBefore",this).call(this,T,R)}},{key:"leaf",value:function(T){return this.path(T).pop()||[null,-1]}},{key:"line",value:function(T){return T===this.length()?this.line(T-1):this.descendant(B,T)}},{key:"lines",value:function(){var T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE,q=function z(ee,Y,G){var re=[],U=G;return ee.children.forEachAt(Y,G,function(S,D,L){B(S)?re.push(S):S instanceof d.default.Container&&(re=re.concat(z(S,D,U))),U-=L}),re};return q(this,T,R)}},{key:"optimize",value:function(){var T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.batch!==!0&&(l(k.prototype.__proto__||Object.getPrototypeOf(k.prototype),"optimize",this).call(this,T,R),T.length>0&&this.emitter.emit(f.default.events.SCROLL_OPTIMIZE,T,R))}},{key:"path",value:function(T){return l(k.prototype.__proto__||Object.getPrototypeOf(k.prototype),"path",this).call(this,T).slice(1)}},{key:"update",value:function(T){if(this.batch!==!0){var R=f.default.sources.USER;typeof T=="string"&&(R=T),Array.isArray(T)||(T=this.observer.takeRecords()),T.length>0&&this.emitter.emit(f.default.events.SCROLL_BEFORE_UPDATE,R,T),l(k.prototype.__proto__||Object.getPrototypeOf(k.prototype),"update",this).call(this,T.concat([])),T.length>0&&this.emitter.emit(f.default.events.SCROLL_UPDATE,R,T)}}}]),k}(d.default.Scroll);E.blotName="scroll",E.className="ql-editor",E.tagName="DIV",E.defaultChild="block",E.allowedChildren=[A.default,h.BlockEmbed,y.default],a.default=E},function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0}),a.SHORTKEY=a.default=void 0;var i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(I){return typeof I}:function(I){return I&&typeof Symbol=="function"&&I.constructor===Symbol&&I!==Symbol.prototype?"symbol":typeof I},o=function(){function I(H,V){var W=[],M=!0,se=!1,K=void 0;try{for(var he=H[Symbol.iterator](),ne;!(M=(ne=he.next()).done)&&(W.push(ne.value),!(V&&W.length===V));M=!0);}catch(te){se=!0,K=te}finally{try{!M&&he.return&&he.return()}finally{if(se)throw K}}return W}return function(H,V){if(Array.isArray(H))return H;if(Symbol.iterator in Object(H))return I(H,V);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function I(H,V){for(var W=0;W<V.length;W++){var M=V[W];M.enumerable=M.enumerable||!1,M.configurable=!0,"value"in M&&(M.writable=!0),Object.defineProperty(H,M.key,M)}}return function(H,V,W){return V&&I(H.prototype,V),W&&I(H,W),H}}(),c=s(21),d=C(c),u=s(11),f=C(u),h=s(3),A=C(h),x=s(2),p=C(x),b=s(20),m=C(b),g=s(0),y=C(g),v=s(5),_=C(v),j=s(10),N=C(j),B=s(9),E=C(B);function C(I){return I&&I.__esModule?I:{default:I}}function k(I,H,V){return H in I?Object.defineProperty(I,H,{value:V,enumerable:!0,configurable:!0,writable:!0}):I[H]=V,I}function w(I,H){if(!(I instanceof H))throw new TypeError("Cannot call a class as a function")}function T(I,H){if(!I)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return H&&(typeof H=="object"||typeof H=="function")?H:I}function R(I,H){if(typeof H!="function"&&H!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof H);I.prototype=Object.create(H&&H.prototype,{constructor:{value:I,enumerable:!1,writable:!0,configurable:!0}}),H&&(Object.setPrototypeOf?Object.setPrototypeOf(I,H):I.__proto__=H)}var q=(0,N.default)("quill:keyboard"),z=/Mac/i.test(navigator.platform)?"metaKey":"ctrlKey",ee=function(I){R(H,I),l(H,null,[{key:"match",value:function(W,M){return M=P(M),["altKey","ctrlKey","metaKey","shiftKey"].some(function(se){return!!M[se]!==W[se]&&M[se]!==null})?!1:M.key===(W.which||W.keyCode)}}]);function H(V,W){w(this,H);var M=T(this,(H.__proto__||Object.getPrototypeOf(H)).call(this,V,W));return M.bindings={},Object.keys(M.options.bindings).forEach(function(se){se==="list autofill"&&V.scroll.whitelist!=null&&!V.scroll.whitelist.list||M.options.bindings[se]&&M.addBinding(M.options.bindings[se])}),M.addBinding({key:H.keys.ENTER,shiftKey:null},S),M.addBinding({key:H.keys.ENTER,metaKey:null,ctrlKey:null,altKey:null},function(){}),/Firefox/i.test(navigator.userAgent)?(M.addBinding({key:H.keys.BACKSPACE},{collapsed:!0},G),M.addBinding({key:H.keys.DELETE},{collapsed:!0},re)):(M.addBinding({key:H.keys.BACKSPACE},{collapsed:!0,prefix:/^.?$/},G),M.addBinding({key:H.keys.DELETE},{collapsed:!0,suffix:/^.?$/},re)),M.addBinding({key:H.keys.BACKSPACE},{collapsed:!1},U),M.addBinding({key:H.keys.DELETE},{collapsed:!1},U),M.addBinding({key:H.keys.BACKSPACE,altKey:null,ctrlKey:null,metaKey:null,shiftKey:null},{collapsed:!0,offset:0},G),M.listen(),M}return l(H,[{key:"addBinding",value:function(W){var M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},se=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},K=P(W);if(K==null||K.key==null)return q.warn("Attempted to add invalid keyboard binding",K);typeof M=="function"&&(M={handler:M}),typeof se=="function"&&(se={handler:se}),K=(0,A.default)(K,M,se),this.bindings[K.key]=this.bindings[K.key]||[],this.bindings[K.key].push(K)}},{key:"listen",value:function(){var W=this;this.quill.root.addEventListener("keydown",function(M){if(!M.defaultPrevented){var se=M.which||M.keyCode,K=(W.bindings[se]||[]).filter(function(Ue){return H.match(M,Ue)});if(K.length!==0){var he=W.quill.getSelection();if(!(he==null||!W.quill.hasFocus())){var ne=W.quill.getLine(he.index),te=o(ne,2),ce=te[0],_e=te[1],de=W.quill.getLeaf(he.index),ye=o(de,2),Le=ye[0],we=ye[1],ge=he.length===0?[Le,we]:W.quill.getLeaf(he.index+he.length),Re=o(ge,2),et=Re[0],Ye=Re[1],Be=Le instanceof y.default.Text?Le.value().slice(0,we):"",Fe=et instanceof y.default.Text?et.value().slice(Ye):"",oe={collapsed:he.length===0,empty:he.length===0&&ce.length()<=1,format:W.quill.getFormat(he),offset:_e,prefix:Be,suffix:Fe},ke=K.some(function(Ue){if(Ue.collapsed!=null&&Ue.collapsed!==oe.collapsed||Ue.empty!=null&&Ue.empty!==oe.empty||Ue.offset!=null&&Ue.offset!==oe.offset)return!1;if(Array.isArray(Ue.format)){if(Ue.format.every(function(qe){return oe.format[qe]==null}))return!1}else if(i(Ue.format)==="object"&&!Object.keys(Ue.format).every(function(qe){return Ue.format[qe]===!0?oe.format[qe]!=null:Ue.format[qe]===!1?oe.format[qe]==null:(0,f.default)(Ue.format[qe],oe.format[qe])}))return!1;return Ue.prefix!=null&&!Ue.prefix.test(oe.prefix)||Ue.suffix!=null&&!Ue.suffix.test(oe.suffix)?!1:Ue.handler.call(W,he,oe)!==!0});ke&&M.preventDefault()}}}})}}]),H}(E.default);ee.keys={BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46},ee.DEFAULTS={bindings:{bold:L("bold"),italic:L("italic"),underline:L("underline"),indent:{key:ee.keys.TAB,format:["blockquote","indent","list"],handler:function(H,V){if(V.collapsed&&V.offset!==0)return!0;this.quill.format("indent","+1",_.default.sources.USER)}},outdent:{key:ee.keys.TAB,shiftKey:!0,format:["blockquote","indent","list"],handler:function(H,V){if(V.collapsed&&V.offset!==0)return!0;this.quill.format("indent","-1",_.default.sources.USER)}},"outdent backspace":{key:ee.keys.BACKSPACE,collapsed:!0,shiftKey:null,metaKey:null,ctrlKey:null,altKey:null,format:["indent","list"],offset:0,handler:function(H,V){V.format.indent!=null?this.quill.format("indent","-1",_.default.sources.USER):V.format.list!=null&&this.quill.format("list",!1,_.default.sources.USER)}},"indent code-block":D(!0),"outdent code-block":D(!1),"remove tab":{key:ee.keys.TAB,shiftKey:!0,collapsed:!0,prefix:/\t$/,handler:function(H){this.quill.deleteText(H.index-1,1,_.default.sources.USER)}},tab:{key:ee.keys.TAB,handler:function(H){this.quill.history.cutoff();var V=new p.default().retain(H.index).delete(H.length).insert("	");this.quill.updateContents(V,_.default.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(H.index+1,_.default.sources.SILENT)}},"list empty enter":{key:ee.keys.ENTER,collapsed:!0,format:["list"],empty:!0,handler:function(H,V){this.quill.format("list",!1,_.default.sources.USER),V.format.indent&&this.quill.format("indent",!1,_.default.sources.USER)}},"checklist enter":{key:ee.keys.ENTER,collapsed:!0,format:{list:"checked"},handler:function(H){var V=this.quill.getLine(H.index),W=o(V,2),M=W[0],se=W[1],K=(0,A.default)({},M.formats(),{list:"checked"}),he=new p.default().retain(H.index).insert(`
`,K).retain(M.length()-se-1).retain(1,{list:"unchecked"});this.quill.updateContents(he,_.default.sources.USER),this.quill.setSelection(H.index+1,_.default.sources.SILENT),this.quill.scrollIntoView()}},"header enter":{key:ee.keys.ENTER,collapsed:!0,format:["header"],suffix:/^$/,handler:function(H,V){var W=this.quill.getLine(H.index),M=o(W,2),se=M[0],K=M[1],he=new p.default().retain(H.index).insert(`
`,V.format).retain(se.length()-K-1).retain(1,{header:null});this.quill.updateContents(he,_.default.sources.USER),this.quill.setSelection(H.index+1,_.default.sources.SILENT),this.quill.scrollIntoView()}},"list autofill":{key:" ",collapsed:!0,format:{list:!1},prefix:/^\s*?(\d+\.|-|\*|\[ ?\]|\[x\])$/,handler:function(H,V){var W=V.prefix.length,M=this.quill.getLine(H.index),se=o(M,2),K=se[0],he=se[1];if(he>W)return!0;var ne=void 0;switch(V.prefix.trim()){case"[]":case"[ ]":ne="unchecked";break;case"[x]":ne="checked";break;case"-":case"*":ne="bullet";break;default:ne="ordered"}this.quill.insertText(H.index," ",_.default.sources.USER),this.quill.history.cutoff();var te=new p.default().retain(H.index-he).delete(W+1).retain(K.length()-2-he).retain(1,{list:ne});this.quill.updateContents(te,_.default.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(H.index-W,_.default.sources.SILENT)}},"code exit":{key:ee.keys.ENTER,collapsed:!0,format:["code-block"],prefix:/\n\n$/,suffix:/^\s+$/,handler:function(H){var V=this.quill.getLine(H.index),W=o(V,2),M=W[0],se=W[1],K=new p.default().retain(H.index+M.length()-se-2).retain(1,{"code-block":null}).delete(1);this.quill.updateContents(K,_.default.sources.USER)}},"embed left":Y(ee.keys.LEFT,!1),"embed left shift":Y(ee.keys.LEFT,!0),"embed right":Y(ee.keys.RIGHT,!1),"embed right shift":Y(ee.keys.RIGHT,!0)}};function Y(I,H){var V,W=I===ee.keys.LEFT?"prefix":"suffix";return V={key:I,shiftKey:H,altKey:null},k(V,W,/^$/),k(V,"handler",function(se){var K=se.index;I===ee.keys.RIGHT&&(K+=se.length+1);var he=this.quill.getLeaf(K),ne=o(he,1),te=ne[0];return te instanceof y.default.Embed?(I===ee.keys.LEFT?H?this.quill.setSelection(se.index-1,se.length+1,_.default.sources.USER):this.quill.setSelection(se.index-1,_.default.sources.USER):H?this.quill.setSelection(se.index,se.length+1,_.default.sources.USER):this.quill.setSelection(se.index+se.length+1,_.default.sources.USER),!1):!0}),V}function G(I,H){if(!(I.index===0||this.quill.getLength()<=1)){var V=this.quill.getLine(I.index),W=o(V,1),M=W[0],se={};if(H.offset===0){var K=this.quill.getLine(I.index-1),he=o(K,1),ne=he[0];if(ne!=null&&ne.length()>1){var te=M.formats(),ce=this.quill.getFormat(I.index-1,1);se=m.default.attributes.diff(te,ce)||{}}}var _e=/[\uD800-\uDBFF][\uDC00-\uDFFF]$/.test(H.prefix)?2:1;this.quill.deleteText(I.index-_e,_e,_.default.sources.USER),Object.keys(se).length>0&&this.quill.formatLine(I.index-_e,_e,se,_.default.sources.USER),this.quill.focus()}}function re(I,H){var V=/^[\uD800-\uDBFF][\uDC00-\uDFFF]/.test(H.suffix)?2:1;if(!(I.index>=this.quill.getLength()-V)){var W={},M=0,se=this.quill.getLine(I.index),K=o(se,1),he=K[0];if(H.offset>=he.length()-1){var ne=this.quill.getLine(I.index+1),te=o(ne,1),ce=te[0];if(ce){var _e=he.formats(),de=this.quill.getFormat(I.index,1);W=m.default.attributes.diff(_e,de)||{},M=ce.length()}}this.quill.deleteText(I.index,V,_.default.sources.USER),Object.keys(W).length>0&&this.quill.formatLine(I.index+M-1,V,W,_.default.sources.USER)}}function U(I){var H=this.quill.getLines(I),V={};if(H.length>1){var W=H[0].formats(),M=H[H.length-1].formats();V=m.default.attributes.diff(M,W)||{}}this.quill.deleteText(I,_.default.sources.USER),Object.keys(V).length>0&&this.quill.formatLine(I.index,1,V,_.default.sources.USER),this.quill.setSelection(I.index,_.default.sources.SILENT),this.quill.focus()}function S(I,H){var V=this;I.length>0&&this.quill.scroll.deleteAt(I.index,I.length);var W=Object.keys(H.format).reduce(function(M,se){return y.default.query(se,y.default.Scope.BLOCK)&&!Array.isArray(H.format[se])&&(M[se]=H.format[se]),M},{});this.quill.insertText(I.index,`
`,W,_.default.sources.USER),this.quill.setSelection(I.index+1,_.default.sources.SILENT),this.quill.focus(),Object.keys(H.format).forEach(function(M){W[M]==null&&(Array.isArray(H.format[M])||M!=="link"&&V.quill.format(M,H.format[M],_.default.sources.USER))})}function D(I){return{key:ee.keys.TAB,shiftKey:!I,format:{"code-block":!0},handler:function(V){var W=y.default.query("code-block"),M=V.index,se=V.length,K=this.quill.scroll.descendant(W,M),he=o(K,2),ne=he[0],te=he[1];if(ne!=null){var ce=this.quill.getIndex(ne),_e=ne.newlineIndex(te,!0)+1,de=ne.newlineIndex(ce+te+se),ye=ne.domNode.textContent.slice(_e,de).split(`
`);te=0,ye.forEach(function(Le,we){I?(ne.insertAt(_e+te,W.TAB),te+=W.TAB.length,we===0?M+=W.TAB.length:se+=W.TAB.length):Le.startsWith(W.TAB)&&(ne.deleteAt(_e+te,W.TAB.length),te-=W.TAB.length,we===0?M-=W.TAB.length:se-=W.TAB.length),te+=Le.length+1}),this.quill.update(_.default.sources.USER),this.quill.setSelection(M,se,_.default.sources.SILENT)}}}}function L(I){return{key:I[0].toUpperCase(),shortKey:!0,handler:function(V,W){this.quill.format(I,!W.format[I],_.default.sources.USER)}}}function P(I){if(typeof I=="string"||typeof I=="number")return P({key:I});if((typeof I>"u"?"undefined":i(I))==="object"&&(I=(0,d.default)(I,!1)),typeof I.key=="string")if(ee.keys[I.key.toUpperCase()]!=null)I.key=ee.keys[I.key.toUpperCase()];else if(I.key.length===1)I.key=I.key.toUpperCase().charCodeAt(0);else return null;return I.shortKey&&(I[z]=I.shortKey,delete I.shortKey),I}a.default=ee,a.SHORTKEY=z},function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0});var i=function(){function m(g,y){var v=[],_=!0,j=!1,N=void 0;try{for(var B=g[Symbol.iterator](),E;!(_=(E=B.next()).done)&&(v.push(E.value),!(y&&v.length===y));_=!0);}catch(C){j=!0,N=C}finally{try{!_&&B.return&&B.return()}finally{if(j)throw N}}return v}return function(g,y){if(Array.isArray(g))return g;if(Symbol.iterator in Object(g))return m(g,y);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function m(g,y,v){g===null&&(g=Function.prototype);var _=Object.getOwnPropertyDescriptor(g,y);if(_===void 0){var j=Object.getPrototypeOf(g);return j===null?void 0:m(j,y,v)}else{if("value"in _)return _.value;var N=_.get;return N===void 0?void 0:N.call(v)}},l=function(){function m(g,y){for(var v=0;v<y.length;v++){var _=y[v];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(g,_.key,_)}}return function(g,y,v){return y&&m(g.prototype,y),v&&m(g,v),g}}(),c=s(0),d=h(c),u=s(7),f=h(u);function h(m){return m&&m.__esModule?m:{default:m}}function A(m,g){if(!(m instanceof g))throw new TypeError("Cannot call a class as a function")}function x(m,g){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g&&(typeof g=="object"||typeof g=="function")?g:m}function p(m,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof g);m.prototype=Object.create(g&&g.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(m,g):m.__proto__=g)}var b=function(m){p(g,m),l(g,null,[{key:"value",value:function(){}}]);function g(y,v){A(this,g);var _=x(this,(g.__proto__||Object.getPrototypeOf(g)).call(this,y));return _.selection=v,_.textNode=document.createTextNode(g.CONTENTS),_.domNode.appendChild(_.textNode),_._length=0,_}return l(g,[{key:"detach",value:function(){this.parent!=null&&this.parent.removeChild(this)}},{key:"format",value:function(v,_){if(this._length!==0)return o(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"format",this).call(this,v,_);for(var j=this,N=0;j!=null&&j.statics.scope!==d.default.Scope.BLOCK_BLOT;)N+=j.offset(j.parent),j=j.parent;j!=null&&(this._length=g.CONTENTS.length,j.optimize(),j.formatAt(N,g.CONTENTS.length,v,_),this._length=0)}},{key:"index",value:function(v,_){return v===this.textNode?0:o(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"index",this).call(this,v,_)}},{key:"length",value:function(){return this._length}},{key:"position",value:function(){return[this.textNode,this.textNode.data.length]}},{key:"remove",value:function(){o(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"remove",this).call(this),this.parent=null}},{key:"restore",value:function(){if(!(this.selection.composing||this.parent==null)){var v=this.textNode,_=this.selection.getNativeRange(),j=void 0,N=void 0,B=void 0;if(_!=null&&_.start.node===v&&_.end.node===v){var E=[v,_.start.offset,_.end.offset];j=E[0],N=E[1],B=E[2]}for(;this.domNode.lastChild!=null&&this.domNode.lastChild!==this.textNode;)this.domNode.parentNode.insertBefore(this.domNode.lastChild,this.domNode);if(this.textNode.data!==g.CONTENTS){var C=this.textNode.data.split(g.CONTENTS).join("");this.next instanceof f.default?(j=this.next.domNode,this.next.insertAt(0,C),this.textNode.data=g.CONTENTS):(this.textNode.data=C,this.parent.insertBefore(d.default.create(this.textNode),this),this.textNode=document.createTextNode(g.CONTENTS),this.domNode.appendChild(this.textNode))}if(this.remove(),N!=null){var k=[N,B].map(function(T){return Math.max(0,Math.min(j.data.length,T-1))}),w=i(k,2);return N=w[0],B=w[1],{startNode:j,startOffset:N,endNode:j,endOffset:B}}}}},{key:"update",value:function(v,_){var j=this;if(v.some(function(B){return B.type==="characterData"&&B.target===j.textNode})){var N=this.restore();N&&(_.range=N)}}},{key:"value",value:function(){return""}}]),g}(d.default.Embed);b.blotName="cursor",b.className="ql-cursor",b.tagName="span",b.CONTENTS="\uFEFF",a.default=b},function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0});var i=s(0),o=d(i),l=s(4),c=d(l);function d(x){return x&&x.__esModule?x:{default:x}}function u(x,p){if(!(x instanceof p))throw new TypeError("Cannot call a class as a function")}function f(x,p){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p&&(typeof p=="object"||typeof p=="function")?p:x}function h(x,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof p);x.prototype=Object.create(p&&p.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(x,p):x.__proto__=p)}var A=function(x){h(p,x);function p(){return u(this,p),f(this,(p.__proto__||Object.getPrototypeOf(p)).apply(this,arguments))}return p}(o.default.Container);A.allowedChildren=[c.default,l.BlockEmbed,A],a.default=A},function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0}),a.ColorStyle=a.ColorClass=a.ColorAttributor=void 0;var i=function(){function b(m,g){for(var y=0;y<g.length;y++){var v=g[y];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(m,v.key,v)}}return function(m,g,y){return g&&b(m.prototype,g),y&&b(m,y),m}}(),o=function b(m,g,y){m===null&&(m=Function.prototype);var v=Object.getOwnPropertyDescriptor(m,g);if(v===void 0){var _=Object.getPrototypeOf(m);return _===null?void 0:b(_,g,y)}else{if("value"in v)return v.value;var j=v.get;return j===void 0?void 0:j.call(y)}},l=s(0),c=d(l);function d(b){return b&&b.__esModule?b:{default:b}}function u(b,m){if(!(b instanceof m))throw new TypeError("Cannot call a class as a function")}function f(b,m){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m&&(typeof m=="object"||typeof m=="function")?m:b}function h(b,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof m);b.prototype=Object.create(m&&m.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),m&&(Object.setPrototypeOf?Object.setPrototypeOf(b,m):b.__proto__=m)}var A=function(b){h(m,b);function m(){return u(this,m),f(this,(m.__proto__||Object.getPrototypeOf(m)).apply(this,arguments))}return i(m,[{key:"value",value:function(y){var v=o(m.prototype.__proto__||Object.getPrototypeOf(m.prototype),"value",this).call(this,y);return v.startsWith("rgb(")?(v=v.replace(/^[^\d]+/,"").replace(/[^\d]+$/,""),"#"+v.split(",").map(function(_){return("00"+parseInt(_).toString(16)).slice(-2)}).join("")):v}}]),m}(c.default.Attributor.Style),x=new c.default.Attributor.Class("color","ql-color",{scope:c.default.Scope.INLINE}),p=new A("color","color",{scope:c.default.Scope.INLINE});a.ColorAttributor=A,a.ColorClass=x,a.ColorStyle=p},function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0}),a.sanitize=a.default=void 0;var i=function(){function p(b,m){for(var g=0;g<m.length;g++){var y=m[g];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(b,y.key,y)}}return function(b,m,g){return m&&p(b.prototype,m),g&&p(b,g),b}}(),o=function p(b,m,g){b===null&&(b=Function.prototype);var y=Object.getOwnPropertyDescriptor(b,m);if(y===void 0){var v=Object.getPrototypeOf(b);return v===null?void 0:p(v,m,g)}else{if("value"in y)return y.value;var _=y.get;return _===void 0?void 0:_.call(g)}},l=s(6),c=d(l);function d(p){return p&&p.__esModule?p:{default:p}}function u(p,b){if(!(p instanceof b))throw new TypeError("Cannot call a class as a function")}function f(p,b){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:p}function h(p,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);p.prototype=Object.create(b&&b.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(p,b):p.__proto__=b)}var A=function(p){h(b,p);function b(){return u(this,b),f(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return i(b,[{key:"format",value:function(g,y){if(g!==this.statics.blotName||!y)return o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"format",this).call(this,g,y);y=this.constructor.sanitize(y),this.domNode.setAttribute("href",y)}}],[{key:"create",value:function(g){var y=o(b.__proto__||Object.getPrototypeOf(b),"create",this).call(this,g);return g=this.sanitize(g),y.setAttribute("href",g),y.setAttribute("rel","noopener noreferrer"),y.setAttribute("target","_blank"),y}},{key:"formats",value:function(g){return g.getAttribute("href")}},{key:"sanitize",value:function(g){return x(g,this.PROTOCOL_WHITELIST)?g:this.SANITIZED_URL}}]),b}(c.default);A.blotName="link",A.tagName="A",A.SANITIZED_URL="about:blank",A.PROTOCOL_WHITELIST=["http","https","mailto","tel"];function x(p,b){var m=document.createElement("a");m.href=p;var g=m.href.slice(0,m.href.indexOf(":"));return b.indexOf(g)>-1}a.default=A,a.sanitize=x},function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0});var i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},o=function(){function b(m,g){for(var y=0;y<g.length;y++){var v=g[y];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(m,v.key,v)}}return function(m,g,y){return g&&b(m.prototype,g),y&&b(m,y),m}}(),l=s(23),c=f(l),d=s(107),u=f(d);function f(b){return b&&b.__esModule?b:{default:b}}function h(b,m){if(!(b instanceof m))throw new TypeError("Cannot call a class as a function")}var A=0;function x(b,m){b.setAttribute(m,b.getAttribute(m)!=="true")}var p=function(){function b(m){var g=this;h(this,b),this.select=m,this.container=document.createElement("span"),this.buildPicker(),this.select.style.display="none",this.select.parentNode.insertBefore(this.container,this.select),this.label.addEventListener("mousedown",function(){g.togglePicker()}),this.label.addEventListener("keydown",function(y){switch(y.keyCode){case c.default.keys.ENTER:g.togglePicker();break;case c.default.keys.ESCAPE:g.escape(),y.preventDefault();break}}),this.select.addEventListener("change",this.update.bind(this))}return o(b,[{key:"togglePicker",value:function(){this.container.classList.toggle("ql-expanded"),x(this.label,"aria-expanded"),x(this.options,"aria-hidden")}},{key:"buildItem",value:function(g){var y=this,v=document.createElement("span");return v.tabIndex="0",v.setAttribute("role","button"),v.classList.add("ql-picker-item"),g.hasAttribute("value")&&v.setAttribute("data-value",g.getAttribute("value")),g.textContent&&v.setAttribute("data-label",g.textContent),v.addEventListener("click",function(){y.selectItem(v,!0)}),v.addEventListener("keydown",function(_){switch(_.keyCode){case c.default.keys.ENTER:y.selectItem(v,!0),_.preventDefault();break;case c.default.keys.ESCAPE:y.escape(),_.preventDefault();break}}),v}},{key:"buildLabel",value:function(){var g=document.createElement("span");return g.classList.add("ql-picker-label"),g.innerHTML=u.default,g.tabIndex="0",g.setAttribute("role","button"),g.setAttribute("aria-expanded","false"),this.container.appendChild(g),g}},{key:"buildOptions",value:function(){var g=this,y=document.createElement("span");y.classList.add("ql-picker-options"),y.setAttribute("aria-hidden","true"),y.tabIndex="-1",y.id="ql-picker-options-"+A,A+=1,this.label.setAttribute("aria-controls",y.id),this.options=y,[].slice.call(this.select.options).forEach(function(v){var _=g.buildItem(v);y.appendChild(_),v.selected===!0&&g.selectItem(_)}),this.container.appendChild(y)}},{key:"buildPicker",value:function(){var g=this;[].slice.call(this.select.attributes).forEach(function(y){g.container.setAttribute(y.name,y.value)}),this.container.classList.add("ql-picker"),this.label=this.buildLabel(),this.buildOptions()}},{key:"escape",value:function(){var g=this;this.close(),setTimeout(function(){return g.label.focus()},1)}},{key:"close",value:function(){this.container.classList.remove("ql-expanded"),this.label.setAttribute("aria-expanded","false"),this.options.setAttribute("aria-hidden","true")}},{key:"selectItem",value:function(g){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,v=this.container.querySelector(".ql-selected");if(g!==v&&(v!=null&&v.classList.remove("ql-selected"),g!=null&&(g.classList.add("ql-selected"),this.select.selectedIndex=[].indexOf.call(g.parentNode.children,g),g.hasAttribute("data-value")?this.label.setAttribute("data-value",g.getAttribute("data-value")):this.label.removeAttribute("data-value"),g.hasAttribute("data-label")?this.label.setAttribute("data-label",g.getAttribute("data-label")):this.label.removeAttribute("data-label"),y))){if(typeof Event=="function")this.select.dispatchEvent(new Event("change"));else if((typeof Event>"u"?"undefined":i(Event))==="object"){var _=document.createEvent("Event");_.initEvent("change",!0,!0),this.select.dispatchEvent(_)}this.close()}}},{key:"update",value:function(){var g=void 0;if(this.select.selectedIndex>-1){var y=this.container.querySelector(".ql-picker-options").children[this.select.selectedIndex];g=this.select.options[this.select.selectedIndex],this.selectItem(y)}else this.selectItem(null);var v=g!=null&&g!==this.select.querySelector("option[selected]");this.label.classList.toggle("ql-active",v)}}]),b}();a.default=p},function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0});var i=s(0),o=q(i),l=s(5),c=q(l),d=s(4),u=q(d),f=s(16),h=q(f),A=s(25),x=q(A),p=s(24),b=q(p),m=s(35),g=q(m),y=s(6),v=q(y),_=s(22),j=q(_),N=s(7),B=q(N),E=s(55),C=q(E),k=s(42),w=q(k),T=s(23),R=q(T);function q(z){return z&&z.__esModule?z:{default:z}}c.default.register({"blots/block":u.default,"blots/block/embed":d.BlockEmbed,"blots/break":h.default,"blots/container":x.default,"blots/cursor":b.default,"blots/embed":g.default,"blots/inline":v.default,"blots/scroll":j.default,"blots/text":B.default,"modules/clipboard":C.default,"modules/history":w.default,"modules/keyboard":R.default}),o.default.register(u.default,h.default,b.default,v.default,j.default,B.default),a.default=c.default},function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0});var i=s(1),o=function(){function l(c){this.domNode=c,this.domNode[i.DATA_KEY]={blot:this}}return Object.defineProperty(l.prototype,"statics",{get:function(){return this.constructor},enumerable:!0,configurable:!0}),l.create=function(c){if(this.tagName==null)throw new i.ParchmentError("Blot definition missing tagName");var d;return Array.isArray(this.tagName)?(typeof c=="string"&&(c=c.toUpperCase(),parseInt(c).toString()===c&&(c=parseInt(c))),typeof c=="number"?d=document.createElement(this.tagName[c-1]):this.tagName.indexOf(c)>-1?d=document.createElement(c):d=document.createElement(this.tagName[0])):d=document.createElement(this.tagName),this.className&&d.classList.add(this.className),d},l.prototype.attach=function(){this.parent!=null&&(this.scroll=this.parent.scroll)},l.prototype.clone=function(){var c=this.domNode.cloneNode(!1);return i.create(c)},l.prototype.detach=function(){this.parent!=null&&this.parent.removeChild(this),delete this.domNode[i.DATA_KEY]},l.prototype.deleteAt=function(c,d){var u=this.isolate(c,d);u.remove()},l.prototype.formatAt=function(c,d,u,f){var h=this.isolate(c,d);if(i.query(u,i.Scope.BLOT)!=null&&f)h.wrap(u,f);else if(i.query(u,i.Scope.ATTRIBUTE)!=null){var A=i.create(this.statics.scope);h.wrap(A),A.format(u,f)}},l.prototype.insertAt=function(c,d,u){var f=u==null?i.create("text",d):i.create(d,u),h=this.split(c);this.parent.insertBefore(f,h)},l.prototype.insertInto=function(c,d){d===void 0&&(d=null),this.parent!=null&&this.parent.children.remove(this);var u=null;c.children.insertBefore(this,d),d!=null&&(u=d.domNode),(this.domNode.parentNode!=c.domNode||this.domNode.nextSibling!=u)&&c.domNode.insertBefore(this.domNode,u),this.parent=c,this.attach()},l.prototype.isolate=function(c,d){var u=this.split(c);return u.split(d),u},l.prototype.length=function(){return 1},l.prototype.offset=function(c){return c===void 0&&(c=this.parent),this.parent==null||this==c?0:this.parent.children.offset(this)+this.parent.offset(c)},l.prototype.optimize=function(c){this.domNode[i.DATA_KEY]!=null&&delete this.domNode[i.DATA_KEY].mutations},l.prototype.remove=function(){this.domNode.parentNode!=null&&this.domNode.parentNode.removeChild(this.domNode),this.detach()},l.prototype.replace=function(c){c.parent!=null&&(c.parent.insertBefore(this,c.next),c.remove())},l.prototype.replaceWith=function(c,d){var u=typeof c=="string"?i.create(c,d):c;return u.replace(this),u},l.prototype.split=function(c,d){return c===0?this:this.next},l.prototype.update=function(c,d){},l.prototype.wrap=function(c,d){var u=typeof c=="string"?i.create(c,d):c;return this.parent!=null&&this.parent.insertBefore(u,this.next),u.appendChild(this),u},l.blotName="abstract",l}();a.default=o},function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0});var i=s(12),o=s(32),l=s(33),c=s(1),d=function(){function u(f){this.attributes={},this.domNode=f,this.build()}return u.prototype.attribute=function(f,h){h?f.add(this.domNode,h)&&(f.value(this.domNode)!=null?this.attributes[f.attrName]=f:delete this.attributes[f.attrName]):(f.remove(this.domNode),delete this.attributes[f.attrName])},u.prototype.build=function(){var f=this;this.attributes={};var h=i.default.keys(this.domNode),A=o.default.keys(this.domNode),x=l.default.keys(this.domNode);h.concat(A).concat(x).forEach(function(p){var b=c.query(p,c.Scope.ATTRIBUTE);b instanceof i.default&&(f.attributes[b.attrName]=b)})},u.prototype.copy=function(f){var h=this;Object.keys(this.attributes).forEach(function(A){var x=h.attributes[A].value(h.domNode);f.format(A,x)})},u.prototype.move=function(f){var h=this;this.copy(f),Object.keys(this.attributes).forEach(function(A){h.attributes[A].remove(h.domNode)}),this.attributes={}},u.prototype.values=function(){var f=this;return Object.keys(this.attributes).reduce(function(h,A){return h[A]=f.attributes[A].value(f.domNode),h},{})},u}();a.default=d},function(r,a,s){var i=this&&this.__extends||function(){var d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,f){u.__proto__=f}||function(u,f){for(var h in f)f.hasOwnProperty(h)&&(u[h]=f[h])};return function(u,f){d(u,f);function h(){this.constructor=u}u.prototype=f===null?Object.create(f):(h.prototype=f.prototype,new h)}}();Object.defineProperty(a,"__esModule",{value:!0});var o=s(12);function l(d,u){var f=d.getAttribute("class")||"";return f.split(/\s+/).filter(function(h){return h.indexOf(u+"-")===0})}var c=function(d){i(u,d);function u(){return d!==null&&d.apply(this,arguments)||this}return u.keys=function(f){return(f.getAttribute("class")||"").split(/\s+/).map(function(h){return h.split("-").slice(0,-1).join("-")})},u.prototype.add=function(f,h){return this.canAdd(f,h)?(this.remove(f),f.classList.add(this.keyName+"-"+h),!0):!1},u.prototype.remove=function(f){var h=l(f,this.keyName);h.forEach(function(A){f.classList.remove(A)}),f.classList.length===0&&f.removeAttribute("class")},u.prototype.value=function(f){var h=l(f,this.keyName)[0]||"",A=h.slice(this.keyName.length+1);return this.canAdd(f,A)?A:""},u}(o.default);a.default=c},function(r,a,s){var i=this&&this.__extends||function(){var d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,f){u.__proto__=f}||function(u,f){for(var h in f)f.hasOwnProperty(h)&&(u[h]=f[h])};return function(u,f){d(u,f);function h(){this.constructor=u}u.prototype=f===null?Object.create(f):(h.prototype=f.prototype,new h)}}();Object.defineProperty(a,"__esModule",{value:!0});var o=s(12);function l(d){var u=d.split("-"),f=u.slice(1).map(function(h){return h[0].toUpperCase()+h.slice(1)}).join("");return u[0]+f}var c=function(d){i(u,d);function u(){return d!==null&&d.apply(this,arguments)||this}return u.keys=function(f){return(f.getAttribute("style")||"").split(";").map(function(h){var A=h.split(":");return A[0].trim()})},u.prototype.add=function(f,h){return this.canAdd(f,h)?(f.style[l(this.keyName)]=h,!0):!1},u.prototype.remove=function(f){f.style[l(this.keyName)]="",f.getAttribute("style")||f.removeAttribute("style")},u.prototype.value=function(f){var h=f.style[l(this.keyName)];return this.canAdd(f,h)?h:""},u}(o.default);a.default=c},function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0});var i=function(){function c(d,u){for(var f=0;f<u.length;f++){var h=u[f];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(d,h.key,h)}}return function(d,u,f){return u&&c(d.prototype,u),f&&c(d,f),d}}();function o(c,d){if(!(c instanceof d))throw new TypeError("Cannot call a class as a function")}var l=function(){function c(d,u){o(this,c),this.quill=d,this.options=u,this.modules={}}return i(c,[{key:"init",value:function(){var u=this;Object.keys(this.options.modules).forEach(function(f){u.modules[f]==null&&u.addModule(f)})}},{key:"addModule",value:function(u){var f=this.quill.constructor.import("modules/"+u);return this.modules[u]=new f(this.quill,this.options.modules[u]||{}),this.modules[u]}}]),c}();l.DEFAULTS={modules:{}},l.themes={default:l},a.default=l},function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0});var i=function(){function m(g,y){for(var v=0;v<y.length;v++){var _=y[v];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(g,_.key,_)}}return function(g,y,v){return y&&m(g.prototype,y),v&&m(g,v),g}}(),o=function m(g,y,v){g===null&&(g=Function.prototype);var _=Object.getOwnPropertyDescriptor(g,y);if(_===void 0){var j=Object.getPrototypeOf(g);return j===null?void 0:m(j,y,v)}else{if("value"in _)return _.value;var N=_.get;return N===void 0?void 0:N.call(v)}},l=s(0),c=f(l),d=s(7),u=f(d);function f(m){return m&&m.__esModule?m:{default:m}}function h(m,g){if(!(m instanceof g))throw new TypeError("Cannot call a class as a function")}function A(m,g){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g&&(typeof g=="object"||typeof g=="function")?g:m}function x(m,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof g);m.prototype=Object.create(g&&g.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(m,g):m.__proto__=g)}var p="\uFEFF",b=function(m){x(g,m);function g(y){h(this,g);var v=A(this,(g.__proto__||Object.getPrototypeOf(g)).call(this,y));return v.contentNode=document.createElement("span"),v.contentNode.setAttribute("contenteditable",!1),[].slice.call(v.domNode.childNodes).forEach(function(_){v.contentNode.appendChild(_)}),v.leftGuard=document.createTextNode(p),v.rightGuard=document.createTextNode(p),v.domNode.appendChild(v.leftGuard),v.domNode.appendChild(v.contentNode),v.domNode.appendChild(v.rightGuard),v}return i(g,[{key:"index",value:function(v,_){return v===this.leftGuard?0:v===this.rightGuard?1:o(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"index",this).call(this,v,_)}},{key:"restore",value:function(v){var _=void 0,j=void 0,N=v.data.split(p).join("");if(v===this.leftGuard)if(this.prev instanceof u.default){var B=this.prev.length();this.prev.insertAt(B,N),_={startNode:this.prev.domNode,startOffset:B+N.length}}else j=document.createTextNode(N),this.parent.insertBefore(c.default.create(j),this),_={startNode:j,startOffset:N.length};else v===this.rightGuard&&(this.next instanceof u.default?(this.next.insertAt(0,N),_={startNode:this.next.domNode,startOffset:N.length}):(j=document.createTextNode(N),this.parent.insertBefore(c.default.create(j),this.next),_={startNode:j,startOffset:N.length}));return v.data=p,_}},{key:"update",value:function(v,_){var j=this;v.forEach(function(N){if(N.type==="characterData"&&(N.target===j.leftGuard||N.target===j.rightGuard)){var B=j.restore(N.target);B&&(_.range=B)}})}}]),g}(c.default.Embed);a.default=b},function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0}),a.AlignStyle=a.AlignClass=a.AlignAttribute=void 0;var i=s(0),o=l(i);function l(h){return h&&h.__esModule?h:{default:h}}var c={scope:o.default.Scope.BLOCK,whitelist:["right","center","justify"]},d=new o.default.Attributor.Attribute("align","align",c),u=new o.default.Attributor.Class("align","ql-align",c),f=new o.default.Attributor.Style("align","text-align",c);a.AlignAttribute=d,a.AlignClass=u,a.AlignStyle=f},function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0}),a.BackgroundStyle=a.BackgroundClass=void 0;var i=s(0),o=c(i),l=s(26);function c(f){return f&&f.__esModule?f:{default:f}}var d=new o.default.Attributor.Class("background","ql-bg",{scope:o.default.Scope.INLINE}),u=new l.ColorAttributor("background","background-color",{scope:o.default.Scope.INLINE});a.BackgroundClass=d,a.BackgroundStyle=u},function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0}),a.DirectionStyle=a.DirectionClass=a.DirectionAttribute=void 0;var i=s(0),o=l(i);function l(h){return h&&h.__esModule?h:{default:h}}var c={scope:o.default.Scope.BLOCK,whitelist:["rtl"]},d=new o.default.Attributor.Attribute("direction","dir",c),u=new o.default.Attributor.Class("direction","ql-direction",c),f=new o.default.Attributor.Style("direction","direction",c);a.DirectionAttribute=d,a.DirectionClass=u,a.DirectionStyle=f},function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0}),a.FontClass=a.FontStyle=void 0;var i=function(){function m(g,y){for(var v=0;v<y.length;v++){var _=y[v];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(g,_.key,_)}}return function(g,y,v){return y&&m(g.prototype,y),v&&m(g,v),g}}(),o=function m(g,y,v){g===null&&(g=Function.prototype);var _=Object.getOwnPropertyDescriptor(g,y);if(_===void 0){var j=Object.getPrototypeOf(g);return j===null?void 0:m(j,y,v)}else{if("value"in _)return _.value;var N=_.get;return N===void 0?void 0:N.call(v)}},l=s(0),c=d(l);function d(m){return m&&m.__esModule?m:{default:m}}function u(m,g){if(!(m instanceof g))throw new TypeError("Cannot call a class as a function")}function f(m,g){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g&&(typeof g=="object"||typeof g=="function")?g:m}function h(m,g){if(typeof g!="function"&&g!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof g);m.prototype=Object.create(g&&g.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(m,g):m.__proto__=g)}var A={scope:c.default.Scope.INLINE,whitelist:["serif","monospace"]},x=new c.default.Attributor.Class("font","ql-font",A),p=function(m){h(g,m);function g(){return u(this,g),f(this,(g.__proto__||Object.getPrototypeOf(g)).apply(this,arguments))}return i(g,[{key:"value",value:function(v){return o(g.prototype.__proto__||Object.getPrototypeOf(g.prototype),"value",this).call(this,v).replace(/["']/g,"")}}]),g}(c.default.Attributor.Style),b=new p("font","font-family",A);a.FontStyle=b,a.FontClass=x},function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0}),a.SizeStyle=a.SizeClass=void 0;var i=s(0),o=l(i);function l(u){return u&&u.__esModule?u:{default:u}}var c=new o.default.Attributor.Class("size","ql-size",{scope:o.default.Scope.INLINE,whitelist:["small","large","huge"]}),d=new o.default.Attributor.Style("size","font-size",{scope:o.default.Scope.INLINE,whitelist:["10px","18px","32px"]});a.SizeClass=c,a.SizeStyle=d},function(r,a,s){r.exports={align:{"":s(76),center:s(77),right:s(78),justify:s(79)},background:s(80),blockquote:s(81),bold:s(82),clean:s(83),code:s(58),"code-block":s(58),color:s(84),direction:{"":s(85),rtl:s(86)},float:{center:s(87),full:s(88),left:s(89),right:s(90)},formula:s(91),header:{1:s(92),2:s(93)},italic:s(94),image:s(95),indent:{"+1":s(96),"-1":s(97)},link:s(98),list:{ordered:s(99),bullet:s(100),check:s(101)},script:{sub:s(102),super:s(103)},strike:s(104),underline:s(105),video:s(106)}},function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0}),a.getLastChangeIndex=a.default=void 0;var i=function(){function y(v,_){for(var j=0;j<_.length;j++){var N=_[j];N.enumerable=N.enumerable||!1,N.configurable=!0,"value"in N&&(N.writable=!0),Object.defineProperty(v,N.key,N)}}return function(v,_,j){return _&&y(v.prototype,_),j&&y(v,j),v}}(),o=s(0),l=h(o),c=s(5),d=h(c),u=s(9),f=h(u);function h(y){return y&&y.__esModule?y:{default:y}}function A(y,v){if(!(y instanceof v))throw new TypeError("Cannot call a class as a function")}function x(y,v){if(!y)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v&&(typeof v=="object"||typeof v=="function")?v:y}function p(y,v){if(typeof v!="function"&&v!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof v);y.prototype=Object.create(v&&v.prototype,{constructor:{value:y,enumerable:!1,writable:!0,configurable:!0}}),v&&(Object.setPrototypeOf?Object.setPrototypeOf(y,v):y.__proto__=v)}var b=function(y){p(v,y);function v(_,j){A(this,v);var N=x(this,(v.__proto__||Object.getPrototypeOf(v)).call(this,_,j));return N.lastRecorded=0,N.ignoreChange=!1,N.clear(),N.quill.on(d.default.events.EDITOR_CHANGE,function(B,E,C,k){B!==d.default.events.TEXT_CHANGE||N.ignoreChange||(!N.options.userOnly||k===d.default.sources.USER?N.record(E,C):N.transform(E))}),N.quill.keyboard.addBinding({key:"Z",shortKey:!0},N.undo.bind(N)),N.quill.keyboard.addBinding({key:"Z",shortKey:!0,shiftKey:!0},N.redo.bind(N)),/Win/i.test(navigator.platform)&&N.quill.keyboard.addBinding({key:"Y",shortKey:!0},N.redo.bind(N)),N}return i(v,[{key:"change",value:function(j,N){if(this.stack[j].length!==0){var B=this.stack[j].pop();this.stack[N].push(B),this.lastRecorded=0,this.ignoreChange=!0,this.quill.updateContents(B[j],d.default.sources.USER),this.ignoreChange=!1;var E=g(B[j]);this.quill.setSelection(E)}}},{key:"clear",value:function(){this.stack={undo:[],redo:[]}}},{key:"cutoff",value:function(){this.lastRecorded=0}},{key:"record",value:function(j,N){if(j.ops.length!==0){this.stack.redo=[];var B=this.quill.getContents().diff(N),E=Date.now();if(this.lastRecorded+this.options.delay>E&&this.stack.undo.length>0){var C=this.stack.undo.pop();B=B.compose(C.undo),j=C.redo.compose(j)}else this.lastRecorded=E;this.stack.undo.push({redo:j,undo:B}),this.stack.undo.length>this.options.maxStack&&this.stack.undo.shift()}}},{key:"redo",value:function(){this.change("redo","undo")}},{key:"transform",value:function(j){this.stack.undo.forEach(function(N){N.undo=j.transform(N.undo,!0),N.redo=j.transform(N.redo,!0)}),this.stack.redo.forEach(function(N){N.undo=j.transform(N.undo,!0),N.redo=j.transform(N.redo,!0)})}},{key:"undo",value:function(){this.change("undo","redo")}}]),v}(f.default);b.DEFAULTS={delay:1e3,maxStack:100,userOnly:!1};function m(y){var v=y.ops[y.ops.length-1];return v==null?!1:v.insert!=null?typeof v.insert=="string"&&v.insert.endsWith(`
`):v.attributes!=null?Object.keys(v.attributes).some(function(_){return l.default.query(_,l.default.Scope.BLOCK)!=null}):!1}function g(y){var v=y.reduce(function(j,N){return j+=N.delete||0,j},0),_=y.length()-v;return m(y)&&(_-=1),_}a.default=b,a.getLastChangeIndex=g},function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0}),a.default=a.BaseTooltip=void 0;var i=function(){function S(D,L){for(var P=0;P<L.length;P++){var I=L[P];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(D,I.key,I)}}return function(D,L,P){return L&&S(D.prototype,L),P&&S(D,P),D}}(),o=function S(D,L,P){D===null&&(D=Function.prototype);var I=Object.getOwnPropertyDescriptor(D,L);if(I===void 0){var H=Object.getPrototypeOf(D);return H===null?void 0:S(H,L,P)}else{if("value"in I)return I.value;var V=I.get;return V===void 0?void 0:V.call(P)}},l=s(3),c=E(l),d=s(2),u=E(d),f=s(8),h=E(f),A=s(23),x=E(A),p=s(34),b=E(p),m=s(59),g=E(m),y=s(60),v=E(y),_=s(28),j=E(_),N=s(61),B=E(N);function E(S){return S&&S.__esModule?S:{default:S}}function C(S,D){if(!(S instanceof D))throw new TypeError("Cannot call a class as a function")}function k(S,D){if(!S)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return D&&(typeof D=="object"||typeof D=="function")?D:S}function w(S,D){if(typeof D!="function"&&D!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof D);S.prototype=Object.create(D&&D.prototype,{constructor:{value:S,enumerable:!1,writable:!0,configurable:!0}}),D&&(Object.setPrototypeOf?Object.setPrototypeOf(S,D):S.__proto__=D)}var T=[!1,"center","right","justify"],R=["#000000","#e60000","#ff9900","#ffff00","#008a00","#0066cc","#9933ff","#ffffff","#facccc","#ffebcc","#ffffcc","#cce8cc","#cce0f5","#ebd6ff","#bbbbbb","#f06666","#ffc266","#ffff66","#66b966","#66a3e0","#c285ff","#888888","#a10000","#b26b00","#b2b200","#006100","#0047b2","#6b24b2","#444444","#5c0000","#663d00","#666600","#003700","#002966","#3d1466"],q=[!1,"serif","monospace"],z=["1","2","3",!1],ee=["small",!1,"large","huge"],Y=function(S){w(D,S);function D(L,P){C(this,D);var I=k(this,(D.__proto__||Object.getPrototypeOf(D)).call(this,L,P)),H=function V(W){if(!document.body.contains(L.root))return document.body.removeEventListener("click",V);I.tooltip!=null&&!I.tooltip.root.contains(W.target)&&document.activeElement!==I.tooltip.textbox&&!I.quill.hasFocus()&&I.tooltip.hide(),I.pickers!=null&&I.pickers.forEach(function(M){M.container.contains(W.target)||M.close()})};return L.emitter.listenDOM("click",document.body,H),I}return i(D,[{key:"addModule",value:function(P){var I=o(D.prototype.__proto__||Object.getPrototypeOf(D.prototype),"addModule",this).call(this,P);return P==="toolbar"&&this.extendToolbar(I),I}},{key:"buildButtons",value:function(P,I){P.forEach(function(H){var V=H.getAttribute("class")||"";V.split(/\s+/).forEach(function(W){if(W.startsWith("ql-")&&(W=W.slice(3),I[W]!=null))if(W==="direction")H.innerHTML=I[W][""]+I[W].rtl;else if(typeof I[W]=="string")H.innerHTML=I[W];else{var M=H.value||"";M!=null&&I[W][M]&&(H.innerHTML=I[W][M])}})})}},{key:"buildPickers",value:function(P,I){var H=this;this.pickers=P.map(function(W){if(W.classList.contains("ql-align"))return W.querySelector("option")==null&&U(W,T),new v.default(W,I.align);if(W.classList.contains("ql-background")||W.classList.contains("ql-color")){var M=W.classList.contains("ql-background")?"background":"color";return W.querySelector("option")==null&&U(W,R,M==="background"?"#ffffff":"#000000"),new g.default(W,I[M])}else return W.querySelector("option")==null&&(W.classList.contains("ql-font")?U(W,q):W.classList.contains("ql-header")?U(W,z):W.classList.contains("ql-size")&&U(W,ee)),new j.default(W)});var V=function(){H.pickers.forEach(function(M){M.update()})};this.quill.on(h.default.events.EDITOR_CHANGE,V)}}]),D}(b.default);Y.DEFAULTS=(0,c.default)(!0,{},b.default.DEFAULTS,{modules:{toolbar:{handlers:{formula:function(){this.quill.theme.tooltip.edit("formula")},image:function(){var D=this,L=this.container.querySelector("input.ql-image[type=file]");L==null&&(L=document.createElement("input"),L.setAttribute("type","file"),L.setAttribute("accept","image/png, image/gif, image/jpeg, image/bmp, image/x-icon"),L.classList.add("ql-image"),L.addEventListener("change",function(){if(L.files!=null&&L.files[0]!=null){var P=new FileReader;P.onload=function(I){var H=D.quill.getSelection(!0);D.quill.updateContents(new u.default().retain(H.index).delete(H.length).insert({image:I.target.result}),h.default.sources.USER),D.quill.setSelection(H.index+1,h.default.sources.SILENT),L.value=""},P.readAsDataURL(L.files[0])}}),this.container.appendChild(L)),L.click()},video:function(){this.quill.theme.tooltip.edit("video")}}}}});var G=function(S){w(D,S);function D(L,P){C(this,D);var I=k(this,(D.__proto__||Object.getPrototypeOf(D)).call(this,L,P));return I.textbox=I.root.querySelector('input[type="text"]'),I.listen(),I}return i(D,[{key:"listen",value:function(){var P=this;this.textbox.addEventListener("keydown",function(I){x.default.match(I,"enter")?(P.save(),I.preventDefault()):x.default.match(I,"escape")&&(P.cancel(),I.preventDefault())})}},{key:"cancel",value:function(){this.hide()}},{key:"edit",value:function(){var P=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"link",I=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;this.root.classList.remove("ql-hidden"),this.root.classList.add("ql-editing"),I!=null?this.textbox.value=I:P!==this.root.getAttribute("data-mode")&&(this.textbox.value=""),this.position(this.quill.getBounds(this.quill.selection.savedRange)),this.textbox.select(),this.textbox.setAttribute("placeholder",this.textbox.getAttribute("data-"+P)||""),this.root.setAttribute("data-mode",P)}},{key:"restoreFocus",value:function(){var P=this.quill.scrollingContainer.scrollTop;this.quill.focus(),this.quill.scrollingContainer.scrollTop=P}},{key:"save",value:function(){var P=this.textbox.value;switch(this.root.getAttribute("data-mode")){case"link":{var I=this.quill.root.scrollTop;this.linkRange?(this.quill.formatText(this.linkRange,"link",P,h.default.sources.USER),delete this.linkRange):(this.restoreFocus(),this.quill.format("link",P,h.default.sources.USER)),this.quill.root.scrollTop=I;break}case"video":P=re(P);case"formula":{if(!P)break;var H=this.quill.getSelection(!0);if(H!=null){var V=H.index+H.length;this.quill.insertEmbed(V,this.root.getAttribute("data-mode"),P,h.default.sources.USER),this.root.getAttribute("data-mode")==="formula"&&this.quill.insertText(V+1," ",h.default.sources.USER),this.quill.setSelection(V+2,h.default.sources.USER)}break}}this.textbox.value="",this.hide()}}]),D}(B.default);function re(S){var D=S.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtube\.com\/watch.*v=([a-zA-Z0-9_-]+)/)||S.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtu\.be\/([a-zA-Z0-9_-]+)/);return D?(D[1]||"https")+"://www.youtube.com/embed/"+D[2]+"?showinfo=0":(D=S.match(/^(?:(https?):\/\/)?(?:www\.)?vimeo\.com\/(\d+)/))?(D[1]||"https")+"://player.vimeo.com/video/"+D[2]+"/":S}function U(S,D){var L=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;D.forEach(function(P){var I=document.createElement("option");P===L?I.setAttribute("selected","selected"):I.setAttribute("value",P),S.appendChild(I)})}a.BaseTooltip=G,a.default=Y},function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0});var i=function(){function o(){this.head=this.tail=null,this.length=0}return o.prototype.append=function(){for(var l=[],c=0;c<arguments.length;c++)l[c]=arguments[c];this.insertBefore(l[0],null),l.length>1&&this.append.apply(this,l.slice(1))},o.prototype.contains=function(l){for(var c,d=this.iterator();c=d();)if(c===l)return!0;return!1},o.prototype.insertBefore=function(l,c){l&&(l.next=c,c!=null?(l.prev=c.prev,c.prev!=null&&(c.prev.next=l),c.prev=l,c===this.head&&(this.head=l)):this.tail!=null?(this.tail.next=l,l.prev=this.tail,this.tail=l):(l.prev=null,this.head=this.tail=l),this.length+=1)},o.prototype.offset=function(l){for(var c=0,d=this.head;d!=null;){if(d===l)return c;c+=d.length(),d=d.next}return-1},o.prototype.remove=function(l){this.contains(l)&&(l.prev!=null&&(l.prev.next=l.next),l.next!=null&&(l.next.prev=l.prev),l===this.head&&(this.head=l.next),l===this.tail&&(this.tail=l.prev),this.length-=1)},o.prototype.iterator=function(l){return l===void 0&&(l=this.head),function(){var c=l;return l!=null&&(l=l.next),c}},o.prototype.find=function(l,c){c===void 0&&(c=!1);for(var d,u=this.iterator();d=u();){var f=d.length();if(l<f||c&&l===f&&(d.next==null||d.next.length()!==0))return[d,l];l-=f}return[null,0]},o.prototype.forEach=function(l){for(var c,d=this.iterator();c=d();)l(c)},o.prototype.forEachAt=function(l,c,d){if(!(c<=0))for(var u=this.find(l),f=u[0],h=u[1],A,x=l-h,p=this.iterator(f);(A=p())&&x<l+c;){var b=A.length();l>x?d(A,l-x,Math.min(c,x+b-l)):d(A,0,Math.min(b,l+c-x)),x+=b}},o.prototype.map=function(l){return this.reduce(function(c,d){return c.push(l(d)),c},[])},o.prototype.reduce=function(l,c){for(var d,u=this.iterator();d=u();)c=l(c,d);return c},o}();a.default=i},function(r,a,s){var i=this&&this.__extends||function(){var f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,A){h.__proto__=A}||function(h,A){for(var x in A)A.hasOwnProperty(x)&&(h[x]=A[x])};return function(h,A){f(h,A);function x(){this.constructor=h}h.prototype=A===null?Object.create(A):(x.prototype=A.prototype,new x)}}();Object.defineProperty(a,"__esModule",{value:!0});var o=s(17),l=s(1),c={attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0},d=100,u=function(f){i(h,f);function h(A){var x=f.call(this,A)||this;return x.scroll=x,x.observer=new MutationObserver(function(p){x.update(p)}),x.observer.observe(x.domNode,c),x.attach(),x}return h.prototype.detach=function(){f.prototype.detach.call(this),this.observer.disconnect()},h.prototype.deleteAt=function(A,x){this.update(),A===0&&x===this.length()?this.children.forEach(function(p){p.remove()}):f.prototype.deleteAt.call(this,A,x)},h.prototype.formatAt=function(A,x,p,b){this.update(),f.prototype.formatAt.call(this,A,x,p,b)},h.prototype.insertAt=function(A,x,p){this.update(),f.prototype.insertAt.call(this,A,x,p)},h.prototype.optimize=function(A,x){var p=this;A===void 0&&(A=[]),x===void 0&&(x={}),f.prototype.optimize.call(this,x);for(var b=[].slice.call(this.observer.takeRecords());b.length>0;)A.push(b.pop());for(var m=function(_,j){j===void 0&&(j=!0),!(_==null||_===p)&&_.domNode.parentNode!=null&&(_.domNode[l.DATA_KEY].mutations==null&&(_.domNode[l.DATA_KEY].mutations=[]),j&&m(_.parent))},g=function(_){_.domNode[l.DATA_KEY]==null||_.domNode[l.DATA_KEY].mutations==null||(_ instanceof o.default&&_.children.forEach(g),_.optimize(x))},y=A,v=0;y.length>0;v+=1){if(v>=d)throw new Error("[Parchment] Maximum optimize iterations reached");for(y.forEach(function(_){var j=l.find(_.target,!0);j!=null&&(j.domNode===_.target&&(_.type==="childList"?(m(l.find(_.previousSibling,!1)),[].forEach.call(_.addedNodes,function(N){var B=l.find(N,!1);m(B,!1),B instanceof o.default&&B.children.forEach(function(E){m(E,!1)})})):_.type==="attributes"&&m(j.prev)),m(j))}),this.children.forEach(g),y=[].slice.call(this.observer.takeRecords()),b=y.slice();b.length>0;)A.push(b.pop())}},h.prototype.update=function(A,x){var p=this;x===void 0&&(x={}),A=A||this.observer.takeRecords(),A.map(function(b){var m=l.find(b.target,!0);return m==null?null:m.domNode[l.DATA_KEY].mutations==null?(m.domNode[l.DATA_KEY].mutations=[b],m):(m.domNode[l.DATA_KEY].mutations.push(b),null)}).forEach(function(b){b==null||b===p||b.domNode[l.DATA_KEY]==null||b.update(b.domNode[l.DATA_KEY].mutations||[],x)}),this.domNode[l.DATA_KEY].mutations!=null&&f.prototype.update.call(this,this.domNode[l.DATA_KEY].mutations,x),this.optimize(A,x)},h.blotName="scroll",h.defaultChild="block",h.scope=l.Scope.BLOCK_BLOT,h.tagName="DIV",h}(o.default);a.default=u},function(r,a,s){var i=this&&this.__extends||function(){var u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,h){f.__proto__=h}||function(f,h){for(var A in h)h.hasOwnProperty(A)&&(f[A]=h[A])};return function(f,h){u(f,h);function A(){this.constructor=f}f.prototype=h===null?Object.create(h):(A.prototype=h.prototype,new A)}}();Object.defineProperty(a,"__esModule",{value:!0});var o=s(18),l=s(1);function c(u,f){if(Object.keys(u).length!==Object.keys(f).length)return!1;for(var h in u)if(u[h]!==f[h])return!1;return!0}var d=function(u){i(f,u);function f(){return u!==null&&u.apply(this,arguments)||this}return f.formats=function(h){if(h.tagName!==f.tagName)return u.formats.call(this,h)},f.prototype.format=function(h,A){var x=this;h===this.statics.blotName&&!A?(this.children.forEach(function(p){p instanceof o.default||(p=p.wrap(f.blotName,!0)),x.attributes.copy(p)}),this.unwrap()):u.prototype.format.call(this,h,A)},f.prototype.formatAt=function(h,A,x,p){if(this.formats()[x]!=null||l.query(x,l.Scope.ATTRIBUTE)){var b=this.isolate(h,A);b.format(x,p)}else u.prototype.formatAt.call(this,h,A,x,p)},f.prototype.optimize=function(h){u.prototype.optimize.call(this,h);var A=this.formats();if(Object.keys(A).length===0)return this.unwrap();var x=this.next;x instanceof f&&x.prev===this&&c(A,x.formats())&&(x.moveChildren(this),x.remove())},f.blotName="inline",f.scope=l.Scope.INLINE_BLOT,f.tagName="SPAN",f}(o.default);a.default=d},function(r,a,s){var i=this&&this.__extends||function(){var d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,f){u.__proto__=f}||function(u,f){for(var h in f)f.hasOwnProperty(h)&&(u[h]=f[h])};return function(u,f){d(u,f);function h(){this.constructor=u}u.prototype=f===null?Object.create(f):(h.prototype=f.prototype,new h)}}();Object.defineProperty(a,"__esModule",{value:!0});var o=s(18),l=s(1),c=function(d){i(u,d);function u(){return d!==null&&d.apply(this,arguments)||this}return u.formats=function(f){var h=l.query(u.blotName).tagName;if(f.tagName!==h)return d.formats.call(this,f)},u.prototype.format=function(f,h){l.query(f,l.Scope.BLOCK)!=null&&(f===this.statics.blotName&&!h?this.replaceWith(u.blotName):d.prototype.format.call(this,f,h))},u.prototype.formatAt=function(f,h,A,x){l.query(A,l.Scope.BLOCK)!=null?this.format(A,x):d.prototype.formatAt.call(this,f,h,A,x)},u.prototype.insertAt=function(f,h,A){if(A==null||l.query(h,l.Scope.INLINE)!=null)d.prototype.insertAt.call(this,f,h,A);else{var x=this.split(f),p=l.create(h,A);x.parent.insertBefore(p,x)}},u.prototype.update=function(f,h){navigator.userAgent.match(/Trident/)?this.build():d.prototype.update.call(this,f,h)},u.blotName="block",u.scope=l.Scope.BLOCK_BLOT,u.tagName="P",u}(o.default);a.default=c},function(r,a,s){var i=this&&this.__extends||function(){var c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,u){d.__proto__=u}||function(d,u){for(var f in u)u.hasOwnProperty(f)&&(d[f]=u[f])};return function(d,u){c(d,u);function f(){this.constructor=d}d.prototype=u===null?Object.create(u):(f.prototype=u.prototype,new f)}}();Object.defineProperty(a,"__esModule",{value:!0});var o=s(19),l=function(c){i(d,c);function d(){return c!==null&&c.apply(this,arguments)||this}return d.formats=function(u){},d.prototype.format=function(u,f){c.prototype.formatAt.call(this,0,this.length(),u,f)},d.prototype.formatAt=function(u,f,h,A){u===0&&f===this.length()?this.format(h,A):c.prototype.formatAt.call(this,u,f,h,A)},d.prototype.formats=function(){return this.statics.formats(this.domNode)},d}(o.default);a.default=l},function(r,a,s){var i=this&&this.__extends||function(){var d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,f){u.__proto__=f}||function(u,f){for(var h in f)f.hasOwnProperty(h)&&(u[h]=f[h])};return function(u,f){d(u,f);function h(){this.constructor=u}u.prototype=f===null?Object.create(f):(h.prototype=f.prototype,new h)}}();Object.defineProperty(a,"__esModule",{value:!0});var o=s(19),l=s(1),c=function(d){i(u,d);function u(f){var h=d.call(this,f)||this;return h.text=h.statics.value(h.domNode),h}return u.create=function(f){return document.createTextNode(f)},u.value=function(f){var h=f.data;return h.normalize&&(h=h.normalize()),h},u.prototype.deleteAt=function(f,h){this.domNode.data=this.text=this.text.slice(0,f)+this.text.slice(f+h)},u.prototype.index=function(f,h){return this.domNode===f?h:-1},u.prototype.insertAt=function(f,h,A){A==null?(this.text=this.text.slice(0,f)+h+this.text.slice(f),this.domNode.data=this.text):d.prototype.insertAt.call(this,f,h,A)},u.prototype.length=function(){return this.text.length},u.prototype.optimize=function(f){d.prototype.optimize.call(this,f),this.text=this.statics.value(this.domNode),this.text.length===0?this.remove():this.next instanceof u&&this.next.prev===this&&(this.insertAt(this.length(),this.next.value()),this.next.remove())},u.prototype.position=function(f,h){return[this.domNode,f]},u.prototype.split=function(f,h){if(h===void 0&&(h=!1),!h){if(f===0)return this;if(f===this.length())return this.next}var A=l.create(this.domNode.splitText(f));return this.parent.insertBefore(A,this.next),this.text=this.statics.value(this.domNode),A},u.prototype.update=function(f,h){var A=this;f.some(function(x){return x.type==="characterData"&&x.target===A.domNode})&&(this.text=this.statics.value(this.domNode))},u.prototype.value=function(){return this.text},u.blotName="text",u.scope=l.Scope.INLINE_BLOT,u}(o.default);a.default=c},function(r,a,s){var i=document.createElement("div");if(i.classList.toggle("test-class",!1),i.classList.contains("test-class")){var o=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(l,c){return arguments.length>1&&!this.contains(l)==!c?c:o.call(this,l)}}String.prototype.startsWith||(String.prototype.startsWith=function(l,c){return c=c||0,this.substr(c,l.length)===l}),String.prototype.endsWith||(String.prototype.endsWith=function(l,c){var d=this.toString();(typeof c!="number"||!isFinite(c)||Math.floor(c)!==c||c>d.length)&&(c=d.length),c-=l.length;var u=d.indexOf(l,c);return u!==-1&&u===c}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(c){if(this===null)throw new TypeError("Array.prototype.find called on null or undefined");if(typeof c!="function")throw new TypeError("predicate must be a function");for(var d=Object(this),u=d.length>>>0,f=arguments[1],h,A=0;A<u;A++)if(h=d[A],c.call(f,h,A,d))return h}}),document.addEventListener("DOMContentLoaded",function(){document.execCommand("enableObjectResizing",!1,!1),document.execCommand("autoUrlDetect",!1,!1)})},function(r,a){var s=-1,i=1,o=0;function l(v,_,j){if(v==_)return v?[[o,v]]:[];(j<0||v.length<j)&&(j=null);var N=f(v,_),B=v.substring(0,N);v=v.substring(N),_=_.substring(N),N=h(v,_);var E=v.substring(v.length-N);v=v.substring(0,v.length-N),_=_.substring(0,_.length-N);var C=c(v,_);return B&&C.unshift([o,B]),E&&C.push([o,E]),x(C),j!=null&&(C=m(C,j)),C=g(C),C}function c(v,_){var j;if(!v)return[[i,_]];if(!_)return[[s,v]];var N=v.length>_.length?v:_,B=v.length>_.length?_:v,E=N.indexOf(B);if(E!=-1)return j=[[i,N.substring(0,E)],[o,B],[i,N.substring(E+B.length)]],v.length>_.length&&(j[0][0]=j[2][0]=s),j;if(B.length==1)return[[s,v],[i,_]];var C=A(v,_);if(C){var k=C[0],w=C[1],T=C[2],R=C[3],q=C[4],z=l(k,T),ee=l(w,R);return z.concat([[o,q]],ee)}return d(v,_)}function d(v,_){for(var j=v.length,N=_.length,B=Math.ceil((j+N)/2),E=B,C=2*B,k=new Array(C),w=new Array(C),T=0;T<C;T++)k[T]=-1,w[T]=-1;k[E+1]=0,w[E+1]=0;for(var R=j-N,q=R%2!=0,z=0,ee=0,Y=0,G=0,re=0;re<B;re++){for(var U=-re+z;U<=re-ee;U+=2){var S=E+U,D;U==-re||U!=re&&k[S-1]<k[S+1]?D=k[S+1]:D=k[S-1]+1;for(var L=D-U;D<j&&L<N&&v.charAt(D)==_.charAt(L);)D++,L++;if(k[S]=D,D>j)ee+=2;else if(L>N)z+=2;else if(q){var P=E+R-U;if(P>=0&&P<C&&w[P]!=-1){var I=j-w[P];if(D>=I)return u(v,_,D,L)}}}for(var H=-re+Y;H<=re-G;H+=2){var P=E+H,I;H==-re||H!=re&&w[P-1]<w[P+1]?I=w[P+1]:I=w[P-1]+1;for(var V=I-H;I<j&&V<N&&v.charAt(j-I-1)==_.charAt(N-V-1);)I++,V++;if(w[P]=I,I>j)G+=2;else if(V>N)Y+=2;else if(!q){var S=E+R-H;if(S>=0&&S<C&&k[S]!=-1){var D=k[S],L=E+D-S;if(I=j-I,D>=I)return u(v,_,D,L)}}}}return[[s,v],[i,_]]}function u(v,_,j,N){var B=v.substring(0,j),E=_.substring(0,N),C=v.substring(j),k=_.substring(N),w=l(B,E),T=l(C,k);return w.concat(T)}function f(v,_){if(!v||!_||v.charAt(0)!=_.charAt(0))return 0;for(var j=0,N=Math.min(v.length,_.length),B=N,E=0;j<B;)v.substring(E,B)==_.substring(E,B)?(j=B,E=j):N=B,B=Math.floor((N-j)/2+j);return B}function h(v,_){if(!v||!_||v.charAt(v.length-1)!=_.charAt(_.length-1))return 0;for(var j=0,N=Math.min(v.length,_.length),B=N,E=0;j<B;)v.substring(v.length-B,v.length-E)==_.substring(_.length-B,_.length-E)?(j=B,E=j):N=B,B=Math.floor((N-j)/2+j);return B}function A(v,_){var j=v.length>_.length?v:_,N=v.length>_.length?_:v;if(j.length<4||N.length*2<j.length)return null;function B(ee,Y,G){for(var re=ee.substring(G,G+Math.floor(ee.length/4)),U=-1,S="",D,L,P,I;(U=Y.indexOf(re,U+1))!=-1;){var H=f(ee.substring(G),Y.substring(U)),V=h(ee.substring(0,G),Y.substring(0,U));S.length<V+H&&(S=Y.substring(U-V,U)+Y.substring(U,U+H),D=ee.substring(0,G-V),L=ee.substring(G+H),P=Y.substring(0,U-V),I=Y.substring(U+H))}return S.length*2>=ee.length?[D,L,P,I,S]:null}var E=B(j,N,Math.ceil(j.length/4)),C=B(j,N,Math.ceil(j.length/2)),k;if(!E&&!C)return null;C?E?k=E[4].length>C[4].length?E:C:k=C:k=E;var w,T,R,q;v.length>_.length?(w=k[0],T=k[1],R=k[2],q=k[3]):(R=k[0],q=k[1],w=k[2],T=k[3]);var z=k[4];return[w,T,R,q,z]}function x(v){v.push([o,""]);for(var _=0,j=0,N=0,B="",E="",C;_<v.length;)switch(v[_][0]){case i:N++,E+=v[_][1],_++;break;case s:j++,B+=v[_][1],_++;break;case o:j+N>1?(j!==0&&N!==0&&(C=f(E,B),C!==0&&(_-j-N>0&&v[_-j-N-1][0]==o?v[_-j-N-1][1]+=E.substring(0,C):(v.splice(0,0,[o,E.substring(0,C)]),_++),E=E.substring(C),B=B.substring(C)),C=h(E,B),C!==0&&(v[_][1]=E.substring(E.length-C)+v[_][1],E=E.substring(0,E.length-C),B=B.substring(0,B.length-C))),j===0?v.splice(_-N,j+N,[i,E]):N===0?v.splice(_-j,j+N,[s,B]):v.splice(_-j-N,j+N,[s,B],[i,E]),_=_-j-N+(j?1:0)+(N?1:0)+1):_!==0&&v[_-1][0]==o?(v[_-1][1]+=v[_][1],v.splice(_,1)):_++,N=0,j=0,B="",E="";break}v[v.length-1][1]===""&&v.pop();var k=!1;for(_=1;_<v.length-1;)v[_-1][0]==o&&v[_+1][0]==o&&(v[_][1].substring(v[_][1].length-v[_-1][1].length)==v[_-1][1]?(v[_][1]=v[_-1][1]+v[_][1].substring(0,v[_][1].length-v[_-1][1].length),v[_+1][1]=v[_-1][1]+v[_+1][1],v.splice(_-1,1),k=!0):v[_][1].substring(0,v[_+1][1].length)==v[_+1][1]&&(v[_-1][1]+=v[_+1][1],v[_][1]=v[_][1].substring(v[_+1][1].length)+v[_+1][1],v.splice(_+1,1),k=!0)),_++;k&&x(v)}var p=l;p.INSERT=i,p.DELETE=s,p.EQUAL=o,r.exports=p;function b(v,_){if(_===0)return[o,v];for(var j=0,N=0;N<v.length;N++){var B=v[N];if(B[0]===s||B[0]===o){var E=j+B[1].length;if(_===E)return[N+1,v];if(_<E){v=v.slice();var C=_-j,k=[B[0],B[1].slice(0,C)],w=[B[0],B[1].slice(C)];return v.splice(N,1,k,w),[N+1,v]}else j=E}}throw new Error("cursor_pos is out of bounds!")}function m(v,_){var j=b(v,_),N=j[1],B=j[0],E=N[B],C=N[B+1];if(E==null)return v;if(E[0]!==o)return v;if(C!=null&&E[1]+C[1]===C[1]+E[1])return N.splice(B,2,C,E),y(N,B,2);if(C!=null&&C[1].indexOf(E[1])===0){N.splice(B,2,[C[0],E[1]],[0,E[1]]);var k=C[1].slice(E[1].length);return k.length>0&&N.splice(B+2,0,[C[0],k]),y(N,B,3)}else return v}function g(v){for(var _=!1,j=function(C){return C.charCodeAt(0)>=56320&&C.charCodeAt(0)<=57343},N=function(C){return C.charCodeAt(C.length-1)>=55296&&C.charCodeAt(C.length-1)<=56319},B=2;B<v.length;B+=1)v[B-2][0]===o&&N(v[B-2][1])&&v[B-1][0]===s&&j(v[B-1][1])&&v[B][0]===i&&j(v[B][1])&&(_=!0,v[B-1][1]=v[B-2][1].slice(-1)+v[B-1][1],v[B][1]=v[B-2][1].slice(-1)+v[B][1],v[B-2][1]=v[B-2][1].slice(0,-1));if(!_)return v;for(var E=[],B=0;B<v.length;B+=1)v[B][1].length>0&&E.push(v[B]);return E}function y(v,_,j){for(var N=_+j-1;N>=0&&N>=_-1;N--)if(N+1<v.length){var B=v[N],E=v[N+1];B[0]===E[1]&&v.splice(N,2,[B[0],B[1]+E[1]])}return v}},function(r,a){a=r.exports=typeof Object.keys=="function"?Object.keys:s,a.shim=s;function s(i){var o=[];for(var l in i)o.push(l);return o}},function(r,a){var s=function(){return Object.prototype.toString.call(arguments)}()=="[object Arguments]";a=r.exports=s?i:o,a.supported=i;function i(l){return Object.prototype.toString.call(l)=="[object Arguments]"}a.unsupported=o;function o(l){return l&&typeof l=="object"&&typeof l.length=="number"&&Object.prototype.hasOwnProperty.call(l,"callee")&&!Object.prototype.propertyIsEnumerable.call(l,"callee")||!1}},function(r,a){var s=Object.prototype.hasOwnProperty,i="~";function o(){}Object.create&&(o.prototype=Object.create(null),new o().__proto__||(i=!1));function l(d,u,f){this.fn=d,this.context=u,this.once=f||!1}function c(){this._events=new o,this._eventsCount=0}c.prototype.eventNames=function(){var u=[],f,h;if(this._eventsCount===0)return u;for(h in f=this._events)s.call(f,h)&&u.push(i?h.slice(1):h);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(f)):u},c.prototype.listeners=function(u,f){var h=i?i+u:u,A=this._events[h];if(f)return!!A;if(!A)return[];if(A.fn)return[A.fn];for(var x=0,p=A.length,b=new Array(p);x<p;x++)b[x]=A[x].fn;return b},c.prototype.emit=function(u,f,h,A,x,p){var b=i?i+u:u;if(!this._events[b])return!1;var m=this._events[b],g=arguments.length,y,v;if(m.fn){switch(m.once&&this.removeListener(u,m.fn,void 0,!0),g){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,f),!0;case 3:return m.fn.call(m.context,f,h),!0;case 4:return m.fn.call(m.context,f,h,A),!0;case 5:return m.fn.call(m.context,f,h,A,x),!0;case 6:return m.fn.call(m.context,f,h,A,x,p),!0}for(v=1,y=new Array(g-1);v<g;v++)y[v-1]=arguments[v];m.fn.apply(m.context,y)}else{var _=m.length,j;for(v=0;v<_;v++)switch(m[v].once&&this.removeListener(u,m[v].fn,void 0,!0),g){case 1:m[v].fn.call(m[v].context);break;case 2:m[v].fn.call(m[v].context,f);break;case 3:m[v].fn.call(m[v].context,f,h);break;case 4:m[v].fn.call(m[v].context,f,h,A);break;default:if(!y)for(j=1,y=new Array(g-1);j<g;j++)y[j-1]=arguments[j];m[v].fn.apply(m[v].context,y)}}return!0},c.prototype.on=function(u,f,h){var A=new l(f,h||this),x=i?i+u:u;return this._events[x]?this._events[x].fn?this._events[x]=[this._events[x],A]:this._events[x].push(A):(this._events[x]=A,this._eventsCount++),this},c.prototype.once=function(u,f,h){var A=new l(f,h||this,!0),x=i?i+u:u;return this._events[x]?this._events[x].fn?this._events[x]=[this._events[x],A]:this._events[x].push(A):(this._events[x]=A,this._eventsCount++),this},c.prototype.removeListener=function(u,f,h,A){var x=i?i+u:u;if(!this._events[x])return this;if(!f)return--this._eventsCount===0?this._events=new o:delete this._events[x],this;var p=this._events[x];if(p.fn)p.fn===f&&(!A||p.once)&&(!h||p.context===h)&&(--this._eventsCount===0?this._events=new o:delete this._events[x]);else{for(var b=0,m=[],g=p.length;b<g;b++)(p[b].fn!==f||A&&!p[b].once||h&&p[b].context!==h)&&m.push(p[b]);m.length?this._events[x]=m.length===1?m[0]:m:--this._eventsCount===0?this._events=new o:delete this._events[x]}return this},c.prototype.removeAllListeners=function(u){var f;return u?(f=i?i+u:u,this._events[f]&&(--this._eventsCount===0?this._events=new o:delete this._events[f])):(this._events=new o,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prototype.setMaxListeners=function(){return this},c.prefixed=i,c.EventEmitter=c,typeof r<"u"&&(r.exports=c)},function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0}),a.matchText=a.matchSpacing=a.matchNewline=a.matchBlot=a.matchAttributor=a.default=void 0;var i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(de){return typeof de}:function(de){return de&&typeof Symbol=="function"&&de.constructor===Symbol&&de!==Symbol.prototype?"symbol":typeof de},o=function(){function de(ye,Le){var we=[],ge=!0,Re=!1,et=void 0;try{for(var Ye=ye[Symbol.iterator](),Be;!(ge=(Be=Ye.next()).done)&&(we.push(Be.value),!(Le&&we.length===Le));ge=!0);}catch(Fe){Re=!0,et=Fe}finally{try{!ge&&Ye.return&&Ye.return()}finally{if(Re)throw et}}return we}return function(ye,Le){if(Array.isArray(ye))return ye;if(Symbol.iterator in Object(ye))return de(ye,Le);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function de(ye,Le){for(var we=0;we<Le.length;we++){var ge=Le[we];ge.enumerable=ge.enumerable||!1,ge.configurable=!0,"value"in ge&&(ge.writable=!0),Object.defineProperty(ye,ge.key,ge)}}return function(ye,Le,we){return Le&&de(ye.prototype,Le),we&&de(ye,we),ye}}(),c=s(3),d=w(c),u=s(2),f=w(u),h=s(0),A=w(h),x=s(5),p=w(x),b=s(10),m=w(b),g=s(9),y=w(g),v=s(36),_=s(37),j=s(13),N=w(j),B=s(26),E=s(38),C=s(39),k=s(40);function w(de){return de&&de.__esModule?de:{default:de}}function T(de,ye,Le){return ye in de?Object.defineProperty(de,ye,{value:Le,enumerable:!0,configurable:!0,writable:!0}):de[ye]=Le,de}function R(de,ye){if(!(de instanceof ye))throw new TypeError("Cannot call a class as a function")}function q(de,ye){if(!de)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ye&&(typeof ye=="object"||typeof ye=="function")?ye:de}function z(de,ye){if(typeof ye!="function"&&ye!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof ye);de.prototype=Object.create(ye&&ye.prototype,{constructor:{value:de,enumerable:!1,writable:!0,configurable:!0}}),ye&&(Object.setPrototypeOf?Object.setPrototypeOf(de,ye):de.__proto__=ye)}var ee=(0,m.default)("quill:clipboard"),Y="__ql-matcher",G=[[Node.TEXT_NODE,_e],[Node.TEXT_NODE,ne],["br",se],[Node.ELEMENT_NODE,ne],[Node.ELEMENT_NODE,M],[Node.ELEMENT_NODE,te],[Node.ELEMENT_NODE,W],[Node.ELEMENT_NODE,ce],["li",he],["b",V.bind(V,"bold")],["i",V.bind(V,"italic")],["style",K]],re=[v.AlignAttribute,E.DirectionAttribute].reduce(function(de,ye){return de[ye.keyName]=ye,de},{}),U=[v.AlignStyle,_.BackgroundStyle,B.ColorStyle,E.DirectionStyle,C.FontStyle,k.SizeStyle].reduce(function(de,ye){return de[ye.keyName]=ye,de},{}),S=function(de){z(ye,de);function ye(Le,we){R(this,ye);var ge=q(this,(ye.__proto__||Object.getPrototypeOf(ye)).call(this,Le,we));return ge.quill.root.addEventListener("paste",ge.onPaste.bind(ge)),ge.container=ge.quill.addContainer("ql-clipboard"),ge.container.setAttribute("contenteditable",!0),ge.container.setAttribute("tabindex",-1),ge.matchers=[],G.concat(ge.options.matchers).forEach(function(Re){var et=o(Re,2),Ye=et[0],Be=et[1];!we.matchVisual&&Be===te||ge.addMatcher(Ye,Be)}),ge}return l(ye,[{key:"addMatcher",value:function(we,ge){this.matchers.push([we,ge])}},{key:"convert",value:function(we){if(typeof we=="string")return this.container.innerHTML=we.replace(/\>\r?\n +\</g,"><"),this.convert();var ge=this.quill.getFormat(this.quill.selection.savedRange.index);if(ge[N.default.blotName]){var Re=this.container.innerText;return this.container.innerHTML="",new f.default().insert(Re,T({},N.default.blotName,ge[N.default.blotName]))}var et=this.prepareMatching(),Ye=o(et,2),Be=Ye[0],Fe=Ye[1],oe=H(this.container,Be,Fe);return P(oe,`
`)&&oe.ops[oe.ops.length-1].attributes==null&&(oe=oe.compose(new f.default().retain(oe.length()-1).delete(1))),ee.log("convert",this.container.innerHTML,oe),this.container.innerHTML="",oe}},{key:"dangerouslyPasteHTML",value:function(we,ge){var Re=arguments.length>2&&arguments[2]!==void 0?arguments[2]:p.default.sources.API;if(typeof we=="string")this.quill.setContents(this.convert(we),ge),this.quill.setSelection(0,p.default.sources.SILENT);else{var et=this.convert(ge);this.quill.updateContents(new f.default().retain(we).concat(et),Re),this.quill.setSelection(we+et.length(),p.default.sources.SILENT)}}},{key:"onPaste",value:function(we){var ge=this;if(!(we.defaultPrevented||!this.quill.isEnabled())){var Re=this.quill.getSelection(),et=new f.default().retain(Re.index),Ye=this.quill.scrollingContainer.scrollTop;this.container.focus(),this.quill.selection.update(p.default.sources.SILENT),setTimeout(function(){et=et.concat(ge.convert()).delete(Re.length),ge.quill.updateContents(et,p.default.sources.USER),ge.quill.setSelection(et.length()-Re.length,p.default.sources.SILENT),ge.quill.scrollingContainer.scrollTop=Ye,ge.quill.focus()},1)}}},{key:"prepareMatching",value:function(){var we=this,ge=[],Re=[];return this.matchers.forEach(function(et){var Ye=o(et,2),Be=Ye[0],Fe=Ye[1];switch(Be){case Node.TEXT_NODE:Re.push(Fe);break;case Node.ELEMENT_NODE:ge.push(Fe);break;default:[].forEach.call(we.container.querySelectorAll(Be),function(oe){oe[Y]=oe[Y]||[],oe[Y].push(Fe)});break}}),[ge,Re]}}]),ye}(y.default);S.DEFAULTS={matchers:[],matchVisual:!0};function D(de,ye,Le){return(typeof ye>"u"?"undefined":i(ye))==="object"?Object.keys(ye).reduce(function(we,ge){return D(we,ge,ye[ge])},de):de.reduce(function(we,ge){return ge.attributes&&ge.attributes[ye]?we.push(ge):we.insert(ge.insert,(0,d.default)({},T({},ye,Le),ge.attributes))},new f.default)}function L(de){if(de.nodeType!==Node.ELEMENT_NODE)return{};var ye="__ql-computed-style";return de[ye]||(de[ye]=window.getComputedStyle(de))}function P(de,ye){for(var Le="",we=de.ops.length-1;we>=0&&Le.length<ye.length;--we){var ge=de.ops[we];if(typeof ge.insert!="string")break;Le=ge.insert+Le}return Le.slice(-1*ye.length)===ye}function I(de){if(de.childNodes.length===0)return!1;var ye=L(de);return["block","list-item"].indexOf(ye.display)>-1}function H(de,ye,Le){return de.nodeType===de.TEXT_NODE?Le.reduce(function(we,ge){return ge(de,we)},new f.default):de.nodeType===de.ELEMENT_NODE?[].reduce.call(de.childNodes||[],function(we,ge){var Re=H(ge,ye,Le);return ge.nodeType===de.ELEMENT_NODE&&(Re=ye.reduce(function(et,Ye){return Ye(ge,et)},Re),Re=(ge[Y]||[]).reduce(function(et,Ye){return Ye(ge,et)},Re)),we.concat(Re)},new f.default):new f.default}function V(de,ye,Le){return D(Le,de,!0)}function W(de,ye){var Le=A.default.Attributor.Attribute.keys(de),we=A.default.Attributor.Class.keys(de),ge=A.default.Attributor.Style.keys(de),Re={};return Le.concat(we).concat(ge).forEach(function(et){var Ye=A.default.query(et,A.default.Scope.ATTRIBUTE);Ye!=null&&(Re[Ye.attrName]=Ye.value(de),Re[Ye.attrName])||(Ye=re[et],Ye!=null&&(Ye.attrName===et||Ye.keyName===et)&&(Re[Ye.attrName]=Ye.value(de)||void 0),Ye=U[et],Ye!=null&&(Ye.attrName===et||Ye.keyName===et)&&(Ye=U[et],Re[Ye.attrName]=Ye.value(de)||void 0))}),Object.keys(Re).length>0&&(ye=D(ye,Re)),ye}function M(de,ye){var Le=A.default.query(de);if(Le==null)return ye;if(Le.prototype instanceof A.default.Embed){var we={},ge=Le.value(de);ge!=null&&(we[Le.blotName]=ge,ye=new f.default().insert(we,Le.formats(de)))}else typeof Le.formats=="function"&&(ye=D(ye,Le.blotName,Le.formats(de)));return ye}function se(de,ye){return P(ye,`
`)||ye.insert(`
`),ye}function K(){return new f.default}function he(de,ye){var Le=A.default.query(de);if(Le==null||Le.blotName!=="list-item"||!P(ye,`
`))return ye;for(var we=-1,ge=de.parentNode;!ge.classList.contains("ql-clipboard");)(A.default.query(ge)||{}).blotName==="list"&&(we+=1),ge=ge.parentNode;return we<=0?ye:ye.compose(new f.default().retain(ye.length()-1).retain(1,{indent:we}))}function ne(de,ye){return P(ye,`
`)||(I(de)||ye.length()>0&&de.nextSibling&&I(de.nextSibling))&&ye.insert(`
`),ye}function te(de,ye){if(I(de)&&de.nextElementSibling!=null&&!P(ye,`

`)){var Le=de.offsetHeight+parseFloat(L(de).marginTop)+parseFloat(L(de).marginBottom);de.nextElementSibling.offsetTop>de.offsetTop+Le*1.5&&ye.insert(`
`)}return ye}function ce(de,ye){var Le={},we=de.style||{};return we.fontStyle&&L(de).fontStyle==="italic"&&(Le.italic=!0),we.fontWeight&&(L(de).fontWeight.startsWith("bold")||parseInt(L(de).fontWeight)>=700)&&(Le.bold=!0),Object.keys(Le).length>0&&(ye=D(ye,Le)),parseFloat(we.textIndent||0)>0&&(ye=new f.default().insert("	").concat(ye)),ye}function _e(de,ye){var Le=de.data;if(de.parentNode.tagName==="O:P")return ye.insert(Le.trim());if(Le.trim().length===0&&de.parentNode.classList.contains("ql-clipboard"))return ye;if(!L(de.parentNode).whiteSpace.startsWith("pre")){var we=function(Re,et){return et=et.replace(/[^\u00a0]/g,""),et.length<1&&Re?" ":et};Le=Le.replace(/\r\n/g," ").replace(/\n/g," "),Le=Le.replace(/\s\s+/g,we.bind(we,!0)),(de.previousSibling==null&&I(de.parentNode)||de.previousSibling!=null&&I(de.previousSibling))&&(Le=Le.replace(/^\s+/,we.bind(we,!1))),(de.nextSibling==null&&I(de.parentNode)||de.nextSibling!=null&&I(de.nextSibling))&&(Le=Le.replace(/\s+$/,we.bind(we,!1)))}return ye.insert(Le)}a.default=S,a.matchAttributor=W,a.matchBlot=M,a.matchNewline=ne,a.matchSpacing=te,a.matchText=_e},function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0});var i=function(){function x(p,b){for(var m=0;m<b.length;m++){var g=b[m];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(p,g.key,g)}}return function(p,b,m){return b&&x(p.prototype,b),m&&x(p,m),p}}(),o=function x(p,b,m){p===null&&(p=Function.prototype);var g=Object.getOwnPropertyDescriptor(p,b);if(g===void 0){var y=Object.getPrototypeOf(p);return y===null?void 0:x(y,b,m)}else{if("value"in g)return g.value;var v=g.get;return v===void 0?void 0:v.call(m)}},l=s(6),c=d(l);function d(x){return x&&x.__esModule?x:{default:x}}function u(x,p){if(!(x instanceof p))throw new TypeError("Cannot call a class as a function")}function f(x,p){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p&&(typeof p=="object"||typeof p=="function")?p:x}function h(x,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof p);x.prototype=Object.create(p&&p.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(x,p):x.__proto__=p)}var A=function(x){h(p,x);function p(){return u(this,p),f(this,(p.__proto__||Object.getPrototypeOf(p)).apply(this,arguments))}return i(p,[{key:"optimize",value:function(m){o(p.prototype.__proto__||Object.getPrototypeOf(p.prototype),"optimize",this).call(this,m),this.domNode.tagName!==this.statics.tagName[0]&&this.replaceWith(this.statics.blotName)}}],[{key:"create",value:function(){return o(p.__proto__||Object.getPrototypeOf(p),"create",this).call(this)}},{key:"formats",value:function(){return!0}}]),p}(c.default);A.blotName="bold",A.tagName=["STRONG","B"],a.default=A},function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0}),a.addControls=a.default=void 0;var i=function(){function k(w,T){var R=[],q=!0,z=!1,ee=void 0;try{for(var Y=w[Symbol.iterator](),G;!(q=(G=Y.next()).done)&&(R.push(G.value),!(T&&R.length===T));q=!0);}catch(re){z=!0,ee=re}finally{try{!q&&Y.return&&Y.return()}finally{if(z)throw ee}}return R}return function(w,T){if(Array.isArray(w))return w;if(Symbol.iterator in Object(w))return k(w,T);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function k(w,T){for(var R=0;R<T.length;R++){var q=T[R];q.enumerable=q.enumerable||!1,q.configurable=!0,"value"in q&&(q.writable=!0),Object.defineProperty(w,q.key,q)}}return function(w,T,R){return T&&k(w.prototype,T),R&&k(w,R),w}}(),l=s(2),c=m(l),d=s(0),u=m(d),f=s(5),h=m(f),A=s(10),x=m(A),p=s(9),b=m(p);function m(k){return k&&k.__esModule?k:{default:k}}function g(k,w,T){return w in k?Object.defineProperty(k,w,{value:T,enumerable:!0,configurable:!0,writable:!0}):k[w]=T,k}function y(k,w){if(!(k instanceof w))throw new TypeError("Cannot call a class as a function")}function v(k,w){if(!k)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w&&(typeof w=="object"||typeof w=="function")?w:k}function _(k,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof w);k.prototype=Object.create(w&&w.prototype,{constructor:{value:k,enumerable:!1,writable:!0,configurable:!0}}),w&&(Object.setPrototypeOf?Object.setPrototypeOf(k,w):k.__proto__=w)}var j=(0,x.default)("quill:toolbar"),N=function(k){_(w,k);function w(T,R){y(this,w);var q=v(this,(w.__proto__||Object.getPrototypeOf(w)).call(this,T,R));if(Array.isArray(q.options.container)){var z=document.createElement("div");E(z,q.options.container),T.container.parentNode.insertBefore(z,T.container),q.container=z}else typeof q.options.container=="string"?q.container=document.querySelector(q.options.container):q.container=q.options.container;if(!(q.container instanceof HTMLElement)){var ee;return ee=j.error("Container required for toolbar",q.options),v(q,ee)}return q.container.classList.add("ql-toolbar"),q.controls=[],q.handlers={},Object.keys(q.options.handlers).forEach(function(Y){q.addHandler(Y,q.options.handlers[Y])}),[].forEach.call(q.container.querySelectorAll("button, select"),function(Y){q.attach(Y)}),q.quill.on(h.default.events.EDITOR_CHANGE,function(Y,G){Y===h.default.events.SELECTION_CHANGE&&q.update(G)}),q.quill.on(h.default.events.SCROLL_OPTIMIZE,function(){var Y=q.quill.selection.getRange(),G=i(Y,1),re=G[0];q.update(re)}),q}return o(w,[{key:"addHandler",value:function(R,q){this.handlers[R]=q}},{key:"attach",value:function(R){var q=this,z=[].find.call(R.classList,function(Y){return Y.indexOf("ql-")===0});if(z){if(z=z.slice(3),R.tagName==="BUTTON"&&R.setAttribute("type","button"),this.handlers[z]==null){if(this.quill.scroll.whitelist!=null&&this.quill.scroll.whitelist[z]==null){j.warn("ignoring attaching to disabled format",z,R);return}if(u.default.query(z)==null){j.warn("ignoring attaching to nonexistent format",z,R);return}}var ee=R.tagName==="SELECT"?"change":"click";R.addEventListener(ee,function(Y){var G=void 0;if(R.tagName==="SELECT"){if(R.selectedIndex<0)return;var re=R.options[R.selectedIndex];re.hasAttribute("selected")?G=!1:G=re.value||!1}else R.classList.contains("ql-active")?G=!1:G=R.value||!R.hasAttribute("value"),Y.preventDefault();q.quill.focus();var U=q.quill.selection.getRange(),S=i(U,1),D=S[0];if(q.handlers[z]!=null)q.handlers[z].call(q,G);else if(u.default.query(z).prototype instanceof u.default.Embed){if(G=prompt("Enter "+z),!G)return;q.quill.updateContents(new c.default().retain(D.index).delete(D.length).insert(g({},z,G)),h.default.sources.USER)}else q.quill.format(z,G,h.default.sources.USER);q.update(D)}),this.controls.push([z,R])}}},{key:"update",value:function(R){var q=R==null?{}:this.quill.getFormat(R);this.controls.forEach(function(z){var ee=i(z,2),Y=ee[0],G=ee[1];if(G.tagName==="SELECT"){var re=void 0;if(R==null)re=null;else if(q[Y]==null)re=G.querySelector("option[selected]");else if(!Array.isArray(q[Y])){var U=q[Y];typeof U=="string"&&(U=U.replace(/\"/g,'\\"')),re=G.querySelector('option[value="'+U+'"]')}re==null?(G.value="",G.selectedIndex=-1):re.selected=!0}else if(R==null)G.classList.remove("ql-active");else if(G.hasAttribute("value")){var S=q[Y]===G.getAttribute("value")||q[Y]!=null&&q[Y].toString()===G.getAttribute("value")||q[Y]==null&&!G.getAttribute("value");G.classList.toggle("ql-active",S)}else G.classList.toggle("ql-active",q[Y]!=null)})}}]),w}(b.default);N.DEFAULTS={};function B(k,w,T){var R=document.createElement("button");R.setAttribute("type","button"),R.classList.add("ql-"+w),T!=null&&(R.value=T),k.appendChild(R)}function E(k,w){Array.isArray(w[0])||(w=[w]),w.forEach(function(T){var R=document.createElement("span");R.classList.add("ql-formats"),T.forEach(function(q){if(typeof q=="string")B(R,q);else{var z=Object.keys(q)[0],ee=q[z];Array.isArray(ee)?C(R,z,ee):B(R,z,ee)}}),k.appendChild(R)})}function C(k,w,T){var R=document.createElement("select");R.classList.add("ql-"+w),T.forEach(function(q){var z=document.createElement("option");q!==!1?z.setAttribute("value",q):z.setAttribute("selected","selected"),R.appendChild(z)}),k.appendChild(R)}N.DEFAULTS={container:null,handlers:{clean:function(){var w=this,T=this.quill.getSelection();if(T!=null)if(T.length==0){var R=this.quill.getFormat();Object.keys(R).forEach(function(q){u.default.query(q,u.default.Scope.INLINE)!=null&&w.quill.format(q,!1)})}else this.quill.removeFormat(T,h.default.sources.USER)},direction:function(w){var T=this.quill.getFormat().align;w==="rtl"&&T==null?this.quill.format("align","right",h.default.sources.USER):!w&&T==="right"&&this.quill.format("align",!1,h.default.sources.USER),this.quill.format("direction",w,h.default.sources.USER)},indent:function(w){var T=this.quill.getSelection(),R=this.quill.getFormat(T),q=parseInt(R.indent||0);if(w==="+1"||w==="-1"){var z=w==="+1"?1:-1;R.direction==="rtl"&&(z*=-1),this.quill.format("indent",q+z,h.default.sources.USER)}},link:function(w){w===!0&&(w=prompt("Enter link URL:")),this.quill.format("link",w,h.default.sources.USER)},list:function(w){var T=this.quill.getSelection(),R=this.quill.getFormat(T);w==="check"?R.list==="checked"||R.list==="unchecked"?this.quill.format("list",!1,h.default.sources.USER):this.quill.format("list","unchecked",h.default.sources.USER):this.quill.format("list",w,h.default.sources.USER)}}},a.default=N,a.addControls=E},function(r,a){r.exports='<svg viewbox="0 0 18 18"> <polyline class="ql-even ql-stroke" points="5 7 3 9 5 11"></polyline> <polyline class="ql-even ql-stroke" points="13 7 15 9 13 11"></polyline> <line class=ql-stroke x1=10 x2=8 y1=5 y2=13></line> </svg>'},function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0});var i=function(){function x(p,b){for(var m=0;m<b.length;m++){var g=b[m];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(p,g.key,g)}}return function(p,b,m){return b&&x(p.prototype,b),m&&x(p,m),p}}(),o=function x(p,b,m){p===null&&(p=Function.prototype);var g=Object.getOwnPropertyDescriptor(p,b);if(g===void 0){var y=Object.getPrototypeOf(p);return y===null?void 0:x(y,b,m)}else{if("value"in g)return g.value;var v=g.get;return v===void 0?void 0:v.call(m)}},l=s(28),c=d(l);function d(x){return x&&x.__esModule?x:{default:x}}function u(x,p){if(!(x instanceof p))throw new TypeError("Cannot call a class as a function")}function f(x,p){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p&&(typeof p=="object"||typeof p=="function")?p:x}function h(x,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof p);x.prototype=Object.create(p&&p.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(x,p):x.__proto__=p)}var A=function(x){h(p,x);function p(b,m){u(this,p);var g=f(this,(p.__proto__||Object.getPrototypeOf(p)).call(this,b));return g.label.innerHTML=m,g.container.classList.add("ql-color-picker"),[].slice.call(g.container.querySelectorAll(".ql-picker-item"),0,7).forEach(function(y){y.classList.add("ql-primary")}),g}return i(p,[{key:"buildItem",value:function(m){var g=o(p.prototype.__proto__||Object.getPrototypeOf(p.prototype),"buildItem",this).call(this,m);return g.style.backgroundColor=m.getAttribute("value")||"",g}},{key:"selectItem",value:function(m,g){o(p.prototype.__proto__||Object.getPrototypeOf(p.prototype),"selectItem",this).call(this,m,g);var y=this.label.querySelector(".ql-color-label"),v=m&&m.getAttribute("data-value")||"";y&&(y.tagName==="line"?y.style.stroke=v:y.style.fill=v)}}]),p}(c.default);a.default=A},function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0});var i=function(){function x(p,b){for(var m=0;m<b.length;m++){var g=b[m];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(p,g.key,g)}}return function(p,b,m){return b&&x(p.prototype,b),m&&x(p,m),p}}(),o=function x(p,b,m){p===null&&(p=Function.prototype);var g=Object.getOwnPropertyDescriptor(p,b);if(g===void 0){var y=Object.getPrototypeOf(p);return y===null?void 0:x(y,b,m)}else{if("value"in g)return g.value;var v=g.get;return v===void 0?void 0:v.call(m)}},l=s(28),c=d(l);function d(x){return x&&x.__esModule?x:{default:x}}function u(x,p){if(!(x instanceof p))throw new TypeError("Cannot call a class as a function")}function f(x,p){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p&&(typeof p=="object"||typeof p=="function")?p:x}function h(x,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof p);x.prototype=Object.create(p&&p.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(x,p):x.__proto__=p)}var A=function(x){h(p,x);function p(b,m){u(this,p);var g=f(this,(p.__proto__||Object.getPrototypeOf(p)).call(this,b));return g.container.classList.add("ql-icon-picker"),[].forEach.call(g.container.querySelectorAll(".ql-picker-item"),function(y){y.innerHTML=m[y.getAttribute("data-value")||""]}),g.defaultItem=g.container.querySelector(".ql-selected"),g.selectItem(g.defaultItem),g}return i(p,[{key:"selectItem",value:function(m,g){o(p.prototype.__proto__||Object.getPrototypeOf(p.prototype),"selectItem",this).call(this,m,g),m=m||this.defaultItem,this.label.innerHTML=m.innerHTML}}]),p}(c.default);a.default=A},function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0});var i=function(){function c(d,u){for(var f=0;f<u.length;f++){var h=u[f];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(d,h.key,h)}}return function(d,u,f){return u&&c(d.prototype,u),f&&c(d,f),d}}();function o(c,d){if(!(c instanceof d))throw new TypeError("Cannot call a class as a function")}var l=function(){function c(d,u){var f=this;o(this,c),this.quill=d,this.boundsContainer=u||document.body,this.root=d.addContainer("ql-tooltip"),this.root.innerHTML=this.constructor.TEMPLATE,this.quill.root===this.quill.scrollingContainer&&this.quill.root.addEventListener("scroll",function(){f.root.style.marginTop=-1*f.quill.root.scrollTop+"px"}),this.hide()}return i(c,[{key:"hide",value:function(){this.root.classList.add("ql-hidden")}},{key:"position",value:function(u){var f=u.left+u.width/2-this.root.offsetWidth/2,h=u.bottom+this.quill.root.scrollTop;this.root.style.left=f+"px",this.root.style.top=h+"px",this.root.classList.remove("ql-flip");var A=this.boundsContainer.getBoundingClientRect(),x=this.root.getBoundingClientRect(),p=0;if(x.right>A.right&&(p=A.right-x.right,this.root.style.left=f+p+"px"),x.left<A.left&&(p=A.left-x.left,this.root.style.left=f+p+"px"),x.bottom>A.bottom){var b=x.bottom-x.top,m=u.bottom-u.top+b;this.root.style.top=h-m+"px",this.root.classList.add("ql-flip")}return p}},{key:"show",value:function(){this.root.classList.remove("ql-editing"),this.root.classList.remove("ql-hidden")}}]),c}();a.default=l},function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0});var i=function(){function C(k,w){var T=[],R=!0,q=!1,z=void 0;try{for(var ee=k[Symbol.iterator](),Y;!(R=(Y=ee.next()).done)&&(T.push(Y.value),!(w&&T.length===w));R=!0);}catch(G){q=!0,z=G}finally{try{!R&&ee.return&&ee.return()}finally{if(q)throw z}}return T}return function(k,w){if(Array.isArray(k))return k;if(Symbol.iterator in Object(k))return C(k,w);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function C(k,w,T){k===null&&(k=Function.prototype);var R=Object.getOwnPropertyDescriptor(k,w);if(R===void 0){var q=Object.getPrototypeOf(k);return q===null?void 0:C(q,w,T)}else{if("value"in R)return R.value;var z=R.get;return z===void 0?void 0:z.call(T)}},l=function(){function C(k,w){for(var T=0;T<w.length;T++){var R=w[T];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(k,R.key,R)}}return function(k,w,T){return w&&C(k.prototype,w),T&&C(k,T),k}}(),c=s(3),d=y(c),u=s(8),f=y(u),h=s(43),A=y(h),x=s(27),p=y(x),b=s(15),m=s(41),g=y(m);function y(C){return C&&C.__esModule?C:{default:C}}function v(C,k){if(!(C instanceof k))throw new TypeError("Cannot call a class as a function")}function _(C,k){if(!C)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return k&&(typeof k=="object"||typeof k=="function")?k:C}function j(C,k){if(typeof k!="function"&&k!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof k);C.prototype=Object.create(k&&k.prototype,{constructor:{value:C,enumerable:!1,writable:!0,configurable:!0}}),k&&(Object.setPrototypeOf?Object.setPrototypeOf(C,k):C.__proto__=k)}var N=[[{header:["1","2","3",!1]}],["bold","italic","underline","link"],[{list:"ordered"},{list:"bullet"}],["clean"]],B=function(C){j(k,C);function k(w,T){v(this,k),T.modules.toolbar!=null&&T.modules.toolbar.container==null&&(T.modules.toolbar.container=N);var R=_(this,(k.__proto__||Object.getPrototypeOf(k)).call(this,w,T));return R.quill.container.classList.add("ql-snow"),R}return l(k,[{key:"extendToolbar",value:function(T){T.container.classList.add("ql-snow"),this.buildButtons([].slice.call(T.container.querySelectorAll("button")),g.default),this.buildPickers([].slice.call(T.container.querySelectorAll("select")),g.default),this.tooltip=new E(this.quill,this.options.bounds),T.container.querySelector(".ql-link")&&this.quill.keyboard.addBinding({key:"K",shortKey:!0},function(R,q){T.handlers.link.call(T,!q.format.link)})}}]),k}(A.default);B.DEFAULTS=(0,d.default)(!0,{},A.default.DEFAULTS,{modules:{toolbar:{handlers:{link:function(k){if(k){var w=this.quill.getSelection();if(w==null||w.length==0)return;var T=this.quill.getText(w);/^\S+@\S+\.\S+$/.test(T)&&T.indexOf("mailto:")!==0&&(T="mailto:"+T);var R=this.quill.theme.tooltip;R.edit("link",T)}else this.quill.format("link",!1)}}}}});var E=function(C){j(k,C);function k(w,T){v(this,k);var R=_(this,(k.__proto__||Object.getPrototypeOf(k)).call(this,w,T));return R.preview=R.root.querySelector("a.ql-preview"),R}return l(k,[{key:"listen",value:function(){var T=this;o(k.prototype.__proto__||Object.getPrototypeOf(k.prototype),"listen",this).call(this),this.root.querySelector("a.ql-action").addEventListener("click",function(R){T.root.classList.contains("ql-editing")?T.save():T.edit("link",T.preview.textContent),R.preventDefault()}),this.root.querySelector("a.ql-remove").addEventListener("click",function(R){if(T.linkRange!=null){var q=T.linkRange;T.restoreFocus(),T.quill.formatText(q,"link",!1,f.default.sources.USER),delete T.linkRange}R.preventDefault(),T.hide()}),this.quill.on(f.default.events.SELECTION_CHANGE,function(R,q,z){if(R!=null){if(R.length===0&&z===f.default.sources.USER){var ee=T.quill.scroll.descendant(p.default,R.index),Y=i(ee,2),G=Y[0],re=Y[1];if(G!=null){T.linkRange=new b.Range(R.index-re,G.length());var U=p.default.formats(G.domNode);T.preview.textContent=U,T.preview.setAttribute("href",U),T.show(),T.position(T.quill.getBounds(T.linkRange));return}}else delete T.linkRange;T.hide()}})}},{key:"show",value:function(){o(k.prototype.__proto__||Object.getPrototypeOf(k.prototype),"show",this).call(this),this.root.removeAttribute("data-mode")}}]),k}(h.BaseTooltip);E.TEMPLATE=['<a class="ql-preview" rel="noopener noreferrer" target="_blank" href="about:blank"></a>','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-action"></a>','<a class="ql-remove"></a>'].join(""),a.default=B},function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0});var i=s(29),o=ge(i),l=s(36),c=s(38),d=s(64),u=s(65),f=ge(u),h=s(66),A=ge(h),x=s(67),p=ge(x),b=s(37),m=s(26),g=s(39),y=s(40),v=s(56),_=ge(v),j=s(68),N=ge(j),B=s(27),E=ge(B),C=s(69),k=ge(C),w=s(70),T=ge(w),R=s(71),q=ge(R),z=s(72),ee=ge(z),Y=s(73),G=ge(Y),re=s(13),U=ge(re),S=s(74),D=ge(S),L=s(75),P=ge(L),I=s(57),H=ge(I),V=s(41),W=ge(V),M=s(28),se=ge(M),K=s(59),he=ge(K),ne=s(60),te=ge(ne),ce=s(61),_e=ge(ce),de=s(108),ye=ge(de),Le=s(62),we=ge(Le);function ge(Re){return Re&&Re.__esModule?Re:{default:Re}}o.default.register({"attributors/attribute/direction":c.DirectionAttribute,"attributors/class/align":l.AlignClass,"attributors/class/background":b.BackgroundClass,"attributors/class/color":m.ColorClass,"attributors/class/direction":c.DirectionClass,"attributors/class/font":g.FontClass,"attributors/class/size":y.SizeClass,"attributors/style/align":l.AlignStyle,"attributors/style/background":b.BackgroundStyle,"attributors/style/color":m.ColorStyle,"attributors/style/direction":c.DirectionStyle,"attributors/style/font":g.FontStyle,"attributors/style/size":y.SizeStyle},!0),o.default.register({"formats/align":l.AlignClass,"formats/direction":c.DirectionClass,"formats/indent":d.IndentClass,"formats/background":b.BackgroundStyle,"formats/color":m.ColorStyle,"formats/font":g.FontClass,"formats/size":y.SizeClass,"formats/blockquote":f.default,"formats/code-block":U.default,"formats/header":A.default,"formats/list":p.default,"formats/bold":_.default,"formats/code":re.Code,"formats/italic":N.default,"formats/link":E.default,"formats/script":k.default,"formats/strike":T.default,"formats/underline":q.default,"formats/image":ee.default,"formats/video":G.default,"formats/list/item":x.ListItem,"modules/formula":D.default,"modules/syntax":P.default,"modules/toolbar":H.default,"themes/bubble":ye.default,"themes/snow":we.default,"ui/icons":W.default,"ui/picker":se.default,"ui/icon-picker":te.default,"ui/color-picker":he.default,"ui/tooltip":_e.default},!0),a.default=o.default},function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0}),a.IndentClass=void 0;var i=function(){function p(b,m){for(var g=0;g<m.length;g++){var y=m[g];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(b,y.key,y)}}return function(b,m,g){return m&&p(b.prototype,m),g&&p(b,g),b}}(),o=function p(b,m,g){b===null&&(b=Function.prototype);var y=Object.getOwnPropertyDescriptor(b,m);if(y===void 0){var v=Object.getPrototypeOf(b);return v===null?void 0:p(v,m,g)}else{if("value"in y)return y.value;var _=y.get;return _===void 0?void 0:_.call(g)}},l=s(0),c=d(l);function d(p){return p&&p.__esModule?p:{default:p}}function u(p,b){if(!(p instanceof b))throw new TypeError("Cannot call a class as a function")}function f(p,b){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:p}function h(p,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);p.prototype=Object.create(b&&b.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(p,b):p.__proto__=b)}var A=function(p){h(b,p);function b(){return u(this,b),f(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return i(b,[{key:"add",value:function(g,y){if(y==="+1"||y==="-1"){var v=this.value(g)||0;y=y==="+1"?v+1:v-1}return y===0?(this.remove(g),!0):o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"add",this).call(this,g,y)}},{key:"canAdd",value:function(g,y){return o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"canAdd",this).call(this,g,y)||o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"canAdd",this).call(this,g,parseInt(y))}},{key:"value",value:function(g){return parseInt(o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"value",this).call(this,g))||void 0}}]),b}(c.default.Attributor.Class),x=new A("indent","ql-indent",{scope:c.default.Scope.BLOCK,whitelist:[1,2,3,4,5,6,7,8]});a.IndentClass=x},function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0});var i=s(4),o=l(i);function l(h){return h&&h.__esModule?h:{default:h}}function c(h,A){if(!(h instanceof A))throw new TypeError("Cannot call a class as a function")}function d(h,A){if(!h)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return A&&(typeof A=="object"||typeof A=="function")?A:h}function u(h,A){if(typeof A!="function"&&A!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof A);h.prototype=Object.create(A&&A.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),A&&(Object.setPrototypeOf?Object.setPrototypeOf(h,A):h.__proto__=A)}var f=function(h){u(A,h);function A(){return c(this,A),d(this,(A.__proto__||Object.getPrototypeOf(A)).apply(this,arguments))}return A}(o.default);f.blotName="blockquote",f.tagName="blockquote",a.default=f},function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0});var i=function(){function A(x,p){for(var b=0;b<p.length;b++){var m=p[b];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(x,m.key,m)}}return function(x,p,b){return p&&A(x.prototype,p),b&&A(x,b),x}}(),o=s(4),l=c(o);function c(A){return A&&A.__esModule?A:{default:A}}function d(A,x){if(!(A instanceof x))throw new TypeError("Cannot call a class as a function")}function u(A,x){if(!A)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:A}function f(A,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);A.prototype=Object.create(x&&x.prototype,{constructor:{value:A,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(A,x):A.__proto__=x)}var h=function(A){f(x,A);function x(){return d(this,x),u(this,(x.__proto__||Object.getPrototypeOf(x)).apply(this,arguments))}return i(x,null,[{key:"formats",value:function(b){return this.tagName.indexOf(b.tagName)+1}}]),x}(l.default);h.blotName="header",h.tagName=["H1","H2","H3","H4","H5","H6"],a.default=h},function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0}),a.default=a.ListItem=void 0;var i=function(){function v(_,j){for(var N=0;N<j.length;N++){var B=j[N];B.enumerable=B.enumerable||!1,B.configurable=!0,"value"in B&&(B.writable=!0),Object.defineProperty(_,B.key,B)}}return function(_,j,N){return j&&v(_.prototype,j),N&&v(_,N),_}}(),o=function v(_,j,N){_===null&&(_=Function.prototype);var B=Object.getOwnPropertyDescriptor(_,j);if(B===void 0){var E=Object.getPrototypeOf(_);return E===null?void 0:v(E,j,N)}else{if("value"in B)return B.value;var C=B.get;return C===void 0?void 0:C.call(N)}},l=s(0),c=A(l),d=s(4),u=A(d),f=s(25),h=A(f);function A(v){return v&&v.__esModule?v:{default:v}}function x(v,_,j){return _ in v?Object.defineProperty(v,_,{value:j,enumerable:!0,configurable:!0,writable:!0}):v[_]=j,v}function p(v,_){if(!(v instanceof _))throw new TypeError("Cannot call a class as a function")}function b(v,_){if(!v)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _&&(typeof _=="object"||typeof _=="function")?_:v}function m(v,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof _);v.prototype=Object.create(_&&_.prototype,{constructor:{value:v,enumerable:!1,writable:!0,configurable:!0}}),_&&(Object.setPrototypeOf?Object.setPrototypeOf(v,_):v.__proto__=_)}var g=function(v){m(_,v);function _(){return p(this,_),b(this,(_.__proto__||Object.getPrototypeOf(_)).apply(this,arguments))}return i(_,[{key:"format",value:function(N,B){N===y.blotName&&!B?this.replaceWith(c.default.create(this.statics.scope)):o(_.prototype.__proto__||Object.getPrototypeOf(_.prototype),"format",this).call(this,N,B)}},{key:"remove",value:function(){this.prev==null&&this.next==null?this.parent.remove():o(_.prototype.__proto__||Object.getPrototypeOf(_.prototype),"remove",this).call(this)}},{key:"replaceWith",value:function(N,B){return this.parent.isolate(this.offset(this.parent),this.length()),N===this.parent.statics.blotName?(this.parent.replaceWith(N,B),this):(this.parent.unwrap(),o(_.prototype.__proto__||Object.getPrototypeOf(_.prototype),"replaceWith",this).call(this,N,B))}}],[{key:"formats",value:function(N){return N.tagName===this.tagName?void 0:o(_.__proto__||Object.getPrototypeOf(_),"formats",this).call(this,N)}}]),_}(u.default);g.blotName="list-item",g.tagName="LI";var y=function(v){m(_,v),i(_,null,[{key:"create",value:function(N){var B=N==="ordered"?"OL":"UL",E=o(_.__proto__||Object.getPrototypeOf(_),"create",this).call(this,B);return(N==="checked"||N==="unchecked")&&E.setAttribute("data-checked",N==="checked"),E}},{key:"formats",value:function(N){if(N.tagName==="OL")return"ordered";if(N.tagName==="UL")return N.hasAttribute("data-checked")?N.getAttribute("data-checked")==="true"?"checked":"unchecked":"bullet"}}]);function _(j){p(this,_);var N=b(this,(_.__proto__||Object.getPrototypeOf(_)).call(this,j)),B=function(C){if(C.target.parentNode===j){var k=N.statics.formats(j),w=c.default.find(C.target);k==="checked"?w.format("list","unchecked"):k==="unchecked"&&w.format("list","checked")}};return j.addEventListener("touchstart",B),j.addEventListener("mousedown",B),N}return i(_,[{key:"format",value:function(N,B){this.children.length>0&&this.children.tail.format(N,B)}},{key:"formats",value:function(){return x({},this.statics.blotName,this.statics.formats(this.domNode))}},{key:"insertBefore",value:function(N,B){if(N instanceof g)o(_.prototype.__proto__||Object.getPrototypeOf(_.prototype),"insertBefore",this).call(this,N,B);else{var E=B==null?this.length():B.offset(this),C=this.split(E);C.parent.insertBefore(N,C)}}},{key:"optimize",value:function(N){o(_.prototype.__proto__||Object.getPrototypeOf(_.prototype),"optimize",this).call(this,N);var B=this.next;B!=null&&B.prev===this&&B.statics.blotName===this.statics.blotName&&B.domNode.tagName===this.domNode.tagName&&B.domNode.getAttribute("data-checked")===this.domNode.getAttribute("data-checked")&&(B.moveChildren(this),B.remove())}},{key:"replace",value:function(N){if(N.statics.blotName!==this.statics.blotName){var B=c.default.create(this.statics.defaultChild);N.moveChildren(B),this.appendChild(B)}o(_.prototype.__proto__||Object.getPrototypeOf(_.prototype),"replace",this).call(this,N)}}]),_}(h.default);y.blotName="list",y.scope=c.default.Scope.BLOCK_BLOT,y.tagName=["OL","UL"],y.defaultChild="list-item",y.allowedChildren=[g],a.ListItem=g,a.default=y},function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0});var i=s(56),o=l(i);function l(h){return h&&h.__esModule?h:{default:h}}function c(h,A){if(!(h instanceof A))throw new TypeError("Cannot call a class as a function")}function d(h,A){if(!h)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return A&&(typeof A=="object"||typeof A=="function")?A:h}function u(h,A){if(typeof A!="function"&&A!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof A);h.prototype=Object.create(A&&A.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),A&&(Object.setPrototypeOf?Object.setPrototypeOf(h,A):h.__proto__=A)}var f=function(h){u(A,h);function A(){return c(this,A),d(this,(A.__proto__||Object.getPrototypeOf(A)).apply(this,arguments))}return A}(o.default);f.blotName="italic",f.tagName=["EM","I"],a.default=f},function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0});var i=function(){function x(p,b){for(var m=0;m<b.length;m++){var g=b[m];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(p,g.key,g)}}return function(p,b,m){return b&&x(p.prototype,b),m&&x(p,m),p}}(),o=function x(p,b,m){p===null&&(p=Function.prototype);var g=Object.getOwnPropertyDescriptor(p,b);if(g===void 0){var y=Object.getPrototypeOf(p);return y===null?void 0:x(y,b,m)}else{if("value"in g)return g.value;var v=g.get;return v===void 0?void 0:v.call(m)}},l=s(6),c=d(l);function d(x){return x&&x.__esModule?x:{default:x}}function u(x,p){if(!(x instanceof p))throw new TypeError("Cannot call a class as a function")}function f(x,p){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p&&(typeof p=="object"||typeof p=="function")?p:x}function h(x,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof p);x.prototype=Object.create(p&&p.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),p&&(Object.setPrototypeOf?Object.setPrototypeOf(x,p):x.__proto__=p)}var A=function(x){h(p,x);function p(){return u(this,p),f(this,(p.__proto__||Object.getPrototypeOf(p)).apply(this,arguments))}return i(p,null,[{key:"create",value:function(m){return m==="super"?document.createElement("sup"):m==="sub"?document.createElement("sub"):o(p.__proto__||Object.getPrototypeOf(p),"create",this).call(this,m)}},{key:"formats",value:function(m){if(m.tagName==="SUB")return"sub";if(m.tagName==="SUP")return"super"}}]),p}(c.default);A.blotName="script",A.tagName=["SUB","SUP"],a.default=A},function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0});var i=s(6),o=l(i);function l(h){return h&&h.__esModule?h:{default:h}}function c(h,A){if(!(h instanceof A))throw new TypeError("Cannot call a class as a function")}function d(h,A){if(!h)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return A&&(typeof A=="object"||typeof A=="function")?A:h}function u(h,A){if(typeof A!="function"&&A!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof A);h.prototype=Object.create(A&&A.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),A&&(Object.setPrototypeOf?Object.setPrototypeOf(h,A):h.__proto__=A)}var f=function(h){u(A,h);function A(){return c(this,A),d(this,(A.__proto__||Object.getPrototypeOf(A)).apply(this,arguments))}return A}(o.default);f.blotName="strike",f.tagName="S",a.default=f},function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0});var i=s(6),o=l(i);function l(h){return h&&h.__esModule?h:{default:h}}function c(h,A){if(!(h instanceof A))throw new TypeError("Cannot call a class as a function")}function d(h,A){if(!h)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return A&&(typeof A=="object"||typeof A=="function")?A:h}function u(h,A){if(typeof A!="function"&&A!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof A);h.prototype=Object.create(A&&A.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),A&&(Object.setPrototypeOf?Object.setPrototypeOf(h,A):h.__proto__=A)}var f=function(h){u(A,h);function A(){return c(this,A),d(this,(A.__proto__||Object.getPrototypeOf(A)).apply(this,arguments))}return A}(o.default);f.blotName="underline",f.tagName="U",a.default=f},function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0});var i=function(){function b(m,g){for(var y=0;y<g.length;y++){var v=g[y];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(m,v.key,v)}}return function(m,g,y){return g&&b(m.prototype,g),y&&b(m,y),m}}(),o=function b(m,g,y){m===null&&(m=Function.prototype);var v=Object.getOwnPropertyDescriptor(m,g);if(v===void 0){var _=Object.getPrototypeOf(m);return _===null?void 0:b(_,g,y)}else{if("value"in v)return v.value;var j=v.get;return j===void 0?void 0:j.call(y)}},l=s(0),c=u(l),d=s(27);function u(b){return b&&b.__esModule?b:{default:b}}function f(b,m){if(!(b instanceof m))throw new TypeError("Cannot call a class as a function")}function h(b,m){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m&&(typeof m=="object"||typeof m=="function")?m:b}function A(b,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof m);b.prototype=Object.create(m&&m.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),m&&(Object.setPrototypeOf?Object.setPrototypeOf(b,m):b.__proto__=m)}var x=["alt","height","width"],p=function(b){A(m,b);function m(){return f(this,m),h(this,(m.__proto__||Object.getPrototypeOf(m)).apply(this,arguments))}return i(m,[{key:"format",value:function(y,v){x.indexOf(y)>-1?v?this.domNode.setAttribute(y,v):this.domNode.removeAttribute(y):o(m.prototype.__proto__||Object.getPrototypeOf(m.prototype),"format",this).call(this,y,v)}}],[{key:"create",value:function(y){var v=o(m.__proto__||Object.getPrototypeOf(m),"create",this).call(this,y);return typeof y=="string"&&v.setAttribute("src",this.sanitize(y)),v}},{key:"formats",value:function(y){return x.reduce(function(v,_){return y.hasAttribute(_)&&(v[_]=y.getAttribute(_)),v},{})}},{key:"match",value:function(y){return/\.(jpe?g|gif|png)$/.test(y)||/^data:image\/.+;base64/.test(y)}},{key:"sanitize",value:function(y){return(0,d.sanitize)(y,["http","https","data"])?y:"//:0"}},{key:"value",value:function(y){return y.getAttribute("src")}}]),m}(c.default.Embed);p.blotName="image",p.tagName="IMG",a.default=p},function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0});var i=function(){function b(m,g){for(var y=0;y<g.length;y++){var v=g[y];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(m,v.key,v)}}return function(m,g,y){return g&&b(m.prototype,g),y&&b(m,y),m}}(),o=function b(m,g,y){m===null&&(m=Function.prototype);var v=Object.getOwnPropertyDescriptor(m,g);if(v===void 0){var _=Object.getPrototypeOf(m);return _===null?void 0:b(_,g,y)}else{if("value"in v)return v.value;var j=v.get;return j===void 0?void 0:j.call(y)}},l=s(4),c=s(27),d=u(c);function u(b){return b&&b.__esModule?b:{default:b}}function f(b,m){if(!(b instanceof m))throw new TypeError("Cannot call a class as a function")}function h(b,m){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m&&(typeof m=="object"||typeof m=="function")?m:b}function A(b,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof m);b.prototype=Object.create(m&&m.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),m&&(Object.setPrototypeOf?Object.setPrototypeOf(b,m):b.__proto__=m)}var x=["height","width"],p=function(b){A(m,b);function m(){return f(this,m),h(this,(m.__proto__||Object.getPrototypeOf(m)).apply(this,arguments))}return i(m,[{key:"format",value:function(y,v){x.indexOf(y)>-1?v?this.domNode.setAttribute(y,v):this.domNode.removeAttribute(y):o(m.prototype.__proto__||Object.getPrototypeOf(m.prototype),"format",this).call(this,y,v)}}],[{key:"create",value:function(y){var v=o(m.__proto__||Object.getPrototypeOf(m),"create",this).call(this,y);return v.setAttribute("frameborder","0"),v.setAttribute("allowfullscreen",!0),v.setAttribute("src",this.sanitize(y)),v}},{key:"formats",value:function(y){return x.reduce(function(v,_){return y.hasAttribute(_)&&(v[_]=y.getAttribute(_)),v},{})}},{key:"sanitize",value:function(y){return d.default.sanitize(y)}},{key:"value",value:function(y){return y.getAttribute("src")}}]),m}(l.BlockEmbed);p.blotName="video",p.className="ql-video",p.tagName="IFRAME",a.default=p},function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0}),a.default=a.FormulaBlot=void 0;var i=function(){function y(v,_){for(var j=0;j<_.length;j++){var N=_[j];N.enumerable=N.enumerable||!1,N.configurable=!0,"value"in N&&(N.writable=!0),Object.defineProperty(v,N.key,N)}}return function(v,_,j){return _&&y(v.prototype,_),j&&y(v,j),v}}(),o=function y(v,_,j){v===null&&(v=Function.prototype);var N=Object.getOwnPropertyDescriptor(v,_);if(N===void 0){var B=Object.getPrototypeOf(v);return B===null?void 0:y(B,_,j)}else{if("value"in N)return N.value;var E=N.get;return E===void 0?void 0:E.call(j)}},l=s(35),c=A(l),d=s(5),u=A(d),f=s(9),h=A(f);function A(y){return y&&y.__esModule?y:{default:y}}function x(y,v){if(!(y instanceof v))throw new TypeError("Cannot call a class as a function")}function p(y,v){if(!y)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v&&(typeof v=="object"||typeof v=="function")?v:y}function b(y,v){if(typeof v!="function"&&v!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof v);y.prototype=Object.create(v&&v.prototype,{constructor:{value:y,enumerable:!1,writable:!0,configurable:!0}}),v&&(Object.setPrototypeOf?Object.setPrototypeOf(y,v):y.__proto__=v)}var m=function(y){b(v,y);function v(){return x(this,v),p(this,(v.__proto__||Object.getPrototypeOf(v)).apply(this,arguments))}return i(v,null,[{key:"create",value:function(j){var N=o(v.__proto__||Object.getPrototypeOf(v),"create",this).call(this,j);return typeof j=="string"&&(window.katex.render(j,N,{throwOnError:!1,errorColor:"#f00"}),N.setAttribute("data-value",j)),N}},{key:"value",value:function(j){return j.getAttribute("data-value")}}]),v}(c.default);m.blotName="formula",m.className="ql-formula",m.tagName="SPAN";var g=function(y){b(v,y),i(v,null,[{key:"register",value:function(){u.default.register(m,!0)}}]);function v(){x(this,v);var _=p(this,(v.__proto__||Object.getPrototypeOf(v)).call(this));if(window.katex==null)throw new Error("Formula module requires KaTeX.");return _}return v}(h.default);a.FormulaBlot=m,a.default=g},function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0}),a.default=a.CodeToken=a.CodeBlock=void 0;var i=function(){function j(N,B){for(var E=0;E<B.length;E++){var C=B[E];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(N,C.key,C)}}return function(N,B,E){return B&&j(N.prototype,B),E&&j(N,E),N}}(),o=function j(N,B,E){N===null&&(N=Function.prototype);var C=Object.getOwnPropertyDescriptor(N,B);if(C===void 0){var k=Object.getPrototypeOf(N);return k===null?void 0:j(k,B,E)}else{if("value"in C)return C.value;var w=C.get;return w===void 0?void 0:w.call(E)}},l=s(0),c=p(l),d=s(5),u=p(d),f=s(9),h=p(f),A=s(13),x=p(A);function p(j){return j&&j.__esModule?j:{default:j}}function b(j,N){if(!(j instanceof N))throw new TypeError("Cannot call a class as a function")}function m(j,N){if(!j)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return N&&(typeof N=="object"||typeof N=="function")?N:j}function g(j,N){if(typeof N!="function"&&N!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof N);j.prototype=Object.create(N&&N.prototype,{constructor:{value:j,enumerable:!1,writable:!0,configurable:!0}}),N&&(Object.setPrototypeOf?Object.setPrototypeOf(j,N):j.__proto__=N)}var y=function(j){g(N,j);function N(){return b(this,N),m(this,(N.__proto__||Object.getPrototypeOf(N)).apply(this,arguments))}return i(N,[{key:"replaceWith",value:function(E){this.domNode.textContent=this.domNode.textContent,this.attach(),o(N.prototype.__proto__||Object.getPrototypeOf(N.prototype),"replaceWith",this).call(this,E)}},{key:"highlight",value:function(E){var C=this.domNode.textContent;this.cachedText!==C&&((C.trim().length>0||this.cachedText==null)&&(this.domNode.innerHTML=E(C),this.domNode.normalize(),this.attach()),this.cachedText=C)}}]),N}(x.default);y.className="ql-syntax";var v=new c.default.Attributor.Class("token","hljs",{scope:c.default.Scope.INLINE}),_=function(j){g(N,j),i(N,null,[{key:"register",value:function(){u.default.register(v,!0),u.default.register(y,!0)}}]);function N(B,E){b(this,N);var C=m(this,(N.__proto__||Object.getPrototypeOf(N)).call(this,B,E));if(typeof C.options.highlight!="function")throw new Error("Syntax module requires highlight.js. Please include the library on the page before Quill.");var k=null;return C.quill.on(u.default.events.SCROLL_OPTIMIZE,function(){clearTimeout(k),k=setTimeout(function(){C.highlight(),k=null},C.options.interval)}),C.highlight(),C}return i(N,[{key:"highlight",value:function(){var E=this;if(!this.quill.selection.composing){this.quill.update(u.default.sources.USER);var C=this.quill.getSelection();this.quill.scroll.descendants(y).forEach(function(k){k.highlight(E.options.highlight)}),this.quill.update(u.default.sources.SILENT),C!=null&&this.quill.setSelection(C,u.default.sources.SILENT)}}}]),N}(h.default);_.DEFAULTS={highlight:function(){return window.hljs==null?null:function(j){var N=window.hljs.highlightAuto(j);return N.value}}(),interval:1e3},a.CodeBlock=y,a.CodeToken=v,a.default=_},function(r,a){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=3 x2=13 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=9 y1=4 y2=4></line> </svg>'},function(r,a){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=14 x2=4 y1=14 y2=14></line> <line class=ql-stroke x1=12 x2=6 y1=4 y2=4></line> </svg>'},function(r,a){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=15 x2=5 y1=14 y2=14></line> <line class=ql-stroke x1=15 x2=9 y1=4 y2=4></line> </svg>'},function(r,a){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=15 x2=3 y1=14 y2=14></line> <line class=ql-stroke x1=15 x2=3 y1=4 y2=4></line> </svg>'},function(r,a){r.exports='<svg viewbox="0 0 18 18"> <g class="ql-fill ql-color-label"> <polygon points="6 6.868 6 6 5 6 5 7 5.942 7 6 6.868"></polygon> <rect height=1 width=1 x=4 y=4></rect> <polygon points="6.817 5 6 5 6 6 6.38 6 6.817 5"></polygon> <rect height=1 width=1 x=2 y=6></rect> <rect height=1 width=1 x=3 y=5></rect> <rect height=1 width=1 x=4 y=7></rect> <polygon points="4 11.439 4 11 3 11 3 12 3.755 12 4 11.439"></polygon> <rect height=1 width=1 x=2 y=12></rect> <rect height=1 width=1 x=2 y=9></rect> <rect height=1 width=1 x=2 y=15></rect> <polygon points="4.63 10 4 10 4 11 4.192 11 4.63 10"></polygon> <rect height=1 width=1 x=3 y=8></rect> <path d=M10.832,4.2L11,4.582V4H10.708A1.948,1.948,0,0,1,10.832,4.2Z></path> <path d=M7,4.582L7.168,4.2A1.929,1.929,0,0,1,7.292,4H7V4.582Z></path> <path d=M8,13H7.683l-0.351.8a1.933,1.933,0,0,1-.124.2H8V13Z></path> <rect height=1 width=1 x=12 y=2></rect> <rect height=1 width=1 x=11 y=3></rect> <path d=M9,3H8V3.282A1.985,1.985,0,0,1,9,3Z></path> <rect height=1 width=1 x=2 y=3></rect> <rect height=1 width=1 x=6 y=2></rect> <rect height=1 width=1 x=3 y=2></rect> <rect height=1 width=1 x=5 y=3></rect> <rect height=1 width=1 x=9 y=2></rect> <rect height=1 width=1 x=15 y=14></rect> <polygon points="13.447 10.174 13.469 10.225 13.472 10.232 13.808 11 14 11 14 10 13.37 10 13.447 10.174"></polygon> <rect height=1 width=1 x=13 y=7></rect> <rect height=1 width=1 x=15 y=5></rect> <rect height=1 width=1 x=14 y=6></rect> <rect height=1 width=1 x=15 y=8></rect> <rect height=1 width=1 x=14 y=9></rect> <path d=M3.775,14H3v1H4V14.314A1.97,1.97,0,0,1,3.775,14Z></path> <rect height=1 width=1 x=14 y=3></rect> <polygon points="12 6.868 12 6 11.62 6 12 6.868"></polygon> <rect height=1 width=1 x=15 y=2></rect> <rect height=1 width=1 x=12 y=5></rect> <rect height=1 width=1 x=13 y=4></rect> <polygon points="12.933 9 13 9 13 8 12.495 8 12.933 9"></polygon> <rect height=1 width=1 x=9 y=14></rect> <rect height=1 width=1 x=8 y=15></rect> <path d=M6,14.926V15H7V14.316A1.993,1.993,0,0,1,6,14.926Z></path> <rect height=1 width=1 x=5 y=15></rect> <path d=M10.668,13.8L10.317,13H10v1h0.792A1.947,1.947,0,0,1,10.668,13.8Z></path> <rect height=1 width=1 x=11 y=15></rect> <path d=M14.332,12.2a1.99,1.99,0,0,1,.166.8H15V12H14.245Z></path> <rect height=1 width=1 x=14 y=15></rect> <rect height=1 width=1 x=15 y=11></rect> </g> <polyline class=ql-stroke points="5.5 13 9 5 12.5 13"></polyline> <line class=ql-stroke x1=11.63 x2=6.38 y1=11 y2=11></line> </svg>'},function(r,a){r.exports='<svg viewbox="0 0 18 18"> <rect class="ql-fill ql-stroke" height=3 width=3 x=4 y=5></rect> <rect class="ql-fill ql-stroke" height=3 width=3 x=11 y=5></rect> <path class="ql-even ql-fill ql-stroke" d=M7,8c0,4.031-3,5-3,5></path> <path class="ql-even ql-fill ql-stroke" d=M14,8c0,4.031-3,5-3,5></path> </svg>'},function(r,a){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-stroke d=M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z></path> <path class=ql-stroke d=M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z></path> </svg>'},function(r,a){r.exports='<svg class="" viewbox="0 0 18 18"> <line class=ql-stroke x1=5 x2=13 y1=3 y2=3></line> <line class=ql-stroke x1=6 x2=9.35 y1=12 y2=3></line> <line class=ql-stroke x1=11 x2=15 y1=11 y2=15></line> <line class=ql-stroke x1=15 x2=11 y1=11 y2=15></line> <rect class=ql-fill height=1 rx=0.5 ry=0.5 width=7 x=2 y=14></rect> </svg>'},function(r,a){r.exports='<svg viewbox="0 0 18 18"> <line class="ql-color-label ql-stroke ql-transparent" x1=3 x2=15 y1=15 y2=15></line> <polyline class=ql-stroke points="5.5 11 9 3 12.5 11"></polyline> <line class=ql-stroke x1=11.63 x2=6.38 y1=9 y2=9></line> </svg>'},function(r,a){r.exports='<svg viewbox="0 0 18 18"> <polygon class="ql-stroke ql-fill" points="3 11 5 9 3 7 3 11"></polygon> <line class="ql-stroke ql-fill" x1=15 x2=11 y1=4 y2=4></line> <path class=ql-fill d=M11,3a3,3,0,0,0,0,6h1V3H11Z></path> <rect class=ql-fill height=11 width=1 x=11 y=4></rect> <rect class=ql-fill height=11 width=1 x=13 y=4></rect> </svg>'},function(r,a){r.exports='<svg viewbox="0 0 18 18"> <polygon class="ql-stroke ql-fill" points="15 12 13 10 15 8 15 12"></polygon> <line class="ql-stroke ql-fill" x1=9 x2=5 y1=4 y2=4></line> <path class=ql-fill d=M5,3A3,3,0,0,0,5,9H6V3H5Z></path> <rect class=ql-fill height=11 width=1 x=5 y=4></rect> <rect class=ql-fill height=11 width=1 x=7 y=4></rect> </svg>'},function(r,a){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M14,16H4a1,1,0,0,1,0-2H14A1,1,0,0,1,14,16Z /> <path class=ql-fill d=M14,4H4A1,1,0,0,1,4,2H14A1,1,0,0,1,14,4Z /> <rect class=ql-fill x=3 y=6 width=12 height=6 rx=1 ry=1 /> </svg>'},function(r,a){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M13,16H5a1,1,0,0,1,0-2h8A1,1,0,0,1,13,16Z /> <path class=ql-fill d=M13,4H5A1,1,0,0,1,5,2h8A1,1,0,0,1,13,4Z /> <rect class=ql-fill x=2 y=6 width=14 height=6 rx=1 ry=1 /> </svg>'},function(r,a){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15,8H13a1,1,0,0,1,0-2h2A1,1,0,0,1,15,8Z /> <path class=ql-fill d=M15,12H13a1,1,0,0,1,0-2h2A1,1,0,0,1,15,12Z /> <path class=ql-fill d=M15,16H5a1,1,0,0,1,0-2H15A1,1,0,0,1,15,16Z /> <path class=ql-fill d=M15,4H5A1,1,0,0,1,5,2H15A1,1,0,0,1,15,4Z /> <rect class=ql-fill x=2 y=6 width=8 height=6 rx=1 ry=1 /> </svg>'},function(r,a){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M5,8H3A1,1,0,0,1,3,6H5A1,1,0,0,1,5,8Z /> <path class=ql-fill d=M5,12H3a1,1,0,0,1,0-2H5A1,1,0,0,1,5,12Z /> <path class=ql-fill d=M13,16H3a1,1,0,0,1,0-2H13A1,1,0,0,1,13,16Z /> <path class=ql-fill d=M13,4H3A1,1,0,0,1,3,2H13A1,1,0,0,1,13,4Z /> <rect class=ql-fill x=8 y=6 width=8 height=6 rx=1 ry=1 transform="translate(24 18) rotate(-180)"/> </svg>'},function(r,a){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M11.759,2.482a2.561,2.561,0,0,0-3.53.607A7.656,7.656,0,0,0,6.8,6.2C6.109,9.188,5.275,14.677,4.15,14.927a1.545,1.545,0,0,0-1.3-.933A0.922,0.922,0,0,0,2,15.036S1.954,16,4.119,16s3.091-2.691,3.7-5.553c0.177-.826.36-1.726,0.554-2.6L8.775,6.2c0.381-1.421.807-2.521,1.306-2.676a1.014,1.014,0,0,0,1.02.56A0.966,0.966,0,0,0,11.759,2.482Z></path> <rect class=ql-fill height=1.6 rx=0.8 ry=0.8 width=5 x=5.15 y=6.2></rect> <path class=ql-fill d=M13.663,12.027a1.662,1.662,0,0,1,.266-0.276q0.193,0.069.456,0.138a2.1,2.1,0,0,0,.535.069,1.075,1.075,0,0,0,.767-0.3,1.044,1.044,0,0,0,.314-0.8,0.84,0.84,0,0,0-.238-0.619,0.8,0.8,0,0,0-.594-0.239,1.154,1.154,0,0,0-.781.3,4.607,4.607,0,0,0-.781,1q-0.091.15-.218,0.346l-0.246.38c-0.068-.288-0.137-0.582-0.212-0.885-0.459-1.847-2.494-.984-2.941-0.8-0.482.2-.353,0.647-0.094,0.529a0.869,0.869,0,0,1,1.281.585c0.217,0.751.377,1.436,0.527,2.038a5.688,5.688,0,0,1-.362.467,2.69,2.69,0,0,1-.264.271q-0.221-.08-0.471-0.147a2.029,2.029,0,0,0-.522-0.066,1.079,1.079,0,0,0-.768.3A1.058,1.058,0,0,0,9,15.131a0.82,0.82,0,0,0,.832.852,1.134,1.134,0,0,0,.787-0.3,5.11,5.11,0,0,0,.776-0.993q0.141-.219.215-0.34c0.046-.076.122-0.194,0.223-0.346a2.786,2.786,0,0,0,.918,1.726,2.582,2.582,0,0,0,2.376-.185c0.317-.181.212-0.565,0-0.494A0.807,0.807,0,0,1,14.176,15a5.159,5.159,0,0,1-.913-2.446l0,0Q13.487,12.24,13.663,12.027Z></path> </svg>'},function(r,a){r.exports='<svg viewBox="0 0 18 18"> <path class=ql-fill d=M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm6.06787,9.209H14.98975V7.59863a.54085.54085,0,0,0-.605-.60547h-.62744a1.01119,1.01119,0,0,0-.748.29688L11.645,8.56641a.5435.5435,0,0,0-.022.8584l.28613.30762a.53861.53861,0,0,0,.84717.0332l.09912-.08789a1.2137,1.2137,0,0,0,.2417-.35254h.02246s-.01123.30859-.01123.60547V13.209H12.041a.54085.54085,0,0,0-.605.60547v.43945a.54085.54085,0,0,0,.605.60547h4.02686a.54085.54085,0,0,0,.605-.60547v-.43945A.54085.54085,0,0,0,16.06787,13.209Z /> </svg>'},function(r,a){r.exports='<svg viewBox="0 0 18 18"> <path class=ql-fill d=M16.73975,13.81445v.43945a.54085.54085,0,0,1-.605.60547H11.855a.58392.58392,0,0,1-.64893-.60547V14.0127c0-2.90527,3.39941-3.42187,3.39941-4.55469a.77675.77675,0,0,0-.84717-.78125,1.17684,1.17684,0,0,0-.83594.38477c-.2749.26367-.561.374-.85791.13184l-.4292-.34082c-.30811-.24219-.38525-.51758-.1543-.81445a2.97155,2.97155,0,0,1,2.45361-1.17676,2.45393,2.45393,0,0,1,2.68408,2.40918c0,2.45312-3.1792,2.92676-3.27832,3.93848h2.79443A.54085.54085,0,0,1,16.73975,13.81445ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z /> </svg>'},function(r,a){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=13 y1=4 y2=4></line> <line class=ql-stroke x1=5 x2=11 y1=14 y2=14></line> <line class=ql-stroke x1=8 x2=10 y1=14 y2=4></line> </svg>'},function(r,a){r.exports='<svg viewbox="0 0 18 18"> <rect class=ql-stroke height=10 width=12 x=3 y=4></rect> <circle class=ql-fill cx=6 cy=7 r=1></circle> <polyline class="ql-even ql-fill" points="5 12 5 11 7 9 8 10 11 7 13 9 13 12 5 12"></polyline> </svg>'},function(r,a){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class="ql-fill ql-stroke" points="3 7 3 11 5 9 3 7"></polyline> </svg>'},function(r,a){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=ql-stroke points="5 7 5 11 3 9 5 7"></polyline> </svg>'},function(r,a){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=11 y1=7 y2=11></line> <path class="ql-even ql-stroke" d=M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z></path> <path class="ql-even ql-stroke" d=M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z></path> </svg>'},function(r,a){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=7 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=7 x2=15 y1=14 y2=14></line> <line class="ql-stroke ql-thin" x1=2.5 x2=4.5 y1=5.5 y2=5.5></line> <path class=ql-fill d=M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z></path> <path class="ql-stroke ql-thin" d=M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156></path> <path class="ql-stroke ql-thin" d=M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109></path> </svg>'},function(r,a){r.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=6 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=6 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=6 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=3 y1=4 y2=4></line> <line class=ql-stroke x1=3 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=3 x2=3 y1=14 y2=14></line> </svg>'},function(r,a){r.exports='<svg class="" viewbox="0 0 18 18"> <line class=ql-stroke x1=9 x2=15 y1=4 y2=4></line> <polyline class=ql-stroke points="3 4 4 5 6 3"></polyline> <line class=ql-stroke x1=9 x2=15 y1=14 y2=14></line> <polyline class=ql-stroke points="3 14 4 15 6 13"></polyline> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=ql-stroke points="3 9 4 10 6 8"></polyline> </svg>'},function(r,a){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15.5,15H13.861a3.858,3.858,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.921,1.921,0,0,0,12.021,11.7a0.50013,0.50013,0,1,0,.957.291h0a0.914,0.914,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.076-1.16971,1.86982-1.93971,2.43082A1.45639,1.45639,0,0,0,12,15.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,15Z /> <path class=ql-fill d=M9.65,5.241a1,1,0,0,0-1.409.108L6,7.964,3.759,5.349A1,1,0,0,0,2.192,6.59178Q2.21541,6.6213,2.241,6.649L4.684,9.5,2.241,12.35A1,1,0,0,0,3.71,13.70722q0.02557-.02768.049-0.05722L6,11.036,8.241,13.65a1,1,0,1,0,1.567-1.24277Q9.78459,12.3777,9.759,12.35L7.316,9.5,9.759,6.651A1,1,0,0,0,9.65,5.241Z /> </svg>'},function(r,a){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15.5,7H13.861a4.015,4.015,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.922,1.922,0,0,0,12.021,3.7a0.5,0.5,0,1,0,.957.291,0.917,0.917,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.077-1.164,1.925-1.934,2.486A1.423,1.423,0,0,0,12,7.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,7Z /> <path class=ql-fill d=M9.651,5.241a1,1,0,0,0-1.41.108L6,7.964,3.759,5.349a1,1,0,1,0-1.519,1.3L4.683,9.5,2.241,12.35a1,1,0,1,0,1.519,1.3L6,11.036,8.241,13.65a1,1,0,0,0,1.519-1.3L7.317,9.5,9.759,6.651A1,1,0,0,0,9.651,5.241Z /> </svg>'},function(r,a){r.exports='<svg viewbox="0 0 18 18"> <line class="ql-stroke ql-thin" x1=15.5 x2=2.5 y1=8.5 y2=9.5></line> <path class=ql-fill d=M9.007,8C6.542,7.791,6,7.519,6,6.5,6,5.792,7.283,5,9,5c1.571,0,2.765.679,2.969,1.309a1,1,0,0,0,1.9-.617C13.356,4.106,11.354,3,9,3,6.2,3,4,4.538,4,6.5a3.2,3.2,0,0,0,.5,1.843Z></path> <path class=ql-fill d=M8.984,10C11.457,10.208,12,10.479,12,11.5c0,0.708-1.283,1.5-3,1.5-1.571,0-2.765-.679-2.969-1.309a1,1,0,1,0-1.9.617C4.644,13.894,6.646,15,9,15c2.8,0,5-1.538,5-3.5a3.2,3.2,0,0,0-.5-1.843Z></path> </svg>'},function(r,a){r.exports='<svg viewbox="0 0 18 18"> <path class=ql-stroke d=M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3></path> <rect class=ql-fill height=1 rx=0.5 ry=0.5 width=12 x=3 y=15></rect> </svg>'},function(r,a){r.exports='<svg viewbox="0 0 18 18"> <rect class=ql-stroke height=12 width=12 x=3 y=3></rect> <rect class=ql-fill height=12 width=1 x=5 y=3></rect> <rect class=ql-fill height=12 width=1 x=12 y=3></rect> <rect class=ql-fill height=2 width=8 x=5 y=8></rect> <rect class=ql-fill height=1 width=3 x=3 y=5></rect> <rect class=ql-fill height=1 width=3 x=3 y=7></rect> <rect class=ql-fill height=1 width=3 x=3 y=10></rect> <rect class=ql-fill height=1 width=3 x=3 y=12></rect> <rect class=ql-fill height=1 width=3 x=12 y=5></rect> <rect class=ql-fill height=1 width=3 x=12 y=7></rect> <rect class=ql-fill height=1 width=3 x=12 y=10></rect> <rect class=ql-fill height=1 width=3 x=12 y=12></rect> </svg>'},function(r,a){r.exports='<svg viewbox="0 0 18 18"> <polygon class=ql-stroke points="7 11 9 13 11 11 7 11"></polygon> <polygon class=ql-stroke points="7 7 9 5 11 7 7 7"></polygon> </svg>'},function(r,a,s){Object.defineProperty(a,"__esModule",{value:!0}),a.default=a.BubbleTooltip=void 0;var i=function N(B,E,C){B===null&&(B=Function.prototype);var k=Object.getOwnPropertyDescriptor(B,E);if(k===void 0){var w=Object.getPrototypeOf(B);return w===null?void 0:N(w,E,C)}else{if("value"in k)return k.value;var T=k.get;return T===void 0?void 0:T.call(C)}},o=function(){function N(B,E){for(var C=0;C<E.length;C++){var k=E[C];k.enumerable=k.enumerable||!1,k.configurable=!0,"value"in k&&(k.writable=!0),Object.defineProperty(B,k.key,k)}}return function(B,E,C){return E&&N(B.prototype,E),C&&N(B,C),B}}(),l=s(3),c=b(l),d=s(8),u=b(d),f=s(43),h=b(f),A=s(15),x=s(41),p=b(x);function b(N){return N&&N.__esModule?N:{default:N}}function m(N,B){if(!(N instanceof B))throw new TypeError("Cannot call a class as a function")}function g(N,B){if(!N)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return B&&(typeof B=="object"||typeof B=="function")?B:N}function y(N,B){if(typeof B!="function"&&B!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof B);N.prototype=Object.create(B&&B.prototype,{constructor:{value:N,enumerable:!1,writable:!0,configurable:!0}}),B&&(Object.setPrototypeOf?Object.setPrototypeOf(N,B):N.__proto__=B)}var v=[["bold","italic","link"],[{header:1},{header:2},"blockquote"]],_=function(N){y(B,N);function B(E,C){m(this,B),C.modules.toolbar!=null&&C.modules.toolbar.container==null&&(C.modules.toolbar.container=v);var k=g(this,(B.__proto__||Object.getPrototypeOf(B)).call(this,E,C));return k.quill.container.classList.add("ql-bubble"),k}return o(B,[{key:"extendToolbar",value:function(C){this.tooltip=new j(this.quill,this.options.bounds),this.tooltip.root.appendChild(C.container),this.buildButtons([].slice.call(C.container.querySelectorAll("button")),p.default),this.buildPickers([].slice.call(C.container.querySelectorAll("select")),p.default)}}]),B}(h.default);_.DEFAULTS=(0,c.default)(!0,{},h.default.DEFAULTS,{modules:{toolbar:{handlers:{link:function(B){B?this.quill.theme.tooltip.edit():this.quill.format("link",!1)}}}}});var j=function(N){y(B,N);function B(E,C){m(this,B);var k=g(this,(B.__proto__||Object.getPrototypeOf(B)).call(this,E,C));return k.quill.on(u.default.events.EDITOR_CHANGE,function(w,T,R,q){if(w===u.default.events.SELECTION_CHANGE)if(T!=null&&T.length>0&&q===u.default.sources.USER){k.show(),k.root.style.left="0px",k.root.style.width="",k.root.style.width=k.root.offsetWidth+"px";var z=k.quill.getLines(T.index,T.length);if(z.length===1)k.position(k.quill.getBounds(T));else{var ee=z[z.length-1],Y=k.quill.getIndex(ee),G=Math.min(ee.length()-1,T.index+T.length-Y),re=k.quill.getBounds(new A.Range(Y,G));k.position(re)}}else document.activeElement!==k.textbox&&k.quill.hasFocus()&&k.hide()}),k}return o(B,[{key:"listen",value:function(){var C=this;i(B.prototype.__proto__||Object.getPrototypeOf(B.prototype),"listen",this).call(this),this.root.querySelector(".ql-close").addEventListener("click",function(){C.root.classList.remove("ql-editing")}),this.quill.on(u.default.events.SCROLL_OPTIMIZE,function(){setTimeout(function(){if(!C.root.classList.contains("ql-hidden")){var k=C.quill.getSelection();k!=null&&C.position(C.quill.getBounds(k))}},1)})}},{key:"cancel",value:function(){this.show()}},{key:"position",value:function(C){var k=i(B.prototype.__proto__||Object.getPrototypeOf(B.prototype),"position",this).call(this,C),w=this.root.querySelector(".ql-tooltip-arrow");if(w.style.marginLeft="",k===0)return k;w.style.marginLeft=-1*k-w.offsetWidth/2+"px"}}]),B}(f.BaseTooltip);j.TEMPLATE=['<span class="ql-tooltip-arrow"></span>','<div class="ql-tooltip-editor">','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-close"></a>',"</div>"].join(""),a.BubbleTooltip=j,a.default=_},function(r,a,s){r.exports=s(63)}]).default})})(KF);var UJ=KF.exports,RJ=hi&&hi.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,s){a.__proto__=s}||function(a,s){for(var i in s)s.hasOwnProperty(i)&&(a[i]=s[i])},e(t,r)};return function(t,r){e(t,r);function a(){this.constructor=t}t.prototype=r===null?Object.create(r):(a.prototype=r.prototype,new a)}}(),sx=hi&&hi.__assign||function(){return sx=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},sx.apply(this,arguments)},MJ=hi&&hi.__spreadArrays||function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var a=Array(e),s=0,t=0;t<r;t++)for(var i=arguments[t],o=0,l=i.length;o<l;o++,s++)a[s]=i[o];return a},sy=hi&&hi.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},Io=sy(Q),QJ=sy(JB),Kh=sy(OJ),pC=sy(UJ),HJ=function(e){RJ(t,e);function t(r){var a=e.call(this,r)||this;a.dirtyProps=["modules","formats","bounds","theme","children"],a.cleanProps=["id","className","style","placeholder","tabIndex","onChange","onChangeSelection","onFocus","onBlur","onKeyPress","onKeyDown","onKeyUp"],a.state={generation:0},a.selection=null,a.onEditorChange=function(i,o,l,c){var d,u,f,h;i==="text-change"?(u=(d=a).onEditorChangeText)===null||u===void 0||u.call(d,a.editor.root.innerHTML,o,c,a.unprivilegedEditor):i==="selection-change"&&((h=(f=a).onEditorChangeSelection)===null||h===void 0||h.call(f,o,c,a.unprivilegedEditor))};var s=a.isControlled()?r.value:r.defaultValue;return a.value=s??"",a}return t.prototype.validateProps=function(r){var a;if(Io.default.Children.count(r.children)>1)throw new Error("The Quill editing area can only be composed of a single React element.");if(Io.default.Children.count(r.children)){var s=Io.default.Children.only(r.children);if(((a=s)===null||a===void 0?void 0:a.type)==="textarea")throw new Error("Quill does not support editing on a <textarea>. Use a <div> instead.")}if(this.lastDeltaChangeSet&&r.value===this.lastDeltaChangeSet)throw new Error("You are passing the `delta` object from the `onChange` event back as `value`. You most probably want `editor.getContents()` instead. See: https://github.com/zenoamaro/react-quill#using-deltas")},t.prototype.shouldComponentUpdate=function(r,a){var s=this,i;if(this.validateProps(r),!this.editor||this.state.generation!==a.generation)return!0;if("value"in r){var o=this.getEditorContents(),l=(i=r.value,i??"");this.isEqualValue(l,o)||this.setEditorContents(this.editor,l)}return r.readOnly!==this.props.readOnly&&this.setEditorReadOnly(this.editor,r.readOnly),MJ(this.cleanProps,this.dirtyProps).some(function(c){return!Kh.default(r[c],s.props[c])})},t.prototype.shouldComponentRegenerate=function(r){var a=this;return this.dirtyProps.some(function(s){return!Kh.default(r[s],a.props[s])})},t.prototype.componentDidMount=function(){this.instantiateEditor(),this.setEditorContents(this.editor,this.getEditorContents())},t.prototype.componentWillUnmount=function(){this.destroyEditor()},t.prototype.componentDidUpdate=function(r,a){var s=this;if(this.editor&&this.shouldComponentRegenerate(r)){var i=this.editor.getContents(),o=this.editor.getSelection();this.regenerationSnapshot={delta:i,selection:o},this.setState({generation:this.state.generation+1}),this.destroyEditor()}if(this.state.generation!==a.generation){var l=this.regenerationSnapshot,i=l.delta,c=l.selection;delete this.regenerationSnapshot,this.instantiateEditor();var d=this.editor;d.setContents(i),mC(function(){return s.setEditorSelection(d,c)})}},t.prototype.instantiateEditor=function(){this.editor?this.hookEditor(this.editor):this.editor=this.createEditor(this.getEditingArea(),this.getEditorConfig())},t.prototype.destroyEditor=function(){this.editor&&this.unhookEditor(this.editor)},t.prototype.isControlled=function(){return"value"in this.props},t.prototype.getEditorConfig=function(){return{bounds:this.props.bounds,formats:this.props.formats,modules:this.props.modules,placeholder:this.props.placeholder,readOnly:this.props.readOnly,scrollingContainer:this.props.scrollingContainer,tabIndex:this.props.tabIndex,theme:this.props.theme}},t.prototype.getEditor=function(){if(!this.editor)throw new Error("Accessing non-instantiated editor");return this.editor},t.prototype.createEditor=function(r,a){var s=new pC.default(r,a);return a.tabIndex!=null&&this.setEditorTabIndex(s,a.tabIndex),this.hookEditor(s),s},t.prototype.hookEditor=function(r){this.unprivilegedEditor=this.makeUnprivilegedEditor(r),r.on("editor-change",this.onEditorChange)},t.prototype.unhookEditor=function(r){r.off("editor-change",this.onEditorChange)},t.prototype.getEditorContents=function(){return this.value},t.prototype.getEditorSelection=function(){return this.selection},t.prototype.isDelta=function(r){return r&&r.ops},t.prototype.isEqualValue=function(r,a){return this.isDelta(r)&&this.isDelta(a)?Kh.default(r.ops,a.ops):Kh.default(r,a)},t.prototype.setEditorContents=function(r,a){var s=this;this.value=a;var i=this.getEditorSelection();typeof a=="string"?r.setContents(r.clipboard.convert(a)):r.setContents(a),mC(function(){return s.setEditorSelection(r,i)})},t.prototype.setEditorSelection=function(r,a){if(this.selection=a,a){var s=r.getLength();a.index=Math.max(0,Math.min(a.index,s-1)),a.length=Math.max(0,Math.min(a.length,s-1-a.index)),r.setSelection(a)}},t.prototype.setEditorTabIndex=function(r,a){var s,i;!((i=(s=r)===null||s===void 0?void 0:s.scroll)===null||i===void 0)&&i.domNode&&(r.scroll.domNode.tabIndex=a)},t.prototype.setEditorReadOnly=function(r,a){a?r.disable():r.enable()},t.prototype.makeUnprivilegedEditor=function(r){var a=r;return{getHTML:function(){return a.root.innerHTML},getLength:a.getLength.bind(a),getText:a.getText.bind(a),getContents:a.getContents.bind(a),getSelection:a.getSelection.bind(a),getBounds:a.getBounds.bind(a)}},t.prototype.getEditingArea=function(){if(!this.editingArea)throw new Error("Instantiating on missing editing area");var r=QJ.default.findDOMNode(this.editingArea);if(!r)throw new Error("Cannot find element for editing area");if(r.nodeType===3)throw new Error("Editing area cannot be a text node");return r},t.prototype.renderEditingArea=function(){var r=this,a=this.props,s=a.children,i=a.preserveWhitespace,o=this.state.generation,l={key:o,ref:function(c){r.editingArea=c}};return Io.default.Children.count(s)?Io.default.cloneElement(Io.default.Children.only(s),l):i?Io.default.createElement("pre",sx({},l)):Io.default.createElement("div",sx({},l))},t.prototype.render=function(){var r;return Io.default.createElement("div",{id:this.props.id,style:this.props.style,key:this.state.generation,className:"quill "+(r=this.props.className,r??""),onKeyPress:this.props.onKeyPress,onKeyDown:this.props.onKeyDown,onKeyUp:this.props.onKeyUp},this.renderEditingArea())},t.prototype.onEditorChangeText=function(r,a,s,i){var o,l;if(this.editor){var c=this.isDelta(this.value)?i.getContents():i.getHTML();c!==this.getEditorContents()&&(this.lastDeltaChangeSet=a,this.value=c,(l=(o=this.props).onChange)===null||l===void 0||l.call(o,r,a,s,i))}},t.prototype.onEditorChangeSelection=function(r,a,s){var i,o,l,c,d,u;if(this.editor){var f=this.getEditorSelection(),h=!f&&r,A=f&&!r;Kh.default(r,f)||(this.selection=r,(o=(i=this.props).onChangeSelection)===null||o===void 0||o.call(i,r,a,s),h?(c=(l=this.props).onFocus)===null||c===void 0||c.call(l,r,a,s):A&&((u=(d=this.props).onBlur)===null||u===void 0||u.call(d,f,a,s)))}},t.prototype.focus=function(){this.editor&&this.editor.focus()},t.prototype.blur=function(){this.editor&&(this.selection=null,this.editor.blur())},t.displayName="React Quill",t.Quill=pC.default,t.defaultProps={theme:"snow",modules:{},readOnly:!1},t}(Io.default.Component);function mC(e){Promise.resolve().then(e)}var qJ=HJ;const $J=RS(qJ);function KJ({isOpen:e,onClose:t,mode:r="compose",replyTo:a,onSend:s}){const[i,o]=Q.useState([]),[l,c]=Q.useState([]),[d,u]=Q.useState([]),[f,h]=Q.useState(!1),[A,x]=Q.useState(!1),[p,b]=Q.useState(""),[m,g]=Q.useState(""),[y,v]=Q.useState(""),[_,j]=Q.useState(""),[N,B]=Q.useState(""),[E,C]=Q.useState([]),[k,w]=Q.useState(!1),[T,R]=Q.useState(!1),[q,z]=Q.useState(!1),[ee,Y]=Q.useState([]),[G,re]=Q.useState(!1),[U,S]=Q.useState(null),[D,L]=Q.useState(!1),P=Q.useRef(null),I=Q.useRef(null),H=Q.useRef(null),V=Q.useRef(null);Q.useEffect(()=>{if(r==="reply"&&a){j(a.subject.startsWith("Re: ")?a.subject:`Re: ${a.subject}`),o([{name:a.from,email:a.fromEmail}]);const ge=W(a);B(ge)}else if(r==="forward"&&a){j(a.subject.startsWith("Fwd: ")?a.subject:`Fwd: ${a.subject}`);const ge=M(a);B(ge)}},[r,a]),Q.useEffect(()=>{const ge=Re=>{V.current&&!V.current.contains(Re.target)&&re(!1)};if(G)return document.addEventListener("mousedown",ge),()=>document.removeEventListener("mousedown",ge)},[G]);const W=ge=>{var Fe;if(!ge)return"";const Re=ge.date.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric"}),et=ge.date.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}),Ye=`<div style="margin-top: 20px; color: #666;">On ${Re} at ${et}, ${ge.from} &lt;${ge.fromEmail}&gt; wrote:</div>`,Be=`<blockquote style="margin: 10px 0 0 0; padding-left: 16px; border-left: 4px solid #ccc; color: #666;">${ge.htmlBody||((Fe=ge.body)==null?void 0:Fe.replace(/\n/g,"<br>"))||""}</blockquote>`;return`<p><br></p><p><br></p>${Ye}${Be}`},M=ge=>{var Ye;if(!ge)return"";const Re=ge.date.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"});return`<p><br></p><p><br></p>${`<div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid #ccc;">
      <div style="color: #666; margin-bottom: 10px;">---------- Forwarded message ---------</div>
      <div style="color: #666;"><strong>From:</strong> ${ge.from} &lt;${ge.fromEmail}&gt;</div>
      <div style="color: #666;"><strong>Date:</strong> ${Re}</div>
      <div style="color: #666;"><strong>Subject:</strong> ${ge.subject}</div>
      <div style="margin-top: 15px;">${ge.htmlBody||((Ye=ge.body)==null?void 0:Ye.replace(/\n/g,"<br>"))||""}</div>
    </div>`}`},se=Q.useCallback(async ge=>{if(!ge||ge.length<2){Y([]);return}try{const{data:Re}=await Z.from("customers").select("customer_name, email, company_name").eq("is_active",!0).or(`customer_name.ilike.%${ge}%,email.ilike.%${ge}%,company_name.ilike.%${ge}%`).limit(5),{data:et}=await Z.from("crm_contacts").select("contact_person, email, company_name").eq("is_active",!0).or(`contact_person.ilike.%${ge}%,email.ilike.%${ge}%,company_name.ilike.%${ge}%`).limit(5),Ye=[...(Re||[]).map(Be=>({name:Be.customer_name,email:Be.email,company:Be.company_name})),...(et||[]).map(Be=>({name:Be.contact_person,email:Be.email,company:Be.company_name}))];Y(Ye),re(Ye.length>0)}catch(Re){console.error("Error searching customers:",Re)}},[]),K=(ge,Re)=>{Re==="to"?b(ge):Re==="cc"?g(ge):v(ge),S(Re),se(ge)},he=(ge,Re)=>{const et={name:ge.name,email:ge.email};Re==="to"?(o([...i,et]),b("")):Re==="cc"?(c([...l,et]),g("")):(u([...d,et]),v("")),re(!1),Y([])},ne=(ge,Re)=>{Re==="to"?o(i.filter((et,Ye)=>Ye!==ge)):Re==="cc"?c(l.filter((et,Ye)=>Ye!==ge)):u(d.filter((et,Ye)=>Ye!==ge))},te=(ge,Re)=>{const et=Re==="to"?p:Re==="cc"?m:y;if((ge.key==="Enter"||ge.key===","||ge.key===" ")&&et.trim()){if(ge.preventDefault(),ce(et.trim())){const Ye={name:et.trim(),email:et.trim()};Re==="to"?(o([...i,Ye]),b("")):Re==="cc"?(c([...l,Ye]),g("")):(u([...d,Ye]),v("")),re(!1)}}else ge.key==="Backspace"&&!et&&(Re==="to"&&i.length>0?o(i.slice(0,-1)):Re==="cc"&&l.length>0?c(l.slice(0,-1)):Re==="bcc"&&d.length>0&&u(d.slice(0,-1)))},ce=ge=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(ge),_e=ge=>{const Re=ge.target.files;if(!Re)return;const et=[];for(let Ye=0;Ye<Re.length;Ye++){const Be=Re[Ye];if(Be.size>25*1024*1024){alert(`File ${Be.name} is too large. Maximum size is 25MB.`);continue}et.push({file:Be,name:Be.name,size:Be.size})}C(Ye=>[...Ye,...et])},de=ge=>{C(Re=>Re.filter((et,Ye)=>Ye!==ge))},ye=ge=>ge<1024?ge+" B":ge<1024*1024?(ge/1024).toFixed(1)+" KB":(ge/(1024*1024)).toFixed(1)+" MB",Le=async()=>{const ge=[...i.map(Ye=>Ye.email)],Re=[...l.map(Ye=>Ye.email)],et=[...d.map(Ye=>Ye.email)];if(p.trim()&&ce(p.trim())&&ge.push(p.trim()),m.trim()&&ce(m.trim())&&Re.push(m.trim()),y.trim()&&ce(y.trim())&&et.push(y.trim()),ge.length===0||!_||!N){alert("Please fill in recipient, subject, and message");return}w(!0);try{s&&await s({to:ge,cc:Re,bcc:et,subject:_,body:N,attachments:E.map(Ye=>Ye.file)}),alert("Email sent successfully!"),t()}catch(Ye){console.error("Error sending email:",Ye),alert("Failed to send email. Please try again.")}finally{w(!1)}},we={toolbar:[[{header:[1,2,3,!1]}],["bold","italic","underline","strike"],[{color:[]},{background:[]}],[{list:"ordered"},{list:"bullet"}],[{align:[]}],["link","image"],["clean"]]};return e?T?n.jsx("div",{className:"fixed bottom-0 right-4 w-64 bg-gray-800 text-white rounded-t-lg shadow-xl z-50",children:n.jsxs("div",{className:"flex items-center justify-between px-4 py-2 cursor-pointer",onClick:()=>R(!1),children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx($i,{className:"w-4 h-4"}),n.jsx("span",{className:"text-sm font-medium truncate",children:_||"New Message"})]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("button",{onClick:ge=>{ge.stopPropagation(),R(!1)},className:"p-1 hover:bg-gray-700 rounded",children:n.jsx(w5,{className:"w-4 h-4"})}),n.jsx("button",{onClick:ge=>{ge.stopPropagation(),t()},className:"p-1 hover:bg-gray-700 rounded",children:n.jsx(wr,{className:"w-4 h-4"})})]})]})}):n.jsxs("div",{className:`fixed ${q?"inset-0":"bottom-0 right-6 w-[480px] h-[600px]"} bg-white rounded-t-lg shadow-2xl z-40 flex flex-col`,children:[n.jsxs("div",{className:"flex items-center justify-between px-4 py-2 bg-gray-50 border-b border-gray-200 rounded-t-lg",children:[n.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:r==="reply"?"Reply":r==="forward"?"Forward":"New Message"}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("button",{onClick:()=>R(!0),className:"p-1.5 hover:bg-gray-200 rounded transition",title:"Minimize",children:n.jsx(Mg,{className:"w-4 h-4 text-gray-600"})}),n.jsx("button",{onClick:()=>z(!q),className:"p-1.5 hover:bg-gray-200 rounded transition",title:q?"Exit fullscreen":"Fullscreen",children:q?n.jsx(C7,{className:"w-4 h-4 text-gray-600"}):n.jsx(w5,{className:"w-4 h-4 text-gray-600"})}),n.jsx("button",{onClick:t,className:"p-1.5 hover:bg-gray-200 rounded transition",title:"Close",children:n.jsx(wr,{className:"w-4 h-4 text-gray-600"})})]})]}),n.jsxs("div",{className:"border-b border-gray-200 bg-white",children:[n.jsxs("div",{className:"flex items-start px-4 py-2 border-b border-gray-100",children:[n.jsx("span",{className:"text-sm text-gray-600 w-12 pt-1",children:"To"}),n.jsxs("div",{className:"flex-1 flex flex-wrap items-center gap-1",children:[i.map((ge,Re)=>n.jsxs("div",{className:"flex items-center gap-1 px-2 py-0.5 bg-blue-100 text-blue-800 rounded-full text-xs",children:[n.jsx("span",{children:ge.name}),n.jsx("button",{onClick:()=>ne(Re,"to"),className:"hover:text-blue-900",children:n.jsx(wr,{className:"w-3 h-3"})})]},Re)),n.jsx("input",{ref:H,type:"text",value:p,onChange:ge=>K(ge.target.value,"to"),onKeyDown:ge=>te(ge,"to"),onFocus:()=>S("to"),onBlur:()=>{setTimeout(()=>re(!1),200)},placeholder:i.length===0?"Type or search recipients":"",className:"flex-1 min-w-[120px] outline-none text-sm py-1"})]}),n.jsxs("div",{className:"flex items-center gap-2 text-xs ml-2",children:[!f&&n.jsx("button",{onClick:()=>h(!0),className:"text-blue-600 hover:text-blue-700",children:"Cc"}),!A&&n.jsx("button",{onClick:()=>x(!0),className:"text-blue-600 hover:text-blue-700",children:"Bcc"})]})]}),f&&n.jsxs("div",{className:"flex items-start px-4 py-2 border-b border-gray-100",children:[n.jsx("span",{className:"text-sm text-gray-600 w-12 pt-1",children:"Cc"}),n.jsxs("div",{className:"flex-1 flex flex-wrap items-center gap-1",children:[l.map((ge,Re)=>n.jsxs("div",{className:"flex items-center gap-1 px-2 py-0.5 bg-blue-100 text-blue-800 rounded-full text-xs",children:[n.jsx("span",{children:ge.name}),n.jsx("button",{onClick:()=>ne(Re,"cc"),className:"hover:text-blue-900",children:n.jsx(wr,{className:"w-3 h-3"})})]},Re)),n.jsx("input",{type:"text",value:m,onChange:ge=>K(ge.target.value,"cc"),onKeyDown:ge=>te(ge,"cc"),onFocus:()=>S("cc"),onBlur:()=>{setTimeout(()=>re(!1),200)},placeholder:l.length===0?"Type or search Cc recipients":"",className:"flex-1 min-w-[120px] outline-none text-sm py-1"})]})]}),A&&n.jsxs("div",{className:"flex items-start px-4 py-2 border-b border-gray-100",children:[n.jsx("span",{className:"text-sm text-gray-600 w-12 pt-1",children:"Bcc"}),n.jsxs("div",{className:"flex-1 flex flex-wrap items-center gap-1",children:[d.map((ge,Re)=>n.jsxs("div",{className:"flex items-center gap-1 px-2 py-0.5 bg-blue-100 text-blue-800 rounded-full text-xs",children:[n.jsx("span",{children:ge.name}),n.jsx("button",{onClick:()=>ne(Re,"bcc"),className:"hover:text-blue-900",children:n.jsx(wr,{className:"w-3 h-3"})})]},Re)),n.jsx("input",{type:"text",value:y,onChange:ge=>K(ge.target.value,"bcc"),onKeyDown:ge=>te(ge,"bcc"),onFocus:()=>S("bcc"),onBlur:()=>{setTimeout(()=>re(!1),200)},placeholder:d.length===0?"Type or search Bcc recipients":"",className:"flex-1 min-w-[120px] outline-none text-sm py-1"})]})]}),G&&ee.length>0&&U&&n.jsx("div",{ref:V,className:"absolute bg-white border border-gray-200 shadow-lg rounded-lg mt-1 max-h-48 overflow-y-auto z-50 w-96 ml-16",children:ee.map((ge,Re)=>n.jsxs("button",{onMouseDown:et=>{et.preventDefault(),he(ge,U)},className:"w-full px-4 py-2 text-left hover:bg-gray-50 border-b border-gray-100 last:border-b-0",children:[n.jsx("div",{className:"text-sm font-medium text-gray-900",children:ge.name}),n.jsx("div",{className:"text-xs text-gray-500",children:ge.email}),ge.company&&n.jsx("div",{className:"text-xs text-gray-400",children:ge.company})]},Re))}),n.jsx("div",{className:"px-4 pb-2 text-[11px] text-gray-500 italic",children:"Tip: Type email addresses and press Enter, comma, or space to add. Or search from contacts."}),n.jsxs("div",{className:"flex items-center px-4 py-2",children:[n.jsx("span",{className:"text-sm text-gray-600 w-12",children:"Subject"}),n.jsx("input",{type:"text",value:_,onChange:ge=>j(ge.target.value),placeholder:"Subject",className:"flex-1 outline-none text-sm"})]})]}),n.jsxs("div",{className:"flex-1 overflow-hidden flex flex-col",children:[n.jsx("style",{children:`
          .quill-editor-container .ql-container {
            font-size: 14px;
            font-family: Arial, sans-serif;
            overflow-y: auto !important;
            max-height: 100%;
          }
          .quill-editor-container .ql-editor {
            min-height: 200px;
            overflow-y: auto !important;
          }
          .quill-editor-container .ql-editor table {
            border-collapse: collapse;
            width: 100%;
            margin: 12px 0;
          }
          .quill-editor-container .ql-editor table td,
          .quill-editor-container .ql-editor table th {
            border: 1px solid #ddd;
            padding: 8px;
          }
          .quill-editor-container .ql-editor blockquote {
            border-left: 4px solid #ccc;
            padding-left: 16px;
            color: #666;
            margin: 10px 0;
          }
          .quill-editor-container .ql-editor img {
            max-width: 100%;
            height: auto;
          }
        `}),n.jsx($J,{ref:I,theme:"snow",value:N,onChange:B,modules:we,className:"quill-editor-container flex-1",style:{display:"flex",flexDirection:"column",height:"100%"}})]}),E.length>0&&n.jsx("div",{className:"px-4 py-2 border-t border-gray-200 bg-gray-50 max-h-32 overflow-y-auto",children:n.jsx("div",{className:"space-y-1",children:E.map((ge,Re)=>n.jsxs("div",{className:"flex items-center justify-between p-2 bg-white rounded border border-gray-200",children:[n.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[n.jsx(Wo,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}),n.jsx("span",{className:"text-sm text-gray-700 truncate",children:ge.name}),n.jsxs("span",{className:"text-xs text-gray-500 flex-shrink-0",children:["(",ye(ge.size),")"]})]}),n.jsx("button",{onClick:()=>de(Re),className:"text-red-600 hover:text-red-700 ml-2",children:n.jsx(wr,{className:"w-4 h-4"})})]},Re))})}),n.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t border-gray-200 bg-white rounded-b-lg",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:Le,disabled:k||i.length===0&&(!p.trim()||!ce(p.trim()))||!_||!N,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed text-sm font-medium",children:k?n.jsxs(n.Fragment,{children:[n.jsx(Vo,{className:"w-4 h-4 animate-spin"}),"Sending..."]}):n.jsxs(n.Fragment,{children:[n.jsx($i,{className:"w-4 h-4"}),"Send"]})}),n.jsx("input",{ref:P,type:"file",multiple:!0,onChange:_e,className:"hidden"}),n.jsx("button",{onClick:()=>{var ge;return(ge=P.current)==null?void 0:ge.click()},className:"p-2 hover:bg-gray-100 rounded transition",title:"Attach files",children:n.jsx(Wo,{className:"w-5 h-5 text-gray-600"})})]}),n.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded transition",title:"Discard",children:n.jsx(Lr,{className:"w-5 h-5 text-gray-600"})})]})]}):null}/*! @license DOMPurify 3.3.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.1/LICENSE */const{entries:VF,setPrototypeOf:gC,isFrozen:VJ,getPrototypeOf:WJ,getOwnPropertyDescriptor:zJ}=Object;let{freeze:Ts,seal:Vi,create:H_}=Object,{apply:q_,construct:$_}=typeof Reflect<"u"&&Reflect;Ts||(Ts=function(t){return t});Vi||(Vi=function(t){return t});q_||(q_=function(t,r){for(var a=arguments.length,s=new Array(a>2?a-2:0),i=2;i<a;i++)s[i-2]=arguments[i];return t.apply(r,s)});$_||($_=function(t){for(var r=arguments.length,a=new Array(r>1?r-1:0),s=1;s<r;s++)a[s-1]=arguments[s];return new t(...a)});const Sm=Is(Array.prototype.forEach),GJ=Is(Array.prototype.lastIndexOf),xC=Is(Array.prototype.pop),Vh=Is(Array.prototype.push),XJ=Is(Array.prototype.splice),ug=Is(String.prototype.toLowerCase),b1=Is(String.prototype.toString),_1=Is(String.prototype.match),Wh=Is(String.prototype.replace),YJ=Is(String.prototype.indexOf),JJ=Is(String.prototype.trim),so=Is(Object.prototype.hasOwnProperty),bs=Is(RegExp.prototype.test),zh=ZJ(TypeError);function Is(e){return function(t){t instanceof RegExp&&(t.lastIndex=0);for(var r=arguments.length,a=new Array(r>1?r-1:0),s=1;s<r;s++)a[s-1]=arguments[s];return q_(e,t,a)}}function ZJ(e){return function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return $_(e,r)}}function br(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ug;gC&&gC(e,null);let a=t.length;for(;a--;){let s=t[a];if(typeof s=="string"){const i=r(s);i!==s&&(VJ(t)||(t[a]=i),s=i)}e[s]=!0}return e}function eZ(e){for(let t=0;t<e.length;t++)so(e,t)||(e[t]=null);return e}function Po(e){const t=H_(null);for(const[r,a]of VF(e))so(e,r)&&(Array.isArray(a)?t[r]=eZ(a):a&&typeof a=="object"&&a.constructor===Object?t[r]=Po(a):t[r]=a);return t}function Gh(e,t){for(;e!==null;){const a=zJ(e,t);if(a){if(a.get)return Is(a.get);if(typeof a.value=="function")return Is(a.value)}e=WJ(e)}function r(){return null}return r}const yC=Ts(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),w1=Ts(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),N1=Ts(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),tZ=Ts(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),j1=Ts(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),rZ=Ts(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),vC=Ts(["#text"]),bC=Ts(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),k1=Ts(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),_C=Ts(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Bm=Ts(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),nZ=Vi(/\{\{[\w\W]*|[\w\W]*\}\}/gm),aZ=Vi(/<%[\w\W]*|[\w\W]*%>/gm),sZ=Vi(/\$\{[\w\W]*/gm),iZ=Vi(/^data-[\-\w.\u00B7-\uFFFF]+$/),oZ=Vi(/^aria-[\-\w]+$/),WF=Vi(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),lZ=Vi(/^(?:\w+script|data):/i),cZ=Vi(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),zF=Vi(/^html$/i),dZ=Vi(/^[a-z][.\w]*(-[.\w]+)+$/i);var wC=Object.freeze({__proto__:null,ARIA_ATTR:oZ,ATTR_WHITESPACE:cZ,CUSTOM_ELEMENT:dZ,DATA_ATTR:iZ,DOCTYPE_NAME:zF,ERB_EXPR:aZ,IS_ALLOWED_URI:WF,IS_SCRIPT_OR_DATA:lZ,MUSTACHE_EXPR:nZ,TMPLIT_EXPR:sZ});const Xh={element:1,text:3,progressingInstruction:7,comment:8,document:9},uZ=function(){return typeof window>"u"?null:window},AZ=function(t,r){if(typeof t!="object"||typeof t.createPolicy!="function")return null;let a=null;const s="data-tt-policy-suffix";r&&r.hasAttribute(s)&&(a=r.getAttribute(s));const i="dompurify"+(a?"#"+a:"");try{return t.createPolicy(i,{createHTML(o){return o},createScriptURL(o){return o}})}catch{return console.warn("TrustedTypes policy "+i+" could not be created."),null}},NC=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function GF(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:uZ();const t=Me=>GF(Me);if(t.version="3.3.1",t.removed=[],!e||!e.document||e.document.nodeType!==Xh.document||!e.Element)return t.isSupported=!1,t;let{document:r}=e;const a=r,s=a.currentScript,{DocumentFragment:i,HTMLTemplateElement:o,Node:l,Element:c,NodeFilter:d,NamedNodeMap:u=e.NamedNodeMap||e.MozNamedAttrMap,HTMLFormElement:f,DOMParser:h,trustedTypes:A}=e,x=c.prototype,p=Gh(x,"cloneNode"),b=Gh(x,"remove"),m=Gh(x,"nextSibling"),g=Gh(x,"childNodes"),y=Gh(x,"parentNode");if(typeof o=="function"){const Me=r.createElement("template");Me.content&&Me.content.ownerDocument&&(r=Me.content.ownerDocument)}let v,_="";const{implementation:j,createNodeIterator:N,createDocumentFragment:B,getElementsByTagName:E}=r,{importNode:C}=a;let k=NC();t.isSupported=typeof VF=="function"&&typeof y=="function"&&j&&j.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:w,ERB_EXPR:T,TMPLIT_EXPR:R,DATA_ATTR:q,ARIA_ATTR:z,IS_SCRIPT_OR_DATA:ee,ATTR_WHITESPACE:Y,CUSTOM_ELEMENT:G}=wC;let{IS_ALLOWED_URI:re}=wC,U=null;const S=br({},[...yC,...w1,...N1,...j1,...vC]);let D=null;const L=br({},[...bC,...k1,..._C,...Bm]);let P=Object.seal(H_(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),I=null,H=null;const V=Object.seal(H_(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let W=!0,M=!0,se=!1,K=!0,he=!1,ne=!0,te=!1,ce=!1,_e=!1,de=!1,ye=!1,Le=!1,we=!0,ge=!1;const Re="user-content-";let et=!0,Ye=!1,Be={},Fe=null;const oe=br({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let ke=null;const Ue=br({},["audio","video","img","source","image","track"]);let qe=null;const $e=br({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Ne="http://www.w3.org/1998/Math/MathML",Ee="http://www.w3.org/2000/svg",ze="http://www.w3.org/1999/xhtml";let rt=ze,nt=!1,mt=null;const gt=br({},[Ne,Ee,ze],b1);let Nt=br({},["mi","mo","mn","ms","mtext"]),yt=br({},["annotation-xml"]);const Et=br({},["title","style","font","a","script"]);let It=null;const ir=["application/xhtml+xml","text/html"],Oe="text/html";let tt=null,At=null;const wt=r.createElement("form"),ht=function(Ce){return Ce instanceof RegExp||Ce instanceof Function},Ft=function(){let Ce=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(At&&At===Ce)){if((!Ce||typeof Ce!="object")&&(Ce={}),Ce=Po(Ce),It=ir.indexOf(Ce.PARSER_MEDIA_TYPE)===-1?Oe:Ce.PARSER_MEDIA_TYPE,tt=It==="application/xhtml+xml"?b1:ug,U=so(Ce,"ALLOWED_TAGS")?br({},Ce.ALLOWED_TAGS,tt):S,D=so(Ce,"ALLOWED_ATTR")?br({},Ce.ALLOWED_ATTR,tt):L,mt=so(Ce,"ALLOWED_NAMESPACES")?br({},Ce.ALLOWED_NAMESPACES,b1):gt,qe=so(Ce,"ADD_URI_SAFE_ATTR")?br(Po($e),Ce.ADD_URI_SAFE_ATTR,tt):$e,ke=so(Ce,"ADD_DATA_URI_TAGS")?br(Po(Ue),Ce.ADD_DATA_URI_TAGS,tt):Ue,Fe=so(Ce,"FORBID_CONTENTS")?br({},Ce.FORBID_CONTENTS,tt):oe,I=so(Ce,"FORBID_TAGS")?br({},Ce.FORBID_TAGS,tt):Po({}),H=so(Ce,"FORBID_ATTR")?br({},Ce.FORBID_ATTR,tt):Po({}),Be=so(Ce,"USE_PROFILES")?Ce.USE_PROFILES:!1,W=Ce.ALLOW_ARIA_ATTR!==!1,M=Ce.ALLOW_DATA_ATTR!==!1,se=Ce.ALLOW_UNKNOWN_PROTOCOLS||!1,K=Ce.ALLOW_SELF_CLOSE_IN_ATTR!==!1,he=Ce.SAFE_FOR_TEMPLATES||!1,ne=Ce.SAFE_FOR_XML!==!1,te=Ce.WHOLE_DOCUMENT||!1,de=Ce.RETURN_DOM||!1,ye=Ce.RETURN_DOM_FRAGMENT||!1,Le=Ce.RETURN_TRUSTED_TYPE||!1,_e=Ce.FORCE_BODY||!1,we=Ce.SANITIZE_DOM!==!1,ge=Ce.SANITIZE_NAMED_PROPS||!1,et=Ce.KEEP_CONTENT!==!1,Ye=Ce.IN_PLACE||!1,re=Ce.ALLOWED_URI_REGEXP||WF,rt=Ce.NAMESPACE||ze,Nt=Ce.MATHML_TEXT_INTEGRATION_POINTS||Nt,yt=Ce.HTML_INTEGRATION_POINTS||yt,P=Ce.CUSTOM_ELEMENT_HANDLING||{},Ce.CUSTOM_ELEMENT_HANDLING&&ht(Ce.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(P.tagNameCheck=Ce.CUSTOM_ELEMENT_HANDLING.tagNameCheck),Ce.CUSTOM_ELEMENT_HANDLING&&ht(Ce.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(P.attributeNameCheck=Ce.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),Ce.CUSTOM_ELEMENT_HANDLING&&typeof Ce.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(P.allowCustomizedBuiltInElements=Ce.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),he&&(M=!1),ye&&(de=!0),Be&&(U=br({},vC),D=[],Be.html===!0&&(br(U,yC),br(D,bC)),Be.svg===!0&&(br(U,w1),br(D,k1),br(D,Bm)),Be.svgFilters===!0&&(br(U,N1),br(D,k1),br(D,Bm)),Be.mathMl===!0&&(br(U,j1),br(D,_C),br(D,Bm))),Ce.ADD_TAGS&&(typeof Ce.ADD_TAGS=="function"?V.tagCheck=Ce.ADD_TAGS:(U===S&&(U=Po(U)),br(U,Ce.ADD_TAGS,tt))),Ce.ADD_ATTR&&(typeof Ce.ADD_ATTR=="function"?V.attributeCheck=Ce.ADD_ATTR:(D===L&&(D=Po(D)),br(D,Ce.ADD_ATTR,tt))),Ce.ADD_URI_SAFE_ATTR&&br(qe,Ce.ADD_URI_SAFE_ATTR,tt),Ce.FORBID_CONTENTS&&(Fe===oe&&(Fe=Po(Fe)),br(Fe,Ce.FORBID_CONTENTS,tt)),Ce.ADD_FORBID_CONTENTS&&(Fe===oe&&(Fe=Po(Fe)),br(Fe,Ce.ADD_FORBID_CONTENTS,tt)),et&&(U["#text"]=!0),te&&br(U,["html","head","body"]),U.table&&(br(U,["tbody"]),delete I.tbody),Ce.TRUSTED_TYPES_POLICY){if(typeof Ce.TRUSTED_TYPES_POLICY.createHTML!="function")throw zh('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof Ce.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw zh('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');v=Ce.TRUSTED_TYPES_POLICY,_=v.createHTML("")}else v===void 0&&(v=AZ(A,s)),v!==null&&typeof _=="string"&&(_=v.createHTML(""));Ts&&Ts(Ce),At=Ce}},Ht=br({},[...w1,...N1,...tZ]),vr=br({},[...j1,...rZ]),xr=function(Ce){let We=y(Ce);(!We||!We.tagName)&&(We={namespaceURI:rt,tagName:"template"});const Je=ug(Ce.tagName),ot=ug(We.tagName);return mt[Ce.namespaceURI]?Ce.namespaceURI===Ee?We.namespaceURI===ze?Je==="svg":We.namespaceURI===Ne?Je==="svg"&&(ot==="annotation-xml"||Nt[ot]):!!Ht[Je]:Ce.namespaceURI===Ne?We.namespaceURI===ze?Je==="math":We.namespaceURI===Ee?Je==="math"&&yt[ot]:!!vr[Je]:Ce.namespaceURI===ze?We.namespaceURI===Ee&&!yt[ot]||We.namespaceURI===Ne&&!Nt[ot]?!1:!vr[Je]&&(Et[Je]||!Ht[Je]):!!(It==="application/xhtml+xml"&&mt[Ce.namespaceURI]):!1},Jt=function(Ce){Vh(t.removed,{element:Ce});try{y(Ce).removeChild(Ce)}catch{b(Ce)}},Wt=function(Ce,We){try{Vh(t.removed,{attribute:We.getAttributeNode(Ce),from:We})}catch{Vh(t.removed,{attribute:null,from:We})}if(We.removeAttribute(Ce),Ce==="is")if(de||ye)try{Jt(We)}catch{}else try{We.setAttribute(Ce,"")}catch{}},ue=function(Ce){let We=null,Je=null;if(_e)Ce="<remove></remove>"+Ce;else{const kt=_1(Ce,/^[\r\n\t ]+/);Je=kt&&kt[0]}It==="application/xhtml+xml"&&rt===ze&&(Ce='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+Ce+"</body></html>");const ot=v?v.createHTML(Ce):Ce;if(rt===ze)try{We=new h().parseFromString(ot,It)}catch{}if(!We||!We.documentElement){We=j.createDocument(rt,"template",null);try{We.documentElement.innerHTML=nt?_:ot}catch{}}const lt=We.body||We.documentElement;return Ce&&Je&&lt.insertBefore(r.createTextNode(Je),lt.childNodes[0]||null),rt===ze?E.call(We,te?"html":"body")[0]:te?We.documentElement:lt},ie=function(Ce){return N.call(Ce.ownerDocument||Ce,Ce,d.SHOW_ELEMENT|d.SHOW_COMMENT|d.SHOW_TEXT|d.SHOW_PROCESSING_INSTRUCTION|d.SHOW_CDATA_SECTION,null)},Ae=function(Ce){return Ce instanceof f&&(typeof Ce.nodeName!="string"||typeof Ce.textContent!="string"||typeof Ce.removeChild!="function"||!(Ce.attributes instanceof u)||typeof Ce.removeAttribute!="function"||typeof Ce.setAttribute!="function"||typeof Ce.namespaceURI!="string"||typeof Ce.insertBefore!="function"||typeof Ce.hasChildNodes!="function")},le=function(Ce){return typeof l=="function"&&Ce instanceof l};function ve(Me,Ce,We){Sm(Me,Je=>{Je.call(t,Ce,We,At)})}const me=function(Ce){let We=null;if(ve(k.beforeSanitizeElements,Ce,null),Ae(Ce))return Jt(Ce),!0;const Je=tt(Ce.nodeName);if(ve(k.uponSanitizeElement,Ce,{tagName:Je,allowedTags:U}),ne&&Ce.hasChildNodes()&&!le(Ce.firstElementChild)&&bs(/<[/\w!]/g,Ce.innerHTML)&&bs(/<[/\w!]/g,Ce.textContent)||Ce.nodeType===Xh.progressingInstruction||ne&&Ce.nodeType===Xh.comment&&bs(/<[/\w]/g,Ce.data))return Jt(Ce),!0;if(!(V.tagCheck instanceof Function&&V.tagCheck(Je))&&(!U[Je]||I[Je])){if(!I[Je]&&Qe(Je)&&(P.tagNameCheck instanceof RegExp&&bs(P.tagNameCheck,Je)||P.tagNameCheck instanceof Function&&P.tagNameCheck(Je)))return!1;if(et&&!Fe[Je]){const ot=y(Ce)||Ce.parentNode,lt=g(Ce)||Ce.childNodes;if(lt&&ot){const kt=lt.length;for(let Xt=kt-1;Xt>=0;--Xt){const $t=p(lt[Xt],!0);$t.__removalCount=(Ce.__removalCount||0)+1,ot.insertBefore($t,m(Ce))}}}return Jt(Ce),!0}return Ce instanceof c&&!xr(Ce)||(Je==="noscript"||Je==="noembed"||Je==="noframes")&&bs(/<\/no(script|embed|frames)/i,Ce.innerHTML)?(Jt(Ce),!0):(he&&Ce.nodeType===Xh.text&&(We=Ce.textContent,Sm([w,T,R],ot=>{We=Wh(We,ot," ")}),Ce.textContent!==We&&(Vh(t.removed,{element:Ce.cloneNode()}),Ce.textContent=We)),ve(k.afterSanitizeElements,Ce,null),!1)},Pe=function(Ce,We,Je){if(we&&(We==="id"||We==="name")&&(Je in r||Je in wt))return!1;if(!(M&&!H[We]&&bs(q,We))){if(!(W&&bs(z,We))){if(!(V.attributeCheck instanceof Function&&V.attributeCheck(We,Ce))){if(!D[We]||H[We]){if(!(Qe(Ce)&&(P.tagNameCheck instanceof RegExp&&bs(P.tagNameCheck,Ce)||P.tagNameCheck instanceof Function&&P.tagNameCheck(Ce))&&(P.attributeNameCheck instanceof RegExp&&bs(P.attributeNameCheck,We)||P.attributeNameCheck instanceof Function&&P.attributeNameCheck(We,Ce))||We==="is"&&P.allowCustomizedBuiltInElements&&(P.tagNameCheck instanceof RegExp&&bs(P.tagNameCheck,Je)||P.tagNameCheck instanceof Function&&P.tagNameCheck(Je))))return!1}else if(!qe[We]){if(!bs(re,Wh(Je,Y,""))){if(!((We==="src"||We==="xlink:href"||We==="href")&&Ce!=="script"&&YJ(Je,"data:")===0&&ke[Ce])){if(!(se&&!bs(ee,Wh(Je,Y,"")))){if(Je)return!1}}}}}}}return!0},Qe=function(Ce){return Ce!=="annotation-xml"&&_1(Ce,G)},Ke=function(Ce){ve(k.beforeSanitizeAttributes,Ce,null);const{attributes:We}=Ce;if(!We||Ae(Ce))return;const Je={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:D,forceKeepAttr:void 0};let ot=We.length;for(;ot--;){const lt=We[ot],{name:kt,namespaceURI:Xt,value:$t}=lt,Pt=tt(kt),jr=$t;let tr=kt==="value"?jr:JJ(jr);if(Je.attrName=Pt,Je.attrValue=tr,Je.keepAttr=!0,Je.forceKeepAttr=void 0,ve(k.uponSanitizeAttribute,Ce,Je),tr=Je.attrValue,ge&&(Pt==="id"||Pt==="name")&&(Wt(kt,Ce),tr=Re+tr),ne&&bs(/((--!?|])>)|<\/(style|title|textarea)/i,tr)){Wt(kt,Ce);continue}if(Pt==="attributename"&&_1(tr,"href")){Wt(kt,Ce);continue}if(Je.forceKeepAttr)continue;if(!Je.keepAttr){Wt(kt,Ce);continue}if(!K&&bs(/\/>/i,tr)){Wt(kt,Ce);continue}he&&Sm([w,T,R],Hr=>{tr=Wh(tr,Hr," ")});const Er=tt(Ce.nodeName);if(!Pe(Er,Pt,tr)){Wt(kt,Ce);continue}if(v&&typeof A=="object"&&typeof A.getAttributeType=="function"&&!Xt)switch(A.getAttributeType(Er,Pt)){case"TrustedHTML":{tr=v.createHTML(tr);break}case"TrustedScriptURL":{tr=v.createScriptURL(tr);break}}if(tr!==jr)try{Xt?Ce.setAttributeNS(Xt,kt,tr):Ce.setAttribute(kt,tr),Ae(Ce)?Jt(Ce):xC(t.removed)}catch{Wt(kt,Ce)}}ve(k.afterSanitizeAttributes,Ce,null)},Xe=function Me(Ce){let We=null;const Je=ie(Ce);for(ve(k.beforeSanitizeShadowDOM,Ce,null);We=Je.nextNode();)ve(k.uponSanitizeShadowNode,We,null),me(We),Ke(We),We.content instanceof i&&Me(We.content);ve(k.afterSanitizeShadowDOM,Ce,null)};return t.sanitize=function(Me){let Ce=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},We=null,Je=null,ot=null,lt=null;if(nt=!Me,nt&&(Me="<!-->"),typeof Me!="string"&&!le(Me))if(typeof Me.toString=="function"){if(Me=Me.toString(),typeof Me!="string")throw zh("dirty is not a string, aborting")}else throw zh("toString is not a function");if(!t.isSupported)return Me;if(ce||Ft(Ce),t.removed=[],typeof Me=="string"&&(Ye=!1),Ye){if(Me.nodeName){const $t=tt(Me.nodeName);if(!U[$t]||I[$t])throw zh("root node is forbidden and cannot be sanitized in-place")}}else if(Me instanceof l)We=ue("<!---->"),Je=We.ownerDocument.importNode(Me,!0),Je.nodeType===Xh.element&&Je.nodeName==="BODY"||Je.nodeName==="HTML"?We=Je:We.appendChild(Je);else{if(!de&&!he&&!te&&Me.indexOf("<")===-1)return v&&Le?v.createHTML(Me):Me;if(We=ue(Me),!We)return de?null:Le?_:""}We&&_e&&Jt(We.firstChild);const kt=ie(Ye?Me:We);for(;ot=kt.nextNode();)me(ot),Ke(ot),ot.content instanceof i&&Xe(ot.content);if(Ye)return Me;if(de){if(ye)for(lt=B.call(We.ownerDocument);We.firstChild;)lt.appendChild(We.firstChild);else lt=We;return(D.shadowroot||D.shadowrootmode)&&(lt=C.call(a,lt,!0)),lt}let Xt=te?We.outerHTML:We.innerHTML;return te&&U["!doctype"]&&We.ownerDocument&&We.ownerDocument.doctype&&We.ownerDocument.doctype.name&&bs(zF,We.ownerDocument.doctype.name)&&(Xt="<!DOCTYPE "+We.ownerDocument.doctype.name+`>
`+Xt),he&&Sm([w,T,R],$t=>{Xt=Wh(Xt,$t," ")}),v&&Le?v.createHTML(Xt):Xt},t.setConfig=function(){let Me=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ft(Me),ce=!0},t.clearConfig=function(){At=null,ce=!1},t.isValidAttribute=function(Me,Ce,We){At||Ft({});const Je=tt(Me),ot=tt(Ce);return Pe(Je,ot,We)},t.addHook=function(Me,Ce){typeof Ce=="function"&&Vh(k[Me],Ce)},t.removeHook=function(Me,Ce){if(Ce!==void 0){const We=GJ(k[Me],Ce);return We===-1?void 0:XJ(k[Me],We,1)[0]}return xC(k[Me])},t.removeHooks=function(Me){k[Me]=[]},t.removeAllHooks=function(){k=NC()},t}var XF=GF();const hZ=Object.freeze(Object.defineProperty({__proto__:null,default:XF},Symbol.toStringTag,{value:"Module"}));function YF({htmlContent:e,className:t=""}){const r=Q.useRef(null),[a,s]=Q.useState(500),[i,o]=Q.useState({});return Q.useEffect(()=>{var g;if(!r.current||!e)return;const l=r.current;let u=(y=>{const v=document.createElement("textarea");return v.innerHTML=y,v.value})(e);u=u.replace(/<blockquote[^>]*>([\s\S]*?)<\/blockquote>/gi,(y,v,_)=>{const j=Math.random().toString(36).substr(2,9);return`<div class="quoted-section" data-quote-id="${j}">
          <div class="quoted-toggle" onclick="toggleQuote('${j}')">
            <span class="toggle-icon">...</span>
          </div>
          <blockquote class="quoted-content" id="quote-${j}" style="display: none;">${v}</blockquote>
        </div>`});const A=`
      <!DOCTYPE html>
      <html>
        <head>
          <meta charset="UTF-8">
          <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
          <meta name="viewport" content="width=device-width, initial-scale=1.0">
          
      <style>
        * {
          box-sizing: border-box;
        }
        body {
          font-family: Arial, sans-serif;
          font-size: 14px;
          line-height: 1.6;
          color: #202124;
          margin: 0;
          padding: 16px;
          background: white;
          overflow-x: hidden;
          word-wrap: break-word;
        }

        /* Table styling - Gmail style */
        table {
          border-collapse: collapse !important;
          width: auto !important;
          max-width: 100%;
          margin: 12px 0;
          font-size: 13px;
        }

        table, th, td {
          border: 1px solid #000 !important;
        }

        th, td {
          padding: 6px 10px !important;
          text-align: left;
          vertical-align: top;
          word-break: break-word;
        }

        th {
          font-weight: 700 !important;
        }

        /* Preserve inline styles and colors */
        th[bgcolor], td[bgcolor] {
          /* Browser will apply bgcolor attribute */
        }

        /* Common email table colors */
        [bgcolor="#FFFF00"], [bgcolor="yellow"], [style*="background:yellow"], [style*="background-color:yellow"] {
          background-color: #FFFF00 !important;
        }

        [bgcolor="#E6E6FA"], [bgcolor="lavender"], [style*="background:lavender"], [style*="background-color:lavender"] {
          background-color: #E6E6FA !important;
        }

        [style*="color:blue"], [style*="color:#0000FF"] {
          color: #0000FF !important;
        }

        [style*="color:darkblue"], [style*="color:#00008B"] {
          color: #00008B !important;
        }

        /* Typography */
        p {
          margin: 8px 0;
        }

        a {
          color: #1a73e8;
          text-decoration: none;
        }

        a:hover {
          text-decoration: underline;
        }

        strong, b {
          font-weight: 700;
        }

        em, i {
          font-style: italic;
        }

        /* Lists */
        ul, ol {
          margin: 8px 0;
          padding-left: 24px;
        }

        li {
          margin: 4px 0;
        }

        /* Blockquotes */
        blockquote {
          margin: 8px 0;
          padding-left: 16px;
          border-left: 4px solid #ccc;
          color: #666;
        }

        /* Quoted section styling */
        .quoted-section {
          margin: 12px 0;
        }

        .quoted-toggle {
          display: inline-block;
          color: #1a73e8;
          cursor: pointer;
          font-size: 13px;
          padding: 4px 8px;
          border-radius: 4px;
          user-select: none;
        }

        .quoted-toggle:hover {
          background-color: #f0f0f0;
        }

        .toggle-icon {
          display: inline-block;
          font-weight: bold;
        }

        .quoted-content {
          margin-top: 8px;
          padding-left: 16px;
          border-left: 4px solid #ccc;
          color: #666;
        }

        /* Headers */
        h1, h2, h3, h4, h5, h6 {
          margin: 12px 0 8px 0;
          font-weight: 700;
          line-height: 1.3;
        }

        /* Images */
        img {
          max-width: 100%;
          height: auto;
        }

        /* Horizontal rules */
        hr {
          border: none;
          border-top: 1px solid #dadce0;
          margin: 16px 0;
        }

        /* Prevent overflow */
        pre {
          white-space: pre-wrap;
          word-wrap: break-word;
          overflow-x: auto;
        }

        /* Center tag support */
        center {
          text-align: center;
        }
      </style>
    
          <script>
            function toggleQuote(id) {
              const content = document.getElementById('quote-' + id);
              const toggle = content.previousElementSibling.querySelector('.toggle-icon');

              if (content.style.display === 'none') {
                content.style.display = 'block';
                toggle.textContent = '';
              } else {
                content.style.display = 'none';
                toggle.textContent = '...';
              }
            }
          <\/script>
        </head>
        <body>
          ${XF.sanitize(u,{ALLOWED_TAGS:["html","head","body","meta","title","style","p","br","div","span","a","img","strong","em","u","b","i","s","strike","h1","h2","h3","h4","h5","h6","ul","ol","li","table","thead","tbody","tfoot","tr","th","td","font","center","blockquote","pre","code","hr","sup","sub"],ALLOWED_ATTR:["style","class","id","href","target","rel","src","alt","title","width","height","align","valign","border","cellpadding","cellspacing","bgcolor","color","face","size","data-quote-id","onclick"],ALLOW_DATA_ATTR:!0,ALLOWED_URI_REGEXP:/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i})}
        </body>
      </html>
    `,x=new Blob([A],{type:"text/html; charset=UTF-8"}),p=URL.createObjectURL(x);if(l.src=p,!(l.contentDocument||((g=l.contentWindow)==null?void 0:g.document)))return;const m=()=>{var y;try{const v=l.contentDocument||((y=l.contentWindow)==null?void 0:y.document);if(!v)return;const _=()=>{const N=v.body,B=v.documentElement,E=Math.max((N==null?void 0:N.scrollHeight)||0,(N==null?void 0:N.offsetHeight)||0,(B==null?void 0:B.clientHeight)||0,(B==null?void 0:B.scrollHeight)||0,(B==null?void 0:B.offsetHeight)||0);s(Math.max(E+20,100))};_();const j=new ResizeObserver(_);v.body&&j.observe(v.body),setTimeout(_,150),l.__cleanup=()=>{j.disconnect(),URL.revokeObjectURL(p)}}catch(v){console.error("Error measuring iframe height:",v)}};return l.addEventListener("load",m),()=>{l.removeEventListener("load",m),l.__cleanup&&l.__cleanup(),URL.revokeObjectURL(p)}},[e]),!e||e.trim()===""?n.jsx("div",{className:`text-gray-500 italic p-4 ${t}`,children:"No email content available"}):n.jsx("iframe",{ref:r,title:"Email Content",className:`w-full border-0 ${t}`,style:{height:`${a}px`,minHeight:"100px",maxHeight:"800px"},sandbox:"allow-same-origin",loading:"lazy"})}function fZ(){const{setCurrentPage:e}=Go(),[t,r]=Q.useState(null),[a,s]=Q.useState(!0),[i,o]=Q.useState(!1),[l,c]=Q.useState([]),[d,u]=Q.useState(null),[f,h]=Q.useState("INBOX"),[A,x]=Q.useState(""),[p,b]=Q.useState(null),[m,g]=Q.useState(null),[y,v]=Q.useState(!1),[_,j]=Q.useState(!1),[N,B]=Q.useState("compose"),[E,C]=Q.useState(null),[k,w]=Q.useState(null),T=Q.useRef(null);Q.useEffect(()=>{R()},[]),Q.useEffect(()=>{t&&ee()},[t,f]),Q.useEffect(()=>{const ne=te=>{T.current&&!T.current.contains(te.target)&&w(null)};if(k)return document.addEventListener("mousedown",ne),()=>document.removeEventListener("mousedown",ne)},[k]);const R=async()=>{try{console.log("[GmailBrowserInbox] === LOADING GMAIL CONNECTION ===");const{data:{user:ne},error:te}=await Z.auth.getUser();if(console.log("[GmailBrowserInbox] Auth user:",ne==null?void 0:ne.id),console.log("[GmailBrowserInbox] Auth error:",te),te||!ne){console.error("[GmailBrowserInbox] Auth error:",te),b("Not authenticated"),s(!1);return}console.log("[GmailBrowserInbox] Querying gmail_connections for user:",ne.id);const{data:ce,error:_e}=await Z.from("gmail_connections").select("*").eq("user_id",ne.id).eq("is_connected",!0).order("created_at",{ascending:!1}).limit(1).maybeSingle();if(console.log("[GmailBrowserInbox] Query result - data:",ce),console.log("[GmailBrowserInbox] Query result - error:",_e),_e&&_e.code!=="PGRST116")throw console.error("[GmailBrowserInbox] Database error loading connection:",_e),_e;if(!ce){console.error("[GmailBrowserInbox] NO CONNECTION FOUND for user:",ne.id),b("No Gmail account connected. Please connect your Gmail account in Settings."),s(!1);return}console.log("[GmailBrowserInbox] Connection loaded successfully:",ce.email_address),r(ce),b(null)}catch(ne){console.error("[GmailBrowserInbox] Error loading Gmail connection:",ne),b("Failed to load Gmail connection")}finally{s(!1)}},q=async ne=>{if(new Date(ne.access_token_expires_at)>new Date)return ne.access_token;const ce=await fetch("https://oauth2.googleapis.com/token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:"90568246766-durgkfgje103589m6cuk99sv8kim69ec.apps.googleusercontent.com",client_secret:"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",refresh_token:ne.refresh_token,grant_type:"refresh_token"})});if(!ce.ok)throw new Error("Failed to refresh token");const _e=await ce.json(),de=_e.access_token,ye=new Date(Date.now()+_e.expires_in*1e3).toISOString();return await Z.from("gmail_connections").update({access_token:de,access_token_expires_at:ye}).eq("id",ne.id),r({...ne,access_token:de,access_token_expires_at:ye}),de},z=ne=>{switch(ne){case"INBOX":return"in:inbox";case"SENT":return"in:sent";case"STARRED":return"is:starred";case"TRASH":return"in:trash";case"DRAFT":return"in:drafts";case"ALL":return"in:anywhere";default:return"in:inbox"}},ee=async ne=>{if(t){o(!0),b(null);try{const te=await q(t),ce=z(f);let de=`https://gmail.googleapis.com/gmail/v1/users/me/messages?maxResults=50&q=${encodeURIComponent(ce)}`;ne&&(de+=`&pageToken=${ne}`);const ye=await fetch(de,{headers:{Authorization:`Bearer ${te}`}});if(!ye.ok)throw new Error("Failed to fetch emails from Gmail");const Le=await ye.json(),we=Le.messages||[];g(Le.nextPageToken||null);const ge=[],Re=5,et=100;for(let Ye=0;Ye<we.length;Ye+=Re){const Fe=we.slice(Ye,Ye+Re).map(async Ue=>{try{const qe=await fetch(`https://gmail.googleapis.com/gmail/v1/users/me/messages/${Ue.id}?format=full`,{headers:{Authorization:`Bearer ${te}`}});if(!qe.ok)return qe.status===429&&(console.warn("Rate limit hit, slowing down..."),await new Promise(Ne=>setTimeout(Ne,1e3))),null;const $e=await qe.json();return Y($e)}catch(qe){return console.error("Error fetching message:",qe),null}}),ke=(await Promise.all(Fe)).filter(Ue=>Ue!==null);ge.push(...ke),Ye+Re<we.length&&await new Promise(Ue=>setTimeout(Ue,et))}c(ne?[...l,...ge]:ge)}catch(te){console.error("Error loading emails:",te),b("Failed to load emails from Gmail")}finally{o(!1)}}},Y=ne=>{var te,ce,_e;try{const de=ne.payload.headers,ye=G(de,"subject")||"(No Subject)",Le=G(de,"from")||"",we=G(de,"to")||"",ge=G(de,"cc")||"",Re=((te=Le.match(/<(.+?)>/))==null?void 0:te[1])||Le,et=Le.replace(/<.+?>/,"").trim()||Re,Ye=new Date(parseInt(ne.internalDate)),Be=((ce=ne.labelIds)==null?void 0:ce.includes("UNREAD"))||!1,Fe=((_e=ne.labelIds)==null?void 0:_e.includes("STARRED"))||!1,{text:oe,html:ke,attachments:Ue}=U(ne.payload);return{id:ne.id,threadId:ne.threadId,subject:ye,from:et,fromEmail:Re,to:we,cc:ge,snippet:ne.snippet||"",body:oe,htmlBody:ke,date:Ye,isUnread:Be,isStarred:Fe,labels:ne.labelIds||[],attachments:Ue.length>0?Ue:void 0}}catch(de){return console.error("Error parsing email:",de),null}},G=(ne,te)=>{const ce=ne.find(_e=>_e.name.toLowerCase()===te.toLowerCase());return(ce==null?void 0:ce.value)||""},re=ne=>{const te=document.createElement("DIV");return te.innerHTML=ne,te.textContent||te.innerText||""},U=ne=>{var ge;let te="",ce="";const _e=[],de=Re=>{try{const et=Re.replace(/-/g,"+").replace(/_/g,"/"),Ye=atob(et),Be=new Uint8Array(Ye.length);for(let Fe=0;Fe<Ye.length;Fe++)Be[Fe]=Ye.charCodeAt(Fe);return new TextDecoder("utf-8").decode(Be)}catch{try{return atob(Re.replace(/-/g,"+").replace(/_/g,"/"))}catch{return Re}}},ye=Re=>{var et,Ye,Be;for(const Fe of Re)Fe.filename&&((et=Fe.body)!=null&&et.attachmentId)&&_e.push({filename:Fe.filename,mimeType:Fe.mimeType,size:Fe.body.size,attachmentId:Fe.body.attachmentId}),Fe.mimeType==="text/html"&&((Ye=Fe.body)!=null&&Ye.data)?ce=de(Fe.body.data):Fe.mimeType==="text/plain"&&((Be=Fe.body)!=null&&Be.data)?te=de(Fe.body.data):Fe.parts&&ye(Fe.parts)};if((ge=ne.body)!=null&&ge.data){const Re=de(ne.body.data);ne.mimeType==="text/html"?ce=Re:te=Re}else ne.parts&&ye(ne.parts);const Le=te||(ce?re(ce):""),we=ce||te.replace(/\n/g,"<br>");return{text:Le,html:we,attachments:_e}},S=async ne=>{if(u(ne),ne.isUnread&&D(ne.id),!ne.body&&t){v(!0);try{const te=await q(t),ce=await fetch(`https://gmail.googleapis.com/gmail/v1/users/me/messages/${ne.id}?format=full`,{headers:{Authorization:`Bearer ${te}`}});if(ce.ok){const _e=await ce.json(),{text:de,html:ye,attachments:Le}=U(_e.payload),we=_e.payload.headers,ge=G(we,"to")||"",Re=G(we,"cc")||"",et={...ne,body:de,htmlBody:ye,to:ge,cc:Re,attachments:Le.length>0?Le:void 0};u(et),c(l.map(Ye=>Ye.id===ne.id?et:Ye))}}catch(te){console.error("Error loading email body:",te)}finally{v(!1)}}},D=async ne=>{if(t)try{const te=await q(t);await fetch(`https://gmail.googleapis.com/gmail/v1/users/me/messages/${ne}/modify`,{method:"POST",headers:{Authorization:`Bearer ${te}`,"Content-Type":"application/json"},body:JSON.stringify({removeLabelIds:["UNREAD"]})}),c(l.map(ce=>ce.id===ne?{...ce,isUnread:!1}:ce)),(d==null?void 0:d.id)===ne&&u({...d,isUnread:!1})}catch(te){console.error("Error marking as read:",te)}},L=async(ne,te)=>{if(t)try{const ce=await q(t);await fetch(`https://gmail.googleapis.com/gmail/v1/users/me/messages/${ne}/modify`,{method:"POST",headers:{Authorization:`Bearer ${ce}`,"Content-Type":"application/json"},body:JSON.stringify({addLabelIds:te?[]:["STARRED"],removeLabelIds:te?["STARRED"]:[]})}),c(l.map(_e=>_e.id===ne?{..._e,isStarred:!te}:_e)),(d==null?void 0:d.id)===ne&&u({...d,isStarred:!te})}catch(ce){console.error("Error toggling star:",ce)}},P=(ne,te=!1)=>{B("reply"),C(ne),j(!0),w(null)},I=ne=>{B("forward"),C(ne),j(!0),w(null)},H=async ne=>{if(t)try{const te=await q(t);await fetch(`https://gmail.googleapis.com/gmail/v1/users/me/messages/${ne.id}/trash`,{method:"POST",headers:{Authorization:`Bearer ${te}`}}),c(l.filter(ce=>ce.id!==ne.id)),(d==null?void 0:d.id)===ne.id&&u(null),w(null)}catch(te){console.error("Error deleting email:",te),alert("Failed to delete email")}},V=async ne=>{if(!t)throw new Error("No Gmail connection");const te=await q(t);let ce="";if(ne.attachments.length>0){const ye="----=_Part_"+Date.now(),Le=['Content-Type: multipart/mixed; boundary="'+ye+'"',"MIME-Version: 1.0",`To: ${ne.to.join(", ")}`];ne.cc.length>0&&Le.push(`Cc: ${ne.cc.join(", ")}`),ne.bcc.length>0&&Le.push(`Bcc: ${ne.bcc.join(", ")}`),Le.push(`Subject: ${ne.subject}`),ce=Le.join(`\r
`)+`\r
\r
`,ce+=`--${ye}\r
`,ce+=`Content-Type: text/html; charset="UTF-8"\r
`,ce+=`Content-Transfer-Encoding: 7bit\r
\r
`,ce+=ne.body+`\r
\r
`;for(const we of ne.attachments){const ge=await W(we);ce+=`--${ye}\r
`,ce+=`Content-Type: ${we.type}; name="${we.name}"\r
`,ce+=`Content-Transfer-Encoding: base64\r
`,ce+=`Content-Disposition: attachment; filename="${we.name}"\r
\r
`,ce+=ge+`\r
\r
`}ce+=`--${ye}--`}else{const ye=['Content-Type: text/html; charset="UTF-8"',"MIME-Version: 1.0",`To: ${ne.to.join(", ")}`];ne.cc.length>0&&ye.push(`Cc: ${ne.cc.join(", ")}`),ne.bcc.length>0&&ye.push(`Bcc: ${ne.bcc.join(", ")}`),ye.push(`Subject: ${ne.subject}`),ce=ye.join(`\r
`)+`\r
\r
`+ne.body}const _e=btoa(unescape(encodeURIComponent(ce))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"");if(!(await fetch("https://gmail.googleapis.com/gmail/v1/users/me/messages/send",{method:"POST",headers:{Authorization:`Bearer ${te}`,"Content-Type":"application/json"},body:JSON.stringify({raw:_e})})).ok)throw new Error("Failed to send email")},W=ne=>new Promise((te,ce)=>{const _e=new FileReader;_e.readAsDataURL(ne),_e.onload=()=>{const de=_e.result.split(",")[1];te(de)},_e.onerror=de=>ce(de)}),M=async(ne,te)=>{if(t)try{const ce=await q(t),_e=await fetch(`https://gmail.googleapis.com/gmail/v1/users/me/messages/${ne.id}/attachments/${te.attachmentId}`,{headers:{Authorization:`Bearer ${ce}`}});if(!_e.ok)throw new Error("Failed to download attachment");const ye=(await _e.json()).data.replace(/-/g,"+").replace(/_/g,"/"),Le=atob(ye),we=new Uint8Array(Le.length);for(let Ye=0;Ye<Le.length;Ye++)we[Ye]=Le.charCodeAt(Ye);const ge=new Blob([we],{type:te.mimeType}),Re=window.URL.createObjectURL(ge),et=document.createElement("a");et.href=Re,et.download=te.filename,document.body.appendChild(et),et.click(),document.body.removeChild(et),window.URL.revokeObjectURL(Re)}catch(ce){console.error("Error downloading attachment:",ce),alert("Failed to download attachment")}},se=async ne=>{if(!ne){alert("No email selected");return}w(null);try{const te={subject:ne.subject||"No Subject",body:ne.htmlBody||ne.body||ne.snippet||"",fromEmail:ne.fromEmail||"",fromName:ne.from||"",date:ne.date?ne.date.toISOString():new Date().toISOString()};sessionStorage.setItem("pendingEmailForInquiry",JSON.stringify(te)),e("command-center")}catch(te){console.error("Error preparing inquiry:",te),alert("Failed to prepare inquiry. Please try again.")}},K=(ne,te)=>{ne.preventDefault(),w({x:ne.clientX,y:ne.clientY,email:te})},he=ne=>{const ce=new Date().getTime()-ne.getTime(),_e=Math.floor(ce/(1e3*60*60*24));return _e===0?ne.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):_e<7?ne.toLocaleDateString("en-US",{weekday:"short"}):ne.toLocaleDateString("en-US",{month:"short",day:"numeric"})};return a?n.jsx("div",{className:"flex items-center justify-center h-64",children:n.jsx(Vo,{className:"w-6 h-6 animate-spin text-blue-500"})}):p?n.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:n.jsxs("div",{className:"text-center max-w-md px-6",children:[n.jsx(En,{className:"w-16 h-16 text-amber-500 mx-auto mb-4"}),n.jsx("p",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Gmail Not Connected"}),n.jsx("p",{className:"text-sm text-gray-600 mb-4",children:p}),n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 text-left",children:[n.jsx("p",{className:"text-sm font-medium text-blue-900 mb-2",children:"To connect Gmail:"}),n.jsxs("ol",{className:"text-sm text-blue-800 space-y-1 list-decimal list-inside",children:[n.jsx("li",{children:"Go to Settings page"}),n.jsx("li",{children:"Navigate to Gmail Settings section"}),n.jsx("li",{children:'Click "Connect Gmail Account"'}),n.jsx("li",{children:"Authorize access to your Gmail account"})]})]}),n.jsxs("div",{className:"flex gap-2 justify-center",children:[n.jsx("button",{onClick:()=>{s(!0),b(null),R()},className:"mt-4 px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 transition",children:"Retry Connection"}),n.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 transition",children:"Refresh Page"})]})]})}):n.jsxs("div",{className:"flex h-[calc(100vh-16rem)] bg-white rounded-lg border border-gray-200 overflow-hidden",children:[n.jsxs("div",{className:"w-[10%] min-w-[140px] border-r border-gray-200 flex flex-col bg-gray-50",children:[n.jsx("div",{className:"p-3 border-b border-gray-200",children:n.jsx("h3",{className:"text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Folders"})}),n.jsxs("div",{className:"flex-1 overflow-y-auto py-1",children:[n.jsxs("button",{onClick:()=>h("INBOX"),className:`w-full flex items-center gap-2 px-3 py-2 text-xs transition ${f==="INBOX"?"bg-blue-100 text-blue-700 font-semibold":"text-gray-700 hover:bg-gray-100"}`,children:[n.jsx(kE,{className:"w-3.5 h-3.5"}),n.jsx("span",{children:"Inbox"})]}),n.jsxs("button",{onClick:()=>h("STARRED"),className:`w-full flex items-center gap-2 px-3 py-2 text-xs transition ${f==="STARRED"?"bg-blue-100 text-blue-700 font-semibold":"text-gray-700 hover:bg-gray-100"}`,children:[n.jsx(Cv,{className:"w-3.5 h-3.5"}),n.jsx("span",{children:"Starred"})]}),n.jsxs("button",{onClick:()=>h("SENT"),className:`w-full flex items-center gap-2 px-3 py-2 text-xs transition ${f==="SENT"?"bg-blue-100 text-blue-700 font-semibold":"text-gray-700 hover:bg-gray-100"}`,children:[n.jsx($i,{className:"w-3.5 h-3.5"}),n.jsx("span",{children:"Sent"})]}),n.jsxs("button",{onClick:()=>h("DRAFT"),className:`w-full flex items-center gap-2 px-3 py-2 text-xs transition ${f==="DRAFT"?"bg-blue-100 text-blue-700 font-semibold":"text-gray-700 hover:bg-gray-100"}`,children:[n.jsx(ua,{className:"w-3.5 h-3.5"}),n.jsx("span",{children:"Drafts"})]}),n.jsxs("button",{onClick:()=>h("ALL"),className:`w-full flex items-center gap-2 px-3 py-2 text-xs transition ${f==="ALL"?"bg-blue-100 text-blue-700 font-semibold":"text-gray-700 hover:bg-gray-100"}`,children:[n.jsx(vE,{className:"w-3.5 h-3.5"}),n.jsx("span",{children:"All Mail"})]}),n.jsxs("button",{onClick:()=>h("TRASH"),className:`w-full flex items-center gap-2 px-3 py-2 text-xs transition ${f==="TRASH"?"bg-blue-100 text-blue-700 font-semibold":"text-gray-700 hover:bg-gray-100"}`,children:[n.jsx(Sv,{className:"w-3.5 h-3.5"}),n.jsx("span",{children:"Trash"})]})]}),n.jsx("div",{className:"p-2 border-t border-gray-200",children:n.jsxs("button",{onClick:()=>ee(),disabled:i,className:"w-full flex items-center justify-center gap-1.5 px-2 py-1.5 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded hover:bg-gray-50 transition disabled:opacity-50",children:[n.jsx(Hs,{className:`w-3 h-3 ${i?"animate-spin":""}`}),"Refresh"]})})]}),n.jsxs("div",{className:"w-[30%] min-w-[320px] flex flex-col border-r border-gray-200 bg-white",children:[n.jsx("div",{className:"p-3 border-b border-gray-200 bg-gray-50",children:n.jsxs("div",{className:"relative",children:[n.jsx(Ca,{className:"absolute left-2.5 top-1/2 transform -translate-y-1/2 w-3.5 h-3.5 text-gray-400"}),n.jsx("input",{type:"text",value:A,onChange:ne=>x(ne.target.value),placeholder:"Search emails...",className:"w-full pl-8 pr-3 py-1.5 text-xs border border-gray-300 rounded bg-white focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]})}),n.jsx("div",{className:"flex-1 overflow-y-auto",children:i&&l.length===0?n.jsx("div",{className:"flex items-center justify-center h-full",children:n.jsx(Vo,{className:"w-6 h-6 animate-spin text-blue-500"})}):l.length===0?n.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-500",children:[n.jsx(ua,{className:"w-12 h-12 mb-4 text-gray-300"}),n.jsx("p",{className:"text-sm",children:"No emails found"})]}):n.jsxs("div",{children:[l.filter(ne=>A===""||ne.subject.toLowerCase().includes(A.toLowerCase())||ne.from.toLowerCase().includes(A.toLowerCase())||ne.snippet.toLowerCase().includes(A.toLowerCase())).map(ne=>n.jsxs("div",{onClick:()=>S(ne),onContextMenu:te=>K(te,ne),className:`flex items-start gap-2 px-3 py-2.5 border-b border-gray-100 cursor-pointer transition ${(d==null?void 0:d.id)===ne.id?"bg-blue-50 border-l-2 border-l-blue-500":(ne.isUnread,"bg-white hover:bg-gray-50")}`,children:[n.jsx("button",{onClick:te=>{te.stopPropagation(),L(ne.id,ne.isStarred)},className:"mt-0.5 flex-shrink-0",children:n.jsx(Cv,{className:`w-3.5 h-3.5 ${ne.isStarred?"fill-yellow-400 text-yellow-400":"text-gray-300"} hover:text-yellow-400 transition`})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-baseline justify-between gap-2 mb-0.5",children:[n.jsx("p",{className:`text-xs truncate ${ne.isUnread?"font-bold text-gray-900":"font-medium text-gray-700"}`,children:ne.from}),n.jsx("span",{className:"text-[10px] text-gray-500 whitespace-nowrap flex-shrink-0",children:he(ne.date)})]}),n.jsx("p",{className:`text-xs truncate mb-0.5 ${ne.isUnread?"font-semibold text-gray-900":"text-gray-600"}`,children:ne.subject}),n.jsx("p",{className:"text-[10px] text-gray-500 line-clamp-1",children:ne.snippet})]}),ne.isUnread&&n.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-blue-500 mt-1.5 flex-shrink-0"})]},ne.id)),m&&n.jsx("div",{className:"p-4 text-center",children:n.jsx("button",{onClick:()=>ee(m),disabled:i,className:"px-4 py-2 text-sm text-blue-600 hover:text-blue-700 font-medium disabled:opacity-50",children:i?"Loading...":"Load More"})})]})})]}),n.jsx("div",{className:"flex-1 w-[60%] flex flex-col bg-white overflow-hidden",children:d?n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 bg-white",children:[n.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-3 leading-tight",children:d.subject}),n.jsxs("div",{className:"flex items-start justify-between gap-4",children:[n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center text-white font-semibold text-sm flex-shrink-0",children:d.from.charAt(0).toUpperCase()}),n.jsxs("div",{className:"min-w-0",children:[n.jsx("p",{className:"text-sm font-semibold text-gray-900",children:d.from}),n.jsx("p",{className:"text-xs text-gray-500 truncate",children:d.fromEmail})]})]}),n.jsx("p",{className:"text-xs text-gray-500 whitespace-nowrap",children:d.date.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"})})]})]}),n.jsx("div",{className:"flex-1 overflow-y-auto px-6 py-4 bg-gray-50",children:y?n.jsx("div",{className:"flex items-center justify-center h-full",children:n.jsx(Vo,{className:"w-6 h-6 animate-spin text-blue-500"})}):n.jsxs(n.Fragment,{children:[d.htmlBody?n.jsx("div",{className:"bg-white rounded-lg shadow-sm",children:n.jsx(YF,{htmlContent:d.htmlBody})}):d.body?n.jsx("div",{className:"bg-white rounded-lg p-6 shadow-sm",children:n.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:d.body})}):n.jsx("div",{className:"bg-white rounded-lg p-6 shadow-sm",children:n.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:d.snippet})}),d.attachments&&d.attachments.length>0&&n.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-sm mt-4",children:[n.jsxs("p",{className:"text-xs font-semibold text-gray-700 mb-2 uppercase",children:["Attachments (",d.attachments.length,")"]}),n.jsx("div",{className:"space-y-2",children:d.attachments.map((ne,te)=>n.jsxs("button",{onClick:()=>M(d,ne),className:"flex items-center gap-3 w-full p-3 bg-gray-50 hover:bg-gray-100 rounded-lg border border-gray-200 transition",children:[n.jsx(Zt,{className:"w-5 h-5 text-blue-600 flex-shrink-0"}),n.jsxs("div",{className:"flex-1 text-left min-w-0",children:[n.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:ne.filename}),n.jsxs("p",{className:"text-xs text-gray-500",children:[(ne.size/1024).toFixed(1)," KB"]})]}),n.jsx(Rc,{className:"w-4 h-4 text-gray-400"})]},te))})]})]})}),n.jsx("div",{className:"px-4 py-3 border-t border-gray-200 bg-white",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("button",{onClick:()=>P(d,!1),className:"flex items-center gap-1.5 px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded hover:bg-blue-700 transition",children:[n.jsx(j5,{className:"w-4 h-4"}),"Reply"]}),d.cc&&n.jsxs("button",{onClick:()=>P(d,!0),className:"flex items-center gap-1.5 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded hover:bg-gray-50 transition",children:[n.jsx(vo,{className:"w-4 h-4"}),"Reply All"]}),n.jsxs("button",{onClick:()=>I(d),className:"flex items-center gap-1.5 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded hover:bg-gray-50 transition",children:[n.jsx(_5,{className:"w-4 h-4"}),"Forward"]}),n.jsxs("button",{onClick:()=>se(d),className:"flex items-center gap-1.5 px-4 py-2 text-sm font-medium text-blue-700 bg-blue-50 border border-blue-200 rounded hover:bg-blue-100 transition",children:[n.jsx(Zr,{className:"w-4 h-4"}),"Process in Command Center"]}),n.jsxs("button",{onClick:()=>H(d),className:"flex items-center gap-1.5 px-4 py-2 text-sm font-medium text-red-700 bg-red-50 border border-red-200 rounded hover:bg-red-100 transition ml-auto",children:[n.jsx(Sv,{className:"w-4 h-4"}),"Delete"]})]})})]}):n.jsx("div",{className:"flex items-center justify-center h-full text-gray-400 bg-gray-50",children:n.jsxs("div",{className:"text-center",children:[n.jsx(ua,{className:"w-20 h-20 mx-auto mb-4 text-gray-300"}),n.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Select an email to view"}),n.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Choose a message from your inbox"})]})})}),k&&n.jsxs("div",{ref:T,className:"fixed bg-white rounded-lg shadow-xl border border-gray-200 py-1 z-50 min-w-[160px]",style:{top:k.y,left:k.x},children:[n.jsxs("button",{onClick:()=>P(k.email,!1),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center gap-2",children:[n.jsx(j5,{className:"w-4 h-4"}),"Reply"]}),k.email.cc&&n.jsxs("button",{onClick:()=>P(k.email,!0),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center gap-2",children:[n.jsx(vo,{className:"w-4 h-4"}),"Reply All"]}),n.jsxs("button",{onClick:()=>I(k.email),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center gap-2",children:[n.jsx(_5,{className:"w-4 h-4"}),"Forward"]}),n.jsxs("button",{onClick:()=>L(k.email.id,k.email.isStarred),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center gap-2",children:[n.jsx(Cv,{className:"w-4 h-4"}),k.email.isStarred?"Unstar":"Star"]}),n.jsxs("button",{onClick:()=>se(k.email),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center gap-2 border-t border-gray-100",children:[n.jsx(Zr,{className:"w-4 h-4"}),"Process in Command Center"]}),n.jsxs("button",{onClick:()=>H(k.email),className:"w-full px-4 py-2 text-left text-sm hover:bg-red-50 text-red-700 flex items-center gap-2 border-t border-gray-100",children:[n.jsx(Sv,{className:"w-4 h-4"}),"Delete"]})]}),n.jsx(KJ,{isOpen:_,onClose:()=>{j(!1),C(null),B("compose")},mode:N,replyTo:E?{id:E.id,subject:E.subject,from:E.from,fromEmail:E.fromEmail,body:E.body,htmlBody:E.htmlBody,date:E.date}:void 0,onSend:V})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var ix={};ix.version="0.18.5";var JF=1252,pZ=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],f2={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},p2=function(e){pZ.indexOf(e)!=-1&&(JF=f2[0]=e)};function mZ(){p2(1252)}var ho=function(e){p2(e)};function m2(){ho(1200),mZ()}function jC(e){for(var t=[],r=0,a=e.length;r<a;++r)t[r]=e.charCodeAt(r);return t}function gZ(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function ZF(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var hf=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?gZ(e.slice(2)):t==254&&r==255?ZF(e.slice(2)):t==65279?e.slice(1):e},Em=function(t){return String.fromCharCode(t)},kC=function(t){return String.fromCharCode(t)},g0,Bc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function x0(e){for(var t="",r=0,a=0,s=0,i=0,o=0,l=0,c=0,d=0;d<e.length;)r=e.charCodeAt(d++),i=r>>2,a=e.charCodeAt(d++),o=(r&3)<<4|a>>4,s=e.charCodeAt(d++),l=(a&15)<<2|s>>6,c=s&63,isNaN(a)?l=c=64:isNaN(s)&&(c=64),t+=Bc.charAt(i)+Bc.charAt(o)+Bc.charAt(l)+Bc.charAt(c);return t}function xi(e){var t="",r=0,a=0,s=0,i=0,o=0,l=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<e.length;)i=Bc.indexOf(e.charAt(d++)),o=Bc.indexOf(e.charAt(d++)),r=i<<2|o>>4,t+=String.fromCharCode(r),l=Bc.indexOf(e.charAt(d++)),a=(o&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(a)),c=Bc.indexOf(e.charAt(d++)),s=(l&3)<<6|c,c!==64&&(t+=String.fromCharCode(s));return t}var yr=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Vl=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Vc(e){return yr?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function CC(e){return yr?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var ui=function(t){return yr?Vl(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function iy(e){if(typeof ArrayBuffer>"u")return ui(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),a=0;a!=e.length;++a)r[a]=e.charCodeAt(a)&255;return t}function Zc(e){if(Array.isArray(e))return e.map(function(a){return String.fromCharCode(a)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function xZ(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function g2(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return g2(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Ta=yr?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Vl(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var a=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)a.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";a.set(new Uint8Array(e[t]),r)}return a}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function yZ(e){for(var t=[],r=0,a=e.length+250,s=Vc(e.length+255),i=0;i<e.length;++i){var o=e.charCodeAt(i);if(o<128)s[r++]=o;else if(o<2048)s[r++]=192|o>>6&31,s[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=e.charCodeAt(++i)&1023;s[r++]=240|o>>8&7,s[r++]=128|o>>2&63,s[r++]=128|l>>6&15|(o&3)<<4,s[r++]=128|l&63}else s[r++]=224|o>>12&15,s[r++]=128|o>>6&63,s[r++]=128|o&63;r>a&&(t.push(s.slice(0,r)),r=0,s=Vc(65535),a=65530)}return t.push(s.slice(0,r)),Ta(t)}var Es=/\u0000/g,ff=/[\u0001-\u0006]/g;function kA(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function fo(e,t){var r=""+e;return r.length>=t?r:On("0",t-r.length)+r}function x2(e,t){var r=""+e;return r.length>=t?r:On(" ",t-r.length)+r}function ox(e,t){var r=""+e;return r.length>=t?r:r+On(" ",t-r.length)}function vZ(e,t){var r=""+Math.round(e);return r.length>=t?r:On("0",t-r.length)+r}function bZ(e,t){var r=""+e;return r.length>=t?r:On("0",t-r.length)+r}var SC=Math.pow(2,32);function Mu(e,t){if(e>SC||e<-SC)return vZ(e,t);var r=Math.round(e);return bZ(r,t)}function lx(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var BC=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],C1=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function _Z(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var nr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},EC={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},wZ={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function cx(e,t,r){for(var a=e<0?-1:1,s=e*a,i=0,o=1,l=0,c=1,d=0,u=0,f=Math.floor(s);d<t&&(f=Math.floor(s),l=f*o+i,u=f*d+c,!(s-f<5e-8));)s=1/(s-f),i=o,o=l,c=d,d=u;if(u>t&&(d>t?(u=c,l=i):(u=d,l=o)),!r)return[0,a*l,u];var h=Math.floor(a*l/u);return[h,a*l-h*u,u]}function Dd(e,t,r){if(e>2958465||e<0)return null;var a=e|0,s=Math.floor(86400*(e-a)),i=0,o=[],l={D:a,T:s,u:86400*(e-a)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(a+=1462),l.u>.9999&&(l.u=0,++s==86400&&(l.T=s=0,++a,++l.D)),a===60)o=r?[1317,10,29]:[1900,2,29],i=3;else if(a===0)o=r?[1317,8,29]:[1900,1,0],i=6;else{a>60&&--a;var c=new Date(1900,0,1);c.setDate(c.getDate()+a-1),o=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),a<60&&(i=(i+6)%7),r&&(i=BZ(c,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=s%60,s=Math.floor(s/60),l.M=s%60,s=Math.floor(s/60),l.H=s,l.q=i,l}var eT=new Date(1899,11,31,0,0,0),NZ=eT.getTime(),jZ=new Date(1900,2,1,0,0,0);function tT(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=jZ&&(r+=24*60*60*1e3),(r-(NZ+(e.getTimezoneOffset()-eT.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function y2(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function kZ(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function CZ(e){var t=e<0?12:11,r=y2(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function SZ(e){var t=y2(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function y0(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=CZ(e):t===10?r=e.toFixed(10).substr(0,12):r=SZ(e),y2(kZ(r.toUpperCase()))}function Jd(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):y0(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Wi(14,tT(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function BZ(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function EZ(e,t,r,a){var s="",i=0,o=0,l=r.y,c,d=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:c=l%100,d=2;break;default:c=l%1e4,d=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,d=t.length;break;case 3:return C1[r.m-1][1];case 5:return C1[r.m-1][0];default:return C1[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,d=t.length;break;case 3:return BC[r.q][0];default:return BC[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,d=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,d=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,d=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?fo(r.S,t.length):(a>=2?o=a===3?1e3:100:o=a===1?10:1,i=Math.round(o*(r.S+r.u)),i>=60*o&&(i=0),t==="s"?i===0?"0":""+i/o:(s=fo(i,2+a),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}d=t.length===3?1:2;break;case 101:c=l,d=1;break}var u=d>0?fo(c,d):"";return u}function Ec(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,a=e.substr(0,r);r!=e.length;r+=t)a+=(a.length>0?",":"")+e.substr(r,t);return a}var rT=/%/g;function FZ(e,t,r){var a=t.replace(rT,""),s=t.length-a.length;return Fl(e,a,r*Math.pow(10,2*s))+On("%",s)}function TZ(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return Fl(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function nT(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+nT(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(t/Math.pow(10,i)).toPrecision(a+1+(s+i)%s),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,d,u){return c+d+u.substr(0,(s+i)%s)+"."+u.substr(i)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var aT=/# (\?+)( ?)\/( ?)(\d+)/;function IZ(e,t,r){var a=parseInt(e[4],10),s=Math.round(t*a),i=Math.floor(s/a),o=s-i*a,l=a;return r+(i===0?"":""+i)+" "+(o===0?On(" ",e[1].length+1+e[4].length):x2(o,e[1].length)+e[2]+"/"+e[3]+fo(l,e[4].length))}function DZ(e,t,r){return r+(t===0?"":""+t)+On(" ",e[1].length+2+e[4].length)}var sT=/^#*0*\.([0#]+)/,iT=/\).*[0#]/,oT=/\(###\) ###\\?-####/;function js(e){for(var t="",r,a=0;a!=e.length;++a)switch(r=e.charCodeAt(a)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function FC(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function TC(e,t){var r=e-Math.floor(e),a=Math.pow(10,t);return t<(""+Math.round(r*a)).length?0:Math.round(r*a)}function LZ(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function PZ(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Si(e,t,r){if(e.charCodeAt(0)===40&&!t.match(iT)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Si("n",a,r):"("+Si("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return TZ(e,t,r);if(t.indexOf("%")!==-1)return FZ(e,t,r);if(t.indexOf("E")!==-1)return nT(t,r);if(t.charCodeAt(0)===36)return"$"+Si(e,t.substr(t.charAt(1)==" "?2:1),r);var s,i,o,l,c=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+Mu(c,t.length);if(t.match(/^[#?]+$/))return s=Mu(r,0),s==="0"&&(s=""),s.length>t.length?s:js(t.substr(0,t.length-s.length))+s;if(i=t.match(aT))return IZ(i,c,d);if(t.match(/^#+0+$/))return d+Mu(c,t.length-t.indexOf("0"));if(i=t.match(sT))return s=FC(r,i[1].length).replace(/^([^\.]+)$/,"$1."+js(i[1])).replace(/\.$/,"."+js(i[1])).replace(/\.(\d*)$/,function(x,p){return"."+p+On("0",js(i[1]).length-p.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return d+FC(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return d+Ec(Mu(c,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Si(e,t,-r):Ec(""+(Math.floor(r)+LZ(r,i[1].length)))+"."+fo(TC(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return Si(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=kA(Si(e,t.replace(/[\\-]/g,""),r)),o=0,kA(kA(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return o<s.length?s.charAt(o++):x==="0"?"0":""}));if(t.match(oT))return s=Si(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=cx(c,Math.pow(10,o)-1,!1),s=""+d,u=Fl("n",i[1],l[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+i[2]+"/"+i[3],u=ox(l[2],o),u.length<i[4].length&&(u=js(i[4].substr(i[4].length-u.length))+u),s+=u,s;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=cx(c,Math.pow(10,o)-1,!0),d+(l[0]||(l[1]?"":"0"))+" "+(l[1]?x2(l[1],o)+i[2]+"/"+i[3]+ox(l[2],o):On(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return s=Mu(r,0),t.length<=s.length?s:js(t.substr(0,t.length-s.length))+s;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var f=t.indexOf(".")-o,h=t.length-s.length-f;return js(t.substr(0,f)+s+t.substr(t.length-h))}if(i=t.match(/^00,000\.([#0]*0)$/))return o=TC(r,i[1].length),r<0?"-"+Si(e,t,-r):Ec(PZ(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?fo(0,3-x.length):"")+x})+"."+fo(o,i[1].length);switch(t){case"###,##0.00":return Si(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var A=Ec(Mu(c,0));return A!=="0"?d+A:"";case"###,###.00":return Si(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Si(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function OZ(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return Fl(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function UZ(e,t,r){var a=t.replace(rT,""),s=t.length-a.length;return Fl(e,a,r*Math.pow(10,2*s))+On("%",s)}function lT(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+lT(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(t/Math.pow(10,i)).toPrecision(a+1+(s+i)%s),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,d,u){return c+d+u.substr(0,(s+i)%s)+"."+u.substr(i)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Oo(e,t,r){if(e.charCodeAt(0)===40&&!t.match(iT)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Oo("n",a,r):"("+Oo("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return OZ(e,t,r);if(t.indexOf("%")!==-1)return UZ(e,t,r);if(t.indexOf("E")!==-1)return lT(t,r);if(t.charCodeAt(0)===36)return"$"+Oo(e,t.substr(t.charAt(1)==" "?2:1),r);var s,i,o,l,c=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+fo(c,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:js(t.substr(0,t.length-s.length))+s;if(i=t.match(aT))return DZ(i,c,d);if(t.match(/^#+0+$/))return d+fo(c,t.length-t.indexOf("0"));if(i=t.match(sT))return s=(""+r).replace(/^([^\.]+)$/,"$1."+js(i[1])).replace(/\.$/,"."+js(i[1])),s=s.replace(/\.(\d*)$/,function(x,p){return"."+p+On("0",js(i[1]).length-p.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return d+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return d+Ec(""+c);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Oo(e,t,-r):Ec(""+r)+"."+On("0",i[1].length);if(i=t.match(/^#,#*,#0/))return Oo(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=kA(Oo(e,t.replace(/[\\-]/g,""),r)),o=0,kA(kA(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return o<s.length?s.charAt(o++):x==="0"?"0":""}));if(t.match(oT))return s=Oo(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=cx(c,Math.pow(10,o)-1,!1),s=""+d,u=Fl("n",i[1],l[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+i[2]+"/"+i[3],u=ox(l[2],o),u.length<i[4].length&&(u=js(i[4].substr(i[4].length-u.length))+u),s+=u,s;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=cx(c,Math.pow(10,o)-1,!0),d+(l[0]||(l[1]?"":"0"))+" "+(l[1]?x2(l[1],o)+i[2]+"/"+i[3]+ox(l[2],o):On(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:js(t.substr(0,t.length-s.length))+s;if(i=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var f=t.indexOf(".")-o,h=t.length-s.length-f;return js(t.substr(0,f)+s+t.substr(t.length-h))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Oo(e,t,-r):Ec(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?fo(0,3-x.length):"")+x})+"."+fo(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var A=Ec(""+c);return A!=="0"?d+A:"";default:if(t.match(/\.[0#?]*$/))return Oo(e,t.slice(0,t.lastIndexOf(".")),r)+js(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Fl(e,t,r){return(r|0)===r?Oo(e,t,r):Si(e,t,r)}function RZ(e){for(var t=[],r=!1,a=0,s=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(s,a-s),s=a+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var cT=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function eh(e){for(var t=0,r="",a="";t<e.length;)switch(r=e.charAt(t)){case"G":lx(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(a=r;e.charAt(t++)!=="]"&&t<e.length;)a+=e.charAt(t);if(a.match(cT))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function MZ(e,t,r,a){for(var s=[],i="",o=0,l="",c="t",d,u,f,h="H";o<e.length;)switch(l=e.charAt(o)){case"G":if(!lx(e,o))throw new Error("unrecognized character "+l+" in "+e);s[s.length]={t:"G",v:"General"},o+=7;break;case'"':for(i="";(f=e.charCodeAt(++o))!==34&&o<e.length;)i+=String.fromCharCode(f);s[s.length]={t:"t",v:i},++o;break;case"\\":var A=e.charAt(++o),x=A==="("||A===")"?A:"t";s[s.length]={t:x,v:A},++o;break;case"_":s[s.length]={t:"t",v:" "},o+=2;break;case"@":s[s.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(d==null&&(d=Dd(t,r,e.charAt(o+1)==="2"),d==null))return"";s[s.length]={t:"X",v:e.substr(o,2)},c=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||d==null&&(d=Dd(t,r),d==null))return"";for(i=l;++o<e.length&&e.charAt(o).toLowerCase()===l;)i+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=h),s[s.length]={t:l,v:i},c=l;break;case"A":case"a":case"":var p={t:l,v:l};if(d==null&&(d=Dd(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(d!=null&&(p.v=d.H>=12?"P":"A"),p.t="T",h="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(d!=null&&(p.v=d.H>=12?"PM":"AM"),p.t="T",o+=5,h="h"):e.substr(o,5).toUpperCase()==="/"?(d!=null&&(p.v=d.H>=12?"":""),p.t="T",o+=5,h="h"):(p.t="t",++o),d==null&&p.t==="T")return"";s[s.length]=p,c=l;break;case"[":for(i=l;e.charAt(o++)!=="]"&&o<e.length;)i+=e.charAt(o);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(cT)){if(d==null&&(d=Dd(t,r),d==null))return"";s[s.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",eh(e)||(s[s.length]={t:"t",v:i}));break;case".":if(d!=null){for(i=l;++o<e.length&&(l=e.charAt(o))==="0";)i+=l;s[s.length]={t:"s",v:i};break}case"0":case"#":for(i=l;++o<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(o))>-1;)i+=l;s[s.length]={t:"n",v:i};break;case"?":for(i=l;e.charAt(++o)===l;)i+=l;s[s.length]={t:l,v:i},c=l;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":s[s.length]={t:a===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=l;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)i+=e.charAt(o);s[s.length]={t:"D",v:i};break;case" ":s[s.length]={t:l,v:l},++o;break;case"$":s[s.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);s[s.length]={t:"t",v:l},++o;break}var b=0,m=0,g;for(o=s.length-1,c="t";o>=0;--o)switch(s[o].t){case"h":case"H":s[o].t=h,c="h",b<1&&(b=1);break;case"s":(g=s[o].v.match(/\.0+$/))&&(m=Math.max(m,g[0].length-1)),b<3&&(b=3);case"d":case"y":case"M":case"e":c=s[o].t;break;case"m":c==="s"&&(s[o].t="M",b<2&&(b=2));break;case"X":break;case"Z":b<1&&s[o].v.match(/[Hh]/)&&(b=1),b<2&&s[o].v.match(/[Mm]/)&&(b=2),b<3&&s[o].v.match(/[Ss]/)&&(b=3)}switch(b){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var y="",v;for(o=0;o<s.length;++o)switch(s[o].t){case"t":case"T":case" ":case"D":break;case"X":s[o].v="",s[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[o].v=EZ(s[o].t.charCodeAt(0),s[o].v,d,m),s[o].t="t";break;case"n":case"?":for(v=o+1;s[v]!=null&&((l=s[v].t)==="?"||l==="D"||(l===" "||l==="t")&&s[v+1]!=null&&(s[v+1].t==="?"||s[v+1].t==="t"&&s[v+1].v==="/")||s[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(s[v].v==="/"||s[v].v===" "&&s[v+1]!=null&&s[v+1].t=="?"));)s[o].v+=s[v].v,s[v]={v:"",t:";"},++v;y+=s[o].v,o=v-1;break;case"G":s[o].t="t",s[o].v=Jd(t,r);break}var _="",j,N;if(y.length>0){y.charCodeAt(0)==40?(j=t<0&&y.charCodeAt(0)===45?-t:t,N=Fl("n",y,j)):(j=t<0&&a>1?-t:t,N=Fl("n",y,j),j<0&&s[0]&&s[0].t=="t"&&(N=N.substr(1),s[0].v="-"+s[0].v)),v=N.length-1;var B=s.length;for(o=0;o<s.length;++o)if(s[o]!=null&&s[o].t!="t"&&s[o].v.indexOf(".")>-1){B=o;break}var E=s.length;if(B===s.length&&N.indexOf("E")===-1){for(o=s.length-1;o>=0;--o)s[o]==null||"n?".indexOf(s[o].t)===-1||(v>=s[o].v.length-1?(v-=s[o].v.length,s[o].v=N.substr(v+1,s[o].v.length)):v<0?s[o].v="":(s[o].v=N.substr(0,v+1),v=-1),s[o].t="t",E=o);v>=0&&E<s.length&&(s[E].v=N.substr(0,v+1)+s[E].v)}else if(B!==s.length&&N.indexOf("E")===-1){for(v=N.indexOf(".")-1,o=B;o>=0;--o)if(!(s[o]==null||"n?".indexOf(s[o].t)===-1)){for(u=s[o].v.indexOf(".")>-1&&o===B?s[o].v.indexOf(".")-1:s[o].v.length-1,_=s[o].v.substr(u+1);u>=0;--u)v>=0&&(s[o].v.charAt(u)==="0"||s[o].v.charAt(u)==="#")&&(_=N.charAt(v--)+_);s[o].v=_,s[o].t="t",E=o}for(v>=0&&E<s.length&&(s[E].v=N.substr(0,v+1)+s[E].v),v=N.indexOf(".")+1,o=B;o<s.length;++o)if(!(s[o]==null||"n?(".indexOf(s[o].t)===-1&&o!==B)){for(u=s[o].v.indexOf(".")>-1&&o===B?s[o].v.indexOf(".")+1:0,_=s[o].v.substr(0,u);u<s[o].v.length;++u)v<N.length&&(_+=N.charAt(v++));s[o].v=_,s[o].t="t",E=o}}}for(o=0;o<s.length;++o)s[o]!=null&&"n?".indexOf(s[o].t)>-1&&(j=a>1&&t<0&&o>0&&s[o-1].v==="-"?-t:t,s[o].v=Fl(s[o].t,s[o].v,j),s[o].t="t");var C="";for(o=0;o!==s.length;++o)s[o]!=null&&(C+=s[o].v);return C}var IC=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function DC(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function QZ(e,t){var r=RZ(e),a=r.length,s=r[a-1].indexOf("@");if(a<4&&s>-1&&--a,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[a,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(IC),l=r[1].match(IC);return DC(t,o)?[a,r[0]]:DC(t,l)?[a,r[1]]:[a,r[o!=null&&l!=null?2:1]]}return[a,i]}function Wi(e,t,r){r==null&&(r={});var a="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?a=r.dateNF:a=e;break;case"number":e==14&&r.dateNF?a=r.dateNF:a=(r.table!=null?r.table:nr)[e],a==null&&(a=r.table&&r.table[EC[e]]||nr[EC[e]]),a==null&&(a=wZ[e]||"General");break}if(lx(a,0))return Jd(t,r);t instanceof Date&&(t=tT(t,r.date1904));var s=QZ(a,t);if(lx(s[1]))return Jd(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return MZ(s[1],t,r,s[0])}function Tl(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(nr[r]==null){t<0&&(t=r);continue}if(nr[r]==e){t=r;break}}t<0&&(t=391)}return nr[t]=e,t}function oy(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Tl(e[t],t)}function th(){nr=_Z()}var HZ={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},dT=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function qZ(e){var t=typeof e=="number"?nr[e]:e;return t=t.replace(dT,"(\\d+)"),new RegExp("^"+t+"$")}function $Z(e,t,r){var a=-1,s=-1,i=-1,o=-1,l=-1,c=-1;(t.match(dT)||[]).forEach(function(f,h){var A=parseInt(r[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":a=A;break;case"d":i=A;break;case"h":o=A;break;case"s":c=A;break;case"m":o>=0?l=A:s=A;break}}),c>=0&&l==-1&&s>=0&&(l=s,s=-1);var d=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var u=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return o==-1&&l==-1&&c==-1?d:a==-1&&s==-1&&i==-1?u:d+"T"+u}var KZ=function(){var e={};e.version="1.2.0";function t(){for(var N=0,B=new Array(256),E=0;E!=256;++E)N=E,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,B[E]=N;return typeof Int32Array<"u"?new Int32Array(B):B}var r=t();function a(N){var B=0,E=0,C=0,k=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(C=0;C!=256;++C)k[C]=N[C];for(C=0;C!=256;++C)for(E=N[C],B=256+C;B<4096;B+=256)E=k[B]=E>>>8^N[E&255];var w=[];for(C=1;C!=16;++C)w[C-1]=typeof Int32Array<"u"?k.subarray(C*256,C*256+256):k.slice(C*256,C*256+256);return w}var s=a(r),i=s[0],o=s[1],l=s[2],c=s[3],d=s[4],u=s[5],f=s[6],h=s[7],A=s[8],x=s[9],p=s[10],b=s[11],m=s[12],g=s[13],y=s[14];function v(N,B){for(var E=B^-1,C=0,k=N.length;C<k;)E=E>>>8^r[(E^N.charCodeAt(C++))&255];return~E}function _(N,B){for(var E=B^-1,C=N.length-15,k=0;k<C;)E=y[N[k++]^E&255]^g[N[k++]^E>>8&255]^m[N[k++]^E>>16&255]^b[N[k++]^E>>>24]^p[N[k++]]^x[N[k++]]^A[N[k++]]^h[N[k++]]^f[N[k++]]^u[N[k++]]^d[N[k++]]^c[N[k++]]^l[N[k++]]^o[N[k++]]^i[N[k++]]^r[N[k++]];for(C+=15;k<C;)E=E>>>8^r[(E^N[k++])&255];return~E}function j(N,B){for(var E=B^-1,C=0,k=N.length,w=0,T=0;C<k;)w=N.charCodeAt(C++),w<128?E=E>>>8^r[(E^w)&255]:w<2048?(E=E>>>8^r[(E^(192|w>>6&31))&255],E=E>>>8^r[(E^(128|w&63))&255]):w>=55296&&w<57344?(w=(w&1023)+64,T=N.charCodeAt(C++)&1023,E=E>>>8^r[(E^(240|w>>8&7))&255],E=E>>>8^r[(E^(128|w>>2&63))&255],E=E>>>8^r[(E^(128|T>>6&15|(w&3)<<4))&255],E=E>>>8^r[(E^(128|T&63))&255]):(E=E>>>8^r[(E^(224|w>>12&15))&255],E=E>>>8^r[(E^(128|w>>6&63))&255],E=E>>>8^r[(E^(128|w&63))&255]);return~E}return e.table=r,e.bstr=v,e.buf=_,e.str=j,e}(),er=function(){var t={};t.version="1.2.1";function r(ue,ie){for(var Ae=ue.split("/"),le=ie.split("/"),ve=0,me=0,Pe=Math.min(Ae.length,le.length);ve<Pe;++ve){if(me=Ae[ve].length-le[ve].length)return me;if(Ae[ve]!=le[ve])return Ae[ve]<le[ve]?-1:1}return Ae.length-le.length}function a(ue){if(ue.charAt(ue.length-1)=="/")return ue.slice(0,-1).indexOf("/")===-1?ue:a(ue.slice(0,-1));var ie=ue.lastIndexOf("/");return ie===-1?ue:ue.slice(0,ie+1)}function s(ue){if(ue.charAt(ue.length-1)=="/")return s(ue.slice(0,-1));var ie=ue.lastIndexOf("/");return ie===-1?ue:ue.slice(ie+1)}function i(ue,ie){typeof ie=="string"&&(ie=new Date(ie));var Ae=ie.getHours();Ae=Ae<<6|ie.getMinutes(),Ae=Ae<<5|ie.getSeconds()>>>1,ue.write_shift(2,Ae);var le=ie.getFullYear()-1980;le=le<<4|ie.getMonth()+1,le=le<<5|ie.getDate(),ue.write_shift(2,le)}function o(ue){var ie=ue.read_shift(2)&65535,Ae=ue.read_shift(2)&65535,le=new Date,ve=Ae&31;Ae>>>=5;var me=Ae&15;Ae>>>=4,le.setMilliseconds(0),le.setFullYear(Ae+1980),le.setMonth(me-1),le.setDate(ve);var Pe=ie&31;ie>>>=5;var Qe=ie&63;return ie>>>=6,le.setHours(ie),le.setMinutes(Qe),le.setSeconds(Pe<<1),le}function l(ue){Ka(ue,0);for(var ie={},Ae=0;ue.l<=ue.length-4;){var le=ue.read_shift(2),ve=ue.read_shift(2),me=ue.l+ve,Pe={};switch(le){case 21589:Ae=ue.read_shift(1),Ae&1&&(Pe.mtime=ue.read_shift(4)),ve>5&&(Ae&2&&(Pe.atime=ue.read_shift(4)),Ae&4&&(Pe.ctime=ue.read_shift(4))),Pe.mtime&&(Pe.mt=new Date(Pe.mtime*1e3));break}ue.l=me,ie[le]=Pe}return ie}var c;function d(){return c||(c={})}function u(ue,ie){if(ue[0]==80&&ue[1]==75)return Nt(ue,ie);if((ue[0]|32)==109&&(ue[1]|32)==105)return ht(ue,ie);if(ue.length<512)throw new Error("CFB file size "+ue.length+" < 512");var Ae=3,le=512,ve=0,me=0,Pe=0,Qe=0,Ke=0,Xe=[],Me=ue.slice(0,512);Ka(Me,0);var Ce=f(Me);switch(Ae=Ce[0],Ae){case 3:le=512;break;case 4:le=4096;break;case 0:if(Ce[1]==0)return Nt(ue,ie);default:throw new Error("Major Version: Expected 3 or 4 saw "+Ae)}le!==512&&(Me=ue.slice(0,le),Ka(Me,28));var We=ue.slice(0,le);h(Me,Ae);var Je=Me.read_shift(4,"i");if(Ae===3&&Je!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Je);Me.l+=4,Pe=Me.read_shift(4,"i"),Me.l+=4,Me.chk("00100000","Mini Stream Cutoff Size: "),Qe=Me.read_shift(4,"i"),ve=Me.read_shift(4,"i"),Ke=Me.read_shift(4,"i"),me=Me.read_shift(4,"i");for(var ot=-1,lt=0;lt<109&&(ot=Me.read_shift(4,"i"),!(ot<0));++lt)Xe[lt]=ot;var kt=A(ue,le);b(Ke,me,kt,le,Xe);var Xt=g(kt,Pe,Xe,le);Xt[Pe].name="!Directory",ve>0&&Qe!==T&&(Xt[Qe].name="!MiniFAT"),Xt[Xe[0]].name="!FAT",Xt.fat_addrs=Xe,Xt.ssz=le;var $t={},Pt=[],jr=[],tr=[];y(Pe,Xt,kt,Pt,ve,$t,jr,Qe),x(jr,tr,Pt),Pt.shift();var Er={FileIndex:jr,FullPaths:tr};return ie&&ie.raw&&(Er.raw={header:We,sectors:kt}),Er}function f(ue){if(ue[ue.l]==80&&ue[ue.l+1]==75)return[0,0];ue.chk(R,"Header Signature: "),ue.l+=16;var ie=ue.read_shift(2,"u");return[ue.read_shift(2,"u"),ie]}function h(ue,ie){var Ae=9;switch(ue.l+=2,Ae=ue.read_shift(2)){case 9:if(ie!=3)throw new Error("Sector Shift: Expected 9 saw "+Ae);break;case 12:if(ie!=4)throw new Error("Sector Shift: Expected 12 saw "+Ae);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+Ae)}ue.chk("0600","Mini Sector Shift: "),ue.chk("000000000000","Reserved: ")}function A(ue,ie){for(var Ae=Math.ceil(ue.length/ie)-1,le=[],ve=1;ve<Ae;++ve)le[ve-1]=ue.slice(ve*ie,(ve+1)*ie);return le[Ae-1]=ue.slice(Ae*ie),le}function x(ue,ie,Ae){for(var le=0,ve=0,me=0,Pe=0,Qe=0,Ke=Ae.length,Xe=[],Me=[];le<Ke;++le)Xe[le]=Me[le]=le,ie[le]=Ae[le];for(;Qe<Me.length;++Qe)le=Me[Qe],ve=ue[le].L,me=ue[le].R,Pe=ue[le].C,Xe[le]===le&&(ve!==-1&&Xe[ve]!==ve&&(Xe[le]=Xe[ve]),me!==-1&&Xe[me]!==me&&(Xe[le]=Xe[me])),Pe!==-1&&(Xe[Pe]=le),ve!==-1&&le!=Xe[le]&&(Xe[ve]=Xe[le],Me.lastIndexOf(ve)<Qe&&Me.push(ve)),me!==-1&&le!=Xe[le]&&(Xe[me]=Xe[le],Me.lastIndexOf(me)<Qe&&Me.push(me));for(le=1;le<Ke;++le)Xe[le]===le&&(me!==-1&&Xe[me]!==me?Xe[le]=Xe[me]:ve!==-1&&Xe[ve]!==ve&&(Xe[le]=Xe[ve]));for(le=1;le<Ke;++le)if(ue[le].type!==0){if(Qe=le,Qe!=Xe[Qe])do Qe=Xe[Qe],ie[le]=ie[Qe]+"/"+ie[le];while(Qe!==0&&Xe[Qe]!==-1&&Qe!=Xe[Qe]);Xe[le]=-1}for(ie[0]+="/",le=1;le<Ke;++le)ue[le].type!==2&&(ie[le]+="/")}function p(ue,ie,Ae){for(var le=ue.start,ve=ue.size,me=[],Pe=le;Ae&&ve>0&&Pe>=0;)me.push(ie.slice(Pe*w,Pe*w+w)),ve-=w,Pe=Sd(Ae,Pe*4);return me.length===0?ct(0):Ta(me).slice(0,ue.size)}function b(ue,ie,Ae,le,ve){var me=T;if(ue===T){if(ie!==0)throw new Error("DIFAT chain shorter than expected")}else if(ue!==-1){var Pe=Ae[ue],Qe=(le>>>2)-1;if(!Pe)return;for(var Ke=0;Ke<Qe&&(me=Sd(Pe,Ke*4))!==T;++Ke)ve.push(me);b(Sd(Pe,le-4),ie-1,Ae,le,ve)}}function m(ue,ie,Ae,le,ve){var me=[],Pe=[];ve||(ve=[]);var Qe=le-1,Ke=0,Xe=0;for(Ke=ie;Ke>=0;){ve[Ke]=!0,me[me.length]=Ke,Pe.push(ue[Ke]);var Me=Ae[Math.floor(Ke*4/le)];if(Xe=Ke*4&Qe,le<4+Xe)throw new Error("FAT boundary crossed: "+Ke+" 4 "+le);if(!ue[Me])break;Ke=Sd(ue[Me],Xe)}return{nodes:me,data:VC([Pe])}}function g(ue,ie,Ae,le){var ve=ue.length,me=[],Pe=[],Qe=[],Ke=[],Xe=le-1,Me=0,Ce=0,We=0,Je=0;for(Me=0;Me<ve;++Me)if(Qe=[],We=Me+ie,We>=ve&&(We-=ve),!Pe[We]){Ke=[];var ot=[];for(Ce=We;Ce>=0;){ot[Ce]=!0,Pe[Ce]=!0,Qe[Qe.length]=Ce,Ke.push(ue[Ce]);var lt=Ae[Math.floor(Ce*4/le)];if(Je=Ce*4&Xe,le<4+Je)throw new Error("FAT boundary crossed: "+Ce+" 4 "+le);if(!ue[lt]||(Ce=Sd(ue[lt],Je),ot[Ce]))break}me[We]={nodes:Qe,data:VC([Ke])}}return me}function y(ue,ie,Ae,le,ve,me,Pe,Qe){for(var Ke=0,Xe=le.length?2:0,Me=ie[ue].data,Ce=0,We=0,Je;Ce<Me.length;Ce+=128){var ot=Me.slice(Ce,Ce+128);Ka(ot,64),We=ot.read_shift(2),Je=k2(ot,0,We-Xe),le.push(Je);var lt={name:Je,type:ot.read_shift(1),color:ot.read_shift(1),L:ot.read_shift(4,"i"),R:ot.read_shift(4,"i"),C:ot.read_shift(4,"i"),clsid:ot.read_shift(16),state:ot.read_shift(4,"i"),start:0,size:0},kt=ot.read_shift(2)+ot.read_shift(2)+ot.read_shift(2)+ot.read_shift(2);kt!==0&&(lt.ct=v(ot,ot.l-8));var Xt=ot.read_shift(2)+ot.read_shift(2)+ot.read_shift(2)+ot.read_shift(2);Xt!==0&&(lt.mt=v(ot,ot.l-8)),lt.start=ot.read_shift(4,"i"),lt.size=ot.read_shift(4,"i"),lt.size<0&&lt.start<0&&(lt.size=lt.type=0,lt.start=T,lt.name=""),lt.type===5?(Ke=lt.start,ve>0&&Ke!==T&&(ie[Ke].name="!StreamData")):lt.size>=4096?(lt.storage="fat",ie[lt.start]===void 0&&(ie[lt.start]=m(Ae,lt.start,ie.fat_addrs,ie.ssz)),ie[lt.start].name=lt.name,lt.content=ie[lt.start].data.slice(0,lt.size)):(lt.storage="minifat",lt.size<0?lt.size=0:Ke!==T&&lt.start!==T&&ie[Ke]&&(lt.content=p(lt,ie[Ke].data,(ie[Qe]||{}).data))),lt.content&&Ka(lt.content,0),me[Je]=lt,Pe.push(lt)}}function v(ue,ie){return new Date((ci(ue,ie+4)/1e7*Math.pow(2,32)+ci(ue,ie)/1e7-11644473600)*1e3)}function _(ue,ie){return d(),u(c.readFileSync(ue),ie)}function j(ue,ie){var Ae=ie&&ie.type;switch(Ae||yr&&Buffer.isBuffer(ue)&&(Ae="buffer"),Ae||"base64"){case"file":return _(ue,ie);case"base64":return u(ui(xi(ue)),ie);case"binary":return u(ui(ue),ie)}return u(ue,ie)}function N(ue,ie){var Ae=ie||{},le=Ae.root||"Root Entry";if(ue.FullPaths||(ue.FullPaths=[]),ue.FileIndex||(ue.FileIndex=[]),ue.FullPaths.length!==ue.FileIndex.length)throw new Error("inconsistent CFB structure");ue.FullPaths.length===0&&(ue.FullPaths[0]=le+"/",ue.FileIndex[0]={name:le,type:5}),Ae.CLSID&&(ue.FileIndex[0].clsid=Ae.CLSID),B(ue)}function B(ue){var ie="Sh33tJ5";if(!er.find(ue,"/"+ie)){var Ae=ct(4);Ae[0]=55,Ae[1]=Ae[3]=50,Ae[2]=54,ue.FileIndex.push({name:ie,type:2,content:Ae,size:4,L:69,R:69,C:69}),ue.FullPaths.push(ue.FullPaths[0]+ie),E(ue)}}function E(ue,ie){N(ue);for(var Ae=!1,le=!1,ve=ue.FullPaths.length-1;ve>=0;--ve){var me=ue.FileIndex[ve];switch(me.type){case 0:le?Ae=!0:(ue.FileIndex.pop(),ue.FullPaths.pop());break;case 1:case 2:case 5:le=!0,isNaN(me.R*me.L*me.C)&&(Ae=!0),me.R>-1&&me.L>-1&&me.R==me.L&&(Ae=!0);break;default:Ae=!0;break}}if(!(!Ae&&!ie)){var Pe=new Date(1987,1,19),Qe=0,Ke=Object.create?Object.create(null):{},Xe=[];for(ve=0;ve<ue.FullPaths.length;++ve)Ke[ue.FullPaths[ve]]=!0,ue.FileIndex[ve].type!==0&&Xe.push([ue.FullPaths[ve],ue.FileIndex[ve]]);for(ve=0;ve<Xe.length;++ve){var Me=a(Xe[ve][0]);le=Ke[Me],le||(Xe.push([Me,{name:s(Me).replace("/",""),type:1,clsid:z,ct:Pe,mt:Pe,content:null}]),Ke[Me]=!0)}for(Xe.sort(function(Je,ot){return r(Je[0],ot[0])}),ue.FullPaths=[],ue.FileIndex=[],ve=0;ve<Xe.length;++ve)ue.FullPaths[ve]=Xe[ve][0],ue.FileIndex[ve]=Xe[ve][1];for(ve=0;ve<Xe.length;++ve){var Ce=ue.FileIndex[ve],We=ue.FullPaths[ve];if(Ce.name=s(We).replace("/",""),Ce.L=Ce.R=Ce.C=-(Ce.color=1),Ce.size=Ce.content?Ce.content.length:0,Ce.start=0,Ce.clsid=Ce.clsid||z,ve===0)Ce.C=Xe.length>1?1:-1,Ce.size=0,Ce.type=5;else if(We.slice(-1)=="/"){for(Qe=ve+1;Qe<Xe.length&&a(ue.FullPaths[Qe])!=We;++Qe);for(Ce.C=Qe>=Xe.length?-1:Qe,Qe=ve+1;Qe<Xe.length&&a(ue.FullPaths[Qe])!=a(We);++Qe);Ce.R=Qe>=Xe.length?-1:Qe,Ce.type=1}else a(ue.FullPaths[ve+1]||"")==a(We)&&(Ce.R=ve+1),Ce.type=2}}}function C(ue,ie){var Ae=ie||{};if(Ae.fileType=="mad")return Ft(ue,Ae);switch(E(ue),Ae.fileType){case"zip":return Et(ue,Ae)}var le=function(Je){for(var ot=0,lt=0,kt=0;kt<Je.FileIndex.length;++kt){var Xt=Je.FileIndex[kt];if(Xt.content){var $t=Xt.content.length;$t>0&&($t<4096?ot+=$t+63>>6:lt+=$t+511>>9)}}for(var Pt=Je.FullPaths.length+3>>2,jr=ot+7>>3,tr=ot+127>>7,Er=jr+lt+Pt+tr,Hr=Er+127>>7,Gs=Hr<=109?0:Math.ceil((Hr-109)/127);Er+Hr+Gs+127>>7>Hr;)Gs=++Hr<=109?0:Math.ceil((Hr-109)/127);var Fn=[1,Gs,Hr,tr,Pt,lt,ot,0];return Je.FileIndex[0].size=ot<<6,Fn[7]=(Je.FileIndex[0].start=Fn[0]+Fn[1]+Fn[2]+Fn[3]+Fn[4]+Fn[5])+(Fn[6]+7>>3),Fn}(ue),ve=ct(le[7]<<9),me=0,Pe=0;{for(me=0;me<8;++me)ve.write_shift(1,q[me]);for(me=0;me<8;++me)ve.write_shift(2,0);for(ve.write_shift(2,62),ve.write_shift(2,3),ve.write_shift(2,65534),ve.write_shift(2,9),ve.write_shift(2,6),me=0;me<3;++me)ve.write_shift(2,0);for(ve.write_shift(4,0),ve.write_shift(4,le[2]),ve.write_shift(4,le[0]+le[1]+le[2]+le[3]-1),ve.write_shift(4,0),ve.write_shift(4,4096),ve.write_shift(4,le[3]?le[0]+le[1]+le[2]-1:T),ve.write_shift(4,le[3]),ve.write_shift(-4,le[1]?le[0]-1:T),ve.write_shift(4,le[1]),me=0;me<109;++me)ve.write_shift(-4,me<le[2]?le[1]+me:-1)}if(le[1])for(Pe=0;Pe<le[1];++Pe){for(;me<236+Pe*127;++me)ve.write_shift(-4,me<le[2]?le[1]+me:-1);ve.write_shift(-4,Pe===le[1]-1?T:Pe+1)}var Qe=function(Je){for(Pe+=Je;me<Pe-1;++me)ve.write_shift(-4,me+1);Je&&(++me,ve.write_shift(-4,T))};for(Pe=me=0,Pe+=le[1];me<Pe;++me)ve.write_shift(-4,ee.DIFSECT);for(Pe+=le[2];me<Pe;++me)ve.write_shift(-4,ee.FATSECT);Qe(le[3]),Qe(le[4]);for(var Ke=0,Xe=0,Me=ue.FileIndex[0];Ke<ue.FileIndex.length;++Ke)Me=ue.FileIndex[Ke],Me.content&&(Xe=Me.content.length,!(Xe<4096)&&(Me.start=Pe,Qe(Xe+511>>9)));for(Qe(le[6]+7>>3);ve.l&511;)ve.write_shift(-4,ee.ENDOFCHAIN);for(Pe=me=0,Ke=0;Ke<ue.FileIndex.length;++Ke)Me=ue.FileIndex[Ke],Me.content&&(Xe=Me.content.length,!(!Xe||Xe>=4096)&&(Me.start=Pe,Qe(Xe+63>>6)));for(;ve.l&511;)ve.write_shift(-4,ee.ENDOFCHAIN);for(me=0;me<le[4]<<2;++me){var Ce=ue.FullPaths[me];if(!Ce||Ce.length===0){for(Ke=0;Ke<17;++Ke)ve.write_shift(4,0);for(Ke=0;Ke<3;++Ke)ve.write_shift(4,-1);for(Ke=0;Ke<12;++Ke)ve.write_shift(4,0);continue}Me=ue.FileIndex[me],me===0&&(Me.start=Me.size?Me.start-1:T);var We=me===0&&Ae.root||Me.name;if(Xe=2*(We.length+1),ve.write_shift(64,We,"utf16le"),ve.write_shift(2,Xe),ve.write_shift(1,Me.type),ve.write_shift(1,Me.color),ve.write_shift(-4,Me.L),ve.write_shift(-4,Me.R),ve.write_shift(-4,Me.C),Me.clsid)ve.write_shift(16,Me.clsid,"hex");else for(Ke=0;Ke<4;++Ke)ve.write_shift(4,0);ve.write_shift(4,Me.state||0),ve.write_shift(4,0),ve.write_shift(4,0),ve.write_shift(4,0),ve.write_shift(4,0),ve.write_shift(4,Me.start),ve.write_shift(4,Me.size),ve.write_shift(4,0)}for(me=1;me<ue.FileIndex.length;++me)if(Me=ue.FileIndex[me],Me.size>=4096)if(ve.l=Me.start+1<<9,yr&&Buffer.isBuffer(Me.content))Me.content.copy(ve,ve.l,0,Me.size),ve.l+=Me.size+511&-512;else{for(Ke=0;Ke<Me.size;++Ke)ve.write_shift(1,Me.content[Ke]);for(;Ke&511;++Ke)ve.write_shift(1,0)}for(me=1;me<ue.FileIndex.length;++me)if(Me=ue.FileIndex[me],Me.size>0&&Me.size<4096)if(yr&&Buffer.isBuffer(Me.content))Me.content.copy(ve,ve.l,0,Me.size),ve.l+=Me.size+63&-64;else{for(Ke=0;Ke<Me.size;++Ke)ve.write_shift(1,Me.content[Ke]);for(;Ke&63;++Ke)ve.write_shift(1,0)}if(yr)ve.l=ve.length;else for(;ve.l<ve.length;)ve.write_shift(1,0);return ve}function k(ue,ie){var Ae=ue.FullPaths.map(function(Ke){return Ke.toUpperCase()}),le=Ae.map(function(Ke){var Xe=Ke.split("/");return Xe[Xe.length-(Ke.slice(-1)=="/"?2:1)]}),ve=!1;ie.charCodeAt(0)===47?(ve=!0,ie=Ae[0].slice(0,-1)+ie):ve=ie.indexOf("/")!==-1;var me=ie.toUpperCase(),Pe=ve===!0?Ae.indexOf(me):le.indexOf(me);if(Pe!==-1)return ue.FileIndex[Pe];var Qe=!me.match(ff);for(me=me.replace(Es,""),Qe&&(me=me.replace(ff,"!")),Pe=0;Pe<Ae.length;++Pe)if((Qe?Ae[Pe].replace(ff,"!"):Ae[Pe]).replace(Es,"")==me||(Qe?le[Pe].replace(ff,"!"):le[Pe]).replace(Es,"")==me)return ue.FileIndex[Pe];return null}var w=64,T=-2,R="d0cf11e0a1b11ae1",q=[208,207,17,224,161,177,26,225],z="00000000000000000000000000000000",ee={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:T,FREESECT:-1,HEADER_SIGNATURE:R,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:z,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Y(ue,ie,Ae){d();var le=C(ue,Ae);c.writeFileSync(ie,le)}function G(ue){for(var ie=new Array(ue.length),Ae=0;Ae<ue.length;++Ae)ie[Ae]=String.fromCharCode(ue[Ae]);return ie.join("")}function re(ue,ie){var Ae=C(ue,ie);switch(ie&&ie.type||"buffer"){case"file":return d(),c.writeFileSync(ie.filename,Ae),Ae;case"binary":return typeof Ae=="string"?Ae:G(Ae);case"base64":return x0(typeof Ae=="string"?Ae:G(Ae));case"buffer":if(yr)return Buffer.isBuffer(Ae)?Ae:Vl(Ae);case"array":return typeof Ae=="string"?ui(Ae):Ae}return Ae}var U;function S(ue){try{var ie=ue.InflateRaw,Ae=new ie;if(Ae._processChunk(new Uint8Array([3,0]),Ae._finishFlushFlag),Ae.bytesRead)U=ue;else throw new Error("zlib does not expose bytesRead")}catch(le){console.error("cannot use native zlib: "+(le.message||le))}}function D(ue,ie){if(!U)return mt(ue,ie);var Ae=U.InflateRaw,le=new Ae,ve=le._processChunk(ue.slice(ue.l),le._finishFlushFlag);return ue.l+=le.bytesRead,ve}function L(ue){return U?U.deflateRawSync(ue):Ue(ue)}var P=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],I=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],H=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function V(ue){var ie=(ue<<1|ue<<11)&139536|(ue<<5|ue<<15)&558144;return(ie>>16|ie>>8|ie)&255}for(var W=typeof Uint8Array<"u",M=W?new Uint8Array(256):[],se=0;se<256;++se)M[se]=V(se);function K(ue,ie){var Ae=M[ue&255];return ie<=8?Ae>>>8-ie:(Ae=Ae<<8|M[ue>>8&255],ie<=16?Ae>>>16-ie:(Ae=Ae<<8|M[ue>>16&255],Ae>>>24-ie))}function he(ue,ie){var Ae=ie&7,le=ie>>>3;return(ue[le]|(Ae<=6?0:ue[le+1]<<8))>>>Ae&3}function ne(ue,ie){var Ae=ie&7,le=ie>>>3;return(ue[le]|(Ae<=5?0:ue[le+1]<<8))>>>Ae&7}function te(ue,ie){var Ae=ie&7,le=ie>>>3;return(ue[le]|(Ae<=4?0:ue[le+1]<<8))>>>Ae&15}function ce(ue,ie){var Ae=ie&7,le=ie>>>3;return(ue[le]|(Ae<=3?0:ue[le+1]<<8))>>>Ae&31}function _e(ue,ie){var Ae=ie&7,le=ie>>>3;return(ue[le]|(Ae<=1?0:ue[le+1]<<8))>>>Ae&127}function de(ue,ie,Ae){var le=ie&7,ve=ie>>>3,me=(1<<Ae)-1,Pe=ue[ve]>>>le;return Ae<8-le||(Pe|=ue[ve+1]<<8-le,Ae<16-le)||(Pe|=ue[ve+2]<<16-le,Ae<24-le)||(Pe|=ue[ve+3]<<24-le),Pe&me}function ye(ue,ie,Ae){var le=ie&7,ve=ie>>>3;return le<=5?ue[ve]|=(Ae&7)<<le:(ue[ve]|=Ae<<le&255,ue[ve+1]=(Ae&7)>>8-le),ie+3}function Le(ue,ie,Ae){var le=ie&7,ve=ie>>>3;return Ae=(Ae&1)<<le,ue[ve]|=Ae,ie+1}function we(ue,ie,Ae){var le=ie&7,ve=ie>>>3;return Ae<<=le,ue[ve]|=Ae&255,Ae>>>=8,ue[ve+1]=Ae,ie+8}function ge(ue,ie,Ae){var le=ie&7,ve=ie>>>3;return Ae<<=le,ue[ve]|=Ae&255,Ae>>>=8,ue[ve+1]=Ae&255,ue[ve+2]=Ae>>>8,ie+16}function Re(ue,ie){var Ae=ue.length,le=2*Ae>ie?2*Ae:ie+5,ve=0;if(Ae>=ie)return ue;if(yr){var me=CC(le);if(ue.copy)ue.copy(me);else for(;ve<ue.length;++ve)me[ve]=ue[ve];return me}else if(W){var Pe=new Uint8Array(le);if(Pe.set)Pe.set(ue);else for(;ve<Ae;++ve)Pe[ve]=ue[ve];return Pe}return ue.length=le,ue}function et(ue){for(var ie=new Array(ue),Ae=0;Ae<ue;++Ae)ie[Ae]=0;return ie}function Ye(ue,ie,Ae){var le=1,ve=0,me=0,Pe=0,Qe=0,Ke=ue.length,Xe=W?new Uint16Array(32):et(32);for(me=0;me<32;++me)Xe[me]=0;for(me=Ke;me<Ae;++me)ue[me]=0;Ke=ue.length;var Me=W?new Uint16Array(Ke):et(Ke);for(me=0;me<Ke;++me)Xe[ve=ue[me]]++,le<ve&&(le=ve),Me[me]=0;for(Xe[0]=0,me=1;me<=le;++me)Xe[me+16]=Qe=Qe+Xe[me-1]<<1;for(me=0;me<Ke;++me)Qe=ue[me],Qe!=0&&(Me[me]=Xe[Qe+16]++);var Ce=0;for(me=0;me<Ke;++me)if(Ce=ue[me],Ce!=0)for(Qe=K(Me[me],le)>>le-Ce,Pe=(1<<le+4-Ce)-1;Pe>=0;--Pe)ie[Qe|Pe<<Ce]=Ce&15|me<<4;return le}var Be=W?new Uint16Array(512):et(512),Fe=W?new Uint16Array(32):et(32);if(!W){for(var oe=0;oe<512;++oe)Be[oe]=0;for(oe=0;oe<32;++oe)Fe[oe]=0}(function(){for(var ue=[],ie=0;ie<32;ie++)ue.push(5);Ye(ue,Fe,32);var Ae=[];for(ie=0;ie<=143;ie++)Ae.push(8);for(;ie<=255;ie++)Ae.push(9);for(;ie<=279;ie++)Ae.push(7);for(;ie<=287;ie++)Ae.push(8);Ye(Ae,Be,288)})();var ke=function(){for(var ie=W?new Uint8Array(32768):[],Ae=0,le=0;Ae<H.length-1;++Ae)for(;le<H[Ae+1];++le)ie[le]=Ae;for(;le<32768;++le)ie[le]=29;var ve=W?new Uint8Array(259):[];for(Ae=0,le=0;Ae<I.length-1;++Ae)for(;le<I[Ae+1];++le)ve[le]=Ae;function me(Qe,Ke){for(var Xe=0;Xe<Qe.length;){var Me=Math.min(65535,Qe.length-Xe),Ce=Xe+Me==Qe.length;for(Ke.write_shift(1,+Ce),Ke.write_shift(2,Me),Ke.write_shift(2,~Me&65535);Me-- >0;)Ke[Ke.l++]=Qe[Xe++]}return Ke.l}function Pe(Qe,Ke){for(var Xe=0,Me=0,Ce=W?new Uint16Array(32768):[];Me<Qe.length;){var We=Math.min(65535,Qe.length-Me);if(We<10){for(Xe=ye(Ke,Xe,+(Me+We==Qe.length)),Xe&7&&(Xe+=8-(Xe&7)),Ke.l=Xe/8|0,Ke.write_shift(2,We),Ke.write_shift(2,~We&65535);We-- >0;)Ke[Ke.l++]=Qe[Me++];Xe=Ke.l*8;continue}Xe=ye(Ke,Xe,+(Me+We==Qe.length)+2);for(var Je=0;We-- >0;){var ot=Qe[Me];Je=(Je<<5^ot)&32767;var lt=-1,kt=0;if((lt=Ce[Je])&&(lt|=Me&-32768,lt>Me&&(lt-=32768),lt<Me))for(;Qe[lt+kt]==Qe[Me+kt]&&kt<250;)++kt;if(kt>2){ot=ve[kt],ot<=22?Xe=we(Ke,Xe,M[ot+1]>>1)-1:(we(Ke,Xe,3),Xe+=5,we(Ke,Xe,M[ot-23]>>5),Xe+=3);var Xt=ot<8?0:ot-4>>2;Xt>0&&(ge(Ke,Xe,kt-I[ot]),Xe+=Xt),ot=ie[Me-lt],Xe=we(Ke,Xe,M[ot]>>3),Xe-=3;var $t=ot<4?0:ot-2>>1;$t>0&&(ge(Ke,Xe,Me-lt-H[ot]),Xe+=$t);for(var Pt=0;Pt<kt;++Pt)Ce[Je]=Me&32767,Je=(Je<<5^Qe[Me])&32767,++Me;We-=kt-1}else ot<=143?ot=ot+48:Xe=Le(Ke,Xe,1),Xe=we(Ke,Xe,M[ot]),Ce[Je]=Me&32767,++Me}Xe=we(Ke,Xe,0)-1}return Ke.l=(Xe+7)/8|0,Ke.l}return function(Ke,Xe){return Ke.length<8?me(Ke,Xe):Pe(Ke,Xe)}}();function Ue(ue){var ie=ct(50+Math.floor(ue.length*1.1)),Ae=ke(ue,ie);return ie.slice(0,Ae)}var qe=W?new Uint16Array(32768):et(32768),$e=W?new Uint16Array(32768):et(32768),Ne=W?new Uint16Array(128):et(128),Ee=1,ze=1;function rt(ue,ie){var Ae=ce(ue,ie)+257;ie+=5;var le=ce(ue,ie)+1;ie+=5;var ve=te(ue,ie)+4;ie+=4;for(var me=0,Pe=W?new Uint8Array(19):et(19),Qe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Ke=1,Xe=W?new Uint8Array(8):et(8),Me=W?new Uint8Array(8):et(8),Ce=Pe.length,We=0;We<ve;++We)Pe[P[We]]=me=ne(ue,ie),Ke<me&&(Ke=me),Xe[me]++,ie+=3;var Je=0;for(Xe[0]=0,We=1;We<=Ke;++We)Me[We]=Je=Je+Xe[We-1]<<1;for(We=0;We<Ce;++We)(Je=Pe[We])!=0&&(Qe[We]=Me[Je]++);var ot=0;for(We=0;We<Ce;++We)if(ot=Pe[We],ot!=0){Je=M[Qe[We]]>>8-ot;for(var lt=(1<<7-ot)-1;lt>=0;--lt)Ne[Je|lt<<ot]=ot&7|We<<3}var kt=[];for(Ke=1;kt.length<Ae+le;)switch(Je=Ne[_e(ue,ie)],ie+=Je&7,Je>>>=3){case 16:for(me=3+he(ue,ie),ie+=2,Je=kt[kt.length-1];me-- >0;)kt.push(Je);break;case 17:for(me=3+ne(ue,ie),ie+=3;me-- >0;)kt.push(0);break;case 18:for(me=11+_e(ue,ie),ie+=7;me-- >0;)kt.push(0);break;default:kt.push(Je),Ke<Je&&(Ke=Je);break}var Xt=kt.slice(0,Ae),$t=kt.slice(Ae);for(We=Ae;We<286;++We)Xt[We]=0;for(We=le;We<30;++We)$t[We]=0;return Ee=Ye(Xt,qe,286),ze=Ye($t,$e,30),ie}function nt(ue,ie){if(ue[0]==3&&!(ue[1]&3))return[Vc(ie),2];for(var Ae=0,le=0,ve=CC(ie||1<<18),me=0,Pe=ve.length>>>0,Qe=0,Ke=0;!(le&1);){if(le=ne(ue,Ae),Ae+=3,le>>>1)le>>1==1?(Qe=9,Ke=5):(Ae=rt(ue,Ae),Qe=Ee,Ke=ze);else{Ae&7&&(Ae+=8-(Ae&7));var Xe=ue[Ae>>>3]|ue[(Ae>>>3)+1]<<8;if(Ae+=32,Xe>0)for(!ie&&Pe<me+Xe&&(ve=Re(ve,me+Xe),Pe=ve.length);Xe-- >0;)ve[me++]=ue[Ae>>>3],Ae+=8;continue}for(;;){!ie&&Pe<me+32767&&(ve=Re(ve,me+32767),Pe=ve.length);var Me=de(ue,Ae,Qe),Ce=le>>>1==1?Be[Me]:qe[Me];if(Ae+=Ce&15,Ce>>>=4,!(Ce>>>8&255))ve[me++]=Ce;else{if(Ce==256)break;Ce-=257;var We=Ce<8?0:Ce-4>>2;We>5&&(We=0);var Je=me+I[Ce];We>0&&(Je+=de(ue,Ae,We),Ae+=We),Me=de(ue,Ae,Ke),Ce=le>>>1==1?Fe[Me]:$e[Me],Ae+=Ce&15,Ce>>>=4;var ot=Ce<4?0:Ce-2>>1,lt=H[Ce];for(ot>0&&(lt+=de(ue,Ae,ot),Ae+=ot),!ie&&Pe<Je&&(ve=Re(ve,Je+100),Pe=ve.length);me<Je;)ve[me]=ve[me-lt],++me}}}return ie?[ve,Ae+7>>>3]:[ve.slice(0,me),Ae+7>>>3]}function mt(ue,ie){var Ae=ue.slice(ue.l||0),le=nt(Ae,ie);return ue.l+=le[1],le[0]}function gt(ue,ie){if(ue)typeof console<"u"&&console.error(ie);else throw new Error(ie)}function Nt(ue,ie){var Ae=ue;Ka(Ae,0);var le=[],ve=[],me={FileIndex:le,FullPaths:ve};N(me,{root:ie.root});for(var Pe=Ae.length-4;(Ae[Pe]!=80||Ae[Pe+1]!=75||Ae[Pe+2]!=5||Ae[Pe+3]!=6)&&Pe>=0;)--Pe;Ae.l=Pe+4,Ae.l+=4;var Qe=Ae.read_shift(2);Ae.l+=6;var Ke=Ae.read_shift(4);for(Ae.l=Ke,Pe=0;Pe<Qe;++Pe){Ae.l+=20;var Xe=Ae.read_shift(4),Me=Ae.read_shift(4),Ce=Ae.read_shift(2),We=Ae.read_shift(2),Je=Ae.read_shift(2);Ae.l+=8;var ot=Ae.read_shift(4),lt=l(Ae.slice(Ae.l+Ce,Ae.l+Ce+We));Ae.l+=Ce+We+Je;var kt=Ae.l;Ae.l=ot+4,yt(Ae,Xe,Me,me,lt),Ae.l=kt}return me}function yt(ue,ie,Ae,le,ve){ue.l+=2;var me=ue.read_shift(2),Pe=ue.read_shift(2),Qe=o(ue);if(me&8257)throw new Error("Unsupported ZIP encryption");for(var Ke=ue.read_shift(4),Xe=ue.read_shift(4),Me=ue.read_shift(4),Ce=ue.read_shift(2),We=ue.read_shift(2),Je="",ot=0;ot<Ce;++ot)Je+=String.fromCharCode(ue[ue.l++]);if(We){var lt=l(ue.slice(ue.l,ue.l+We));(lt[21589]||{}).mt&&(Qe=lt[21589].mt),((ve||{})[21589]||{}).mt&&(Qe=ve[21589].mt)}ue.l+=We;var kt=ue.slice(ue.l,ue.l+Xe);switch(Pe){case 8:kt=D(ue,Me);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Pe)}var Xt=!1;me&8&&(Ke=ue.read_shift(4),Ke==134695760&&(Ke=ue.read_shift(4),Xt=!0),Xe=ue.read_shift(4),Me=ue.read_shift(4)),Xe!=ie&&gt(Xt,"Bad compressed size: "+ie+" != "+Xe),Me!=Ae&&gt(Xt,"Bad uncompressed size: "+Ae+" != "+Me),vr(le,Je,kt,{unsafe:!0,mt:Qe})}function Et(ue,ie){var Ae=ie||{},le=[],ve=[],me=ct(1),Pe=Ae.compression?8:0,Qe=0,Ke=0,Xe=0,Me=0,Ce=0,We=ue.FullPaths[0],Je=We,ot=ue.FileIndex[0],lt=[],kt=0;for(Ke=1;Ke<ue.FullPaths.length;++Ke)if(Je=ue.FullPaths[Ke].slice(We.length),ot=ue.FileIndex[Ke],!(!ot.size||!ot.content||Je=="Sh33tJ5")){var Xt=Me,$t=ct(Je.length);for(Xe=0;Xe<Je.length;++Xe)$t.write_shift(1,Je.charCodeAt(Xe)&127);$t=$t.slice(0,$t.l),lt[Ce]=KZ.buf(ot.content,0);var Pt=ot.content;Pe==8&&(Pt=L(Pt)),me=ct(30),me.write_shift(4,67324752),me.write_shift(2,20),me.write_shift(2,Qe),me.write_shift(2,Pe),ot.mt?i(me,ot.mt):me.write_shift(4,0),me.write_shift(-4,lt[Ce]),me.write_shift(4,Pt.length),me.write_shift(4,ot.content.length),me.write_shift(2,$t.length),me.write_shift(2,0),Me+=me.length,le.push(me),Me+=$t.length,le.push($t),Me+=Pt.length,le.push(Pt),me=ct(46),me.write_shift(4,33639248),me.write_shift(2,0),me.write_shift(2,20),me.write_shift(2,Qe),me.write_shift(2,Pe),me.write_shift(4,0),me.write_shift(-4,lt[Ce]),me.write_shift(4,Pt.length),me.write_shift(4,ot.content.length),me.write_shift(2,$t.length),me.write_shift(2,0),me.write_shift(2,0),me.write_shift(2,0),me.write_shift(2,0),me.write_shift(4,0),me.write_shift(4,Xt),kt+=me.l,ve.push(me),kt+=$t.length,ve.push($t),++Ce}return me=ct(22),me.write_shift(4,101010256),me.write_shift(2,0),me.write_shift(2,0),me.write_shift(2,Ce),me.write_shift(2,Ce),me.write_shift(4,kt),me.write_shift(4,Me),me.write_shift(2,0),Ta([Ta(le),Ta(ve),me])}var It={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ir(ue,ie){if(ue.ctype)return ue.ctype;var Ae=ue.name||"",le=Ae.match(/\.([^\.]+)$/);return le&&It[le[1]]||ie&&(le=(Ae=ie).match(/[\.\\]([^\.\\])+$/),le&&It[le[1]])?It[le[1]]:"application/octet-stream"}function Oe(ue){for(var ie=x0(ue),Ae=[],le=0;le<ie.length;le+=76)Ae.push(ie.slice(le,le+76));return Ae.join(`\r
`)+`\r
`}function tt(ue){var ie=ue.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Xe){var Me=Xe.charCodeAt(0).toString(16).toUpperCase();return"="+(Me.length==1?"0"+Me:Me)});ie=ie.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ie.charAt(0)==`
`&&(ie="=0D"+ie.slice(1)),ie=ie.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var Ae=[],le=ie.split(`\r
`),ve=0;ve<le.length;++ve){var me=le[ve];if(me.length==0){Ae.push("");continue}for(var Pe=0;Pe<me.length;){var Qe=76,Ke=me.slice(Pe,Pe+Qe);Ke.charAt(Qe-1)=="="?Qe--:Ke.charAt(Qe-2)=="="?Qe-=2:Ke.charAt(Qe-3)=="="&&(Qe-=3),Ke=me.slice(Pe,Pe+Qe),Pe+=Qe,Pe<me.length&&(Ke+="="),Ae.push(Ke)}}return Ae.join(`\r
`)}function At(ue){for(var ie=[],Ae=0;Ae<ue.length;++Ae){for(var le=ue[Ae];Ae<=ue.length&&le.charAt(le.length-1)=="=";)le=le.slice(0,le.length-1)+ue[++Ae];ie.push(le)}for(var ve=0;ve<ie.length;++ve)ie[ve]=ie[ve].replace(/[=][0-9A-Fa-f]{2}/g,function(me){return String.fromCharCode(parseInt(me.slice(1),16))});return ui(ie.join(`\r
`))}function wt(ue,ie,Ae){for(var le="",ve="",me="",Pe,Qe=0;Qe<10;++Qe){var Ke=ie[Qe];if(!Ke||Ke.match(/^\s*$/))break;var Xe=Ke.match(/^(.*?):\s*([^\s].*)$/);if(Xe)switch(Xe[1].toLowerCase()){case"content-location":le=Xe[2].trim();break;case"content-type":me=Xe[2].trim();break;case"content-transfer-encoding":ve=Xe[2].trim();break}}switch(++Qe,ve.toLowerCase()){case"base64":Pe=ui(xi(ie.slice(Qe).join("")));break;case"quoted-printable":Pe=At(ie.slice(Qe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ve)}var Me=vr(ue,le.slice(Ae.length),Pe,{unsafe:!0});me&&(Me.ctype=me)}function ht(ue,ie){if(G(ue.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var Ae=ie&&ie.root||"",le=(yr&&Buffer.isBuffer(ue)?ue.toString("binary"):G(ue)).split(`\r
`),ve=0,me="";for(ve=0;ve<le.length;++ve)if(me=le[ve],!!/^Content-Location:/i.test(me)&&(me=me.slice(me.indexOf("file")),Ae||(Ae=me.slice(0,me.lastIndexOf("/")+1)),me.slice(0,Ae.length)!=Ae))for(;Ae.length>0&&(Ae=Ae.slice(0,Ae.length-1),Ae=Ae.slice(0,Ae.lastIndexOf("/")+1),me.slice(0,Ae.length)!=Ae););var Pe=(le[1]||"").match(/boundary="(.*?)"/);if(!Pe)throw new Error("MAD cannot find boundary");var Qe="--"+(Pe[1]||""),Ke=[],Xe=[],Me={FileIndex:Ke,FullPaths:Xe};N(Me);var Ce,We=0;for(ve=0;ve<le.length;++ve){var Je=le[ve];Je!==Qe&&Je!==Qe+"--"||(We++&&wt(Me,le.slice(Ce,ve),Ae),Ce=ve)}return Me}function Ft(ue,ie){var Ae=ie||{},le=Ae.boundary||"SheetJS";le="------="+le;for(var ve=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+le.slice(2)+'"',"","",""],me=ue.FullPaths[0],Pe=me,Qe=ue.FileIndex[0],Ke=1;Ke<ue.FullPaths.length;++Ke)if(Pe=ue.FullPaths[Ke].slice(me.length),Qe=ue.FileIndex[Ke],!(!Qe.size||!Qe.content||Pe=="Sh33tJ5")){Pe=Pe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(kt){return"_x"+kt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(kt){return"_u"+kt.charCodeAt(0).toString(16)+"_"});for(var Xe=Qe.content,Me=yr&&Buffer.isBuffer(Xe)?Xe.toString("binary"):G(Xe),Ce=0,We=Math.min(1024,Me.length),Je=0,ot=0;ot<=We;++ot)(Je=Me.charCodeAt(ot))>=32&&Je<128&&++Ce;var lt=Ce>=We*4/5;ve.push(le),ve.push("Content-Location: "+(Ae.root||"file:///C:/SheetJS/")+Pe),ve.push("Content-Transfer-Encoding: "+(lt?"quoted-printable":"base64")),ve.push("Content-Type: "+ir(Qe,Pe)),ve.push(""),ve.push(lt?tt(Me):Oe(Me))}return ve.push(le+`--\r
`),ve.join(`\r
`)}function Ht(ue){var ie={};return N(ie,ue),ie}function vr(ue,ie,Ae,le){var ve=le&&le.unsafe;ve||N(ue);var me=!ve&&er.find(ue,ie);if(!me){var Pe=ue.FullPaths[0];ie.slice(0,Pe.length)==Pe?Pe=ie:(Pe.slice(-1)!="/"&&(Pe+="/"),Pe=(Pe+ie).replace("//","/")),me={name:s(ie),type:2},ue.FileIndex.push(me),ue.FullPaths.push(Pe),ve||er.utils.cfb_gc(ue)}return me.content=Ae,me.size=Ae?Ae.length:0,le&&(le.CLSID&&(me.clsid=le.CLSID),le.mt&&(me.mt=le.mt),le.ct&&(me.ct=le.ct)),me}function xr(ue,ie){N(ue);var Ae=er.find(ue,ie);if(Ae){for(var le=0;le<ue.FileIndex.length;++le)if(ue.FileIndex[le]==Ae)return ue.FileIndex.splice(le,1),ue.FullPaths.splice(le,1),!0}return!1}function Jt(ue,ie,Ae){N(ue);var le=er.find(ue,ie);if(le){for(var ve=0;ve<ue.FileIndex.length;++ve)if(ue.FileIndex[ve]==le)return ue.FileIndex[ve].name=s(Ae),ue.FullPaths[ve]=Ae,!0}return!1}function Wt(ue){E(ue,!0)}return t.find=k,t.read=j,t.parse=u,t.write=re,t.writeFile=Y,t.utils={cfb_new:Ht,cfb_add:vr,cfb_del:xr,cfb_mov:Jt,cfb_gc:Wt,ReadShift:Df,CheckField:TT,prep_blob:Ka,bconcat:Ta,use_zlib:S,_deflateRaw:Ue,_inflateRaw:mt,consts:ee},t}();function VZ(e){return typeof e=="string"?iy(e):Array.isArray(e)?xZ(e):e}function H0(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=iy(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var a=r=="utf8"?qo(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(a,e);if(typeof Blob<"u"){var s=new Blob([VZ(a)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=i,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(t)&&(t=Zc(t)),l.write(t),l.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function WZ(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+e)}function Mn(e){for(var t=Object.keys(e),r=[],a=0;a<t.length;++a)Object.prototype.hasOwnProperty.call(e,t[a])&&r.push(t[a]);return r}function LC(e,t){for(var r=[],a=Mn(e),s=0;s!==a.length;++s)r[e[a[s]][t]]==null&&(r[e[a[s]][t]]=a[s]);return r}function ly(e){for(var t=[],r=Mn(e),a=0;a!==r.length;++a)t[e[r[a]]]=r[a];return t}function cy(e){for(var t=[],r=Mn(e),a=0;a!==r.length;++a)t[e[r[a]]]=parseInt(r[a],10);return t}function zZ(e){for(var t=[],r=Mn(e),a=0;a!==r.length;++a)t[e[r[a]]]==null&&(t[e[r[a]]]=[]),t[e[r[a]]].push(r[a]);return t}var dx=new Date(1899,11,30,0,0,0);function ka(e,t){var r=e.getTime(),a=dx.getTime()+(e.getTimezoneOffset()-dx.getTimezoneOffset())*6e4;return(r-a)/(24*60*60*1e3)}var uT=new Date,GZ=dx.getTime()+(uT.getTimezoneOffset()-dx.getTimezoneOffset())*6e4,PC=uT.getTimezoneOffset();function dy(e){var t=new Date;return t.setTime(e*24*60*60*1e3+GZ),t.getTimezoneOffset()!==PC&&t.setTime(t.getTime()+(t.getTimezoneOffset()-PC)*6e4),t}function XZ(e){var t=0,r=0,a=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=s.length;++i)if(s[i]){switch(r=1,i>3&&(a=!0),s[i].slice(s[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[i].slice(s[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(a)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(s[i],10)}return t}var OC=new Date("2017-02-19T19:06:09.000Z"),AT=isNaN(OC.getFullYear())?new Date("2/19/17"):OC,YZ=AT.getFullYear()==2017;function xn(e,t){var r=new Date(e);if(YZ)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(AT.getFullYear()==1917&&!isNaN(r.getFullYear())){var a=r.getFullYear();return e.indexOf(""+a)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function Zd(e,t){if(yr&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return qo(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return qo(ZF(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return qo(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return qo(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var a=[],s=0;s!=e.length;++s)a.push(String.fromCharCode(e[s]));return a.join("")}function yn(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=yn(e[r]));return t}function On(e,t){for(var r="";r.length<t;)r+=e;return r}function go(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(a))||(a=a.replace(/[(](.*)[)]/,function(s,i){return r=-r,i}),!isNaN(t=Number(a)))?t/r:t}var JZ=["january","february","march","april","may","june","july","august","september","october","november","december"];function RA(e){var t=new Date(e),r=new Date(NaN),a=t.getYear(),s=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&JZ.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return a<0||a>8099?r:(s>0||i>1)&&a!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var ZZ=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,a,s){if(e||typeof a=="string")return r.split(a);for(var i=r.split(a),o=[i[0]],l=1;l<i.length;++l)o.push(s),o.push(i[l]);return o}}();function hT(e){return e?e.content&&e.type?Zd(e.content,!0):e.data?hf(e.data):e.asNodeBuffer&&yr?hf(e.asNodeBuffer().toString("binary")):e.asBinary?hf(e.asBinary()):e._data&&e._data.getContent?hf(Zd(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function fT(e){if(!e)return null;if(e.data)return jC(e.data);if(e.asNodeBuffer&&yr)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?jC(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function eee(e){return e&&e.name.slice(-4)===".bin"?fT(e):hT(e)}function Ti(e,t){for(var r=e.FullPaths||Mn(e.files),a=t.toLowerCase().replace(/[\/]/g,"\\"),s=a.replace(/\\/g,"/"),i=0;i<r.length;++i){var o=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==o||s==o)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function v2(e,t){var r=Ti(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function sa(e,t,r){if(!r)return eee(v2(e,t));if(!t)return null;try{return sa(e,t)}catch{return null}}function Ai(e,t,r){if(!r)return hT(v2(e,t));if(!t)return null;try{return Ai(e,t)}catch{return null}}function tee(e,t,r){return fT(v2(e,t))}function UC(e){for(var t=e.FullPaths||Mn(e.files),r=[],a=0;a<t.length;++a)t[a].slice(-1)!="/"&&r.push(t[a].replace(/^Root Entry[\/]/,""));return r.sort()}function gr(e,t,r){if(e.FullPaths){if(typeof r=="string"){var a;return yr?a=Vl(r):a=yZ(r),er.utils.cfb_add(e,t,a)}er.utils.cfb_add(e,t,r)}else e.file(t,r)}function b2(){return er.utils.cfb_new()}function pT(e,t){switch(t.type){case"base64":return er.read(e,{type:"base64"});case"binary":return er.read(e,{type:"binary"});case"buffer":case"array":return er.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function pf(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var a=e.split("/");a.length!==0;){var s=a.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var ea=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,ree=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,RC=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,nee=/<[^>]*>/g,ms=ea.match(RC)?RC:nee,aee=/<\w*:/,see=/<(\/?)\w+:/;function or(e,t,r){for(var a={},s=0,i=0;s!==e.length&&!((i=e.charCodeAt(s))===32||i===10||i===13);++s);if(t||(a[0]=e.slice(0,s)),s===e.length)return a;var o=e.match(ree),l=0,c="",d=0,u="",f="",h=1;if(o)for(d=0;d!=o.length;++d){for(f=o[d],i=0;i!=f.length&&f.charCodeAt(i)!==61;++i);for(u=f.slice(0,i).trim();f.charCodeAt(i+1)==32;)++i;for(h=(s=f.charCodeAt(i+1))==34||s==39?1:0,c=f.slice(i+1+h,f.length-h),l=0;l!=u.length&&u.charCodeAt(l)!==58;++l);if(l===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),a[u]=c,a[u.toLowerCase()]=c;else{var A=(l===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(l+1);if(a[A]&&u.slice(l-3,l)=="ext")continue;a[A]=c,a[A.toLowerCase()]=c}}return a}function el(e){return e.replace(see,"<$1")}var mT={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},_2=ly(mT),Dr=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(a){var s=a+"",i=s.indexOf("<![CDATA[");if(i==-1)return s.replace(e,function(l,c){return mT[l]||String.fromCharCode(parseInt(c,l.indexOf("x")>-1?16:10))||l}).replace(t,function(l,c){return String.fromCharCode(parseInt(c,16))});var o=s.indexOf("]]>");return r(s.slice(0,i))+s.slice(i+9,o)+r(s.slice(o+3))}}(),w2=/[&<>'"]/g,iee=/[\u0000-\u0008\u000b-\u001f]/g;function Gr(e){var t=e+"";return t.replace(w2,function(r){return _2[r]}).replace(iee,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function MC(e){return Gr(e).replace(/ /g,"_x0020_")}var gT=/[\u0000-\u001f]/g;function N2(e){var t=e+"";return t.replace(w2,function(r){return _2[r]}).replace(/\n/g,"<br/>").replace(gT,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function oee(e){var t=e+"";return t.replace(w2,function(r){return _2[r]}).replace(gT,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var QC=function(){var e=/&#(\d+);/g;function t(r,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(e,t)}}();function lee(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function fn(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function S1(e){for(var t="",r=0,a=0,s=0,i=0,o=0,l=0;r<e.length;){if(a=e.charCodeAt(r++),a<128){t+=String.fromCharCode(a);continue}if(s=e.charCodeAt(r++),a>191&&a<224){o=(a&31)<<6,o|=s&63,t+=String.fromCharCode(o);continue}if(i=e.charCodeAt(r++),a<240){t+=String.fromCharCode((a&15)<<12|(s&63)<<6|i&63);continue}o=e.charCodeAt(r++),l=((a&7)<<18|(s&63)<<12|(i&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function HC(e){var t=Vc(2*e.length),r,a,s=1,i=0,o=0,l;for(a=0;a<e.length;a+=s)s=1,(l=e.charCodeAt(a))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(a+1)&63),s=2):l<240?(r=(l&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63),s=3):(s=4,r=(l&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[i++]=o&255,t[i++]=o>>>8,o=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function qC(e){return Vl(e,"binary").toString("utf8")}var Fm="foo bar baz",Jr=yr&&(qC(Fm)==S1(Fm)&&qC||HC(Fm)==S1(Fm)&&HC)||S1,qo=yr?function(e){return Vl(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,a=0,s=0;r<e.length;)switch(a=e.charCodeAt(r++),!0){case a<128:t.push(String.fromCharCode(a));break;case a<2048:t.push(String.fromCharCode(192+(a>>6))),t.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,s=e.charCodeAt(r++)-56320+(a<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(a>>12))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)))}return t.join("")},v0=function(){var e={};return function(r,a){var s=r+"|"+(a||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",a||"")}}(),xT=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var a=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)a=a.replace(e[s][0],e[s][1]);return a}}(),cee=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),dee=/<\/?(?:vt:)?variant>/g,uee=/<(?:vt:)([^>]*)>([\s\S]*)</;function $C(e,t){var r=or(e),a=e.match(cee(r.baseType))||[],s=[];if(a.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+a.length+" != "+r.size);return s}return a.forEach(function(i){var o=i.replace(dee,"").match(uee);o&&s.push({v:Jr(o[2]),t:o[1]})}),s}var yT=/(^\s|\s$|\n)/;function Va(e,t){return"<"+e+(t.match(yT)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function b0(e){return Mn(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function St(e,t,r){return"<"+e+(r!=null?b0(r):"")+(t!=null?(t.match(yT)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function K_(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function Aee(e,t){switch(typeof e){case"string":var r=St("vt:lpwstr",Gr(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return St((e|0)==e?"vt:i4":"vt:r8",Gr(String(e)));case"boolean":return St("vt:bool",e?"true":"false")}if(e instanceof Date)return St("vt:filetime",K_(e));throw new Error("Unable to serialize "+e)}function j2(e){if(yr&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Jr(Zc(g2(e)));throw new Error("Bad input format: expected Buffer or string")}var _0=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,wa={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},lu=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],li={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function hee(e,t){for(var r=1-2*(e[t+7]>>>7),a=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,i=5;i>=0;--i)s=s*256+e[t+i];return a==2047?s==0?r*(1/0):NaN:(a==0?a=-1022:(a-=1023,s+=Math.pow(2,52)),r*Math.pow(2,a-52)*s)}function fee(e,t,r){var a=(t<0||1/t==-1/0?1:0)<<7,s=0,i=0,o=a?-t:t;isFinite(o)?o==0?s=i=0:(s=Math.floor(Math.log(o)/Math.LN2),i=o*Math.pow(2,52-s),s<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?s=-1022:(i-=Math.pow(2,52),s+=1023)):(s=2047,i=isNaN(t)?26985:0);for(var l=0;l<=5;++l,i/=256)e[r+l]=i&255;e[r+6]=(s&15)<<4|i&15,e[r+7]=s>>4|a}var KC=function(e){for(var t=[],r=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var s=0,i=e[0][a].length;s<i;s+=r)t.push.apply(t,e[0][a].slice(s,s+r));return t},VC=yr?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Vl(t)})):KC(e)}:KC,WC=function(e,t,r){for(var a=[],s=t;s<r;s+=2)a.push(String.fromCharCode(Sl(e,s)));return a.join("").replace(Es,"")},k2=yr?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Es,""):WC(e,t,r)}:WC,zC=function(e,t,r){for(var a=[],s=t;s<t+r;++s)a.push(("0"+e[s].toString(16)).slice(-2));return a.join("")},vT=yr?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):zC(e,t,r)}:zC,GC=function(e,t,r){for(var a=[],s=t;s<r;s++)a.push(String.fromCharCode(Xu(e,s)));return a.join("")},q0=yr?function(t,r,a){return Buffer.isBuffer(t)?t.toString("utf8",r,a):GC(t,r,a)}:GC,bT=function(e,t){var r=ci(e,t);return r>0?q0(e,t+4,t+4+r-1):""},_T=bT,wT=function(e,t){var r=ci(e,t);return r>0?q0(e,t+4,t+4+r-1):""},NT=wT,jT=function(e,t){var r=2*ci(e,t);return r>0?q0(e,t+4,t+4+r-1):""},kT=jT,CT=function(t,r){var a=ci(t,r);return a>0?k2(t,r+4,r+4+a):""},ST=CT,BT=function(e,t){var r=ci(e,t);return r>0?q0(e,t+4,t+4+r):""},ET=BT,FT=function(e,t){return hee(e,t)},ux=FT,C2=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};yr&&(_T=function(t,r){if(!Buffer.isBuffer(t))return bT(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},NT=function(t,r){if(!Buffer.isBuffer(t))return wT(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},kT=function(t,r){if(!Buffer.isBuffer(t))return jT(t,r);var a=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a-1)},ST=function(t,r){if(!Buffer.isBuffer(t))return CT(t,r);var a=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a)},ET=function(t,r){if(!Buffer.isBuffer(t))return BT(t,r);var a=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+a)},ux=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):FT(t,r)},C2=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Xu=function(e,t){return e[t]},Sl=function(e,t){return e[t+1]*256+e[t]},pee=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},ci=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Sd=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},mee=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Df(e,t){var r="",a,s,i=[],o,l,c,d;switch(t){case"dbcs":if(d=this.l,yr&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(Sl(this,d)),d+=2;e*=2;break;case"utf8":r=q0(this,this.l,this.l+e);break;case"utf16le":e*=2,r=k2(this,this.l,this.l+e);break;case"wstr":return Df.call(this,e,"dbcs");case"lpstr-ansi":r=_T(this,this.l),e=4+ci(this,this.l);break;case"lpstr-cp":r=NT(this,this.l),e=4+ci(this,this.l);break;case"lpwstr":r=kT(this,this.l),e=4+2*ci(this,this.l);break;case"lpp4":e=4+ci(this,this.l),r=ST(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+ci(this,this.l),r=ET(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=Xu(this,this.l+e++))!==0;)i.push(Em(o));r=i.join("");break;case"_wstr":for(e=0,r="";(o=Sl(this,this.l+e))!==0;)i.push(Em(o)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",d=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return o=Xu(this,d),this.l=d+1,l=Df.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(Em(Sl(this,d))),d+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return o=Xu(this,d),this.l=d+1,l=Df.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(Em(Xu(this,d))),d+=1}r=i.join("");break;default:switch(e){case 1:return a=Xu(this,this.l),this.l++,a;case 2:return a=(t==="i"?pee:Sl)(this,this.l),this.l+=2,a;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(a=(e>0?Sd:mee)(this,this.l),this.l+=4,a):(s=ci(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=ux(this,this.l):s=ux([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=vT(this,this.l,e);break}}return this.l+=e,r}var gee=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},xee=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},yee=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function vee(e,t,r){var a=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)yee(this,t.charCodeAt(s),this.l+2*s);a=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;a=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var o=t.charCodeAt(s);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=t&255;break;case 2:a=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:a=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:a=4,gee(this,t,this.l);break;case 8:if(a=8,r==="f"){fee(this,t,this.l);break}case 16:break;case-4:a=4,xee(this,t,this.l);break}return this.l+=a,this}function TT(e,t){var r=vT(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Ka(e,t){e.l=t,e.read_shift=Df,e.chk=TT,e.write_shift=vee}function ps(e,t){e.l+=t}function ct(e){var t=Vc(e);return Ka(t,0),t}function Wl(e,t,r){if(e){var a,s,i;Ka(e,e.l||0);for(var o=e.length,l=0,c=0;e.l<o;){l=e.read_shift(1),l&128&&(l=(l&127)+((e.read_shift(1)&127)<<7));var d=S0[l]||S0[65535];for(a=e.read_shift(1),i=a&127,s=1;s<4&&a&128;++s)i+=((a=e.read_shift(1))&127)<<7*s;c=e.l+i;var u=d.f&&d.f(e,i,r);if(e.l=c,t(u,d,l))return}}}function Vs(){var e=[],t=yr?256:2048,r=function(d){var u=ct(d);return Ka(u,0),u},a=r(t),s=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a),a=null)},i=function(d){return a&&d<a.length-a.l?a:(s(),a=r(Math.max(d+1,t)))},o=function(){return s(),Ta(e)},l=function(d){s(),a=d,a.l==null&&(a.l=a.length),i(t)};return{next:i,push:l,end:o,_bufs:e}}function xt(e,t,r,a){var s=+t,i;if(!isNaN(s)){a||(a=S0[s].p||(r||[]).length||0),i=1+(s>=128?1:0)+1,a>=128&&++i,a>=16384&&++i,a>=2097152&&++i;var o=e.next(i);s<=127?o.write_shift(1,s):(o.write_shift(1,(s&127)+128),o.write_shift(1,s>>7));for(var l=0;l!=4;++l)if(a>=128)o.write_shift(1,(a&127)+128),a>>=7;else{o.write_shift(1,a);break}a>0&&C2(r)&&e.push(r)}}function Lf(e,t,r){var a=yn(e);if(t.s?(a.cRel&&(a.c+=t.s.c),a.rRel&&(a.r+=t.s.r)):(a.cRel&&(a.c+=t.c),a.rRel&&(a.r+=t.r)),!r||r.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function XC(e,t,r){var a=yn(e);return a.s=Lf(a.s,t.s,r),a.e=Lf(a.e,t.s,r),a}function Pf(e,t){if(e.cRel&&e.c<0)for(e=yn(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=yn(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=sr(e);return!e.cRel&&e.cRel!=null&&(r=wee(r)),!e.rRel&&e.rRel!=null&&(r=bee(r)),r}function B1(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+kn(e.s.c)+":"+(e.e.cRel?"":"$")+kn(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Jn(e.s.r)+":"+(e.e.rRel?"":"$")+Jn(e.e.r):Pf(e.s,t.biff)+":"+Pf(e.e,t.biff)}function S2(e){return parseInt(_ee(e),10)-1}function Jn(e){return""+(e+1)}function bee(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function _ee(e){return e.replace(/\$(\d+)$/,"$1")}function B2(e){for(var t=Nee(e),r=0,a=0;a!==t.length;++a)r=26*r+t.charCodeAt(a)-64;return r-1}function kn(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function wee(e){return e.replace(/^([A-Z])/,"$$$1")}function Nee(e){return e.replace(/^\$([A-Z])/,"$1")}function jee(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Cn(e){for(var t=0,r=0,a=0;a<e.length;++a){var s=e.charCodeAt(a);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function sr(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Ws(e){var t=e.indexOf(":");return t==-1?{s:Cn(e),e:Cn(e)}:{s:Cn(e.slice(0,t)),e:Cn(e.slice(t+1))}}function fr(e,t){return typeof t>"u"||typeof t=="number"?fr(e.s,e.e):(typeof e!="string"&&(e=sr(e)),typeof t!="string"&&(t=sr(t)),e==t?e:e+":"+t)}function Or(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,s=0,i=e.length;for(r=0;a<i&&!((s=e.charCodeAt(a)-64)<1||s>26);++a)r=26*r+s;for(t.s.c=--r,r=0;a<i&&!((s=e.charCodeAt(a)-48)<0||s>9);++a)r=10*r+s;if(t.s.r=--r,a===i||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++a,r=0;a!=i&&!((s=e.charCodeAt(a)-64)<1||s>26);++a)r=26*r+s;for(t.e.c=--r,r=0;a!=i&&!((s=e.charCodeAt(a)-48)<0||s>9);++a)r=10*r+s;return t.e.r=--r,t}function YC(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Wi(e.z,r?ka(t):t)}catch{}try{return e.w=Wi((e.XF||{}).numFmtId||(r?14:0),r?ka(t):t)}catch{return""+t}}function Ql(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?zl[e.v]||e.v:t==null?YC(e,e.v):YC(e,t))}function ed(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",a={};return a[r]=e,{SheetNames:[r],Sheets:a}}function IT(e,t,r){var a=r||{},s=e?Array.isArray(e):a.dense,i=e||(s?[]:{}),o=0,l=0;if(i&&a.origin!=null){if(typeof a.origin=="number")o=a.origin;else{var c=typeof a.origin=="string"?Cn(a.origin):a.origin;o=c.r,l=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var u=Or(i["!ref"]);d.s.c=u.s.c,d.s.r=u.s.r,d.e.c=Math.max(d.e.c,u.e.c),d.e.r=Math.max(d.e.r,u.e.r),o==-1&&(d.e.r=o=u.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[f].length;++h)if(!(typeof t[f][h]>"u")){var A={v:t[f][h]},x=o+f,p=l+h;if(d.s.r>x&&(d.s.r=x),d.s.c>p&&(d.s.c=p),d.e.r<x&&(d.e.r=x),d.e.c<p&&(d.e.c=p),t[f][h]&&typeof t[f][h]=="object"&&!Array.isArray(t[f][h])&&!(t[f][h]instanceof Date))A=t[f][h];else if(Array.isArray(A.v)&&(A.f=t[f][h][1],A.v=A.v[0]),A.v===null)if(A.f)A.t="n";else if(a.nullError)A.t="e",A.v=0;else if(a.sheetStubs)A.t="z";else continue;else typeof A.v=="number"?A.t="n":typeof A.v=="boolean"?A.t="b":A.v instanceof Date?(A.z=a.dateNF||nr[14],a.cellDates?(A.t="d",A.w=Wi(A.z,ka(A.v))):(A.t="n",A.v=ka(A.v),A.w=Wi(A.z,A.v))):A.t="s";if(s)i[x]||(i[x]=[]),i[x][p]&&i[x][p].z&&(A.z=i[x][p].z),i[x][p]=A;else{var b=sr({c:p,r:x});i[b]&&i[b].z&&(A.z=i[b].z),i[b]=A}}}return d.s.c<1e7&&(i["!ref"]=fr(d)),i}function rh(e,t){return IT(null,e,t)}function kee(e){return e.read_shift(4,"i")}function xo(e,t){return t||(t=ct(4)),t.write_shift(4,e),t}function hs(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Ia(e,t){var r=!1;return t==null&&(r=!0,t=ct(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function Cee(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function See(e,t){return t||(t=ct(4)),t.write_shift(2,0),t.write_shift(2,0),t}function E2(e,t){var r=e.l,a=e.read_shift(1),s=hs(e),i=[],o={t:s,h:s};if(a&1){for(var l=e.read_shift(4),c=0;c!=l;++c)i.push(Cee(e));o.r=i}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function Bee(e,t){var r=!1;return t==null&&(r=!0,t=ct(15+4*e.t.length)),t.write_shift(1,0),Ia(e.t,t),r?t.slice(0,t.l):t}var Eee=E2;function Fee(e,t){var r=!1;return t==null&&(r=!0,t=ct(23+4*e.t.length)),t.write_shift(1,1),Ia(e.t,t),t.write_shift(4,1),See({},t),r?t.slice(0,t.l):t}function zi(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function cu(e,t){return t==null&&(t=ct(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function du(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function uu(e,t){return t==null&&(t=ct(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var Tee=hs,DT=Ia;function F2(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Ax(e,t){var r=!1;return t==null&&(r=!0,t=ct(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var Iee=hs,V_=F2,T2=Ax;function I2(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,a=t[0]&2;e.l+=4;var s=a===0?ux([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Sd(t,0)>>2;return r?s/100:s}function LT(e,t){t==null&&(t=ct(4));var r=0,a=0,s=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?a=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(a=1,r=1),a)t.write_shift(-4,((r?s:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function PT(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function Dee(e,t){return t||(t=ct(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Au=PT,nh=Dee;function As(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function eu(e,t){return(t||ct(8)).write_shift(8,e,"f")}function Lee(e){var t={},r=e.read_shift(1),a=r>>>1,s=e.read_shift(1),i=e.read_shift(2,"i"),o=e.read_shift(1),l=e.read_shift(1),c=e.read_shift(1);switch(e.l++,a){case 0:t.auto=1;break;case 1:t.index=s;var d=Md[s];d&&(t.rgb=N0(d));break;case 2:t.rgb=N0([o,l,c]);break;case 3:t.theme=s;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function hx(e,t){if(t||(t=ct(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var a=e.rgb||"FFFFFF";typeof a=="number"&&(a=("000000"+a.toString(16)).slice(-6)),t.write_shift(1,parseInt(a.slice(0,2),16)),t.write_shift(1,parseInt(a.slice(2,4),16)),t.write_shift(1,parseInt(a.slice(4,6),16)),t.write_shift(1,255)}return t}function Pee(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function Oee(e,t){t||(t=ct(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function OT(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=e.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function Uee(e){return OT(e,1)}function Ree(e){return OT(e,2)}var D2=2,Us=3,Tm=11,JC=12,fx=19,Im=64,Mee=65,Qee=71,Hee=4108,qee=4126,Ba=80,UT=81,$ee=[Ba,UT],W_={1:{n:"CodePage",t:D2},2:{n:"Category",t:Ba},3:{n:"PresentationFormat",t:Ba},4:{n:"ByteCount",t:Us},5:{n:"LineCount",t:Us},6:{n:"ParagraphCount",t:Us},7:{n:"SlideCount",t:Us},8:{n:"NoteCount",t:Us},9:{n:"HiddenCount",t:Us},10:{n:"MultimediaClipCount",t:Us},11:{n:"ScaleCrop",t:Tm},12:{n:"HeadingPairs",t:Hee},13:{n:"TitlesOfParts",t:qee},14:{n:"Manager",t:Ba},15:{n:"Company",t:Ba},16:{n:"LinksUpToDate",t:Tm},17:{n:"CharacterCount",t:Us},19:{n:"SharedDoc",t:Tm},22:{n:"HyperlinksChanged",t:Tm},23:{n:"AppVersion",t:Us,p:"version"},24:{n:"DigSig",t:Mee},26:{n:"ContentType",t:Ba},27:{n:"ContentStatus",t:Ba},28:{n:"Language",t:Ba},29:{n:"Version",t:Ba},255:{},2147483648:{n:"Locale",t:fx},2147483651:{n:"Behavior",t:fx},1919054434:{}},z_={1:{n:"CodePage",t:D2},2:{n:"Title",t:Ba},3:{n:"Subject",t:Ba},4:{n:"Author",t:Ba},5:{n:"Keywords",t:Ba},6:{n:"Comments",t:Ba},7:{n:"Template",t:Ba},8:{n:"LastAuthor",t:Ba},9:{n:"RevNumber",t:Ba},10:{n:"EditTime",t:Im},11:{n:"LastPrinted",t:Im},12:{n:"CreatedDate",t:Im},13:{n:"ModifiedDate",t:Im},14:{n:"PageCount",t:Us},15:{n:"WordCount",t:Us},16:{n:"CharCount",t:Us},17:{n:"Thumbnail",t:Qee},18:{n:"Application",t:Ba},19:{n:"DocSecurity",t:Us},255:{},2147483648:{n:"Locale",t:fx},2147483651:{n:"Behavior",t:fx},1919054434:{}},ZC={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Kee=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Vee(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var Wee=Vee([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Md=yn(Wee),zl={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},RT={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},G_={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Dm={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function L2(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function zee(e){var t=L2();if(!e||!e.match)return t;var r={};if((e.match(ms)||[]).forEach(function(a){var s=or(a);switch(s[0].replace(aee,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":t[G_[s.ContentType]]!==void 0&&t[G_[s.ContentType]].push(s.PartName);break}}),t.xmlns!==wa.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function MT(e,t){var r=zZ(G_),a=[],s;a[a.length]=ea,a[a.length]=St("Types",null,{xmlns:wa.CT,"xmlns:xsd":wa.xsd,"xmlns:xsi":wa.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return St("Default",null,{Extension:c[0],ContentType:c[1]})}));var i=function(c){e[c]&&e[c].length>0&&(s=e[c][0],a[a.length]=St("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:Dm[c][t.bookType]||Dm[c].xlsx}))},o=function(c){(e[c]||[]).forEach(function(d){a[a.length]=St("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:Dm[c][t.bookType]||Dm[c].xlsx})})},l=function(c){(e[c]||[]).forEach(function(d){a[a.length]=St("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:r[c][0]})})};return i("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var _r={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function w0(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Of(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var a={};return(e.match(ms)||[]).forEach(function(s){var i=or(s);if(i[0]==="<Relationship"){var o={};o.Type=i.Type,o.Target=i.Target,o.Id=i.Id,i.TargetMode&&(o.TargetMode=i.TargetMode);var l=i.TargetMode==="External"?i.Target:pf(i.Target,t);r[l]=o,a[i.Id]=o}}),r["!id"]=a,r}function CA(e){var t=[ea,St("Relationships",null,{xmlns:wa.RELS})];return Mn(e["!id"]).forEach(function(r){t[t.length]=St("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Wr(e,t,r,a,s,i){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=a,s.Target=r,[_r.HLINK,_r.XPATH,_r.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}var Gee="application/vnd.oasis.opendocument.spreadsheet";function Xee(e,t){for(var r=j2(e),a,s;a=_0.exec(r);)switch(a[3]){case"manifest":break;case"file-entry":if(s=or(a[0],!1),s.path=="/"&&s.type!==Gee)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw a}}function Yee(e){var t=[ea];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function eS(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function Jee(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function Zee(e){var t=[ea];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(eS(e[r][0],e[r][1])),t.push(Jee("",e[r][0]));return t.push(eS("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function QT(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+ix.version+"</meta:generator></office:meta></office:document-meta>"}var Qi=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],ete=function(){for(var e=new Array(Qi.length),t=0;t<Qi.length;++t){var r=Qi[t],a="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return e}();function HT(e){var t={};e=Jr(e);for(var r=0;r<Qi.length;++r){var a=Qi[r],s=e.match(ete[r]);s!=null&&s.length>0&&(t[a[1]]=Dr(s[1])),a[2]==="date"&&t[a[1]]&&(t[a[1]]=xn(t[a[1]]))}return t}function E1(e,t,r,a,s){s[e]!=null||t==null||t===""||(s[e]=t,t=Gr(t),a[a.length]=r?St(e,t,r):Va(e,t))}function qT(e,t){var r=t||{},a=[ea,St("cp:coreProperties",null,{"xmlns:cp":wa.CORE_PROPS,"xmlns:dc":wa.dc,"xmlns:dcterms":wa.dcterms,"xmlns:dcmitype":wa.dcmitype,"xmlns:xsi":wa.xsi})],s={};if(!e&&!r.Props)return a.join("");e&&(e.CreatedDate!=null&&E1("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:K_(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,s),e.ModifiedDate!=null&&E1("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:K_(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,s));for(var i=0;i!=Qi.length;++i){var o=Qi[i],l=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&E1(o[0],l,null,a,s)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var Qd=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],$T=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function KT(e,t,r,a){var s=[];if(typeof e=="string")s=$C(e,a);else for(var i=0;i<e.length;++i)s=s.concat(e[i].map(function(u){return{v:u}}));var o=typeof t=="string"?$C(t,a).map(function(u){return u.v}):t,l=0,c=0;if(o.length>0)for(var d=0;d!==s.length;d+=2){switch(c=+s[d+1].v,s[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=o.slice(l,l+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=o.slice(l,l+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=o.slice(l,l+c);break}l+=c}}function tte(e,t,r){var a={};return t||(t={}),e=Jr(e),Qd.forEach(function(s){var i=(e.match(v0(s[0]))||[])[1];switch(s[2]){case"string":i&&(t[s[1]]=Dr(i));break;case"bool":t[s[1]]=i==="true";break;case"raw":var o=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));o&&o.length>0&&(a[s[1]]=o[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&KT(a.HeadingPairs,a.TitlesOfParts,t,r),t}function VT(e){var t=[],r=St;return e||(e={}),e.Application="SheetJS",t[t.length]=ea,t[t.length]=St("Properties",null,{xmlns:wa.EXT_PROPS,"xmlns:vt":wa.vt}),Qd.forEach(function(a){if(e[a[1]]!==void 0){var s;switch(a[2]){case"string":s=Gr(String(e[a[1]]));break;case"bool":s=e[a[1]]?"true":"false";break}s!==void 0&&(t[t.length]=r(a[0],s))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(a){return"<vt:lpstr>"+Gr(a)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var rte=/<[^>]+>[^<]*/g;function nte(e,t){var r={},a="",s=e.match(rte);if(s)for(var i=0;i!=s.length;++i){var o=s[i],l=or(o);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":a=Dr(l.name);break;case"</property>":a=null;break;default:if(o.indexOf("<vt:")===0){var c=o.split(">"),d=c[0].slice(4),u=c[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[a]=Dr(u);break;case"bool":r[a]=fn(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[a]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[a]=parseFloat(u);break;case"filetime":case"date":r[a]=xn(u);break;case"cy":case"error":r[a]=Dr(u);break;default:if(d.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,d,c)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}function WT(e){var t=[ea,St("Properties",null,{xmlns:wa.CUST_PROPS,"xmlns:vt":wa.vt})];if(!e)return t.join("");var r=1;return Mn(e).forEach(function(s){++r,t[t.length]=St("property",Aee(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Gr(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var X_={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},F1;function ate(e,t,r){F1||(F1=ly(X_)),t=F1[t]||t,e[t]=r}function ste(e,t){var r=[];return Mn(X_).map(function(a){for(var s=0;s<Qi.length;++s)if(Qi[s][1]==a)return Qi[s];for(s=0;s<Qd.length;++s)if(Qd[s][1]==a)return Qd[s];throw a}).forEach(function(a){if(e[a[1]]!=null){var s=t&&t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:e[a[1]];switch(a[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(Va(X_[a[1]]||a[1],s))}}),St("DocumentProperties",r.join(""),{xmlns:li.o})}function ite(e,t){var r=["Worksheets","SheetNames"],a="CustomDocumentProperties",s=[];return e&&Mn(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var o=0;o<Qi.length;++o)if(i==Qi[o][1])return;for(o=0;o<Qd.length;++o)if(i==Qd[o][1])return;for(o=0;o<r.length;++o)if(i==r[o])return;var l=e[i],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),s.push(St(MC(i),l,{"dt:dt":c}))}}),t&&Mn(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var o=t[i],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),s.push(St(MC(i),o,{"dt:dt":l}))}}),"<"+a+' xmlns="'+li.o+'">'+s.join("")+"</"+a+">"}function P2(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function ote(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,a=r%Math.pow(2,32),s=(r-a)/Math.pow(2,32);a*=1e7,s*=1e7;var i=a/Math.pow(2,32)|0;i>0&&(a=a%Math.pow(2,32),s+=i);var o=ct(8);return o.write_shift(4,a),o.write_shift(4,s),o}function zT(e,t,r){var a=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-a&3;)++e.l;return s}function GT(e,t,r){var a=e.read_shift(0,"lpwstr");return a}function XT(e,t,r){return t===31?GT(e):zT(e,t,r)}function Y_(e,t,r){return XT(e,t,r===!1?0:4)}function lte(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return XT(e,t,0)}function cte(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a){var s=e.l;r[a]=e.read_shift(0,"lpwstr").replace(Es,""),e.l-s&2&&(e.l+=2)}return r}function dte(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a)r[a]=e.read_shift(0,"lpstr-cp").replace(Es,"");return r}function ute(e){var t=e.l,r=px(e,UT);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var a=px(e,Us);return[r,a]}function Ate(e){for(var t=e.read_shift(4),r=[],a=0;a<t/2;++a)r.push(ute(e));return r}function tS(e,t){for(var r=e.read_shift(4),a={},s=0;s!=r;++s){var i=e.read_shift(4),o=e.read_shift(4);a[i]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(Es,"").replace(ff,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),a}function YT(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function hte(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function px(e,t,r){var a=e.read_shift(2),s,i=r||{};if(e.l+=2,t!==JC&&a!==t&&$ee.indexOf(t)===-1&&!((t&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+t+" saw "+a);switch(t===JC?a:t){case 2:return s=e.read_shift(2,"i"),i.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return zT(e,a,4).replace(Es,"");case 31:return GT(e);case 64:return P2(e);case 65:return YT(e);case 71:return hte(e);case 80:return Y_(e,a,!i.raw).replace(Es,"");case 81:return lte(e,a).replace(Es,"");case 4108:return Ate(e);case 4126:case 4127:return a==4127?cte(e):dte(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+a)}}function rS(e,t){var r=ct(4),a=ct(4);switch(r.write_shift(4,e==80?31:e),e){case 3:a.write_shift(-4,t);break;case 5:a=ct(8),a.write_shift(8,t,"f");break;case 11:a.write_shift(4,t?1:0);break;case 64:a=ote(t);break;case 31:case 80:for(a=ct(4+2*(t.length+1)+(t.length%2?0:2)),a.write_shift(4,t.length+1),a.write_shift(0,t,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Ta([r,a])}function nS(e,t){var r=e.l,a=e.read_shift(4),s=e.read_shift(4),i=[],o=0,l=0,c=-1,d={};for(o=0;o!=s;++o){var u=e.read_shift(4),f=e.read_shift(4);i[o]=[u,f+r]}i.sort(function(g,y){return g[1]-y[1]});var h={};for(o=0;o!=s;++o){if(e.l!==i[o][1]){var A=!0;if(o>0&&t)switch(t[i[o-1][0]].t){case 2:e.l+2===i[o][1]&&(e.l+=2,A=!1);break;case 80:e.l<=i[o][1]&&(e.l=i[o][1],A=!1);break;case 4108:e.l<=i[o][1]&&(e.l=i[o][1],A=!1);break}if((!t||o==0)&&e.l<=i[o][1]&&(A=!1,e.l=i[o][1]),A)throw new Error("Read Error: Expected address "+i[o][1]+" at "+e.l+" :"+o)}if(t){var x=t[i[o][0]];if(h[x.n]=px(e,x.t,{raw:!0}),x.p==="version"&&(h[x.n]=String(h[x.n]>>16)+"."+("0000"+String(h[x.n]&65535)).slice(-4)),x.n=="CodePage")switch(h[x.n]){case 0:h[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ho(l=h[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[x.n])}}else if(i[o][0]===1){if(l=h.CodePage=px(e,D2),ho(l),c!==-1){var p=e.l;e.l=i[c][1],d=tS(e,l),e.l=p}}else if(i[o][0]===0){if(l===0){c=o,e.l=i[o+1][1];continue}d=tS(e,l)}else{var b=d[i[o][0]],m;switch(e[e.l]){case 65:e.l+=4,m=YT(e);break;case 30:e.l+=4,m=Y_(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,m=Y_(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,m=e.read_shift(4,"i");break;case 19:e.l+=4,m=e.read_shift(4);break;case 5:e.l+=4,m=e.read_shift(8,"f");break;case 11:e.l+=4,m=Vn(e,4);break;case 64:e.l+=4,m=xn(P2(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[b]=m}}return e.l=r+a,h}var JT=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function fte(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function aS(e,t,r){var a=ct(8),s=[],i=[],o=8,l=0,c=ct(8),d=ct(8);if(c.write_shift(4,2),c.write_shift(4,1200),d.write_shift(4,1),i.push(c),s.push(d),o+=8+c.length,!t){d=ct(8),d.write_shift(4,0),s.unshift(d);var u=[ct(4)];for(u[0].write_shift(4,e.length),l=0;l<e.length;++l){var f=e[l][0];for(c=ct(8+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);u.push(c)}c=Ta(u),i.unshift(c),o+=8+c.length}for(l=0;l<e.length;++l)if(!(t&&!t[e[l][0]])&&!(JT.indexOf(e[l][0])>-1||$T.indexOf(e[l][0])>-1)&&e[l][1]!=null){var h=e[l][1],A=0;if(t){A=+t[e[l][0]];var x=r[A];if(x.p=="version"&&typeof h=="string"){var p=h.split(".");h=(+p[0]<<16)+(+p[1]||0)}c=rS(x.t,h)}else{var b=fte(h);b==-1&&(b=31,h=String(h)),c=rS(b,h)}i.push(c),d=ct(8),d.write_shift(4,t?A:2+l),s.push(d),o+=8+c.length}var m=8*(i.length+1);for(l=0;l<i.length;++l)s[l].write_shift(4,m),m+=i[l].length;return a.write_shift(4,o),a.write_shift(4,i.length),Ta([a].concat(s).concat(i))}function sS(e,t,r){var a=e.content;if(!a)return{};Ka(a,0);var s,i,o,l,c=0;a.chk("feff","Byte Order: "),a.read_shift(2);var d=a.read_shift(4),u=a.read_shift(16);if(u!==er.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(s=a.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(i=a.read_shift(16),l=a.read_shift(4),s===1&&l!==a.l)throw new Error("Length mismatch: "+l+" !== "+a.l);s===2&&(o=a.read_shift(16),c=a.read_shift(4));var f=nS(a,t),h={SystemIdentifier:d};for(var A in f)h[A]=f[A];if(h.FMTID=i,s===1)return h;if(c-a.l==2&&(a.l+=2),a.l!==c)throw new Error("Length mismatch 2: "+a.l+" !== "+c);var x;try{x=nS(a,null)}catch{}for(A in x)h[A]=x[A];return h.FMTID=[i,o],h}function iS(e,t,r,a,s,i){var o=ct(s?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,er.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,s?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,s?68:48);var c=aS(e,r,a);if(l.push(c),s){var d=aS(s,null,null);o.write_shift(16,i,"hex"),o.write_shift(4,68+c.length),l.push(d)}return Ta(l)}function hc(e,t){return e.read_shift(t),null}function pte(e,t){t||(t=ct(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function mte(e,t,r){for(var a=[],s=e.l+t;e.l<s;)a.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return a}function Vn(e,t){return e.read_shift(t)===1}function ks(e,t){return t||(t=ct(2)),t.write_shift(2,+!!e),t}function ia(e){return e.read_shift(2,"u")}function Ii(e,t){return t||(t=ct(2)),t.write_shift(2,e),t}function ZT(e,t){return mte(e,t,ia)}function gte(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function eI(e,t,r){return r||(r=ct(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function $0(e,t,r){var a=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var o=a?e.read_shift(a,s):"";return o}function xte(e){var t=e.read_shift(2),r=e.read_shift(1),a=r&4,s=r&8,i=1+(r&1),o=0,l,c={};s&&(o=e.read_shift(2)),a&&(l=e.read_shift(4));var d=i==2?"dbcs-cont":"sbcs-cont",u=t===0?"":e.read_shift(t,d);return s&&(e.l+=4*o),a&&(e.l+=l),c.t=u,s||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function yte(e){var t=e.t||"",r=ct(3);r.write_shift(2,t.length),r.write_shift(1,1);var a=ct(2*t.length);a.write_shift(2*t.length,t,"utf16le");var s=[r,a];return Ta(s)}function tu(e,t,r){var a;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?a=e.read_shift(t,"sbcs-cont"):a=e.read_shift(t,"dbcs-cont"),a}function K0(e,t,r){var a=e.read_shift(r&&r.biff==2?1:2);return a===0?(e.l++,""):tu(e,a,r)}function hu(e,t,r){if(r.biff>5)return K0(e,t,r);var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function tI(e,t,r){return r||(r=ct(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function vte(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function bte(e){var t=e.read_shift(4),r=e.l,a=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),e.l=r);var s=e.read_shift((a?t-24:t)>>1,"utf16le").replace(Es,"");return a&&(e.l+=24),s}function _te(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var a=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return r+a.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(i>>1,"utf16le").replace(Es,"");return r+o}function wte(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return bte(e);case"0303000000000000c000000000000046":return _te(e);default:throw new Error("Unsupported Moniker "+r)}}function Lm(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Es,""):"";return r}function oS(e,t){t||(t=ct(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function Nte(e,t){var r=e.l+t,a=e.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var s=e.read_shift(2);e.l+=2;var i,o,l,c,d="",u,f;s&16&&(i=Lm(e,r-e.l)),s&128&&(o=Lm(e,r-e.l)),(s&257)===257&&(l=Lm(e,r-e.l)),(s&257)===1&&(c=wte(e,r-e.l)),s&8&&(d=Lm(e,r-e.l)),s&32&&(u=e.read_shift(16)),s&64&&(f=P2(e)),e.l=r;var h=o||l||c||"";h&&d&&(h+="#"+d),h||(h="#"+d),s&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var A={Target:h};return u&&(A.guid=u),f&&(A.time=f),i&&(A.Tooltip=i),A}function jte(e){var t=ct(512),r=0,a=e.Target;a.slice(0,7)=="file://"&&(a=a.slice(7));var s=a.indexOf("#"),i=s>-1?31:23;switch(a.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(i==28)a=a.slice(1),oS(a,t);else if(i&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var l=s>-1?a.slice(0,s):a;for(t.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)t.write_shift(2,l.charCodeAt(r));t.write_shift(2,0),i&8&&oS(s>-1?a.slice(s+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var c=0;a.slice(c*3,c*3+3)=="../"||a.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,a.length-3*c+1),r=0;r<a.length-3*c;++r)t.write_shift(1,a.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function rI(e){var t=e.read_shift(1),r=e.read_shift(1),a=e.read_shift(1),s=e.read_shift(1);return[t,r,a,s]}function nI(e,t){var r=rI(e);return r[3]=0,r}function tl(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return{r:t,c:r,ixfe:a}}function ru(e,t,r,a){return a||(a=ct(6)),a.write_shift(2,e),a.write_shift(2,t),a.write_shift(2,r||0),a}function kte(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function Cte(e,t,r){return t===0?"":hu(e,t,r)}function Ste(e,t,r){var a=r.biff>8?4:2,s=e.read_shift(a),i=e.read_shift(a,"i"),o=e.read_shift(a,"i");return[s,i,o]}function aI(e){var t=e.read_shift(2),r=I2(e);return[t,r]}function Bte(e,t,r){e.l+=4,t-=4;var a=e.l+t,s=$0(e,t,r),i=e.read_shift(2);if(a-=e.l,i!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+i);return e.l+=i,s}function uy(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);return{s:{c:a,r:t},e:{c:s,r}}}function sI(e,t){return t||(t=ct(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function iI(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(1),s=e.read_shift(1);return{s:{c:a,r:t},e:{c:s,r}}}var Ete=iI;function oI(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return e.l+=12,[r,t,a]}function Fte(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function Tte(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function as(e){e.l+=2,e.l+=e.read_shift(2)}var Ite={0:as,4:as,5:as,6:as,7:Tte,8:as,9:as,10:as,11:as,12:as,13:Fte,14:as,15:as,16:as,17:as,18:as,19:as,20:as,21:oI};function Dte(e,t){for(var r=e.l+t,a=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{a.push(Ite[s](e,r-e.l))}catch{return e.l=r,a}}return e.l!=r&&(e.l=r),a}function Pm(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function O2(e,t,r){var a=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":a=1280,s=8;break;case"biff4":a=4,s=6;break;case"biff3":a=3,s=6;break;case"biff2":a=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=ct(s);return i.write_shift(2,a),i.write_shift(2,t),s>4&&i.write_shift(2,29282),s>6&&i.write_shift(2,1997),s>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function Lte(e,t){return t===0||e.read_shift(2),1200}function Pte(e,t,r){if(r.enc)return e.l+=t,"";var a=e.l,s=hu(e,0,r);return e.read_shift(t+a-e.l),s}function Ote(e,t){var r=!t||t.biff==8,a=ct(r?112:54);for(a.write_shift(t.biff==8?2:1,7),r&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(r?0:536870912));a.l<a.length;)a.write_shift(1,r?0:32);return a}function Ute(e,t,r){var a=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function Rte(e,t,r){var a=e.read_shift(4),s=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var o=$0(e,0,r);return o.length===0&&(o="Sheet1"),{pos:a,hs:s,dt:i,name:o}}function Mte(e,t){var r=!t||t.biff>=8?2:1,a=ct(8+r*e.name.length);a.write_shift(4,e.pos),a.write_shift(1,e.hs||0),a.write_shift(1,e.dt),a.write_shift(1,e.name.length),t.biff>=8&&a.write_shift(1,1),a.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=a.slice(0,a.l);return s.l=a.l,s}function Qte(e,t){for(var r=e.l+t,a=e.read_shift(4),s=e.read_shift(4),i=[],o=0;o!=s&&e.l<r;++o)i.push(xte(e));return i.Count=a,i.Unique=s,i}function Hte(e,t){var r=ct(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var a=[],s=0;s<e.length;++s)a[s]=yte(e[s]);var i=Ta([r].concat(a));return i.parts=[r.length].concat(a.map(function(o){return o.length})),i}function qte(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function $te(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var a=e.read_shift(1);return e.l+=3,a&7&&(t.level=a&7),a&32&&(t.hidden=!0),a&64&&(t.hpt=r/20),t}function Kte(e){var t=kte(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function Vte(e){return e.read_shift(2),e.read_shift(4)}function lS(e,t,r){var a=0;r&&r.biff==2||(a=e.read_shift(2));var s=e.read_shift(2);r&&r.biff==2&&(a=1-(s>>15),s&=32767);var i={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[i,s]}function Wte(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),d=e.read_shift(2);return{Pos:[t,r],Dim:[a,s],Flags:i,CurTab:o,FirstTab:l,Selected:c,TabRatio:d}}function zte(){var e=ct(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function Gte(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var a=e.read_shift(2);return{RTL:a&64}}function Xte(e){var t=ct(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function Yte(){}function Jte(e,t,r){var a={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return a.name=$0(e,0,r),a}function Zte(e,t){var r=e.name||"Arial",a=t&&t.biff==5,s=a?15+r.length:16+2*r.length,i=ct(s);return i.write_shift(2,e.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),a||i.write_shift(1,1),i.write_shift((a?1:2)*r.length,r,a?"sbcs":"utf16le"),i}function ere(e){var t=tl(e);return t.isst=e.read_shift(4),t}function tre(e,t,r,a){var s=ct(10);return ru(e,t,a,s),s.write_shift(4,r),s}function rre(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=e.l+t,s=tl(e);r.biff==2&&e.l++;var i=K0(e,a-e.l,r);return s.val=i,s}function nre(e,t,r,a,s){var i=!s||s.biff==8,o=ct(8+ +i+(1+i)*r.length);return ru(e,t,a,o),o.write_shift(2,r.length),i&&o.write_shift(1,1),o.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),o}function are(e,t,r){var a=e.read_shift(2),s=hu(e,0,r);return[a,s]}function sre(e,t,r,a){var s=r&&r.biff==5;a||(a=ct(s?3+t.length:5+2*t.length)),a.write_shift(2,e),a.write_shift(s?1:2,t.length),s||a.write_shift(1,1),a.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var i=a.length>a.l?a.slice(0,a.l):a;return i.l==null&&(i.l=i.length),i}var ire=hu;function cS(e,t,r){var a=e.l+t,s=r.biff==8||!r.biff?4:2,i=e.read_shift(s),o=e.read_shift(s),l=e.read_shift(2),c=e.read_shift(2);return e.l=a,{s:{r:i,c:l},e:{r:o,c}}}function ore(e,t){var r=t.biff==8||!t.biff?4:2,a=ct(2*r+6);return a.write_shift(r,e.s.r),a.write_shift(r,e.e.r+1),a.write_shift(2,e.s.c),a.write_shift(2,e.e.c+1),a.write_shift(2,0),a}function lre(e){var t=e.read_shift(2),r=e.read_shift(2),a=aI(e);return{r:t,c:r,ixfe:a[0],rknum:a[1]}}function cre(e,t){for(var r=e.l+t-2,a=e.read_shift(2),s=e.read_shift(2),i=[];e.l<r;)i.push(aI(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(i.length!=o-s+1)throw new Error("MulRK length mismatch");return{r:a,c:s,C:o,rkrec:i}}function dre(e,t){for(var r=e.l+t-2,a=e.read_shift(2),s=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(i.length!=o-s+1)throw new Error("MulBlank length mismatch");return{r:a,c:s,C:o,ixfe:i}}function ure(e,t,r,a){var s={},i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(4),c=e.read_shift(2);return s.patternType=Kee[l>>26],a.cellStyles&&(s.alc=i&7,s.fWrap=i>>3&1,s.alcV=i>>4&7,s.fJustLast=i>>7&1,s.trot=i>>8&255,s.cIndent=i>>16&15,s.fShrinkToFit=i>>20&1,s.iReadOrder=i>>22&2,s.fAtrNum=i>>26&1,s.fAtrFnt=i>>27&1,s.fAtrAlc=i>>28&1,s.fAtrBdr=i>>29&1,s.fAtrPat=i>>30&1,s.fAtrProt=i>>31&1,s.dgLeft=o&15,s.dgRight=o>>4&15,s.dgTop=o>>8&15,s.dgBottom=o>>12&15,s.icvLeft=o>>16&127,s.icvRight=o>>23&127,s.grbitDiag=o>>30&3,s.icvTop=l&127,s.icvBottom=l>>7&127,s.icvDiag=l>>14&127,s.dgDiag=l>>21&15,s.icvFore=c&127,s.icvBack=c>>7&127,s.fsxButton=c>>14&1),s}function Are(e,t,r){var a={};return a.ifnt=e.read_shift(2),a.numFmtId=e.read_shift(2),a.flags=e.read_shift(2),a.fStyle=a.flags>>2&1,t-=6,a.data=ure(e,t,a.fStyle,r),a}function dS(e,t,r,a){var s=r&&r.biff==5;a||(a=ct(s?16:20)),a.write_shift(2,0),e.style?(a.write_shift(2,e.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,e.numFmtId||0),a.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&s&&(i|=1024),a.write_shift(4,i),a.write_shift(4,0),s||a.write_shift(4,0),a.write_shift(2,0),a}function hre(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function fre(e){var t=ct(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function uS(e,t,r){var a=tl(e);(r.biff==2||t==9)&&++e.l;var s=gte(e);return a.val=s,a.t=s===!0||s===!1?"b":"e",a}function pre(e,t,r,a,s,i){var o=ct(8);return ru(e,t,a,o),eI(r,i,o),o}function mre(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=tl(e),s=As(e);return a.val=s,a}function gre(e,t,r,a){var s=ct(14);return ru(e,t,a,s),eu(r,s),s}var AS=Cte;function xre(e,t,r){var a=e.l+t,s=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,s];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var o=tu(e,i),l=[];a>e.l;)l.push(K0(e));return[i,s,o,l]}function hS(e,t,r){var a=e.read_shift(2),s,i={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return r.sbcch===14849&&(s=Bte(e,t-2,r)),i.body=s||e.read_shift(t-2),typeof s=="string"&&(i.Name=s),i}var yre=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function fS(e,t,r){var a=e.l+t,s=e.read_shift(2),i=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var d=tu(e,o,r);s&32&&(d=yre[d.charCodeAt(0)]);var u=a-e.l;r&&r.biff==2&&--u;var f=a==e.l||l===0||!(u>0)?[]:Die(e,u,r,l);return{chKey:i,Name:d,itab:c,rgce:f}}function lI(e,t,r){if(r.biff<8)return vre(e,t,r);for(var a=[],s=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)a.push(Ste(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return a}function vre(e,t,r){e[e.l+1]==3&&e[e.l]++;var a=$0(e,t,r);return a.charCodeAt(0)==3?a.slice(1):a}function bre(e,t,r){if(r.biff<8){e.l+=t;return}var a=e.read_shift(2),s=e.read_shift(2),i=tu(e,a,r),o=tu(e,s,r);return[i,o]}function _re(e,t,r){var a=iI(e);e.l++;var s=e.read_shift(1);return t-=8,[Lie(e,t,r),s,a]}function pS(e,t,r){var a=Ete(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[a,Tie(e,t,r)]}function wre(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,a=e.read_shift(4);return[t,r,a]}function Nre(e,t,r){if(!(r.biff<8)){var a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=hu(e,0,r);return r.biff<8&&e.read_shift(1),[{r:a,c:s},l,o,i]}}function jre(e,t,r){return Nre(e,t,r)}function kre(e,t){for(var r=[],a=e.read_shift(2);a--;)r.push(uy(e));return r}function Cre(e){var t=ct(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)sI(e[r],t);return t}function Sre(e,t,r){if(r&&r.biff<8)return Ere(e,t,r);var a=oI(e),s=Dte(e,t-22,a[1]);return{cmo:a,ft:s}}var Bre={8:function(e,t){var r=e.l+t;e.l+=10;var a=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:a}}};function Ere(e,t,r){e.l+=4;var a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((Bre[a]||ps)(e,t,r)),{cmo:[s,a,i],ft:o}}function Fre(e,t,r){var a=e.l,s="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:o=vte(e,6,r);var l=e.read_shift(2);e.read_shift(2),ia(e,2);var c=e.read_shift(2);e.l+=c;for(var d=1;d<e.lens.length-1;++d){if(e.l-a!=e.lens[d])throw new Error("TxO: bad continue record");var u=e[e.l],f=tu(e,e.lens[d+1]-e.lens[d]-1);if(s+=f,s.length>=(u?l:2*l))break}if(s.length!==l&&s.length!==l*2)throw new Error("cchText: "+l+" != "+s.length);return e.l=a+t,{t:s}}catch{return e.l=a+t,{t:s}}}function Tre(e,t){var r=uy(e);e.l+=16;var a=Nte(e,t-24);return[r,a]}function Ire(e){var t=ct(24),r=Cn(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(a[s],16));return Ta([t,jte(e[1])])}function Dre(e,t){e.read_shift(2);var r=uy(e),a=e.read_shift((t-10)/2,"dbcs-cont");return a=a.replace(Es,""),[r,a]}function Lre(e){var t=e[1].Tooltip,r=ct(10+2*(t.length+1));r.write_shift(2,2048);var a=Cn(e[0]);r.write_shift(2,a.r),r.write_shift(2,a.r),r.write_shift(2,a.c),r.write_shift(2,a.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}function Pre(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=ZC[r]||r,r=e.read_shift(2),t[1]=ZC[r]||r,t}function Ore(e){return e||(e=ct(4)),e.write_shift(2,1),e.write_shift(2,1),e}function Ure(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(nI(e));return r}function Rre(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(nI(e));return r}function Mre(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function cI(e,t,r){if(!r.cellStyles)return ps(e,t);var a=r&&r.biff>=12?4:2,s=e.read_shift(a),i=e.read_shift(a),o=e.read_shift(a),l=e.read_shift(a),c=e.read_shift(2);a==2&&(e.l+=2);var d={s,e:i,w:o,ixfe:l,flags:c};return(r.biff>=5||!r.biff)&&(d.level=c>>8&7),d}function Qre(e,t){var r=ct(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var a=0;return e.hidden&&(a|=1),r.write_shift(1,a),a=e.level||0,r.write_shift(1,a),r.write_shift(2,0),r}function Hre(e,t){var r={};return t<32||(e.l+=16,r.header=As(e),r.footer=As(e),e.l+=2),r}function qre(e,t,r){var a={area:!1};if(r.biff!=5)return e.l+=t,a;var s=e.read_shift(1);return e.l+=3,s&16&&(a.area=!0),a}function $re(e){for(var t=ct(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var Kre=tl,Vre=ZT,Wre=K0;function zre(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),s={fmt:t,env:r,len:a,data:e.slice(e.l,e.l+a)};return e.l+=a,s}function Gre(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var a=tl(e);++e.l;var s=hu(e,t-7,r);return a.t="str",a.val=s,a}function Xre(e){var t=tl(e);++e.l;var r=As(e);return t.t="n",t.val=r,t}function Yre(e,t,r){var a=ct(15);return G0(a,e,t),a.write_shift(8,r,"f"),a}function Jre(e){var t=tl(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function Zre(e,t,r){var a=ct(9);return G0(a,e,t),a.write_shift(2,r),a}function ene(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function tne(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function rne(e,t,r){var a=e.l+t,s=tl(e),i=e.read_shift(2),o=tu(e,i,r);return e.l=a,s.t="str",s.val=o,s}var nne=[2,3,48,49,131,139,140,245],J_=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=ly({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,c){var d=[],u=Vc(1);switch(c.type){case"base64":u=ui(xi(l));break;case"binary":u=ui(l);break;case"buffer":case"array":u=l;break}Ka(u,0);var f=u.read_shift(1),h=!!(f&136),A=!1,x=!1;switch(f){case 2:break;case 3:break;case 48:A=!0,h=!0;break;case 49:A=!0,h=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var p=0,b=521;f==2&&(p=u.read_shift(2)),u.l+=3,f!=2&&(p=u.read_shift(4)),p>1048576&&(p=1e6),f!=2&&(b=u.read_shift(2));var m=u.read_shift(2),g=c.codepage||1252;f!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(g=e[u[u.l]]),u.l+=1,u.l+=2),x&&(u.l+=36);for(var y=[],v={},_=Math.min(u.length,f==2?521:b-10-(A?264:0)),j=x?32:11;u.l<_&&u[u.l]!=13;)switch(v={},v.name=g0.utils.decode(g,u.slice(u.l,u.l+j)).replace(/[\u0000\r\n].*$/g,""),u.l+=j,v.type=String.fromCharCode(u.read_shift(1)),f!=2&&!x&&(v.offset=u.read_shift(4)),v.len=u.read_shift(1),f==2&&(v.offset=u.read_shift(2)),v.dec=u.read_shift(1),v.name.length&&y.push(v),f!=2&&(u.l+=x?13:14),v.type){case"B":(!A||v.len!=8)&&c.WTF&&console.log("Skipping "+v.name+":"+v.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+v.name+":"+v.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+v.type)}if(u[u.l]!==13&&(u.l=b-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=b;var N=0,B=0;for(d[0]=[],B=0;B!=y.length;++B)d[0][B]=y[B].name;for(;p-- >0;){if(u[u.l]===42){u.l+=m;continue}for(++u.l,d[++N]=[],B=0,B=0;B!=y.length;++B){var E=u.slice(u.l,u.l+y[B].len);u.l+=y[B].len,Ka(E,0);var C=g0.utils.decode(g,E);switch(y[B].type){case"C":C.trim().length&&(d[N][B]=C.replace(/\s+$/,""));break;case"D":C.length===8?d[N][B]=new Date(+C.slice(0,4),+C.slice(4,6)-1,+C.slice(6,8)):d[N][B]=C;break;case"F":d[N][B]=parseFloat(C.trim());break;case"+":case"I":d[N][B]=x?E.read_shift(-4,"i")^2147483648:E.read_shift(4,"i");break;case"L":switch(C.trim().toUpperCase()){case"Y":case"T":d[N][B]=!0;break;case"N":case"F":d[N][B]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+C+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));d[N][B]="##MEMO##"+(x?parseInt(C.trim(),10):E.read_shift(4));break;case"N":C=C.replace(/\u0000/g,"").trim(),C&&C!="."&&(d[N][B]=+C||0);break;case"@":d[N][B]=new Date(E.read_shift(-8,"f")-621356832e5);break;case"T":d[N][B]=new Date((E.read_shift(4)-2440588)*864e5+E.read_shift(4));break;case"Y":d[N][B]=E.read_shift(4,"i")/1e4+E.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[N][B]=-E.read_shift(-8,"f");break;case"B":if(A&&y[B].len==8){d[N][B]=E.read_shift(8,"f");break}case"G":case"P":E.l+=y[B].len;break;case"0":if(y[B].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[B].type)}}}if(f!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return c&&c.sheetRows&&(d=d.slice(0,c.sheetRows)),c.DBF=y,d}function a(l,c){var d=c||{};d.dateNF||(d.dateNF="yyyymmdd");var u=rh(r(l,d),d);return u["!cols"]=d.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete d.DBF,u}function s(l,c){try{return ed(a(l,c),c)}catch(d){if(c&&c.WTF)throw d}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,c){var d=c||{};if(+d.codepage>=0&&ho(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var u=Vs(),f=yx(l,{header:1,raw:!0,cellDates:!0}),h=f[0],A=f.slice(1),x=l["!cols"]||[],p=0,b=0,m=0,g=1;for(p=0;p<h.length;++p){if(((x[p]||{}).DBF||{}).name){h[p]=x[p].DBF.name,++m;continue}if(h[p]!=null){if(++m,typeof h[p]=="number"&&(h[p]=h[p].toString(10)),typeof h[p]!="string")throw new Error("DBF Invalid column name "+h[p]+" |"+typeof h[p]+"|");if(h.indexOf(h[p])!==p){for(b=0;b<1024;++b)if(h.indexOf(h[p]+"_"+b)==-1){h[p]+="_"+b;break}}}}var y=Or(l["!ref"]),v=[],_=[],j=[];for(p=0;p<=y.e.c-y.s.c;++p){var N="",B="",E=0,C=[];for(b=0;b<A.length;++b)A[b][p]!=null&&C.push(A[b][p]);if(C.length==0||h[p]==null){v[p]="?";continue}for(b=0;b<C.length;++b){switch(typeof C[b]){case"number":B="B";break;case"string":B="C";break;case"boolean":B="L";break;case"object":B=C[b]instanceof Date?"D":"C";break;default:B="C"}E=Math.max(E,String(C[b]).length),N=N&&N!=B?"C":B}E>250&&(E=250),B=((x[p]||{}).DBF||{}).type,B=="C"&&x[p].DBF.len>E&&(E=x[p].DBF.len),N=="B"&&B=="N"&&(N="N",j[p]=x[p].DBF.dec,E=x[p].DBF.len),_[p]=N=="C"||B=="N"?E:i[N]||0,g+=_[p],v[p]=N}var k=u.next(32);for(k.write_shift(4,318902576),k.write_shift(4,A.length),k.write_shift(2,296+32*m),k.write_shift(2,g),p=0;p<4;++p)k.write_shift(4,0);for(k.write_shift(4,0|(+t[JF]||3)<<8),p=0,b=0;p<h.length;++p)if(h[p]!=null){var w=u.next(32),T=(h[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);w.write_shift(1,T,"sbcs"),w.write_shift(1,v[p]=="?"?"C":v[p],"sbcs"),w.write_shift(4,b),w.write_shift(1,_[p]||i[v[p]]||0),w.write_shift(1,j[p]||0),w.write_shift(1,2),w.write_shift(4,0),w.write_shift(1,0),w.write_shift(4,0),w.write_shift(4,0),b+=_[p]||i[v[p]]||0}var R=u.next(264);for(R.write_shift(4,13),p=0;p<65;++p)R.write_shift(4,0);for(p=0;p<A.length;++p){var q=u.next(g);for(q.write_shift(1,0),b=0;b<h.length;++b)if(h[b]!=null)switch(v[b]){case"L":q.write_shift(1,A[p][b]==null?63:A[p][b]?84:70);break;case"B":q.write_shift(8,A[p][b]||0,"f");break;case"N":var z="0";for(typeof A[p][b]=="number"&&(z=A[p][b].toFixed(j[b]||0)),m=0;m<_[b]-z.length;++m)q.write_shift(1,32);q.write_shift(1,z,"sbcs");break;case"D":A[p][b]?(q.write_shift(4,("0000"+A[p][b].getFullYear()).slice(-4),"sbcs"),q.write_shift(2,("00"+(A[p][b].getMonth()+1)).slice(-2),"sbcs"),q.write_shift(2,("00"+A[p][b].getDate()).slice(-2),"sbcs")):q.write_shift(8,"00000000","sbcs");break;case"C":var ee=String(A[p][b]!=null?A[p][b]:"").slice(0,_[b]);for(q.write_shift(1,ee,"sbcs"),m=0;m<_[b]-ee.length;++m)q.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:s,to_sheet:a,from_sheet:o}}(),dI=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Mn(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,A){var x=e[A];return typeof x=="number"?kC(x):x},a=function(h,A,x){var p=A.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return p==59?h:kC(p)};e["|"]=254;function s(h,A){switch(A.type){case"base64":return i(xi(h),A);case"binary":return i(h,A);case"buffer":return i(yr&&Buffer.isBuffer(h)?h.toString("binary"):Zc(h),A);case"array":return i(Zd(h),A)}throw new Error("Unrecognized type "+A.type)}function i(h,A){var x=h.split(/[\n\r]+/),p=-1,b=-1,m=0,g=0,y=[],v=[],_=null,j={},N=[],B=[],E=[],C=0,k;for(+A.codepage>=0&&ho(+A.codepage);m!==x.length;++m){C=0;var w=x[m].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(t,r),T=w.replace(/;;/g,"\0").split(";").map(function(P){return P.replace(/\u0000/g,";")}),R=T[0],q;if(w.length>0)switch(R){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":T[1].charAt(0)=="P"&&v.push(w.slice(3).replace(/;;/g,";"));break;case"C":var z=!1,ee=!1,Y=!1,G=!1,re=-1,U=-1;for(g=1;g<T.length;++g)switch(T[g].charAt(0)){case"A":break;case"X":b=parseInt(T[g].slice(1))-1,ee=!0;break;case"Y":for(p=parseInt(T[g].slice(1))-1,ee||(b=0),k=y.length;k<=p;++k)y[k]=[];break;case"K":q=T[g].slice(1),q.charAt(0)==='"'?q=q.slice(1,q.length-1):q==="TRUE"?q=!0:q==="FALSE"?q=!1:isNaN(go(q))?isNaN(RA(q).getDate())||(q=xn(q)):(q=go(q),_!==null&&eh(_)&&(q=dy(q))),z=!0;break;case"E":G=!0;var S=SA(T[g].slice(1),{r:p,c:b});y[p][b]=[y[p][b],S];break;case"S":Y=!0,y[p][b]=[y[p][b],"S5S"];break;case"G":break;case"R":re=parseInt(T[g].slice(1))-1;break;case"C":U=parseInt(T[g].slice(1))-1;break;default:if(A&&A.WTF)throw new Error("SYLK bad record "+w)}if(z&&(y[p][b]&&y[p][b].length==2?y[p][b][0]=q:y[p][b]=q,_=null),Y){if(G)throw new Error("SYLK shared formula cannot have own formula");var D=re>-1&&y[re][U];if(!D||!D[1])throw new Error("SYLK shared formula cannot find base");y[p][b][1]=SI(D[1],{r:p-re,c:b-U})}break;case"F":var L=0;for(g=1;g<T.length;++g)switch(T[g].charAt(0)){case"X":b=parseInt(T[g].slice(1))-1,++L;break;case"Y":for(p=parseInt(T[g].slice(1))-1,k=y.length;k<=p;++k)y[k]=[];break;case"M":C=parseInt(T[g].slice(1))/20;break;case"F":break;case"G":break;case"P":_=v[parseInt(T[g].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(E=T[g].slice(1).split(" "),k=parseInt(E[0],10);k<=parseInt(E[1],10);++k)C=parseInt(E[2],10),B[k-1]=C===0?{hidden:!0}:{wch:C},Wc(B[k-1]);break;case"C":b=parseInt(T[g].slice(1))-1,B[b]||(B[b]={});break;case"R":p=parseInt(T[g].slice(1))-1,N[p]||(N[p]={}),C>0?(N[p].hpt=C,N[p].hpx=QA(C)):C===0&&(N[p].hidden=!0);break;default:if(A&&A.WTF)throw new Error("SYLK bad record "+w)}L<1&&(_=null);break;default:if(A&&A.WTF)throw new Error("SYLK bad record "+w)}}return N.length>0&&(j["!rows"]=N),B.length>0&&(j["!cols"]=B),A&&A.sheetRows&&(y=y.slice(0,A.sheetRows)),[y,j]}function o(h,A){var x=s(h,A),p=x[0],b=x[1],m=rh(p,A);return Mn(b).forEach(function(g){m[g]=b[g]}),m}function l(h,A){return ed(o(h,A),A)}function c(h,A,x,p){var b="C;Y"+(x+1)+";X"+(p+1)+";K";switch(h.t){case"n":b+=h.v||0,h.f&&!h.F&&(b+=";E"+q2(h.f,{r:x,c:p}));break;case"b":b+=h.v?"TRUE":"FALSE";break;case"e":b+=h.w||h.v;break;case"d":b+='"'+(h.w||h.v)+'"';break;case"s":b+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return b}function d(h,A){A.forEach(function(x,p){var b="F;W"+(p+1)+" "+(p+1)+" ";x.hidden?b+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=j0(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=k0(x.wpx)),typeof x.wch=="number"&&(b+=Math.round(x.wch))),b.charAt(b.length-1)!=" "&&h.push(b)})}function u(h,A){A.forEach(function(x,p){var b="F;";x.hidden?b+="M0;":x.hpt?b+="M"+20*x.hpt+";":x.hpx&&(b+="M"+20*C0(x.hpx)+";"),b.length>2&&h.push(b+"R"+(p+1))})}function f(h,A){var x=["ID;PWXL;N;E"],p=[],b=Or(h["!ref"]),m,g=Array.isArray(h),y=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),h["!cols"]&&d(x,h["!cols"]),h["!rows"]&&u(x,h["!rows"]),x.push("B;Y"+(b.e.r-b.s.r+1)+";X"+(b.e.c-b.s.c+1)+";D"+[b.s.c,b.s.r,b.e.c,b.e.r].join(" "));for(var v=b.s.r;v<=b.e.r;++v)for(var _=b.s.c;_<=b.e.c;++_){var j=sr({r:v,c:_});m=g?(h[v]||[])[_]:h[j],!(!m||m.v==null&&(!m.f||m.F))&&p.push(c(m,h,v,_))}return x.join(y)+y+p.join(y)+y+"E"+y}return{to_workbook:l,to_sheet:o,from_sheet:f}}(),uI=function(){function e(i,o){switch(o.type){case"base64":return t(xi(i),o);case"binary":return t(i,o);case"buffer":return t(yr&&Buffer.isBuffer(i)?i.toString("binary"):Zc(i),o);case"array":return t(Zd(i),o)}throw new Error("Unrecognized type "+o.type)}function t(i,o){for(var l=i.split(`
`),c=-1,d=-1,u=0,f=[];u!==l.length;++u){if(l[u].trim()==="BOT"){f[++c]=[],d=0;continue}if(!(c<0)){var h=l[u].trim().split(","),A=h[0],x=h[1];++u;for(var p=l[u]||"";(p.match(/["]/g)||[]).length&1&&u<l.length-1;)p+=`
`+l[++u];switch(p=p.trim(),+A){case-1:if(p==="BOT"){f[++c]=[],d=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?f[c][d]=!0:p==="FALSE"?f[c][d]=!1:isNaN(go(x))?isNaN(RA(x).getDate())?f[c][d]=x:f[c][d]=xn(x):f[c][d]=go(x),++d;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),f[c][d++]=p!==""?p:null;break}if(p==="EOD")break}}return o&&o.sheetRows&&(f=f.slice(0,o.sheetRows)),f}function r(i,o){return rh(e(i,o),o)}function a(i,o){return ed(r(i,o),o)}var s=function(){var i=function(c,d,u,f,h){c.push(d),c.push(u+","+f),c.push('"'+h.replace(/"/g,'""')+'"')},o=function(c,d,u,f){c.push(d+","+u),c.push(d==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var d=[],u=Or(c["!ref"]),f,h=Array.isArray(c);i(d,"TABLE",0,1,"sheetjs"),i(d,"VECTORS",0,u.e.r-u.s.r+1,""),i(d,"TUPLES",0,u.e.c-u.s.c+1,""),i(d,"DATA",0,0,"");for(var A=u.s.r;A<=u.e.r;++A){o(d,-1,0,"BOT");for(var x=u.s.c;x<=u.e.c;++x){var p=sr({r:A,c:x});if(f=h?(c[A]||[])[x]:c[p],!f){o(d,1,0,"");continue}switch(f.t){case"n":var b=f.w;!b&&f.v!=null&&(b=f.v),b==null?f.f&&!f.F?o(d,1,0,"="+f.f):o(d,1,0,""):o(d,0,b,"V");break;case"b":o(d,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":o(d,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Wi(f.z||nr[14],ka(xn(f.v)))),o(d,0,f.w,"V");break;default:o(d,1,0,"")}}}o(d,-1,0,"EOD");var m=`\r
`,g=d.join(m);return g}}();return{to_workbook:a,to_sheet:r,from_sheet:s}}(),AI=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,h){for(var A=f.split(`
`),x=-1,p=-1,b=0,m=[];b!==A.length;++b){var g=A[b].trim().split(":");if(g[0]==="cell"){var y=Cn(g[1]);if(m.length<=y.r)for(x=m.length;x<=y.r;++x)m[x]||(m[x]=[]);switch(x=y.r,p=y.c,g[2]){case"t":m[x][p]=e(g[3]);break;case"v":m[x][p]=+g[3];break;case"vtf":var v=g[g.length-1];case"vtc":switch(g[3]){case"nl":m[x][p]=!!+g[4];break;default:m[x][p]=+g[4];break}g[2]=="vtf"&&(m[x][p]=[m[x][p],v])}}}return h&&h.sheetRows&&(m=m.slice(0,h.sheetRows)),m}function a(f,h){return rh(r(f,h),h)}function s(f,h){return ed(a(f,h),h)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function d(f){if(!f||!f["!ref"])return"";for(var h=[],A=[],x,p="",b=Ws(f["!ref"]),m=Array.isArray(f),g=b.s.r;g<=b.e.r;++g)for(var y=b.s.c;y<=b.e.c;++y)if(p=sr({r:g,c:y}),x=m?(f[g]||[])[y]:f[p],!(!x||x.v==null||x.t==="z")){switch(A=["cell",p,"t"],x.t){case"s":case"str":A.push(t(x.v));break;case"n":x.f?(A[2]="vtf",A[3]="n",A[4]=x.v,A[5]=t(x.f)):(A[2]="v",A[3]=x.v);break;case"b":A[2]="vt"+(x.f?"f":"c"),A[3]="nl",A[4]=x.v?"1":"0",A[5]=t(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var v=ka(xn(x.v));A[2]="vtc",A[3]="nd",A[4]=""+v,A[5]=x.w||Wi(x.z||nr[14],v);break;case"e":continue}h.push(A.join(":"))}return h.push("sheet:c:"+(b.e.c-b.s.c+1)+":r:"+(b.e.r-b.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function u(f){return[i,o,l,o,d(f),c].join(`
`)}return{to_workbook:s,to_sheet:a,from_sheet:u}}(),MA=function(){function e(u,f,h,A,x){x.raw?f[h][A]=u:u===""||(u==="TRUE"?f[h][A]=!0:u==="FALSE"?f[h][A]=!1:isNaN(go(u))?isNaN(RA(u).getDate())?f[h][A]=u:f[h][A]=xn(u):f[h][A]=go(u))}function t(u,f){var h=f||{},A=[];if(!u||u.length===0)return A;for(var x=u.split(/[\r\n]/),p=x.length-1;p>=0&&x[p].length===0;)--p;for(var b=10,m=0,g=0;g<=p;++g)m=x[g].indexOf(" "),m==-1?m=x[g].length:m++,b=Math.max(b,m);for(g=0;g<=p;++g){A[g]=[];var y=0;for(e(x[g].slice(0,b).trim(),A,g,y,h),y=1;y<=(x[g].length-b)/10+1;++y)e(x[g].slice(b+(y-1)*10,b+y*10).trim(),A,g,y,h)}return h.sheetRows&&(A=A.slice(0,h.sheetRows)),A}var r={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function s(u){for(var f={},h=!1,A=0,x=0;A<u.length;++A)(x=u.charCodeAt(A))==34?h=!h:!h&&x in r&&(f[x]=(f[x]||0)+1);x=[];for(A in f)Object.prototype.hasOwnProperty.call(f,A)&&x.push([f[A],A]);if(!x.length){f=a;for(A in f)Object.prototype.hasOwnProperty.call(f,A)&&x.push([f[A],A])}return x.sort(function(p,b){return p[0]-b[0]||a[p[1]]-a[b[1]]}),r[x.pop()[1]]||44}function i(u,f){var h=f||{},A="",x=h.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(A=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(A=u.charAt(4),u=u.slice(6)):A=s(u.slice(0,1024)):h&&h.FS?A=h.FS:A=s(u.slice(0,1024));var b=0,m=0,g=0,y=0,v=0,_=A.charCodeAt(0),j=!1,N=0,B=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var E=h.dateNF!=null?qZ(h.dateNF):null;function C(){var k=u.slice(y,v),w={};if(k.charAt(0)=='"'&&k.charAt(k.length-1)=='"'&&(k=k.slice(1,-1).replace(/""/g,'"')),k.length===0)w.t="z";else if(h.raw)w.t="s",w.v=k;else if(k.trim().length===0)w.t="s",w.v=k;else if(k.charCodeAt(0)==61)k.charCodeAt(1)==34&&k.charCodeAt(k.length-1)==34?(w.t="s",w.v=k.slice(2,-1).replace(/""/g,'"')):xse(k)?(w.t="n",w.f=k.slice(1)):(w.t="s",w.v=k);else if(k=="TRUE")w.t="b",w.v=!0;else if(k=="FALSE")w.t="b",w.v=!1;else if(!isNaN(g=go(k)))w.t="n",h.cellText!==!1&&(w.w=k),w.v=g;else if(!isNaN(RA(k).getDate())||E&&k.match(E)){w.z=h.dateNF||nr[14];var T=0;E&&k.match(E)&&(k=$Z(k,h.dateNF,k.match(E)||[]),T=1),h.cellDates?(w.t="d",w.v=xn(k,T)):(w.t="n",w.v=ka(xn(k,T))),h.cellText!==!1&&(w.w=Wi(w.z,w.v instanceof Date?ka(w.v):w.v)),h.cellNF||delete w.z}else w.t="s",w.v=k;if(w.t=="z"||(h.dense?(x[b]||(x[b]=[]),x[b][m]=w):x[sr({c:m,r:b})]=w),y=v+1,B=u.charCodeAt(y),p.e.c<m&&(p.e.c=m),p.e.r<b&&(p.e.r=b),N==_)++m;else if(m=0,++b,h.sheetRows&&h.sheetRows<=b)return!0}e:for(;v<u.length;++v)switch(N=u.charCodeAt(v)){case 34:B===34&&(j=!j);break;case _:case 10:case 13:if(!j&&C())break e;break}return v-y>0&&C(),x["!ref"]=fr(p),x}function o(u,f){return!(f&&f.PRN)||f.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?i(u,f):rh(t(u,f),f)}function l(u,f){var h="",A=f.type=="string"?[0,0,0,0]:Y2(u,f);switch(f.type){case"base64":h=xi(u);break;case"binary":h=u;break;case"buffer":f.codepage==65001?h=u.toString("utf8"):f.codepage&&typeof g0<"u"||(h=yr&&Buffer.isBuffer(u)?u.toString("binary"):Zc(u));break;case"array":h=Zd(u);break;case"string":h=u;break;default:throw new Error("Unrecognized type "+f.type)}return A[0]==239&&A[1]==187&&A[2]==191?h=Jr(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=Jr(h):f.type=="binary"&&typeof g0<"u",h.slice(0,19)=="socialcalc:version:"?AI.to_sheet(f.type=="string"?h:Jr(h),f):o(h,f)}function c(u,f){return ed(l(u,f),f)}function d(u){for(var f=[],h=Or(u["!ref"]),A,x=Array.isArray(u),p=h.s.r;p<=h.e.r;++p){for(var b=[],m=h.s.c;m<=h.e.c;++m){var g=sr({r:p,c:m});if(A=x?(u[p]||[])[m]:u[g],!A||A.v==null){b.push("          ");continue}for(var y=(A.w||(Ql(A),A.w)||"").slice(0,10);y.length<10;)y+=" ";b.push(y+(m===0?" ":""))}f.push(b.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:d}}();function ane(e,t){var r=t||{},a=!!r.WTF;r.WTF=!0;try{var s=dI.to_workbook(e,r);return r.WTF=a,s}catch(i){if(r.WTF=a,!i.message.match(/SYLK bad record ID/)&&a)throw i;return MA.to_workbook(e,t)}}var Hd=function(){function e(S,D,L){if(S){Ka(S,S.l||0);for(var P=L.Enum||re;S.l<S.length;){var I=S.read_shift(2),H=P[I]||P[65535],V=S.read_shift(2),W=S.l+V,M=H.f&&H.f(S,V,L);if(S.l=W,D(M,H,I))return}}}function t(S,D){switch(D.type){case"base64":return r(ui(xi(S)),D);case"binary":return r(ui(S),D);case"buffer":case"array":return r(S,D)}throw"Unsupported type "+D.type}function r(S,D){if(!S)return S;var L=D||{},P=L.dense?[]:{},I="Sheet1",H="",V=0,W={},M=[],se=[],K={s:{r:0,c:0},e:{r:0,c:0}},he=L.sheetRows||0;if(S[2]==0&&(S[3]==8||S[3]==9)&&S.length>=16&&S[14]==5&&S[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(S[2]==2)L.Enum=re,e(S,function(_e,de,ye){switch(ye){case 0:L.vers=_e,_e>=4096&&(L.qpro=!0);break;case 6:K=_e;break;case 204:_e&&(H=_e);break;case 222:H=_e;break;case 15:case 51:L.qpro||(_e[1].v=_e[1].v.slice(1));case 13:case 14:case 16:ye==14&&(_e[2]&112)==112&&(_e[2]&15)>1&&(_e[2]&15)<15&&(_e[1].z=L.dateNF||nr[14],L.cellDates&&(_e[1].t="d",_e[1].v=dy(_e[1].v))),L.qpro&&_e[3]>V&&(P["!ref"]=fr(K),W[I]=P,M.push(I),P=L.dense?[]:{},K={s:{r:0,c:0},e:{r:0,c:0}},V=_e[3],I=H||"Sheet"+(V+1),H="");var Le=L.dense?(P[_e[0].r]||[])[_e[0].c]:P[sr(_e[0])];if(Le){Le.t=_e[1].t,Le.v=_e[1].v,_e[1].z!=null&&(Le.z=_e[1].z),_e[1].f!=null&&(Le.f=_e[1].f);break}L.dense?(P[_e[0].r]||(P[_e[0].r]=[]),P[_e[0].r][_e[0].c]=_e[1]):P[sr(_e[0])]=_e[1];break}},L);else if(S[2]==26||S[2]==14)L.Enum=U,S[2]==14&&(L.qpro=!0,S.l=0),e(S,function(_e,de,ye){switch(ye){case 204:I=_e;break;case 22:_e[1].v=_e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(_e[3]>V&&(P["!ref"]=fr(K),W[I]=P,M.push(I),P=L.dense?[]:{},K={s:{r:0,c:0},e:{r:0,c:0}},V=_e[3],I="Sheet"+(V+1)),he>0&&_e[0].r>=he)break;L.dense?(P[_e[0].r]||(P[_e[0].r]=[]),P[_e[0].r][_e[0].c]=_e[1]):P[sr(_e[0])]=_e[1],K.e.c<_e[0].c&&(K.e.c=_e[0].c),K.e.r<_e[0].r&&(K.e.r=_e[0].r);break;case 27:_e[14e3]&&(se[_e[14e3][0]]=_e[14e3][1]);break;case 1537:se[_e[0]]=_e[1],_e[0]==V&&(I=_e[1]);break}},L);else throw new Error("Unrecognized LOTUS BOF "+S[2]);if(P["!ref"]=fr(K),W[H||I]=P,M.push(H||I),!se.length)return{SheetNames:M,Sheets:W};for(var ne={},te=[],ce=0;ce<se.length;++ce)W[M[ce]]?(te.push(se[ce]||M[ce]),ne[se[ce]]=W[se[ce]]||W[M[ce]]):(te.push(se[ce]),ne[se[ce]]={"!ref":"A1"});return{SheetNames:te,Sheets:ne}}function a(S,D){var L=D||{};if(+L.codepage>=0&&ho(+L.codepage),L.type=="string")throw new Error("Cannot write WK1 to JS string");var P=Vs(),I=Or(S["!ref"]),H=Array.isArray(S),V=[];Bt(P,0,i(1030)),Bt(P,6,c(I));for(var W=Math.min(I.e.r,8191),M=I.s.r;M<=W;++M)for(var se=Jn(M),K=I.s.c;K<=I.e.c;++K){M===I.s.r&&(V[K]=kn(K));var he=V[K]+se,ne=H?(S[M]||[])[K]:S[he];if(!(!ne||ne.t=="z"))if(ne.t=="n")(ne.v|0)==ne.v&&ne.v>=-32768&&ne.v<=32767?Bt(P,13,A(M,K,ne.v)):Bt(P,14,p(M,K,ne.v));else{var te=Ql(ne);Bt(P,15,f(M,K,te.slice(0,239)))}}return Bt(P,1),P.end()}function s(S,D){var L=D||{};if(+L.codepage>=0&&ho(+L.codepage),L.type=="string")throw new Error("Cannot write WK3 to JS string");var P=Vs();Bt(P,0,o(S));for(var I=0,H=0;I<S.SheetNames.length;++I)(S.Sheets[S.SheetNames[I]]||{})["!ref"]&&Bt(P,27,G(S.SheetNames[I],H++));var V=0;for(I=0;I<S.SheetNames.length;++I){var W=S.Sheets[S.SheetNames[I]];if(!(!W||!W["!ref"])){for(var M=Or(W["!ref"]),se=Array.isArray(W),K=[],he=Math.min(M.e.r,8191),ne=M.s.r;ne<=he;++ne)for(var te=Jn(ne),ce=M.s.c;ce<=M.e.c;++ce){ne===M.s.r&&(K[ce]=kn(ce));var _e=K[ce]+te,de=se?(W[ne]||[])[ce]:W[_e];if(!(!de||de.t=="z"))if(de.t=="n")Bt(P,23,C(ne,ce,V,de.v));else{var ye=Ql(de);Bt(P,22,N(ne,ce,V,ye.slice(0,239)))}}++V}}return Bt(P,1),P.end()}function i(S){var D=ct(2);return D.write_shift(2,S),D}function o(S){var D=ct(26);D.write_shift(2,4096),D.write_shift(2,4),D.write_shift(4,0);for(var L=0,P=0,I=0,H=0;H<S.SheetNames.length;++H){var V=S.SheetNames[H],W=S.Sheets[V];if(!(!W||!W["!ref"])){++I;var M=Ws(W["!ref"]);L<M.e.r&&(L=M.e.r),P<M.e.c&&(P=M.e.c)}}return L>8191&&(L=8191),D.write_shift(2,L),D.write_shift(1,I),D.write_shift(1,P),D.write_shift(2,0),D.write_shift(2,0),D.write_shift(1,1),D.write_shift(1,2),D.write_shift(4,0),D.write_shift(4,0),D}function l(S,D,L){var P={s:{c:0,r:0},e:{c:0,r:0}};return D==8&&L.qpro?(P.s.c=S.read_shift(1),S.l++,P.s.r=S.read_shift(2),P.e.c=S.read_shift(1),S.l++,P.e.r=S.read_shift(2),P):(P.s.c=S.read_shift(2),P.s.r=S.read_shift(2),D==12&&L.qpro&&(S.l+=2),P.e.c=S.read_shift(2),P.e.r=S.read_shift(2),D==12&&L.qpro&&(S.l+=2),P.s.c==65535&&(P.s.c=P.e.c=P.s.r=P.e.r=0),P)}function c(S){var D=ct(8);return D.write_shift(2,S.s.c),D.write_shift(2,S.s.r),D.write_shift(2,S.e.c),D.write_shift(2,S.e.r),D}function d(S,D,L){var P=[{c:0,r:0},{t:"n",v:0},0,0];return L.qpro&&L.vers!=20768?(P[0].c=S.read_shift(1),P[3]=S.read_shift(1),P[0].r=S.read_shift(2),S.l+=2):(P[2]=S.read_shift(1),P[0].c=S.read_shift(2),P[0].r=S.read_shift(2)),P}function u(S,D,L){var P=S.l+D,I=d(S,D,L);if(I[1].t="s",L.vers==20768){S.l++;var H=S.read_shift(1);return I[1].v=S.read_shift(H,"utf8"),I}return L.qpro&&S.l++,I[1].v=S.read_shift(P-S.l,"cstr"),I}function f(S,D,L){var P=ct(7+L.length);P.write_shift(1,255),P.write_shift(2,D),P.write_shift(2,S),P.write_shift(1,39);for(var I=0;I<P.length;++I){var H=L.charCodeAt(I);P.write_shift(1,H>=128?95:H)}return P.write_shift(1,0),P}function h(S,D,L){var P=d(S,D,L);return P[1].v=S.read_shift(2,"i"),P}function A(S,D,L){var P=ct(7);return P.write_shift(1,255),P.write_shift(2,D),P.write_shift(2,S),P.write_shift(2,L,"i"),P}function x(S,D,L){var P=d(S,D,L);return P[1].v=S.read_shift(8,"f"),P}function p(S,D,L){var P=ct(13);return P.write_shift(1,255),P.write_shift(2,D),P.write_shift(2,S),P.write_shift(8,L,"f"),P}function b(S,D,L){var P=S.l+D,I=d(S,D,L);if(I[1].v=S.read_shift(8,"f"),L.qpro)S.l=P;else{var H=S.read_shift(2);v(S.slice(S.l,S.l+H),I),S.l+=H}return I}function m(S,D,L){var P=D&32768;return D&=-32769,D=(P?S:0)+(D>=8192?D-16384:D),(P?"":"$")+(L?kn(D):Jn(D))}var g={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function v(S,D){Ka(S,0);for(var L=[],P=0,I="",H="",V="",W="";S.l<S.length;){var M=S[S.l++];switch(M){case 0:L.push(S.read_shift(8,"f"));break;case 1:H=m(D[0].c,S.read_shift(2),!0),I=m(D[0].r,S.read_shift(2),!1),L.push(H+I);break;case 2:{var se=m(D[0].c,S.read_shift(2),!0),K=m(D[0].r,S.read_shift(2),!1);H=m(D[0].c,S.read_shift(2),!0),I=m(D[0].r,S.read_shift(2),!1),L.push(se+K+":"+H+I)}break;case 3:if(S.l<S.length){console.error("WK1 premature formula end");return}break;case 4:L.push("("+L.pop()+")");break;case 5:L.push(S.read_shift(2));break;case 6:{for(var he="";M=S[S.l++];)he+=String.fromCharCode(M);L.push('"'+he.replace(/"/g,'""')+'"')}break;case 8:L.push("-"+L.pop());break;case 23:L.push("+"+L.pop());break;case 22:L.push("NOT("+L.pop()+")");break;case 20:case 21:W=L.pop(),V=L.pop(),L.push(["AND","OR"][M-20]+"("+V+","+W+")");break;default:if(M<32&&y[M])W=L.pop(),V=L.pop(),L.push(V+y[M]+W);else if(g[M]){if(P=g[M][1],P==69&&(P=S[S.l++]),P>L.length){console.error("WK1 bad formula parse 0x"+M.toString(16)+":|"+L.join("|")+"|");return}var ne=L.slice(-P);L.length-=P,L.push(g[M][0]+"("+ne.join(",")+")")}else return M<=7?console.error("WK1 invalid opcode "+M.toString(16)):M<=24?console.error("WK1 unsupported op "+M.toString(16)):M<=30?console.error("WK1 invalid opcode "+M.toString(16)):M<=115?console.error("WK1 unsupported function opcode "+M.toString(16)):console.error("WK1 unrecognized opcode "+M.toString(16))}}L.length==1?D[1].f=""+L[0]:console.error("WK1 bad formula parse |"+L.join("|")+"|")}function _(S){var D=[{c:0,r:0},{t:"n",v:0},0];return D[0].r=S.read_shift(2),D[3]=S[S.l++],D[0].c=S[S.l++],D}function j(S,D){var L=_(S);return L[1].t="s",L[1].v=S.read_shift(D-4,"cstr"),L}function N(S,D,L,P){var I=ct(6+P.length);I.write_shift(2,S),I.write_shift(1,L),I.write_shift(1,D),I.write_shift(1,39);for(var H=0;H<P.length;++H){var V=P.charCodeAt(H);I.write_shift(1,V>=128?95:V)}return I.write_shift(1,0),I}function B(S,D){var L=_(S);L[1].v=S.read_shift(2);var P=L[1].v>>1;if(L[1].v&1)switch(P&7){case 0:P=(P>>3)*5e3;break;case 1:P=(P>>3)*500;break;case 2:P=(P>>3)/20;break;case 3:P=(P>>3)/200;break;case 4:P=(P>>3)/2e3;break;case 5:P=(P>>3)/2e4;break;case 6:P=(P>>3)/16;break;case 7:P=(P>>3)/64;break}return L[1].v=P,L}function E(S,D){var L=_(S),P=S.read_shift(4),I=S.read_shift(4),H=S.read_shift(2);if(H==65535)return P===0&&I===3221225472?(L[1].t="e",L[1].v=15):P===0&&I===3489660928?(L[1].t="e",L[1].v=42):L[1].v=0,L;var V=H&32768;return H=(H&32767)-16446,L[1].v=(1-V*2)*(I*Math.pow(2,H+32)+P*Math.pow(2,H)),L}function C(S,D,L,P){var I=ct(14);if(I.write_shift(2,S),I.write_shift(1,L),I.write_shift(1,D),P==0)return I.write_shift(4,0),I.write_shift(4,0),I.write_shift(2,65535),I;var H=0,V=0,W=0,M=0;return P<0&&(H=1,P=-P),V=Math.log2(P)|0,P/=Math.pow(2,V-31),M=P>>>0,M&2147483648||(P/=2,++V,M=P>>>0),P-=M,M|=2147483648,M>>>=0,P*=Math.pow(2,32),W=P>>>0,I.write_shift(4,W),I.write_shift(4,M),V+=16383+(H?32768:0),I.write_shift(2,V),I}function k(S,D){var L=E(S);return S.l+=D-14,L}function w(S,D){var L=_(S),P=S.read_shift(4);return L[1].v=P>>6,L}function T(S,D){var L=_(S),P=S.read_shift(8,"f");return L[1].v=P,L}function R(S,D){var L=T(S);return S.l+=D-10,L}function q(S,D){return S[S.l+D-1]==0?S.read_shift(D,"cstr"):""}function z(S,D){var L=S[S.l++];L>D-1&&(L=D-1);for(var P="";P.length<L;)P+=String.fromCharCode(S[S.l++]);return P}function ee(S,D,L){if(!(!L.qpro||D<21)){var P=S.read_shift(1);S.l+=17,S.l+=1,S.l+=2;var I=S.read_shift(D-21,"cstr");return[P,I]}}function Y(S,D){for(var L={},P=S.l+D;S.l<P;){var I=S.read_shift(2);if(I==14e3){for(L[I]=[0,""],L[I][0]=S.read_shift(2);S[S.l];)L[I][1]+=String.fromCharCode(S[S.l]),S.l++;S.l++}}return L}function G(S,D){var L=ct(5+S.length);L.write_shift(2,14e3),L.write_shift(2,D);for(var P=0;P<S.length;++P){var I=S.charCodeAt(P);L[L.l++]=I>127?95:I}return L[L.l++]=0,L}var re={0:{n:"BOF",f:ia},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:x},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:b},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:q},222:{n:"SHEETNAMELP",f:z},65535:{n:""}},U={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:j},23:{n:"NUMBER17",f:E},24:{n:"NUMBER18",f:B},25:{n:"FORMULA19",f:k},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Y},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:w},38:{n:"??"},39:{n:"NUMBER27",f:T},40:{n:"FORMULA28",f:R},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:q},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ee},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:s,to_workbook:t}}();function sne(e){var t={},r=e.match(ms),a=0,s=!1;if(r)for(;a!=r.length;++a){var i=or(r[a]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=f2[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(i[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+i[0])}}return t}var ine=function(){var e=v0("t"),t=v0("rPr");function r(i){var o=i.match(e);if(!o)return{t:"s",v:""};var l={t:"s",v:Dr(o[1])},c=i.match(t);return c&&(l.s=sne(c[1])),l}var a=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(o){return o.replace(a,"").split(s).map(r).filter(function(l){return l.v})}}(),one=function(){var t=/(\r\n|\n)/g;function r(s,i,o){var l=[];s.u&&l.push("text-decoration: underline;"),s.uval&&l.push("text-underline-style:"+s.uval+";"),s.sz&&l.push("font-size:"+s.sz+"pt;"),s.outline&&l.push("text-effect: outline;"),s.shadow&&l.push("text-shadow: auto;"),i.push('<span style="'+l.join("")+'">'),s.b&&(i.push("<b>"),o.push("</b>")),s.i&&(i.push("<i>"),o.push("</i>")),s.strike&&(i.push("<s>"),o.push("</s>"));var c=s.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(i.push("<"+c+">"),o.push("</"+c+">")),o.push("</span>"),s}function a(s){var i=[[],s.v,[]];return s.v?(s.s&&r(s.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(a).join("")}}(),lne=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,cne=/<(?:\w+:)?r>/,dne=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function U2(e,t){var r=t?t.cellHTML:!0,a={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=Dr(Jr(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=Jr(e),r&&(a.h=N2(a.t))):e.match(cne)&&(a.r=Jr(e),a.t=Dr(Jr((e.replace(dne,"").match(lne)||[]).join("").replace(ms,""))),r&&(a.h=one(ine(a.r)))),a):{t:""}}var une=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Ane=/<(?:\w+:)?(?:si|sstItem)>/g,hne=/<\/(?:\w+:)?(?:si|sstItem)>/;function fne(e,t){var r=[],a="";if(!e)return r;var s=e.match(une);if(s){a=s[2].replace(Ane,"").split(hne);for(var i=0;i!=a.length;++i){var o=U2(a[i].trim(),t);o!=null&&(r[r.length]=o)}s=or(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var pne=/^\s|\s$|[\t\n\r]/;function hI(e,t){if(!t.bookSST)return"";var r=[ea];r[r.length]=St("sst",null,{xmlns:lu[0],count:e.Count,uniqueCount:e.Unique});for(var a=0;a!=e.length;++a)if(e[a]!=null){var s=e[a],i="<si>";s.r?i+=s.r:(i+="<t",s.t||(s.t=""),s.t.match(pne)&&(i+=' xml:space="preserve"'),i+=">"+Gr(s.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function mne(e){return[e.read_shift(4),e.read_shift(4)]}function gne(e,t){var r=[],a=!1;return Wl(e,function(i,o,l){switch(l){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(o.T,!a||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function xne(e,t){return t||(t=ct(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var yne=Bee;function vne(e){var t=Vs();xt(t,159,xne(e));for(var r=0;r<e.length;++r)xt(t,19,yne(e[r]));return xt(t,160),t.end()}function fI(e){for(var t=[],r=e.split(""),a=0;a<r.length;++a)t[a]=r[a].charCodeAt(0);return t}function Il(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function bne(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Il(e,4),t.U=Il(e,4),t.W=Il(e,4),t}function _ne(e){for(var t=e.read_shift(4),r=e.l+t-4,a={},s=e.read_shift(4),i=[];s-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(a.name=e.read_shift(0,"lpp4"),a.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return a}function wne(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(_ne(e));return t}function Nne(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function jne(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Il(e,4),t.U=Il(e,4),t.W=Il(e,4),t}function kne(e){var t=jne(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function pI(e,t){var r=e.l+t,a={};a.Flags=e.read_shift(4)&63,e.l+=4,a.AlgID=e.read_shift(4);var s=!1;switch(a.AlgID){case 26126:case 26127:case 26128:s=a.Flags==36;break;case 26625:s=a.Flags==4;break;case 0:s=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=e.read_shift(4),a.KeySize=e.read_shift(4),a.ProviderType=e.read_shift(4),e.l+=8,a.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,a}function mI(e,t){var r={},a=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,a),e.l=a,r}function Cne(e){var t=Il(e);switch(t.Minor){case 2:return[t.Minor,Sne(e)];case 3:return[t.Minor,Bne()];case 4:return[t.Minor,Ene(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function Sne(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),a=pI(e,r),s=mI(e,e.length-e.l);return{t:"Std",h:a,v:s}}function Bne(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Ene(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),a={};return r.replace(ms,function(i){var o=or(i);switch(el(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(l){a[l]=o[l]});break;case"<dataIntegrity":a.encryptedHmacKey=o.encryptedHmacKey,a.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(o);break;default:throw o[0]}}),a}function Fne(e,t){var r={},a=r.EncryptionVersionInfo=Il(e,4);if(t-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=pI(e,s),t-=s,r.EncryptionVerifier=mI(e,t),r}function Tne(e){var t={},r=t.EncryptionVersionInfo=Il(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function R2(e){var t=0,r,a=fI(e),s=a.length+1,i,o,l,c,d;for(r=Vc(s),r[0]=a.length,i=1;i!=s;++i)r[i]=a[i-1];for(i=s-1;i>=0;--i)o=r[i],l=t&16384?1:0,c=t<<1&32767,d=l|c,t=d^o;return t^52811}var gI=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(o){return(o/2|o*128)&255},s=function(o,l){return a(o^l)},i=function(o){for(var l=t[o.length-1],c=104,d=o.length-1;d>=0;--d)for(var u=o[d],f=0;f!=7;++f)u&64&&(l^=r[c]),u*=2,--c;return l};return function(o){for(var l=fI(o),c=i(l),d=l.length,u=Vc(16),f=0;f!=16;++f)u[f]=0;var h,A,x;for((d&1)===1&&(h=c>>8,u[d]=s(e[0],h),--d,h=c&255,A=l[l.length-1],u[d]=s(A,h));d>0;)--d,h=c>>8,u[d]=s(l[d],h),--d,h=c&255,u[d]=s(l[d],h);for(d=15,x=15-l.length;x>0;)h=c>>8,u[d]=s(e[x],h),--d,--x,h=c&255,u[d]=s(l[d],h),--d,--x;return u}}(),Ine=function(e,t,r,a,s){s||(s=t),a||(a=gI(e));var i,o;for(i=0;i!=t.length;++i)o=t[i],o^=a[r],o=(o>>5|o<<3)&255,s[i]=o,++r;return[s,r,a]},Dne=function(e){var t=0,r=gI(e);return function(a){var s=Ine("",a,t,r);return t=s[1],s[0]}};function Lne(e,t,r,a){var s={key:ia(e),verificationBytes:ia(e)};return r.password&&(s.verifier=R2(r.password)),a.valid=s.verificationBytes===s.verifier,a.valid&&(a.insitu=Dne(r.password)),s}function Pne(e,t,r){var a=r||{};return a.Info=e.read_shift(2),e.l-=2,a.Info===1?a.Data=Tne(e):a.Data=Fne(e,t),a}function One(e,t,r){var a={Type:r.biff>=8?e.read_shift(2):0};return a.Type?Pne(e,t-2,a):Lne(e,r.biff>=8?t:t-2,r,a),a}var xI=function(){function e(s,i){switch(i.type){case"base64":return t(xi(s),i);case"binary":return t(s,i);case"buffer":return t(yr&&Buffer.isBuffer(s)?s.toString("binary"):Zc(s),i);case"array":return t(Zd(s),i)}throw new Error("Unrecognized type "+i.type)}function t(s,i){var o=i||{},l=o.dense?[]:{},c=s.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(u,f){Array.isArray(l)&&(l[f]=[]);for(var h=/\\\w+\b/g,A=0,x,p=-1;x=h.exec(u);){switch(x[0]){case"\\cell":var b=u.slice(A,h.lastIndex-x[0].length);if(b[0]==" "&&(b=b.slice(1)),++p,b.length){var m={v:b,t:"s"};Array.isArray(l)?l[f][p]=m:l[sr({r:f,c:p})]=m}break}A=h.lastIndex}p>d.e.c&&(d.e.c=p)}),l["!ref"]=fr(d),l}function r(s,i){return ed(e(s,i),i)}function a(s){for(var i=["{\\rtf1\\ansi"],o=Or(s["!ref"]),l,c=Array.isArray(s),d=o.s.r;d<=o.e.r;++d){i.push("\\trowd\\trautofit1");for(var u=o.s.c;u<=o.e.c;++u)i.push("\\cellx"+(u+1));for(i.push("\\pard\\intbl"),u=o.s.c;u<=o.e.c;++u){var f=sr({r:d,c:u});l=c?(s[d]||[])[u]:s[f],!(!l||l.v==null&&(!l.f||l.F))&&(i.push(" "+(l.w||(Ql(l),l.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:a}}();function Une(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function N0(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function Rne(e){var t=e[0]/255,r=e[1]/255,a=e[2]/255,s=Math.max(t,r,a),i=Math.min(t,r,a),o=s-i;if(o===0)return[0,0,t];var l=0,c=0,d=s+i;switch(c=o/(d>1?2-d:d),s){case t:l=((r-a)/o+6)%6;break;case r:l=(a-t)/o+2;break;case a:l=(t-r)/o+4;break}return[l/6,c,d/2]}function Mne(e){var t=e[0],r=e[1],a=e[2],s=r*2*(a<.5?a:1-a),i=a-s/2,o=[i,i,i],l=6*t,c;if(r!==0)switch(l|0){case 0:case 6:c=s*l,o[0]+=s,o[1]+=c;break;case 1:c=s*(2-l),o[0]+=c,o[1]+=s;break;case 2:c=s*(l-2),o[1]+=s,o[2]+=c;break;case 3:c=s*(4-l),o[1]+=c,o[2]+=s;break;case 4:c=s*(l-4),o[2]+=s,o[0]+=c;break;case 5:c=s*(6-l),o[2]+=c,o[0]+=s;break}for(var d=0;d!=3;++d)o[d]=Math.round(o[d]*255);return o}function mx(e,t){if(t===0)return e;var r=Rne(Une(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),N0(Mne(r))}var yI=6,Qne=15,Hne=1,ds=yI;function j0(e){return Math.floor((e+Math.round(128/ds)/256)*ds)}function k0(e){return Math.floor((e-5)/ds*100+.5)/100}function gx(e){return Math.round((e*ds+5)/ds*256)/256}function T1(e){return gx(k0(j0(e)))}function M2(e){var t=Math.abs(e-T1(e)),r=ds;if(t>.005)for(ds=Hne;ds<Qne;++ds)Math.abs(e-T1(e))<=t&&(t=Math.abs(e-T1(e)),r=ds);ds=r}function Wc(e){e.width?(e.wpx=j0(e.width),e.wch=k0(e.wpx),e.MDW=ds):e.wpx?(e.wch=k0(e.wpx),e.width=gx(e.wch),e.MDW=ds):typeof e.wch=="number"&&(e.width=gx(e.wch),e.wpx=j0(e.width),e.MDW=ds),e.customWidth&&delete e.customWidth}var qne=96,vI=qne;function C0(e){return e*96/vI}function QA(e){return e*vI/96}var $ne={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function Kne(e,t,r,a){t.Borders=[];var s={},i=!1;(e[0].match(ms)||[]).forEach(function(o){var l=or(o);switch(el(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},l.diagonalUp&&(s.diagonalUp=fn(l.diagonalUp)),l.diagonalDown&&(s.diagonalDown=fn(l.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+l[0]+" in borders")}})}function Vne(e,t,r,a){t.Fills=[];var s={},i=!1;(e[0].match(ms)||[]).forEach(function(o){var l=or(o);switch(el(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":l.patternType&&(s.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),l.indexed&&(s.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(s.bgColor.theme=parseInt(l.theme,10)),l.tint&&(s.bgColor.tint=parseFloat(l.tint)),l.rgb&&(s.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),l.theme&&(s.fgColor.theme=parseInt(l.theme,10)),l.tint&&(s.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(s.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+l[0]+" in fills")}})}function Wne(e,t,r,a){t.Fonts=[];var s={},i=!1;(e[0].match(ms)||[]).forEach(function(o){var l=or(o);switch(el(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":l.val&&(s.name=Jr(l.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=l.val?fn(l.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=l.val?fn(l.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(l.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=l.val?fn(l.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=l.val?fn(l.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=l.val?fn(l.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=l.val?fn(l.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=l.val?fn(l.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":l.val&&(s.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(s.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(s.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(s.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=f2[parseInt(l.val,10)];break;case"<color":if(s.color||(s.color={}),l.auto&&(s.color.auto=fn(l.auto)),l.rgb)s.color.rgb=l.rgb.slice(-6);else if(l.indexed){s.color.index=parseInt(l.indexed,10);var c=Md[s.color.index];s.color.index==81&&(c=Md[1]),c||(c=Md[1]),s.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else l.theme&&(s.color.theme=parseInt(l.theme,10),l.tint&&(s.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=mx(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+l[0]+" in fonts")}})}function zne(e,t,r){t.NumberFmt=[];for(var a=Mn(nr),s=0;s<a.length;++s)t.NumberFmt[a[s]]=nr[a[s]];var i=e[0].match(ms);if(i)for(s=0;s<i.length;++s){var o=or(i[s]);switch(el(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=Dr(Jr(o.formatCode)),c=parseInt(o.numFmtId,10);if(t.NumberFmt[c]=l,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=l}Tl(l,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function Gne(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)e[a]!=null&&(t[t.length]=St("numFmt",null,{numFmtId:a,formatCode:Gr(e[a])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=St("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Om=["numFmtId","fillId","fontId","borderId","xfId"],Um=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function Xne(e,t,r){t.CellXf=[];var a,s=!1;(e[0].match(ms)||[]).forEach(function(i){var o=or(i),l=0;switch(el(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=o,delete a[0],l=0;l<Om.length;++l)a[Om[l]]&&(a[Om[l]]=parseInt(a[Om[l]],10));for(l=0;l<Um.length;++l)a[Um[l]]&&(a[Um[l]]=fn(a[Um[l]]));if(t.NumberFmt&&a.numFmtId>392){for(l=392;l>60;--l)if(t.NumberFmt[a.numFmtId]==t.NumberFmt[l]){a.numFmtId=l;break}}t.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};o.vertical&&(c.vertical=o.vertical),o.horizontal&&(c.horizontal=o.horizontal),o.textRotation!=null&&(c.textRotation=o.textRotation),o.indent&&(c.indent=o.indent),o.wrapText&&(c.wrapText=fn(o.wrapText)),a.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function Yne(e){var t=[];return t[t.length]=St("cellXfs",null),e.forEach(function(r){t[t.length]=St("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=St("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Jne=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,c,d){var u={};if(!l)return u;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=l.match(t))&&zne(f,u,d),(f=l.match(s))&&Wne(f,u,c,d),(f=l.match(a))&&Vne(f,u,c,d),(f=l.match(i))&&Kne(f,u,c,d),(f=l.match(r))&&Xne(f,u,d),u}}();function bI(e,t){var r=[ea,St("styleSheet",null,{xmlns:lu[0],"xmlns:vt":wa.vt})],a;return e.SSF&&(a=Gne(e.SSF))!=null&&(r[r.length]=a),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=Yne(t.cellXfs))&&(r[r.length]=a),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Zne(e,t){var r=e.read_shift(2),a=hs(e);return[r,a]}function eae(e,t,r){r||(r=ct(6+4*t.length)),r.write_shift(2,e),Ia(t,r);var a=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),a}function tae(e,t,r){var a={};a.sz=e.read_shift(2)/20;var s=Pee(e);s.fItalic&&(a.italic=1),s.fCondense&&(a.condense=1),s.fExtend&&(a.extend=1),s.fShadow&&(a.shadow=1),s.fOutline&&(a.outline=1),s.fStrikeout&&(a.strike=1);var i=e.read_shift(2);switch(i===700&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(a.underline=o);var l=e.read_shift(1);l>0&&(a.family=l);var c=e.read_shift(1);switch(c>0&&(a.charset=c),e.l++,a.color=Lee(e),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=hs(e),a}function rae(e,t){t||(t=ct(25+4*32)),t.write_shift(2,e.sz*20),Oee(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),hx(e.color,t);var a=0;return a=2,t.write_shift(1,a),Ia(e.name,t),t.length>t.l?t.slice(0,t.l):t}var nae=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],I1,aae=ps;function mS(e,t){t||(t=ct(4*3+8*7+16*1)),I1||(I1=ly(nae));var r=I1[e.patternType];r==null&&(r=40),t.write_shift(4,r);var a=0;if(r!=40)for(hx({auto:1},t),hx({auto:1},t);a<12;++a)t.write_shift(4,0);else{for(;a<4;++a)t.write_shift(4,0);for(;a<12;++a)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function sae(e,t){var r=e.l+t,a=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:a,numFmtId:s}}function _I(e,t,r){r||(r=ct(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var a=0;return r.write_shift(1,a),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Yh(e,t){return t||(t=ct(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var iae=ps;function oae(e,t){return t||(t=ct(51)),t.write_shift(1,0),Yh(null,t),Yh(null,t),Yh(null,t),Yh(null,t),Yh(null,t),t.length>t.l?t.slice(0,t.l):t}function lae(e,t){return t||(t=ct(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Ax(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function cae(e,t,r){var a=ct(2052);return a.write_shift(4,e),Ax(t,a),Ax(r,a),a.length>a.l?a.slice(0,a.l):a}function dae(e,t,r){var a={};a.NumberFmt=[];for(var s in nr)a.NumberFmt[s]=nr[s];a.CellXf=[],a.Fonts=[];var i=[],o=!1;return Wl(e,function(c,d,u){switch(u){case 44:a.NumberFmt[c[0]]=c[1],Tl(c[1],c[0]);break;case 43:a.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=mx(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&a.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:i.push(u),o=!0;break;case 38:i.pop(),o=!1;break;default:if(d.T>0)i.push(u);else if(d.T<0)i.pop();else if(!o||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),a}function uae(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)t[s]!=null&&++r}),r!=0&&(xt(e,615,xo(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)t[s]!=null&&xt(e,44,eae(s,t[s]))}),xt(e,616))}}function Aae(e){var t=1;xt(e,611,xo(t)),xt(e,43,rae({sz:12,color:{theme:1},name:"Calibri",family:2})),xt(e,612)}function hae(e){var t=2;xt(e,603,xo(t)),xt(e,45,mS({patternType:"none"})),xt(e,45,mS({patternType:"gray125"})),xt(e,604)}function fae(e){var t=1;xt(e,613,xo(t)),xt(e,46,oae()),xt(e,614)}function pae(e){var t=1;xt(e,626,xo(t)),xt(e,47,_I({numFmtId:0},65535)),xt(e,627)}function mae(e,t){xt(e,617,xo(t.length)),t.forEach(function(r){xt(e,47,_I(r,0))}),xt(e,618)}function gae(e){var t=1;xt(e,619,xo(t)),xt(e,48,lae({xfId:0,name:"Normal"})),xt(e,620)}function xae(e){var t=0;xt(e,505,xo(t)),xt(e,506)}function yae(e){var t=0;xt(e,508,cae(t,"TableStyleMedium9","PivotStyleMedium4")),xt(e,509)}function vae(e,t){var r=Vs();return xt(r,278),uae(r,e.SSF),Aae(r),hae(r),fae(r),pae(r),mae(r,t.cellXfs),gae(r),xae(r),yae(r),xt(r,279),r.end()}var bae=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function _ae(e,t,r){t.themeElements.clrScheme=[];var a={};(e[0].match(ms)||[]).forEach(function(s){var i=or(s);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=i.val;break;case"<a:sysClr":a.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[bae.indexOf(i[0])]=a,a={}):a.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function wae(){}function Nae(){}var jae=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,kae=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Cae=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Sae(e,t,r){t.themeElements={};var a;[["clrScheme",jae,_ae],["fontScheme",kae,wae],["fmtScheme",Cae,Nae]].forEach(function(s){if(!(a=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](a,t,r)})}var Bae=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function wI(e,t){(!e||e.length===0)&&(e=Q2());var r,a={};if(!(r=e.match(Bae)))throw new Error("themeElements not found in theme");return Sae(r[0],a,t),a.raw=e,a}function Q2(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[ea];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Eae(e,t,r){var a=e.l+t,s=e.read_shift(4);if(s!==124226){if(!r.cellStyles){e.l=a;return}var i=e.slice(e.l);e.l=a;var o;try{o=pT(i,{type:"array"})}catch{return}var l=Ai(o,"theme/theme/theme1.xml",!0);if(l)return wI(l,r)}}function Fae(e){return e.read_shift(4)}function Tae(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=Iae(e,4);break;case 2:t.xclrValue=rI(e);break;case 3:t.xclrValue=Fae(e);break;case 4:e.l+=4;break}return e.l+=8,t}function Iae(e,t){return ps(e,t)}function Dae(e,t){return ps(e,t)}function Lae(e){var t=e.read_shift(2),r=e.read_shift(2)-4,a=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=Tae(e);break;case 6:a[1]=Dae(e,r);break;case 14:case 15:a[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return a}function Pae(e,t){var r=e.l+t;e.l+=2;var a=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),i=[];s-- >0;)i.push(Lae(e,r-e.l));return{ixfe:a,ext:i}}function Oae(e,t){t.forEach(function(r){switch(r[0]){}})}function Uae(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:hs(e)}}function Rae(e){var t=ct(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Ia(e.name,t),t.slice(0,t.l)}function Mae(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Qae(e){var t=ct(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function Hae(e,t){var r=ct(8+2*t.length);return r.write_shift(4,e),Ia(t,r),r.slice(0,r.l)}function qae(e){return e.l+=4,e.read_shift(4)!=0}function $ae(e,t){var r=ct(8);return r.write_shift(4,e),r.write_shift(4,1),r}function Kae(e,t,r){var a={Types:[],Cell:[],Value:[]},s=r||{},i=[],o=!1,l=2;return Wl(e,function(c,d,u){switch(u){case 335:a.Types.push({name:c.name});break;case 51:c.forEach(function(f){l==1?a.Cell.push({type:a.Types[f[0]-1].name,index:f[1]}):l==0&&a.Value.push({type:a.Types[f[0]-1].name,index:f[1]})});break;case 337:l=c?1:0;break;case 338:l=2;break;case 35:i.push(u),o=!0;break;case 36:i.pop(),o=!1;break;default:if(!d.T){if(!o||s.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),a}function Vae(){var e=Vs();return xt(e,332),xt(e,334,xo(1)),xt(e,335,Rae({name:"XLDAPR",version:12e4,flags:3496657072})),xt(e,336),xt(e,339,Hae(1,"XLDAPR")),xt(e,52),xt(e,35,xo(514)),xt(e,4096,xo(0)),xt(e,4097,Ii(1)),xt(e,36),xt(e,53),xt(e,340),xt(e,337,$ae(1)),xt(e,51,Qae([[1,0]])),xt(e,338),xt(e,333),e.end()}function Wae(e,t,r){var a={Types:[],Cell:[],Value:[]};if(!e)return a;var s=!1,i=2,o;return e.replace(ms,function(l){var c=or(l);switch(el(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<a.Types.length;++d)a.Types[d].name==c.name&&(o=a.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?a.Cell.push({type:a.Types[c.t-1].name,index:+c.v}):i==0&&a.Value.push({type:a.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+c.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return l}),a}function NI(){var e=[ea];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function zae(e){var t=[];if(!e)return t;var r=1;return(e.match(ms)||[]).forEach(function(a){var s=or(a);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,t.push(s);break}}),t}function Gae(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=sr(r);var a=e.read_shift(1);return a&2&&(t.l="1"),a&8&&(t.a="1"),t}function Xae(e,t,r){var a=[];return Wl(e,function(i,o,l){switch(l){case 63:a.push(i);break;default:if(!o.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),a}function Yae(e,t,r,a){if(!e)return e;var s=a||{},i=!1;Wl(e,function(l,c,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!c.T){if(!i||s.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},s)}function Jae(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var AA=1024;function jI(e,t){for(var r=[21600,21600],a=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[St("xml",null,{"xmlns:v":li.v,"xmlns:o":li.o,"xmlns:x":li.x,"xmlns:mv":li.mv}).replace(/\/>/,">"),St("o:shapelayout",St("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),St("v:shapetype",[St("v:stroke",null,{joinstyle:"miter"}),St("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:a})];AA<e*1e3;)AA+=1e3;return t.forEach(function(i){var o=Cn(i[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?St("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=St("v:fill",c,l),u={on:"t",obscured:"t"};++AA,s=s.concat(["<v:shape"+b0({id:"_x0000_s"+AA,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,St("v:shadow",null,u),St("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Va("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),Va("x:AutoFill","False"),Va("x:Row",String(o.r)),Va("x:Column",String(o.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function gS(e,t,r,a){var s=Array.isArray(e),i;t.forEach(function(o){var l=Cn(o.ref);if(s?(e[l.r]||(e[l.r]=[]),i=e[l.r][l.c]):i=e[o.ref],!i){i={t:"z"},s?e[l.r][l.c]=i:e[o.ref]=i;var c=Or(e["!ref"]||"BDWGO1000001:A1");c.s.r>l.r&&(c.s.r=l.r),c.e.r<l.r&&(c.e.r=l.r),c.s.c>l.c&&(c.s.c=l.c),c.e.c<l.c&&(c.e.c=l.c);var d=fr(c);d!==e["!ref"]&&(e["!ref"]=d)}i.c||(i.c=[]);var u={a:o.author,t:o.t,r:o.r,T:r};o.h&&(u.h=o.h);for(var f=i.c.length-1;f>=0;--f){if(!r&&i.c[f].T)return;r&&!i.c[f].T&&i.c.splice(f,1)}if(r&&a){for(f=0;f<a.length;++f)if(u.a==a[f].id){u.a=a[f].name||u.a;break}}i.c.push(u)})}function Zae(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],a=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?comment[^>]*>/);if(l){var c=or(l[0]),d={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},u=Cn(c.ref);if(!(t.sheetRows&&t.sheetRows<=u.r)){var f=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!f&&!!f[1]&&U2(f[1])||{r:"",t:"",h:""};d.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),d.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(d.h=h.h),a.push(d)}}}}),a}function kI(e){var t=[ea,St("comments",null,{xmlns:lu[0]})],r=[];return t.push("<authors>"),e.forEach(function(a){a[1].forEach(function(s){var i=Gr(s.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(a){var s=0,i=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?s=r.indexOf("tc="+a[1][0].ID):a[1].forEach(function(c){c.a&&(s=r.indexOf(Gr(c.a))),i.push(c.t||"")}),t.push('<comment ref="'+a[0]+'" authorId="'+s+'"><text>'),i.length<=1)t.push(Va("t",Gr(i[0]||"")));else{for(var o=`Comment:
    `+i[0]+`
`,l=1;l<i.length;++l)o+=`Reply:
    `+i[l]+`
`;t.push(Va("t",Gr(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function ese(e,t){var r=[],a=!1,s={},i=0;return e.replace(ms,function(l,c){var d=or(l);switch(el(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":i=c+l.length;break;case"</text>":s.t=e.slice(i,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return l}),r}function tse(e,t,r){var a=[ea,St("ThreadedComments",null,{xmlns:wa.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var i="";(s[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var c={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?i=c.id:c.parentId=i,o.ID=c.id,o.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),a.push(St("threadedComment",Va("text",o.t||""),c))})}),a.push("</ThreadedComments>"),a.join("")}function rse(e,t){var r=[],a=!1;return e.replace(ms,function(i){var o=or(i);switch(el(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return i}),r}function nse(e){var t=[ea,St("personList",null,{xmlns:wa.TCMNT,"xmlns:x":lu[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,a){t.push(St("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function ase(e){var t={};t.iauthor=e.read_shift(4);var r=Au(e);return t.rfx=r.s,t.ref=sr(r.s),e.l+=16,t}function sse(e,t){return t==null&&(t=ct(36)),t.write_shift(4,e[1].iauthor),nh(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var ise=hs;function ose(e){return Ia(e.slice(0,54))}function lse(e,t){var r=[],a=[],s={},i=!1;return Wl(e,function(l,c,d){switch(d){case 632:a.push(l);break;case 635:s=l;break;case 637:s.t=l.t,s.h=l.h,s.r=l.r;break;case 636:if(s.author=a[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}function cse(e){var t=Vs(),r=[];return xt(t,628),xt(t,630),e.forEach(function(a){a[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),xt(t,632,ose(s.a)))})}),xt(t,631),xt(t,633),e.forEach(function(a){a[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var i={s:Cn(a[0]),e:Cn(a[0])};xt(t,635,sse([i,s])),s.t&&s.t.length>0&&xt(t,637,Fee(s)),xt(t,636),delete s.iauthor})}),xt(t,634),xt(t,629),t.end()}var dse="application/vnd.ms-office.vbaProject";function use(e){var t=er.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,a){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");er.utils.cfb_add(t,s,e.FileIndex[a].content)}}),er.write(t)}function Ase(e,t){t.FullPaths.forEach(function(r,a){if(a!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&er.utils.cfb_add(e,s,t.FileIndex[a].content)}})}var CI=["xlsb","xlsm","xlam","biff8","xla"];function hse(){return{"!type":"dialog"}}function fse(){return{"!type":"dialog"}}function pse(){return{"!type":"macro"}}function mse(){return{"!type":"macro"}}var SA=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(a,s,i,o){var l=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var d=i.length>0?parseInt(i,10)|0:0,u=o.length>0?parseInt(o,10)|0:0;return l?u+=t.c:--u,c?d+=t.r:--d,s+(l?"":"$")+kn(u)+(c?"":"$")+Jn(d)}return function(s,i){return t=i,s.replace(e,r)}}(),H2=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,q2=function(){return function(t,r){return t.replace(H2,function(a,s,i,o,l,c){var d=B2(o)-(i?0:r.c),u=S2(c)-(l?0:r.r),f=u==0?"":l?u+1:"["+u+"]",h=d==0?"":i?d+1:"["+d+"]";return s+"R"+f+"C"+h})}}();function SI(e,t){return e.replace(H2,function(r,a,s,i,o,l){return a+(s=="$"?s+i:kn(B2(i)+t.c))+(o=="$"?o+l:Jn(S2(l)+t.r))})}function gse(e,t,r){var a=Ws(t),s=a.s,i=Cn(r),o={r:i.r-s.r,c:i.c-s.c};return SI(e,o)}function xse(e){return e.length!=1}function xS(e){return e.replace(/_xlfn\./g,"")}function aa(e){e.l+=1}function zc(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function BI(e,t,r){var a=2;if(r){if(r.biff>=2&&r.biff<=5)return EI(e);r.biff==12&&(a=4)}var s=e.read_shift(a),i=e.read_shift(a),o=zc(e),l=zc(e);return{s:{r:s,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:l[0],cRel:l[1],rRel:l[2]}}}function EI(e){var t=zc(e),r=zc(e),a=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:a,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function yse(e,t,r){if(r.biff<8)return EI(e);var a=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),i=zc(e),o=zc(e);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function FI(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return vse(e);var a=e.read_shift(r&&r.biff==12?4:2),s=zc(e);return{r:a,c:s[0],cRel:s[1],rRel:s[2]}}function vse(e){var t=zc(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function bse(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function _se(e,t,r){var a=r&&r.biff?r.biff:8;if(a>=2&&a<=5)return wse(e);var s=e.read_shift(a>=12?4:2),i=e.read_shift(2),o=(i&16384)>>14,l=(i&32768)>>15;if(i&=16383,l==1)for(;s>524287;)s-=1048576;if(o==1)for(;i>8191;)i=i-16384;return{r:s,c:i,cRel:o,rRel:l}}function wse(e){var t=e.read_shift(2),r=e.read_shift(1),a=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,a==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:a}}function Nse(e,t,r){var a=(e[e.l++]&96)>>5,s=BI(e,r.biff>=2&&r.biff<=5?6:8,r);return[a,s]}function jse(e,t,r){var a=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var o=BI(e,i,r);return[a,s,o]}function kse(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[a]}function Cse(e,t,r){var a=(e[e.l++]&96)>>5,s=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[a,s]}function Sse(e,t,r){var a=(e[e.l++]&96)>>5,s=yse(e,t-1,r);return[a,s]}function Bse(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[a]}function yS(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function Ese(e,t,r){e.l+=2;for(var a=e.read_shift(r&&r.biff==2?1:2),s=[],i=0;i<=a;++i)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function Fse(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function Tse(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function Ise(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function Dse(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[a]}function TI(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function Lse(e){return e.read_shift(2),TI(e)}function Pse(e){return e.read_shift(2),TI(e)}function Ose(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=FI(e,0,r);return[a,s]}function Use(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=_se(e,0,r);return[a,s]}function Rse(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=FI(e,0,r);return[a,s,i]}function Mse(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[qie[s],LI[s],a]}function Qse(e,t,r){var a=e[e.l++],s=e.read_shift(1),i=r&&r.biff<=3?[a==88?-1:0,e.read_shift(1)]:Hse(e);return[s,(i[0]===0?LI:Hie)[i[1]]]}function Hse(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function qse(e,t,r){e.l+=r&&r.biff==2?3:4}function $se(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var a=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[a,s]}function Kse(e){return e.l++,zl[e.read_shift(1)]}function Vse(e){return e.l++,e.read_shift(2)}function Wse(e){return e.l++,e.read_shift(1)!==0}function zse(e){return e.l++,As(e)}function Gse(e,t,r){return e.l++,$0(e,t-1,r)}function Xse(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Vn(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=zl[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=As(e);break;case 2:r[1]=hu(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Yse(e,t,r){for(var a=e.read_shift(r.biff==12?4:2),s=[],i=0;i!=a;++i)s.push((r.biff==12?Au:uy)(e));return s}function Jse(e,t,r){var a=0,s=0;r.biff==12?(a=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),a=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--a,--s==0&&(s=256));for(var i=0,o=[];i!=a&&(o[i]=[]);++i)for(var l=0;l!=s;++l)o[i][l]=Xse(e,r.biff);return o}function Zse(e,t,r){var a=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,i=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[a,0,i]}function eie(e,t,r){if(r.biff==5)return tie(e);var a=e.read_shift(1)>>>5&3,s=e.read_shift(2),i=e.read_shift(4);return[a,s,i]}function tie(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[t,r,a]}function rie(e,t,r){var a=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[a,s]}function nie(e,t,r){var a=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[a,s]}function aie(e,t,r){var a=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[a]}function sie(e,t,r){var a=(e[e.l++]&96)>>5,s=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[a,s]}var iie=ps,oie=ps,lie=ps;function V0(e,t,r){return e.l+=2,[bse(e)]}function $2(e){return e.l+=6,[]}var cie=V0,die=$2,uie=$2,Aie=V0;function II(e){return e.l+=2,[ia(e),e.read_shift(2)&1]}var hie=V0,fie=II,pie=$2,mie=V0,gie=V0,xie=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function yie(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),s=e.read_shift(2),i=e.read_shift(2),o=xie[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:a,c:s,C:i}}function vie(e){return e.l+=2,[e.read_shift(4)]}function bie(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function _ie(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function wie(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Nie(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function jie(e){return e.l+=4,[0,0]}var vS={1:{n:"PtgExp",f:$se},2:{n:"PtgTbl",f:lie},3:{n:"PtgAdd",f:aa},4:{n:"PtgSub",f:aa},5:{n:"PtgMul",f:aa},6:{n:"PtgDiv",f:aa},7:{n:"PtgPower",f:aa},8:{n:"PtgConcat",f:aa},9:{n:"PtgLt",f:aa},10:{n:"PtgLe",f:aa},11:{n:"PtgEq",f:aa},12:{n:"PtgGe",f:aa},13:{n:"PtgGt",f:aa},14:{n:"PtgNe",f:aa},15:{n:"PtgIsect",f:aa},16:{n:"PtgUnion",f:aa},17:{n:"PtgRange",f:aa},18:{n:"PtgUplus",f:aa},19:{n:"PtgUminus",f:aa},20:{n:"PtgPercent",f:aa},21:{n:"PtgParen",f:aa},22:{n:"PtgMissArg",f:aa},23:{n:"PtgStr",f:Gse},26:{n:"PtgSheet",f:bie},27:{n:"PtgEndSheet",f:_ie},28:{n:"PtgErr",f:Kse},29:{n:"PtgBool",f:Wse},30:{n:"PtgInt",f:Vse},31:{n:"PtgNum",f:zse},32:{n:"PtgArray",f:Bse},33:{n:"PtgFunc",f:Mse},34:{n:"PtgFuncVar",f:Qse},35:{n:"PtgName",f:Zse},36:{n:"PtgRef",f:Ose},37:{n:"PtgArea",f:Nse},38:{n:"PtgMemArea",f:rie},39:{n:"PtgMemErr",f:iie},40:{n:"PtgMemNoMem",f:oie},41:{n:"PtgMemFunc",f:nie},42:{n:"PtgRefErr",f:aie},43:{n:"PtgAreaErr",f:kse},44:{n:"PtgRefN",f:Use},45:{n:"PtgAreaN",f:Sse},46:{n:"PtgMemAreaN",f:wie},47:{n:"PtgMemNoMemN",f:Nie},57:{n:"PtgNameX",f:eie},58:{n:"PtgRef3d",f:Rse},59:{n:"PtgArea3d",f:jse},60:{n:"PtgRefErr3d",f:sie},61:{n:"PtgAreaErr3d",f:Cse},255:{}},kie={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Cie={1:{n:"PtgElfLel",f:II},2:{n:"PtgElfRw",f:mie},3:{n:"PtgElfCol",f:cie},6:{n:"PtgElfRwV",f:gie},7:{n:"PtgElfColV",f:Aie},10:{n:"PtgElfRadical",f:hie},11:{n:"PtgElfRadicalS",f:pie},13:{n:"PtgElfColS",f:die},15:{n:"PtgElfColSV",f:uie},16:{n:"PtgElfRadicalLel",f:fie},25:{n:"PtgList",f:yie},29:{n:"PtgSxName",f:vie},255:{}},Sie={0:{n:"PtgAttrNoop",f:jie},1:{n:"PtgAttrSemi",f:Dse},2:{n:"PtgAttrIf",f:Tse},4:{n:"PtgAttrChoose",f:Ese},8:{n:"PtgAttrGoto",f:Fse},16:{n:"PtgAttrSum",f:qse},32:{n:"PtgAttrBaxcel",f:yS},33:{n:"PtgAttrBaxcel",f:yS},64:{n:"PtgAttrSpace",f:Lse},65:{n:"PtgAttrSpaceSemi",f:Pse},128:{n:"PtgAttrIfError",f:Ise},255:{}};function W0(e,t,r,a){if(a.biff<8)return ps(e,t);for(var s=e.l+t,i=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=Jse(e,0,a),i.push(r[o][1]);break;case"PtgMemArea":r[o][2]=Yse(e,r[o][1],a),i.push(r[o][2]);break;case"PtgExp":a&&a.biff==12&&(r[o][1][1]=e.read_shift(4),i.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=s-e.l,t!==0&&i.push(ps(e,t)),i}function z0(e,t,r){for(var a=e.l+t,s,i,o=[];a!=e.l;)t=a-e.l,i=e[e.l],s=vS[i]||vS[kie[i]],(i===24||i===25)&&(s=(i===24?Cie:Sie)[e[e.l+1]]),!s||!s.f?ps(e,t):o.push([s.n,s.f(e,t,r)]);return o}function Bie(e){for(var t=[],r=0;r<e.length;++r){for(var a=e[r],s=[],i=0;i<a.length;++i){var o=a[i];if(o)switch(o[0]){case 2:s.push('"'+o[1].replace(/"/g,'""')+'"');break;default:s.push(o[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var Eie={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Fie(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function DI(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!a)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[a[0]][0]){case 357:return s=a[1]==-1?"#REF":e.SheetNames[a[1]],a[1]==a[2]?s:s+":"+e.SheetNames[a[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[a[0]][0];case 355:default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return s=a[1]==-1?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?s:s+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[a[0]][0][3]?(s=a[1]==-1?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?s:s+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function bS(e,t,r){var a=DI(e,t,r);return a=="#REF"?a:Fie(a,r)}function ls(e,t,r,a,s){var i=s&&s.biff||8,o={s:{c:0,r:0}},l=[],c,d,u,f=0,h=0,A,x="";if(!e[0]||!e[0][0])return"";for(var p=-1,b="",m=0,g=e[0].length;m<g;++m){var y=e[0][m];switch(y[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),d=l.pop(),p>=0){switch(e[0][p][1][0]){case 0:b=On(" ",e[0][p][1][1]);break;case 1:b=On("\r",e[0][p][1][1]);break;default:if(b="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}d=d+b,p=-1}l.push(d+Eie[y[0]]+c);break;case"PtgIsect":c=l.pop(),d=l.pop(),l.push(d+" "+c);break;case"PtgUnion":c=l.pop(),d=l.pop(),l.push(d+","+c);break;case"PtgRange":c=l.pop(),d=l.pop(),l.push(d+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=Lf(y[1][1],o,s),l.push(Pf(u,i));break;case"PtgRefN":u=r?Lf(y[1][1],r,s):y[1][1],l.push(Pf(u,i));break;case"PtgRef3d":f=y[1][1],u=Lf(y[1][2],o,s),x=bS(a,f,s),l.push(x+"!"+Pf(u,i));break;case"PtgFunc":case"PtgFuncVar":var v=y[1][0],_=y[1][1];v||(v=0),v&=127;var j=v==0?[]:l.slice(-v);l.length-=v,_==="User"&&(_=j.shift()),l.push(_+"("+j.join(",")+")");break;case"PtgBool":l.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(y[1]);break;case"PtgNum":l.push(String(y[1]));break;case"PtgStr":l.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(y[1]);break;case"PtgAreaN":A=XC(y[1][1],r?{s:r}:o,s),l.push(B1(A,s));break;case"PtgArea":A=XC(y[1][1],o,s),l.push(B1(A,s));break;case"PtgArea3d":f=y[1][1],A=y[1][2],x=bS(a,f,s),l.push(x+"!"+B1(A,s));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=y[1][2];var N=(a.names||[])[h-1]||(a[0]||[])[h],B=N?N.Name:"SH33TJSNAME"+String(h);B&&B.slice(0,6)=="_xlfn."&&!s.xlfn&&(B=B.slice(6)),l.push(B);break;case"PtgNameX":var E=y[1][1];h=y[1][2];var C;if(s.biff<=5)E<0&&(E=-E),a[E]&&(C=a[E][h]);else{var k="";if(((a[E]||[])[0]||[])[0]==14849||(((a[E]||[])[0]||[])[0]==1025?a[E][h]&&a[E][h].itab>0&&(k=a.SheetNames[a[E][h].itab-1]+"!"):k=a.SheetNames[h-1]+"!"),a[E]&&a[E][h])k+=a[E][h].Name;else if(a[0]&&a[0][h])k+=a[0][h].Name;else{var w=(DI(a,E,s)||"").split(";;");w[h-1]?k=w[h-1]:k+="SH33TJSERRX"}l.push(k);break}C||(C={Name:"SH33TJSERRY"}),l.push(C.Name);break;case"PtgParen":var T="(",R=")";if(p>=0){switch(b="",e[0][p][1][0]){case 2:T=On(" ",e[0][p][1][1])+T;break;case 3:T=On("\r",e[0][p][1][1])+T;break;case 4:R=On(" ",e[0][p][1][1])+R;break;case 5:R=On("\r",e[0][p][1][1])+R;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}l.push(T+l.pop()+R);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":u={c:y[1][1],r:y[1][0]};var q={c:r.c,r:r.r};if(a.sharedf[sr(u)]){var z=a.sharedf[sr(u)];l.push(ls(z,o,q,a,s))}else{var ee=!1;for(c=0;c!=a.arrayf.length;++c)if(d=a.arrayf[c],!(u.c<d[0].s.c||u.c>d[0].e.c)&&!(u.r<d[0].s.r||u.r>d[0].e.r)){l.push(ls(d[1],o,q,a,s)),ee=!0;break}ee||l.push(y[1])}break;case"PtgArray":l.push("{"+Bie(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=m;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var Y=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&p>=0&&Y.indexOf(e[0][m][0])==-1){y=e[0][p];var G=!0;switch(y[1][0]){case 4:G=!1;case 0:b=On(" ",y[1][1]);break;case 5:G=!1;case 1:b=On("\r",y[1][1]);break;default:if(b="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}l.push((G?b:"")+l.pop()+(G?"":b)),p=-1}}if(l.length>1&&s.WTF)throw new Error("bad formula stack");return l[0]}function Tie(e,t,r){var a=e.l+t,s=r.biff==2?1:2,i,o=e.read_shift(s);if(o==65535)return[[],ps(e,t-2)];var l=z0(e,o,r);return t!==o+s&&(i=W0(e,t-o-s,l,r)),e.l=a,[l,i]}function Iie(e,t,r){var a=e.l+t,s=r.biff==2?1:2,i,o=e.read_shift(s);if(o==65535)return[[],ps(e,t-2)];var l=z0(e,o,r);return t!==o+s&&(i=W0(e,t-o-s,l,r)),e.l=a,[l,i]}function Die(e,t,r,a){var s=e.l+t,i=z0(e,a,r),o;return s!==e.l&&(o=W0(e,s-e.l,i,r)),[i,o]}function Lie(e,t,r){var a=e.l+t,s,i=e.read_shift(2),o=z0(e,i,r);return i==65535?[[],ps(e,t-2)]:(t!==i+2&&(s=W0(e,a-i-2,o,r)),[o,s])}function Pie(e){var t;if(Sl(e,e.l+6)!==65535)return[As(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function Oie(e){if(e==null){var t=ct(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return eu(e);return eu(0)}function D1(e,t,r){var a=e.l+t,s=tl(e);r.biff==2&&++e.l;var i=Pie(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var l=Iie(e,a-e.l,r);return{cell:s,val:i[0],formula:l,shared:o>>3&1,tt:i[1]}}function Uie(e,t,r,a,s){var i=ru(t,r,s),o=Oie(e.v),l=ct(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var d=ct(e.bf.length),u=0;u<e.bf.length;++u)d[u]=e.bf[u];var f=Ta([i,o,l,d]);return f}function Ay(e,t,r){var a=e.read_shift(4),s=z0(e,a,r),i=e.read_shift(4),o=i>0?W0(e,i,s,r):null;return[s,o]}var Rie=Ay,hy=Ay,Mie=Ay,Qie=Ay,Hie={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},LI={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},qie={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function _S(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function $ie(e){var t="of:="+e.replace(H2,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function L1(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function Kie(e){return e.replace(/\./,"!")}var Uf={},BA={},Rf=typeof Map<"u";function K2(e,t,r){var a=0,s=e.length;if(r){if(Rf?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=Rf?r.get(t):r[t];a<i.length;++a)if(e[i[a]].t===t)return e.Count++,i[a]}}else for(;a<s;++a)if(e[a].t===t)return e.Count++,a;return e[s]={t},e.Count++,e.Unique++,r&&(Rf?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function fy(e,t){var r={min:e+1,max:e+1},a=-1;return t.MDW&&(ds=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?a=k0(t.wpx):t.wch!=null&&(a=t.wch),a>-1?(r.width=gx(a),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function qd(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function td(e,t,r){var a=r.revssf[t.z!=null?t.z:"General"],s=60,i=e.length;if(a==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){Tl(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=a=s;break}}for(s=0;s!=i;++s)if(e[s].numFmtId===a)return s;return e[i]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function PI(e,t,r,a,s,i){try{a.cellNF&&(e.z=nr[t])}catch(l){if(a.WTF)throw l}if(!(e.t==="z"&&!a.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=xn(e.v)),(!a||a.cellText!==!1)&&e.t!=="z")try{if(nr[t]==null&&Tl(HZ[t]||"General",t),e.t==="e")e.w=e.w||zl[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=y0(e.v);else if(e.t==="d"){var o=ka(e.v);(o|0)===o?e.w=o.toString(10):e.w=y0(o)}else{if(e.v===void 0)return"";e.w=Jd(e.v,BA)}else e.t==="d"?e.w=Wi(t,ka(e.v),BA):e.w=Wi(t,e.v,BA)}catch(l){if(a.WTF)throw l}if(a.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=mx(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),a.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=mx(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),a.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(l){if(a.WTF&&i.Fills)throw l}}}function Vie(e,t,r){if(e&&e["!ref"]){var a=Or(e["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function Wie(e,t){var r=Or(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=fr(r))}var zie=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Gie=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Xie=/<(?:\w:)?hyperlink [^>]*>/mg,Yie=/"(\w*:\w*)"/,Jie=/<(?:\w:)?col\b[^>]*[\/]?>/g,Zie=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,eoe=/<(?:\w:)?pageMargins[^>]*\/>/g,OI=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,toe=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,roe=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function noe(e,t,r,a,s,i,o){if(!e)return e;a||(a={"!id":{}});var l=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",u="",f=e.match(Gie);f?(d=e.slice(0,f.index),u=e.slice(f.index+f[0].length)):d=u=e;var h=d.match(OI);h?V2(h[0],l,s,r):(h=d.match(toe))&&soe(h[0],h[1]||"",l,s,r);var A=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(A>0){var x=d.slice(A,A+50).match(Yie);x&&Wie(l,x[1])}var p=d.match(roe);p&&p[1]&&xoe(p[1],s);var b=[];if(t.cellStyles){var m=d.match(Jie);m&&hoe(b,m)}f&&boe(f[1],l,t,c,i,o);var g=u.match(Zie);g&&(l["!autofilter"]=poe(g[0]));var y=[],v=u.match(zie);if(v)for(A=0;A!=v.length;++A)y[A]=Or(v[A].slice(v[A].indexOf('"')+1));var _=u.match(Xie);_&&doe(l,_,a);var j=u.match(eoe);if(j&&(l["!margins"]=uoe(or(j[0]))),!l["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(l["!ref"]=fr(c)),t.sheetRows>0&&l["!ref"]){var N=Or(l["!ref"]);t.sheetRows<=+N.e.r&&(N.e.r=t.sheetRows-1,N.e.r>c.e.r&&(N.e.r=c.e.r),N.e.r<N.s.r&&(N.s.r=N.e.r),N.e.c>c.e.c&&(N.e.c=c.e.c),N.e.c<N.s.c&&(N.s.c=N.e.c),l["!fullref"]=l["!ref"],l["!ref"]=fr(N))}return b.length>0&&(l["!cols"]=b),y.length>0&&(l["!merges"]=y),l}function aoe(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+fr(e[r])+'"/>';return t+"</mergeCells>"}function V2(e,t,r,a){var s=or(e);r.Sheets[a]||(r.Sheets[a]={}),s.codeName&&(r.Sheets[a].CodeName=Dr(Jr(s.codeName)))}function soe(e,t,r,a,s){V2(e.slice(0,e.indexOf(">")),r,a,s)}function ioe(e,t,r,a,s){var i=!1,o={},l=null;if(a.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}i=!0,o.codeName=qo(Gr(c))}if(e&&e["!outline"]){var d={summaryBelow:1,summaryRight:1};e["!outline"].above&&(d.summaryBelow=0),e["!outline"].left&&(d.summaryRight=0),l=(l||"")+St("outlinePr",null,d)}!i&&!l||(s[s.length]=St("sheetPr",l,o))}var ooe=["objects","scenarios","selectLockedCells","selectUnlockedCells"],loe=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function coe(e){var t={sheet:1};return ooe.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),loe.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=R2(e.password).toString(16).toUpperCase()),St("sheetProtection",null,t)}function doe(e,t,r){for(var a=Array.isArray(e),s=0;s!=t.length;++s){var i=or(Jr(t[s]),!0);if(!i.ref)return;var o=((r||{})["!id"]||[])[i.id];o?(i.Target=o.Target,i.location&&(i.Target+="#"+Dr(i.location))):(i.Target="#"+Dr(i.location),o={Target:i.Target,TargetMode:"Internal"}),i.Rel=o,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var l=Or(i.ref),c=l.s.r;c<=l.e.r;++c)for(var d=l.s.c;d<=l.e.c;++d){var u=sr({c:d,r:c});a?(e[c]||(e[c]=[]),e[c][d]||(e[c][d]={t:"z",v:void 0}),e[c][d].l=i):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=i)}}}function uoe(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function Aoe(e){return qd(e),St("pageMargins",null,e)}function hoe(e,t){for(var r=!1,a=0;a!=t.length;++a){var s=or(t[a],!0);s.hidden&&(s.hidden=fn(s.hidden));var i=parseInt(s.min,10)-1,o=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,M2(s.width)),Wc(s);i<=o;)e[i++]=yn(s)}}function foe(e,t){for(var r=["<cols>"],a,s=0;s!=t.length;++s)(a=t[s])&&(r[r.length]=St("col",null,fy(s,a)));return r[r.length]="</cols>",r.join("")}function poe(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function moe(e,t,r,a){var s=typeof e.ref=="string"?e.ref:fr(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=Ws(s);o.s.r==o.e.r&&(o.e.r=Ws(t["!ref"]).e.r,s=fr(o));for(var l=0;l<i.length;++l){var c=i[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==a){c.Ref="'"+r.SheetNames[a]+"'!"+s;break}}return l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+s}),St("autoFilter",null,{ref:s})}var goe=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function xoe(e,t){t.Views||(t.Views=[{}]),(e.match(goe)||[]).forEach(function(r,a){var s=or(r);t.Views[a]||(t.Views[a]={}),+s.zoomScale&&(t.Views[a].zoom=+s.zoomScale),fn(s.rightToLeft)&&(t.Views[a].RTL=!0)})}function yoe(e,t,r,a){var s={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),St("sheetViews",St("sheetView",null,s),{})}function voe(e,t,r,a){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",i=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=zl[e.v];break;case"d":a&&a.cellDates?s=xn(e.v,-1).toISOString():(e=yn(e),e.t="n",s=""+(e.v=ka(xn(e.v)))),typeof e.z>"u"&&(e.z=nr[14]);break;default:s=e.v;break}var l=Va("v",Gr(s)),c={r:t},d=td(a.cellXfs,e,a);switch(d!==0&&(c.s=d),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){l=Va("v",""+K2(a.Strings,e.v,a.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=i&&(e.t=i,e.v=o),typeof e.f=="string"&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;l=St("f",Gr(e.f),u)+(e.v!=null?l:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),St("c",l,c)}var boe=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,i=v0("v"),o=v0("f");return function(c,d,u,f,h,A){for(var x=0,p="",b=[],m=[],g=0,y=0,v=0,_="",j,N,B=0,E=0,C,k,w=0,T=0,R=Array.isArray(A.CellXf),q,z=[],ee=[],Y=Array.isArray(d),G=[],re={},U=!1,S=!!u.sheetStubs,D=c.split(t),L=0,P=D.length;L!=P;++L){p=D[L].trim();var I=p.length;if(I!==0){var H=0;e:for(x=0;x<I;++x)switch(p[x]){case">":if(p[x-1]!="/"){++x;break e}if(u&&u.cellStyles){if(N=or(p.slice(H,x),!0),B=N.r!=null?parseInt(N.r,10):B+1,E=-1,u.sheetRows&&u.sheetRows<B)continue;re={},U=!1,N.ht&&(U=!0,re.hpt=parseFloat(N.ht),re.hpx=QA(re.hpt)),N.hidden=="1"&&(U=!0,re.hidden=!0),N.outlineLevel!=null&&(U=!0,re.level=+N.outlineLevel),U&&(G[B-1]=re)}break;case"<":H=x;break}if(H>=x)break;if(N=or(p.slice(H,x),!0),B=N.r!=null?parseInt(N.r,10):B+1,E=-1,!(u.sheetRows&&u.sheetRows<B)){f.s.r>B-1&&(f.s.r=B-1),f.e.r<B-1&&(f.e.r=B-1),u&&u.cellStyles&&(re={},U=!1,N.ht&&(U=!0,re.hpt=parseFloat(N.ht),re.hpx=QA(re.hpt)),N.hidden=="1"&&(U=!0,re.hidden=!0),N.outlineLevel!=null&&(U=!0,re.level=+N.outlineLevel),U&&(G[B-1]=re)),b=p.slice(x).split(e);for(var V=0;V!=b.length&&b[V].trim().charAt(0)=="<";++V);for(b=b.slice(V),x=0;x!=b.length;++x)if(p=b[x].trim(),p.length!==0){if(m=p.match(r),g=x,y=0,v=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,m!=null&&m.length===2){for(g=0,_=m[1],y=0;y!=_.length&&!((v=_.charCodeAt(y)-64)<1||v>26);++y)g=26*g+v;--g,E=g}else++E;for(y=0;y!=p.length&&p.charCodeAt(y)!==62;++y);if(++y,N=or(p.slice(0,y),!0),N.r||(N.r=sr({r:B-1,c:E})),_=p.slice(y),j={t:""},(m=_.match(i))!=null&&m[1]!==""&&(j.v=Dr(m[1])),u.cellFormula){if((m=_.match(o))!=null&&m[1]!==""){if(j.f=Dr(Jr(m[1])).replace(/\r\n/g,`
`),u.xlfn||(j.f=xS(j.f)),m[0].indexOf('t="array"')>-1)j.F=(_.match(s)||[])[1],j.F.indexOf(":")>-1&&z.push([Or(j.F),j.F]);else if(m[0].indexOf('t="shared"')>-1){k=or(m[0]);var W=Dr(Jr(m[1]));u.xlfn||(W=xS(W)),ee[parseInt(k.si,10)]=[k,W,N.r]}}else(m=_.match(/<f[^>]*\/>/))&&(k=or(m[0]),ee[k.si]&&(j.f=gse(ee[k.si][1],ee[k.si][2],N.r)));var M=Cn(N.r);for(y=0;y<z.length;++y)M.r>=z[y][0].s.r&&M.r<=z[y][0].e.r&&M.c>=z[y][0].s.c&&M.c<=z[y][0].e.c&&(j.F=z[y][1])}if(N.t==null&&j.v===void 0)if(j.f||j.F)j.v=0,j.t="n";else if(S)j.t="z";else continue;else j.t=N.t||"n";switch(f.s.c>E&&(f.s.c=E),f.e.c<E&&(f.e.c=E),j.t){case"n":if(j.v==""||j.v==null){if(!S)continue;j.t="z"}else j.v=parseFloat(j.v);break;case"s":if(typeof j.v>"u"){if(!S)continue;j.t="z"}else C=Uf[parseInt(j.v,10)],j.v=C.t,j.r=C.r,u.cellHTML&&(j.h=C.h);break;case"str":j.t="s",j.v=j.v!=null?Jr(j.v):"",u.cellHTML&&(j.h=N2(j.v));break;case"inlineStr":m=_.match(a),j.t="s",m!=null&&(C=U2(m[1]))?(j.v=C.t,u.cellHTML&&(j.h=C.h)):j.v="";break;case"b":j.v=fn(j.v);break;case"d":u.cellDates?j.v=xn(j.v,1):(j.v=ka(xn(j.v,1)),j.t="n");break;case"e":(!u||u.cellText!==!1)&&(j.w=j.v),j.v=RT[j.v];break}if(w=T=0,q=null,R&&N.s!==void 0&&(q=A.CellXf[N.s],q!=null&&(q.numFmtId!=null&&(w=q.numFmtId),u.cellStyles&&q.fillId!=null&&(T=q.fillId))),PI(j,w,T,u,h,A),u.cellDates&&R&&j.t=="n"&&eh(nr[w])&&(j.t="d",j.v=dy(j.v)),N.cm&&u.xlmeta){var se=(u.xlmeta.Cell||[])[+N.cm-1];se&&se.type=="XLDAPR"&&(j.D=!0)}if(Y){var K=Cn(N.r);d[K.r]||(d[K.r]=[]),d[K.r][K.c]=j}else d[N.r]=j}}}}G.length>0&&(d["!rows"]=G)}}();function _oe(e,t,r,a){var s=[],i=[],o=Or(e["!ref"]),l="",c,d="",u=[],f=0,h=0,A=e["!rows"],x=Array.isArray(e),p={r:d},b,m=-1;for(h=o.s.c;h<=o.e.c;++h)u[h]=kn(h);for(f=o.s.r;f<=o.e.r;++f){for(i=[],d=Jn(f),h=o.s.c;h<=o.e.c;++h){c=u[h]+d;var g=x?(e[f]||[])[h]:e[c];g!==void 0&&(l=voe(g,c,e,t))!=null&&i.push(l)}(i.length>0||A&&A[f])&&(p={r:d},A&&A[f]&&(b=A[f],b.hidden&&(p.hidden=1),m=-1,b.hpx?m=C0(b.hpx):b.hpt&&(m=b.hpt),m>-1&&(p.ht=m,p.customHeight=1),b.level&&(p.outlineLevel=b.level)),s[s.length]=St("row",i.join(""),p))}if(A)for(;f<A.length;++f)A&&A[f]&&(p={r:f+1},b=A[f],b.hidden&&(p.hidden=1),m=-1,b.hpx?m=C0(b.hpx):b.hpt&&(m=b.hpt),m>-1&&(p.ht=m,p.customHeight=1),b.level&&(p.outlineLevel=b.level),s[s.length]=St("row","",p));return s.join("")}function UI(e,t,r,a){var s=[ea,St("worksheet",null,{xmlns:lu[0],"xmlns:r":wa.r})],i=r.SheetNames[e],o=0,l="",c=r.Sheets[i];c==null&&(c={});var d=c["!ref"]||"A1",u=Or(d);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),d=fr(u)}a||(a={}),c["!comments"]=[];var f=[];ioe(c,r,e,t,s),s[s.length]=St("dimension",null,{ref:d}),s[s.length]=yoe(c,t,e,r),t.sheetFormat&&(s[s.length]=St("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(s[s.length]=foe(c,c["!cols"])),s[o=s.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=_oe(c,t),l.length>0&&(s[s.length]=l)),s.length>o+1&&(s[s.length]="</sheetData>",s[o]=s[o].replace("/>",">")),c["!protect"]&&(s[s.length]=coe(c["!protect"])),c["!autofilter"]!=null&&(s[s.length]=moe(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(s[s.length]=aoe(c["!merges"]));var h=-1,A,x=-1;return c["!links"].length>0&&(s[s.length]="<hyperlinks>",c["!links"].forEach(function(p){p[1].Target&&(A={ref:p[0]},p[1].Target.charAt(0)!="#"&&(x=Wr(a,-1,Gr(p[1].Target).replace(/#.*$/,""),_r.HLINK),A["r:id"]="rId"+x),(h=p[1].Target.indexOf("#"))>-1&&(A.location=Gr(p[1].Target.slice(h+1))),p[1].Tooltip&&(A.tooltip=Gr(p[1].Tooltip)),s[s.length]=St("hyperlink",null,A))}),s[s.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(s[s.length]=Aoe(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(s[s.length]=Va("ignoredErrors",St("ignoredError",null,{numberStoredAsText:1,sqref:d}))),f.length>0&&(x=Wr(a,-1,"../drawings/drawing"+(e+1)+".xml",_r.DRAW),s[s.length]=St("drawing",null,{"r:id":"rId"+x}),c["!drawing"]=f),c["!comments"].length>0&&(x=Wr(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",_r.VML),s[s.length]=St("legacyDrawing",null,{"r:id":"rId"+x}),c["!legacy"]=x),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function woe(e,t){var r={},a=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=a,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=s/20),r}function Noe(e,t,r){var a=ct(145),s=(r["!rows"]||[])[e]||{};a.write_shift(4,e),a.write_shift(4,0);var i=320;s.hpx?i=C0(s.hpx)*20:s.hpt&&(i=s.hpt*20),a.write_shift(2,i),a.write_shift(1,0);var o=0;s.level&&(o|=s.level),s.hidden&&(o|=16),(s.hpx||s.hpt)&&(o|=32),a.write_shift(1,o),a.write_shift(1,0);var l=0,c=a.l;a.l+=4;for(var d={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var f=-1,h=-1,A=u<<10;A<u+1<<10;++A){d.c=A;var x=Array.isArray(r)?(r[d.r]||[])[d.c]:r[sr(d)];x&&(f<0&&(f=A),h=A)}f<0||(++l,a.write_shift(4,f),a.write_shift(4,h))}var p=a.l;return a.l=c,a.write_shift(4,l),a.l=p,a.length>a.l?a.slice(0,a.l):a}function joe(e,t,r,a){var s=Noe(a,r,t);(s.length>17||(t["!rows"]||[])[a])&&xt(e,0,s)}var koe=Au,Coe=nh;function Soe(){}function Boe(e,t){var r={},a=e[e.l];return++e.l,r.above=!(a&64),r.left=!(a&128),e.l+=18,r.name=Tee(e),r}function Eoe(e,t,r){r==null&&(r=ct(84+4*e.length));var a=192;t&&(t.above&&(a&=-65),t.left&&(a&=-129)),r.write_shift(1,a);for(var s=1;s<3;++s)r.write_shift(1,0);return hx({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),DT(e,r),r.slice(0,r.l)}function Foe(e){var t=zi(e);return[t]}function Toe(e,t,r){return r==null&&(r=ct(8)),cu(t,r)}function Ioe(e){var t=du(e);return[t]}function Doe(e,t,r){return r==null&&(r=ct(4)),uu(t,r)}function Loe(e){var t=zi(e),r=e.read_shift(1);return[t,r,"b"]}function Poe(e,t,r){return r==null&&(r=ct(9)),cu(t,r),r.write_shift(1,e.v?1:0),r}function Ooe(e){var t=du(e),r=e.read_shift(1);return[t,r,"b"]}function Uoe(e,t,r){return r==null&&(r=ct(5)),uu(t,r),r.write_shift(1,e.v?1:0),r}function Roe(e){var t=zi(e),r=e.read_shift(1);return[t,r,"e"]}function Moe(e,t,r){return r==null&&(r=ct(9)),cu(t,r),r.write_shift(1,e.v),r}function Qoe(e){var t=du(e),r=e.read_shift(1);return[t,r,"e"]}function Hoe(e,t,r){return r==null&&(r=ct(8)),uu(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function qoe(e){var t=zi(e),r=e.read_shift(4);return[t,r,"s"]}function $oe(e,t,r){return r==null&&(r=ct(12)),cu(t,r),r.write_shift(4,t.v),r}function Koe(e){var t=du(e),r=e.read_shift(4);return[t,r,"s"]}function Voe(e,t,r){return r==null&&(r=ct(8)),uu(t,r),r.write_shift(4,t.v),r}function Woe(e){var t=zi(e),r=As(e);return[t,r,"n"]}function zoe(e,t,r){return r==null&&(r=ct(16)),cu(t,r),eu(e.v,r),r}function RI(e){var t=du(e),r=As(e);return[t,r,"n"]}function Goe(e,t,r){return r==null&&(r=ct(12)),uu(t,r),eu(e.v,r),r}function Xoe(e){var t=zi(e),r=I2(e);return[t,r,"n"]}function Yoe(e,t,r){return r==null&&(r=ct(12)),cu(t,r),LT(e.v,r),r}function Joe(e){var t=du(e),r=I2(e);return[t,r,"n"]}function Zoe(e,t,r){return r==null&&(r=ct(8)),uu(t,r),LT(e.v,r),r}function ele(e){var t=zi(e),r=E2(e);return[t,r,"is"]}function tle(e){var t=zi(e),r=hs(e);return[t,r,"str"]}function rle(e,t,r){return r==null&&(r=ct(12+4*e.v.length)),cu(t,r),Ia(e.v,r),r.length>r.l?r.slice(0,r.l):r}function nle(e){var t=du(e),r=hs(e);return[t,r,"str"]}function ale(e,t,r){return r==null&&(r=ct(8+4*e.v.length)),uu(t,r),Ia(e.v,r),r.length>r.l?r.slice(0,r.l):r}function sle(e,t,r){var a=e.l+t,s=zi(e);s.r=r["!row"];var i=e.read_shift(1),o=[s,i,"b"];if(r.cellFormula){e.l+=2;var l=hy(e,a-e.l,r);o[3]=ls(l,null,s,r.supbooks,r)}else e.l=a;return o}function ile(e,t,r){var a=e.l+t,s=zi(e);s.r=r["!row"];var i=e.read_shift(1),o=[s,i,"e"];if(r.cellFormula){e.l+=2;var l=hy(e,a-e.l,r);o[3]=ls(l,null,s,r.supbooks,r)}else e.l=a;return o}function ole(e,t,r){var a=e.l+t,s=zi(e);s.r=r["!row"];var i=As(e),o=[s,i,"n"];if(r.cellFormula){e.l+=2;var l=hy(e,a-e.l,r);o[3]=ls(l,null,s,r.supbooks,r)}else e.l=a;return o}function lle(e,t,r){var a=e.l+t,s=zi(e);s.r=r["!row"];var i=hs(e),o=[s,i,"str"];if(r.cellFormula){e.l+=2;var l=hy(e,a-e.l,r);o[3]=ls(l,null,s,r.supbooks,r)}else e.l=a;return o}var cle=Au,dle=nh;function ule(e,t){return t==null&&(t=ct(4)),t.write_shift(4,e),t}function Ale(e,t){var r=e.l+t,a=Au(e),s=F2(e),i=hs(e),o=hs(e),l=hs(e);e.l=r;var c={rfx:a,relId:s,loc:i,display:l};return o&&(c.Tooltip=o),c}function hle(e,t){var r=ct(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));nh({s:Cn(e[0]),e:Cn(e[0])},r),T2("rId"+t,r);var a=e[1].Target.indexOf("#"),s=a==-1?"":e[1].Target.slice(a+1);return Ia(s||"",r),Ia(e[1].Tooltip||"",r),Ia("",r),r.slice(0,r.l)}function fle(){}function ple(e,t,r){var a=e.l+t,s=PT(e),i=e.read_shift(1),o=[s];if(o[2]=i,r.cellFormula){var l=Rie(e,a-e.l,r);o[1]=l}else e.l=a;return o}function mle(e,t,r){var a=e.l+t,s=Au(e),i=[s];if(r.cellFormula){var o=Qie(e,a-e.l,r);i[1]=o,e.l=a}else e.l=a;return i}function gle(e,t,r){r==null&&(r=ct(18));var a=fy(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(a.width||10)*256),r.write_shift(4,0);var s=0;return t.hidden&&(s|=1),typeof a.width=="number"&&(s|=2),t.level&&(s|=t.level<<8),r.write_shift(2,s),r}var MI=["left","right","top","bottom","header","footer"];function xle(e){var t={};return MI.forEach(function(r){t[r]=As(e)}),t}function yle(e,t){return t==null&&(t=ct(6*8)),qd(e),MI.forEach(function(r){eu(e[r],t)}),t}function vle(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function ble(e,t,r){r==null&&(r=ct(30));var a=924;return(((t||{}).Views||[])[0]||{}).RTL&&(a|=32),r.write_shift(2,a),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function _le(e){var t=ct(24);return t.write_shift(4,4),t.write_shift(4,1),nh(e,t),t}function wle(e,t){return t==null&&(t=ct(16*4+2)),t.write_shift(2,e.password?R2(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function Nle(){}function jle(){}function kle(e,t,r,a,s,i,o){if(!e)return e;var l=t||{};a||(a={"!id":{}});var c=l.dense?[]:{},d,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,h=!1,A,x,p,b,m,g,y,v,_,j=[];l.biff=12,l["!row"]=0;var N=0,B=!1,E=[],C={},k=l.supbooks||s.supbooks||[[]];if(k.sharedf=C,k.arrayf=E,k.SheetNames=s.SheetNames||s.Sheets.map(function(Y){return Y.name}),!l.supbooks&&(l.supbooks=k,s.Names))for(var w=0;w<s.Names.length;++w)k[0][w+1]=s.Names[w];var T=[],R=[],q=!1;S0[16]={n:"BrtShortReal",f:RI};var z;if(Wl(e,function(G,re,U){if(!h)switch(U){case 148:d=G;break;case 0:A=G,l.sheetRows&&l.sheetRows<=A.r&&(h=!0),v=Jn(b=A.r),l["!row"]=A.r,(G.hidden||G.hpt||G.level!=null)&&(G.hpt&&(G.hpx=QA(G.hpt)),R[G.r]=G);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(x={t:G[2]},G[2]){case"n":x.v=G[1];break;case"s":y=Uf[G[1]],x.v=y.t,x.r=y.r;break;case"b":x.v=!!G[1];break;case"e":x.v=G[1],l.cellText!==!1&&(x.w=zl[x.v]);break;case"str":x.t="s",x.v=G[1];break;case"is":x.t="s",x.v=G[1].t;break}if((p=o.CellXf[G[0].iStyleRef])&&PI(x,p.numFmtId,null,l,i,o),m=G[0].c==-1?m+1:G[0].c,l.dense?(c[b]||(c[b]=[]),c[b][m]=x):c[kn(m)+v]=x,l.cellFormula){for(B=!1,N=0;N<E.length;++N){var S=E[N];A.r>=S[0].s.r&&A.r<=S[0].e.r&&m>=S[0].s.c&&m<=S[0].e.c&&(x.F=fr(S[0]),B=!0)}!B&&G.length>3&&(x.f=G[3])}if(u.s.r>A.r&&(u.s.r=A.r),u.s.c>m&&(u.s.c=m),u.e.r<A.r&&(u.e.r=A.r),u.e.c<m&&(u.e.c=m),l.cellDates&&p&&x.t=="n"&&eh(nr[p.numFmtId])){var D=Dd(x.v);D&&(x.t="d",x.v=new Date(D.y,D.m-1,D.d,D.H,D.M,D.S,D.u))}z&&(z.type=="XLDAPR"&&(x.D=!0),z=void 0);break;case 1:case 12:if(!l.sheetStubs||f)break;x={t:"z",v:void 0},m=G[0].c==-1?m+1:G[0].c,l.dense?(c[b]||(c[b]=[]),c[b][m]=x):c[kn(m)+v]=x,u.s.r>A.r&&(u.s.r=A.r),u.s.c>m&&(u.s.c=m),u.e.r<A.r&&(u.e.r=A.r),u.e.c<m&&(u.e.c=m),z&&(z.type=="XLDAPR"&&(x.D=!0),z=void 0);break;case 176:j.push(G);break;case 49:z=((l.xlmeta||{}).Cell||[])[G-1];break;case 494:var L=a["!id"][G.relId];for(L?(G.Target=L.Target,G.loc&&(G.Target+="#"+G.loc),G.Rel=L):G.relId==""&&(G.Target="#"+G.loc),b=G.rfx.s.r;b<=G.rfx.e.r;++b)for(m=G.rfx.s.c;m<=G.rfx.e.c;++m)l.dense?(c[b]||(c[b]=[]),c[b][m]||(c[b][m]={t:"z",v:void 0}),c[b][m].l=G):(g=sr({c:m,r:b}),c[g]||(c[g]={t:"z",v:void 0}),c[g].l=G);break;case 426:if(!l.cellFormula)break;E.push(G),_=l.dense?c[b][m]:c[kn(m)+v],_.f=ls(G[1],u,{r:A.r,c:m},k,l),_.F=fr(G[0]);break;case 427:if(!l.cellFormula)break;C[sr(G[0].s)]=G[1],_=l.dense?c[b][m]:c[kn(m)+v],_.f=ls(G[1],u,{r:A.r,c:m},k,l);break;case 60:if(!l.cellStyles)break;for(;G.e>=G.s;)T[G.e--]={width:G.w/256,hidden:!!(G.flags&1),level:G.level},q||(q=!0,M2(G.w/256)),Wc(T[G.e+1]);break;case 161:c["!autofilter"]={ref:fr(G)};break;case 476:c["!margins"]=G;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),G.name&&(s.Sheets[r].CodeName=G.name),(G.above||G.left)&&(c["!outline"]={above:G.above,left:G.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),G.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!re.T){if(!f||l.WTF)throw new Error("Unexpected record 0x"+U.toString(16))}}},l),delete l.supbooks,delete l["!row"],!c["!ref"]&&(u.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(c["!ref"]=fr(d||u)),l.sheetRows&&c["!ref"]){var ee=Or(c["!ref"]);l.sheetRows<=+ee.e.r&&(ee.e.r=l.sheetRows-1,ee.e.r>u.e.r&&(ee.e.r=u.e.r),ee.e.r<ee.s.r&&(ee.s.r=ee.e.r),ee.e.c>u.e.c&&(ee.e.c=u.e.c),ee.e.c<ee.s.c&&(ee.s.c=ee.e.c),c["!fullref"]=c["!ref"],c["!ref"]=fr(ee))}return j.length>0&&(c["!merges"]=j),T.length>0&&(c["!cols"]=T),R.length>0&&(c["!rows"]=R),c}function Cle(e,t,r,a,s,i,o){if(t.v===void 0)return!1;var l="";switch(t.t){case"b":l=t.v?"1":"0";break;case"d":t=yn(t),t.z=t.z||nr[14],t.v=ka(xn(t.v)),t.t="n";break;case"n":case"e":l=""+t.v;break;default:l=t.v;break}var c={r,c:a};switch(c.s=td(s.cellXfs,t,s),t.l&&i["!links"].push([sr(c),t.l]),t.c&&i["!comments"].push([sr(c),t.c]),t.t){case"s":case"str":return s.bookSST?(l=K2(s.Strings,t.v,s.revStrings),c.t="s",c.v=l,o?xt(e,18,Voe(t,c)):xt(e,7,$oe(t,c))):(c.t="str",o?xt(e,17,ale(t,c)):xt(e,6,rle(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?xt(e,13,Zoe(t,c)):xt(e,2,Yoe(t,c)):o?xt(e,16,Goe(t,c)):xt(e,5,zoe(t,c)),!0;case"b":return c.t="b",o?xt(e,15,Uoe(t,c)):xt(e,4,Poe(t,c)),!0;case"e":return c.t="e",o?xt(e,14,Hoe(t,c)):xt(e,3,Moe(t,c)),!0}return o?xt(e,12,Doe(t,c)):xt(e,1,Toe(t,c)),!0}function Sle(e,t,r,a){var s=Or(t["!ref"]||"A1"),i,o="",l=[];xt(e,145);var c=Array.isArray(t),d=s.e.r;t["!rows"]&&(d=Math.max(s.e.r,t["!rows"].length-1));for(var u=s.s.r;u<=d;++u){o=Jn(u),joe(e,t,s,u);var f=!1;if(u<=s.e.r)for(var h=s.s.c;h<=s.e.c;++h){u===s.s.r&&(l[h]=kn(h)),i=l[h]+o;var A=c?(t[u]||[])[h]:t[i];if(!A){f=!1;continue}f=Cle(e,A,u,h,a,t,f)}}xt(e,146)}function Ble(e,t){!t||!t["!merges"]||(xt(e,177,ule(t["!merges"].length)),t["!merges"].forEach(function(r){xt(e,176,dle(r))}),xt(e,178))}function Ele(e,t){!t||!t["!cols"]||(xt(e,390),t["!cols"].forEach(function(r,a){r&&xt(e,60,gle(a,r))}),xt(e,391))}function Fle(e,t){!t||!t["!ref"]||(xt(e,648),xt(e,649,_le(Or(t["!ref"]))),xt(e,650))}function Tle(e,t,r){t["!links"].forEach(function(a){if(a[1].Target){var s=Wr(r,-1,a[1].Target.replace(/#.*$/,""),_r.HLINK);xt(e,494,hle(a,s))}}),delete t["!links"]}function Ile(e,t,r,a){if(t["!comments"].length>0){var s=Wr(a,-1,"../drawings/vmlDrawing"+(r+1)+".vml",_r.VML);xt(e,551,T2("rId"+s)),t["!legacy"]=s}}function Dle(e,t,r,a){if(t["!autofilter"]){var s=t["!autofilter"],i=typeof s.ref=="string"?s.ref:fr(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=Ws(i);l.s.r==l.e.r&&(l.e.r=Ws(t["!ref"]).e.r,i=fr(l));for(var c=0;c<o.length;++c){var d=o[c];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==a){d.Ref="'"+r.SheetNames[a]+"'!"+i;break}}c==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+i}),xt(e,161,nh(Or(i))),xt(e,162)}}function Lle(e,t,r){xt(e,133),xt(e,137,ble(t,r)),xt(e,138),xt(e,134)}function Ple(e,t){t["!protect"]&&xt(e,535,wle(t["!protect"]))}function Ole(e,t,r,a){var s=Vs(),i=r.SheetNames[e],o=r.Sheets[i]||{},l=i;try{r&&r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch{}var c=Or(o["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],xt(s,129),(r.vbaraw||o["!outline"])&&xt(s,147,Eoe(l,o["!outline"])),xt(s,148,Coe(c)),Lle(s,o,r.Workbook),Ele(s,o),Sle(s,o,e,t),Ple(s,o),Dle(s,o,r,e),Ble(s,o),Tle(s,o,a),o["!margins"]&&xt(s,476,yle(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&Fle(s,o),Ile(s,o,e,a),xt(s,130),s.end()}function Ule(e){var t=[],r=e.match(/^<c:numCache>/),a;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var o=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var s=Dr((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){a=i.replace(/<.*?>/g,"")}),[t,s,a]}function Rle(e,t,r,a,s,i){var o=i||{"!type":"chart"};if(!e)return i;var l=0,c=0,d="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var h=Ule(f);u.s.r=u.s.c=0,u.e.c=l,d=kn(l),h[0].forEach(function(A,x){o[d+Jn(x)]={t:"n",v:A,z:h[1]},c=x}),u.e.r<c&&(u.e.r=c),++l}),l>0&&(o["!ref"]=fr(u)),o}function Mle(e,t,r,a,s){if(!e)return e;a||(a={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o,l=e.match(OI);return l&&V2(l[0],i,s,r),(o=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=o[1]),a["!id"][i["!rel"]]&&(i["!drawel"]=a["!id"][i["!rel"]]),i}function Qle(e,t){e.l+=10;var r=hs(e);return{name:r}}function Hle(e,t,r,a,s){if(!e)return e;a||(a={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o=!1;return Wl(e,function(c,d,u){switch(u){case 550:i["!rel"]=c;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),c.name&&(s.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},t),a["!id"][i["!rel"]]&&(i["!drawel"]=a["!id"][i["!rel"]]),i}var W2=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],qle=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],$le=[],Kle=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function wS(e,t){for(var r=0;r!=e.length;++r)for(var a=e[r],s=0;s!=t.length;++s){var i=t[s];if(a[i[0]]==null)a[i[0]]=i[1];else switch(i[2]){case"bool":typeof a[i[0]]=="string"&&(a[i[0]]=fn(a[i[0]]));break;case"int":typeof a[i[0]]=="string"&&(a[i[0]]=parseInt(a[i[0]],10));break}}}function NS(e,t){for(var r=0;r!=t.length;++r){var a=t[r];if(e[a[0]]==null)e[a[0]]=a[1];else switch(a[2]){case"bool":typeof e[a[0]]=="string"&&(e[a[0]]=fn(e[a[0]]));break;case"int":typeof e[a[0]]=="string"&&(e[a[0]]=parseInt(e[a[0]],10));break}}}function QI(e){NS(e.WBProps,W2),NS(e.CalcPr,Kle),wS(e.WBView,qle),wS(e.Sheets,$le),BA.date1904=fn(e.WBProps.date1904)}function Vle(e){return!e.Workbook||!e.Workbook.WBProps?"false":fn(e.Workbook.WBProps.date1904)?"true":"false"}var Wle="][*?/\\".split("");function HI(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return Wle.forEach(function(a){if(e.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function zle(e,t,r){e.forEach(function(a,s){HI(a);for(var i=0;i<s;++i)if(a==e[i])throw new Error("Duplicate Sheet Name: "+a);if(r){var o=t&&t[s]&&t[s].CodeName||a;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function Gle(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];zle(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)Vie(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var Xle=/<\w+:workbook/;function Yle(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,s="xmlns",i={},o=0;if(e.replace(ms,function(c,d){var u=or(c);switch(el(u[0])){case"<?xml":break;case"<workbook":c.match(Xle)&&(s="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=u[s];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":W2.forEach(function(f){if(u[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=fn(u[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(u[f[0]],10);break;default:r.WBProps[f[0]]=u[f[0]]}}),u.codeName&&(r.WBProps.CodeName=Jr(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=Dr(Jr(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":i={},i.Name=Jr(u.name),u.comment&&(i.Comment=u.comment),u.localSheetId&&(i.Sheet=+u.localSheetId),fn(u.hidden||"0")&&(i.Hidden=!0),o=d+c.length;break;case"</definedName>":i.Ref=Dr(Jr(e.slice(o,d))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&t.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return c}),lu.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return QI(r),r}function qI(e){var t=[ea];t[t.length]=St("workbook",null,{xmlns:lu[0],"xmlns:r":wa.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(W2.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(a[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(a.codeName=e.Workbook.WBProps.CodeName,delete a.CodeName)),t[t.length]=St("workbookPr",null,a);var s=e.Workbook&&e.Workbook.Sheets||[],i=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!s[i]||!s[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var o={name:Gr(e.SheetNames[i].slice(0,31))};if(o.sheetId=""+(i+1),o["r:id"]="rId"+(i+1),s[i])switch(s[i].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=St("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(t[t.length]=St("definedName",Gr(l.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function Jle(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=V_(e),r.name=hs(e),r}function Zle(e,t){return t||(t=ct(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),T2(e.strRelID,t),Ia(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function ece(e,t){var r={},a=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?hs(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(a&65536),r.backupFile=!!(a&64),r.checkCompatibility=!!(a&4096),r.date1904=!!(a&1),r.filterPrivacy=!!(a&8),r.hidePivotFieldList=!!(a&1024),r.promptedSolutions=!!(a&16),r.publishItems=!!(a&2048),r.refreshAllConnections=!!(a&262144),r.saveExternalLinkValues=!!(a&128),r.showBorderUnselectedTables=!!(a&4),r.showInkAnnotation=!!(a&32),r.showObjects=["all","placeholders","none"][a>>13&3],r.showPivotChartFilter=!!(a&32768),r.updateLinks=["userSet","never","always"][a>>8&3],r}function tce(e,t){t||(t=ct(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),DT(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function rce(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function nce(e,t,r){var a=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),i=Iee(e),o=Mie(e,0,r),l=F2(e);e.l=a;var c={Name:i,Ptg:o};return s<268435455&&(c.Sheet=s),l&&(c.Comment=l),c}function ace(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],s=!1;t||(t={}),t.biff=12;var i=[],o=[[]];return o.SheetNames=[],o.XTI=[],S0[16]={n:"BrtFRTArchID$",f:rce},Wl(e,function(c,d,u){switch(u){case 156:o.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=ls(c.Ptg,null,null,o,t),delete t.SID,delete c.Ptg,i.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([u,c]):o[0]=[u,c],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(c),o.XTI=o.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(u),s=!0;break;case 36:a.pop(),s=!1;break;case 37:a.push(u),s=!0;break;case 38:a.pop(),s=!1;break;case 16:break;default:if(!d.T){if(!s||t.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},t),QI(r),r.Names=i,r.supbooks=o,r}function sce(e,t){xt(e,143);for(var r=0;r!=t.SheetNames.length;++r){var a=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,s={Hidden:a,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};xt(e,156,Zle(s))}xt(e,144)}function ice(e,t){t||(t=ct(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Ia("SheetJS",t),Ia(ix.version,t),Ia(ix.version,t),Ia("7262",t),t.length>t.l?t.slice(0,t.l):t}function oce(e,t){t||(t=ct(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function lce(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,a=0,s=-1,i=-1;a<r.length;++a)!r[a]||!r[a].Hidden&&s==-1?s=a:r[a].Hidden==1&&i==-1&&(i=a);i>s||(xt(e,135),xt(e,158,oce(s)),xt(e,136))}}function cce(e,t){var r=Vs();return xt(r,131),xt(r,128,ice()),xt(r,153,tce(e.Workbook&&e.Workbook.WBProps||null)),lce(r,e),sce(r,e),xt(r,132),r.end()}function dce(e,t,r){return t.slice(-4)===".bin"?ace(e,r):Yle(e,r)}function uce(e,t,r,a,s,i,o,l){return t.slice(-4)===".bin"?kle(e,a,r,s,i,o,l):noe(e,a,r,s,i,o,l)}function Ace(e,t,r,a,s,i,o,l){return t.slice(-4)===".bin"?Hle(e,a,r,s,i):Mle(e,a,r,s,i)}function hce(e,t,r,a,s,i,o,l){return t.slice(-4)===".bin"?pse():mse()}function fce(e,t,r,a,s,i,o,l){return t.slice(-4)===".bin"?hse():fse()}function pce(e,t,r,a){return t.slice(-4)===".bin"?dae(e,r,a):Jne(e,r,a)}function mce(e,t,r){return wI(e,r)}function gce(e,t,r){return t.slice(-4)===".bin"?gne(e,r):fne(e,r)}function xce(e,t,r){return t.slice(-4)===".bin"?lse(e,r):Zae(e,r)}function yce(e,t,r){return t.slice(-4)===".bin"?Xae(e):zae(e)}function vce(e,t,r,a){return r.slice(-4)===".bin"?Yae(e,t,r,a):void 0}function bce(e,t,r){return t.slice(-4)===".bin"?Kae(e,t,r):Wae(e,t,r)}function _ce(e,t,r){return(t.slice(-4)===".bin"?cce:qI)(e)}function wce(e,t,r,a,s){return(t.slice(-4)===".bin"?Ole:UI)(e,r,a,s)}function Nce(e,t,r){return(t.slice(-4)===".bin"?vae:bI)(e,r)}function jce(e,t,r){return(t.slice(-4)===".bin"?vne:hI)(e,r)}function kce(e,t,r){return(t.slice(-4)===".bin"?cse:kI)(e)}function Cce(e){return(e.slice(-4)===".bin"?Vae:NI)()}var $I=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,KI=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function ro(e,t){var r=e.split(/\s+/),a=[];if(a[0]=r[0],r.length===1)return a;var s=e.match($I),i,o,l,c;if(s)for(c=0;c!=s.length;++c)i=s[c].match(KI),(o=i[1].indexOf(":"))===-1?a[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?l="xmlns"+i[1].slice(6):l=i[1].slice(o+1),a[l]=i[2].slice(1,i[2].length-1));return a}function Sce(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var a=e.match($I),s,i,o,l;if(a)for(l=0;l!=a.length;++l)s=a[l].match(KI),(i=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(i+1),r[o]=s[2].slice(1,s[2].length-1));return r}var Mf;function Bce(e,t){var r=Mf[e]||Dr(e);return r==="General"?Jd(t):Wi(r,t)}function Ece(e,t,r,a){var s=a;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=fn(a);break;case"i2":case"int":s=parseInt(a,10);break;case"r4":case"float":s=parseFloat(a);break;case"date":case"dateTime.tz":s=xn(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Dr(t)]=s}function Fce(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||zl[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=y0(e.v):e.w=Jd(e.v):e.w=Bce(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var a=Mf[t]||t||"General";if(r.cellNF&&(e.z=a),r.cellDates&&e.t=="n"&&eh(a)){var s=Dd(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(i){if(r.WTF)throw i}}}function Tce(e,t,r){if(r.cellStyles&&t.Interior){var a=t.Interior;a.Pattern&&(a.patternType=$ne[a.Pattern]||a.Pattern)}e[t.ID]=t}function Ice(e,t,r,a,s,i,o,l,c,d){var u="General",f=a.StyleID,h={};d=d||{};var A=[],x=0;for(f===void 0&&l&&(f=l.StyleID),f===void 0&&o&&(f=o.StyleID);i[f]!==void 0&&(i[f].nf&&(u=i[f].nf),i[f].Interior&&A.push(i[f].Interior),!!i[f].Parent);)f=i[f].Parent;switch(r.Type){case"Boolean":a.t="b",a.v=fn(e);break;case"String":a.t="s",a.r=QC(Dr(e)),a.v=e.indexOf("<")>-1?Dr(t||e).replace(/<.*?>/g,""):a.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),a.v=(xn(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),a.v!==a.v?a.v=Dr(e):a.v<60&&(a.v=a.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+e),a.t||(a.t="n");break;case"Error":a.t="e",a.v=RT[e],d.cellText!==!1&&(a.w=e);break;default:e==""&&t==""?a.t="z":(a.t="s",a.v=QC(t||e));break}if(Fce(a,u,d),d.cellFormula!==!1)if(a.Formula){var p=Dr(a.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),a.f=SA(p,s),delete a.Formula,a.ArrayRange=="RC"?a.F=SA("RC:RC",s):a.ArrayRange&&(a.F=SA(a.ArrayRange,s),c.push([Or(a.F),a.F]))}else for(x=0;x<c.length;++x)s.r>=c[x][0].s.r&&s.r<=c[x][0].e.r&&s.c>=c[x][0].s.c&&s.c<=c[x][0].e.c&&(a.F=c[x][1]);d.cellStyles&&(A.forEach(function(b){!h.patternType&&b.patternType&&(h.patternType=b.patternType)}),a.s=h),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function Dce(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function P1(e,t){var r=t||{};th();var a=hf(j2(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(a=Jr(a));var s=a.slice(0,1024).toLowerCase(),i=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var o=yn(r);return o.type="string",MA.to_workbook(a,o)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(de){s.indexOf("<"+de)>=0&&(i=!0)}),i)return yde(a,r);Mf={"General Number":"General","General Date":nr[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":nr[15],"Short Date":nr[14],"Long Time":nr[19],"Medium Time":nr[18],"Short Time":nr[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:nr[2],Standard:nr[4],Percent:nr[10],Scientific:nr[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[],d,u={},f=[],h=r.dense?[]:{},A="",x={},p={},b=ro('<Data ss:Type="String">'),m=0,g=0,y=0,v={s:{r:2e6,c:2e6},e:{r:0,c:0}},_={},j={},N="",B=0,E=[],C={},k={},w=0,T=[],R=[],q={},z=[],ee,Y=!1,G=[],re=[],U={},S=0,D=0,L={Sheets:[],WBProps:{date1904:!1}},P={};_0.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var I="";l=_0.exec(a);)switch(l[3]=(I=l[3]).toLowerCase()){case"data":if(I=="data"){if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break}if(c[c.length-1][1])break;l[1]==="/"?Ice(a.slice(m,l.index),N,b,c[c.length-1][0]=="comment"?q:x,{c:g,r:y},_,z[g],p,G,r):(N="",b=ro(l[0]),m=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(R.length>0&&(x.c=R),(!r.sheetRows||r.sheetRows>y)&&x.v!==void 0&&(r.dense?(h[y]||(h[y]=[]),h[y][g]=x):h[kn(g)+Jn(y)]=x),x.HRef&&(x.l={Target:Dr(x.HRef)},x.HRefScreenTip&&(x.l.Tooltip=x.HRefScreenTip),delete x.HRef,delete x.HRefScreenTip),(x.MergeAcross||x.MergeDown)&&(S=g+(parseInt(x.MergeAcross,10)|0),D=y+(parseInt(x.MergeDown,10)|0),E.push({s:{c:g,r:y},e:{c:S,r:D}})),!r.sheetStubs)x.MergeAcross?g=S+1:++g;else if(x.MergeAcross||x.MergeDown){for(var H=g;H<=S;++H)for(var V=y;V<=D;++V)(H>g||V>y)&&(r.dense?(h[V]||(h[V]=[]),h[V][H]={t:"z"}):h[kn(H)+Jn(V)]={t:"z"});g=S+1}else++g;else x=Sce(l[0]),x.Index&&(g=+x.Index-1),g<v.s.c&&(v.s.c=g),g>v.e.c&&(v.e.c=g),l[0].slice(-2)==="/>"&&++g,R=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(y<v.s.r&&(v.s.r=y),y>v.e.r&&(v.e.r=y),l[0].slice(-2)==="/>"&&(p=ro(l[0]),p.Index&&(y=+p.Index-1)),g=0,++y):(p=ro(l[0]),p.Index&&(y=+p.Index-1),U={},(p.AutoFitHeight=="0"||p.Height)&&(U.hpx=parseInt(p.Height,10),U.hpt=C0(U.hpx),re[y]=U),p.Hidden=="1"&&(U.hidden=!0,re[y]=U));break;case"worksheet":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"));f.push(A),v.s.r<=v.e.r&&v.s.c<=v.e.c&&(h["!ref"]=fr(v),r.sheetRows&&r.sheetRows<=v.e.r&&(h["!fullref"]=h["!ref"],v.e.r=r.sheetRows-1,h["!ref"]=fr(v))),E.length&&(h["!merges"]=E),z.length>0&&(h["!cols"]=z),re.length>0&&(h["!rows"]=re),u[A]=h}else v={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=g=0,c.push([l[3],!1]),d=ro(l[0]),A=Dr(d.Name),h=r.dense?[]:{},E=[],G=[],re=[],P={name:A,Hidden:0},L.Sheets.push(P);break;case"table":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else{if(l[0].slice(-2)=="/>")break;c.push([l[3],!1]),z=[],Y=!1}break;case"style":l[1]==="/"?Tce(_,j,r):j=ro(l[0]);break;case"numberformat":j.nf=Dr(ro(l[0]).Format||"General"),Mf[j.nf]&&(j.nf=Mf[j.nf]);for(var W=0;W!=392&&nr[W]!=j.nf;++W);if(W==392){for(W=57;W!=392;++W)if(nr[W]==null){Tl(j.nf,W);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(ee=ro(l[0]),ee.Hidden&&(ee.hidden=!0,delete ee.Hidden),ee.Width&&(ee.wpx=parseInt(ee.Width,10)),!Y&&ee.wpx>10){Y=!0,ds=yI;for(var M=0;M<z.length;++M)z[M]&&Wc(z[M])}Y&&Wc(ee),z[ee.Index-1||z.length]=ee;for(var se=0;se<+ee.Span;++se)z[z.length]=yn(ee);break;case"namedrange":if(l[1]==="/")break;L.Names||(L.Names=[]);var K=or(l[0]),he={Name:K.Name,Ref:SA(K.RefersTo.slice(1),{r:0,c:0})};L.Sheets.length>0&&(he.Sheet=L.Sheets.length-1),L.Names.push(he);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?N+=a.slice(B,l.index):B=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;j.Interior=ro(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?ate(C,I,a.slice(w,l.index)):w=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else c.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"));Dce(q),R.push(q)}else c.push([l[3],!1]),d=ro(l[0]),q={a:d.Author};break;case"autofilter":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var ne=ro(l[0]);h["!autofilter"]={ref:SA(ne.Range).replace(/\$/g,"")},c.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"null":break;default:if(c.length==0&&l[3]=="document"||c.length==0&&l[3]=="uof")return BS(a,r);var te=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:te=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:te=!1}break;case"excelworkbook":switch(l[3]){case"date1904":L.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:te=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:te=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(a.slice(w,l.index)){case"SheetHidden":P.Hidden=1;break;case"SheetVeryHidden":P.Hidden=2;break}else w=l.index+l[0].length;break;case"header":h["!margins"]||qd(h["!margins"]={},"xlml"),isNaN(+or(l[0]).Margin)||(h["!margins"].header=+or(l[0]).Margin);break;case"footer":h["!margins"]||qd(h["!margins"]={},"xlml"),isNaN(+or(l[0]).Margin)||(h["!margins"].footer=+or(l[0]).Margin);break;case"pagemargins":var ce=or(l[0]);h["!margins"]||qd(h["!margins"]={},"xlml"),isNaN(+ce.Top)||(h["!margins"].top=+ce.Top),isNaN(+ce.Left)||(h["!margins"].left=+ce.Left),isNaN(+ce.Right)||(h["!margins"].right=+ce.Right),isNaN(+ce.Bottom)||(h["!margins"].bottom=+ce.Bottom);break;case"displayrighttoleft":L.Views||(L.Views=[]),L.Views[0]||(L.Views[0]={}),L.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:te=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:te=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:te=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:te=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:te=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:te=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:te=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:te=!1}break;case"smarttags":break;default:te=!1;break}if(te||l[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?Ece(k,I,T,a.slice(w,l.index)):(T=l,w=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+c.join("|")}var _e={};return!r.bookSheets&&!r.bookProps&&(_e.Sheets=u),_e.SheetNames=f,_e.Workbook=L,_e.SSF=yn(nr),_e.Props=C,_e.Custprops=k,_e}function Z_(e,t){switch(G2(t=t||{}),t.type||"base64"){case"base64":return P1(xi(e),t);case"binary":case"buffer":case"file":return P1(e,t);case"array":return P1(Zc(e),t)}}function Lce(e,t){var r=[];return e.Props&&r.push(ste(e.Props,t)),e.Custprops&&r.push(ite(e.Props,e.Custprops)),r.join("")}function Pce(){return""}function Oce(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(a,s){var i=[];i.push(St("NumberFormat",null,{"ss:Format":Gr(nr[a.numFmtId])}));var o={"ss:ID":"s"+(21+s)};r.push(St("Style",i.join(""),o))}),St("Styles",r.join(""))}function VI(e){return St("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+q2(e.Ref,{r:0,c:0})})}function Uce(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],a=0;a<t.length;++a){var s=t[a];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(VI(s)))}return St("Names",r.join(""))}function Rce(e,t,r,a){if(!e||!((a||{}).Workbook||{}).Names)return"";for(var s=a.Workbook.Names,i=[],o=0;o<s.length;++o){var l=s[o];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||i.push(VI(l)))}return i.join("")}function Mce(e,t,r,a){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(St("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(St("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(St("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[r])if(a.Workbook.Sheets[r].Hidden)s.push(St("Visible",a.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(a.Workbook.Sheets[i]&&!a.Workbook.Sheets[i].Hidden);++i);i==r&&s.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(Va("ProtectContents","True")),e["!protect"].objects&&s.push(Va("ProtectObjects","True")),e["!protect"].scenarios&&s.push(Va("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(Va("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(Va("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&s.push("<"+o[1]+"/>")})),s.length==0?"":St("WorksheetOptions",s.join(""),{xmlns:li.x})}function Qce(e){return e.map(function(t){var r=lee(t.t||""),a=St("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return St("Comment",a,{"ss:Author":t.a})}).join("")}function Hce(e,t,r,a,s,i,o){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+Gr(q2(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var c=Cn(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==o.r?"":"["+(c.r-o.r)+"]")+"C"+(c.c==o.c?"":"["+(c.c-o.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=Gr(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=Gr(e.l.Tooltip))),r["!merges"])for(var d=r["!merges"],u=0;u!=d.length;++u)d[u].s.c!=o.c||d[u].s.r!=o.r||(d[u].e.c>d[u].s.c&&(l["ss:MergeAcross"]=d[u].e.c-d[u].s.c),d[u].e.r>d[u].s.r&&(l["ss:MergeDown"]=d[u].e.r-d[u].s.r));var f="",h="";switch(e.t){case"z":if(!a.sheetStubs)return"";break;case"n":f="Number",h=String(e.v);break;case"b":f="Boolean",h=e.v?"1":"0";break;case"e":f="Error",h=zl[e.v];break;case"d":f="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||nr[14]);break;case"s":f="String",h=oee(e.v||"");break}var A=td(a.cellXfs,e,a);l["ss:StyleID"]="s"+(21+A),l["ss:Index"]=o.c+1;var x=e.v!=null?h:"",p=e.t=="z"?"":'<Data ss:Type="'+f+'">'+x+"</Data>";return(e.c||[]).length>0&&(p+=Qce(e.c)),St("Cell",p,l)}function qce(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=QA(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function $ce(e,t,r,a){if(!e["!ref"])return"";var s=Or(e["!ref"]),i=e["!merges"]||[],o=0,l=[];e["!cols"]&&e["!cols"].forEach(function(b,m){Wc(b);var g=!!b.width,y=fy(m,b),v={"ss:Index":m+1};g&&(v["ss:Width"]=j0(y.width)),b.hidden&&(v["ss:Hidden"]="1"),l.push(St("Column",null,v))});for(var c=Array.isArray(e),d=s.s.r;d<=s.e.r;++d){for(var u=[qce(d,(e["!rows"]||[])[d])],f=s.s.c;f<=s.e.c;++f){var h=!1;for(o=0;o!=i.length;++o)if(!(i[o].s.c>f)&&!(i[o].s.r>d)&&!(i[o].e.c<f)&&!(i[o].e.r<d)){(i[o].s.c!=f||i[o].s.r!=d)&&(h=!0);break}if(!h){var A={r:d,c:f},x=sr(A),p=c?(e[d]||[])[f]:e[x];u.push(Hce(p,x,e,t,r,a,A))}}u.push("</Row>"),u.length>2&&l.push(u.join(""))}return l.join("")}function Kce(e,t,r){var a=[],s=r.SheetNames[e],i=r.Sheets[s],o=i?Rce(i,t,e,r):"";return o.length>0&&a.push("<Names>"+o+"</Names>"),o=i?$ce(i,t,e,r):"",o.length>0&&a.push("<Table>"+o+"</Table>"),a.push(Mce(i,t,e,r)),a.join("")}function Vce(e,t){t||(t={}),e.SSF||(e.SSF=yn(nr)),e.SSF&&(th(),oy(e.SSF),t.revssf=cy(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],td(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(Lce(e,t)),r.push(Pce()),r.push(""),r.push("");for(var a=0;a<e.SheetNames.length;++a)r.push(St("Worksheet",Kce(a,t,e),{"ss:Name":Gr(e.SheetNames[a])}));return r[2]=Oce(e,t),r[3]=Uce(e),ea+St("Workbook",r.join(""),{xmlns:li.ss,"xmlns:o":li.o,"xmlns:x":li.x,"xmlns:ss":li.ss,"xmlns:dt":li.dt,"xmlns:html":li.html})}function Wce(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=Uee(r),r.length-r.l<=4)return t;var a=r.read_shift(4);if(a==0||a>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(a=r.read_shift(4),a!==1907505652)||(t.UnicodeClipboardFormat=Ree(r),a=r.read_shift(4),a==0||a>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var zce=[60,1084,2066,2165,2175];function Gce(e,t,r,a,s){var i=a,o=[],l=r.slice(r.l,r.l+i);if(s&&s.enc&&s.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(l)}o.push(l),r.l+=i;for(var c=Sl(r,r.l),d=ew[c],u=0;d!=null&&zce.indexOf(c)>-1;)i=Sl(r,r.l+2),u=r.l+4,c==2066?u+=4:(c==2165||c==2175)&&(u+=12),l=r.slice(u,r.l+4+i),o.push(l),r.l+=4+i,d=ew[c=Sl(r,r.l)];var f=Ta(o);Ka(f,0);var h=0;f.lens=[];for(var A=0;A<o.length;++A)f.lens.push(h),h+=o[A].length;if(f.length<a)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+a;return t.f(f,f.length,s)}function Do(e,t,r){if(e.t!=="z"&&e.XF){var a=0;try{a=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=nr[a])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||zl[e.v]:a===0||a=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=y0(e.v):e.w=Jd(e.v):e.w=Wi(a,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&a&&e.t=="n"&&eh(nr[a]||String(a))){var s=Dd(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function Rm(e,t,r){return{v:e,ixfe:t,t:r}}function Xce(e,t){var r={opts:{}},a={},s=t.dense?[]:{},i={},o={},l=null,c=[],d="",u={},f,h="",A,x,p,b,m={},g=[],y,v,_=[],j=[],N={Sheets:[],WBProps:{date1904:!1},Views:[{}]},B={},E=function(Ue){return Ue<8?Md[Ue]:Ue<64&&j[Ue-8]||Md[Ue]},C=function(Ue,qe,$e){var Ne=qe.XF.data;if(!(!Ne||!Ne.patternType||!$e||!$e.cellStyles)){qe.s={},qe.s.patternType=Ne.patternType;var Ee;(Ee=N0(E(Ne.icvFore)))&&(qe.s.fgColor={rgb:Ee}),(Ee=N0(E(Ne.icvBack)))&&(qe.s.bgColor={rgb:Ee})}},k=function(Ue,qe,$e){if(!(U>1)&&!($e.sheetRows&&Ue.r>=$e.sheetRows)){if($e.cellStyles&&qe.XF&&qe.XF.data&&C(Ue,qe,$e),delete qe.ixfe,delete qe.XF,f=Ue,h=sr(Ue),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),Ue.r<o.s.r&&(o.s.r=Ue.r),Ue.c<o.s.c&&(o.s.c=Ue.c),Ue.r+1>o.e.r&&(o.e.r=Ue.r+1),Ue.c+1>o.e.c&&(o.e.c=Ue.c+1),$e.cellFormula&&qe.f){for(var Ne=0;Ne<g.length;++Ne)if(!(g[Ne][0].s.c>Ue.c||g[Ne][0].s.r>Ue.r)&&!(g[Ne][0].e.c<Ue.c||g[Ne][0].e.r<Ue.r)){qe.F=fr(g[Ne][0]),(g[Ne][0].s.c!=Ue.c||g[Ne][0].s.r!=Ue.r)&&delete qe.f,qe.f&&(qe.f=""+ls(g[Ne][1],o,Ue,G,w));break}}$e.dense?(s[Ue.r]||(s[Ue.r]=[]),s[Ue.r][Ue.c]=qe):s[h]=qe}},w={enc:!1,sbcch:0,snames:[],sharedf:m,arrayf:g,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(w.password=t.password);var T,R=[],q=[],z=[],ee=[],Y=!1,G=[];G.SheetNames=w.snames,G.sharedf=w.sharedf,G.arrayf=w.arrayf,G.names=[],G.XTI=[];var re=0,U=0,S=0,D=[],L=[],P;w.codepage=1200,ho(1200);for(var I=!1;e.l<e.length-1;){var H=e.l,V=e.read_shift(2);if(V===0&&re===10)break;var W=e.l===e.length?0:e.read_shift(2),M=ew[V];if(M&&M.f){if(t.bookSheets&&re===133&&V!==133)break;if(re=V,M.r===2||M.r==12){var se=e.read_shift(2);if(W-=2,!w.enc&&se!==V&&((se&255)<<8|se>>8)!==V)throw new Error("rt mismatch: "+se+"!="+V);M.r==12&&(e.l+=10,W-=10)}var K={};if(V===10?K=M.f(e,W,w):K=Gce(V,M,e,W,w),U==0&&[9,521,1033,2057].indexOf(re)===-1)continue;switch(V){case 34:r.opts.Date1904=N.WBProps.date1904=K;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(w.enc||(e.l=0),w.enc=K,!t.password)throw new Error("File is password-protected");if(K.valid==null)throw new Error("Encryption scheme unsupported");if(!K.valid)throw new Error("Password is incorrect");break;case 92:w.lastuser=K;break;case 66:var he=Number(K);switch(he){case 21010:he=1200;break;case 32768:he=1e4;break;case 32769:he=1252;break}ho(w.codepage=he),I=!0;break;case 317:w.rrtabid=K;break;case 25:w.winlocked=K;break;case 439:r.opts.RefreshAll=K;break;case 12:r.opts.CalcCount=K;break;case 16:r.opts.CalcDelta=K;break;case 17:r.opts.CalcIter=K;break;case 13:r.opts.CalcMode=K;break;case 14:r.opts.CalcPrecision=K;break;case 95:r.opts.CalcSaveRecalc=K;break;case 15:w.CalcRefMode=K;break;case 2211:r.opts.FullCalc=K;break;case 129:K.fDialog&&(s["!type"]="dialog"),K.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),K.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:_.push(K);break;case 430:G.push([K]),G[G.length-1].XTI=[];break;case 35:case 547:G[G.length-1].push(K);break;case 24:case 536:P={Name:K.Name,Ref:ls(K.rgce,o,null,G,w)},K.itab>0&&(P.Sheet=K.itab-1),G.names.push(P),G[0]||(G[0]=[],G[0].XTI=[]),G[G.length-1].push(K),K.Name=="_xlnm._FilterDatabase"&&K.itab>0&&K.rgce&&K.rgce[0]&&K.rgce[0][0]&&K.rgce[0][0][0]=="PtgArea3d"&&(L[K.itab-1]={ref:fr(K.rgce[0][0][1][2])});break;case 22:w.ExternCount=K;break;case 23:G.length==0&&(G[0]=[],G[0].XTI=[]),G[G.length-1].XTI=G[G.length-1].XTI.concat(K),G.XTI=G.XTI.concat(K);break;case 2196:if(w.biff<8)break;P!=null&&(P.Comment=K[1]);break;case 18:s["!protect"]=K;break;case 19:K!==0&&w.WTF&&console.error("Password verifier: "+K);break;case 133:i[K.pos]=K,w.snames.push(K.name);break;case 10:{if(--U)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,s["!ref"]=fr(o),t.sheetRows&&t.sheetRows<=o.e.r){var ne=o.e.r;o.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=fr(o),o.e.r=ne}o.e.r++,o.e.c++}R.length>0&&(s["!merges"]=R),q.length>0&&(s["!objects"]=q),z.length>0&&(s["!cols"]=z),ee.length>0&&(s["!rows"]=ee),N.Sheets.push(B)}d===""?u=s:a[d]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(w.biff===8&&(w.biff={9:2,521:3,1033:4}[V]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[K.BIFFVer]||8),w.biffguess=K.BIFFVer==0,K.BIFFVer==0&&K.dt==4096&&(w.biff=5,I=!0,ho(w.codepage=28591)),w.biff==8&&K.BIFFVer==0&&K.dt==16&&(w.biff=2),U++)break;if(s=t.dense?[]:{},w.biff<8&&!I&&(I=!0,ho(w.codepage=t.codepage||1252)),w.biff<5||K.BIFFVer==0&&K.dt==4096){d===""&&(d="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var te={pos:e.l-W,name:d};i[te.pos]=te,w.snames.push(d)}else d=(i[H]||{name:""}).name;K.dt==32&&(s["!type"]="chart"),K.dt==64&&(s["!type"]="macro"),R=[],q=[],w.arrayf=g=[],z=[],ee=[],Y=!1,B={Hidden:(i[H]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[K.r]||[])[K.c]:s[sr({c:K.c,r:K.r})])&&++K.c,y={ixfe:K.ixfe,XF:_[K.ixfe]||{},v:K.val,t:"n"},S>0&&(y.z=D[y.ixfe>>8&63]),Do(y,t,r.opts.Date1904),k({c:K.c,r:K.r},y,t);break;case 5:case 517:y={ixfe:K.ixfe,XF:_[K.ixfe],v:K.val,t:K.t},S>0&&(y.z=D[y.ixfe>>8&63]),Do(y,t,r.opts.Date1904),k({c:K.c,r:K.r},y,t);break;case 638:y={ixfe:K.ixfe,XF:_[K.ixfe],v:K.rknum,t:"n"},S>0&&(y.z=D[y.ixfe>>8&63]),Do(y,t,r.opts.Date1904),k({c:K.c,r:K.r},y,t);break;case 189:for(var ce=K.c;ce<=K.C;++ce){var _e=K.rkrec[ce-K.c][0];y={ixfe:_e,XF:_[_e],v:K.rkrec[ce-K.c][1],t:"n"},S>0&&(y.z=D[y.ixfe>>8&63]),Do(y,t,r.opts.Date1904),k({c:ce,r:K.r},y,t)}break;case 6:case 518:case 1030:{if(K.val=="String"){l=K;break}if(y=Rm(K.val,K.cell.ixfe,K.tt),y.XF=_[y.ixfe],t.cellFormula){var de=K.formula;if(de&&de[0]&&de[0][0]&&de[0][0][0]=="PtgExp"){var ye=de[0][0][1][0],Le=de[0][0][1][1],we=sr({r:ye,c:Le});m[we]?y.f=""+ls(K.formula,o,K.cell,G,w):y.F=((t.dense?(s[ye]||[])[Le]:s[we])||{}).F}else y.f=""+ls(K.formula,o,K.cell,G,w)}S>0&&(y.z=D[y.ixfe>>8&63]),Do(y,t,r.opts.Date1904),k(K.cell,y,t),l=K}break;case 7:case 519:if(l)l.val=K,y=Rm(K,l.cell.ixfe,"s"),y.XF=_[y.ixfe],t.cellFormula&&(y.f=""+ls(l.formula,o,l.cell,G,w)),S>0&&(y.z=D[y.ixfe>>8&63]),Do(y,t,r.opts.Date1904),k(l.cell,y,t),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{g.push(K);var ge=sr(K[0].s);if(A=t.dense?(s[K[0].s.r]||[])[K[0].s.c]:s[ge],t.cellFormula&&A){if(!l||!ge||!A)break;A.f=""+ls(K[1],o,K[0],G,w),A.F=fr(K[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!l)break;m[sr(l.cell)]=K[0],A=t.dense?(s[l.cell.r]||[])[l.cell.c]:s[sr(l.cell)],(A||{}).f=""+ls(K[0],o,f,G,w)}}break;case 253:y=Rm(c[K.isst].t,K.ixfe,"s"),c[K.isst].h&&(y.h=c[K.isst].h),y.XF=_[y.ixfe],S>0&&(y.z=D[y.ixfe>>8&63]),Do(y,t,r.opts.Date1904),k({c:K.c,r:K.r},y,t);break;case 513:t.sheetStubs&&(y={ixfe:K.ixfe,XF:_[K.ixfe],t:"z"},S>0&&(y.z=D[y.ixfe>>8&63]),Do(y,t,r.opts.Date1904),k({c:K.c,r:K.r},y,t));break;case 190:if(t.sheetStubs)for(var Re=K.c;Re<=K.C;++Re){var et=K.ixfe[Re-K.c];y={ixfe:et,XF:_[et],t:"z"},S>0&&(y.z=D[y.ixfe>>8&63]),Do(y,t,r.opts.Date1904),k({c:Re,r:K.r},y,t)}break;case 214:case 516:case 4:y=Rm(K.val,K.ixfe,"s"),y.XF=_[y.ixfe],S>0&&(y.z=D[y.ixfe>>8&63]),Do(y,t,r.opts.Date1904),k({c:K.c,r:K.r},y,t);break;case 0:case 512:U===1&&(o=K);break;case 252:c=K;break;case 1054:if(w.biff==4){D[S++]=K[1];for(var Ye=0;Ye<S+163&&nr[Ye]!=K[1];++Ye);Ye>=163&&Tl(K[1],S+163)}else Tl(K[1],K[0]);break;case 30:{D[S++]=K;for(var Be=0;Be<S+163&&nr[Be]!=K;++Be);Be>=163&&Tl(K,S+163)}break;case 229:R=R.concat(K);break;case 93:q[K.cmo[0]]=w.lastobj=K;break;case 438:w.lastobj.TxO=K;break;case 127:w.lastobj.ImData=K;break;case 440:for(b=K[0].s.r;b<=K[0].e.r;++b)for(p=K[0].s.c;p<=K[0].e.c;++p)A=t.dense?(s[b]||[])[p]:s[sr({c:p,r:b})],A&&(A.l=K[1]);break;case 2048:for(b=K[0].s.r;b<=K[0].e.r;++b)for(p=K[0].s.c;p<=K[0].e.c;++p)A=t.dense?(s[b]||[])[p]:s[sr({c:p,r:b})],A&&A.l&&(A.l.Tooltip=K[1]);break;case 28:{if(w.biff<=5&&w.biff>=2)break;A=t.dense?(s[K[0].r]||[])[K[0].c]:s[sr(K[0])];var Fe=q[K[2]];A||(t.dense?(s[K[0].r]||(s[K[0].r]=[]),A=s[K[0].r][K[0].c]={t:"z"}):A=s[sr(K[0])]={t:"z"},o.e.r=Math.max(o.e.r,K[0].r),o.s.r=Math.min(o.s.r,K[0].r),o.e.c=Math.max(o.e.c,K[0].c),o.s.c=Math.min(o.s.c,K[0].c)),A.c||(A.c=[]),x={a:K[1],t:Fe.TxO.t},A.c.push(x)}break;case 2173:Oae(_[K.ixfe],K.ext);break;case 125:{if(!w.cellStyles)break;for(;K.e>=K.s;)z[K.e--]={width:K.w/256,level:K.level||0,hidden:!!(K.flags&1)},Y||(Y=!0,M2(K.w/256)),Wc(z[K.e+1])}break;case 520:{var oe={};K.level!=null&&(ee[K.r]=oe,oe.level=K.level),K.hidden&&(ee[K.r]=oe,oe.hidden=!0),K.hpt&&(ee[K.r]=oe,oe.hpt=K.hpt,oe.hpx=QA(K.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||qd(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[V]]=K;break;case 161:s["!margins"]||qd(s["!margins"]={}),s["!margins"].header=K.header,s["!margins"].footer=K.footer;break;case 574:K.RTL&&(N.Views[0].RTL=!0);break;case 146:j=K;break;case 2198:T=K;break;case 140:v=K;break;case 442:d?B.CodeName=K||B.name:N.WBProps.CodeName=K||"ThisWorkbook";break}}else M||console.error("Missing Info for XLS Record 0x"+V.toString(16)),e.l+=W}return r.SheetNames=Mn(i).sort(function(ke,Ue){return Number(ke)-Number(Ue)}).map(function(ke){return i[ke].name}),t.bookSheets||(r.Sheets=a),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&L.forEach(function(ke,Ue){r.Sheets[r.SheetNames[Ue]]["!autofilter"]=ke}),r.Strings=c,r.SSF=yn(nr),w.enc&&(r.Encryption=w.enc),T&&(r.Themes=T),r.Metadata={},v!==void 0&&(r.Metadata.Country=v),G.names.length>0&&(N.Names=G.names),r.Workbook=N,r}var Qf={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Yce(e,t,r){var a=er.find(e,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var s=sS(a,W_,Qf.DSI);for(var i in s)t[i]=s[i]}catch(d){if(r.WTF)throw d}var o=er.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var l=sS(o,z_,Qf.SI);for(var c in l)t[c]==null&&(t[c]=l[c])}catch(d){if(r.WTF)throw d}t.HeadingPairs&&t.TitlesOfParts&&(KT(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function Jce(e,t){var r=[],a=[],s=[],i=0,o,l=LC(W_,"n"),c=LC(z_,"n");if(e.Props)for(o=Mn(e.Props),i=0;i<o.length;++i)(Object.prototype.hasOwnProperty.call(l,o[i])?r:Object.prototype.hasOwnProperty.call(c,o[i])?a:s).push([o[i],e.Props[o[i]]]);if(e.Custprops)for(o=Mn(e.Custprops),i=0;i<o.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},o[i])||(Object.prototype.hasOwnProperty.call(l,o[i])?r:Object.prototype.hasOwnProperty.call(c,o[i])?a:s).push([o[i],e.Custprops[o[i]]]);var d=[];for(i=0;i<s.length;++i)JT.indexOf(s[i][0])>-1||$T.indexOf(s[i][0])>-1||s[i][1]!=null&&d.push(s[i]);a.length&&er.utils.cfb_add(t,"/SummaryInformation",iS(a,Qf.SI,c,z_)),(r.length||d.length)&&er.utils.cfb_add(t,"/DocumentSummaryInformation",iS(r,Qf.DSI,l,W_,d.length?d:null,Qf.UDI))}function WI(e,t){t||(t={}),G2(t),m2(),t.codepage&&p2(t.codepage);var r,a;if(e.FullPaths){if(er.find(e,"/encryption"))throw new Error("File is password-protected");r=er.find(e,"!CompObj"),a=er.find(e,"/Workbook")||er.find(e,"/Book")}else{switch(t.type){case"base64":e=ui(xi(e));break;case"binary":e=ui(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Ka(e,0),a={content:e}}var s,i;if(r&&Wce(r),t.bookProps&&!t.bookSheets)s={};else{var o=yr?"buffer":"array";if(a&&a.content)s=Xce(a.content,t);else if((i=er.find(e,"PerfectOffice_MAIN"))&&i.content)s=Hd.to_workbook(i.content,(t.type=o,t));else if((i=er.find(e,"NativeContent_MAIN"))&&i.content)s=Hd.to_workbook(i.content,(t.type=o,t));else throw(i=er.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&er.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=use(e))}var l={};return e.FullPaths&&Yce(e,l,t),s.Props=s.Custprops=l,t.bookFiles&&(s.cfb=e),s}function Zce(e,t){var r=t||{},a=er.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return er.utils.cfb_add(a,s,zI(e,r)),r.biff==8&&(e.Props||e.Custprops)&&Jce(e,a),r.biff==8&&e.vbaraw&&Ase(a,er.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),a}var S0={0:{f:woe},1:{f:Foe},2:{f:Xoe},3:{f:Roe},4:{f:Loe},5:{f:Woe},6:{f:tle},7:{f:qoe},8:{f:lle},9:{f:ole},10:{f:sle},11:{f:ile},12:{f:Ioe},13:{f:Joe},14:{f:Qoe},15:{f:Ooe},16:{f:RI},17:{f:nle},18:{f:Koe},19:{f:E2},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:nce},40:{},42:{},43:{f:tae},44:{f:Zne},45:{f:aae},46:{f:iae},47:{f:sae},48:{},49:{f:kee},50:{},51:{f:Mae},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:cI},62:{f:ele},63:{f:Gae},64:{f:Nle},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:ps,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:vle},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Boe},148:{f:koe,p:16},151:{f:fle},152:{},153:{f:ece},154:{},155:{},156:{f:Jle},157:{},158:{},159:{T:1,f:mne},160:{T:-1},161:{T:1,f:Au},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:cle},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Uae},336:{T:-1},337:{f:qae,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:V_},357:{},358:{},359:{},360:{T:1},361:{},362:{f:lI},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:ple},427:{f:mle},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:xle},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Soe},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:Ale},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:V_},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:ise},633:{T:1},634:{T:-1},635:{T:1,f:ase},636:{T:-1},637:{f:Eee},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Qle},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:jle},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},ew={6:{f:D1},10:{f:hc},12:{f:ia},13:{f:ia},14:{f:Vn},15:{f:Vn},16:{f:As},17:{f:Vn},18:{f:Vn},19:{f:ia},20:{f:AS},21:{f:AS},23:{f:lI},24:{f:fS},25:{f:Vn},26:{},27:{},28:{f:jre},29:{},34:{f:Vn},35:{f:hS},38:{f:As},39:{f:As},40:{f:As},41:{f:As},42:{f:Vn},43:{f:Vn},47:{f:One},49:{f:Jte},51:{f:ia},60:{},61:{f:Wte},64:{f:Vn},65:{f:Yte},66:{f:ia},77:{},80:{},81:{},82:{},85:{f:ia},89:{},90:{},91:{},92:{f:Pte},93:{f:Sre},94:{},95:{f:Vn},96:{},97:{},99:{f:Vn},125:{f:cI},128:{f:hre},129:{f:Ute},130:{f:ia},131:{f:Vn},132:{f:Vn},133:{f:Rte},134:{},140:{f:Pre},141:{f:ia},144:{},146:{f:Rre},151:{},152:{},153:{},154:{},155:{},156:{f:ia},157:{},158:{},160:{f:Vre},161:{f:Hre},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:cre},190:{f:dre},193:{f:hc},197:{},198:{},199:{},200:{},201:{},202:{f:Vn},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:ia},220:{},221:{f:Vn},222:{},224:{f:Are},225:{f:Lte},226:{f:hc},227:{},229:{f:kre},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Qte},253:{f:ere},255:{f:qte},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:ZT},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Vn},353:{f:hc},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:xre},431:{f:Vn},432:{},433:{},434:{},437:{},438:{f:Fre},439:{f:Vn},440:{f:Tre},441:{},442:{f:K0},443:{},444:{f:ia},445:{},446:{},448:{f:hc},449:{f:Vte,r:2},450:{f:hc},512:{f:cS},513:{f:Kre},515:{f:mre},516:{f:rre},517:{f:uS},519:{f:Wre},520:{f:$te},523:{},545:{f:pS},549:{f:lS},566:{},574:{f:Gte},638:{f:lre},659:{},1048:{},1054:{f:are},1084:{},1212:{f:_re},2048:{f:Dre},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Pm},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:hc},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:Mre,r:12},2173:{f:Pae,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Vn,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:bre,r:12},2197:{},2198:{f:Eae,r:12},2199:{},2200:{},2201:{},2202:{f:wre,r:12},2203:{f:hc},2204:{},2205:{},2206:{},2207:{},2211:{f:Kte},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:ia},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:qre},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:Ure},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:cS},1:{},2:{f:Jre},3:{f:Xre},4:{f:Gre},5:{f:uS},7:{f:ene},8:{},9:{f:Pm},11:{},22:{f:ia},30:{f:ire},31:{},32:{},33:{f:pS},36:{},37:{f:lS},50:{f:tne},62:{},52:{},67:{},68:{f:ia},69:{},86:{},126:{},127:{f:zre},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:rne},223:{},234:{},354:{},421:{},518:{f:D1},521:{f:Pm},536:{f:fS},547:{f:hS},561:{},579:{},1030:{f:D1},1033:{f:Pm},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Bt(e,t,r,a){var s=t;if(!isNaN(s)){var i=a||(r||[]).length||0,o=e.next(4);o.write_shift(2,s),o.write_shift(2,i),i>0&&C2(r)&&e.push(r)}}function ede(e,t,r,a){var s=(r||[]).length||0;if(s<=8224)return Bt(e,t,r,s);var i=t;if(!isNaN(i)){for(var o=r.parts||[],l=0,c=0,d=0;d+(o[l]||8224)<=8224;)d+=o[l]||8224,l++;var u=e.next(4);for(u.write_shift(2,i),u.write_shift(2,d),e.push(r.slice(c,c+d)),c+=d;c<s;){for(u=e.next(4),u.write_shift(2,60),d=0;d+(o[l]||8224)<=8224;)d+=o[l]||8224,l++;u.write_shift(2,d),e.push(r.slice(c,c+d)),c+=d}}}function G0(e,t,r){return e||(e=ct(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function tde(e,t,r,a){var s=ct(9);return G0(s,e,t),eI(r,a||"b",s),s}function rde(e,t,r){var a=ct(8+2*r.length);return G0(a,e,t),a.write_shift(1,r.length),a.write_shift(r.length,r,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function nde(e,t,r,a){if(t.v!=null)switch(t.t){case"d":case"n":var s=t.t=="d"?ka(xn(t.v)):t.v;s==(s|0)&&s>=0&&s<65536?Bt(e,2,Zre(r,a,s)):Bt(e,3,Yre(r,a,s));return;case"b":case"e":Bt(e,5,tde(r,a,t.v,t.t));return;case"s":case"str":Bt(e,4,rde(r,a,(t.v||"").slice(0,255)));return}Bt(e,1,G0(null,r,a))}function ade(e,t,r,a){var s=Array.isArray(t),i=Or(t["!ref"]||"A1"),o,l="",c=[];if(i.e.c>255||i.e.r>16383){if(a.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),o=fr(i)}for(var d=i.s.r;d<=i.e.r;++d){l=Jn(d);for(var u=i.s.c;u<=i.e.c;++u){d===i.s.r&&(c[u]=kn(u)),o=c[u]+l;var f=s?(t[d]||[])[u]:t[o];f&&nde(e,f,d,u)}}}function sde(e,t){for(var r=t||{},a=Vs(),s=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(s=i);if(s==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Bt(a,r.biff==4?1033:r.biff==3?521:9,O2(e,16,r)),ade(a,e.Sheets[e.SheetNames[s]],s,r),Bt(a,10),a.end()}function ide(e,t,r){Bt(e,49,Zte({sz:12,name:"Arial"},r))}function ode(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)t[s]!=null&&Bt(e,1054,sre(s,t[s],r))})}function lde(e,t){var r=ct(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Bt(e,2151,r),r=ct(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),sI(Or(t["!ref"]||"A1"),r),r.write_shift(4,4),Bt(e,2152,r)}function cde(e,t){for(var r=0;r<16;++r)Bt(e,224,dS({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(a){Bt(e,224,dS(a,0,t))})}function dde(e,t){for(var r=0;r<t["!links"].length;++r){var a=t["!links"][r];Bt(e,440,Ire(a)),a[1].Tooltip&&Bt(e,2048,Lre(a))}delete t["!links"]}function ude(e,t){if(t){var r=0;t.forEach(function(a,s){++r<=256&&a&&Bt(e,125,Qre(fy(s,a),s))})}}function Ade(e,t,r,a,s){var i=16+td(s.cellXfs,t,s);if(t.v==null&&!t.bf){Bt(e,513,ru(r,a,i));return}if(t.bf)Bt(e,6,Uie(t,r,a,s,i));else switch(t.t){case"d":case"n":var o=t.t=="d"?ka(xn(t.v)):t.v;Bt(e,515,gre(r,a,o,i));break;case"b":case"e":Bt(e,517,pre(r,a,t.v,i,s,t.t));break;case"s":case"str":if(s.bookSST){var l=K2(s.Strings,t.v,s.revStrings);Bt(e,253,tre(r,a,l,i))}else Bt(e,516,nre(r,a,(t.v||"").slice(0,255),i,s));break;default:Bt(e,513,ru(r,a,i))}}function hde(e,t,r){var a=Vs(),s=r.SheetNames[e],i=r.Sheets[s]||{},o=(r||{}).Workbook||{},l=(o.Sheets||[])[e]||{},c=Array.isArray(i),d=t.biff==8,u,f="",h=[],A=Or(i["!ref"]||"A1"),x=d?65536:16384;if(A.e.c>255||A.e.r>=x){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");A.e.c=Math.min(A.e.c,255),A.e.r=Math.min(A.e.c,x-1)}Bt(a,2057,O2(r,16,t)),Bt(a,13,Ii(1)),Bt(a,12,Ii(100)),Bt(a,15,ks(!0)),Bt(a,17,ks(!1)),Bt(a,16,eu(.001)),Bt(a,95,ks(!0)),Bt(a,42,ks(!1)),Bt(a,43,ks(!1)),Bt(a,130,Ii(1)),Bt(a,128,fre()),Bt(a,131,ks(!1)),Bt(a,132,ks(!1)),d&&ude(a,i["!cols"]),Bt(a,512,ore(A,t)),d&&(i["!links"]=[]);for(var p=A.s.r;p<=A.e.r;++p){f=Jn(p);for(var b=A.s.c;b<=A.e.c;++b){p===A.s.r&&(h[b]=kn(b)),u=h[b]+f;var m=c?(i[p]||[])[b]:i[u];m&&(Ade(a,m,p,b,t),d&&m.l&&i["!links"].push([u,m.l]))}}var g=l.CodeName||l.name||s;return d&&Bt(a,574,Xte((o.Views||[])[0])),d&&(i["!merges"]||[]).length&&Bt(a,229,Cre(i["!merges"])),d&&dde(a,i),Bt(a,442,tI(g)),d&&lde(a,i),Bt(a,10),a.end()}function fde(e,t,r){var a=Vs(),s=(e||{}).Workbook||{},i=s.Sheets||[],o=s.WBProps||{},l=r.biff==8,c=r.biff==5;if(Bt(a,2057,O2(e,5,r)),r.bookType=="xla"&&Bt(a,135),Bt(a,225,l?Ii(1200):null),Bt(a,193,pte(2)),c&&Bt(a,191),c&&Bt(a,192),Bt(a,226),Bt(a,92,Ote("SheetJS",r)),Bt(a,66,Ii(l?1200:1252)),l&&Bt(a,353,Ii(0)),l&&Bt(a,448),Bt(a,317,$re(e.SheetNames.length)),l&&e.vbaraw&&Bt(a,211),l&&e.vbaraw){var d=o.CodeName||"ThisWorkbook";Bt(a,442,tI(d))}Bt(a,156,Ii(17)),Bt(a,25,ks(!1)),Bt(a,18,ks(!1)),Bt(a,19,Ii(0)),l&&Bt(a,431,ks(!1)),l&&Bt(a,444,Ii(0)),Bt(a,61,zte()),Bt(a,64,ks(!1)),Bt(a,141,Ii(0)),Bt(a,34,ks(Vle(e)=="true")),Bt(a,14,ks(!0)),l&&Bt(a,439,ks(!1)),Bt(a,218,Ii(0)),ide(a,e,r),ode(a,e.SSF,r),cde(a,r),l&&Bt(a,352,ks(!1));var u=a.end(),f=Vs();l&&Bt(f,140,Ore()),l&&r.Strings&&ede(f,252,Hte(r.Strings)),Bt(f,10);var h=f.end(),A=Vs(),x=0,p=0;for(p=0;p<e.SheetNames.length;++p)x+=(l?12:11)+(l?2:1)*e.SheetNames[p].length;var b=u.length+x+h.length;for(p=0;p<e.SheetNames.length;++p){var m=i[p]||{};Bt(A,133,Mte({pos:b,hs:m.Hidden||0,dt:0,name:e.SheetNames[p]},r)),b+=t[p].length}var g=A.end();if(x!=g.length)throw new Error("BS8 "+x+" != "+g.length);var y=[];return u.length&&y.push(u),g.length&&y.push(g),h.length&&y.push(h),Ta(y)}function pde(e,t){var r=t||{},a=[];e&&!e.SSF&&(e.SSF=yn(nr)),e&&e.SSF&&(th(),oy(e.SSF),r.revssf=cy(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,X2(r),r.cellXfs=[],td(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)a[a.length]=hde(s,r,e);return a.unshift(fde(e,a,r)),Ta(a)}function zI(e,t){for(var r=0;r<=e.SheetNames.length;++r){var a=e.Sheets[e.SheetNames[r]];if(!(!a||!a["!ref"])){var s=Ws(a["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return pde(e,t);case 4:case 3:case 2:return sde(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function jS(e,t){var r=t||{},a=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),o=s.index,l=i&&i.index||e.length,c=ZZ(e.slice(o,l),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,u=0,f=0,h=0,A={s:{r:1e7,c:1e7},e:{r:0,c:0}},x=[];for(o=0;o<c.length;++o){var p=c[o].trim(),b=p.slice(0,3).toLowerCase();if(b=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}u=0;continue}if(!(b!="<td"&&b!="<th")){var m=p.split(/<\/t[dh]>/i);for(l=0;l<m.length;++l){var g=m[l].trim();if(g.match(/<t[dh]/i)){for(var y=g,v=0;y.charAt(0)=="<"&&(v=y.indexOf(">"))>-1;)y=y.slice(v+1);for(var _=0;_<x.length;++_){var j=x[_];j.s.c==u&&j.s.r<d&&d<=j.e.r&&(u=j.e.c+1,_=-1)}var N=or(g.slice(0,g.indexOf(">")));h=N.colspan?+N.colspan:1,((f=+N.rowspan)>1||h>1)&&x.push({s:{r:d,c:u},e:{r:d+(f||1)-1,c:u+h-1}});var B=N.t||N["data-t"]||"";if(!y.length){u+=h;continue}if(y=xT(y),A.s.r>d&&(A.s.r=d),A.e.r<d&&(A.e.r=d),A.s.c>u&&(A.s.c=u),A.e.c<u&&(A.e.c=u),!y.length){u+=h;continue}var E={t:"s",v:y};r.raw||!y.trim().length||B=="s"||(y==="TRUE"?E={t:"b",v:!0}:y==="FALSE"?E={t:"b",v:!1}:isNaN(go(y))?isNaN(RA(y).getDate())||(E={t:"d",v:xn(y)},r.cellDates||(E={t:"n",v:ka(E.v)}),E.z=r.dateNF||nr[14]):E={t:"n",v:go(y)}),r.dense?(a[d]||(a[d]=[]),a[d][u]=E):a[sr({r:d,c:u})]=E,u+=h}}}}return a["!ref"]=fr(A),x.length&&(a["!merges"]=x),a}function mde(e,t,r,a){for(var s=e["!merges"]||[],i=[],o=t.s.c;o<=t.e.c;++o){for(var l=0,c=0,d=0;d<s.length;++d)if(!(s[d].s.r>r||s[d].s.c>o)&&!(s[d].e.r<r||s[d].e.c<o)){if(s[d].s.r<r||s[d].s.c<o){l=-1;break}l=s[d].e.r-s[d].s.r+1,c=s[d].e.c-s[d].s.c+1;break}if(!(l<0)){var u=sr({r,c:o}),f=a.dense?(e[r]||[])[o]:e[u],h=f&&f.v!=null&&(f.h||N2(f.w||(Ql(f),f.w)||""))||"",A={};l>1&&(A.rowspan=l),c>1&&(A.colspan=c),a.editable?h='<span contenteditable="true">'+h+"</span>":f&&(A["data-t"]=f&&f.t||"z",f.v!=null&&(A["data-v"]=f.v),f.z!=null&&(A["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+f.l.Target+'">'+h+"</a>")),A.id=(a.id||"sjs")+"-"+u,i.push(St("td",h,A))}}var x="<tr>";return x+i.join("")+"</tr>"}var gde='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',xde="</body></html>";function yde(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return ed(jS(r[0],t),t);var a=Z2();return r.forEach(function(s,i){eN(a,jS(s,t),"Sheet"+(i+1))}),a}function vde(e,t,r){var a=[];return a.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function GI(e,t){var r=t||{},a=r.header!=null?r.header:gde,s=r.footer!=null?r.footer:xde,i=[a],o=Ws(e["!ref"]);r.dense=Array.isArray(e),i.push(vde(e,o,r));for(var l=o.s.r;l<=o.e.r;++l)i.push(mde(e,o,l,r));return i.push("</table>"+s),i.join("")}function XI(e,t,r){var a=r||{},s=0,i=0;if(a.origin!=null)if(typeof a.origin=="number")s=a.origin;else{var o=typeof a.origin=="string"?Cn(a.origin):a.origin;s=o.r,i=o.c}var l=t.getElementsByTagName("tr"),c=Math.min(a.sheetRows||1e7,l.length),d={s:{r:0,c:0},e:{r:s,c:i}};if(e["!ref"]){var u=Ws(e["!ref"]);d.s.r=Math.min(d.s.r,u.s.r),d.s.c=Math.min(d.s.c,u.s.c),d.e.r=Math.max(d.e.r,u.e.r),d.e.c=Math.max(d.e.c,u.e.c),s==-1&&(d.e.r=s=u.e.r+1)}var f=[],h=0,A=e["!rows"]||(e["!rows"]=[]),x=0,p=0,b=0,m=0,g=0,y=0;for(e["!cols"]||(e["!cols"]=[]);x<l.length&&p<c;++x){var v=l[x];if(kS(v)){if(a.display)continue;A[p]={hidden:!0}}var _=v.children;for(b=m=0;b<_.length;++b){var j=_[b];if(!(a.display&&kS(j))){var N=j.hasAttribute("data-v")?j.getAttribute("data-v"):j.hasAttribute("v")?j.getAttribute("v"):xT(j.innerHTML),B=j.getAttribute("data-z")||j.getAttribute("z");for(h=0;h<f.length;++h){var E=f[h];E.s.c==m+i&&E.s.r<p+s&&p+s<=E.e.r&&(m=E.e.c+1-i,h=-1)}y=+j.getAttribute("colspan")||1,((g=+j.getAttribute("rowspan")||1)>1||y>1)&&f.push({s:{r:p+s,c:m+i},e:{r:p+s+(g||1)-1,c:m+i+(y||1)-1}});var C={t:"s",v:N},k=j.getAttribute("data-t")||j.getAttribute("t")||"";N!=null&&(N.length==0?C.t=k||"z":a.raw||N.trim().length==0||k=="s"||(N==="TRUE"?C={t:"b",v:!0}:N==="FALSE"?C={t:"b",v:!1}:isNaN(go(N))?isNaN(RA(N).getDate())||(C={t:"d",v:xn(N)},a.cellDates||(C={t:"n",v:ka(C.v)}),C.z=a.dateNF||nr[14]):C={t:"n",v:go(N)})),C.z===void 0&&B!=null&&(C.z=B);var w="",T=j.getElementsByTagName("A");if(T&&T.length)for(var R=0;R<T.length&&!(T[R].hasAttribute("href")&&(w=T[R].getAttribute("href"),w.charAt(0)!="#"));++R);w&&w.charAt(0)!="#"&&(C.l={Target:w}),a.dense?(e[p+s]||(e[p+s]=[]),e[p+s][m+i]=C):e[sr({c:m+i,r:p+s})]=C,d.e.c<m+i&&(d.e.c=m+i),m+=y}}++p}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),d.e.r=Math.max(d.e.r,p-1+s),e["!ref"]=fr(d),p>=c&&(e["!fullref"]=fr((d.e.r=l.length-x+p-1+s,d))),e}function YI(e,t){var r=t||{},a=r.dense?[]:{};return XI(a,e,t)}function bde(e,t){return ed(YI(e,t),t)}function kS(e){var t="",r=_de(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function _de(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function wde(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Dr(t.replace(/<[^>]*>/g,""));return[r]}var CS={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function JI(e,t){var r=t||{},a=j2(e),s=[],i,o,l={name:""},c="",d=0,u,f,h={},A=[],x=r.dense?[]:{},p,b,m={value:""},g="",y=0,v=[],_=-1,j=-1,N={s:{r:1e6,c:1e7},e:{r:0,c:0}},B=0,E={},C=[],k={},w=0,T=0,R=[],q=1,z=1,ee=[],Y={Names:[]},G={},re=["",""],U=[],S={},D="",L=0,P=!1,I=!1,H=0;for(_0.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=_0.exec(a);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"":p[1]==="/"?(N.e.c>=N.s.c&&N.e.r>=N.s.r?x["!ref"]=fr(N):x["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=N.e.r&&(x["!fullref"]=x["!ref"],N.e.r=r.sheetRows-1,x["!ref"]=fr(N)),C.length&&(x["!merges"]=C),R.length&&(x["!rows"]=R),u.name=u.||u.name,typeof JSON<"u"&&JSON.stringify(u),A.push(u.name),h[u.name]=x,I=!1):p[0].charAt(p[0].length-2)!=="/"&&(u=or(p[0],!1),_=j=-1,N.s.r=N.s.c=1e7,N.e.r=N.e.c=0,x=r.dense?[]:{},C=[],R=[],I=!0);break;case"table-row-group":p[1]==="/"?--B:++B;break;case"table-row":case"":if(p[1]==="/"){_+=q,q=1;break}if(f=or(p[0],!1),f.?_=f.-1:_==-1&&(_=0),q=+f["number-rows-repeated"]||1,q<10)for(H=0;H<q;++H)B>0&&(R[_+H]={level:B});j=-1;break;case"covered-table-cell":p[1]!=="/"&&++j,r.sheetStubs&&(r.dense?(x[_]||(x[_]=[]),x[_][j]={t:"z"}):x[sr({r:_,c:j})]={t:"z"}),g="",v=[];break;case"table-cell":case"":if(p[0].charAt(p[0].length-2)==="/")++j,m=or(p[0],!1),z=parseInt(m["number-columns-repeated"]||"1",10),b={t:"z",v:null},m.formula&&r.cellFormula!=!1&&(b.f=_S(Dr(m.formula))),(m.||m["value-type"])=="string"&&(b.t="s",b.v=Dr(m["string-value"]||""),r.dense?(x[_]||(x[_]=[]),x[_][j]=b):x[sr({r:_,c:j})]=b),j+=z-1;else if(p[1]!=="/"){++j,g="",y=0,v=[],z=1;var V=q?_+q-1:_;if(j>N.e.c&&(N.e.c=j),j<N.s.c&&(N.s.c=j),_<N.s.r&&(N.s.r=_),V>N.e.r&&(N.e.r=V),m=or(p[0],!1),U=[],S={},b={t:m.||m["value-type"],v:null},r.cellFormula)if(m.formula&&(m.formula=Dr(m.formula)),m["number-matrix-columns-spanned"]&&m["number-matrix-rows-spanned"]&&(w=parseInt(m["number-matrix-rows-spanned"],10)||0,T=parseInt(m["number-matrix-columns-spanned"],10)||0,k={s:{r:_,c:j},e:{r:_+w-1,c:j+T-1}},b.F=fr(k),ee.push([k,b.F])),m.formula)b.f=_S(m.formula);else for(H=0;H<ee.length;++H)_>=ee[H][0].s.r&&_<=ee[H][0].e.r&&j>=ee[H][0].s.c&&j<=ee[H][0].e.c&&(b.F=ee[H][1]);switch((m["number-columns-spanned"]||m["number-rows-spanned"])&&(w=parseInt(m["number-rows-spanned"],10)||0,T=parseInt(m["number-columns-spanned"],10)||0,k={s:{r:_,c:j},e:{r:_+w-1,c:j+T-1}},C.push(k)),m["number-columns-repeated"]&&(z=parseInt(m["number-columns-repeated"],10)),b.t){case"boolean":b.t="b",b.v=fn(m["boolean-value"]);break;case"float":b.t="n",b.v=parseFloat(m.value);break;case"percentage":b.t="n",b.v=parseFloat(m.value);break;case"currency":b.t="n",b.v=parseFloat(m.value);break;case"date":b.t="d",b.v=xn(m["date-value"]),r.cellDates||(b.t="n",b.v=ka(b.v)),b.z="m/d/yy";break;case"time":b.t="n",b.v=XZ(m["time-value"])/86400,r.cellDates&&(b.t="d",b.v=dy(b.v)),b.z="HH:MM:SS";break;case"number":b.t="n",b.v=parseFloat(m.);break;default:if(b.t==="string"||b.t==="text"||!b.t)b.t="s",m["string-value"]!=null&&(g=Dr(m["string-value"]),v=[]);else throw new Error("Unsupported value type "+b.t)}}else{if(P=!1,b.t==="s"&&(b.v=g||"",v.length&&(b.R=v),P=y==0),G.Target&&(b.l=G),U.length>0&&(b.c=U,U=[]),g&&r.cellText!==!1&&(b.w=g),P&&(b.t="z",delete b.v),(!P||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=_))for(var W=0;W<q;++W){if(z=parseInt(m["number-columns-repeated"]||"1",10),r.dense)for(x[_+W]||(x[_+W]=[]),x[_+W][j]=W==0?b:yn(b);--z>0;)x[_+W][j+z]=yn(b);else for(x[sr({r:_+W,c:j})]=b;--z>0;)x[sr({r:_+W,c:j+z})]=yn(b);N.e.c<=j&&(N.e.c=j)}z=parseInt(m["number-columns-repeated"]||"1",10),j+=z-1,z=0,b={},g="",v=[]}G={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((i=s.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&s.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((i=s.pop())[0]!==p[3])throw"Bad state: "+i;S.t=g,v.length&&(S.R=v),S.a=D,U.push(S)}else p[0].charAt(p[0].length-2)!=="/"&&s.push([p[3],!1]);D="",L=0,g="",y=0,v=[];break;case"creator":p[1]==="/"?D=a.slice(L,p.index):L=p.index+p[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((i=s.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&s.push([p[3],!1]);g="",y=0,v=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(E[l.name]=c,(i=s.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&(c="",l=or(p[0],!1),s.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":o=or(p[0],!1),c+=CS[p[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":o=or(p[0],!1),c+=CS[p[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":c+=a.slice(d,p.index);break}else d=p.index+p[0].length;break;case"named-range":o=or(p[0],!1),re=L1(o["cell-range-address"]);var M={Name:o.name,Ref:re[0]+"!"+re[1]};I&&(M.Sheet=A.length),Y.Names.push(M);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(p[1]==="/"&&(!m||!m["string-value"])){var se=wde(a.slice(y,p.index));g=(g.length>0?g+`
`:"")+se[0]}else or(p[0],!1),y=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{re=L1(or(p[0])["target-range-address"]),h[re[0]]["!autofilter"]={ref:re[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(G=or(p[0],!1),!G.href)break;G.Target=Dr(G.href),delete G.href,G.Target.charAt(0)=="#"&&G.Target.indexOf(".")>-1?(re=L1(G.Target.slice(1)),G.Target="#"+re[0]+"!"+re[1]):G.Target.match(/^\.\.[\\\/]/)&&(G.Target=G.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(p)}}var K={Sheets:h,SheetNames:A,Workbook:Y};return r.bookSheets&&delete K.Sheets,K}function SS(e,t){t=t||{},Ti(e,"META-INF/manifest.xml")&&Xee(sa(e,"META-INF/manifest.xml"),t);var r=Ai(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var a=JI(Jr(r),t);return Ti(e,"meta.xml")&&(a.Props=HT(sa(e,"meta.xml"))),a}function BS(e,t){return JI(e,t)}var Nde=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+b0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return ea+t}}(),ES=function(){var e=function(i){return Gr(i).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,a=function(i,o,l){var c=[];c.push('      <table:table table:name="'+Gr(o.SheetNames[l])+`" table:style-name="ta1">
`);var d=0,u=0,f=Ws(i["!ref"]||"A1"),h=i["!merges"]||[],A=0,x=Array.isArray(i);if(i["!cols"])for(u=0;u<=f.e.c;++u)c.push("        <table:table-column"+(i["!cols"][u]?' table:style-name="co'+i["!cols"][u].ods+'"':"")+`></table:table-column>
`);var p="",b=i["!rows"]||[];for(d=0;d<f.s.r;++d)p=b[d]?' table:style-name="ro'+b[d].ods+'"':"",c.push("        <table:table-row"+p+`></table:table-row>
`);for(;d<=f.e.r;++d){for(p=b[d]?' table:style-name="ro'+b[d].ods+'"':"",c.push("        <table:table-row"+p+`>
`),u=0;u<f.s.c;++u)c.push(t);for(;u<=f.e.c;++u){var m=!1,g={},y="";for(A=0;A!=h.length;++A)if(!(h[A].s.c>u)&&!(h[A].s.r>d)&&!(h[A].e.c<u)&&!(h[A].e.r<d)){(h[A].s.c!=u||h[A].s.r!=d)&&(m=!0),g["table:number-columns-spanned"]=h[A].e.c-h[A].s.c+1,g["table:number-rows-spanned"]=h[A].e.r-h[A].s.r+1;break}if(m){c.push(r);continue}var v=sr({r:d,c:u}),_=x?(i[d]||[])[u]:i[v];if(_&&_.f&&(g["table:formula"]=Gr($ie(_.f)),_.F&&_.F.slice(0,v.length)==v)){var j=Ws(_.F);g["table:number-matrix-columns-spanned"]=j.e.c-j.s.c+1,g["table:number-matrix-rows-spanned"]=j.e.r-j.s.r+1}if(!_){c.push(t);continue}switch(_.t){case"b":y=_.v?"TRUE":"FALSE",g["office:value-type"]="boolean",g["office:boolean-value"]=_.v?"true":"false";break;case"n":y=_.w||String(_.v||0),g["office:value-type"]="float",g["office:value"]=_.v||0;break;case"s":case"str":y=_.v==null?"":_.v,g["office:value-type"]="string";break;case"d":y=_.w||xn(_.v).toISOString(),g["office:value-type"]="date",g["office:date-value"]=xn(_.v).toISOString(),g["table:style-name"]="ce1";break;default:c.push(t);continue}var N=e(y);if(_.l&&_.l.Target){var B=_.l.Target;B=B.charAt(0)=="#"?"#"+Kie(B.slice(1)):B,B.charAt(0)!="#"&&!B.match(/^\w+:/)&&(B="../"+B),N=St("text:a",N,{"xlink:href":B.replace(/&/g,"&amp;")})}c.push("          "+St("table:table-cell",St("text:p",N,{}),g)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},s=function(i,o){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var u=0;u<d["!cols"].length;++u)if(d["!cols"][u]){var f=d["!cols"][u];if(f.width==null&&f.wpx==null&&f.wch==null)continue;Wc(f),f.ods=l;var h=d["!cols"][u].wpx+"px";i.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),i.push(`  </style:style>
`),++l}}});var c=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var u=0;u<d["!rows"].length;++u)if(d["!rows"][u]){d["!rows"][u].ods=c;var f=d["!rows"][u].hpx+"px";i.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),i.push(`  </style:style>
`),++c}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(o,l){var c=[ea],d=b0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=b0({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+d+u+`>
`),c.push(QT().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+d+`>
`),s(c,o),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=o.SheetNames.length;++f)c.push(a(o.Sheets[o.SheetNames[f]],o,f));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function ZI(e,t){if(t.bookType=="fods")return ES(e,t);var r=b2(),a="",s=[],i=[];return a="mimetype",gr(r,a,"application/vnd.oasis.opendocument.spreadsheet"),a="content.xml",gr(r,a,ES(e,t)),s.push([a,"text/xml"]),i.push([a,"ContentFile"]),a="styles.xml",gr(r,a,Nde(e,t)),s.push([a,"text/xml"]),i.push([a,"StylesFile"]),a="meta.xml",gr(r,a,ea+QT()),s.push([a,"text/xml"]),i.push([a,"MetadataFile"]),a="manifest.rdf",gr(r,a,Zee(i)),s.push([a,"application/rdf+xml"]),a="META-INF/manifest.xml",gr(r,a,Yee(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function nu(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function tw(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Jr(Zc(e))}function jde(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):ui(qo(e))}function kde(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var a=0;a<t.length;++a)if(e[r+a]!=t[a])continue e;return!0}return!1}function Gc(e){var t=e.reduce(function(s,i){return s+i.length},0),r=new Uint8Array(t),a=0;return e.forEach(function(s){r.set(s,a),a+=s.length}),r}function FS(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function Cde(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,a=e[t+14]&1,s=t+13;s>=t;--s)a=a*256+e[s];return(e[t+15]&128?-a:a)*Math.pow(10,r-6176)}function Sde(e,t,r){var a=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,a-6176);e[t+15]|=a>>7,e[t+14]|=(a&127)<<1;for(var i=0;s>=1;++i,s/=256)e[t+i]=s&255;e[t+15]|=r>=0?0:128}function B0(e,t){var r=t?t[0]:0,a=e[r]&127;e:if(e[r++]>=128&&(a|=(e[r]&127)<<7,e[r++]<128||(a|=(e[r]&127)<<14,e[r++]<128)||(a|=(e[r]&127)<<21,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),a}function Vr(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Rn(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Ur(e){for(var t=[],r=[0];r[0]<e.length;){var a=r[0],s=B0(e,r),i=s&7;s=Math.floor(s/8);var o=0,l;if(s==0)break;switch(i){case 0:{for(var c=r[0];e[r[0]++]>=128;);l=e.slice(c,r[0])}break;case 5:o=4,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=B0(e,r),l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(s," at offset ").concat(a))}var d={data:l,type:i};t[s]==null?t[s]=[d]:t[s].push(d)}return t}function Ha(e){var t=[];return e.forEach(function(r,a){r.forEach(function(s){s.data&&(t.push(Vr(a*8+s.type)),s.type==2&&t.push(Vr(s.data.length)),t.push(s.data))})}),Gc(t)}function z2(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function Bi(e){for(var t,r=[],a=[0];a[0]<e.length;){var s=B0(e,a),i=Ur(e.slice(a[0],a[0]+s));a[0]+=s;var o={id:Rn(i[1][0].data),messages:[]};i[2].forEach(function(l){var c=Ur(l.data),d=Rn(c[3][0].data);o.messages.push({meta:c,data:e.slice(a[0],a[0]+d)}),a[0]+=d}),(t=i[3])!=null&&t[0]&&(o.merge=Rn(i[3][0].data)>>>0>0),r.push(o)}return r}function Qu(e){var t=[];return e.forEach(function(r){var a=[];a[1]=[{data:Vr(r.id),type:0}],a[2]=[],r.merge!=null&&(a[3]=[{data:Vr(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(o){s.push(o.data),o.meta[3]=[{type:0,data:Vr(o.data.length)}],a[2].push({data:Ha(o.meta),type:2})});var i=Ha(a);t.push(Vr(i.length)),t.push(i),s.forEach(function(o){return t.push(o)})}),Gc(t)}function Bde(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],a=B0(t,r),s=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=t[r[0]],l>1&&(o|=t[r[0]+1]<<8),l>2&&(o|=t[r[0]+2]<<16),l>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}s.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var c=0,d=0;if(i==1?(d=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(d=(t[r[0]++]>>2)+1,i==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Gc(s)],c==0)throw new Error("Invalid offset 0");if(c>s[0].length)throw new Error("Invalid offset beyond length");if(d>=c)for(s.push(s[0].slice(-c)),d-=c;d>=s[s.length-1].length;)s.push(s[s.length-1]),d-=s[s.length-1].length;s.push(s[0].slice(-c,-c+d))}}var u=Gc(s);if(u.length!=a)throw new Error("Unexpected length: ".concat(u.length," != ").concat(a));return u}function Ei(e){for(var t=[],r=0;r<e.length;){var a=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(Bde(a,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Gc(t)}function Hu(e){for(var t=[],r=0;r<e.length;){var a=Math.min(e.length-r,268435455),s=new Uint8Array(4);t.push(s);var i=Vr(a),o=i.length;t.push(i),a<=60?(o++,t.push(new Uint8Array([a-1<<2]))):a<=256?(o+=2,t.push(new Uint8Array([240,a-1&255]))):a<=65536?(o+=3,t.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(o+=4,t.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(o+=5,t.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),t.push(e.slice(r,r+a)),o+=a,s[0]=0,s[1]=o&255,s[2]=o>>8&255,s[3]=o>>16&255,r+=a}return Gc(t)}function Ede(e,t,r,a){var s=nu(e),i=s.getUint32(4,!0),o=(a>1?12:8)+FS(i&(a>1?3470:398))*4,l=-1,c=-1,d=NaN,u=new Date(2001,0,1);i&512&&(l=s.getUint32(o,!0),o+=4),o+=FS(i&(a>1?12288:4096))*4,i&16&&(c=s.getUint32(o,!0),o+=4),i&32&&(d=s.getFloat64(o,!0),o+=8),i&64&&(u.setTime(u.getTime()+s.getFloat64(o,!0)*1e3),o+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:d};break;case 3:f={t:"s",v:t[c]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:d>0};break;case 7:f={t:"n",v:d/86400};break;case 8:f={t:"e",v:0};break;case 9:if(l>-1)f={t:"s",v:r[l]};else if(c>-1)f={t:"s",v:t[c]};else if(!isNaN(d))f={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function Fde(e,t,r){var a=nu(e),s=a.getUint32(8,!0),i=12,o=-1,l=-1,c=NaN,d=NaN,u=new Date(2001,0,1);s&1&&(c=Cde(e,i),i+=16),s&2&&(d=a.getFloat64(i,!0),i+=8),s&4&&(u.setTime(u.getTime()+a.getFloat64(i,!0)*1e3),i+=8),s&8&&(l=a.getUint32(i,!0),i+=4),s&16&&(o=a.getUint32(i,!0),i+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:t[l]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:d>0};break;case 7:f={t:"n",v:d/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return f}function O1(e,t){var r=new Uint8Array(32),a=nu(r),s=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,Sde(r,s,e.v),i|=1,s+=16;break;case"b":r[1]=6,a.setFloat64(s,e.v?1:0,!0),i|=2,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,a.setUint32(s,t.indexOf(e.v),!0),i|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(8,i,!0),r.slice(0,s)}function U1(e,t){var r=new Uint8Array(32),a=nu(r),s=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,a.setFloat64(s,e.v,!0),i|=32,s+=8;break;case"b":r[2]=6,a.setFloat64(s,e.v?1:0,!0),i|=32,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,a.setUint32(s,t.indexOf(e.v),!0),i|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(4,i,!0),r.slice(0,s)}function Tde(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return Ede(e,t,r,e[0]);case 5:return Fde(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function is(e){var t=Ur(e);return B0(t[1][0].data)}function TS(e,t){var r=Ur(t.data),a=Rn(r[1][0].data),s=r[3],i=[];return(s||[]).forEach(function(o){var l=Ur(o.data),c=Rn(l[1][0].data)>>>0;switch(a){case 1:i[c]=tw(l[3][0].data);break;case 8:{var d=e[is(l[9][0].data)][0],u=Ur(d.data),f=e[is(u[1][0].data)][0],h=Rn(f.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var A=Ur(f.data);i[c]=A[3].map(function(x){return tw(x.data)}).join("")}break}}),i}function Ide(e,t){var r,a,s,i,o,l,c,d,u,f,h,A,x,p,b=Ur(e),m=Rn(b[1][0].data)>>>0,g=Rn(b[2][0].data)>>>0,y=((a=(r=b[8])==null?void 0:r[0])==null?void 0:a.data)&&Rn(b[8][0].data)>0||!1,v,_;if((i=(s=b[7])==null?void 0:s[0])!=null&&i.data&&t!=0)v=(l=(o=b[7])==null?void 0:o[0])==null?void 0:l.data,_=(d=(c=b[6])==null?void 0:c[0])==null?void 0:d.data;else if((f=(u=b[4])==null?void 0:u[0])!=null&&f.data&&t!=1)v=(A=(h=b[4])==null?void 0:h[0])==null?void 0:A.data,_=(p=(x=b[3])==null?void 0:x[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var j=y?4:1,N=nu(v),B=[],E=0;E<v.length/2;++E){var C=N.getUint16(E*2,!0);C<65535&&B.push([E,C])}if(B.length!=g)throw"Expected ".concat(g," cells, found ").concat(B.length);var k=[];for(E=0;E<B.length-1;++E)k[B[E][0]]=_.subarray(B[E][1]*j,B[E+1][1]*j);return B.length>=1&&(k[B[B.length-1][0]]=_.subarray(B[B.length-1][1]*j)),{R:m,cells:k}}function Dde(e,t){var r,a=Ur(t.data),s=(r=a==null?void 0:a[7])!=null&&r[0]?Rn(a[7][0].data)>>>0>0?1:0:-1,i=z2(a[5],function(o){return Ide(o,s)});return{nrows:Rn(a[4][0].data)>>>0,data:i.reduce(function(o,l){return o[l.R]||(o[l.R]=[]),l.cells.forEach(function(c,d){if(o[l.R][d])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(d));o[l.R][d]=c}),o},[])}}function Lde(e,t,r){var a,s=Ur(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Rn(s[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(i.e.c=(Rn(s[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=fr(i);var o=Ur(s[4][0].data),l=TS(e,e[is(o[4][0].data)][0]),c=(a=o[17])!=null&&a[0]?TS(e,e[is(o[17][0].data)][0]):[],d=Ur(o[3][0].data),u=0;d[1].forEach(function(f){var h=Ur(f.data),A=e[is(h[2][0].data)][0],x=Rn(A.meta[1][0].data);if(x!=6002)throw new Error("6001 unexpected reference to ".concat(x));var p=Dde(e,A);p.data.forEach(function(b,m){b.forEach(function(g,y){var v=sr({r:u+m,c:y}),_=Tde(g,l,c);_&&(r[v]=_)})}),u+=p.nrows})}function Pde(e,t){var r=Ur(t.data),a={"!ref":"A1"},s=e[is(r[2][0].data)],i=Rn(s[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return Lde(e,s[0],a),a}function Ode(e,t){var r,a=Ur(t.data),s={name:(r=a[1])!=null&&r[0]?tw(a[1][0].data):"",sheets:[]},i=z2(a[2],is);return i.forEach(function(o){e[o].forEach(function(l){var c=Rn(l.meta[1][0].data);c==6e3&&s.sheets.push(Pde(e,l))})}),s}function Ude(e,t){var r=Z2(),a=Ur(t.data),s=z2(a[1],is);if(s.forEach(function(i){e[i].forEach(function(o){var l=Rn(o.meta[1][0].data);if(l==2){var c=Ode(e,o);c.sheets.forEach(function(d,u){eN(r,d,u==0?c.name:c.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function R1(e){var t,r,a,s,i={},o=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var d;try{d=Ei(c.content)}catch(f){return console.log("?? "+c.content.length+" "+(f.message||f))}var u;try{u=Bi(d)}catch(f){return console.log("## "+(f.message||f))}u.forEach(function(f){i[f.id]=f.messages,o.push(f.id)})}}),!o.length)throw new Error("File has no messages");var l=((s=(a=(r=(t=i==null?void 0:i[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:a[1])==null?void 0:s[0].data)&&Rn(i[1][0].meta[1][0].data)==1&&i[1][0];if(l||o.forEach(function(c){i[c].forEach(function(d){var u=Rn(d.meta[1][0].data)>>>0;if(u==1)if(!l)l=d;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return Ude(i,l)}function Rde(e,t,r){var a,s,i,o;if(!((a=e[6])!=null&&a[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(i=e[8])==null?void 0:i[0])==null?void 0:o.data)&&Rn(e[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,d=nu(e[7][0].data),u=0,f=[],h=nu(e[4][0].data),A=0,x=[],p=0;p<t.length;++p){if(t[p]==null){d.setUint16(p*2,65535,!0),h.setUint16(p*2,65535);continue}d.setUint16(p*2,u,!0),h.setUint16(p*2,A,!0);var b,m;switch(typeof t[p]){case"string":b=O1({t:"s",v:t[p]},r),m=U1({t:"s",v:t[p]},r);break;case"number":b=O1({t:"n",v:t[p]},r),m=U1({t:"n",v:t[p]},r);break;case"boolean":b=O1({t:"b",v:t[p]},r),m=U1({t:"b",v:t[p]},r);break;default:throw new Error("Unsupported value "+t[p])}f.push(b),u+=b.length,x.push(m),A+=m.length,++c}for(e[2][0].data=Vr(c);p<e[7][0].data.length/2;++p)d.setUint16(p*2,65535,!0),h.setUint16(p*2,65535,!0);return e[6][0].data=Gc(f),e[3][0].data=Gc(x),c}function Mde(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=Ws(r["!ref"]);a.s.r=a.s.c=0;var s=!1;a.e.c>9&&(s=!0,a.e.c=9),a.e.r>49&&(s=!0,a.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(fr(a)));var i=yx(r,{range:a,header:1}),o=["~Sh33tJ5~"];i.forEach(function(D){return D.forEach(function(L){typeof L=="string"&&o.push(L)})});var l={},c=[],d=er.read(t.numbers,{type:"base64"});d.FileIndex.map(function(D,L){return[D,d.FullPaths[L]]}).forEach(function(D){var L=D[0],P=D[1];if(L.type==2&&L.name.match(/\.iwa/)){var I=L.content,H=Ei(I),V=Bi(H);V.forEach(function(W){c.push(W.id),l[W.id]={deps:[],location:P,type:Rn(W.messages[0].meta[1][0].data)}})}}),c.sort(function(D,L){return D-L});var u=c.filter(function(D){return D>1}).map(function(D){return[D,Vr(D)]});d.FileIndex.map(function(D,L){return[D,d.FullPaths[L]]}).forEach(function(D){var L=D[0];if(D[1],!!L.name.match(/\.iwa/)){var P=Bi(Ei(L.content));P.forEach(function(I){I.messages.forEach(function(H){u.forEach(function(V){I.messages.some(function(W){return Rn(W.meta[1][0].data)!=11006&&kde(W.data,V[1])})&&l[V[0]].deps.push(I.id)})})})}});for(var f=er.find(d,l[1].location),h=Bi(Ei(f.content)),A,x=0;x<h.length;++x){var p=h[x];p.id==1&&(A=p)}var b=is(Ur(A.messages[0].data)[1][0].data);for(f=er.find(d,l[b].location),h=Bi(Ei(f.content)),x=0;x<h.length;++x)p=h[x],p.id==b&&(A=p);for(b=is(Ur(A.messages[0].data)[2][0].data),f=er.find(d,l[b].location),h=Bi(Ei(f.content)),x=0;x<h.length;++x)p=h[x],p.id==b&&(A=p);for(b=is(Ur(A.messages[0].data)[2][0].data),f=er.find(d,l[b].location),h=Bi(Ei(f.content)),x=0;x<h.length;++x)p=h[x],p.id==b&&(A=p);var m=Ur(A.messages[0].data);{m[6][0].data=Vr(a.e.r+1),m[7][0].data=Vr(a.e.c+1);var g=is(m[46][0].data),y=er.find(d,l[g].location),v=Bi(Ei(y.content));{for(var _=0;_<v.length&&v[_].id!=g;++_);if(v[_].id!=g)throw"Bad ColumnRowUIDMapArchive";var j=Ur(v[_].messages[0].data);j[1]=[],j[2]=[],j[3]=[];for(var N=0;N<=a.e.c;++N){var B=[];B[1]=B[2]=[{type:0,data:Vr(N+420690)}],j[1].push({type:2,data:Ha(B)}),j[2].push({type:0,data:Vr(N)}),j[3].push({type:0,data:Vr(N)})}j[4]=[],j[5]=[],j[6]=[];for(var E=0;E<=a.e.r;++E)B=[],B[1]=B[2]=[{type:0,data:Vr(E+726270)}],j[4].push({type:2,data:Ha(B)}),j[5].push({type:0,data:Vr(E)}),j[6].push({type:0,data:Vr(E)});v[_].messages[0].data=Ha(j)}y.content=Hu(Qu(v)),y.size=y.content.length,delete m[46];var C=Ur(m[4][0].data);{C[7][0].data=Vr(a.e.r+1);var k=Ur(C[1][0].data),w=is(k[2][0].data);y=er.find(d,l[w].location),v=Bi(Ei(y.content));{if(v[0].id!=w)throw"Bad HeaderStorageBucket";var T=Ur(v[0].messages[0].data);for(E=0;E<i.length;++E){var R=Ur(T[2][0].data);R[1][0].data=Vr(E),R[4][0].data=Vr(i[E].length),T[2][E]={type:T[2][0].type,data:Ha(R)}}v[0].messages[0].data=Ha(T)}y.content=Hu(Qu(v)),y.size=y.content.length;var q=is(C[2][0].data);y=er.find(d,l[q].location),v=Bi(Ei(y.content));{if(v[0].id!=q)throw"Bad HeaderStorageBucket";for(T=Ur(v[0].messages[0].data),N=0;N<=a.e.c;++N)R=Ur(T[2][0].data),R[1][0].data=Vr(N),R[4][0].data=Vr(a.e.r+1),T[2][N]={type:T[2][0].type,data:Ha(R)};v[0].messages[0].data=Ha(T)}y.content=Hu(Qu(v)),y.size=y.content.length;var z=is(C[4][0].data);(function(){for(var D=er.find(d,l[z].location),L=Bi(Ei(D.content)),P,I=0;I<L.length;++I){var H=L[I];H.id==z&&(P=H)}var V=Ur(P.messages[0].data);{V[3]=[];var W=[];o.forEach(function(K,he){W[1]=[{type:0,data:Vr(he)}],W[2]=[{type:0,data:Vr(1)}],W[3]=[{type:2,data:jde(K)}],V[3].push({type:2,data:Ha(W)})})}P.messages[0].data=Ha(V);var M=Qu(L),se=Hu(M);D.content=se,D.size=D.content.length})();var ee=Ur(C[3][0].data);{var Y=ee[1][0];delete ee[2];var G=Ur(Y.data);{var re=is(G[2][0].data);(function(){for(var D=er.find(d,l[re].location),L=Bi(Ei(D.content)),P,I=0;I<L.length;++I){var H=L[I];H.id==re&&(P=H)}var V=Ur(P.messages[0].data);{delete V[6],delete ee[7];var W=new Uint8Array(V[5][0].data);V[5]=[];for(var M=0,se=0;se<=a.e.r;++se){var K=Ur(W);M+=Rde(K,i[se],o),K[1][0].data=Vr(se),V[5].push({data:Ha(K),type:2})}V[1]=[{type:0,data:Vr(a.e.c+1)}],V[2]=[{type:0,data:Vr(a.e.r+1)}],V[3]=[{type:0,data:Vr(M)}],V[4]=[{type:0,data:Vr(a.e.r+1)}]}P.messages[0].data=Ha(V);var he=Qu(L),ne=Hu(he);D.content=ne,D.size=D.content.length})()}Y.data=Ha(G)}C[3][0].data=Ha(ee)}m[4][0].data=Ha(C)}A.messages[0].data=Ha(m);var U=Qu(h),S=Hu(U);return f.content=S,f.size=f.content.length,d}function eD(e){return function(r){for(var a=0;a!=e.length;++a){var s=e[a];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function G2(e){eD([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function X2(e){eD([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function Qde(e){return _r.WS.indexOf(e)>-1?"sheet":e==_r.CS?"chart":e==_r.DS?"dialog":e==_r.MS?"macro":e&&e.length?e:"sheet"}function Hde(e,t){if(!e)return 0;try{e=t.map(function(a){return a.id||(a.id=a.strRelID),[a.name,e["!id"][a.id].Target,Qde(e["!id"][a.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function qde(e,t,r,a,s,i,o,l,c,d,u,f){try{i[a]=Of(Ai(e,r,!0),t);var h=sa(e,t),A;switch(l){case"sheet":A=uce(h,t,s,c,i[a],d,u,f);break;case"chart":if(A=Ace(h,t,s,c,i[a],d,u,f),!A||!A["!drawel"])break;var x=pf(A["!drawel"].Target,t),p=w0(x),b=Jae(Ai(e,x,!0),Of(Ai(e,p,!0),x)),m=pf(b,x),g=w0(m);A=Rle(Ai(e,m,!0),m,c,Of(Ai(e,g,!0),m),d,A);break;case"macro":A=hce(h,t,s,c,i[a],d,u,f);break;case"dialog":A=fce(h,t,s,c,i[a],d,u,f);break;default:throw new Error("Unrecognized sheet type "+l)}o[a]=A;var y=[];i&&i[a]&&Mn(i[a]).forEach(function(v){var _="";if(i[a][v].Type==_r.CMNT){_=pf(i[a][v].Target,t);var j=xce(sa(e,_,!0),_,c);if(!j||!j.length)return;gS(A,j,!1)}i[a][v].Type==_r.TCMNT&&(_=pf(i[a][v].Target,t),y=y.concat(ese(sa(e,_,!0),c)))}),y&&y.length&&gS(A,y,!0,c.people||[])}catch(v){if(c.WTF)throw v}}function Ci(e){return e.charAt(0)=="/"?e.slice(1):e}function $de(e,t){if(th(),t=t||{},G2(t),Ti(e,"META-INF/manifest.xml")||Ti(e,"objectdata.xml"))return SS(e,t);if(Ti(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof R1<"u"){if(e.FileIndex)return R1(e);var r=er.utils.cfb_new();return UC(e).forEach(function(R){gr(r,R,tee(e,R))}),R1(r)}throw new Error("Unsupported NUMBERS file")}if(!Ti(e,"[Content_Types].xml"))throw Ti(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Ti(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=UC(e),s=zee(Ai(e,"[Content_Types].xml")),i=!1,o,l;if(s.workbooks.length===0&&(l="xl/workbook.xml",sa(e,l,!0)&&s.workbooks.push(l)),s.workbooks.length===0){if(l="xl/workbook.bin",!sa(e,l,!0))throw new Error("Could not find workbook");s.workbooks.push(l),i=!0}s.workbooks[0].slice(-3)=="bin"&&(i=!0);var c={},d={};if(!t.bookSheets&&!t.bookProps){if(Uf=[],s.sst)try{Uf=gce(sa(e,Ci(s.sst)),s.sst,t)}catch(R){if(t.WTF)throw R}t.cellStyles&&s.themes.length&&(c=mce(Ai(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(d=pce(sa(e,Ci(s.style)),s.style,c,t))}s.links.map(function(R){try{var q=Of(Ai(e,w0(Ci(R))),R);return vce(sa(e,Ci(R)),q,R,t)}catch{}});var u=dce(sa(e,Ci(s.workbooks[0])),s.workbooks[0],t),f={},h="";s.coreprops.length&&(h=sa(e,Ci(s.coreprops[0]),!0),h&&(f=HT(h)),s.extprops.length!==0&&(h=sa(e,Ci(s.extprops[0]),!0),h&&tte(h,f,t)));var A={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(h=Ai(e,Ci(s.custprops[0]),!0),h&&(A=nte(h,t)));var x={};if((t.bookSheets||t.bookProps)&&(u.Sheets?o=u.Sheets.map(function(q){return q.name}):f.Worksheets&&f.SheetNames.length>0&&(o=f.SheetNames),t.bookProps&&(x.Props=f,x.Custprops=A),t.bookSheets&&typeof o<"u"&&(x.SheetNames=o),t.bookSheets?x.SheetNames:t.bookProps))return x;o={};var p={};t.bookDeps&&s.calcchain&&(p=yce(sa(e,Ci(s.calcchain)),s.calcchain));var b=0,m={},g,y;{var v=u.Sheets;f.Worksheets=v.length,f.SheetNames=[];for(var _=0;_!=v.length;++_)f.SheetNames[_]=v[_].name}var j=i?"bin":"xml",N=s.workbooks[0].lastIndexOf("/"),B=(s.workbooks[0].slice(0,N+1)+"_rels/"+s.workbooks[0].slice(N+1)+".rels").replace(/^\//,"");Ti(e,B)||(B="xl/_rels/workbook."+j+".rels");var E=Of(Ai(e,B,!0),B.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=bce(sa(e,Ci(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=rse(sa(e,Ci(s.people[0])),t)),E&&(E=Hde(E,u.Sheets));var C=sa(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(b=0;b!=f.Worksheets;++b){var k="sheet";if(E&&E[b]?(g="xl/"+E[b][1].replace(/[\/]?xl\//,""),Ti(e,g)||(g=E[b][1]),Ti(e,g)||(g=B.replace(/_rels\/.*$/,"")+E[b][1]),k=E[b][2]):(g="xl/worksheets/sheet"+(b+1-C)+"."+j,g=g.replace(/sheet0\./,"sheet.")),y=g.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(b!=t.sheets)continue e;break;case"string":if(f.SheetNames[b].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var w=!1,T=0;T!=t.sheets.length;++T)typeof t.sheets[T]=="number"&&t.sheets[T]==b&&(w=1),typeof t.sheets[T]=="string"&&t.sheets[T].toLowerCase()==f.SheetNames[b].toLowerCase()&&(w=1);if(!w)continue e}}qde(e,g,y,f.SheetNames[b],b,m,o,k,t,u,c,d)}return x={Directory:s,Workbook:u,Props:f,Custprops:A,Deps:p,Sheets:o,SheetNames:f.SheetNames,Strings:Uf,Styles:d,Themes:c,SSF:yn(nr)},t&&t.bookFiles&&(e.files?(x.keys=a,x.files=e.files):(x.keys=[],x.files={},e.FullPaths.forEach(function(R,q){R=R.replace(/^Root Entry[\/]/,""),x.keys.push(R),x.files[R]=e.FileIndex[q]}))),t&&t.bookVBA&&(s.vba.length>0?x.vbaraw=sa(e,Ci(s.vba[0]),!0):s.defaults&&s.defaults.bin===dse&&(x.vbaraw=sa(e,"xl/vbaProject.bin",!0))),x}function Kde(e,t){var r=t||{},a="Workbook",s=er.find(e,a);try{if(a="/!DataSpaces/Version",s=er.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(bne(s.content),a="/!DataSpaces/DataSpaceMap",s=er.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var i=wne(s.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=er.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var o=Nne(s.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=er.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);kne(s.content)}catch{}if(a="/EncryptionInfo",s=er.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var l=Cne(s.content);if(a="/EncryptedPackage",s=er.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],s.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function Vde(e,t){return t.bookType=="ods"?ZI(e,t):t.bookType=="numbers"?Mde(e,t):t.bookType=="xlsb"?Wde(e,t):zde(e,t)}function Wde(e,t){AA=1024,e&&!e.SSF&&(e.SSF=yn(nr)),e&&e.SSF&&(th(),oy(e.SSF),t.revssf=cy(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Rf?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",a=CI.indexOf(t.bookType)>-1,s=L2();X2(t=t||{});var i=b2(),o="",l=0;if(t.cellXfs=[],td(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",gr(i,o,qT(e.Props,t)),s.coreprops.push(o),Wr(t.rels,2,o,_r.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&c.push(e.SheetNames[d]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,gr(i,o,VT(e.Props)),s.extprops.push(o),Wr(t.rels,3,o,_r.EXT_PROPS),e.Custprops!==e.Props&&Mn(e.Custprops||{}).length>0&&(o="docProps/custom.xml",gr(i,o,WT(e.Custprops)),s.custprops.push(o),Wr(t.rels,4,o,_r.CUST_PROPS)),l=1;l<=e.SheetNames.length;++l){var u={"!id":{}},f=e.Sheets[e.SheetNames[l-1]],h=(f||{})["!type"]||"sheet";switch(h){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,gr(i,o,wce(l-1,o,t,e,u)),s.sheets.push(o),Wr(t.wbrels,-1,"worksheets/sheet"+l+"."+r,_r.WS[0])}if(f){var A=f["!comments"],x=!1,p="";A&&A.length>0&&(p="xl/comments"+l+"."+r,gr(i,p,kce(A,p)),s.comments.push(p),Wr(u,-1,"../comments"+l+"."+r,_r.CMNT),x=!0),f["!legacy"]&&x&&gr(i,"xl/drawings/vmlDrawing"+l+".vml",jI(l,f["!comments"])),delete f["!comments"],delete f["!legacy"]}u["!id"].rId1&&gr(i,w0(o),CA(u))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,gr(i,o,jce(t.Strings,o,t)),s.strs.push(o),Wr(t.wbrels,-1,"sharedStrings."+r,_r.SST)),o="xl/workbook."+r,gr(i,o,_ce(e,o)),s.workbooks.push(o),Wr(t.rels,1,o,_r.WB),o="xl/theme/theme1.xml",gr(i,o,Q2(e.Themes,t)),s.themes.push(o),Wr(t.wbrels,-1,"theme/theme1.xml",_r.THEME),o="xl/styles."+r,gr(i,o,Nce(e,o,t)),s.styles.push(o),Wr(t.wbrels,-1,"styles."+r,_r.STY),e.vbaraw&&a&&(o="xl/vbaProject.bin",gr(i,o,e.vbaraw),s.vba.push(o),Wr(t.wbrels,-1,"vbaProject.bin",_r.VBA)),o="xl/metadata."+r,gr(i,o,Cce(o)),s.metadata.push(o),Wr(t.wbrels,-1,"metadata."+r,_r.XLMETA),gr(i,"[Content_Types].xml",MT(s,t)),gr(i,"_rels/.rels",CA(t.rels)),gr(i,"xl/_rels/workbook."+r+".rels",CA(t.wbrels)),delete t.revssf,delete t.ssf,i}function zde(e,t){AA=1024,e&&!e.SSF&&(e.SSF=yn(nr)),e&&e.SSF&&(th(),oy(e.SSF),t.revssf=cy(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Rf?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",a=CI.indexOf(t.bookType)>-1,s=L2();X2(t=t||{});var i=b2(),o="",l=0;if(t.cellXfs=[],td(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",gr(i,o,qT(e.Props,t)),s.coreprops.push(o),Wr(t.rels,2,o,_r.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&c.push(e.SheetNames[d]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,gr(i,o,VT(e.Props)),s.extprops.push(o),Wr(t.rels,3,o,_r.EXT_PROPS),e.Custprops!==e.Props&&Mn(e.Custprops||{}).length>0&&(o="docProps/custom.xml",gr(i,o,WT(e.Custprops)),s.custprops.push(o),Wr(t.rels,4,o,_r.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var f={"!id":{}},h=e.Sheets[e.SheetNames[l-1]],A=(h||{})["!type"]||"sheet";switch(A){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,gr(i,o,UI(l-1,t,e,f)),s.sheets.push(o),Wr(t.wbrels,-1,"worksheets/sheet"+l+"."+r,_r.WS[0])}if(h){var x=h["!comments"],p=!1,b="";if(x&&x.length>0){var m=!1;x.forEach(function(g){g[1].forEach(function(y){y.T==!0&&(m=!0)})}),m&&(b="xl/threadedComments/threadedComment"+l+"."+r,gr(i,b,tse(x,u,t)),s.threadedcomments.push(b),Wr(f,-1,"../threadedComments/threadedComment"+l+"."+r,_r.TCMNT)),b="xl/comments"+l+"."+r,gr(i,b,kI(x)),s.comments.push(b),Wr(f,-1,"../comments"+l+"."+r,_r.CMNT),p=!0}h["!legacy"]&&p&&gr(i,"xl/drawings/vmlDrawing"+l+".vml",jI(l,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&gr(i,w0(o),CA(f))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,gr(i,o,hI(t.Strings,t)),s.strs.push(o),Wr(t.wbrels,-1,"sharedStrings."+r,_r.SST)),o="xl/workbook."+r,gr(i,o,qI(e)),s.workbooks.push(o),Wr(t.rels,1,o,_r.WB),o="xl/theme/theme1.xml",gr(i,o,Q2(e.Themes,t)),s.themes.push(o),Wr(t.wbrels,-1,"theme/theme1.xml",_r.THEME),o="xl/styles."+r,gr(i,o,bI(e,t)),s.styles.push(o),Wr(t.wbrels,-1,"styles."+r,_r.STY),e.vbaraw&&a&&(o="xl/vbaProject.bin",gr(i,o,e.vbaraw),s.vba.push(o),Wr(t.wbrels,-1,"vbaProject.bin",_r.VBA)),o="xl/metadata."+r,gr(i,o,NI()),s.metadata.push(o),Wr(t.wbrels,-1,"metadata."+r,_r.XLMETA),u.length>1&&(o="xl/persons/person.xml",gr(i,o,nse(u)),s.people.push(o),Wr(t.wbrels,-1,"persons/person.xml",_r.PEOPLE)),gr(i,"[Content_Types].xml",MT(s,t)),gr(i,"_rels/.rels",CA(t.rels)),gr(i,"xl/_rels/workbook."+r+".rels",CA(t.wbrels)),delete t.revssf,delete t.ssf,i}function Y2(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=xi(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Gde(e,t){return er.find(e,"EncryptedPackage")?Kde(e,t):WI(e,t)}function Xde(e,t){var r,a=e,s=t||{};return s.type||(s.type=yr&&Buffer.isBuffer(e)?"buffer":"base64"),r=pT(a,s),$de(r,s)}function tD(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Z_(e.slice(r),t);default:break e}return MA.to_workbook(e,t)}function Yde(e,t){var r="",a=Y2(e,t);switch(t.type){case"base64":r=xi(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Zd(e);break;default:throw new Error("Unrecognized type "+t.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(r=Jr(r)),t.type="binary",tD(r,t)}function Jde(e,t){var r=e;return t.type=="base64"&&(r=xi(r)),r=g0.utils.decode(1200,r.slice(2),"str"),t.type="binary",tD(r,t)}function Zde(e){return e.match(/[^\x00-\x7F]/)?qo(e):e}function M1(e,t,r,a){return a?(r.type="string",MA.to_workbook(e,r)):MA.to_workbook(t,r)}function xx(e,t){m2();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return xx(new Uint8Array(e),(r=yn(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var a=e,s=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),BA={},r.dateNF&&(BA.dateNF=r.dateNF),r.type||(r.type=yr&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=yr?"buffer":"binary",a=WZ(e),typeof Uint8Array<"u"&&!yr&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,a=Zde(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),l=new Uint8Array(o);if(l.foo="bar",!l.foo)return r=yn(r),r.type="array",xx(g2(a),r)}switch((s=Y2(a,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return Gde(er.read(a,r),r);break;case 9:if(s[1]<=8)return WI(a,r);break;case 60:return Z_(a,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return ane(a,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return uI.to_workbook(a,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?Xde(a,r):M1(e,a,r,i);case 239:return s[3]===60?Z_(a,r):M1(e,a,r,i);case 255:if(s[1]===254)return Jde(a,r);if(s[1]===0&&s[2]===2&&s[3]===0)return Hd.to_workbook(a,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return Hd.to_workbook(a,r);break;case 3:case 131:case 139:case 140:return J_.to_workbook(a,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return xI.to_workbook(a,r);break;case 10:case 13:case 32:return Yde(a,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return nne.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?J_.to_workbook(a,r):M1(e,a,r,i)}function rD(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return H0(t.file,er.write(e,{type:yr?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return er.write(e,t)}function eue(e,t){var r=yn(t||{}),a=Vde(e,r);return tue(a,r)}function tue(e,t){var r={},a=yr?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=a;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=a;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?er.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(t.type=="binary"||t.type=="base64")return s;s=new Uint8Array(iy(s))}return t.password&&typeof encrypt_agile<"u"?rD(encrypt_agile(s,t.password),t):t.type==="file"?H0(t.file,s):t.type=="string"?Jr(s):s}function rue(e,t){var r=t||{},a=Zce(e,r);return rD(a,r)}function Uo(e,t,r){r||(r="");var a=r+e;switch(t.type){case"base64":return x0(qo(a));case"binary":return qo(a);case"string":return e;case"file":return H0(t.file,a,"utf8");case"buffer":return yr?Vl(a,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(a):Uo(a,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function nue(e,t){switch(t.type){case"base64":return x0(e);case"binary":return e;case"string":return e;case"file":return H0(t.file,e,"binary");case"buffer":return yr?Vl(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Mm(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",a=0;a<e.length;++a)r+=String.fromCharCode(e[a]);return t.type=="base64"?x0(r):t.type=="string"?Jr(r):r;case"file":return H0(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function nD(e,t){m2(),Gle(e);var r=yn(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var a=nD(e,r);return r.type="array",iy(a)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=e.SheetNames.indexOf(r.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Uo(Vce(e,r),r);case"slk":case"sylk":return Uo(dI.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"htm":case"html":return Uo(GI(e.Sheets[e.SheetNames[s]],r),r);case"txt":return nue(aD(e.Sheets[e.SheetNames[s]],r),r);case"csv":return Uo(J2(e.Sheets[e.SheetNames[s]],r),r,"\uFEFF");case"dif":return Uo(uI.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"dbf":return Mm(J_.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"prn":return Uo(MA.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"rtf":return Uo(xI.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"eth":return Uo(AI.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"fods":return Uo(ZI(e,r),r);case"wk1":return Mm(Hd.sheet_to_wk1(e.Sheets[e.SheetNames[s]],r),r);case"wk3":return Mm(Hd.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Mm(zI(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),rue(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return eue(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function aue(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function E0(e,t,r){var a={};return a.type="file",a.file=t,aue(a),nD(e,a)}function sue(e,t,r,a,s,i,o,l){var c=Jn(r),d=l.defval,u=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),f=!0,h=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!o||e[r])for(var A=t.s.c;A<=t.e.c;++A){var x=o?e[r][A]:e[a[A]+c];if(x===void 0||x.t===void 0){if(d===void 0)continue;i[A]!=null&&(h[i[A]]=d);continue}var p=x.v;switch(x.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(i[A]!=null){if(p==null)if(x.t=="e"&&p===null)h[i[A]]=null;else if(d!==void 0)h[i[A]]=d;else if(u&&p===null)h[i[A]]=null;else continue;else h[i[A]]=u&&(x.t!=="n"||x.t==="n"&&l.rawNumbers!==!1)?p:Ql(x,p,l);p!=null&&(f=!1)}}return{row:h,isempty:f}}function yx(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},a=0,s=1,i=[],o=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},d=t||{},u=d.range!=null?d.range:e["!ref"];switch(d.header===1?a=1:d.header==="A"?a=2:Array.isArray(d.header)?a=3:d.header==null&&(a=0),typeof u){case"string":c=Or(u);break;case"number":c=Or(e["!ref"]),c.s.r=u;break;default:c=u}a>0&&(s=0);var f=Jn(c.s.r),h=[],A=[],x=0,p=0,b=Array.isArray(e),m=c.s.r,g=0,y={};b&&!e[m]&&(e[m]=[]);var v=d.skipHidden&&e["!cols"]||[],_=d.skipHidden&&e["!rows"]||[];for(g=c.s.c;g<=c.e.c;++g)if(!(v[g]||{}).hidden)switch(h[g]=kn(g),r=b?e[m][g]:e[h[g]+f],a){case 1:i[g]=g-c.s.c;break;case 2:i[g]=h[g];break;case 3:i[g]=d.header[g-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=Ql(r,null,d),p=y[o]||0,!p)y[o]=1;else{do l=o+"_"+p++;while(y[l]);y[o]=p,y[l]=1}i[g]=l}for(m=c.s.r+s;m<=c.e.r;++m)if(!(_[m]||{}).hidden){var j=sue(e,c,m,h,a,i,b,d);(j.isempty===!1||(a===1?d.blankrows!==!1:d.blankrows))&&(A[x++]=j.row)}return A.length=x,A}var IS=/"/g;function iue(e,t,r,a,s,i,o,l){for(var c=!0,d=[],u="",f=Jn(r),h=t.s.c;h<=t.e.c;++h)if(a[h]){var A=l.dense?(e[r]||[])[h]:e[a[h]+f];if(A==null)u="";else if(A.v!=null){c=!1,u=""+(l.rawNumbers&&A.t=="n"?A.v:Ql(A,null,l));for(var x=0,p=0;x!==u.length;++x)if((p=u.charCodeAt(x))===s||p===i||p===34||l.forceQuotes){u='"'+u.replace(IS,'""')+'"';break}u=="ID"&&(u='"ID"')}else A.f!=null&&!A.F?(c=!1,u="="+A.f,u.indexOf(",")>=0&&(u='"'+u.replace(IS,'""')+'"')):u="";d.push(u)}return l.blankrows===!1&&c?null:d.join(o)}function J2(e,t){var r=[],a=t??{};if(e==null||e["!ref"]==null)return"";var s=Or(e["!ref"]),i=a.FS!==void 0?a.FS:",",o=i.charCodeAt(0),l=a.RS!==void 0?a.RS:`
`,c=l.charCodeAt(0),d=new RegExp((i=="|"?"\\|":i)+"+$"),u="",f=[];a.dense=Array.isArray(e);for(var h=a.skipHidden&&e["!cols"]||[],A=a.skipHidden&&e["!rows"]||[],x=s.s.c;x<=s.e.c;++x)(h[x]||{}).hidden||(f[x]=kn(x));for(var p=0,b=s.s.r;b<=s.e.r;++b)(A[b]||{}).hidden||(u=iue(e,s,b,f,o,c,i,a),u!=null&&(a.strip&&(u=u.replace(d,"")),(u||a.blankrows!==!1)&&r.push((p++?l:"")+u)));return delete a.dense,r.join("")}function aD(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=J2(e,t);return r}function oue(e){var t="",r,a="";if(e==null||e["!ref"]==null)return[];var s=Or(e["!ref"]),i="",o=[],l,c=[],d=Array.isArray(e);for(l=s.s.c;l<=s.e.c;++l)o[l]=kn(l);for(var u=s.s.r;u<=s.e.r;++u)for(i=Jn(u),l=s.s.c;l<=s.e.c;++l)if(t=o[l]+i,r=d?(e[u]||[])[l]:e[t],a="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;a=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)a=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)a=""+r.v;else if(r.t=="b")a=r.v?"TRUE":"FALSE";else if(r.w!==void 0)a="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?a="'"+r.v:a=""+r.v}}c[c.length]=t+"="+a}return c}function sD(e,t,r){var a=r||{},s=+!a.skipHeader,i=e||{},o=0,l=0;if(i&&a.origin!=null)if(typeof a.origin=="number")o=a.origin;else{var c=typeof a.origin=="string"?Cn(a.origin):a.origin;o=c.r,l=c.c}var d,u={s:{c:0,r:0},e:{c:l,r:o+t.length-1+s}};if(i["!ref"]){var f=Or(i["!ref"]);u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),o==-1&&(o=f.e.r+1,u.e.r=o+t.length-1+s)}else o==-1&&(o=0,u.e.r=t.length-1+s);var h=a.header||[],A=0;t.forEach(function(p,b){Mn(p).forEach(function(m){(A=h.indexOf(m))==-1&&(h[A=h.length]=m);var g=p[m],y="z",v="",_=sr({c:l+A,r:o+b+s});d=F0(i,_),g&&typeof g=="object"&&!(g instanceof Date)?i[_]=g:(typeof g=="number"?y="n":typeof g=="boolean"?y="b":typeof g=="string"?y="s":g instanceof Date?(y="d",a.cellDates||(y="n",g=ka(g)),v=a.dateNF||nr[14]):g===null&&a.nullError&&(y="e",g=0),d?(d.t=y,d.v=g,delete d.w,delete d.R,v&&(d.z=v)):i[_]=d={t:y,v:g},v&&(d.z=v))})}),u.e.c=Math.max(u.e.c,l+h.length-1);var x=Jn(o);if(s)for(A=0;A<h.length;++A)i[kn(A+l)+x]={t:"s",v:h[A]};return i["!ref"]=fr(u),i}function lue(e,t){return sD(null,e,t)}function F0(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var a=Cn(t);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?F0(e,sr(t)):F0(e,sr({r:t,c:r||0}))}function cue(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Z2(){return{SheetNames:[],Sheets:{}}}function eN(e,t,r,a){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);s=i&&+i[2]||0;var o=i&&i[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=o+s)!=-1;++s);}if(HI(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function due(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=cue(e,t);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[a].Hidden=r}function uue(e,t){return e.z=t,e}function iD(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function Aue(e,t,r){return iD(e,"#"+t,r)}function hue(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function fue(e,t,r,a){for(var s=typeof t!="string"?t:Or(t),i=typeof t=="string"?t:fr(t),o=s.s.r;o<=s.e.r;++o)for(var l=s.s.c;l<=s.e.c;++l){var c=F0(e,o,l);c.t="n",c.F=i,delete c.v,o==s.s.r&&l==s.s.c&&(c.f=r,a&&(c.D=!0))}return e}var va={encode_col:kn,encode_row:Jn,encode_cell:sr,encode_range:fr,decode_col:B2,decode_row:S2,split_cell:jee,decode_cell:Cn,decode_range:Ws,format_cell:Ql,sheet_add_aoa:IT,sheet_add_json:sD,sheet_add_dom:XI,aoa_to_sheet:rh,json_to_sheet:lue,table_to_sheet:YI,table_to_book:bde,sheet_to_csv:J2,sheet_to_txt:aD,sheet_to_json:yx,sheet_to_html:GI,sheet_to_formulae:oue,sheet_to_row_object_array:yx,sheet_get_cell:F0,book_new:Z2,book_append_sheet:eN,book_set_sheet_visibility:due,cell_set_number_format:uue,cell_set_hyperlink:iD,cell_set_internal_link:Aue,cell_add_comment:hue,sheet_set_array_formula:fue,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function pue({isOpen:e,onClose:t,inquiry:r,replyTo:a}){const[s,i]=Q.useState(r.contact_email||""),[o,l]=Q.useState(""),[c,d]=Q.useState(""),[u,f]=Q.useState(!1),[h,A]=Q.useState(!1),[x,p]=Q.useState(a!=null&&a.subject?a.subject.startsWith("Re:")?a.subject:`Re: ${a.subject}`:`Re: ${r.product_name} - Inquiry ${r.inquiry_number}`),[b,m]=Q.useState(""),[g,y]=Q.useState([]),[v,_]=Q.useState(!1),[j,N]=Q.useState([]),[B,E]=Q.useState(!1),[C,k]=Q.useState(""),w=Q.useRef(null);Q.useEffect(()=>{if(T(),z(),R(),a){const S=`
        <br><br>
        <div style="border-left: 3px solid #ccc; padding-left: 15px; margin-left: 10px; color: #666;">
          <p><strong>On ${new Date().toLocaleDateString()}, ${a.from_email} wrote:</strong></p>
          ${a.body}
        </div>
      `;m(S)}else q()},[a]);const T=async()=>{try{const{data:S,error:D}=await Z.from("crm_email_templates").select("*").eq("is_active",!0).order("template_name");if(D)throw D;N(S||[])}catch(S){console.error("Error loading templates:",S)}},R=async()=>{try{const{data:S,error:D}=await Z.storage.from("crm-documents").list(`inquiry-${r.id}`,{limit:100,offset:0});if(D)throw D;if(S&&S.length>0){const P=(await Promise.all(S.map(async I=>{const{data:H}=await Z.storage.from("crm-documents").download(`inquiry-${r.id}/${I.name}`);return H?{file:new File([H],I.name,{type:H.type}),name:I.name,size:H.size}:null}))).filter(I=>I!==null);y(P)}}catch(S){console.error("Error loading existing documents:",S)}},q=()=>{let S=`<p>Dear ${r.contact_person||"Sir/Madam"},</p><br>`;if(S+=`<p>Thank you for your inquiry regarding <strong>${r.product_name}</strong>.</p><br>`,r.specification&&(S+=`<p><strong>Specification:</strong> ${r.specification}</p>`),S+=`<p><strong>Quantity:</strong> ${r.quantity}</p><br>`,r.offered_price&&r.offered_price>0){const D=r.offered_price_currency||"USD";S+=`<p><strong>Our Price:</strong> ${D} ${r.offered_price.toLocaleString()}</p><br>`}r.supplier_name&&(S+=`<p><strong>Origin:</strong> ${r.supplier_name}${r.supplier_country?`, ${r.supplier_country}`:""}</p><br>`),S+="<p>Please find the attached documents for your reference.</p><br>",S+="<p>Should you have any questions or require additional information, please feel free to contact us.</p><br>",S+="<p>Best regards,</p>",m(S)},z=async()=>{try{const{data:{user:S}}=await Z.auth.getUser();if(S){const{data:D}=await Z.from("user_profiles").select("full_name").eq("id",S.id).single();k((D==null?void 0:D.full_name)||"")}}catch(S){console.error("Error loading user name:",S)}},ee=S=>{const D={"{{contact_person}}":r.contact_person||"","{{company_name}}":r.company_name,"{{product_name}}":r.product_name,"{{specification}}":r.specification||"-","{{quantity}}":r.quantity,"{{supplier_name}}":r.supplier_name||"-","{{supplier_country}}":r.supplier_country||"-","{{inquiry_number}}":r.inquiry_number,"{{user_name}}":C,"{{offered_price}}":r.offered_price?`${r.offered_price_currency||"USD"} ${r.offered_price.toLocaleString()}`:"Please contact us for pricing","{{purchase_price}}":r.purchase_price?`${r.purchase_price_currency||"USD"} ${r.purchase_price.toLocaleString()}`:"-"};let L=S.subject,P=S.body;Object.entries(D).forEach(([I,H])=>{const V=new RegExp(I.replace(/[{}]/g,"\\$&"),"g");L=L.replace(V,H),P=P.replace(V,H)}),p(L),m(P),E(!1),Z.from("crm_email_templates").update({use_count:S.use_count+1,last_used:new Date().toISOString()}).eq("id",S.id).then(()=>{})},Y=S=>{const D=S.target.files;if(!D)return;const L=[];for(let P=0;P<D.length;P++){const I=D[P];if(I.size>25*1024*1024){alert(`File ${I.name} is too large. Maximum size is 25MB.`);continue}L.push({file:I,name:I.name,size:I.size})}y(P=>[...P,...L])},G=S=>{y(D=>D.filter((L,P)=>P!==S))},re=S=>S<1024?S+" B":S<1024*1024?(S/1024).toFixed(1)+" KB":(S/(1024*1024)).toFixed(1)+" MB",U=async()=>{if(!s||!x||!b){alert("Please fill in all required fields");return}_(!0);try{const{data:{user:S}}=await Z.auth.getUser();if(!S)throw new Error("Not authenticated");const D=[];for(const H of g){const V=`${Date.now()}_${H.name}`,W=`email-attachments/${S.id}/${V}`,{error:M}=await Z.storage.from("crm-documents").upload(W,H.file);M||D.push(W)}const L={inquiry_id:r.id,email_type:"sent",from_email:S.email,to_email:[s,...o?o.split(",").map(H=>H.trim()):[]],cc_email:o?o.split(",").map(H=>H.trim()):null,bcc_email:c?c.split(",").map(H=>H.trim()):null,subject:x,body:b,attachment_urls:D.length>0?D:null,sent_date:new Date().toISOString(),created_by:S.id},{error:P}=await Z.from("crm_email_activities").insert([L]);if(P)throw P;const I={};x.toLowerCase().includes("price")||x.toLowerCase().includes("quote")?(I.price_quoted=!0,I.price_quoted_date=new Date().toISOString().split("T")[0],I.status="price_quoted"):(x.toLowerCase().includes("coa")||x.toLowerCase().includes("msds"))&&(I.coa_sent=!0,I.coa_sent_date=new Date().toISOString().split("T")[0]),Object.keys(I).length>0&&await Z.from("crm_inquiries").update(I).eq("id",r.id),alert("Email sent successfully!"),t()}catch(S){console.error("Error sending email:",S),alert("Failed to send email. Please try again.")}finally{_(!1)}};return e?n.jsx(Ot,{isOpen:e,onClose:t,title:"",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between border-b pb-4",children:[n.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[n.jsx(ua,{className:"w-5 h-5"}),a?"Reply to Email":"New Message"]}),n.jsxs("button",{onClick:()=>E(!B),className:"flex items-center gap-1 px-3 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 text-gray-700 rounded transition",children:[n.jsx(vA,{className:"w-4 h-4"}),"Templates",n.jsx(Cs,{className:"w-3 h-3"})]})]}),B&&n.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-3",children:[n.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Choose a template:"}),n.jsx("div",{className:"grid grid-cols-2 gap-2",children:j.map(S=>n.jsxs("button",{onClick:()=>ee(S),className:"px-3 py-2 text-left text-sm bg-white hover:bg-blue-50 border border-gray-200 rounded transition",children:[n.jsx("div",{className:"font-medium text-gray-900",children:S.template_name}),n.jsx("div",{className:"text-xs text-gray-500",children:S.category})]},S.id))})]}),n.jsx("div",{children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("label",{className:"text-sm font-medium text-gray-700 w-12",children:"To:"}),n.jsx("input",{type:"email",value:s,onChange:S=>i(S.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-sm",placeholder:"recipient@example.com",required:!0}),n.jsx("button",{onClick:()=>f(!u),className:"text-sm text-blue-600 hover:text-blue-700",children:"Cc"}),n.jsx("button",{onClick:()=>A(!h),className:"text-sm text-blue-600 hover:text-blue-700",children:"Bcc"})]})}),u&&n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("label",{className:"text-sm font-medium text-gray-700 w-12",children:"Cc:"}),n.jsx("input",{type:"text",value:o,onChange:S=>l(S.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-sm",placeholder:"cc@example.com (comma separated)"})]}),h&&n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("label",{className:"text-sm font-medium text-gray-700 w-12",children:"Bcc:"}),n.jsx("input",{type:"text",value:c,onChange:S=>d(S.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-sm",placeholder:"bcc@example.com (comma separated)"})]}),n.jsx("div",{children:n.jsx("input",{type:"text",value:x,onChange:S=>p(S.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Subject",required:!0})}),n.jsx("div",{children:n.jsx("textarea",{value:b.replace(/<[^>]*>/g,""),onChange:S=>m(S.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:15,placeholder:"Compose your email..."})}),g.length>0&&n.jsx("div",{className:"space-y-2",children:g.map((S,D)=>n.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded border border-gray-200",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Wo,{className:"w-4 h-4 text-gray-500"}),n.jsx("span",{className:"text-sm text-gray-700",children:S.name}),n.jsxs("span",{className:"text-xs text-gray-500",children:["(",re(S.size),")"]})]}),n.jsx("button",{onClick:()=>G(D),className:"text-red-600 hover:text-red-700",children:n.jsx(wr,{className:"w-4 h-4"})})]},D))}),n.jsxs("div",{className:"flex items-center justify-between pt-4 border-t",children:[n.jsxs("div",{children:[n.jsx("input",{ref:w,type:"file",multiple:!0,onChange:Y,className:"hidden"}),n.jsxs("button",{onClick:()=>{var S;return(S=w.current)==null?void 0:S.click()},className:"flex items-center gap-2 px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition",children:[n.jsx(Wo,{className:"w-4 h-4"}),"Attach Files"]})]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx("button",{onClick:t,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),n.jsx("button",{onClick:U,disabled:v||!s||!x||!b,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed",children:v?n.jsxs(n.Fragment,{children:[n.jsx(Vo,{className:"w-4 h-4 animate-spin"}),"Sending..."]}):n.jsxs(n.Fragment,{children:[n.jsx($i,{className:"w-4 h-4"}),"Send"]})})]})]}),n.jsxs("div",{className:"text-xs text-gray-500 pt-2 border-t",children:[n.jsx("strong",{children:"Inquiry:"})," ",r.inquiry_number," | ",r.company_name," | ",r.product_name]})]})}):null}function oD({isOpen:e,onClose:t,onSuccess:r,initialData:a}){const{user:s}=Cr(),[i,o]=Q.useState(!1),[l,c]=Q.useState([]),[d,u]=Q.useState([]),[f,h]=Q.useState([]),[A,x]=Q.useState([]),p=Q.useRef(null),[b,m]=Q.useState(""),[g,y]=Q.useState(""),[v,_]=Q.useState(""),[j,N]=Q.useState(""),[B,E]=Q.useState("medium"),[C,k]=Q.useState([]),[w,T]=Q.useState(""),[R,q]=Q.useState(""),[z,ee]=Q.useState(""),[Y,G]=Q.useState([]),[re,U]=Q.useState(""),[S,D]=Q.useState([]),[L,P]=Q.useState(""),[I,H]=Q.useState(!1);Q.useEffect(()=>{if(e){V(),W(),M(),se(),a&&(T(a.inquiry_id||""),q(a.customer_id||""),ee(a.product_id||""));const de=new Date;de.setDate(de.getDate()+1),_(de.toISOString().split("T")[0]),N("17:00")}},[e,a]);const V=async()=>{try{const{data:de,error:ye}=await Z.from("user_profiles").select("id, full_name, email, role").eq("is_active",!0).order("full_name");if(ye)throw ye;c(de||[])}catch(de){console.error("Error loading users:",de)}},W=async()=>{try{const{data:de,error:ye}=await Z.from("crm_inquiries").select("id, inquiry_number, company_name, product_name").order("created_at",{ascending:!1}).limit(100);if(ye)throw ye;u((de||[]).map(Le=>({id:Le.id,label:`${Le.inquiry_number} - ${Le.company_name} (${Le.product_name})`})))}catch(de){console.error("Error loading inquiries:",de)}},M=async()=>{try{const{data:de,error:ye}=await Z.from("customers").select("id, company_name, contact_person").eq("is_active",!0).order("company_name");if(ye)throw ye;h((de||[]).map(Le=>({id:Le.id,label:`${Le.company_name}${Le.contact_person?` (${Le.contact_person})`:""}`})))}catch(de){console.error("Error loading customers:",de)}},se=async()=>{try{const{data:de,error:ye}=await Z.from("products").select("id, product_name, product_code").eq("is_active",!0).order("product_name");if(ye)throw ye;x((de||[]).map(Le=>({id:Le.id,label:`${Le.product_name}${Le.product_code?` (${Le.product_code})`:""}`})))}catch(de){console.error("Error loading products:",de)}},K=de=>{C.includes(de)?k(C.filter(ye=>ye!==de)):k([...C,de])},he=()=>{re.trim()&&!Y.includes(re.trim())&&(G([...Y,re.trim()]),U(""))},ne=de=>{G(Y.filter(ye=>ye!==de))},te=async de=>{const ye=[];for(const Le of S){const we=`${Date.now()}_${Le.name}`,ge=`tasks/${de}/${we}`,{error:Re}=await Z.storage.from("task-attachments").upload(ge,Le);Re?console.error("Error uploading file:",Re):ye.push(ge)}return ye},ce=async de=>{if(de.preventDefault(),!b.trim()){alert("Please enter a task title");return}if(!v||!j){alert("Please set a deadline");return}if(C.length===0){alert("Please assign at least one user");return}try{o(!0);const ye=`${v}T${j}:00`,Le={title:b.trim(),description:g.trim()||null,deadline:ye,priority:B,created_by:s==null?void 0:s.id,assigned_users:C,inquiry_id:w||null,customer_id:R||null,product_id:z||null,tags:Y},{data:we,error:ge}=await Z.from("tasks").insert([Le]).select().single();if(ge)throw ge;if(S.length>0&&we){const Ye=await te(we.id),{error:Be}=await Z.from("tasks").update({attachment_urls:Ye}).eq("id",we.id);if(Be)throw Be}const Re=C.map(Ye=>({task_id:we.id,assigned_user_id:Ye,assigned_by:s==null?void 0:s.id})),{error:et}=await Z.from("task_assignments").insert(Re);if(et)throw et;r()}catch(ye){console.error("Error creating task:",ye),alert("Failed to create task. Please try again.")}finally{o(!1)}},_e=l.filter(de=>de.full_name.toLowerCase().includes(L.toLowerCase())||de.email.toLowerCase().includes(L.toLowerCase()));return n.jsx(Ot,{isOpen:e,onClose:t,title:"Create New Task",size:"lg",children:n.jsxs("form",{onSubmit:ce,className:"space-y-6",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Task Title ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:b,onChange:de=>m(de.target.value),placeholder:"e.g., Send quotation to customer",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),n.jsx("textarea",{value:g,onChange:de=>y(de.target.value),placeholder:"Add detailed instructions or notes...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:4})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Deadline Date ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"date",value:v,onChange:de=>_(de.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Deadline Time ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"time",value:j,onChange:de=>N(de.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Priority ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("select",{value:B,onChange:de=>E(de.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[n.jsx("option",{value:"low",children:"Low"}),n.jsx("option",{value:"medium",children:"Medium"}),n.jsx("option",{value:"high",children:"High"}),n.jsx("option",{value:"urgent",children:"Urgent"})]})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Assign To ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("div",{className:"relative",children:[n.jsx("input",{type:"text",value:L,onChange:de=>P(de.target.value),onFocus:()=>H(!0),placeholder:"Search users...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),n.jsx(Ca,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),I&&n.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-48 overflow-y-auto",children:_e.map(de=>n.jsxs("button",{type:"button",onClick:()=>K(de.id),className:`w-full px-3 py-2 text-left hover:bg-gray-50 flex items-center justify-between ${C.includes(de.id)?"bg-blue-50":""}`,children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-gray-900",children:de.full_name}),n.jsxs("p",{className:"text-xs text-gray-500",children:[de.email,"  ",de.role]})]}),C.includes(de.id)&&n.jsx("div",{className:"w-5 h-5 bg-blue-600 rounded-full flex items-center justify-center",children:n.jsx("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:n.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]},de.id))})]}),C.length>0&&n.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:C.map(de=>{const ye=l.find(Le=>Le.id===de);return n.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-sm",children:[ye==null?void 0:ye.full_name,n.jsx("button",{type:"button",onClick:()=>K(de),className:"text-blue-600 hover:text-blue-800",children:n.jsx(wr,{className:"w-4 h-4"})})]},de)})})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Related Inquiry"}),n.jsxs("select",{value:w,onChange:de=>T(de.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[n.jsx("option",{value:"",children:"None"}),d.map(de=>n.jsx("option",{value:de.id,children:de.label},de.id))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Related Customer"}),n.jsxs("select",{value:R,onChange:de=>q(de.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[n.jsx("option",{value:"",children:"None"}),f.map(de=>n.jsx("option",{value:de.id,children:de.label},de.id))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Related Product"}),n.jsxs("select",{value:z,onChange:de=>ee(de.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[n.jsx("option",{value:"",children:"None"}),A.map(de=>n.jsx("option",{value:de.id,children:de.label},de.id))]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tags"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("input",{type:"text",value:re,onChange:de=>U(de.target.value),onKeyPress:de=>de.key==="Enter"&&(de.preventDefault(),he()),placeholder:"Add tag and press Enter",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),n.jsx("button",{type:"button",onClick:he,className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition",children:"Add"})]}),Y.length>0&&n.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:Y.map(de=>n.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm",children:[n.jsx(Qg,{className:"w-3 h-3"}),de,n.jsx("button",{type:"button",onClick:()=>ne(de),className:"text-gray-500 hover:text-red-600",children:n.jsx(wr,{className:"w-3 h-3"})})]},de))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Attachments"}),n.jsx("input",{ref:p,type:"file",multiple:!0,onChange:de=>{de.target.files&&D(Array.from(de.target.files))},className:"hidden"}),n.jsxs("button",{type:"button",onClick:()=>{var de;return(de=p.current)==null?void 0:de.click()},className:"flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:[n.jsx(Wo,{className:"w-4 h-4"}),"Choose Files"]}),S.length>0&&n.jsx("div",{className:"mt-2 space-y-2",children:S.map((de,ye)=>n.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 border border-gray-200 rounded-lg",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Zt,{className:"w-4 h-4 text-gray-500"}),n.jsx("span",{className:"text-sm text-gray-700",children:de.name}),n.jsxs("span",{className:"text-xs text-gray-500",children:["(",(de.size/1024).toFixed(1)," KB)"]})]}),n.jsx("button",{type:"button",onClick:()=>D(Le=>Le.filter((we,ge)=>ge!==ye)),className:"text-red-600 hover:text-red-700",children:n.jsx(wr,{className:"w-4 h-4"})})]},ye))})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[n.jsx("button",{type:"button",onClick:t,disabled:i,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition disabled:opacity-50",children:"Cancel"}),n.jsx("button",{type:"submit",disabled:i||!b.trim()||C.length===0,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed",children:i?n.jsxs(n.Fragment,{children:[n.jsx(Vo,{className:"w-4 h-4 animate-spin"}),"Creating..."]}):"Create Task"})]})]})})}function mue({inquiry:e,compact:t=!1,onMarkSent:r}){const a=[{type:"price",letter:"P",required:e.price_required??!0,sent:e.price_sent_at,label:"Price"},{type:"coa",letter:"C",required:e.coa_required??!0,sent:e.coa_sent_at,label:"COA"},{type:"sample",letter:"S",required:e.sample_required,sent:e.sample_sent_at,label:"Sample"},{type:"agency_letter",letter:"A",required:e.agency_letter_required,sent:e.agency_letter_sent_at,label:"Agency Letter"},{type:"others",letter:"O",required:e.others_required,sent:e.others_sent_at,label:"Others"}];return a.some(i=>i.required)?n.jsx("div",{className:"flex flex-wrap gap-1.5",children:a.filter(i=>i.required).map(i=>n.jsx("button",{onClick:()=>r==null?void 0:r(i.type),disabled:!r,className:`
            inline-flex items-center justify-center
            w-6 h-6 rounded text-xs font-bold
            transition-colors duration-150
            ${i.sent?"bg-green-100 text-green-700 hover:bg-green-200 cursor-pointer":"bg-red-100 text-red-700 hover:bg-red-200 cursor-pointer"}
            ${r?"":"cursor-default"}
          `,title:`${i.label}${i.sent?" - Sent (Click to unmark)":" - Pending (Click to mark as sent)"}`,children:i.letter},i.type))}):n.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs bg-gray-100 text-gray-500",children:[n.jsx(gue,{className:"w-3 h-3"}),!t&&"Nothing required"]})}function gue({className:e}){return n.jsx("svg",{className:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:n.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})})}const DS={new:{label:"New",color:"bg-gray-100 text-gray-700 border-gray-300",icon:bE},in_progress:{label:"In Progress",color:"bg-blue-100 text-blue-700 border-blue-300",icon:zo},follow_up:{label:"Follow Up",color:"bg-purple-100 text-purple-700 border-purple-300",icon:da},won:{label:"Won",color:"bg-green-100 text-green-700 border-green-300",icon:Zr},lost:{label:"Lost",color:"bg-red-100 text-red-700 border-red-300",icon:gn},on_hold:{label:"On Hold",color:"bg-yellow-100 text-yellow-700 border-yellow-300",icon:B7}};function lD({status:e,compact:t=!1}){const r=DS[e]||DS.new,a=r.icon;return n.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium border ${r.color}`,children:[n.jsx(a,{className:"w-3 h-3"}),!t&&r.label]})}const Qm=[{value:"new",label:"New"},{value:"in_progress",label:"In Progress"},{value:"follow_up",label:"Follow Up"},{value:"won",label:"Won"},{value:"lost",label:"Lost"},{value:"on_hold",label:"On Hold"}];function xue({isOpen:e,onClose:t,inquiryId:r,inquiryNumber:a,onSuccess:s}){const[i,o]=Q.useState(""),[l,c]=Q.useState(""),[d,u]=Q.useState(""),[f,h]=Q.useState(!1),A=async b=>{if(b.preventDefault(),i.trim().length<10){alert("Please provide a detailed reason (at least 10 characters)");return}h(!0);try{const m={pipeline_status:"lost",lost_reason:i.trim(),lost_at:new Date().toISOString()};l.trim()&&(m.competitor_name=l.trim()),d.trim()&&(m.competitor_price=parseFloat(d));const{error:g}=await Z.from("crm_inquiries").update(m).eq("id",r);if(g)throw g;s(),t(),x()}catch(m){console.error("Error marking inquiry as lost:",m),alert("Failed to mark inquiry as lost. Please try again.")}finally{h(!1)}},x=()=>{o(""),c(""),u("")},p=()=>{f||(t(),x())};return n.jsx(Ot,{isOpen:e,onClose:p,title:`Mark Inquiry #${a} as Lost`,children:n.jsxs("form",{onSubmit:A,className:"space-y-4",children:[n.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-start gap-3",children:[n.jsx(gn,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),n.jsxs("div",{className:"text-sm text-red-800",children:[n.jsx("p",{className:"font-medium",children:"You are about to mark this inquiry as lost."}),n.jsx("p",{className:"mt-1 text-red-700",children:"This will move it to the Archive. Please provide details below."})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Lost Reason ",n.jsx("span",{className:"text-red-600",children:"*"})]}),n.jsx("textarea",{value:i,onChange:b=>o(b.target.value),placeholder:"e.g., Competitor offered lower price, Customer chose local supplier, Budget constraints...",rows:4,required:!0,minLength:10,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Minimum 10 characters. Be specific to help improve future quotes."})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Competitor Name ",n.jsx("span",{className:"text-gray-400",children:"(optional)"})]}),n.jsx("input",{type:"text",value:l,onChange:b=>c(b.target.value),placeholder:"e.g., ABC Trading Co.",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Competitor Price (USD) ",n.jsx("span",{className:"text-gray-400",children:"(optional)"})]}),n.jsx("input",{type:"number",step:"0.01",value:d,onChange:b=>u(b.target.value),placeholder:"0.00",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[n.jsx("button",{type:"button",onClick:p,disabled:f,className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50",children:"Cancel"}),n.jsx("button",{type:"submit",disabled:f||i.trim().length<10,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:f?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Saving..."]}):n.jsxs(n.Fragment,{children:[n.jsx(gn,{className:"w-4 h-4"}),"Mark as Lost"]})})]})]})})}function yue({inquiries:e,onRefresh:t,canManage:r,onAddInquiry:a}){const{profile:s}=Cr(),[i,o]=Q.useState(new Set),[l,c]=Q.useState([]),[d,u]=Q.useState(null),[f,h]=Q.useState(e),[A,x]=Q.useState({column:"inquiry_date",direction:"desc"}),[p,b]=Q.useState(null),[m,g]=Q.useState(""),[y,v]=Q.useState(!1),[_,j]=Q.useState(null),[N,B]=Q.useState(!1),[E,C]=Q.useState(""),[k,w]=Q.useState(!1),[T,R]=Q.useState(""),[q,z]=Q.useState(""),[ee,Y]=Q.useState(!1),[G,re]=Q.useState(!1),[U,S]=Q.useState(!1),[D,L]=Q.useState(null),[P,I]=Q.useState(!1),[H,V]=Q.useState(null),[W,M]=Q.useState(""),[se,K]=Q.useState(!1),[he,ne]=Q.useState({price_required:!1,coa_required:!1,sample_required:!1,agency_letter_required:!1,others_required:!1}),[te,ce]=Q.useState(new Set),[_e,de]=Q.useState(new Map),ye=Q.useRef(null),[Le,we]=Q.useState({checkbox:50,inquiry_number:120,inquiry_date:120,product_name:200,specification:200,quantity:100,supplier_name:150,company_name:180,mail_subject:200,aceerp_no:120,status:130,pipeline_status:130,our_side:130,purchase_price:100,offered_price:100,delivery_date:120,priority:100,remarks:200}),[ge,Re]=Q.useState(null),et=[{value:"urgent",label:"Urgent",icon:n.jsx(NE,{className:"w-3 h-3 text-red-600"})},{value:"high",label:"High",icon:n.jsx(Yb,{className:"w-3 h-3 text-orange-600"})},{value:"medium",label:"Medium",icon:n.jsx(Mg,{className:"w-3 h-3 text-gray-400"})},{value:"low",label:"Low",icon:n.jsx(Mg,{className:"w-3 h-3 text-gray-300"})}];Q.useEffect(()=>{Fe()},[e,l,A]),Q.useEffect(()=>{function ie(Ae){ye.current&&!ye.current.contains(Ae.target)&&u(null)}return document.addEventListener("mousedown",ie),()=>document.removeEventListener("mousedown",ie)},[]),Q.useEffect(()=>{const ie=le=>{if(!ge)return;const ve=le.clientX-ge.startX,me=Math.max(50,ge.startWidth+ve);we(Pe=>({...Pe,[ge.column]:me}))},Ae=()=>{Re(null)};if(ge)return document.addEventListener("mousemove",ie),document.addEventListener("mouseup",Ae),()=>{document.removeEventListener("mousemove",ie),document.removeEventListener("mouseup",Ae)}},[ge]);const Ye=(ie,Ae)=>{Ae.preventDefault(),Ae.stopPropagation(),Re({column:ie,startX:Ae.clientX,startWidth:Le[ie]||150})},Be=({column:ie,label:Ae,sortable:le=!0,className:ve=""})=>n.jsxs("th",{style:{width:Le[ie],minWidth:Le[ie]},className:`relative px-3 py-2 text-left font-semibold text-gray-700 border-r border-gray-300 ${le?"cursor-pointer hover:bg-gray-100 select-none":""} ${ve}`,onClick:le?()=>oe(ie):void 0,children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("span",{className:"truncate",children:Ae}),le&&ke(ie)]}),n.jsx("div",{className:"absolute top-0 right-0 w-1 h-full cursor-col-resize hover:bg-blue-400 group",onMouseDown:me=>Ye(ie,me),onClick:me=>me.stopPropagation(),children:n.jsx("div",{className:"absolute top-0 right-0 w-1 h-full bg-transparent group-hover:bg-blue-400"})})]}),Fe=()=>{let ie=[...e];l.forEach(Ae=>{Ae.values.length>0&&(ie=ie.filter(le=>{const ve=le[Ae.column];return Ae.values.includes(String(ve||""))}))}),A.column&&A.direction&&ie.sort((Ae,le)=>{const ve=Ae[A.column],me=le[A.column];if(ve==null&&me==null)return 0;if(ve==null)return A.direction==="asc"?1:-1;if(me==null)return A.direction==="asc"?-1:1;const Pe=String(ve).toLowerCase(),Qe=String(me).toLowerCase();return A.direction==="asc"?Pe>Qe?1:Pe<Qe?-1:0:Pe<Qe?1:Pe>Qe?-1:0}),h(ie)},oe=ie=>{let Ae="asc";A.column===ie&&(A.direction==="asc"?Ae="desc":A.direction==="desc"&&(Ae=null)),x({column:ie,direction:Ae})},ke=ie=>A.column!==ie?n.jsx(y5,{className:"w-3 h-3 text-gray-400"}):A.direction==="asc"?n.jsx(Yb,{className:"w-3 h-3 text-blue-600"}):A.direction==="desc"?n.jsx(s7,{className:"w-3 h-3 text-blue-600"}):n.jsx(y5,{className:"w-3 h-3 text-gray-400"}),Ue=()=>{re(!0);try{const ie=f.map(me=>{var Pe,Qe;return{"No.":me.inquiry_number,Date:new Date(me.inquiry_date).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"}),Product:me.product_name,Specification:me.specification||"-",Qty:me.quantity,Supplier:me.supplier_name||"-",Country:me.supplier_country||"-",Company:me.company_name,"Mail Subject":me.mail_subject||"-","ACE ERP#":me.aceerp_no||"-",Pipeline:((Pe=Qm.find(Ke=>Ke.value===me.pipeline_status))==null?void 0:Pe.label)||"-","Price Needed":me.price_required?"Yes":"No","COA Needed":me.coa_required?"Yes":"No","Sample Needed":me.sample_required?"Yes":"No","Agency Letter Needed":me.agency_letter_required?"Yes":"No","Others Needed":me.others_required?"Yes":"No","Price Sent":me.price_sent_at?"Yes":"No","COA Sent":me.coa_sent_at?"Yes":"No","Sample Sent":me.sample_sent_at?"Yes":"No","Agency Letter Sent":me.agency_letter_sent_at?"Yes":"No","Purchase Price":me.purchase_price?`${me.purchase_price} ${me.purchase_price_currency||"USD"}`:"-","Offered Price":me.offered_price?`${me.offered_price} ${me.offered_price_currency||"USD"}`:"-","Delivery Date":me.delivery_date?new Date(me.delivery_date).toLocaleDateString("en-GB"):"-","Delivery Terms":me.delivery_terms||"-",Priority:((Qe=et.find(Ke=>Ke.value===me.priority))==null?void 0:Qe.label)||me.priority,Remarks:me.remarks||"-"}}),Ae=va.json_to_sheet(ie);Ae["!cols"]=[{wch:15},{wch:12},{wch:30},{wch:20},{wch:10},{wch:20},{wch:12},{wch:25},{wch:30},{wch:12},{wch:15},{wch:13},{wch:12},{wch:15},{wch:20},{wch:12},{wch:11},{wch:13},{wch:19},{wch:18},{wch:18},{wch:15},{wch:18},{wch:10},{wch:30}];const le=va.book_new();va.book_append_sheet(le,Ae,"CRM Inquiries");const ve=`CRM-Inquiries-${new Date().toISOString().split("T")[0]}.xlsx`;E0(le,ve),alert(`Exported ${ie.length} inquiries to ${ve}`)}catch(ie){console.error("Export error:",ie),alert("Failed to export data. Please try again.")}finally{re(!1)}},qe=()=>{re(!0);try{const ie=f.map(Qe=>{var Ke,Xe;return{"No.":Qe.inquiry_number,Date:new Date(Qe.inquiry_date).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"}),Product:Qe.product_name,Specification:Qe.specification||"-",Qty:Qe.quantity,Supplier:Qe.supplier_name||"-",Country:Qe.supplier_country||"-",Company:Qe.company_name,"Mail Subject":Qe.mail_subject||"-","ACE ERP#":Qe.aceerp_no||"-",Pipeline:((Ke=Qm.find(Me=>Me.value===Qe.pipeline_status))==null?void 0:Ke.label)||"-","Price Needed":Qe.price_required?"Yes":"No","COA Needed":Qe.coa_required?"Yes":"No","Sample Needed":Qe.sample_required?"Yes":"No","Agency Letter Needed":Qe.agency_letter_required?"Yes":"No","Others Needed":Qe.others_required?"Yes":"No","Price Sent":Qe.price_sent_at?"Yes":"No","COA Sent":Qe.coa_sent_at?"Yes":"No","Sample Sent":Qe.sample_sent_at?"Yes":"No","Agency Letter Sent":Qe.agency_letter_sent_at?"Yes":"No","Purchase Price":Qe.purchase_price?`${Qe.purchase_price} ${Qe.purchase_price_currency||"USD"}`:"-","Offered Price":Qe.offered_price?`${Qe.offered_price} ${Qe.offered_price_currency||"USD"}`:"-","Delivery Date":Qe.delivery_date?new Date(Qe.delivery_date).toLocaleDateString("en-GB"):"-","Delivery Terms":Qe.delivery_terms||"-",Priority:((Xe=et.find(Me=>Me.value===Qe.priority))==null?void 0:Xe.label)||Qe.priority,Remarks:Qe.remarks||"-"}}),Ae=va.json_to_sheet(ie),le=va.sheet_to_csv(Ae),ve=new Blob([le],{type:"text/csv;charset=utf-8;"}),me=document.createElement("a"),Pe=URL.createObjectURL(ve);me.setAttribute("href",Pe),me.setAttribute("download",`CRM-Inquiries-${new Date().toISOString().split("T")[0]}.csv`),me.style.visibility="hidden",document.body.appendChild(me),me.click(),document.body.removeChild(me),alert(`Exported ${ie.length} inquiries to CSV. You can import this file to Google Sheets.`)}catch(ie){console.error("Export error:",ie),alert("Failed to export data. Please try again.")}finally{re(!1)}},$e=()=>{const ie=[{Date:"02-12-2024",Product:"Example Product Name",Specification:"BP / USP / EP",Qty:"500 KG",Supplier:"Manufacturer Name",Country:"Japan",Company:"Customer Company Name","Mail Subject":"Inquiry for Product","ACE ERP#":"ACE-123","Price Needed":"Yes","COA Needed":"Yes","Sample Needed":"No","Agency Letter Needed":"No","Others Needed":"No","Purchase Price":"100","Purchase Price Currency":"USD","Offered Price":"150","Offered Price Currency":"USD","Delivery Date":"2025-12-31","Delivery Terms":"FOB Shanghai",Priority:"Medium",Remarks:"Additional notes"}],Ae=va.json_to_sheet(ie),le=va.book_new();va.book_append_sheet(le,Ae,"Import Template"),E0(le,"CRM-Import-Template.xlsx"),alert("Template downloaded! Fill in your data and use the Import button to upload.")},Ne=ie=>{var ve;const Ae=(ve=ie.target.files)==null?void 0:ve[0];if(!Ae)return;const le=new FileReader;le.onload=async me=>{var Pe;try{const Qe=new Uint8Array((Pe=me.target)==null?void 0:Pe.result),Ke=xx(Qe,{type:"array"}),Xe=Ke.Sheets[Ke.SheetNames[0]],Me=va.sheet_to_json(Xe);if(Me.length===0){alert("No data found in the file");return}const{data:{user:Ce}}=await Z.auth.getUser();if(!Ce)throw new Error("Not authenticated");const We=lt=>{if(!lt)return new Date().toISOString().split("T")[0];if(typeof lt=="number"){const tr=new Date(1899,11,30),Er=new Date(tr.getTime()+lt*864e5),Hr=Er.getFullYear(),Gs=(Er.getMonth()+1).toString().padStart(2,"0"),Fn=Er.getDate().toString().padStart(2,"0");return`${Hr}-${Gs}-${Fn}`}const kt=lt.toString().trim(),Xt=kt.match(/^(\d{1,2})\/(\d{1,2})\/(\d{2})$/);if(Xt){let[,tr,Er,Hr]=Xt;return`${parseInt(Hr)<30?`20${Hr}`:`19${Hr}`}-${Er.padStart(2,"0")}-${tr.padStart(2,"0")}`}const $t=kt.match(/^(\d{1,2})-(\d{1,2})-(\d{4})$/);if($t){const[,tr,Er,Hr]=$t;return`${Hr}-${Er.padStart(2,"0")}-${tr.padStart(2,"0")}`}const Pt=kt.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/);if(Pt){const[,tr,Er,Hr]=Pt;return`${Hr}-${Er.padStart(2,"0")}-${tr.padStart(2,"0")}`}const jr=kt.match(/^(\d{4})-(\d{1,2})-(\d{1,2})$/);if(jr){const[,tr,Er,Hr]=jr;return`${tr}-${Er.padStart(2,"0")}-${Hr.padStart(2,"0")}`}return new Date().toISOString().split("T")[0]},Je=Me.map(lt=>({product_name:lt.Product||"",specification:lt.Specification||null,quantity:lt.Qty||"",supplier_name:lt.Supplier||null,supplier_country:lt.Country||null,company_name:lt.Company||"",mail_subject:lt["Mail Subject"]||null,aceerp_no:lt["ACE ERP#"]||null,price_required:(lt["Price Needed"]||"").toLowerCase()==="yes",coa_required:(lt["COA Needed"]||"").toLowerCase()==="yes",sample_required:(lt["Sample Needed"]||"").toLowerCase()==="yes",agency_letter_required:(lt["Agency Letter Needed"]||"").toLowerCase()==="yes",others_required:(lt["Others Needed"]||"").toLowerCase()==="yes",purchase_price:lt["Purchase Price"]?parseFloat(lt["Purchase Price"]):null,purchase_price_currency:lt["Purchase Price Currency"]||"USD",offered_price:lt["Offered Price"]?parseFloat(lt["Offered Price"]):null,offered_price_currency:lt["Offered Price Currency"]||"USD",delivery_date:lt["Delivery Date"]||null,delivery_terms:lt["Delivery Terms"]||null,priority:(lt.Priority||"medium").toLowerCase(),remarks:lt.Remarks||null,inquiry_date:We(lt.Date),pipeline_status:"new",status:"new",inquiry_source:"other",assigned_to:Ce.id,created_by:Ce.id})),{error:ot}=await Z.from("crm_inquiries").insert(Je);if(ot)throw ot;alert(`Successfully imported ${Je.length} inquiries!`),t(),ie.target.value=""}catch(Qe){console.error("Import error:",Qe),alert("Failed to import data. Please check the file format and try again."),ie.target.value=""}},le.readAsArrayBuffer(Ae)},Ee=(ie,Ae)=>{c(le=>{const ve=le.find(me=>me.column===ie);if(ve){const me=ve.values.includes(Ae)?ve.values.filter(Pe=>Pe!==Ae):[...ve.values,Ae];return me.length===0?le.filter(Pe=>Pe.column!==ie):le.map(Pe=>Pe.column===ie?{...Pe,values:me}:Pe)}return[...le,{column:ie,values:[Ae]}]})},ze=ie=>{c(Ae=>Ae.filter(le=>le.column!==ie))},rt=ie=>{const Ae=e.map(le=>le[ie]);return[...new Set(Ae)].filter(Boolean).sort()},nt=ie=>l.some(Ae=>Ae.column===ie&&Ae.values.length>0),mt=ie=>{o(Ae=>{const le=new Set(Ae);return le.has(ie)?le.delete(ie):le.add(ie),le})},gt=()=>{i.size===f.length?o(new Set):o(new Set(f.map(ie=>ie.id)))},Nt=async ie=>{const Ae=new Set(te);if(Ae.has(ie))Ae.delete(ie);else if(Ae.add(ie),!_e.has(ie))try{const{data:le,error:ve}=await Z.from("crm_inquiry_items").select("*").eq("parent_inquiry_id",ie).order("inquiry_number",{ascending:!0});if(ve)throw ve;const me=new Map(_e);me.set(ie,le||[]),de(me)}catch(le){console.error("Error fetching inquiry items:",le)}ce(Ae)},yt=(ie,Ae)=>{r&&(b({id:ie.id,field:Ae}),g(String(ie[Ae]||"")))},Et=async()=>{if(p)try{const{error:ie}=await Z.from("crm_inquiries").update({[p.field]:m||null}).eq("id",p.id);if(ie)throw ie;b(null),t()}catch(ie){console.error("Error updating field:",ie),alert("Failed to update. Please try again.")}},It=async(ie,Ae)=>{try{const{error:le}=await Z.from("crm_inquiries").update({priority:Ae}).eq("id",ie.id);if(le)throw le;t()}catch(le){console.error("Error updating priority:",le)}},ir=async(ie,Ae)=>{if(Ae==="lost"){L(ie),S(!0);return}try{const{error:le}=await Z.from("crm_inquiries").update({pipeline_status:Ae}).eq("id",ie.id);if(le)throw le;t()}catch(le){console.error("Error updating pipeline status:",le)}},Oe=async(ie,Ae)=>{var me;const le=`${Ae}_sent_at`;if(ie[le]){if(!confirm(`Are you sure you want to unmark ${Ae.toUpperCase()} as sent?`))return;try{const Pe={[le]:null},{error:Qe}=await Z.from("crm_inquiries").update(Pe).eq("id",ie.id);if(Qe)throw Qe;t(),alert(`${Ae.toUpperCase()} unmarked!`)}catch(Pe){console.error("Error unmarking requirement:",Pe),alert("Failed to unmark. Please try again.")}return}if(Ae==="price"){V(ie),M(((me=ie.offered_price)==null?void 0:me.toString())||""),I(!0);return}try{const{error:Pe}=await Z.rpc("mark_requirement_sent",{inquiry_id:ie.id,requirement_type:Ae});if(Pe)throw Pe;t(),alert(`${Ae.toUpperCase()} marked as sent!`)}catch(Pe){console.error("Error marking requirement as sent:",Pe),alert("Failed to mark as sent. Please try again.")}},tt=async()=>{if(!H)return;const ie=W.trim()?parseFloat(W):null;try{const{error:Ae}=await Z.from("crm_inquiries").update({offered_price:ie}).eq("id",H.id);if(Ae)throw Ae;const{error:le}=await Z.rpc("mark_requirement_sent",{inquiry_id:H.id,requirement_type:"price"});if(le)throw le;I(!1),V(null),M(""),t(),alert("Price marked as sent with offered price updated!")}catch(Ae){console.error("Error saving offered price and marking sent:",Ae),alert("Failed to save. Please try again.")}},At=()=>{const ie=f.find(Ae=>i.has(Ae.id));ie&&(j(ie),v(!0))},wt=async()=>{const ie=f.find(Ae=>i.has(Ae.id));ie&&(j(ie),v(!0))},ht=()=>{B(!0)},Ft=async()=>{const ie=f.find(Ae=>i.has(Ae.id));if(ie)try{const{data:{user:Ae}}=await Z.auth.getUser();if(!Ae)throw new Error("Not authenticated");await Z.from("crm_activities").insert({inquiry_id:ie.id,activity_type:"call",description:E,activity_date:new Date().toISOString().split("T")[0],is_completed:!0,created_by:Ae.id}),B(!1),C(""),alert("Call logged successfully!"),t()}catch(Ae){console.error("Error logging call:",Ae),alert("Failed to log call. Please try again.")}},Ht=async()=>{if(i.size===0)return;const ie=i.size;if(confirm(`Are you sure you want to delete ${ie} selected ${ie===1?"inquiry":"inquiries"}? This action cannot be undone.`))try{const Ae=Array.from(i),{error:le}=await Z.from("crm_inquiries").delete().in("id",Ae);if(le)throw le;o(new Set),alert(`Successfully deleted ${ie} ${ie===1?"inquiry":"inquiries"}`),t()}catch(Ae){console.error("Error deleting inquiries:",Ae),alert("Failed to delete inquiries. Please try again.")}},vr=()=>{w(!0)},xr=async()=>{const ie=f.find(Ae=>i.has(Ae.id));if(ie)try{const{data:{user:Ae}}=await Z.auth.getUser();if(!Ae)throw new Error("Not authenticated");await Z.from("crm_activities").insert({inquiry_id:ie.id,activity_type:"follow_up",description:q,activity_date:new Date().toISOString().split("T")[0],follow_up_date:T,is_completed:!1,created_by:Ae.id}),w(!1),R(""),z(""),alert("Follow-up scheduled successfully!"),t()}catch(Ae){console.error("Error scheduling follow-up:",Ae),alert("Failed to schedule follow-up. Please try again.")}},Jt=()=>{const ie=f.find(Ae=>i.has(Ae.id));ie&&(ne({price_required:ie.price_required??!1,coa_required:ie.coa_required??!1,sample_required:ie.sample_required??!1,agency_letter_required:ie.agency_letter_required??!1,others_required:ie.others_required??!1}),K(!0))},Wt=async()=>{const ie=f.find(Ae=>i.has(Ae.id));if(ie)try{const{error:Ae}=await Z.from("crm_inquiries").update(he).eq("id",ie.id);if(Ae)throw Ae;K(!1),alert("Customer requirements updated successfully!"),t()}catch(Ae){console.error("Error updating requirements:",Ae),alert("Failed to update requirements. Please try again.")}},ue=f.find(ie=>i.has(ie.id));return n.jsxs("div",{className:"space-y-4",children:[n.jsx("div",{className:"flex items-center justify-between",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("button",{onClick:Ue,disabled:G||f.length===0,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition disabled:opacity-50 disabled:cursor-not-allowed",title:"Export to Excel (.xlsx)",children:[n.jsx(b5,{className:"w-3.5 h-3.5"}),G?"Exporting...":"Export Excel"]}),n.jsxs("button",{onClick:qe,disabled:G||f.length===0,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition disabled:opacity-50 disabled:cursor-not-allowed",title:"Export to CSV for Google Sheets",children:[n.jsx(Zn,{className:"w-3.5 h-3.5"}),G?"Exporting...":"Export CSV"]}),r&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"w-px h-8 bg-gray-300 mx-2"}),n.jsxs("button",{onClick:$e,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition",title:"Download Excel template for bulk import",children:[n.jsx(Zn,{className:"w-3.5 h-3.5"}),"Download Template"]}),n.jsxs("label",{className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition cursor-pointer",children:[n.jsx(b5,{className:"w-3.5 h-3.5"}),"Import Excel",n.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:Ne,className:"hidden"})]}),a&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"w-px h-8 bg-gray-300 mx-2"}),n.jsxs("button",{onClick:a,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-blue-700 bg-blue-50 border border-blue-200 rounded-md hover:bg-blue-100 transition",children:[n.jsx(Pr,{className:"w-3.5 h-3.5"}),"Add Inquiry"]})]})]}),n.jsxs("div",{className:"text-sm text-gray-600 ml-2",children:[f.length," ",f.length===1?"inquiry":"inquiries",l.length>0&&" (filtered)",A.direction&&" (sorted)"]})]})}),i.size>0&&r&&ue&&n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("div",{className:"flex items-center gap-3",children:n.jsxs("div",{className:"text-sm font-medium text-blue-900",children:["Selected: ",n.jsx("span",{className:"font-bold",children:ue.inquiry_number})," - ",ue.product_name]})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("button",{onClick:At,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-blue-700 bg-blue-50 border border-blue-200 rounded-md hover:bg-blue-100 transition",children:[n.jsx($i,{className:"w-3.5 h-3.5"}),"Send Price"]}),n.jsxs("button",{onClick:wt,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-green-700 bg-green-50 border border-green-200 rounded-md hover:bg-green-100 transition",children:[n.jsx(Zt,{className:"w-3.5 h-3.5"}),"Send COA/MSDS"]}),n.jsxs("button",{onClick:ht,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition",children:[n.jsx(Ul,{className:"w-3.5 h-3.5"}),"Log Call"]}),n.jsxs("button",{onClick:vr,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition",children:[n.jsx(ja,{className:"w-3.5 h-3.5"}),"Schedule Follow-up"]}),n.jsxs("button",{onClick:()=>Y(!0),className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition",children:[n.jsx(u0,{className:"w-3.5 h-3.5"}),"Create Task"]}),n.jsxs("button",{onClick:Jt,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-purple-700 bg-purple-50 border border-purple-200 rounded-md hover:bg-purple-100 transition",title:"Edit Customer Requirements",children:[n.jsx(u0,{className:"w-3.5 h-3.5"}),"Edit Requirements"]}),n.jsxs("button",{onClick:Ht,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-red-700 bg-red-50 border border-red-200 rounded-md hover:bg-red-100 transition",title:"Delete Selected",children:[n.jsx(wr,{className:"w-3.5 h-3.5"}),"Delete"]}),n.jsx("button",{onClick:()=>o(new Set),className:"p-1.5 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-md transition",title:"Deselect",children:n.jsx(wr,{className:"w-3.5 h-3.5"})})]})]})}),n.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden border border-gray-200",children:n.jsx("div",{className:"overflow-x-auto overflow-y-auto",style:{maxHeight:"calc(100vh - 280px)"},children:n.jsxs("table",{className:"w-full text-sm border-collapse",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{className:"border-b border-gray-300",children:[n.jsx("th",{className:"px-3 py-2 border-r border-gray-300",children:n.jsx("input",{type:"checkbox",checked:i.size===f.length&&f.length>0,onChange:gt,className:"rounded border-gray-300"})}),n.jsx(Be,{column:"inquiry_number",label:"No.",className:"whitespace-nowrap"}),n.jsx(Be,{column:"inquiry_date",label:"Date",className:"whitespace-nowrap"}),n.jsx(Be,{column:"product_name",label:"Product"}),n.jsx(Be,{column:"specification",label:"Specification"}),n.jsx(Be,{column:"quantity",label:"Qty"}),n.jsx(Be,{column:"supplier_name",label:"Supplier"}),n.jsxs("th",{className:"px-3 py-2 text-left font-semibold text-gray-700 border-r border-gray-300 min-w-[150px] relative",children:[n.jsxs("div",{className:"flex items-center justify-between gap-2",children:[n.jsx("span",{children:"Company"}),n.jsx("button",{onClick:()=>u(d==="company_name"?null:"company_name"),className:`p-0.5 rounded hover:bg-gray-200 ${nt("company_name")?"text-blue-600":""}`,children:n.jsx(Cs,{className:"w-4 h-4"})})]}),d==="company_name"&&n.jsxs("div",{ref:ye,className:"absolute top-full left-0 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg z-50 w-64",children:[n.jsxs("div",{className:"p-2 border-b border-gray-200 flex items-center justify-between",children:[n.jsx("span",{className:"text-xs font-medium",children:"Filter Company"}),nt("company_name")&&n.jsx("button",{onClick:()=>ze("company_name"),className:"text-xs text-blue-600 hover:text-blue-700",children:"Clear"})]}),n.jsx("div",{className:"p-2 max-h-64 overflow-y-auto",children:rt("company_name").map(ie=>{var le;const Ae=(le=l.find(ve=>ve.column==="company_name"))==null?void 0:le.values.includes(String(ie));return n.jsxs("label",{className:"flex items-center gap-2 p-1.5 hover:bg-gray-50 rounded cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:Ae,onChange:()=>Ee("company_name",String(ie)),className:"rounded border-gray-300"}),n.jsx("span",{className:"text-sm",children:String(ie)})]},String(ie))})})]})]}),n.jsx(Be,{column:"mail_subject",label:"Mail Subject"}),n.jsx(Be,{column:"aceerp_no",label:"ACE ERP#"}),n.jsxs("th",{className:"px-3 py-2 text-left font-semibold text-gray-700 border-r border-gray-300 relative min-w-[130px]",children:[n.jsxs("div",{className:"flex items-center justify-between gap-2",children:[n.jsx("span",{children:"Pipeline"}),n.jsx("button",{onClick:()=>u(d==="pipeline_status"?null:"pipeline_status"),className:`p-0.5 rounded hover:bg-gray-200 ${nt("pipeline_status")?"text-blue-600":""}`,children:n.jsx(Cs,{className:"w-4 h-4"})})]}),d==="pipeline_status"&&n.jsxs("div",{ref:ye,className:"absolute top-full left-0 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg z-50 w-56",children:[n.jsxs("div",{className:"p-2 border-b border-gray-200 flex items-center justify-between",children:[n.jsx("span",{className:"text-xs font-medium",children:"Filter Pipeline"}),nt("pipeline_status")&&n.jsx("button",{onClick:()=>ze("pipeline_status"),className:"text-xs text-blue-600 hover:text-blue-700",children:"Clear"})]}),n.jsx("div",{className:"p-2 max-h-64 overflow-y-auto",children:Qm.map(ie=>{var le;const Ae=(le=l.find(ve=>ve.column==="pipeline_status"))==null?void 0:le.values.includes(ie.value);return n.jsxs("label",{className:"flex items-center gap-2 p-1.5 hover:bg-gray-50 rounded cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:Ae,onChange:()=>Ee("pipeline_status",ie.value),className:"rounded border-gray-300"}),n.jsx("span",{className:"text-sm",children:ie.label})]},ie.value)})})]})]}),n.jsxs("th",{className:"px-3 py-2 text-left font-semibold text-gray-700 border-r border-gray-300 min-w-[120px] relative",children:[n.jsxs("div",{className:"flex items-center justify-between gap-2",children:[n.jsx("span",{children:"Our Side"}),n.jsx("button",{onClick:()=>u(d==="our_side"?null:"our_side"),className:`p-0.5 rounded hover:bg-gray-200 ${nt("our_side")?"text-blue-600":""}`,children:n.jsx(Cs,{className:"w-4 h-4"})})]}),d==="our_side"&&n.jsxs("div",{ref:ye,className:"absolute top-full left-0 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg z-50 w-56",children:[n.jsxs("div",{className:"p-2 border-b border-gray-200 flex items-center justify-between",children:[n.jsx("span",{className:"text-xs font-medium",children:"Filter Our Side"}),nt("our_side")&&n.jsx("button",{onClick:()=>ze("our_side"),className:"text-xs text-blue-600 hover:text-blue-700",children:"Clear"})]}),n.jsxs("div",{className:"p-2 space-y-1",children:[n.jsxs("button",{onClick:()=>{const ie=e.filter(Ae=>(Ae.price_required??!0)&&!Ae.price_sent_at);h(ie),u(null)},className:"w-full flex items-center gap-2 p-2 hover:bg-red-50 rounded text-left text-sm",children:[n.jsx("span",{className:"w-5 h-5 rounded bg-red-100 text-red-700 flex items-center justify-center font-bold text-xs",children:"P"}),n.jsx("span",{children:"Price Pending"})]}),n.jsxs("button",{onClick:()=>{const ie=e.filter(Ae=>(Ae.coa_required??!0)&&!Ae.coa_sent_at);h(ie),u(null)},className:"w-full flex items-center gap-2 p-2 hover:bg-red-50 rounded text-left text-sm",children:[n.jsx("span",{className:"w-5 h-5 rounded bg-red-100 text-red-700 flex items-center justify-center font-bold text-xs",children:"C"}),n.jsx("span",{children:"COA Pending"})]}),n.jsxs("button",{onClick:()=>{const ie=e.filter(Ae=>(Ae.price_required??!0)&&Ae.price_sent_at);h(ie),u(null)},className:"w-full flex items-center gap-2 p-2 hover:bg-green-50 rounded text-left text-sm",children:[n.jsx("span",{className:"w-5 h-5 rounded bg-green-100 text-green-700 flex items-center justify-center font-bold text-xs",children:"P"}),n.jsx("span",{children:"Price Sent"})]}),n.jsxs("button",{onClick:()=>{const ie=e.filter(Ae=>(Ae.coa_required??!0)&&Ae.coa_sent_at);h(ie),u(null)},className:"w-full flex items-center gap-2 p-2 hover:bg-green-50 rounded text-left text-sm",children:[n.jsx("span",{className:"w-5 h-5 rounded bg-green-100 text-green-700 flex items-center justify-center font-bold text-xs",children:"C"}),n.jsx("span",{children:"COA Sent"})]})]})]})]}),(s==null?void 0:s.role)==="admin"&&n.jsxs("th",{style:{width:Le.purchase_price,minWidth:Le.purchase_price},className:"relative px-3 py-2 text-left font-semibold text-gray-700 border-r border-gray-300",children:[n.jsx("span",{children:"P.Price"}),n.jsx("div",{className:"absolute top-0 right-0 w-1 h-full cursor-col-resize hover:bg-blue-400",onMouseDown:ie=>Ye("purchase_price",ie)})]}),n.jsxs("th",{style:{width:Le.offered_price,minWidth:Le.offered_price},className:"relative px-3 py-2 text-left font-semibold text-gray-700 border-r border-gray-300",children:[n.jsx("span",{children:"O.Price"}),n.jsx("div",{className:"absolute top-0 right-0 w-1 h-full cursor-col-resize hover:bg-blue-400",onMouseDown:ie=>Ye("offered_price",ie)})]}),n.jsxs("th",{style:{width:Le.delivery_date,minWidth:Le.delivery_date},className:"relative px-3 py-2 text-left font-semibold text-gray-700 border-r border-gray-300",children:[n.jsx("span",{children:"Delivery"}),n.jsx("div",{className:"absolute top-0 right-0 w-1 h-full cursor-col-resize hover:bg-blue-400",onMouseDown:ie=>Ye("delivery_date",ie)})]}),n.jsxs("th",{className:"px-3 py-2 text-left font-semibold text-gray-700 border-r border-gray-300 relative",children:[n.jsxs("div",{className:"flex items-center justify-between gap-2",children:[n.jsx("span",{children:"Priority"}),n.jsx("button",{onClick:()=>u(d==="priority"?null:"priority"),className:`p-0.5 rounded hover:bg-gray-200 ${nt("priority")?"text-blue-600":""}`,children:n.jsx(Cs,{className:"w-4 h-4"})})]}),d==="priority"&&n.jsxs("div",{ref:ye,className:"absolute top-full left-0 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg z-50 w-48",children:[n.jsxs("div",{className:"p-2 border-b border-gray-200 flex items-center justify-between",children:[n.jsx("span",{className:"text-xs font-medium",children:"Filter Priority"}),nt("priority")&&n.jsx("button",{onClick:()=>ze("priority"),className:"text-xs text-blue-600 hover:text-blue-700",children:"Clear"})]}),n.jsx("div",{className:"p-2",children:et.map(ie=>{var le;const Ae=(le=l.find(ve=>ve.column==="priority"))==null?void 0:le.values.includes(ie.value);return n.jsxs("label",{className:"flex items-center gap-2 p-1.5 hover:bg-gray-50 rounded cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:Ae,onChange:()=>Ee("priority",ie.value),className:"rounded border-gray-300"}),ie.icon,n.jsx("span",{className:"text-sm",children:ie.label})]},ie.value)})})]})]}),n.jsx(Be,{column:"remarks",label:"Remarks"})]})}),n.jsx("tbody",{children:f.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:18,className:"px-3 py-8 text-center text-gray-500",children:"No inquiries found"})}):f.map(ie=>{var Ae;return n.jsxs(A8.Fragment,{children:[n.jsxs("tr",{className:`border-b border-gray-200 hover:bg-blue-50 transition ${i.has(ie.id)?"bg-blue-100":""}`,children:[n.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:n.jsx("input",{type:"checkbox",checked:i.has(ie.id),onChange:()=>mt(ie.id),className:"rounded border-gray-300"})}),n.jsx("td",{className:"px-3 py-2 border-r border-gray-200 font-medium text-blue-600",children:n.jsxs("div",{className:"flex items-center gap-1",children:[ie.has_items&&n.jsx("button",{onClick:()=>Nt(ie.id),className:"hover:bg-blue-100 rounded p-0.5 transition",title:te.has(ie.id)?"Collapse products":"Expand products",children:te.has(ie.id)?n.jsx(Cs,{className:"w-4 h-4"}):n.jsx(Rc,{className:"w-4 h-4"})}),ie.is_multi_product&&n.jsx(CE,{className:"w-3.5 h-3.5 text-blue-500",title:"Multi-product inquiry"}),n.jsx("span",{children:ie.inquiry_number})]})}),n.jsx("td",{className:"px-3 py-2 border-r border-gray-200 text-gray-600 whitespace-nowrap",children:new Date(ie.inquiry_date).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})}),n.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:(p==null?void 0:p.id)===ie.id&&(p==null?void 0:p.field)==="product_name"?n.jsx("input",{type:"text",value:m,onChange:le=>g(le.target.value),onBlur:Et,onKeyDown:le=>{le.key==="Enter"&&Et(),le.key==="Escape"&&b(null)},className:"w-full px-2 py-1 border-2 border-blue-500 rounded focus:outline-none",autoFocus:!0}):n.jsx("div",{onDoubleClick:()=>yt(ie,"product_name"),className:"cursor-text hover:bg-yellow-50 px-2 py-1 rounded",children:ie.product_name})}),n.jsx("td",{className:"px-3 py-2 border-r border-gray-200 text-gray-600 text-xs",children:(p==null?void 0:p.id)===ie.id&&(p==null?void 0:p.field)==="specification"?n.jsx("input",{type:"text",value:m,onChange:le=>g(le.target.value),onBlur:Et,onKeyDown:le=>{le.key==="Enter"&&Et(),le.key==="Escape"&&b(null)},className:"w-full px-2 py-1 border-2 border-blue-500 rounded focus:outline-none text-xs",autoFocus:!0}):n.jsx("div",{onDoubleClick:()=>yt(ie,"specification"),className:"cursor-text hover:bg-yellow-50 px-2 py-1 rounded",children:ie.specification||"-"})}),n.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:(p==null?void 0:p.id)===ie.id&&(p==null?void 0:p.field)==="quantity"?n.jsx("input",{type:"text",value:m,onChange:le=>g(le.target.value),onBlur:Et,onKeyDown:le=>{le.key==="Enter"&&Et(),le.key==="Escape"&&b(null)},className:"w-full px-2 py-1 border-2 border-blue-500 rounded focus:outline-none",autoFocus:!0}):n.jsx("div",{onDoubleClick:()=>yt(ie,"quantity"),className:"cursor-text hover:bg-yellow-50 px-2 py-1 rounded",children:ie.quantity})}),n.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:(p==null?void 0:p.id)===ie.id&&(p==null?void 0:p.field)==="supplier_name"?n.jsx("input",{type:"text",value:m,onChange:le=>g(le.target.value),onBlur:Et,onKeyDown:le=>{le.key==="Enter"&&Et(),le.key==="Escape"&&b(null)},className:"w-full px-2 py-1 border-2 border-blue-500 rounded focus:outline-none",autoFocus:!0}):n.jsxs("div",{onDoubleClick:()=>yt(ie,"supplier_name"),className:"cursor-text hover:bg-yellow-50 px-2 py-1 rounded",children:[n.jsx("div",{children:ie.supplier_name||"-"}),ie.supplier_country&&n.jsx("div",{className:"text-xs text-gray-500",children:ie.supplier_country})]})}),n.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:n.jsx("div",{className:"font-medium",children:ie.company_name})}),n.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:(p==null?void 0:p.id)===ie.id&&(p==null?void 0:p.field)==="mail_subject"?n.jsx("input",{type:"text",value:m,onChange:le=>g(le.target.value),onBlur:Et,onKeyDown:le=>{le.key==="Enter"&&Et(),le.key==="Escape"&&b(null)},className:"w-full px-2 py-1 border-2 border-blue-500 rounded focus:outline-none text-xs",autoFocus:!0}):n.jsx("div",{onDoubleClick:()=>yt(ie,"mail_subject"),className:"cursor-text hover:bg-yellow-50 px-2 py-1 rounded text-xs",title:ie.mail_subject||"",children:ie.mail_subject?n.jsx("div",{className:"line-clamp-2",children:ie.mail_subject}):n.jsx("span",{className:"text-gray-400",children:"-"})})}),n.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:(p==null?void 0:p.id)===ie.id&&(p==null?void 0:p.field)==="aceerp_no"?n.jsx("input",{type:"text",value:m,onChange:le=>g(le.target.value),onBlur:Et,onKeyDown:le=>{le.key==="Enter"&&Et(),le.key==="Escape"&&b(null)},className:"w-full px-2 py-1 border-2 border-blue-500 rounded focus:outline-none",autoFocus:!0}):n.jsx("div",{onDoubleClick:()=>r&&yt(ie,"aceerp_no"),className:r?"cursor-text hover:bg-yellow-50 px-2 py-1 rounded":"px-2 py-1",children:ie.aceerp_no||(r?n.jsx("span",{className:"text-gray-400 text-xs",children:"Click to add"}):"-")})}),n.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:n.jsx("select",{value:ie.pipeline_status||"new",onChange:le=>ir(ie,le.target.value),disabled:!r,className:"w-full px-2 py-1 border border-gray-300 rounded text-xs focus:border-blue-500 focus:outline-none cursor-pointer bg-white",children:Qm.map(le=>n.jsx("option",{value:le.value,children:le.label},le.value))})}),n.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:n.jsx("div",{className:"flex items-center justify-center",children:n.jsx(mue,{inquiry:ie,onMarkSent:r?le=>Oe(ie,le):void 0})})}),(s==null?void 0:s.role)==="admin"&&n.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:(p==null?void 0:p.id)===ie.id&&(p==null?void 0:p.field)==="purchase_price"?n.jsx("input",{type:"text",value:m,onChange:le=>g(le.target.value),onBlur:Et,onKeyDown:le=>{le.key==="Enter"&&Et(),le.key==="Escape"&&b(null)},className:"w-full px-2 py-1 border-2 border-blue-500 rounded focus:outline-none text-xs",autoFocus:!0,placeholder:"Click to add"}):n.jsx("div",{onDoubleClick:()=>yt(ie,"purchase_price"),className:"cursor-text hover:bg-yellow-50 px-2 py-1 rounded text-xs",children:ie.purchase_price?`$${ie.purchase_price.toLocaleString("en-US",{minimumFractionDigits:2})}`:n.jsx("span",{className:"text-gray-400",children:"Click to add"})})}),n.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:(p==null?void 0:p.id)===ie.id&&(p==null?void 0:p.field)==="offered_price"?n.jsx("input",{type:"text",value:m,onChange:le=>g(le.target.value),onBlur:Et,onKeyDown:le=>{le.key==="Enter"&&Et(),le.key==="Escape"&&b(null)},className:"w-full px-2 py-1 border-2 border-blue-500 rounded focus:outline-none text-xs",autoFocus:!0,placeholder:"Click to add"}):n.jsx("div",{onDoubleClick:()=>r&&yt(ie,"offered_price"),className:r?"cursor-text hover:bg-yellow-50 px-2 py-1 rounded text-xs":"px-2 py-1 text-xs",children:ie.offered_price?`$${ie.offered_price.toLocaleString("en-US",{minimumFractionDigits:2})}`:r?n.jsx("span",{className:"text-gray-400",children:"Click to add"}):"-"})}),n.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:(p==null?void 0:p.id)===ie.id&&(p==null?void 0:p.field)==="delivery_date"?n.jsx("input",{type:"date",value:m,onChange:le=>g(le.target.value),onBlur:Et,onKeyDown:le=>{le.key==="Enter"&&Et(),le.key==="Escape"&&b(null)},className:"w-full px-2 py-1 border-2 border-blue-500 rounded focus:outline-none text-xs",autoFocus:!0}):n.jsx("div",{onDoubleClick:()=>r&&yt(ie,"delivery_date"),className:r?"cursor-text hover:bg-yellow-50 px-2 py-1 rounded text-xs whitespace-nowrap":"px-2 py-1 text-xs whitespace-nowrap",children:ie.delivery_date?new Date(ie.delivery_date).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"}):r?n.jsx("span",{className:"text-gray-400",children:"Click to add"}):"-"})}),n.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:n.jsx("select",{value:ie.priority,onChange:le=>It(ie,le.target.value),disabled:!r,className:"w-full px-2 py-1 border border-gray-300 rounded text-xs focus:border-blue-500 focus:outline-none cursor-pointer",children:et.map(le=>n.jsx("option",{value:le.value,children:le.label},le.value))})}),n.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:(p==null?void 0:p.id)===ie.id&&(p==null?void 0:p.field)==="remarks"?n.jsx("input",{type:"text",value:m,onChange:le=>g(le.target.value),onBlur:Et,onKeyDown:le=>{le.key==="Enter"&&Et(),le.key==="Escape"&&b(null)},className:"w-full px-2 py-1 border-2 border-blue-500 rounded focus:outline-none",autoFocus:!0}):n.jsx("div",{onDoubleClick:()=>yt(ie,"remarks"),className:"cursor-text hover:bg-yellow-50 px-2 py-1 rounded text-gray-600",children:ie.remarks||"-"})})]}),ie.has_items&&te.has(ie.id)&&((Ae=_e.get(ie.id))==null?void 0:Ae.map(le=>n.jsxs("tr",{className:"bg-blue-50 border-b border-blue-100",children:[n.jsx("td",{className:"px-3 py-2 border-r border-gray-200"}),n.jsx("td",{className:"px-3 py-2 border-r border-gray-200 text-sm text-blue-700 pl-8",children:le.inquiry_number}),n.jsx("td",{className:"px-3 py-2 border-r border-gray-200 text-xs text-gray-500",children:"-"}),n.jsx("td",{className:"px-3 py-2 border-r border-gray-200 text-sm",children:le.product_name}),n.jsx("td",{className:"px-3 py-2 border-r border-gray-200 text-xs text-gray-600",children:le.specification||"-"}),n.jsx("td",{className:"px-3 py-2 border-r border-gray-200 text-sm",children:le.quantity}),n.jsx("td",{className:"px-3 py-2 border-r border-gray-200 text-xs text-gray-500",children:"-"}),n.jsx("td",{className:"px-3 py-2 border-r border-gray-200 text-xs text-gray-500",children:"-"}),n.jsx("td",{className:"px-3 py-2 border-r border-gray-200 text-xs text-gray-500",children:"-"}),n.jsx("td",{className:"px-3 py-2 border-r border-gray-200 text-xs text-gray-500",children:"-"}),n.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:n.jsx(lD,{status:le.pipeline_stage})}),n.jsx("td",{className:"px-3 py-2 border-r border-gray-200 text-center",children:le.document_sent?n.jsxs("div",{className:"flex items-center justify-center gap-1",children:[n.jsx(Jb,{className:"w-4 h-4 text-green-600"}),n.jsx("span",{className:"text-xs text-gray-500",children:le.document_sent_at?new Date(le.document_sent_at).toLocaleDateString("en-GB",{day:"2-digit",month:"short"}):""})]}):n.jsx(gn,{className:"w-4 h-4 text-gray-400 mx-auto"})}),n.jsx("td",{className:"px-3 py-2 border-r border-gray-200 text-xs text-gray-600",children:le.notes||"-"}),n.jsx("td",{className:"px-3 py-2 border-r border-gray-200"}),n.jsx("td",{className:"px-3 py-2 border-r border-gray-200"}),n.jsx("td",{className:"px-3 py-2 border-r border-gray-200"}),n.jsx("td",{className:"px-3 py-2 border-r border-gray-200"}),n.jsx("td",{className:"px-3 py-2 border-r border-gray-200"})]},le.id)))]},ie.id)})})]})})}),y&&_&&n.jsx(pue,{isOpen:y,onClose:()=>{v(!1),j(null),t()},inquiry:_}),n.jsx(Ot,{isOpen:N,onClose:()=>{B(!1),C("")},title:"Log Phone Call",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Call Notes *"}),n.jsx("textarea",{value:E,onChange:ie=>C(ie.target.value),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"What was discussed during the call?",required:!0})]}),n.jsxs("div",{className:"flex justify-end gap-3",children:[n.jsx("button",{onClick:()=>{B(!1),C("")},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),n.jsx("button",{onClick:Ft,disabled:!E.trim(),className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50",children:"Save Call Log"})]})]})}),n.jsx(Ot,{isOpen:k,onClose:()=>{w(!1),R(""),z("")},title:"Schedule Follow-up",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Follow-up Date *"}),n.jsx("input",{type:"date",value:T,onChange:ie=>R(ie.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),n.jsx("textarea",{value:q,onChange:ie=>z(ie.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"What needs to be followed up?"})]}),n.jsxs("div",{className:"flex justify-end gap-3",children:[n.jsx("button",{onClick:()=>{w(!1),R(""),z("")},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),n.jsx("button",{onClick:xr,disabled:!T,className:"px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 disabled:opacity-50",children:"Schedule Follow-up"})]})]})}),ee&&ue&&n.jsx(oD,{isOpen:ee,onClose:()=>Y(!1),onSuccess:()=>{Y(!1),t()},initialData:{inquiry_id:ue.id}}),D&&n.jsx(xue,{isOpen:U,onClose:()=>{S(!1),L(null)},inquiryId:D.id,inquiryNumber:D.inquiry_number,onSuccess:()=>{t(),L(null)}}),n.jsx(Ot,{isOpen:P,onClose:()=>{I(!1),V(null),M("")},title:"Enter Offered Price",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Inquiry: ",(H==null?void 0:H.inquiry_number)||"-"]}),n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Product: ",(H==null?void 0:H.product_name)||"-"]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Offered Price (O.Price) *"}),n.jsx("input",{type:"number",value:W,onChange:ie=>M(ie.target.value),placeholder:"Enter offered price",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",step:"0.01",min:"0"}),n.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Enter the price you offered to the customer"})]}),n.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[n.jsx("button",{onClick:()=>{I(!1),V(null),M("")},className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Cancel"}),n.jsx("button",{onClick:tt,className:"px-4 py-2 text-white bg-blue-600 rounded-lg hover:bg-blue-700",children:"Save & Mark Price as Sent"})]})]})}),n.jsx(Ot,{isOpen:se,onClose:()=>K(!1),title:"Edit Customer Requirements",children:n.jsxs("div",{className:"space-y-4",children:[n.jsx("p",{className:"text-sm text-gray-600",children:"Check what the customer has requested:"}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:he.price_required,onChange:ie=>ne({...he,price_required:ie.target.checked}),className:"w-5 h-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),n.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Price"})]}),n.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:he.coa_required,onChange:ie=>ne({...he,coa_required:ie.target.checked}),className:"w-5 h-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),n.jsx("span",{className:"text-sm font-medium text-gray-700",children:"COA"})]}),n.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:he.sample_required,onChange:ie=>ne({...he,sample_required:ie.target.checked}),className:"w-5 h-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),n.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Sample"})]}),n.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:he.agency_letter_required,onChange:ie=>ne({...he,agency_letter_required:ie.target.checked}),className:"w-5 h-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),n.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Agency Letter"})]}),n.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:he.others_required,onChange:ie=>ne({...he,others_required:ie.target.checked}),className:"w-5 h-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),n.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Others"})]})]}),n.jsxs("div",{className:"flex justify-end gap-2 mt-6 pt-4 border-t",children:[n.jsx("button",{onClick:()=>K(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition",children:"Cancel"}),n.jsx("button",{onClick:Wt,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 transition",children:"Save Requirements"})]})]})})]})}function vue({onReminderCreated:e}){const[t,r]=Q.useState([]),[a,s]=Q.useState([]),[i,o]=Q.useState(new Date),[l,c]=Q.useState(null),[d,u]=Q.useState("month"),[f,h]=Q.useState(!0),[A,x]=Q.useState(!1),[p,b]=Q.useState(null),[m,g]=Q.useState(null),[y,v]=Q.useState([]);Q.useEffect(()=>{j(),N()},[i,d]),Q.useEffect(()=>{m!=null&&m.participants&&m.participants.length>0&&_(m.participants)},[m]);const _=async S=>{try{const{data:D,error:L}=await Z.from("user_profiles").select("id, full_name").in("id",S);if(L)throw L;v(D||[])}catch(D){console.error("Error loading participants:",D)}},j=async()=>{try{let S=Z.from("crm_reminders").select(`
          *,
          crm_inquiries (
            inquiry_number,
            company_name,
            product_name
          )
        `);if(d==="month"){const P=new Date(i.getFullYear(),i.getMonth(),1),I=new Date(i.getFullYear(),i.getMonth()+1,0);S=S.gte("due_date",P.toISOString()).lte("due_date",I.toISOString())}const{data:D,error:L}=await S.order("due_date",{ascending:!0});if(L)throw L;r(D||[])}catch(S){console.error("Error loading reminders:",S)}finally{h(!1)}},N=async()=>{try{const{data:{user:S}}=await Z.auth.getUser();if(!S)return;let D=Z.from("crm_activities").select("*, user_profiles!crm_activities_created_by_fkey(full_name), crm_contacts!crm_activities_customer_id_fkey(company_name)").in("activity_type",["meeting","video_call","phone_call"]).not("follow_up_date","is",null).or(`created_by.eq.${S.id},participants.cs.{${S.id}}`).order("follow_up_date",{ascending:!0});if(d==="month"){const I=new Date(i.getFullYear(),i.getMonth(),1),H=new Date(i.getFullYear(),i.getMonth()+1,0);D=D.gte("follow_up_date",I.toISOString()).lte("follow_up_date",H.toISOString())}const{data:L,error:P}=await D;if(P)throw P;s(L||[])}catch(S){console.error("Error loading appointments:",S)}},B=async S=>{try{const{error:D}=await Z.from("crm_reminders").update({is_completed:!S.is_completed,completed_at:S.is_completed?null:new Date().toISOString()}).eq("id",S.id);if(D)throw D;j()}catch(D){console.error("Error updating reminder:",D)}},E=async(S,D)=>{try{const L=new Date(S.due_date);L.setDate(L.getDate()+D);const{error:P}=await Z.from("crm_reminders").update({due_date:L.toISOString()}).eq("id",S.id);if(P)throw P;j(),x(!1)}catch(L){console.error("Error snoozing reminder:",L)}},C=S=>new Date(S.getFullYear(),S.getMonth()+1,0).getDate(),k=S=>new Date(S.getFullYear(),S.getMonth(),1).getDay(),w=S=>t.filter(D=>{const L=new Date(D.due_date);return L.getDate()===S.getDate()&&L.getMonth()===S.getMonth()&&L.getFullYear()===S.getFullYear()}),T=S=>a.filter(D=>{const L=new Date(D.follow_up_date);return L.getDate()===S.getDate()&&L.getMonth()===S.getMonth()&&L.getFullYear()===S.getFullYear()}),R=()=>{const S=new Date;return S.setHours(0,0,0,0),t.filter(D=>{const L=new Date(D.due_date);return L.setHours(0,0,0,0),L.getTime()===S.getTime()&&!D.is_completed})},q=()=>{const S=new Date;return S.setHours(0,0,0,0),t.filter(D=>{const L=new Date(D.due_date);return L.setHours(0,0,0,0),L<S&&!D.is_completed})},z=()=>{const S=new Date;S.setHours(0,0,0,0);const D=new Date(S);return D.setDate(D.getDate()+7),t.filter(L=>{const P=new Date(L.due_date);return P.setHours(0,0,0,0),P>S&&P<=D&&!L.is_completed})},ee=()=>{o(new Date(i.getFullYear(),i.getMonth()-1))},Y=()=>{o(new Date(i.getFullYear(),i.getMonth()+1))},G={follow_up:"bg-blue-100 text-blue-800 border-blue-200",send_coa:"bg-orange-100 text-orange-800 border-orange-200",send_sample:"bg-green-100 text-green-800 border-green-200",send_price:"bg-purple-100 text-purple-800 border-purple-200",custom:"bg-gray-100 text-gray-800 border-gray-200"},re=()=>{const S=C(i),D=k(i),L=[];for(let P=0;P<D;P++)L.push(n.jsx("div",{className:"min-h-24 p-2 bg-gray-50"},`empty-${P}`));for(let P=1;P<=S;P++){const I=new Date(i.getFullYear(),i.getMonth(),P),H=w(I),V=T(I),W=I.toDateString()===new Date().toDateString();[...H,...V],L.push(n.jsxs("div",{className:`min-h-24 p-2 border border-gray-200 ${W?"bg-blue-50":"bg-white"} hover:bg-gray-50 transition cursor-pointer`,onClick:()=>{c(I),H.length>0?(b(H[0]),x(!0)):V.length>0&&(g(V[0]),x(!0))},children:[n.jsx("div",{className:`text-sm font-medium mb-1 ${W?"text-blue-600":"text-gray-900"}`,children:P}),n.jsxs("div",{className:"space-y-1",children:[V.map(M=>{var he;const se=new Date(M.follow_up_date).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1}),K=((he=M.crm_contacts)==null?void 0:he.company_name)||"No Customer";return n.jsxs("div",{className:`text-xs p-1 rounded border bg-purple-100 text-purple-800 border-purple-200 truncate ${M.is_completed?"opacity-50 line-through":""}`,title:`${se} - ${K}`,children:[" ",se," - ",K]},M.id)}),H.map(M=>n.jsx("div",{className:`text-xs p-1 rounded border ${G[M.reminder_type]} truncate ${M.is_completed?"opacity-50 line-through":""}`,title:M.title,children:M.title},M.id))]})]},P))}return L},U=()=>{const S=q(),D=R(),L=z();return n.jsxs("div",{className:"space-y-6",children:[S.length>0&&n.jsxs("div",{children:[n.jsxs("h3",{className:"text-sm font-semibold text-red-600 mb-2 flex items-center gap-2",children:[n.jsx(En,{className:"w-4 h-4"}),"Overdue (",S.length,")"]}),n.jsx("div",{className:"space-y-2",children:S.map(P=>n.jsx(Q1,{reminder:P,onToggleComplete:B,onViewDetails:()=>{b(P),x(!0)}},P.id))})]}),D.length>0&&n.jsxs("div",{children:[n.jsxs("h3",{className:"text-sm font-semibold text-blue-600 mb-2 flex items-center gap-2",children:[n.jsx(da,{className:"w-4 h-4"}),"Today (",D.length,")"]}),n.jsx("div",{className:"space-y-2",children:D.map(P=>n.jsx(Q1,{reminder:P,onToggleComplete:B,onViewDetails:()=>{b(P),x(!0)}},P.id))})]}),L.length>0&&n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Upcoming (Next 7 days)"}),n.jsx("div",{className:"space-y-2",children:L.map(P=>n.jsx(Q1,{reminder:P,onToggleComplete:B,onViewDetails:()=>{b(P),x(!0)}},P.id))})]}),S.length===0&&D.length===0&&L.length===0&&n.jsxs("div",{className:"text-center py-12 text-gray-500",children:[n.jsx(da,{className:"w-12 h-12 mx-auto text-gray-300 mb-3"}),t.length===0?n.jsx("p",{children:"No reminders found. Create one using the quick actions!"}):n.jsxs("div",{children:[n.jsx("p",{className:"font-medium",children:"No upcoming reminders in the next 7 days"}),n.jsxs("p",{className:"text-sm mt-1",children:["You have ",t.length," reminder",t.length===1?"":"s"," total (all past or completed)"]})]})]})]})};return n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[n.jsx(ja,{className:"w-5 h-5 text-blue-600"}),"Reminders & Tasks"]}),n.jsxs("div",{className:"flex gap-1 bg-gray-100 rounded-lg p-1",children:[n.jsx("button",{onClick:()=>u("month"),className:`px-3 py-1 rounded text-sm ${d==="month"?"bg-white shadow":"text-gray-600"}`,children:"Month"}),n.jsx("button",{onClick:()=>u("list"),className:`px-3 py-1 rounded text-sm ${d==="list"?"bg-white shadow":"text-gray-600"}`,children:"List"})]})]}),d==="month"&&n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:ee,className:"p-2 hover:bg-gray-100 rounded-lg transition",children:n.jsx(h7,{className:"w-5 h-5"})}),n.jsx("span",{className:"font-semibold min-w-40 text-center",children:i.toLocaleDateString("en-US",{month:"long",year:"numeric"})}),n.jsx("button",{onClick:Y,className:"p-2 hover:bg-gray-100 rounded-lg transition",children:n.jsx(Rc,{className:"w-5 h-5"})})]})]}),f?n.jsx("div",{className:"flex justify-center items-center py-12",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):d==="month"?n.jsxs("div",{className:"space-y-2",children:[t.length===0&&n.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 text-sm text-yellow-800",children:[n.jsxs("p",{className:"font-medium",children:["No reminders for ",i.toLocaleDateString("en-US",{month:"long",year:"numeric"})]}),n.jsx("p",{className:"text-xs mt-1",children:'Use the arrows above to navigate to other months, or switch to "List" view to see all reminders.'})]}),t.length>0&&n.jsxs("div",{className:"text-sm text-gray-600 px-2",children:[t.length," reminder",t.length===1?"":"s"," in ",i.toLocaleDateString("en-US",{month:"long"})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[n.jsx("div",{className:"grid grid-cols-7 border-b border-gray-200",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(S=>n.jsx("div",{className:"p-2 text-center text-sm font-semibold text-gray-700 bg-gray-50",children:S},S))}),n.jsx("div",{className:"grid grid-cols-7",children:re()})]})]}):n.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:U()}),n.jsxs(Ot,{isOpen:A,onClose:()=>{x(!1),b(null),g(null)},title:p?"Reminder Details":"Appointment Details",children:[p&&n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:`p-3 rounded-lg border ${G[p.reminder_type]}`,children:[n.jsx("p",{className:"font-semibold",children:p.title}),n.jsxs("p",{className:"text-sm mt-1",children:["Due: ",new Date(p.due_date).toLocaleDateString()]})]}),p.description&&n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Description"}),n.jsx("p",{className:"text-sm text-gray-600 mt-1",children:p.description})]}),p.crm_inquiries&&n.jsxs("div",{className:"border-t pt-4",children:[n.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Related Inquiry"}),n.jsxs("div",{className:"mt-2 bg-gray-50 p-3 rounded-lg",children:[n.jsxs("p",{className:"text-sm font-medium",children:["#",p.crm_inquiries.inquiry_number]}),n.jsx("p",{className:"text-sm text-gray-600",children:p.crm_inquiries.company_name}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:p.crm_inquiries.product_name})]})]}),n.jsxs("div",{className:"flex justify-between items-center pt-4 border-t",children:[n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{onClick:()=>E(p,1),className:"text-sm px-3 py-1.5 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Snooze 1 day"}),n.jsx("button",{onClick:()=>E(p,3),className:"text-sm px-3 py-1.5 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Snooze 3 days"})]}),n.jsxs("button",{onClick:()=>{B(p),x(!1)},className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition",children:[n.jsx(Zr,{className:"w-4 h-4"}),p.is_completed?"Mark Incomplete":"Mark Complete"]})]})]}),m&&n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"border-l-4 border-blue-500 bg-blue-50 p-4 rounded",children:[n.jsx("h3",{className:"text-base font-semibold text-gray-900",children:m.subject}),m.crm_contacts&&n.jsx("p",{className:"text-sm font-medium text-blue-600 mt-1",children:m.crm_contacts.company_name}),n.jsx("p",{className:"text-sm text-gray-600 mt-1 capitalize",children:m.activity_type.replace("_"," ")}),n.jsxs("p",{className:"text-sm font-medium mt-1 flex items-center gap-1",children:[n.jsx(da,{className:"w-4 h-4"}),new Date(m.follow_up_date).toLocaleString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"})]})]}),m.description&&n.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:m.description}),m.participants&&m.participants.length>0&&n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(vo,{className:"w-4 h-4 text-gray-500"}),n.jsx("div",{className:"flex flex-wrap gap-1",children:y.map(S=>n.jsx("span",{className:"text-xs bg-blue-100 text-blue-700 px-2 py-0.5 rounded",children:S.full_name},S.id))})]}),n.jsx("div",{className:"flex justify-end pt-4 border-t",children:n.jsx("button",{onClick:()=>x(!1),className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition",children:"Close"})})]})]})]})}function Q1({reminder:e,onToggleComplete:t,onViewDetails:r}){const a={follow_up:"border-blue-200",send_coa:"border-orange-200",send_sample:"border-green-200",send_price:"border-purple-200",custom:"border-gray-200"},s=new Date(e.due_date)<new Date&&!e.is_completed;return n.jsx("div",{className:`p-3 border-l-4 ${a[e.reminder_type]} bg-white rounded-lg shadow-sm hover:shadow-md transition ${e.is_completed?"opacity-60":""}`,children:n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("div",{className:"flex-1 cursor-pointer",onClick:r,children:[n.jsx("p",{className:`font-medium ${e.is_completed?"line-through":""}`,children:e.title}),e.crm_inquiries&&n.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["#",e.crm_inquiries.inquiry_number," - ",e.crm_inquiries.company_name]}),n.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[n.jsx("span",{className:`text-xs ${s?"text-red-600 font-medium":"text-gray-500"}`,children:new Date(e.due_date).toLocaleDateString()}),s&&n.jsx("span",{className:"text-xs bg-red-100 text-red-800 px-2 py-0.5 rounded-full",children:"Overdue"})]})]}),n.jsx("button",{onClick:()=>t(e),className:`p-1 rounded ${e.is_completed?"text-green-600":"text-gray-400 hover:text-green-600"}`,children:n.jsx(Zr,{className:"w-5 h-5"})})]})})}function bue({canManage:e,onInquiryClick:t}){const[r,a]=Q.useState([]),[s,i]=Q.useState([]),[o,l]=Q.useState(!0),[c,d]=Q.useState(null),[u,f]=Q.useState(null);Q.useEffect(()=>{h(),A()},[]);const h=async()=>{try{d(null);const{data:_,error:j}=await Z.from("crm_pipeline_stages").select("*").eq("is_active",!0).order("stage_order",{ascending:!0});if(j)throw console.error("Database error loading stages:",j),new Error(j.message||"Failed to load pipeline stages");i(_||[])}catch(_){const j=_ instanceof Error?_.message:"Failed to load pipeline stages";console.error("Error loading stages:",_),d(j),i([])}},A=async()=>{try{d(null);const{data:_,error:j}=await Z.from("crm_inquiries").select("*").order("created_at",{ascending:!1});if(j)throw console.error("Database error loading inquiries:",j),new Error(j.message||"Failed to load inquiries");a(_||[])}catch(_){const j=_ instanceof Error?_.message:"Failed to load inquiries";console.error("Error loading inquiries:",_),d(j),a([])}finally{l(!1)}},x={"New Inquiry":"new","Price Quoted":"price_quoted","COA Pending":"coa_pending","Sample Sent":"sample_sent",Negotiation:"negotiation","PO Received":"po_received",Won:"won",Lost:"lost"},p=_=>{const j=x[_];return r.filter(N=>N.status===j)},b=_=>{e&&f(_)},m=_=>{_.preventDefault()},g=async _=>{if(!u||!e)return;const j=x[_];if(u.status===j){f(null);return}try{const{error:N}=await Z.from("crm_inquiries").update({status:j}).eq("id",u.id);if(N)throw N;A()}catch(N){console.error("Error updating inquiry status:",N),alert("Failed to update inquiry status")}finally{f(null)}},y=_=>{const j=new Date(_.created_at),B=Math.abs(new Date().getTime()-j.getTime());return Math.ceil(B/(1e3*60*60*24))},v={urgent:"border-l-4 border-red-500",high:"border-l-4 border-orange-500",medium:"border-l-4 border-yellow-500",low:"border-l-4 border-gray-400"};return o?n.jsx("div",{className:"flex justify-center items-center py-12",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):c?n.jsx("div",{className:"space-y-4",children:n.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"text-red-600 mt-0.5",children:n.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:n.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"text-sm font-medium text-red-900",children:"Error Loading Pipeline"}),n.jsx("p",{className:"text-sm text-red-700 mt-1",children:c}),n.jsx("button",{onClick:()=>{h(),A()},className:"mt-3 text-sm font-medium text-red-700 hover:text-red-800 underline",children:"Try Again"})]})]})})}):n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h3",{className:"text-lg font-semibold",children:"Pipeline View"}),n.jsxs("div",{className:"text-sm text-gray-600",children:["Total: ",r.length," inquiries"]})]}),n.jsx("div",{className:"flex gap-4 overflow-x-auto pb-4",children:s.map(_=>{const j=p(_.stage_name),N=j.reduce((B,E)=>B+(E.estimated_value||0),0);return n.jsxs("div",{className:"flex-shrink-0 w-80 bg-gray-50 rounded-lg",onDragOver:m,onDrop:()=>g(_.stage_name),children:[n.jsxs("div",{className:"p-4 rounded-t-lg",style:{backgroundColor:_.color+"20"},children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("h4",{className:"font-semibold text-gray-900",children:_.stage_name}),n.jsx("span",{className:"text-sm font-medium text-gray-600",children:j.length})]}),N>0&&n.jsxs("div",{className:"text-xs text-gray-600",children:["Value: Rp ",N.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),n.jsx("div",{className:"p-2 space-y-2 max-h-[600px] overflow-y-auto",children:j.length===0?n.jsx("div",{className:"text-center py-8 text-gray-400 text-sm",children:"No inquiries"}):j.map(B=>n.jsxs("div",{draggable:e,onDragStart:()=>b(B),onClick:()=>t&&t(B),className:`bg-white rounded-lg p-3 shadow-sm hover:shadow-md transition cursor-pointer ${v[B.priority]||""} ${e?"cursor-move":""}`,children:[n.jsxs("div",{className:"flex items-start justify-between mb-2",children:[n.jsxs("span",{className:"text-xs font-semibold text-blue-600",children:["#",B.inquiry_number]}),n.jsxs("span",{className:"text-xs text-gray-500",children:[y(B),"d"]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex items-start gap-2",children:[n.jsx(d7,{className:"w-4 h-4 text-gray-400 flex-shrink-0 mt-0.5"}),n.jsx("p",{className:"text-sm font-medium text-gray-900 line-clamp-2",children:B.company_name})]}),n.jsxs("div",{className:"flex items-start gap-2",children:[n.jsx(Rr,{className:"w-4 h-4 text-gray-400 flex-shrink-0 mt-0.5"}),n.jsx("p",{className:"text-xs text-gray-600 line-clamp-2",children:B.product_name})]}),n.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[n.jsx("span",{children:B.quantity}),n.jsx("span",{children:new Date(B.inquiry_date).toLocaleDateString("en-GB")})]}),B.priority==="urgent"&&n.jsxs("div",{className:"flex items-center gap-1 text-xs text-red-600",children:[n.jsx(En,{className:"w-3 h-3"}),n.jsx("span",{className:"font-medium",children:"URGENT"})]}),B.estimated_value&&B.estimated_value>0&&n.jsxs("div",{className:"flex items-center gap-1 text-xs text-green-600 font-medium",children:[n.jsx(hn,{className:"w-3 h-3"}),n.jsxs("span",{children:["Rp ",B.estimated_value.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})]},B.id))})]},_.id)})}),!e&&n.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 flex items-start gap-2",children:[n.jsx(En,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}),n.jsx("p",{className:"text-sm text-yellow-800",children:"You have view-only access to the pipeline. Contact admin to manage inquiries."})]})]})}function _ue({inquiry:e,onClose:t,onSent:r}){const[a,s]=Q.useState([]),[i,o]=Q.useState(null),[l,c]=Q.useState(""),[d,u]=Q.useState(""),[f,h]=Q.useState(""),[A,x]=Q.useState(!1),[p,b]=Q.useState(!1);Q.useEffect(()=>{m(),e&&c(e.contact_email||"")},[e]);const m=async()=>{try{const{data:v,error:_}=await Z.from("crm_email_templates").select("*").eq("is_active",!0).order("template_name");if(_)throw _;s(v||[])}catch(v){console.error("Error loading templates:",v)}},g=v=>{let _=v.subject,j=v.body;e&&(_=_.replace(/\{\{company_name\}\}/g,e.company_name).replace(/\{\{contact_person\}\}/g,e.contact_person||"").replace(/\{\{product\}\}/g,e.product_name).replace(/\{\{quantity\}\}/g,e.quantity).replace(/\{\{inquiry_number\}\}/g,e.inquiry_number),j=j.replace(/\{\{company_name\}\}/g,e.company_name).replace(/\{\{contact_person\}\}/g,e.contact_person||"Sir/Madam").replace(/\{\{product\}\}/g,e.product_name).replace(/\{\{quantity\}\}/g,e.quantity).replace(/\{\{inquiry_number\}\}/g,e.inquiry_number)),u(_),h(j),o(v),b(!1)},y=async()=>{if(!l||!d||!f){alert("Please fill in all required fields");return}x(!0);try{const{data:{user:v}}=await Z.auth.getUser();if(!v)throw new Error("Not authenticated");const _=l.split(";").map(B=>B.trim()).filter(B=>B.length>0),j={inquiry_id:(e==null?void 0:e.id)||null,contact_id:null,email_type:"sent",from_email:v.email,to_email:_,subject:d,body:f,template_id:(i==null?void 0:i.id)||null,sent_date:new Date().toISOString(),created_by:v.id},{error:N}=await Z.from("crm_email_activities").insert([j]);if(N)throw N;i&&await Z.from("crm_email_templates").update({use_count:i.use_count+1,last_used:new Date().toISOString()}).eq("id",i.id),alert("Email logged successfully! Note: Actual email sending requires SMTP configuration."),r&&r(),t&&t()}catch(v){console.error("Error sending email:",v),alert("Failed to send email. Please try again.")}finally{x(!1)}};return n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[n.jsx(ua,{className:"w-5 h-5 text-blue-600"}),"Compose Email"]}),n.jsxs("button",{onClick:()=>b(!0),className:"flex items-center gap-2 px-3 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 rounded-lg transition",children:[n.jsx(Zt,{className:"w-4 h-4"}),"Use Template"]})]}),e&&n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:[n.jsxs("p",{className:"text-sm font-medium text-blue-900",children:["Inquiry #",e.inquiry_number," - ",e.company_name]}),n.jsxs("p",{className:"text-xs text-blue-700 mt-1",children:[e.product_name," - ",e.quantity]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"To *"}),n.jsx("input",{type:"text",value:l,onChange:v=>c(v.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"recipient@example.com; recipient2@example.com",required:!0}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:l.includes(";")?`Sending to ${l.split(";").filter(v=>v.trim()).length} email addresses`:"Separate multiple emails with semicolon (;)"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject *"}),n.jsx("input",{type:"text",value:d,onChange:v=>u(v.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Email subject",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Message *"}),n.jsx("textarea",{value:f,onChange:v=>h(v.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:12,placeholder:"Type your message here...",required:!0})]}),n.jsxs("div",{className:"flex justify-between items-center pt-4 border-t",children:[n.jsx("div",{className:"flex gap-2",children:n.jsxs("button",{type:"button",className:"flex items-center gap-2 px-3 py-2 text-sm border border-gray-300 rounded-lg hover:bg-gray-50 transition",disabled:!0,children:[n.jsx(Wo,{className:"w-4 h-4"}),"Attach Files (Coming Soon)"]})}),n.jsxs("div",{className:"flex gap-2",children:[t&&n.jsx("button",{onClick:t,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),n.jsx("button",{onClick:y,disabled:A||!l||!d||!f,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed",children:A?n.jsxs(n.Fragment,{children:[n.jsx(Vo,{className:"w-4 h-4 animate-spin"}),"Sending..."]}):n.jsxs(n.Fragment,{children:[n.jsx($i,{className:"w-4 h-4"}),"Send Email"]})})]})]}),n.jsx(Ot,{isOpen:p,onClose:()=>b(!1),title:"Email Templates",children:n.jsx("div",{className:"space-y-2",children:a.length===0?n.jsxs("div",{className:"text-center py-8 text-gray-500",children:[n.jsx(Zt,{className:"w-12 h-12 mx-auto text-gray-300 mb-3"}),n.jsx("p",{children:"No templates available"}),n.jsx("p",{className:"text-sm mt-1",children:"Contact admin to create email templates"})]}):a.map(v=>n.jsxs("div",{onClick:()=>g(v),className:"p-4 border border-gray-200 rounded-lg hover:border-blue-500 hover:bg-blue-50 cursor-pointer transition",children:[n.jsx("div",{className:"flex items-start justify-between",children:n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-semibold text-gray-900",children:v.template_name}),n.jsx("p",{className:"text-sm text-gray-600 mt-1",children:v.subject}),v.category&&n.jsx("span",{className:"inline-block mt-2 px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded",children:v.category})]})}),v.variables&&v.variables.length>0&&n.jsx("div",{className:"mt-2 pt-2 border-t border-gray-100",children:n.jsxs("p",{className:"text-xs text-gray-500",children:["Variables: ",v.variables.join(", ")]})})]},v.id))})})]})}function wue({selectedCustomers:e,onClose:t,onComplete:r}){var T;const[a,s]=Q.useState([]),[i,o]=Q.useState(null),[l,c]=Q.useState(""),[d,u]=Q.useState(""),[f,h]=Q.useState(30),[A,x]=Q.useState(!1),[p,b]=Q.useState(!1),[m,g]=Q.useState([]),[y,v]=Q.useState(0);Q.useEffect(()=>{j(),_()},[]);const _=()=>{const R=e.map(q=>({customerId:q.id,companyName:q.company_name,email:q.email,status:"pending"}));g(R)},j=async()=>{try{const{data:R,error:q}=await Z.from("crm_email_templates").select("*").eq("is_active",!0).order("template_name");if(q)throw q;s(R||[])}catch(R){console.error("Error loading templates:",R)}},N=R=>{c(R.subject),u(R.body),o(R),b(!1)},B=(R,q)=>R.replace(/\{\{company_name\}\}/g,q.company_name).replace(/\{\{contact_person\}\}/g,q.contact_person||"Sir/Madam"),E=async()=>{if(!l||!d){alert("Please fill in subject and message");return}if(f<10){alert("Please set interval to at least 10 seconds to avoid blocking");return}x(!0),v(0);try{const{data:{user:R}}=await Z.auth.getUser();if(!R)throw new Error("Not authenticated");const{data:q}=await Z.from("gmail_connections").select("*").eq("user_id",R.id).eq("is_connected",!0).maybeSingle();if(!q){alert("Gmail not connected. Please connect Gmail in Settings first."),x(!1);return}for(let ee=0;ee<e.length;ee++){const Y=e[ee];v(ee),g(G=>G.map((re,U)=>U===ee?{...re,status:"sending"}:re));try{const G=Y.email.split(";").map(I=>I.trim()).filter(I=>I.length>0),re=B(l,Y),U=B(d,Y),L=await fetch("https://dkrtsqienlhpouohmfki.supabase.co/functions/v1/send-bulk-email",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRrcnRzcWllbmxocG91b2htZmtpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE5MTQxNzQsImV4cCI6MjA3NzQ5MDE3NH0.Kjo9RU0WAfQSSEm2vTWmuN5BIYk_hvanKDQkm5qdCGY"},body:JSON.stringify({userId:R.id,toEmails:G,subject:re,body:U,contactId:Y.id})});if(!L.ok)throw new Error("Failed to send email");const P=await L.json();if(P.success){const I={contact_id:Y.id,email_type:"sent",from_email:R.email,to_email:G,subject:re,body:U,template_id:(i==null?void 0:i.id)||null,sent_date:new Date().toISOString(),created_by:R.id};await Z.from("crm_email_activities").insert([I]),g(H=>H.map((V,W)=>W===ee?{...V,status:"success"}:V))}else throw new Error(P.error||"Unknown error");ee<e.length-1&&await new Promise(I=>setTimeout(I,f*1e3))}catch(G){console.error(`Error sending to ${Y.company_name}:`,G),g(re=>re.map((U,S)=>S===ee?{...U,status:"error",error:G.message}:U))}}i&&await Z.from("crm_email_templates").update({use_count:i.use_count+e.length,last_used:new Date().toISOString()}).eq("id",i.id);const z=m.filter(ee=>ee.status==="success").length;alert(`Bulk email completed!
${z} of ${e.length} emails sent successfully.`),r()}catch(R){console.error("Error in bulk email:",R),alert("Failed to complete bulk email. Please check the results.")}finally{x(!1)}},C=m.filter(R=>R.status==="success").length,k=m.filter(R=>R.status==="error").length,w=m.filter(R=>R.status==="pending").length;return n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[n.jsx(ua,{className:"w-5 h-5 text-blue-600"}),"Bulk Email to Customers"]}),n.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Sending to ",e.length," customers"]})]}),n.jsxs("button",{onClick:()=>b(!0),disabled:A,className:"flex items-center gap-2 px-3 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 rounded-lg transition disabled:opacity-50",children:[n.jsx(Zt,{className:"w-4 h-4"}),"Use Template"]})]}),n.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 flex items-start gap-2",children:[n.jsx(En,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}),n.jsxs("div",{className:"text-sm text-yellow-800",children:[n.jsx("p",{className:"font-medium",children:"Important: Email Throttling"}),n.jsxs("p",{className:"mt-1",children:["Emails will be sent with ",f,"s intervals to prevent your email account from being blocked. Total time: ~",Math.ceil(e.length*f/60)," minutes"]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Interval Between Emails (seconds)"}),n.jsx("input",{type:"number",min:"10",max:"300",value:f,onChange:R=>h(Math.max(10,parseInt(R.target.value)||10)),disabled:A,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100"}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Minimum 10 seconds recommended. Higher values are safer for large batches."})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject *"}),n.jsx("input",{type:"text",value:l,onChange:R=>c(R.target.value),disabled:A,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100",placeholder:"Email subject (use {{company_name}} and {{contact_person}} for personalization)"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Message *"}),n.jsx("textarea",{value:d,onChange:R=>u(R.target.value),disabled:A,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100",rows:10,placeholder:"Type your message here... (use {{company_name}} and {{contact_person}} for personalization)"}),n.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Variables: ","{{company_name}}",", ","{{contact_person}}"]})]}),A&&n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[n.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600"}),n.jsxs("div",{children:[n.jsxs("p",{className:"font-medium text-blue-900",children:["Sending email ",y+1," of ",e.length]}),n.jsxs("p",{className:"text-sm text-blue-700",children:["Current: ",(T=e[y])==null?void 0:T.company_name]})]})]}),n.jsxs("div",{className:"flex gap-4 text-sm",children:[n.jsxs("div",{className:"flex items-center gap-1 text-green-700",children:[n.jsx(Zr,{className:"w-4 h-4"}),"Success: ",C]}),n.jsxs("div",{className:"flex items-center gap-1 text-red-700",children:[n.jsx(gn,{className:"w-4 h-4"}),"Failed: ",k]}),n.jsxs("div",{className:"flex items-center gap-1 text-gray-700",children:[n.jsx(da,{className:"w-4 h-4"}),"Pending: ",w]})]})]}),m.some(R=>R.status!=="pending")&&n.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[n.jsx("div",{className:"bg-gray-50 px-4 py-2 border-b",children:n.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Send Results"})}),n.jsx("div",{className:"max-h-64 overflow-y-auto",children:m.map((R,q)=>n.jsxs("div",{className:`px-4 py-2 border-b last:border-b-0 flex items-center justify-between ${R.status==="success"?"bg-green-50":R.status==="error"?"bg-red-50":R.status==="sending"?"bg-blue-50":""}`,children:[n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"text-sm font-medium text-gray-900",children:R.companyName}),n.jsx("p",{className:"text-xs text-gray-600",children:R.email}),R.error&&n.jsx("p",{className:"text-xs text-red-600 mt-1",children:R.error})]}),n.jsxs("div",{children:[R.status==="success"&&n.jsx(Zr,{className:"w-5 h-5 text-green-600"}),R.status==="error"&&n.jsx(gn,{className:"w-5 h-5 text-red-600"}),R.status==="sending"&&n.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600"}),R.status==="pending"&&n.jsx(da,{className:"w-5 h-5 text-gray-400"})]})]},q))})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[n.jsx("button",{onClick:t,disabled:A,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition disabled:opacity-50",children:A?"Sending...":"Cancel"}),n.jsxs("button",{onClick:E,disabled:A||!l||!d,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed",children:[n.jsx($i,{className:"w-4 h-4"}),A?"Sending...":"Start Bulk Send"]})]}),n.jsx(Ot,{isOpen:p,onClose:()=>b(!1),title:"Email Templates",children:n.jsx("div",{className:"space-y-2",children:a.length===0?n.jsxs("div",{className:"text-center py-8 text-gray-500",children:[n.jsx(Zt,{className:"w-12 h-12 mx-auto text-gray-300 mb-3"}),n.jsx("p",{children:"No templates available"}),n.jsx("p",{className:"text-sm mt-1",children:"Contact admin to create email templates"})]}):a.map(R=>n.jsx("div",{onClick:()=>N(R),className:"p-4 border border-gray-200 rounded-lg hover:border-blue-500 hover:bg-blue-50 cursor-pointer transition",children:n.jsx("div",{className:"flex items-start justify-between",children:n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-semibold text-gray-900",children:R.template_name}),n.jsx("p",{className:"text-sm text-gray-600 mt-1",children:R.subject}),R.category&&n.jsx("span",{className:"inline-block mt-2 px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded",children:R.category})]})})},R.id))})})]})}function Nue(){const[e,t]=Q.useState([]),[r,a]=Q.useState([]),[s,i]=Q.useState(!0),[o,l]=Q.useState(null),[c,d]=Q.useState(""),[u,f]=Q.useState(new Set),[h,A]=Q.useState(!1),[x,p]=Q.useState(""),[b,m]=Q.useState(""),[g,y]=Q.useState(""),[v,_]=Q.useState({created_at:110,company_name:200,contact_person:150,designation:120,email:180,mobile:130,landline:130,phone:130,country:120,city:120,address:200,website:150,customer_type:120,notes:200}),[j,N]=Q.useState(null),B=Q.useRef(null);Q.useEffect(()=>{E()},[]),Q.useEffect(()=>{if(j){const H=W=>{const M=W.clientX-j.startX,se=Math.max(80,j.startWidth+M);_(K=>({...K,[j.column]:se}))},V=()=>{N(null)};return document.addEventListener("mousemove",H),document.addEventListener("mouseup",V),()=>{document.removeEventListener("mousemove",H),document.removeEventListener("mouseup",V)}}},[j]);const E=async()=>{try{const{data:H,error:V}=await Z.from("crm_contacts").select("*").order("company_name");if(V)throw V;t(H||[]),a(H||[])}catch(H){console.error("Error loading customers:",H)}finally{i(!1)}};Q.useEffect(()=>{let H=[...e];if(x){const V=x.toLowerCase();H=H.filter(W=>{var M,se,K,he;return((M=W.company_name)==null?void 0:M.toLowerCase().includes(V))||((se=W.contact_person)==null?void 0:se.toLowerCase().includes(V))||((K=W.email)==null?void 0:K.toLowerCase().includes(V))||((he=W.city)==null?void 0:he.toLowerCase().includes(V))})}b&&(H=H.filter(V=>V.city===b)),g&&(H=H.filter(V=>V.customer_type===g)),a(H)},[x,b,g,e]);const C=Array.from(new Set(e.map(H=>H.city).filter(Boolean))).sort(),k=Array.from(new Set(e.map(H=>H.customer_type).filter(Boolean))).sort(),w=(H,V)=>{l({rowId:H.id,field:V}),d(H[V]||"")},T=async()=>{if(o)try{const{error:H}=await Z.from("crm_contacts").update({[o.field]:c||null}).eq("id",o.rowId);if(H)throw H;t(V=>V.map(W=>W.id===o.rowId?{...W,[o.field]:c||null}:W))}catch(H){console.error("Error updating customer:",H),alert("Failed to update customer")}finally{l(null),d("")}},R=H=>{H.key==="Enter"?(H.preventDefault(),T()):H.key==="Escape"&&(l(null),d(""))},q=async()=>{try{const{data:{user:H}}=await Z.auth.getUser();if(!H)throw new Error("Not authenticated");const{data:V,error:W}=await Z.from("crm_contacts").insert({company_name:"New Customer",is_active:!0,created_by:H.id}).select().single();if(W)throw W;t(M=>[V,...M])}catch(H){console.error("Error adding customer:",H),alert("Failed to add customer")}},z=async()=>{if(u.size!==0&&confirm(`Delete ${u.size} customer(s)?`))try{const{error:H}=await Z.from("crm_contacts").delete().in("id",Array.from(u));if(H)throw H;t(V=>V.filter(W=>!u.has(W.id))),f(new Set)}catch(H){console.error("Error deleting customers:",H),alert("Failed to delete customers")}},ee=H=>{f(V=>{const W=new Set(V);return W.has(H)?W.delete(H):W.add(H),W})},Y=()=>{u.size===r.length?f(new Set):f(new Set(r.map(H=>H.id)))},G=H=>{const V=new Date(H),W=V.getDate().toString().padStart(2,"0"),M=(V.getMonth()+1).toString().padStart(2,"0"),se=V.getFullYear();return`${W}-${M}-${se}`},re=()=>{const H=["Date","Company Name","Contact Person","Designation","Email","Mobile","Landline","Phone","Country","City","Address","Website","Customer Type","Notes"],V=e.map(he=>[G(he.created_at),he.company_name,he.contact_person||"",he.designation||"",he.email||"",he.mobile||"",he.landline||"",he.phone||"",he.country||"",he.city||"",he.address||"",he.website||"",he.customer_type||"",he.notes||""]),W=[H,...V].map(he=>he.map(ne=>`"${ne}"`).join(",")).join(`
`),M=new Blob([W],{type:"text/csv"}),se=URL.createObjectURL(M),K=document.createElement("a");K.href=se,K.download=`customers_${new Date().toISOString().split("T")[0]}.csv`,K.click()},U=async H=>{var W;const V=(W=H.target.files)==null?void 0:W[0];if(V){try{const{data:{user:M}}=await Z.auth.getUser();if(!M)throw new Error("Not authenticated");const K=(await V.text()).split(`
`).filter(Ee=>Ee.trim());if(K.length<2){alert("CSV file is empty or invalid");return}const he=K[0].split(",").map(Ee=>Ee.replace(/"/g,"").trim()),ne=K.slice(1),te=he.findIndex(Ee=>Ee.toLowerCase()==="date"),ce=he.findIndex(Ee=>Ee.toLowerCase()==="company name"),_e=he.findIndex(Ee=>Ee.toLowerCase()==="contact person"),de=he.findIndex(Ee=>Ee.toLowerCase()==="designation"),ye=he.findIndex(Ee=>Ee.toLowerCase()==="email"),Le=he.findIndex(Ee=>Ee.toLowerCase()==="mobile"),we=he.findIndex(Ee=>Ee.toLowerCase()==="landline"),ge=he.findIndex(Ee=>Ee.toLowerCase()==="phone"),Re=he.findIndex(Ee=>Ee.toLowerCase()==="country"),et=he.findIndex(Ee=>Ee.toLowerCase()==="city"),Ye=he.findIndex(Ee=>Ee.toLowerCase()==="address"),Be=he.findIndex(Ee=>Ee.toLowerCase()==="website"),Fe=he.findIndex(Ee=>Ee.toLowerCase()==="customer type"),oe=he.findIndex(Ee=>Ee.toLowerCase()==="notes");if(ce===-1){alert('CSV must have a "Company Name" column');return}const ke=Ee=>{const ze=[];let rt="",nt=!1;for(let mt=0;mt<Ee.length;mt++){const gt=Ee[mt];gt==='"'?nt=!nt:gt===","&&!nt?(ze.push(rt.trim()),rt=""):rt+=gt}return ze.push(rt.trim()),ze},Ue=Ee=>{if(!Ee)return new Date().toISOString();const ze=[/^(\d{1,2})-(\d{1,2})-(\d{4})$/,/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/,/^(\d{4})-(\d{1,2})-(\d{1,2})$/];for(const rt of ze){const nt=Ee.match(rt);if(nt){let mt,gt,Nt;return rt.toString().includes("\\d{4}$")?[,mt,gt,Nt]=nt:[,Nt,gt,mt]=nt,new Date(`${Nt}-${gt.padStart(2,"0")}-${mt.padStart(2,"0")}`).toISOString()}}return new Date().toISOString()},qe=ne.map(Ee=>{var mt,gt,Nt,yt,Et,It,ir,Oe,tt,At,wt,ht,Ft,Ht;const ze=ke(Ee),rt=(mt=ze[ce])==null?void 0:mt.replace(/"/g,"").trim();if(!rt)return null;const nt=te!==-1?Ue((gt=ze[te])==null?void 0:gt.replace(/"/g,"").trim()):new Date().toISOString();return{company_name:rt,contact_person:_e!==-1&&((Nt=ze[_e])==null?void 0:Nt.replace(/"/g,"").trim())||null,designation:de!==-1&&((yt=ze[de])==null?void 0:yt.replace(/"/g,"").trim())||null,email:ye!==-1&&((Et=ze[ye])==null?void 0:Et.replace(/"/g,"").trim())||null,mobile:Le!==-1&&((It=ze[Le])==null?void 0:It.replace(/"/g,"").trim())||null,landline:we!==-1&&((ir=ze[we])==null?void 0:ir.replace(/"/g,"").trim())||null,phone:ge!==-1&&((Oe=ze[ge])==null?void 0:Oe.replace(/"/g,"").trim())||null,country:Re!==-1&&((tt=ze[Re])==null?void 0:tt.replace(/"/g,"").trim())||null,city:et!==-1&&((At=ze[et])==null?void 0:At.replace(/"/g,"").trim())||null,address:Ye!==-1&&((wt=ze[Ye])==null?void 0:wt.replace(/"/g,"").trim())||null,website:Be!==-1&&((ht=ze[Be])==null?void 0:ht.replace(/"/g,"").trim())||null,customer_type:Fe!==-1&&((Ft=ze[Fe])==null?void 0:Ft.replace(/"/g,"").trim())||null,notes:oe!==-1&&((Ht=ze[oe])==null?void 0:Ht.replace(/"/g,"").trim())||null,is_active:!0,created_by:M.id,created_at:nt}}).filter(Boolean);if(qe.length===0){alert("No valid customer data found in CSV");return}const{data:$e,error:Ne}=await Z.from("crm_contacts").insert(qe).select();if(Ne)throw Ne;alert(`Successfully imported ${qe.length} customer(s)`),E()}catch(M){console.error("Error importing CSV:",M),alert("Failed to import CSV. Please check the file format.")}H.target.value=""}},S=H=>{const V=new Date(H),W=V.getDate().toString().padStart(2,"0"),M=(V.getMonth()+1).toString().padStart(2,"0"),se=V.getFullYear();return`${W}-${M}-${se}`},D=(H,V)=>{const W=(o==null?void 0:o.rowId)===H.id&&(o==null?void 0:o.field)===V,M=H[V];return V==="created_at"?n.jsx("div",{className:"px-2 py-1 h-full flex items-center",children:n.jsx("span",{className:"truncate text-xs",children:S(H.created_at)})}):W?n.jsx("input",{type:"text",value:c,onChange:se=>d(se.target.value),onBlur:T,onKeyDown:R,autoFocus:!0,className:"w-full h-full px-2 py-1 border-2 border-blue-500 focus:outline-none bg-white"}):n.jsx("div",{onDoubleClick:()=>w(H,V),className:"px-2 py-1 cursor-cell hover:bg-gray-50 h-full flex items-center",title:"Double-click to edit",children:V==="is_active"?n.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${M?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:M?"Active":"Inactive"}):n.jsx("span",{className:"truncate",children:(M==null?void 0:M.toString())||"-"})})},L=(H,V)=>{H.preventDefault(),N({column:V,startX:H.clientX,startWidth:v[V]})},P=()=>{if(Array.from(u).map(V=>e.find(W=>W.id===V)).filter(V=>!!V&&!!V.email).length===0){alert("Please select customers with email addresses");return}A(!0)},I=()=>Array.from(u).map(H=>e.find(V=>V.id===H)).filter(H=>!!H&&!!H.email).map(H=>({id:H.id,company_name:H.company_name,email:H.email,contact_person:H.contact_person}));return s?n.jsx("div",{className:"flex items-center justify-center h-64",children:"Loading customers..."}):n.jsxs("div",{className:"flex flex-col h-full bg-white rounded-lg shadow",children:[n.jsxs("div",{className:"flex flex-col gap-3 px-4 py-3 border-b border-gray-200",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("button",{onClick:q,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-blue-700 bg-blue-50 border border-blue-200 rounded-md hover:bg-blue-100 transition",children:[n.jsx(Pr,{className:"w-3.5 h-3.5"}),"Add Customer"]}),u.size>0&&n.jsxs(n.Fragment,{children:[n.jsxs("button",{onClick:P,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-white bg-green-600 border border-green-700 rounded-md hover:bg-green-700 transition",children:[n.jsx($i,{className:"w-3.5 h-3.5"}),"Send Email (",u.size,")"]}),n.jsxs("button",{onClick:z,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-red-700 bg-red-50 border border-red-200 rounded-md hover:bg-red-100 transition",children:[n.jsx(Lr,{className:"w-3.5 h-3.5"}),"Delete (",u.size,")"]})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("label",{className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition cursor-pointer",children:[n.jsx(Rl,{className:"w-3.5 h-3.5"}),"Import CSV",n.jsx("input",{type:"file",accept:".csv",onChange:U,className:"hidden"})]}),n.jsxs("button",{onClick:re,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition",children:[n.jsx(Zn,{className:"w-3.5 h-3.5"}),"Export CSV"]})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(Ca,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),n.jsx("input",{type:"text",value:x,onChange:H=>p(H.target.value),placeholder:"Search by company, contact person, email, or city...",className:"w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),n.jsxs("select",{value:b,onChange:H=>m(H.target.value),className:"px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"",children:"All Cities"}),C.map(H=>n.jsx("option",{value:H,children:H},H))]}),n.jsxs("select",{value:g,onChange:H=>y(H.target.value),className:"px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"",children:"All Types"}),k.map(H=>n.jsx("option",{value:H,children:H},H))]}),(x||b||g)&&n.jsx("button",{onClick:()=>{p(""),m(""),y("")},className:"px-3 py-2 text-xs font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded-md hover:bg-gray-200 transition",children:"Clear Filters"})]})]}),n.jsx("div",{ref:B,className:"flex-1 overflow-auto",style:{maxHeight:"calc(100vh - 250px)"},children:n.jsxs("table",{className:"w-full border-collapse",children:[n.jsx("thead",{className:"sticky top-0 bg-gray-50 z-10",children:n.jsxs("tr",{children:[n.jsx("th",{className:"border border-gray-300 px-2 py-2 bg-gray-100 w-10",children:n.jsx("input",{type:"checkbox",checked:u.size===r.length&&r.length>0,onChange:Y,className:"rounded"})}),[{key:"created_at",label:"Date"},{key:"company_name",label:"Company Name"},{key:"contact_person",label:"Contact Person"},{key:"designation",label:"Designation"},{key:"email",label:"Email"},{key:"mobile",label:"Mobile"},{key:"landline",label:"Landline"},{key:"phone",label:"Phone"},{key:"country",label:"Country"},{key:"city",label:"City"},{key:"address",label:"Address"},{key:"website",label:"Website"},{key:"customer_type",label:"Type"},{key:"notes",label:"Notes"}].map(({key:H,label:V})=>n.jsx("th",{className:"border border-gray-300 px-2 py-2 bg-gray-100 text-left text-xs font-semibold text-gray-700 relative",style:{width:v[H],minWidth:v[H]},children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{children:V}),n.jsx("div",{onMouseDown:W=>L(W,H),className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 hover:w-1.5 transition-all",style:{touchAction:"none"}})]})},H))]})}),n.jsx("tbody",{children:r.map(H=>n.jsxs("tr",{className:`${u.has(H.id)?"bg-blue-50":"hover:bg-gray-50"} transition`,children:[n.jsx("td",{className:"border border-gray-300 px-2 py-1 text-center",children:n.jsx("input",{type:"checkbox",checked:u.has(H.id),onChange:()=>ee(H.id),className:"rounded"})}),n.jsx("td",{className:"border border-gray-300 h-8",style:{width:v.created_at},children:D(H,"created_at")}),n.jsx("td",{className:"border border-gray-300 h-8",style:{width:v.company_name},children:D(H,"company_name")}),n.jsx("td",{className:"border border-gray-300 h-8",style:{width:v.contact_person},children:D(H,"contact_person")}),n.jsx("td",{className:"border border-gray-300 h-8",style:{width:v.designation},children:D(H,"designation")}),n.jsx("td",{className:"border border-gray-300 h-8",style:{width:v.email},children:D(H,"email")}),n.jsx("td",{className:"border border-gray-300 h-8",style:{width:v.mobile},children:D(H,"mobile")}),n.jsx("td",{className:"border border-gray-300 h-8",style:{width:v.landline},children:D(H,"landline")}),n.jsx("td",{className:"border border-gray-300 h-8",style:{width:v.phone},children:D(H,"phone")}),n.jsx("td",{className:"border border-gray-300 h-8",style:{width:v.country},children:D(H,"country")}),n.jsx("td",{className:"border border-gray-300 h-8",style:{width:v.city},children:D(H,"city")}),n.jsx("td",{className:"border border-gray-300 h-8",style:{width:v.address},children:D(H,"address")}),n.jsx("td",{className:"border border-gray-300 h-8",style:{width:v.website},children:D(H,"website")}),n.jsx("td",{className:"border border-gray-300 h-8",style:{width:v.customer_type},children:D(H,"customer_type")}),n.jsx("td",{className:"border border-gray-300 h-8",style:{width:v.notes},children:D(H,"notes")})]},H.id))})]})}),n.jsx("div",{className:"px-4 py-2 border-t border-gray-200 bg-gray-50 text-sm text-gray-600",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("span",{children:[r.length," customer(s)",r.length!==e.length&&` (filtered from ${e.length} total)`,u.size>0&&`  ${u.size} selected`]}),n.jsx("span",{className:"text-xs text-gray-500",children:"Double-click any cell to edit  Drag column borders to resize"})]})}),n.jsx(Ot,{isOpen:h,onClose:()=>{A(!1),f(new Set)},title:"Bulk Email",children:n.jsx(wue,{selectedCustomers:I(),onClose:()=>{A(!1),f(new Set)},onComplete:()=>{A(!1),f(new Set),E()}})})]})}function jue({inquiryId:e,customerId:t,leadId:r,onActivityLogged:a}){const{profile:s}=Cr(),{t:i}=cn(),[o,l]=Q.useState([]),[c,d]=Q.useState(!0),[u,f]=Q.useState(!1),[h,A]=Q.useState({activity_type:"phone_call",subject:"",description:"",follow_up_date:"",is_completed:!1});Q.useEffect(()=>{x()},[e,t,r]);const x=async()=>{try{let _=Z.from("crm_activities").select("*, user_profiles!crm_activities_created_by_fkey(full_name)").order("created_at",{ascending:!1});r&&(_=_.eq("lead_id",r)),t&&(_=_.eq("customer_id",t));const{data:j,error:N}=await _;if(N)throw N;l(j||[])}catch(_){console.error("Error loading activities:",_)}finally{d(!1)}},p=async _=>{_.preventDefault();try{const{data:{user:j}}=await Z.auth.getUser();if(!j)throw new Error("Not authenticated");const N={...h,created_by:j.id,follow_up_date:h.follow_up_date||null,completed_at:h.is_completed?new Date().toISOString():null};r&&(N.lead_id=r),t&&(N.customer_id=t);const{error:B}=await Z.from("crm_activities").insert([N]);if(B)throw B;f(!1),A({activity_type:"phone_call",subject:"",description:"",follow_up_date:"",is_completed:!1}),x(),a==null||a()}catch(j){console.error("Error logging activity:",j),alert("Failed to log activity. Please try again.")}},b=async _=>{try{const{error:j}=await Z.from("crm_activities").update({is_completed:!0,completed_at:new Date().toISOString()}).eq("id",_);if(j)throw j;x()}catch(j){console.error("Error completing activity:",j),alert("Failed to complete activity. Please try again.")}},m=async _=>{if(confirm("Are you sure you want to delete this activity? This action cannot be undone."))try{const{error:j}=await Z.from("crm_activities").delete().eq("id",_);if(j)throw j;x(),a==null||a()}catch(j){console.error("Error deleting activity:",j),alert("Failed to delete activity. Please try again.")}},g=_=>{switch(_){case"phone_call":return n.jsx(Ul,{className:"w-5 h-5"});case"meeting":return n.jsx(ja,{className:"w-5 h-5"});case"email":return n.jsx(U0,{className:"w-5 h-5"});case"note":return n.jsx(Zt,{className:"w-5 h-5"});case"video_call":return n.jsx(TE,{className:"w-5 h-5"});case"whatsapp":return n.jsx(k7,{className:"w-5 h-5"});default:return n.jsx(Zt,{className:"w-5 h-5"})}},y=_=>{switch(_){case"phone_call":return"bg-blue-50 text-blue-600 border-blue-200";case"meeting":return"bg-purple-50 text-purple-600 border-purple-200";case"email":return"bg-green-50 text-green-600 border-green-200";case"note":return"bg-gray-50 text-gray-600 border-gray-200";case"video_call":return"bg-indigo-50 text-indigo-600 border-indigo-200";case"whatsapp":return"bg-emerald-50 text-emerald-600 border-emerald-200";default:return"bg-gray-50 text-gray-600 border-gray-200"}},v=_=>({phone_call:"Phone Call",meeting:"Meeting",email:"Email",note:"Note",video_call:"Video Call",whatsapp:"WhatsApp"})[_]||_;return c?n.jsx("div",{className:"flex justify-center py-8",children:"Loading activities..."}):n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Activity Log"}),n.jsxs("button",{onClick:()=>f(!u),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:[n.jsx(Pr,{className:"w-4 h-4"}),"Log Activity"]})]}),u&&n.jsx("div",{className:"bg-gray-50 rounded-lg p-6 border border-gray-200",children:n.jsxs("form",{onSubmit:p,className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Activity Type *"}),n.jsxs("select",{value:h.activity_type,onChange:_=>A({...h,activity_type:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[n.jsx("option",{value:"phone_call",children:"Phone Call"}),n.jsx("option",{value:"meeting",children:"Meeting"}),n.jsx("option",{value:"email",children:"Email"}),n.jsx("option",{value:"note",children:"Note"}),n.jsx("option",{value:"video_call",children:"Video Call"}),n.jsx("option",{value:"whatsapp",children:"WhatsApp (Coming Soon)"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject *"}),n.jsx("input",{type:"text",value:h.subject,onChange:_=>A({...h,subject:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Brief description",required:!0})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),n.jsx("textarea",{value:h.description,onChange:_=>A({...h,description:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"Detailed notes about the conversation or activity"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Follow-up Date"}),n.jsx("input",{type:"datetime-local",value:h.follow_up_date,onChange:_=>A({...h,follow_up_date:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),n.jsx("div",{className:"flex items-center",children:n.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:h.is_completed,onChange:_=>A({...h,is_completed:_.target.checked}),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-2 focus:ring-blue-500"}),n.jsx("span",{className:"text-sm text-gray-700",children:"Mark as completed"})]})})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[n.jsx("button",{type:"button",onClick:()=>f(!1),className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),n.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:"Log Activity"})]})]})}),n.jsx("div",{className:"space-y-3",children:o.length===0?n.jsx("div",{className:"text-center py-8 text-gray-500",children:"No activities logged yet. Start by logging your first activity!"}):o.map(_=>n.jsx("div",{className:`border rounded-lg p-4 ${_.is_completed?"bg-gray-50 border-gray-200":"bg-white border-gray-300"}`,children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:`p-2 rounded-lg border ${y(_.activity_type)}`,children:g(_.activity_type)}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-start justify-between gap-2",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("h4",{className:"font-medium text-gray-900",children:_.subject}),_.is_completed&&n.jsxs("span",{className:"flex items-center gap-1 text-xs text-green-600 bg-green-50 px-2 py-0.5 rounded",children:[n.jsx(Zr,{className:"w-3 h-3"}),"Completed"]})]}),n.jsxs("p",{className:"text-sm text-gray-600",children:[v(_.activity_type),"  ",new Date(_.created_at).toLocaleString()]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[!_.is_completed&&_.follow_up_date&&n.jsx("button",{onClick:()=>b(_.id),className:"text-sm px-3 py-1 text-green-600 hover:bg-green-50 rounded-lg transition",children:"Mark Complete"}),n.jsx("button",{onClick:()=>m(_.id),className:"p-1 text-red-600 hover:bg-red-50 rounded transition",title:"Delete activity",children:n.jsx(Lr,{className:"w-4 h-4"})})]})]}),_.description&&n.jsx("p",{className:"mt-2 text-sm text-gray-700 whitespace-pre-wrap",children:_.description}),_.follow_up_date&&!_.is_completed&&n.jsxs("div",{className:"mt-2 flex items-center gap-2 text-sm text-orange-600",children:[n.jsx(da,{className:"w-4 h-4"}),"Follow-up: ",new Date(_.follow_up_date).toLocaleString()]}),_.user_profiles&&n.jsxs("p",{className:"mt-2 text-xs text-gray-500",children:["by ",_.user_profiles.full_name]})]})]})},_.id))})]})}function kue({customerId:e,leadId:t,onAppointmentCreated:r}){const{profile:a}=Cr(),[s,i]=Q.useState([]),[o,l]=Q.useState([]),[c,d]=Q.useState([]),[u,f]=Q.useState(!0),[h,A]=Q.useState(!1),[x,p]=Q.useState(null),[b,m]=Q.useState({activity_type:"meeting",subject:"",description:"",follow_up_date:"",location:"",customer_id:e||"",participants:[],auto_create_followup_task:!1});Q.useEffect(()=>{v(),y(),!e&&!t&&g()},[e,t]);const g=async()=>{try{const{data:w,error:T}=await Z.from("crm_contacts").select("id, company_name").order("company_name",{ascending:!0});if(T)throw T;l(w||[])}catch(w){console.error("Error loading contacts:",w)}},y=async()=>{try{const{data:w,error:T}=await Z.from("user_profiles").select("id, full_name").order("full_name",{ascending:!0});if(T)throw T;d(w||[])}catch(w){console.error("Error loading users:",w)}},v=async()=>{try{let w=Z.from("crm_activities").select("*, user_profiles!crm_activities_created_by_fkey(full_name), crm_contacts!crm_activities_customer_id_fkey(company_name)").in("activity_type",["meeting","video_call","phone_call"]).not("follow_up_date","is",null).order("follow_up_date",{ascending:!0});e?w=w.eq("customer_id",e):t&&(w=w.eq("lead_id",t));const{data:T,error:R}=await w;if(R)throw R;i(T||[])}catch(w){console.error("Error loading appointments:",w)}finally{f(!1)}},_=async w=>{w.preventDefault();try{const{data:{user:T}}=await Z.auth.getUser();if(!T)throw new Error("Not authenticated");let R=b.follow_up_date;b.follow_up_date&&b.follow_up_date.length===16&&(R=b.follow_up_date+":00");const q={activity_type:b.activity_type,subject:b.subject,description:b.description||null,follow_up_date:R,is_completed:!1,created_by:T.id,participants:b.participants,auto_create_followup_task:b.auto_create_followup_task};if(e?q.customer_id=e:t?q.lead_id=t:b.customer_id&&(q.customer_id=b.customer_id),x){const{error:z}=await Z.from("crm_activities").update(q).eq("id",x.id);if(z)throw z}else{const{error:z}=await Z.from("crm_activities").insert([q]);if(z)throw z}A(!1),p(null),m({activity_type:"meeting",subject:"",description:"",follow_up_date:"",location:"",customer_id:e||"",participants:[],auto_create_followup_task:!1}),v(),r==null||r()}catch(T){console.error("Error saving appointment:",T),alert("Failed to save appointment. Please try again.")}},j=w=>{p(w);let T="";w.follow_up_date&&(T=w.follow_up_date.substring(0,16)),m({activity_type:w.activity_type,subject:w.subject,description:w.description||"",follow_up_date:T,location:"",customer_id:w.customer_id||e||"",participants:w.participants||[],auto_create_followup_task:w.auto_create_followup_task||!1}),A(!0)},N=async w=>{if(confirm("Are you sure you want to delete this appointment?"))try{const{error:T}=await Z.from("crm_activities").delete().eq("id",w);if(T)throw T;v()}catch(T){console.error("Error deleting appointment:",T),alert("Failed to delete appointment. Please try again.")}},B=async w=>{try{const{error:T}=await Z.from("crm_activities").update({is_completed:!0,completed_at:new Date().toISOString()}).eq("id",w);if(T)throw T;v()}catch(T){console.error("Error completing appointment:",T),alert("Failed to complete appointment. Please try again.")}},E=w=>{switch(w){case"meeting":return n.jsx(ja,{className:"w-5 h-5"});case"video_call":return n.jsx(TE,{className:"w-5 h-5"});case"phone_call":return n.jsx(Ul,{className:"w-5 h-5"});default:return n.jsx(ja,{className:"w-5 h-5"})}},C=w=>{if(w.is_completed)return"bg-gray-50 border-gray-200 text-gray-600";const T=new Date,R=new Date(w.follow_up_date);return R<T?"bg-red-50 border-red-200 text-red-700":R<new Date(T.getTime()+24*60*60*1e3)?"bg-orange-50 border-orange-200 text-orange-700":"bg-blue-50 border-blue-200 text-blue-700"},k=w=>({meeting:"In-Person Meeting",video_call:"Video Call",phone_call:"Phone Call"})[w]||w;return u?n.jsx("div",{className:"flex justify-center py-8",children:"Loading appointments..."}):n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Appointments & Meetings"}),n.jsxs("button",{onClick:()=>{p(null),m({activity_type:"meeting",subject:"",description:"",follow_up_date:"",location:"",customer_id:e||"",participants:[],auto_create_followup_task:!1}),!e&&!t&&g(),A(!h)},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:[n.jsx(Pr,{className:"w-4 h-4"}),"Schedule Appointment"]})]}),h&&n.jsx("div",{className:"bg-gray-50 rounded-lg p-6 border border-gray-200",children:n.jsxs("form",{onSubmit:_,className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[!e&&!t&&n.jsxs("div",{className:"col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer *"}),n.jsxs("select",{value:b.customer_id,onChange:w=>m({...b,customer_id:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[n.jsx("option",{value:"",children:"Select a customer..."}),o.map(w=>n.jsx("option",{value:w.id,children:w.company_name},w.id))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Appointment Type *"}),n.jsxs("select",{value:b.activity_type,onChange:w=>m({...b,activity_type:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[n.jsx("option",{value:"meeting",children:"In-Person Meeting"}),n.jsx("option",{value:"video_call",children:"Video Call"}),n.jsx("option",{value:"phone_call",children:"Phone Call"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date & Time *"}),n.jsx("input",{type:"datetime-local",value:b.follow_up_date,onChange:w=>m({...b,follow_up_date:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject *"}),n.jsx("input",{type:"text",value:b.subject,onChange:w=>m({...b,subject:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Product demonstration, Price negotiation",required:!0})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description / Agenda"}),n.jsx("textarea",{value:b.description,onChange:w=>m({...b,description:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"Meeting agenda, discussion points, etc."})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Participants"}),n.jsx("div",{className:"border border-gray-300 rounded-lg p-3 max-h-40 overflow-y-auto",children:n.jsx("div",{className:"space-y-2",children:c.map(w=>n.jsxs("label",{className:"flex items-center gap-2 cursor-pointer hover:bg-gray-50 p-1 rounded",children:[n.jsx("input",{type:"checkbox",checked:b.participants.includes(w.id),onChange:T=>{T.target.checked?m({...b,participants:[...b.participants,w.id]}):m({...b,participants:b.participants.filter(R=>R!==w.id)})},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),n.jsx("span",{className:"text-sm text-gray-700",children:w.full_name})]},w.id))})}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Tagged participants will receive notifications and can see this appointment"})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:b.auto_create_followup_task,onChange:w=>m({...b,auto_create_followup_task:w.target.checked}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),n.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Auto-create follow-up task after meeting"})]}),n.jsx("p",{className:"text-xs text-gray-500 ml-6",children:"A task will be created 2 days after the meeting for follow-up"})]})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[n.jsx("button",{type:"button",onClick:()=>{A(!1),p(null)},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),n.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:x?"Update Appointment":"Schedule Appointment"})]})]})}),n.jsx("div",{className:"space-y-3",children:s.length===0?n.jsx("div",{className:"text-center py-8 text-gray-500",children:"No appointments scheduled. Create your first appointment!"}):n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx("h4",{className:"text-sm font-semibold text-gray-700",children:"Upcoming Appointments"}),s.filter(w=>!w.is_completed&&new Date(w.follow_up_date)>=new Date).map(w=>n.jsx("div",{className:`border rounded-lg p-4 ${C(w)}`,children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"flex-shrink-0",children:E(w.activity_type)}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-start justify-between gap-2",children:[n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-gray-900",children:w.subject}),w.crm_contacts&&n.jsx("p",{className:"text-sm font-medium text-blue-600 mt-1",children:w.crm_contacts.company_name}),n.jsx("p",{className:"text-sm text-gray-600 mt-1",children:k(w.activity_type)}),n.jsxs("p",{className:"text-sm font-medium mt-1 flex items-center gap-1",children:[n.jsx(da,{className:"w-4 h-4"}),new Date(w.follow_up_date).toLocaleString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>j(w),className:"p-1 hover:bg-white rounded transition",title:"Edit",children:n.jsx(OA,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>N(w.id),className:"p-1 hover:bg-white rounded transition",title:"Delete",children:n.jsx(Lr,{className:"w-4 h-4"})})]})]}),w.description&&n.jsx("p",{className:"mt-2 text-sm text-gray-700 whitespace-pre-wrap",children:w.description}),w.participants&&w.participants.length>0&&n.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[n.jsx(vo,{className:"w-4 h-4 text-gray-500"}),n.jsx("div",{className:"flex flex-wrap gap-1",children:w.participants.map(T=>{const R=c.find(q=>q.id===T);return R?n.jsx("span",{className:"text-xs bg-blue-100 text-blue-700 px-2 py-0.5 rounded",children:R.full_name},T):null})})]}),n.jsx("div",{className:"mt-3 flex gap-2",children:n.jsx("button",{onClick:()=>B(w.id),className:"text-xs px-3 py-1 bg-white border border-current rounded hover:bg-gray-50 transition",children:"Mark as Completed"})})]})]})},w.id))]}),s.filter(w=>w.is_completed||new Date(w.follow_up_date)<new Date).length>0&&n.jsxs("div",{className:"space-y-2 pt-4 border-t",children:[n.jsx("h4",{className:"text-sm font-semibold text-gray-700",children:"Past Appointments"}),s.filter(w=>w.is_completed||new Date(w.follow_up_date)<new Date).map(w=>n.jsx("div",{className:"border rounded-lg p-4 bg-gray-50 border-gray-200",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"flex-shrink-0 text-gray-400",children:E(w.activity_type)}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("h4",{className:"font-medium text-gray-700",children:w.subject}),n.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[k(w.activity_type),"  ",new Date(w.follow_up_date).toLocaleDateString()]})]})]})},w.id))]})]})})]})}function Cue({canManage:e,onRefresh:t}){const{profile:r}=Cr(),[a,s]=Q.useState([]),[i,o]=Q.useState([]),[l,c]=Q.useState(!0),[d,u]=Q.useState(""),[f,h]=Q.useState(null),[A,x]=Q.useState(!1);Q.useEffect(()=>{p()},[]),Q.useEffect(()=>{if(d){const g=a.filter(y=>y.inquiry_number.toLowerCase().includes(d.toLowerCase())||y.company_name.toLowerCase().includes(d.toLowerCase())||y.product_name.toLowerCase().includes(d.toLowerCase())||y.lost_reason&&y.lost_reason.toLowerCase().includes(d.toLowerCase()));o(g)}else o(a)},[d,a]);const p=async()=>{try{const{data:g,error:y}=await Z.from("crm_inquiries").select("*").eq("pipeline_status","lost").order("lost_at",{ascending:!1});if(y)throw y;s(g||[]),o(g||[])}catch(g){console.error("Error loading archived inquiries:",g)}finally{c(!1)}},b=async g=>{if(confirm(`Reopen inquiry #${g.inquiry_number} and move it back to active deals?`))try{const{error:y}=await Z.from("crm_inquiries").update({pipeline_status:"in_progress",lost_reason:null,lost_at:null,competitor_name:null,competitor_price:null}).eq("id",g.id);if(y)throw y;alert("Inquiry reopened and moved to active deals!"),p(),t()}catch(y){console.error("Error reopening inquiry:",y),alert("Failed to reopen inquiry. Please try again.")}},m=()=>{try{const g=i.map(j=>({"Inquiry No.":j.inquiry_number,Date:new Date(j.inquiry_date).toLocaleDateString("en-GB"),Company:j.company_name,Product:j.product_name,Qty:j.quantity,"Offered Price":j.offered_price?`${j.offered_price} ${j.offered_price_currency}`:"-",Supplier:j.supplier_name||"-","Lost Reason":j.lost_reason||"-",Competitor:j.competitor_name||"-","Competitor Price":j.competitor_price?`$${j.competitor_price}`:"-","Lost Date":j.lost_at?new Date(j.lost_at).toLocaleDateString("en-GB"):"-",Remarks:j.remarks||"-"})),y=va.json_to_sheet(g);y["!cols"]=[{wch:12},{wch:12},{wch:25},{wch:30},{wch:12},{wch:15},{wch:20},{wch:40},{wch:20},{wch:15},{wch:12},{wch:30}];const v=va.book_new();va.book_append_sheet(v,y,"Lost Deals Archive");const _=`Archive-Lost-Deals-${new Date().toISOString().split("T")[0]}.xlsx`;E0(v,_),alert(`Exported ${g.length} archived inquiries to ${_}`)}catch(g){console.error("Export error:",g),alert("Failed to export data. Please try again.")}};return l?n.jsx("div",{className:"flex items-center justify-center py-12",children:n.jsx("div",{className:"w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"})}):n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[n.jsx(gn,{className:"w-6 h-6 text-red-600"}),"Lost Deals Archive"]}),n.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"View history of lost inquiries and analyze reasons for improvement"})]}),n.jsxs("button",{onClick:m,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition",children:[n.jsx(Zn,{className:"w-4 h-4"}),"Export to Excel"]})]}),n.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(Ca,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:d,onChange:g=>u(g.target.value),placeholder:"Search by inquiry no, company, product, or lost reason...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),n.jsxs("div",{className:"text-sm text-gray-600",children:[n.jsx("span",{className:"font-semibold",children:i.length})," archived inquiries"]})]})}),i.length===0?n.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[n.jsx(gn,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),n.jsx("p",{className:"text-gray-500",children:d?"No archived inquiries match your search.":"No archived inquiries yet."})]}):n.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"No."}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Company"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Product"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Qty"}),(r==null?void 0:r.role)==="admin"&&n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Offered"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Supplier"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Lost Reason"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Lost Date"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),n.jsx("tbody",{className:"divide-y divide-gray-200",children:i.map(g=>n.jsxs("tr",{className:"hover:bg-gray-50 transition",children:[n.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:g.inquiry_number}),n.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:new Date(g.inquiry_date).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})}),n.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:g.company_name}),n.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:g.product_name}),n.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:g.quantity}),(r==null?void 0:r.role)==="admin"&&n.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:g.offered_price?`$${g.offered_price.toLocaleString("en-US",{minimumFractionDigits:2})}`:"-"}),n.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:g.supplier_name||"-"}),n.jsx("td",{className:"px-4 py-3 text-sm",children:n.jsxs("div",{className:"max-w-xs",children:[n.jsx("p",{className:"text-gray-900 line-clamp-2",children:g.lost_reason||"-"}),g.competitor_name&&n.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Competitor: ",g.competitor_name,g.competitor_price&&` ($${g.competitor_price})`]})]})}),n.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:g.lost_at?new Date(g.lost_at).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"}):"-"}),n.jsx("td",{className:"px-4 py-3 text-sm",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>{h(g),x(!0)},className:"p-1 text-blue-600 hover:bg-blue-50 rounded transition",title:"View Details",children:n.jsx(bi,{className:"w-4 h-4"})}),e&&n.jsx("button",{onClick:()=>b(g),className:"p-1 text-green-600 hover:bg-green-50 rounded transition",title:"Reopen Deal",children:n.jsx(t_,{className:"w-4 h-4"})})]})})]},g.id))})]})})}),f&&n.jsx(Ot,{isOpen:A,onClose:()=>{x(!1),h(null)},title:`Inquiry #${f.inquiry_number} - Details`,children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-2 pb-4 border-b",children:[n.jsx(lD,{status:"lost"}),n.jsxs("span",{className:"text-sm text-gray-500",children:["Lost on ",f.lost_at?new Date(f.lost_at).toLocaleDateString("en-GB"):"N/A"]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Company"}),n.jsx("p",{className:"text-sm text-gray-900",children:f.company_name})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Product"}),n.jsx("p",{className:"text-sm text-gray-900",children:f.product_name})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Quantity"}),n.jsx("p",{className:"text-sm text-gray-900",children:f.quantity})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Supplier"}),n.jsx("p",{className:"text-sm text-gray-900",children:f.supplier_name||"-"})]}),(r==null?void 0:r.role)==="admin"&&f.offered_price&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Offered Price"}),n.jsxs("p",{className:"text-sm text-gray-900",children:["$",f.offered_price.toLocaleString("en-US",{minimumFractionDigits:2})," ",f.offered_price_currency]})]})]}),n.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx(En,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h4",{className:"text-sm font-medium text-red-900 mb-1",children:"Lost Reason"}),n.jsx("p",{className:"text-sm text-red-800",children:f.lost_reason||"No reason provided"}),f.competitor_name&&n.jsxs("div",{className:"mt-3 pt-3 border-t border-red-200",children:[n.jsx("p",{className:"text-xs font-medium text-red-900 mb-1",children:"Competitor Information"}),n.jsxs("p",{className:"text-sm text-red-800",children:[f.competitor_name,f.competitor_price&&` - $${f.competitor_price.toLocaleString("en-US",{minimumFractionDigits:2})}`]})]})]})]})}),f.remarks&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Remarks"}),n.jsx("p",{className:"text-sm text-gray-900 bg-gray-50 rounded p-3",children:f.remarks})]}),e&&n.jsx("div",{className:"flex justify-end pt-4 border-t",children:n.jsxs("button",{onClick:()=>{b(f),x(!1)},className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition",children:[n.jsx(t_,{className:"w-4 h-4"}),"Reopen This Deal"]})})]})})]})}function cD({onSubmit:e,onCancel:t,initialData:r,isEditing:a=!1}){const{profile:s}=Cr(),[i,o]=Q.useState([]),[l,c]=Q.useState([]),[d,u]=Q.useState(""),[f,h]=Q.useState(!1),[A,x]=Q.useState(!1),[p,b]=Q.useState(!1),m=Q.useRef(null),[g,y]=Q.useState({product_name:(r==null?void 0:r.product_name)||"",specification:(r==null?void 0:r.specification)||"",quantity:(r==null?void 0:r.quantity)||"",priority:(r==null?void 0:r.priority)||"medium",inquiry_source:(r==null?void 0:r.inquiry_source)||"email",supplier_name:(r==null?void 0:r.supplier_name)||"",supplier_country:(r==null?void 0:r.supplier_country)||"",customer_id:(r==null?void 0:r.customer_id)||"",company_name:(r==null?void 0:r.company_name)||"",contact_person:(r==null?void 0:r.contact_person)||"",contact_email:(r==null?void 0:r.contact_email)||"",contact_phone:(r==null?void 0:r.contact_phone)||"",price_required:(r==null?void 0:r.price_required)||!1,coa_required:(r==null?void 0:r.coa_required)||!1,sample_required:(r==null?void 0:r.sample_required)||!1,agency_letter_required:(r==null?void 0:r.agency_letter_required)||!1,others_required:(r==null?void 0:r.others_required)||!1,purchase_price:(r==null?void 0:r.purchase_price)||"",purchase_price_currency:(r==null?void 0:r.purchase_price_currency)||"USD",offered_price:(r==null?void 0:r.offered_price)||"",offered_price_currency:(r==null?void 0:r.offered_price_currency)||"USD",delivery_date:(r==null?void 0:r.delivery_date)||"",delivery_terms:(r==null?void 0:r.delivery_terms)||"",aceerp_no:(r==null?void 0:r.aceerp_no)||"",mail_subject:(r==null?void 0:r.mail_subject)||"",pipeline_status:(r==null?void 0:r.pipeline_status)||"new",remarks:(r==null?void 0:r.remarks)||"",internal_notes:(r==null?void 0:r.internal_notes)||"",is_multi_product:(r==null?void 0:r.is_multi_product)||!1,products:(r==null?void 0:r.products)||[]}),[v,_]=Q.useState({company_name:"",contact_person:"",email:"",phone:"",country:"Indonesia",address:"",city:"Jakarta Pusat",npwp:"",pbf_license:"",gst_vat_type:"",payment_terms:""});Q.useEffect(()=>{j()},[]),Q.useEffect(()=>{const C=k=>{m.current&&!m.current.contains(k.target)&&h(!1)};return f&&document.addEventListener("mousedown",C),()=>{document.removeEventListener("mousedown",C)}},[f]),Q.useEffect(()=>{if(d){const C=i.filter(k=>k.company_name.toLowerCase().includes(d.toLowerCase()));c(C)}else c(i)},[d,i]);const j=async()=>{try{const{data:C,error:k}=await Z.from("customers").select("id, company_name, contact_person, email, phone, country, address, city").eq("is_active",!0).order("company_name");if(k)throw k;o(C||[]),c(C||[])}catch(C){console.error("Error loading customers:",C)}},N=C=>{y({...g,customer_id:C.id,company_name:C.company_name,contact_person:C.contact_person||"",contact_email:C.email||"",contact_phone:C.phone||""}),u(C.company_name),h(!1)},B=async()=>{if(!v.company_name){alert("Customer name is required");return}try{const{data:C,error:k}=await Z.from("customers").insert({...v,is_active:!0}).select().single();if(k)throw k;await j(),N(C),x(!1),_({company_name:"",contact_person:"",email:"",phone:"",country:"Indonesia",address:"",city:"Jakarta Pusat",npwp:"",pbf_license:"",gst_vat_type:"",payment_terms:""})}catch(C){console.error("Error adding customer:",C),alert("Failed to add customer")}},E=async C=>{if(C.preventDefault(),g.is_multi_product){if(!g.company_name){alert("Please fill in Customer");return}}else if(!g.product_name||!g.quantity||!g.company_name){alert("Please fill in all required fields: Product Name, Quantity, and Customer");return}b(!0);try{await e(g)}finally{b(!1)}};return n.jsxs(n.Fragment,{children:[n.jsxs("form",{onSubmit:E,className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center gap-2 p-3 bg-blue-50 rounded-lg border border-blue-200",children:[n.jsx("input",{type:"checkbox",id:"multiProductToggle",checked:g.is_multi_product,onChange:C=>{const k=C.target.checked;y({...g,is_multi_product:k,products:k&&g.products.length===0?[{productName:"",specification:"",quantity:"",supplierName:"",supplierCountry:"",deliveryDate:"",deliveryTerms:""}]:g.products})},className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),n.jsx("label",{htmlFor:"multiProductToggle",className:"text-sm font-medium text-gray-700 cursor-pointer",children:"Multi-Product Inquiry (Common data will be applied to all products)"})]}),!g.is_multi_product&&n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Product Name ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:g.product_name,onChange:C=>y({...g,product_name:C.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Enter product name",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Specification"}),n.jsx("input",{type:"text",value:g.specification,onChange:C=>y({...g,specification:C.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"BP / USP / EP"})]})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[!g.is_multi_product&&n.jsxs("div",{children:[n.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Quantity ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:g.quantity,onChange:C=>y({...g,quantity:C.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"e.g., 500 KG",required:!0})]}),n.jsxs("div",{className:g.is_multi_product?"col-span-1":"",children:[n.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Priority ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("select",{value:g.priority,onChange:C=>y({...g,priority:C.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"low",children:"Low"}),n.jsx("option",{value:"medium",children:"Medium"}),n.jsx("option",{value:"high",children:"High"}),n.jsx("option",{value:"urgent",children:"Urgent"})]})]}),n.jsxs("div",{className:g.is_multi_product?"col-span-2":"",children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Inquiry Source"}),n.jsxs("select",{value:g.inquiry_source,onChange:C=>y({...g,inquiry_source:C.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"email",children:"Email"}),n.jsx("option",{value:"phone",children:"Phone"}),n.jsx("option",{value:"whatsapp",children:"WhatsApp"}),n.jsx("option",{value:"website",children:"Website"}),n.jsx("option",{value:"referral",children:"Referral"}),n.jsx("option",{value:"other",children:"Other"})]})]})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Supplier Name"}),n.jsx("input",{type:"text",value:g.supplier_name,onChange:C=>y({...g,supplier_name:C.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Manufacturer/Supplier"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Country of Origin"}),n.jsx("input",{type:"text",value:g.supplier_country,onChange:C=>y({...g,supplier_country:C.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Supplier country"})]}),n.jsxs("div",{ref:m,className:"relative",children:[n.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Customer ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("div",{className:"relative",children:[n.jsx("input",{type:"text",value:d||g.company_name,onChange:C=>{u(C.target.value),h(!0)},onFocus:()=>h(!0),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 pr-8",placeholder:"Search customer...",required:!0}),n.jsx(Ca,{className:"absolute right-2 top-2 w-4 h-4 text-gray-400"})]}),f&&n.jsxs("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-48 overflow-y-auto",children:[l.map(C=>n.jsxs("div",{onClick:()=>N(C),className:"px-3 py-2 hover:bg-blue-50 cursor-pointer text-sm",children:[n.jsx("div",{className:"font-medium",children:C.company_name}),C.contact_person&&n.jsx("div",{className:"text-xs text-gray-500",children:C.contact_person})]},C.id)),l.length===0&&n.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No customers found"})]}),n.jsxs("button",{type:"button",onClick:()=>x(!0),className:"mt-1 text-xs text-blue-600 hover:text-blue-700 flex items-center gap-1",children:[n.jsx(Pr,{className:"w-3 h-3"}),"Add New Customer"]})]})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Contact Person"}),n.jsx("input",{type:"text",value:g.contact_person,onChange:C=>y({...g,contact_person:C.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Name"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Email"}),n.jsx("input",{type:"text",value:g.contact_email,onChange:C=>y({...g,contact_email:C.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"email@example.com or multiple: email1@example.com, email2@example.com"}),n.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"Use comma (,) or semicolon (;) to separate multiple emails"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Phone"}),n.jsx("input",{type:"tel",value:g.contact_phone,onChange:C=>y({...g,contact_phone:C.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"+62 xxx"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Mail Subject"}),n.jsx("input",{type:"text",value:g.mail_subject,onChange:C=>y({...g,mail_subject:C.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Email subject line"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:"Customer Requested"}),n.jsxs("div",{className:"grid grid-cols-5 gap-3",children:[n.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:g.price_required,onChange:C=>y({...g,price_required:C.target.checked}),className:"w-4 h-4 rounded border-gray-300"}),n.jsx("span",{className:"text-xs text-gray-700",children:"Price"})]}),n.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:g.coa_required,onChange:C=>y({...g,coa_required:C.target.checked}),className:"w-4 h-4 rounded border-gray-300"}),n.jsx("span",{className:"text-xs text-gray-700",children:"COA"})]}),n.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:g.sample_required,onChange:C=>y({...g,sample_required:C.target.checked}),className:"w-4 h-4 rounded border-gray-300"}),n.jsx("span",{className:"text-xs text-gray-700",children:"Sample"})]}),n.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:g.agency_letter_required,onChange:C=>y({...g,agency_letter_required:C.target.checked}),className:"w-4 h-4 rounded border-gray-300"}),n.jsx("span",{className:"text-xs text-gray-700",children:"Agency Letter"})]}),n.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:g.others_required,onChange:C=>y({...g,others_required:C.target.checked}),className:"w-4 h-4 rounded border-gray-300"}),n.jsx("span",{className:"text-xs text-gray-700",children:"Others"})]})]})]}),n.jsxs("div",{className:"border-t border-gray-200 pt-3",children:[n.jsx("h3",{className:"text-xs font-semibold text-gray-700 mb-2",children:"Pricing"}),n.jsxs("div",{className:"grid grid-cols-6 gap-2",children:[(s==null?void 0:s.role)==="admin"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"col-span-2",children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Purchase Price"}),n.jsx("input",{type:"text",value:g.purchase_price,onChange:C=>y({...g,purchase_price:C.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"100.00"})]}),n.jsxs("div",{className:"col-span-1",children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Currency"}),n.jsxs("select",{value:g.purchase_price_currency,onChange:C=>y({...g,purchase_price_currency:C.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"USD",children:"USD"}),n.jsx("option",{value:"IDR",children:"IDR"})]})]})]}),n.jsxs("div",{className:(s==null?void 0:s.role)==="admin"?"col-span-2":"col-span-4",children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Offered Price"}),n.jsx("input",{type:"text",value:g.offered_price,onChange:C=>y({...g,offered_price:C.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"150.00"})]}),n.jsxs("div",{className:(s==null?void 0:s.role)==="admin"?"col-span-1":"col-span-2",children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Currency"}),n.jsxs("select",{value:g.offered_price_currency,onChange:C=>y({...g,offered_price_currency:C.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"USD",children:"USD"}),n.jsx("option",{value:"IDR",children:"IDR"})]})]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Delivery Date"}),n.jsx("input",{type:"date",value:g.delivery_date,onChange:C=>y({...g,delivery_date:C.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Delivery Terms"}),n.jsxs("select",{value:g.delivery_terms,onChange:C=>y({...g,delivery_terms:C.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"",children:"Select..."}),n.jsx("option",{value:"FOB Jakarta",children:"FOB Jakarta"}),n.jsx("option",{value:"CIF Jakarta",children:"CIF Jakarta"}),n.jsx("option",{value:"FOB Surabaya",children:"FOB Surabaya"}),n.jsx("option",{value:"CIF Surabaya",children:"CIF Surabaya"}),n.jsx("option",{value:"FOB Semarang",children:"FOB Semarang"}),n.jsx("option",{value:"CIF Semarang",children:"CIF Semarang"}),n.jsx("option",{value:"EXW",children:"EXW"}),n.jsx("option",{value:"DDP",children:"DDP"}),n.jsx("option",{value:"DAP",children:"DAP"}),n.jsx("option",{value:"CFR",children:"CFR"}),n.jsx("option",{value:"FCA",children:"FCA"})]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"ACE ERP No"}),n.jsx("input",{type:"text",value:g.aceerp_no,onChange:C=>y({...g,aceerp_no:C.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Optional"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Pipeline Status"}),n.jsxs("select",{value:g.pipeline_status,onChange:C=>y({...g,pipeline_status:C.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"new",children:"New"}),n.jsx("option",{value:"contacted",children:"Contacted"}),n.jsx("option",{value:"qualified",children:"Qualified"}),n.jsx("option",{value:"proposal",children:"Proposal"}),n.jsx("option",{value:"negotiation",children:"Negotiation"}),n.jsx("option",{value:"won",children:"Won"}),n.jsx("option",{value:"lost",children:"Lost"})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Remarks"}),n.jsx("textarea",{value:g.remarks,onChange:C=>y({...g,remarks:C.target.value}),rows:2,className:"w-full px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Customer notes, special requirements..."})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Internal Notes"}),n.jsx("textarea",{value:g.internal_notes,onChange:C=>y({...g,internal_notes:C.target.value}),rows:2,className:"w-full px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Private notes (not visible to customer)..."})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-3 border-t border-gray-200 sticky bottom-0 bg-white",children:[n.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm border border-gray-300 rounded-lg hover:bg-gray-50 transition",disabled:p,children:"Cancel"}),n.jsx("button",{type:"submit",className:"px-4 py-2 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition disabled:opacity-50",disabled:p,children:p?"Saving...":a?"Update Inquiry":"Add Inquiry"})]})]}),A&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 w-full max-w-md max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold",children:"Add New Customer"}),n.jsx("button",{onClick:()=>x(!1),className:"text-gray-400 hover:text-gray-600",children:n.jsx(wr,{className:"w-5 h-5"})})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Company Name ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:v.company_name,onChange:C=>_({...v,company_name:C.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Company name"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Contact Person"}),n.jsx("input",{type:"text",value:v.contact_person,onChange:C=>_({...v,contact_person:C.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Contact name"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Email"}),n.jsx("input",{type:"text",value:v.email,onChange:C=>_({...v,email:C.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"email@example.com"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Phone"}),n.jsx("input",{type:"tel",value:v.phone,onChange:C=>_({...v,phone:C.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"+62 xxx"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Country"}),n.jsx("input",{type:"text",value:v.country,onChange:C=>_({...v,country:C.target.value}),className:"w-full h-9 px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Indonesia"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Address"}),n.jsx("textarea",{value:v.address,onChange:C=>_({...v,address:C.target.value}),rows:2,className:"w-full px-3 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Full address"})]})]}),n.jsxs("div",{className:"flex justify-end gap-3 mt-4",children:[n.jsx("button",{onClick:()=>x(!1),className:"px-4 py-2 text-sm border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),n.jsx("button",{onClick:B,className:"px-4 py-2 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:"Add Customer"})]})]})})]})}function Sue({isOpen:e,matches:t,searchTerm:r,onSelect:a,onCreateNew:s,onCancel:i,inquiryCounts:o={}}){const[l,c]=Q.useState(null),d=()=>{const h=t.find(A=>A.customer.id===l);h&&a(h.customer)},u=h=>{switch(h){case"high":return"bg-green-100 text-green-800";case"medium":return"bg-yellow-100 text-yellow-800";case"low":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}},f=h=>{switch(h){case"exact":return"Exact Match";case"startsWith":return"Starts With";case"contains":return"Contains";case"fuzzy":return"Similar Name";default:return"Match"}};return n.jsx(Ot,{isOpen:e,onClose:i,title:"Select Existing Customer",children:n.jsxs("div",{className:"space-y-4",children:[n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:n.jsxs("div",{className:"flex items-start",children:[n.jsx(En,{className:"h-5 w-5 text-blue-600 mr-2 mt-0.5 flex-shrink-0"}),n.jsxs("div",{children:[n.jsxs("p",{className:"text-sm text-blue-900 font-medium",children:["We found ",t.length," existing customer",t.length!==1?"s":"",' similar to "',r,'"']}),n.jsx("p",{className:"text-xs text-blue-700 mt-1",children:"Please select the correct customer or create a new one"})]})]})}),n.jsx("div",{className:"max-h-96 overflow-y-auto space-y-2",children:t.map(h=>{const A=o[h.customer.id]||0,x=l===h.customer.id;return n.jsx("div",{onClick:()=>c(h.customer.id),className:`border rounded-lg p-4 cursor-pointer transition-all ${x?"border-blue-500 bg-blue-50 shadow-md":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"}`,children:n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("input",{type:"radio",checked:x,onChange:()=>c(h.customer.id),className:"h-4 w-4 text-blue-600"}),n.jsx("h3",{className:"font-semibold text-gray-900",children:h.customer.company_name}),n.jsxs("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${u(h.confidence)}`,children:[f(h.matchType)," (",h.score,"%)"]})]}),n.jsxs("div",{className:"ml-6 space-y-1",children:[h.customer.contact_person&&n.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[n.jsx(vo,{className:"h-4 w-4 mr-2"}),h.customer.contact_person]}),h.customer.email&&n.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[n.jsx(ua,{className:"h-4 w-4 mr-2"}),h.customer.email]}),h.customer.phone&&n.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[n.jsx(Ul,{className:"h-4 w-4 mr-2"}),h.customer.phone]}),n.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[n.jsx(ja,{className:"h-4 w-4 mr-2"}),A," ",A===1?"inquiry":"inquiries"," on record"]})]})]}),x&&n.jsx(Zr,{className:"h-6 w-6 text-blue-600 flex-shrink-0"})]})},h.customer.id)})}),n.jsx("div",{className:"border-t pt-4",children:n.jsxs("button",{onClick:s,className:"w-full text-left px-4 py-3 border border-dashed border-gray-300 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition-colors",children:[n.jsxs("div",{className:"flex items-center text-blue-600",children:[n.jsx(vo,{className:"h-5 w-5 mr-2"}),n.jsx("span",{className:"font-medium",children:"None of these - Create New Customer"})]}),n.jsxs("p",{className:"text-xs text-gray-500 ml-7 mt-1",children:['Create a new customer record for "',r,'"']})]})}),n.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t",children:[n.jsx("button",{type:"button",onClick:i,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancel"}),n.jsx("button",{type:"button",onClick:d,disabled:!l,className:`px-4 py-2 rounded-lg text-white ${l?"bg-blue-600 hover:bg-blue-700":"bg-gray-300 cursor-not-allowed"}`,children:"Select Customer"})]})]})})}function Bue({isOpen:e,initialData:t,onConfirm:r,onCancel:a}){const[s,i]=Q.useState({company_name:t.company_name||"",contact_person:t.contact_person||"",email:t.email||"",phone:t.phone||"",address:t.address||"",city:t.city||"Jakarta Pusat",country:t.country||"Indonesia",pbf_license:t.pbf_license||"",npwp:t.npwp||""}),[o,l]=Q.useState(!1),[c,d]=Q.useState({}),u=()=>{const A={};return s.company_name.trim()||(A.company_name="Company name is required"),s.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s.email)&&(A.email="Invalid email format"),d(A),Object.keys(A).length===0},f=async()=>{if(u()){l(!0);try{await r(s)}catch(A){console.error("Error creating customer:",A),alert("Failed to create customer. Please try again.")}finally{l(!1)}}},h=(A,x)=>{i(p=>({...p,[A]:x})),c[A]&&d(p=>{const b={...p};return delete b[A],b})};return n.jsx(Ot,{isOpen:e,onClose:a,title:"Create New Customer",children:n.jsxs("div",{className:"space-y-4",children:[n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:n.jsxs("div",{className:"flex items-start",children:[n.jsx(En,{className:"h-5 w-5 text-blue-600 mr-2 mt-0.5 flex-shrink-0"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-blue-900 font-medium",children:"Creating a new customer record"}),n.jsx("p",{className:"text-xs text-blue-700 mt-1",children:"Please verify the information below before creating"})]})]})}),n.jsxs("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[n.jsx(_n,{className:"inline h-4 w-4 mr-1"}),"Company Name *"]}),n.jsx("input",{type:"text",value:s.company_name,onChange:A=>h("company_name",A.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 ${c.company_name?"border-red-500":"border-gray-300"}`,placeholder:"Enter company name"}),c.company_name&&n.jsx("p",{className:"text-xs text-red-600 mt-1",children:c.company_name})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[n.jsx(Ao,{className:"inline h-4 w-4 mr-1"}),"Contact Person"]}),n.jsx("input",{type:"text",value:s.contact_person,onChange:A=>h("contact_person",A.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Enter contact person name"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[n.jsx(ua,{className:"inline h-4 w-4 mr-1"}),"Email"]}),n.jsx("input",{type:"email",value:s.email,onChange:A=>h("email",A.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 ${c.email?"border-red-500":"border-gray-300"}`,placeholder:"Enter email address"}),c.email&&n.jsx("p",{className:"text-xs text-red-600 mt-1",children:c.email})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[n.jsx(Ul,{className:"inline h-4 w-4 mr-1"}),"Phone"]}),n.jsx("input",{type:"text",value:s.phone,onChange:A=>h("phone",A.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Enter phone number"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[n.jsx(j7,{className:"inline h-4 w-4 mr-1"}),"Address"]}),n.jsx("textarea",{value:s.address,onChange:A=>h("address",A.target.value),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Enter address"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"City"}),n.jsx("select",{value:s.city,onChange:A=>h("city",A.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:DE.map(A=>n.jsx("option",{value:A,children:A},A))})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[n.jsx(jE,{className:"inline h-4 w-4 mr-1"}),"Country"]}),n.jsx("input",{type:"text",value:s.country,onChange:A=>h("country",A.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Enter country"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"PBF License"}),n.jsx("input",{type:"text",value:s.pbf_license,onChange:A=>h("pbf_license",A.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Enter PBF license number"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"NPWP"}),n.jsx("input",{type:"text",value:s.npwp,onChange:A=>h("npwp",A.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Enter NPWP number"})]})]}),n.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t",children:[n.jsx("button",{type:"button",onClick:a,disabled:o,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 disabled:opacity-50",children:"Cancel"}),n.jsx("button",{type:"button",onClick:f,disabled:o,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:o?"Creating...":"Create Customer"})]})]})})}function Eue({isOpen:e,customerName:t,changedFields:r,oldValues:a,newValues:s,onUpdateCustomer:i,onKeepExisting:o,onCancel:l}){const c=d=>({email:"Email",phone:"Phone",contact_person:"Contact Person",address:"Address",city:"City",country:"Country"})[d]||d;return n.jsx(Ot,{isOpen:e,onClose:l,title:"Update Customer Information?",children:n.jsxs("div",{className:"space-y-4",children:[n.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:n.jsxs("div",{className:"flex items-start",children:[n.jsx(En,{className:"h-5 w-5 text-yellow-600 mr-2 mt-0.5 flex-shrink-0"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-yellow-900 font-medium",children:"Contact details differ from master record"}),n.jsxs("p",{className:"text-xs text-yellow-700 mt-1",children:["The information you entered for ",n.jsx("span",{className:"font-semibold",children:t})," differs from what's stored in the customer database."]})]})]})}),n.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden",children:[n.jsx("div",{className:"bg-gray-50 px-4 py-2 border-b border-gray-200",children:n.jsx("h4",{className:"text-sm font-semibold text-gray-700",children:"Changes Detected"})}),n.jsx("div",{className:"divide-y divide-gray-200",children:r.map(d=>n.jsxs("div",{className:"px-4 py-3",children:[n.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase mb-2",children:c(d)}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("div",{className:"flex-1 bg-red-50 border border-red-200 rounded px-3 py-2",children:[n.jsx("div",{className:"text-xs text-red-600 font-medium mb-0.5",children:"Current"}),n.jsx("div",{className:"text-sm text-gray-900",children:a[d]||n.jsx("span",{className:"text-gray-400 italic",children:"Not set"})})]}),n.jsx(i7,{className:"h-5 w-5 text-gray-400 flex-shrink-0"}),n.jsxs("div",{className:"flex-1 bg-green-50 border border-green-200 rounded px-3 py-2",children:[n.jsx("div",{className:"text-xs text-green-600 font-medium mb-0.5",children:"New"}),n.jsx("div",{className:"text-sm text-gray-900",children:s[d]||n.jsx("span",{className:"text-gray-400 italic",children:"Not set"})})]})]})]},d))})]}),n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:n.jsxs("p",{className:"text-xs text-blue-900",children:[n.jsx("strong",{children:"Tip:"})," Updating the customer record will apply these changes to all future inquiries for this customer."]})}),n.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-2 pt-4 border-t",children:[n.jsx("button",{type:"button",onClick:l,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancel"}),n.jsx("button",{type:"button",onClick:o,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Keep Existing"}),n.jsx("button",{type:"button",onClick:i,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Update Customer Record"})]})]})})}function vx(e){return e?e.toLowerCase().trim().replace(/\s+/g," ").replace(/\b(ltd|limited|inc|incorporated|pvt|private|llc|corp|corporation|co|company|pte|sdn bhd|tbk|pt)\b\.?/gi,"").replace(/[^\w\s]/g,"").trim():""}function Fue(e,t){const r=e.length,a=t.length,s=[];if(r===0)return a;if(a===0)return r;for(let i=0;i<=r;i++)s[i]=[i];for(let i=0;i<=a;i++)s[0][i]=i;for(let i=1;i<=r;i++)for(let o=1;o<=a;o++){const l=e[i-1]===t[o-1]?0:1;s[i][o]=Math.min(s[i-1][o]+1,s[i][o-1]+1,s[i-1][o-1]+l)}return s[r][a]}function Tue(e,t){const r=vx(e),a=vx(t);if(r===a)return 1;const s=Math.max(r.length,a.length);return s===0?1:1-Fue(r,a)/s}function LS(e){if(!e)return"";const t=e.match(/@(.+)$/);return t?t[1].toLowerCase():""}function dD(e,t){if(!e||!t.length)return[];const r=vx(e),a=e.toLowerCase().trim(),s=[];for(const i of t){const o=vx(i.company_name),l=i.company_name.toLowerCase().trim();let c="fuzzy",d=0;if(o===r)c="exact",d=100;else if(l.startsWith(a))c="startsWith",d=90-(l.length-a.length);else if(l.includes(a))c="contains",d=75-l.indexOf(a)*2;else{const h=Tue(e,i.company_name);if(h>=.6)d=Math.round(h*70);else continue}(i.email&&e.includes("@")?LS(i.email)===LS(e):!1)&&(d+=15);let f;d>=90?f="high":d>=70?f="medium":f="low",s.push({customer:i,score:Math.min(d,100),matchType:c,confidence:f})}return s.sort((i,o)=>o.score-i.score)}function Iue(e,t){const r=dD(e,t);return r.length>0&&r[0].score>=90?r[0]:null}function Due(e,t){const r=[],a={},s={},i=c=>(c==null?void 0:c.toLowerCase().trim())||"",o=c=>(c==null?void 0:c.replace(/\D/g,""))||"",l=c=>(c==null?void 0:c.trim())||"";if(e.contact_email&&t.email){const c=i(e.contact_email),d=i(t.email);c!==d&&c!==""&&(r.push("email"),a.email=t.email,s.email=e.contact_email)}if(e.contact_phone&&t.phone){const c=o(e.contact_phone),d=o(t.phone);c!==d&&c!==""&&(r.push("phone"),a.phone=t.phone,s.phone=e.contact_phone)}if(e.contact_person&&t.contact_person){const c=l(e.contact_person),d=l(t.contact_person);c!==d&&c!==""&&(r.push("contact_person"),a.contact_person=t.contact_person,s.contact_person=e.contact_person)}return{hasChanges:r.length>0,changedFields:r,oldValues:a,newValues:s}}function Lue(){var H;const{profile:e}=Cr(),[t,r]=Q.useState([]),[a,s]=Q.useState(!0),[i,o]=Q.useState(null),[l,c]=Q.useState("table"),[d,u]=Q.useState(!1),[f,h]=Q.useState(null),[A,x]=Q.useState(!1),[p,b]=Q.useState(null),[m,g]=Q.useState(null),[y,v]=Q.useState([]),[_,j]=Q.useState(!1),[N,B]=Q.useState(!1),[E,C]=Q.useState(!1),[k,w]=Q.useState(null),[T,R]=Q.useState({});Q.useEffect(()=>{q()},[]);const q=async()=>{try{o(null);const{data:V,error:W}=await Z.from("crm_inquiries").select("*, user_profiles!assigned_to(full_name)").neq("pipeline_status","lost").order("created_at",{ascending:!1});if(W)throw W;r(V||[])}catch{o("Failed to load inquiries. Please try again.")}finally{s(!1)}},z=async()=>{try{const{data:V,error:W}=await Z.from("customers").select("id, company_name, contact_person, email, phone, country, address, city").eq("is_active",!0);if(W)throw W;return V||[]}catch(V){return console.error("Error loading customers:",V),[]}},ee=async V=>{try{const{data:W,error:M}=await Z.from("crm_inquiries").select("customer_id").in("customer_id",V);if(M)throw M;const se={};W==null||W.forEach(K=>{K.customer_id&&(se[K.customer_id]=(se[K.customer_id]||0)+1)}),R(se)}catch(W){console.error("Error loading inquiry counts:",W)}},Y=async V=>{if(V.customer_id){const K=(await z()).find(he=>he.id===V.customer_id);if(K){const he=Due({contact_email:V.contact_email,contact_phone:V.contact_phone,contact_person:V.contact_person},K);if(he.hasChanges)return w({...he,customer:K}),g(V),C(!0),!1}return!0}const W=await z(),M=dD(V.company_name,W);if(M.length>0){const se=Iue(V.company_name,W);return se&&se.score>=95?(V.customer_id=se.customer.id,Y(V)):(v(M),g(V),await ee(M.map(K=>K.customer.id)),j(!0),!1)}else return g(V),B(!0),!1},G=V=>{const W={...V},M=["delivery_date","inquiry_date"],se=["purchase_price","offered_price"];return M.forEach(K=>{(W[K]===""||W[K]===void 0)&&(W[K]=null)}),se.forEach(K=>{W[K]===""||W[K]===void 0?W[K]=null:W[K]!==null&&(W[K]=parseFloat(W[K]))}),W},re=async V=>{try{const{data:{user:W}}=await Z.auth.getUser();if(!W)throw new Error("Not authenticated");if(!f){if(!await Y(V))return;if(!V.customer_id){alert("Customer selection is required. Please select or create a customer.");return}}if(f){const{products:M,is_multi_product:se,...K}=V,he=G({...K,specification:V.specification||null,purchase_price:V.purchase_price?parseFloat(V.purchase_price):null,offered_price:V.offered_price?parseFloat(V.offered_price):null}),{error:ne}=await Z.from("crm_inquiries").update(he).eq("id",f.id);if(ne)throw ne}else{const{products:M,is_multi_product:se,...K}=V;if(se&&M&&M.length>0){const he=M.map(ce=>G({...K,product_name:ce.productName||ce.product_name,specification:ce.specification||null,quantity:ce.quantity,supplier_name:ce.supplierName||K.supplier_name||null,supplier_country:ce.supplierCountry||K.supplier_country||null,delivery_date:ce.deliveryDate||null,delivery_terms:ce.deliveryTerms||null,inquiry_date:new Date().toISOString().split("T")[0],assigned_to:W.id,created_by:W.id,purchase_price:null,offered_price:null,is_multi_product:!1,has_items:!1})),{data:ne,error:te}=await Z.from("crm_inquiries").insert(he).select();if(te)throw te;if(ne&&ne.length>0){const ce=ne[0].inquiry_number;for(let _e=0;_e<ne.length;_e++)await Z.from("crm_inquiries").update({inquiry_number:`${ce}.${_e+1}`}).eq("id",ne[_e].id)}}else{const he=G({...K,specification:V.specification||null,inquiry_date:new Date().toISOString().split("T")[0],assigned_to:W.id,created_by:W.id,purchase_price:V.purchase_price?parseFloat(V.purchase_price):null,offered_price:V.offered_price?parseFloat(V.offered_price):null,is_multi_product:!1,has_items:!1}),{error:ne}=await Z.from("crm_inquiries").insert([he]);if(ne)throw ne}}u(!1),h(null),q()}catch(W){throw console.error("Error saving inquiry:",W),alert("Failed to save inquiry. Please try again."),W}},U=V=>{h(V),u(!0)},S=V=>{m&&(m.customer_id=V.id,j(!1),re(m))},D=async V=>{try{const{data:W,error:M}=await Z.from("customers").insert({...V,is_active:!0}).select().single();if(M)throw M;m&&(m.customer_id=W.id,B(!1),re(m))}catch(W){throw console.error("Error creating customer:",W),W}},L=async()=>{if(!(!k||!k.customer))try{const V={};k.changedFields.forEach(M=>{V[M]=k.newValues[M]});const{error:W}=await Z.from("customers").update(V).eq("id",k.customer.id);if(W)throw W;C(!1),m&&re(m)}catch(V){console.error("Error updating customer:",V),alert("Failed to update customer. Please try again.")}},P=()=>{C(!1),m&&re(m)},I=(e==null?void 0:e.role)==="admin"||(e==null?void 0:e.role)==="sales";return n.jsx(Un,{children:n.jsxs("div",{className:"space-y-4",children:[n.jsx("div",{className:"flex items-center",children:n.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"CRM - Inquiry Management"})}),n.jsxs("div",{className:"bg-white rounded-lg shadow",children:[n.jsx("div",{className:"border-b border-gray-200",children:n.jsxs("div",{className:"flex overflow-x-auto",children:[n.jsxs("button",{onClick:()=>c("email"),className:`flex items-center gap-2 px-6 py-4 border-b-2 transition whitespace-nowrap ${l==="email"?"border-blue-500 text-blue-600 font-medium":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[n.jsx(kE,{className:"w-5 h-5"}),"Email Inbox"]}),n.jsxs("button",{onClick:()=>c("table"),className:`flex items-center gap-2 px-6 py-4 border-b-2 transition whitespace-nowrap ${l==="table"?"border-blue-500 text-blue-600 font-medium":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[n.jsx(F7,{className:"w-5 h-5"}),"Table View"]}),n.jsxs("button",{onClick:()=>c("pipeline"),className:`flex items-center gap-2 px-6 py-4 border-b-2 transition whitespace-nowrap ${l==="pipeline"?"border-blue-500 text-blue-600 font-medium":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[n.jsx(N7,{className:"w-5 h-5"}),"Pipeline"]}),n.jsxs("button",{onClick:()=>c("calendar"),className:`flex items-center gap-2 px-6 py-4 border-b-2 transition whitespace-nowrap ${l==="calendar"?"border-blue-500 text-blue-600 font-medium":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[n.jsx(ja,{className:"w-5 h-5"}),"Calendar"]}),n.jsxs("button",{onClick:()=>c("customers"),className:`flex items-center gap-2 px-6 py-4 border-b-2 transition whitespace-nowrap ${l==="customers"?"border-blue-500 text-blue-600 font-medium":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[n.jsx(vo,{className:"w-5 h-5"}),"Customers"]}),n.jsxs("button",{onClick:()=>c("activities"),className:`flex items-center gap-2 px-6 py-4 border-b-2 transition whitespace-nowrap ${l==="activities"?"border-blue-500 text-blue-600 font-medium":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[n.jsx(a7,{className:"w-5 h-5"}),"Activities"]}),n.jsxs("button",{onClick:()=>c("appointments"),className:`flex items-center gap-2 px-6 py-4 border-b-2 transition whitespace-nowrap ${l==="appointments"?"border-blue-500 text-blue-600 font-medium":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[n.jsx(da,{className:"w-5 h-5"}),"Appointments"]}),n.jsxs("button",{onClick:()=>c("archive"),className:`flex items-center gap-2 px-6 py-4 border-b-2 transition whitespace-nowrap ${l==="archive"?"border-blue-500 text-blue-600 font-medium":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[n.jsx(vE,{className:"w-5 h-5"}),"Archive"]})]})}),n.jsxs("div",{className:"p-6",children:[i&&n.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4 flex items-center justify-between",children:[n.jsx("p",{className:"text-red-700",children:i}),n.jsx("button",{onClick:q,className:"px-3 py-1 bg-red-600 text-white rounded-lg hover:bg-red-700 transition text-sm",children:"Retry"})]}),l==="email"&&n.jsx(fZ,{}),l==="table"&&n.jsx(yue,{inquiries:t,onRefresh:q,canManage:I,onAddInquiry:()=>{h(null),u(!0)}}),l==="pipeline"&&n.jsx(bue,{canManage:I,onInquiryClick:V=>U(V)}),l==="calendar"&&n.jsx(vue,{onReminderCreated:q}),l==="customers"&&n.jsx(Nue,{}),l==="activities"&&n.jsx(jue,{onActivityLogged:q}),l==="appointments"&&n.jsx(kue,{onAppointmentCreated:q}),l==="archive"&&n.jsx(Cue,{canManage:I,onRefresh:q})]})]}),n.jsx(Ot,{isOpen:d,onClose:()=>{u(!1),h(null)},title:f?"Edit Inquiry":"Add New Inquiry",children:n.jsx(cD,{onSubmit:re,onCancel:()=>{u(!1),h(null)},initialData:f,isEditing:!!f})}),n.jsx(Ot,{isOpen:A,onClose:()=>{x(!1),b(null)},title:"Send Email",children:n.jsx(_ue,{inquiry:p,onClose:()=>{x(!1),b(null)},onSent:()=>{q()}})}),n.jsx(Sue,{isOpen:_,matches:y,searchTerm:(m==null?void 0:m.company_name)||"",onSelect:S,onCreateNew:()=>{j(!1),B(!0)},onCancel:()=>{j(!1),g(null)},inquiryCounts:T}),n.jsx(Bue,{isOpen:N,initialData:{company_name:(m==null?void 0:m.company_name)||"",contact_person:(m==null?void 0:m.contact_person)||"",email:(m==null?void 0:m.contact_email)||"",phone:(m==null?void 0:m.contact_phone)||"",country:(m==null?void 0:m.supplier_country)||"Indonesia"},onConfirm:D,onCancel:()=>{B(!1),g(null)}}),n.jsx(Eue,{isOpen:E,customerName:((H=k==null?void 0:k.customer)==null?void 0:H.company_name)||"",changedFields:(k==null?void 0:k.changedFields)||[],oldValues:(k==null?void 0:k.oldValues)||{},newValues:(k==null?void 0:k.newValues)||{},onUpdateCustomer:L,onKeepExisting:P,onCancel:()=>{C(!1),g(null)}})]})})}function Pue({onEmailSelect:e,selectedEmailId:t}){const[r,a]=Q.useState([]),[s,i]=Q.useState(!0),[o,l]=Q.useState(!1),[c,d]=Q.useState(null),u=Q.useCallback(async()=>{try{const{data:b,error:m}=await Z.from("crm_email_inbox").select("*").eq("is_processed",!1).order("received_date",{ascending:!1}).limit(50);if(m)throw m;a(b||[])}catch(b){console.error("Error loading emails:",b)}finally{i(!1),l(!1)}},[]),f=Q.useCallback(async()=>{l(!0);try{const{data:{session:b}}=await Z.auth.getSession();if(!b){console.error("Not authenticated"),l(!1);return}const m="https://dkrtsqienlhpouohmfki.supabase.co/functions/v1/sync-gmail-emails",g=new AbortController,y=setTimeout(()=>g.abort(),12e4),v=await fetch(m,{method:"POST",headers:{Authorization:`Bearer ${b.access_token}`,"Content-Type":"application/json"},signal:g.signal});if(clearTimeout(y),!v.ok)throw new Error(`Sync failed: ${v.status}`);await v.json(),await u()}catch(b){console.error("Error syncing emails:",b),await u()}finally{l(!1)}},[u]);Q.useEffect(()=>{u();const b=Z.channel("email_inbox_changes").on("postgres_changes",{event:"*",schema:"public",table:"crm_email_inbox"},()=>{u()}).subscribe(),m=setInterval(()=>{f()},6e5);return()=>{b.unsubscribe(),clearInterval(m)}},[u,f]),Q.useEffect(()=>{(async()=>{const m=sessionStorage.getItem("pendingEmailForInquiry");if(m){console.log("[EmailListPanel] Found pending email in sessionStorage"),sessionStorage.removeItem("pendingEmailForInquiry"),document.body.style.cursor="wait";try{const g=JSON.parse(m);console.log("[EmailListPanel] Parsed email data:",g);const{data:{session:y}}=await Z.auth.getSession();if(!y)throw console.error("[EmailListPanel] No session found"),new Error("Not authenticated");try{const{data:N}=await Z.from("crm_inquiries").select("id, inquiry_number, product_name").eq("mail_subject",g.subject).maybeSingle();if(N){if(!confirm(`This email has already been processed as Inquiry #${N.inquiry_number} (${N.product_name}).

Do you want to reprocess it?`)){console.log("[EmailListPanel] User declined to reprocess existing inquiry"),sessionStorage.removeItem("pendingEmailForCommandCenter");return}console.log("[EmailListPanel] User confirmed reprocessing existing inquiry")}}catch(N){console.warn("[EmailListPanel] Could not check for duplicates (continuing anyway):",N)}console.log("[EmailListPanel] Calling parse-pharma-email edge function");const v="https://dkrtsqienlhpouohmfki.supabase.co/functions/v1/parse-pharma-email";console.log("[EmailListPanel] API URL:",v),console.log("[EmailListPanel] Request body:",{emailSubject:g.subject,emailBody:g.body.substring(0,100)+"...",fromEmail:g.fromEmail,fromName:g.fromName});const _=await fetch(v,{method:"POST",headers:{Authorization:`Bearer ${y.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({emailSubject:g.subject,emailBody:g.body,fromEmail:g.fromEmail,fromName:g.fromName})});if(console.log("[EmailListPanel] Response status:",_.status),!_.ok){const N=await _.text();throw console.error("[EmailListPanel] Response error:",N),new Error(`Edge function returned ${_.status}: ${N}`)}const j=await _.json();if(console.log("[EmailListPanel] Parse result:",j),j.success||j.fallbackData){const N={id:"gmail-"+Date.now(),from_email:g.fromEmail,from_name:g.fromName,subject:g.subject,body:g.body,received_date:g.date,is_processed:!1,is_inquiry:!1,parsed_data:null,converted_to_inquiry:null};console.log("[EmailListPanel] Calling onEmailSelect with mock email"),e(N,j.data||j.fallbackData)}else console.error("[EmailListPanel] Parse failed:",j.error),alert("Failed to parse email from Gmail: "+j.error)}catch(g){console.error("[EmailListPanel] Error processing pending email:",g),alert(`Failed to process email: ${g instanceof Error?g.message:String(g)}`)}finally{document.body.style.cursor="default"}}else console.log("[EmailListPanel] No pending email found in sessionStorage")})()},[e]);const h=async b=>{d(b.id),document.body.style.cursor="wait";try{const{data:{session:m}}=await Z.auth.getSession();if(!m)throw new Error("Not authenticated");const v=await(await fetch("https://dkrtsqienlhpouohmfki.supabase.co/functions/v1/parse-pharma-email",{method:"POST",headers:{Authorization:`Bearer ${m.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({emailSubject:b.subject,emailBody:b.body,fromEmail:b.from_email,fromName:b.from_name})})).json();v.success?e(b,v.data):v.fallbackData?e(b,v.fallbackData):(alert("Failed to parse email: "+v.error),e(b,null))}catch(m){console.error("Error parsing email:",m),alert("Failed to parse email. Please try again.")}finally{d(null),document.body.style.cursor="default"}},A=b=>{var _,j;const m=((_=b.body)==null?void 0:_.toLowerCase())||"",g=((j=b.subject)==null?void 0:j.toLowerCase())||"",y=m+" "+g,v=[];return(y.includes("price")||y.includes("harga")||y.includes("quotation")||y.includes("quote"))&&v.push({icon:hn,color:"text-green-600",label:"Price"}),(y.includes("coa")||y.includes("certificate")||y.includes("analysis"))&&v.push({icon:Zt,color:"text-blue-600",label:"COA"}),(y.includes("msds")||y.includes("safety")||y.includes("data sheet"))&&v.push({icon:Zt,color:"text-orange-600",label:"MSDS"}),(y.includes("sample")||y.includes("sampel"))&&v.push({icon:EE,color:"text-purple-600",label:"Sample"}),v},x=b=>{const g=(b.body||"").split(`
`).filter(j=>j.trim().length>0);let y="",v="",_="";for(const j of g.slice(0,20)){const N=j.toLowerCase();if(!y&&(N.includes("product")||N.includes("material")||N.includes("item"))&&(y=j.replace(/^[^:]+:/,"").trim().substring(0,50)),!v&&(N.includes("qty")||N.includes("quantity")||N.includes("kg")||N.includes("mt"))){const B=j.match(/\d+\s*(kg|mt|ton|units?|pcs)/i);B&&(v=B[0])}!_&&(N.includes("supplier")||N.includes("manufacturer")||N.includes("origin"))&&(_=j.replace(/^[^:]+:/,"").trim().substring(0,30))}return{product:y,quantity:v,supplier:_}},p=b=>{const m=(b.subject+" "+b.body).toLowerCase();return m.includes("urgent")||m.includes("asap")||m.includes("segera")||m.includes("mendesak")};return s?n.jsx("div",{className:"flex items-center justify-center h-full",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),n.jsx("p",{className:"text-gray-600",children:"Loading emails..."})]})}):n.jsxs("div",{className:"flex flex-col h-full bg-white border-r border-gray-200",children:[n.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-200 bg-gray-50",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ua,{className:"w-5 h-5 text-blue-600"}),n.jsx("h2",{className:"font-semibold text-gray-900",children:"New Emails"}),n.jsx("span",{className:"px-2 py-0.5 text-xs font-medium bg-blue-100 text-blue-700 rounded-full",children:r.length})]}),n.jsx("button",{onClick:f,disabled:o,className:"p-1.5 hover:bg-gray-200 rounded-lg transition",title:"Refresh emails",children:n.jsx(Hs,{className:`w-4 h-4 text-gray-600 ${o?"animate-spin":""}`})})]}),n.jsx("div",{className:"flex-1 overflow-y-auto",children:r.length===0?n.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center px-4",children:[n.jsx(ua,{className:"w-16 h-16 text-gray-300 mb-4"}),n.jsx("p",{className:"text-gray-600 font-medium",children:"No unprocessed emails"}),n.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"New emails will appear here automatically"})]}):n.jsx("div",{className:"divide-y divide-gray-100",children:r.map(b=>{const m=x(b),g=A(b),y=p(b),v=t===b.id,_=c===b.id;return n.jsxs("div",{onClick:()=>!_&&h(b),className:`p-4 cursor-pointer transition ${v?"bg-blue-50 border-l-4 border-blue-600":"hover:bg-gray-50 border-l-4 border-transparent"} ${_?"opacity-50 cursor-wait":""}`,children:[n.jsxs("div",{className:"flex items-start justify-between mb-2",children:[n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("span",{className:"font-semibold text-gray-900 truncate",children:b.from_name||b.from_email}),y&&n.jsx("span",{className:"flex-shrink-0 px-1.5 py-0.5 text-xs font-bold bg-red-100 text-red-700 rounded",children:"URGENT"})]}),n.jsx("p",{className:"text-xs text-gray-500 truncate",children:b.from_email})]}),_&&n.jsx(vA,{className:"w-5 h-5 text-blue-600 animate-pulse flex-shrink-0 ml-2"})]}),n.jsx("p",{className:"text-sm font-medium text-gray-800 mb-2 line-clamp-1",children:b.subject}),(m.product||m.quantity)&&n.jsxs("div",{className:"space-y-1 mb-2",children:[m.product&&n.jsxs("div",{className:"flex items-start gap-2",children:[n.jsx(Rr,{className:"w-3.5 h-3.5 text-gray-400 mt-0.5 flex-shrink-0"}),n.jsx("span",{className:"text-xs text-gray-600 line-clamp-1",children:m.product})]}),m.quantity&&n.jsx("div",{className:"flex items-center gap-2",children:n.jsx("span",{className:"text-xs font-medium text-blue-600",children:m.quantity})})]}),g.length>0&&n.jsx("div",{className:"flex items-center gap-2 mb-2",children:g.map((j,N)=>n.jsxs("div",{className:"flex items-center gap-1 px-2 py-0.5 bg-gray-100 rounded",title:j.label,children:[n.jsx(j.icon,{className:`w-3 h-3 ${j.color}`}),n.jsx("span",{className:"text-xs text-gray-600",children:j.label})]},N))}),n.jsxs("div",{className:"flex items-center justify-between mt-2",children:[n.jsx("span",{className:"text-xs text-gray-500",children:new Date(b.received_date).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}),!_&&n.jsxs("span",{className:"text-xs text-blue-600 font-medium flex items-center gap-1",children:[n.jsx(vA,{className:"w-3 h-3"}),"AI Parse"]})]})]},b.id)})})})]})}function Oue({email:e,parsedData:t,onSave:r,saving:a}){const[s,i]=Q.useState(!1),[o,l]=Q.useState(null),[c,d]=Q.useState(!1),u=(t==null?void 0:t.products)&&t.products.length>1;Q.useEffect(()=>{var A,x;if(console.log("[InquiryFormPanel] useEffect triggered",{email:e,parsedData:t}),t){let p=t.contactPerson||"",b=t.contactEmail||"";if(typeof p=="object"&&!Array.isArray(p)?p=p.name||"":Array.isArray(p)&&(p=((A=p[0])==null?void 0:A.name)||p[0]||""),typeof b=="object"&&!Array.isArray(b)?b=b.email||"":Array.isArray(b)&&(b=((x=b[0])==null?void 0:x.email)||b[0]||""),typeof b=="string"){b=b.replace(/<[^>]+>/g,"").replace(/\s+/g," ").trim();const y=/([a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,})/g,v=[];let _;for(;(_=y.exec(b))!==null;)v.includes(_[1])||v.push(_[1]);v.length>0&&(b=v.join(", "))}typeof p=="string"&&(p=p.replace(/<[^>]+>/g,"").replace(/\s+/g," ").trim());let m=t.companyName||"";typeof m=="string"&&(m=m.replace(/<[^>]+>/g,"").replace(/\s+/g," ").trim());const g={product_name:t.productName||"",specification:t.specification||"",quantity:t.quantity||"",supplier_name:t.supplierName||"",supplier_country:t.supplierCountry||"",company_name:m,contact_person:p,contact_email:b,contact_phone:t.contactPhone||"",priority:t.urgency||"medium",delivery_date:t.deliveryDateExpected||"",remarks:t.remarks||"",coa_required:u?!0:t.coaRequested||!1,sample_required:t.sampleRequested||!1,price_required:u?!0:t.priceRequested||!0,agency_letter_required:t.agencyLetterRequested||!1,aceerp_no:"",purchase_price:"",purchase_price_currency:"USD",offered_price:"",offered_price_currency:"USD",delivery_terms:"",inquiry_source:"email",mail_subject:(e==null?void 0:e.subject)||"",is_multi_product:u,products:t.products||[]};console.log("[InquiryFormPanel] Setting initialData:",g),l(g),u&&d(!0)}},[t,e,u]);const f=async A=>{const x={inquiryNumber:"",productName:A.product_name,specification:A.specification||"",quantity:A.quantity,supplierName:A.supplier_name||"",supplierCountry:A.supplier_country||"",companyName:A.company_name,contactPerson:A.contact_person||"",contactEmail:A.contact_email||"",contactPhone:A.contact_phone||"",priority:A.priority,purposeIcons:[],deliveryDateExpected:A.delivery_date||"",remarks:A.remarks||"",coaRequested:A.coa_required||!1,msdsRequested:!1,sampleRequested:A.sample_required||!1,priceRequested:A.price_required||!1,agencyLetterRequested:A.agency_letter_required||!1,aceerp_no:A.aceerp_no||"",purchasePrice:A.purchase_price||"",purchasePriceCurrency:A.purchase_price_currency||"USD",offeredPrice:A.offered_price||"",offeredPriceCurrency:A.offered_price_currency||"USD",deliveryDate:A.delivery_date||"",deliveryTerms:A.delivery_terms||"",isMultiProduct:A.is_multi_product||!1,products:A.products||[]};await r(x)},h={high:"text-green-600 bg-green-50 border-green-200",medium:"text-yellow-600 bg-yellow-50 border-yellow-200",low:"text-red-600 bg-red-50 border-red-200"};return!e||!t?n.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center px-8 bg-gray-50",children:[n.jsx(Zt,{className:"w-20 h-20 text-gray-300 mb-4"}),n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Email Selected"}),n.jsx("p",{className:"text-gray-600 max-w-md",children:"Click on an email from the left panel to automatically parse and fill this inquiry form with AI"}),n.jsxs("div",{className:"mt-6 text-sm text-gray-500 space-y-1",children:[n.jsxs("p",{className:"flex items-center gap-2 justify-center",children:[n.jsx(vA,{className:"w-4 h-4 text-blue-500"}),n.jsx("span",{children:"AI extracts product, quantity, company, contact"})]}),n.jsxs("p",{className:"flex items-center gap-2 justify-center",children:[n.jsx(Ss,{className:"w-4 h-4 text-green-500"}),n.jsx("span",{children:"Only inquiry number needs manual input"})]})]})]}):n.jsxs("div",{className:"flex flex-col h-full bg-white",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 bg-gradient-to-r from-blue-50 to-transparent",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Create Inquiry"}),t&&n.jsx("div",{className:`px-3 py-1 rounded-lg text-sm font-medium border ${h[t.confidence]}`,children:n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsx(vA,{className:"w-3.5 h-3.5"}),n.jsxs("span",{children:["AI Confidence: ",t.confidence.toUpperCase()]}),n.jsxs("span",{className:"text-xs",children:["(",Math.round(t.confidenceScore*100),"%)"]})]})})]}),e&&n.jsxs("div",{className:"mt-3 bg-white border border-gray-300 rounded-lg shadow-sm overflow-hidden",children:[n.jsxs("button",{type:"button",onClick:()=>i(!s),className:"w-full flex items-center justify-between px-5 py-3 hover:bg-gray-50 transition border-b border-gray-200",children:[n.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[n.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center flex-shrink-0",children:n.jsx("span",{className:"text-sm font-bold text-blue-700",children:(e.from_name||e.from_email).charAt(0).toUpperCase()})}),n.jsxs("div",{className:"text-left flex-1 min-w-0",children:[n.jsx("p",{className:"text-base font-semibold text-gray-900 truncate",children:e.subject}),n.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[n.jsx("p",{className:"text-sm text-gray-900 font-medium",children:e.from_name||"Unknown"}),n.jsx("span",{className:"text-gray-400 text-xs",children:""}),n.jsxs("p",{className:"text-xs text-gray-500 truncate",children:["<",e.from_email,">"]})]})]})]}),s?n.jsx(Rg,{className:"w-5 h-5 text-gray-500 flex-shrink-0 ml-2"}):n.jsx(Cs,{className:"w-5 h-5 text-gray-500 flex-shrink-0 ml-2"})]}),s&&n.jsxs("div",{className:"bg-white",children:[n.jsx("div",{className:"px-5 py-3 border-b border-gray-100 bg-gray-50",children:n.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide font-semibold",children:new Date(e.received_date).toLocaleString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})})}),n.jsx("div",{className:"px-5 py-4",children:n.jsx(YF,{htmlContent:e.body,className:"max-h-[600px]"})}),n.jsx("div",{className:"px-5 py-3 bg-blue-50 border-t border-blue-100",children:n.jsxs("div",{className:"flex items-center gap-2 text-sm text-blue-700",children:[n.jsx(vA,{className:"w-4 h-4"}),n.jsx("span",{className:"font-medium",children:"AI has extracted data from this email. Review the form fields below."})]})})]})]}),(t==null?void 0:t.autoDetectedCompany)&&n.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-700 bg-green-50 px-3 py-1.5 rounded-lg mt-3",children:[n.jsx(Ss,{className:"w-4 h-4"}),n.jsx("span",{children:"Company auto-detected from email domain"})]})]}),n.jsx("div",{className:"flex-1 overflow-y-auto px-6 py-4",children:n.jsxs("div",{className:"space-y-4",children:[n.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-4",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx(Ss,{className:"w-5 h-5 text-green-600 mt-0.5 flex-shrink-0"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-green-900 mb-1",children:"Auto-Generated Inquiry Number"}),n.jsx("p",{className:"text-xs text-green-700",children:"Inquiry number will be automatically generated when you save (format: INQ-2025-NNNN)"})]})]})}),u&&(t==null?void 0:t.products)&&n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:[n.jsxs("div",{className:"flex items-start justify-between mb-3",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(CE,{className:"w-5 h-5 text-blue-600"}),n.jsxs("h3",{className:"text-sm font-semibold text-blue-900",children:["Multi-Product Inquiry Detected (",t.products.length," Products)"]})]}),n.jsx("button",{type:"button",onClick:()=>d(!c),className:"text-blue-600 hover:text-blue-800 text-sm font-medium flex items-center gap-1",children:c?n.jsxs(n.Fragment,{children:[n.jsx(Rg,{className:"w-4 h-4"}),"Hide Products"]}):n.jsxs(n.Fragment,{children:[n.jsx(Cs,{className:"w-4 h-4"}),"Show Products"]})})]}),n.jsxs("p",{className:"text-xs text-blue-700 mb-3",children:["This will create a parent inquiry and ",t.products.length," child inquiries with numbers like INQ-2025-001.1, INQ-2025-001.2, etc."]}),c&&n.jsx("div",{className:"bg-white rounded-lg border border-blue-200 overflow-hidden overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-blue-100",children:[n.jsx("thead",{className:"bg-blue-100",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-blue-900",children:"#"}),n.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-blue-900",children:"Product Name"}),n.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-blue-900",children:"Specification"}),n.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-blue-900",children:"Quantity"}),n.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-blue-900",children:"Supplier / Origin"}),n.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-blue-900",children:"Delivery Date"}),n.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-blue-900",children:"Delivery Terms"})]})}),n.jsx("tbody",{className:"divide-y divide-blue-100",children:t.products.map((A,x)=>n.jsxs("tr",{className:"hover:bg-blue-50",children:[n.jsx("td",{className:"px-3 py-2 text-xs text-gray-700",children:x+1}),n.jsx("td",{className:"px-3 py-2 text-xs font-medium text-gray-900",children:A.productName||A.product_name}),n.jsx("td",{className:"px-3 py-2 text-xs text-gray-700",children:A.specification||A.spec||"-"}),n.jsx("td",{className:"px-3 py-2 text-xs text-gray-700",children:A.quantity||"-"}),n.jsxs("td",{className:"px-3 py-2 text-xs text-gray-700",children:[A.supplierName||A.supplier_name||A.origin||"-",(A.supplierCountry||A.supplier_country)&&` (${A.supplierCountry||A.supplier_country})`]}),n.jsx("td",{className:"px-3 py-2 text-xs text-gray-700",children:A.deliveryDate||A.delivery_date||A.tglDatang||A.tgl_datang||"-"}),n.jsx("td",{className:"px-3 py-2 text-xs text-gray-700",children:A.deliveryTerms||A.delivery_terms||"-"})]},x))})]})})]}),o&&n.jsx(cD,{onSubmit:f,onCancel:()=>{},initialData:o,isEditing:!1})]})})]})}async function Uue(e,t,r,a,s){var i;try{const{data:o,error:l}=await Z.from("crm_inquiries").select("*").eq("id",e).single();if(l)throw l;let c=o.status,d=!1;const u={};switch(t){case"send_price":u.price_quoted=!0,u.price_quoted_date=new Date().toISOString().split("T")[0],c="price_quoted",d=!0;break;case"send_coa":u.coa_sent=!0,u.coa_sent_date=new Date().toISOString().split("T")[0],o.price_quoted&&o.coa_sent&&(c="negotiation",d=!0);break;case"send_msds":u.msds_sent=!0,u.msds_sent_date=new Date().toISOString().split("T")[0];break;case"send_sample":u.sample_sent=!0,u.sample_sent_date=new Date().toISOString().split("T")[0],c="sample_sent",d=!0;break}if(d&&(u.status=c),Object.keys(u).length>0){const{error:x}=await Z.from("crm_inquiries").update(u).eq("id",e);if(x)throw x}let f;const{data:h}=await Z.rpc("auto_create_followup",{p_inquiry_id:e,p_action_type:t,p_user_id:a});h&&(f=h);const{error:A}=await Z.from("crm_quick_actions_log").insert({inquiry_id:e,action_type:t,action_label:r,email_sent:!!(s!=null&&s.emailTo),email_to:(s==null?void 0:s.emailTo)||null,email_subject:(s==null?void 0:s.emailSubject)||null,email_body:(s==null?void 0:s.emailBody)||null,template_used:(s==null?void 0:s.templateId)||null,old_status:o.status,new_status:c,status_updated:d,follow_up_created:!!f,follow_up_reminder_id:f||null,notes:(s==null?void 0:s.notes)||null,performed_by:a});if(A)throw A;if(s!=null&&s.emailTo&&(s!=null&&s.emailSubject)&&(s!=null&&s.emailBody)){const{error:x}=await Z.from("crm_email_activities").insert({inquiry_id:e,email_type:"sent",from_email:(i=(await Z.auth.getUser()).data.user)==null?void 0:i.email,to_email:[s.emailTo],subject:s.emailSubject,body:s.emailBody,template_id:s.templateId||null,sent_date:new Date().toISOString(),created_by:a});x&&console.error("Error logging email:",x)}return{success:!0,reminderId:f}}catch(o){return console.error("Error performing quick action:",o),{success:!1,error:o instanceof Error?o.message:"Unknown error"}}}async function Rue(e,t,r,a,s,i){try{let o=null,l="";switch(a){case"customer_will_revert":o=new Date,o.setDate(o.getDate()+2),l="Customer will revert";break;case"could_not_reach":o=new Date,o.setDate(o.getDate()+1),l="Try calling again";break;case"discussed_price":case"discussed_coa":case"discussed_sample":o=new Date,o.setDate(o.getDate()+3),l="Follow up on discussion";break;case"positive":o=new Date,o.setDate(o.getDate()+2),l="Positive response - follow up";break;case"negative":o=new Date,o.setDate(o.getDate()+7),l="Negative response - check back later";break}const{error:c}=await Z.from("crm_activity_logs").insert({inquiry_id:e,activity_type:t,activity_title:r,activity_description:i||null,outcome:a,next_follow_up_date:o?o.toISOString():null,follow_up_reason:l,created_by:s});if(c)throw c;o&&await Z.from("crm_inquiries").update({next_follow_up:o.toISOString(),last_contact_date:new Date().toISOString()}).eq("id",e);let d;if(o){const{data:u,error:f}=await Z.from("crm_reminders").insert({inquiry_id:e,reminder_type:"follow_up",title:l,due_date:o.toISOString(),assigned_to:s,created_by:s}).select("id").single();!f&&u&&(d=u.id)}return{success:!0,reminderId:d}}catch(o){return console.error("Error logging activity:",o),{success:!1,error:o instanceof Error?o.message:"Unknown error"}}}function Mue({inquiry:e,onActionComplete:t}){const[r,a]=Q.useState(!1),[s,i]=Q.useState("phone_call"),[o,l]=Q.useState(!1),c=[{id:"send_price",label:"Send Price",icon:hn,color:"bg-green-50 hover:bg-green-100 text-green-700 border-green-200",description:"Auto-updates status & creates 2-day follow-up"},{id:"send_coa",label:"Send COA",icon:Zt,color:"bg-blue-50 hover:bg-blue-100 text-blue-700 border-blue-200",description:"Auto-updates status & creates 1-day follow-up"},{id:"send_msds",label:"Send MSDS",icon:Zt,color:"bg-orange-50 hover:bg-orange-100 text-orange-700 border-orange-200",description:"Sends MSDS document"},{id:"send_sample",label:"Send Sample",icon:EE,color:"bg-purple-50 hover:bg-purple-100 text-purple-700 border-purple-200",description:"Auto-updates status & creates 3-day follow-up"}],d=[{value:"customer_will_revert",label:"Customer Will Revert",followUpDays:2},{value:"could_not_reach",label:"Could Not Reach",followUpDays:1},{value:"discussed_price",label:"Discussed Price/COA",followUpDays:3},{value:"positive",label:"Positive Response",followUpDays:2},{value:"negative",label:"Negative Response",followUpDays:7},{value:"other",label:"Other",followUpDays:3}],u=async(h,A)=>{if(!(!e||!confirm(`Send ${A}?

This will:
- Update inquiry status
- Create automatic follow-up
- Log the action

Continue?`))){l(!0);try{const{data:{user:p}}=await Z.auth.getUser();if(!p)throw new Error("Not authenticated");const b=await Uue(e.id,h,A,p.id,{emailTo:e.contact_email||void 0,emailSubject:`Re: ${e.email_subject||e.product_name}`,emailBody:`Dear ${e.contact_person||"Sir/Madam"},

Thank you for your inquiry regarding ${e.product_name}.

Please find the ${A.toLowerCase()} attached.

Best regards`});b.success?(alert(`${A} sent successfully!

Status updated & follow-up created automatically.`),t()):alert(`Failed to send ${A}: ${b.error}`)}catch(p){console.error("Error performing quick action:",p),alert("Failed to perform action. Please try again.")}finally{l(!1)}}},f=async h=>{if(e){l(!0);try{const{data:{user:A}}=await Z.auth.getUser();if(!A)throw new Error("Not authenticated");const x=s==="phone_call"?"Phone Call":s==="meeting"?"Meeting":"WhatsApp Message",p=await Rue(e.id,s,x,h,A.id);if(p.success){const b=d.find(m=>m.value===h);alert(`${x} logged!

Follow-up automatically created for ${b==null?void 0:b.followUpDays} days from now.`),a(!1),t()}else alert(`Failed to log activity: ${p.error}`)}catch(A){console.error("Error logging activity:",A),alert("Failed to log activity. Please try again.")}finally{l(!1)}}};return e?n.jsxs("div",{className:"flex flex-col h-full bg-white border-l border-gray-200",children:[n.jsxs("div",{className:"px-4 py-3 border-b border-gray-200 bg-gradient-to-r from-green-50 to-transparent",children:[n.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-1",children:"Quick Actions"}),n.jsxs("p",{className:"text-xs text-gray-600",children:["Inquiry #",e.inquiry_number]})]}),n.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[n.jsxs("div",{children:[n.jsxs("h3",{className:"text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2",children:[n.jsx($i,{className:"w-4 h-4"}),"Send Documents (1-Click)"]}),n.jsx("div",{className:"space-y-2",children:c.map(h=>n.jsx("button",{onClick:()=>u(h.id,h.label),disabled:o,className:`w-full p-3 rounded-lg border-2 transition ${h.color} disabled:opacity-50 disabled:cursor-not-allowed text-left`,children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(h.icon,{className:"w-5 h-5 flex-shrink-0"}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"font-semibold text-sm",children:h.label}),n.jsx("p",{className:"text-xs opacity-75 truncate",children:h.description})]})]})},h.id))})]}),n.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[n.jsxs("h3",{className:"text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2",children:[n.jsx(Ul,{className:"w-4 h-4"}),"Log Activity (1-Click)"]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("button",{onClick:()=>{i("phone_call"),a(!0)},disabled:o,className:"w-full p-3 rounded-lg border-2 border-gray-200 hover:bg-gray-50 transition text-left disabled:opacity-50",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(Ul,{className:"w-5 h-5 text-blue-600 flex-shrink-0"}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-semibold text-sm text-gray-900",children:"Log Call"}),n.jsx("p",{className:"text-xs text-gray-600",children:"Quick outcome selection"})]})]})}),n.jsx("button",{onClick:()=>{i("meeting"),a(!0)},disabled:o,className:"w-full p-3 rounded-lg border-2 border-gray-200 hover:bg-gray-50 transition text-left disabled:opacity-50",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(ja,{className:"w-5 h-5 text-purple-600 flex-shrink-0"}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-semibold text-sm text-gray-900",children:"Log Meeting"}),n.jsx("p",{className:"text-xs text-gray-600",children:"Record meeting outcome"})]})]})}),n.jsx("button",{onClick:()=>{i("whatsapp"),a(!0)},disabled:o,className:"w-full p-3 rounded-lg border-2 border-gray-200 hover:bg-gray-50 transition text-left disabled:opacity-50",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(U0,{className:"w-5 h-5 text-green-600 flex-shrink-0"}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-semibold text-sm text-gray-900",children:"Log WhatsApp"}),n.jsx("p",{className:"text-xs text-gray-600",children:"Log WhatsApp conversation"})]})]})})]})]}),n.jsx("div",{className:"border-t border-gray-200 pt-4",children:n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:n.jsxs("div",{className:"flex items-start gap-2",children:[n.jsx(da,{className:"w-4 h-4 text-blue-600 mt-0.5 flex-shrink-0"}),n.jsxs("div",{className:"text-xs text-blue-800",children:[n.jsx("p",{className:"font-medium mb-1",children:"Auto-Automation Active"}),n.jsxs("ul",{className:"space-y-0.5 text-blue-700",children:[n.jsx("li",{children:" Status updates automatically"}),n.jsx("li",{children:" Follow-ups created automatically"}),n.jsx("li",{children:" All actions logged in timeline"})]})]})]})})})]}),n.jsx(Ot,{isOpen:r,onClose:()=>a(!1),title:`Log ${s==="phone_call"?"Phone Call":s==="meeting"?"Meeting":"WhatsApp"}`,children:n.jsxs("div",{className:"space-y-4",children:[n.jsx("p",{className:"text-sm text-gray-600",children:"Select the outcome to automatically update follow-up date:"}),n.jsx("div",{className:"space-y-2",children:d.map(h=>n.jsx("button",{onClick:()=>f(h.value),disabled:o,className:"w-full p-4 text-left border-2 border-gray-200 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition disabled:opacity-50 disabled:cursor-not-allowed",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(Ss,{className:"w-5 h-5 text-gray-400"}),n.jsx("span",{className:"font-medium text-gray-900",children:h.label})]}),n.jsxs("span",{className:"text-xs text-gray-500",children:["+",h.followUpDays,"d follow-up"]})]})},h.value))}),n.jsx("div",{className:"pt-4 border-t border-gray-200",children:n.jsx("p",{className:"text-xs text-gray-500 text-center",children:"Click an outcome to log and auto-create follow-up"})})]})})]}):n.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center px-8 bg-gray-50",children:[n.jsx($i,{className:"w-20 h-20 text-gray-300 mb-4"}),n.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Quick Actions"}),n.jsx("p",{className:"text-gray-600 max-w-md",children:"Save an inquiry to see quick action buttons here"}),n.jsxs("div",{className:"mt-6 text-sm text-gray-500 space-y-1",children:[n.jsx("p",{children:"One-click actions include:"}),n.jsxs("ul",{className:"list-disc list-inside text-left",children:[n.jsx("li",{children:"Send Price Quote"}),n.jsx("li",{children:"Send COA/MSDS"}),n.jsx("li",{children:"Log Phone Calls"}),n.jsx("li",{children:"Schedule Follow-ups"})]})]})]})}function Que(e){if(!e)return null;const t=e.trim();if(!t)return null;if(/^\d{4}-\d{2}-\d{2}$/.test(t))return t;const r=t.match(/^(\d{1,2})\.(\d{1,2})\.(\d{2})$/);if(r){const o=r[1].padStart(2,"0"),l=r[2].padStart(2,"0");return`${parseInt(r[3])<50?`20${r[3]}`:`19${r[3]}`}-${l}-${o}`}const a=t.match(/^(\d{1,2})\/(\d{1,2})\/(\d{2})$/);if(a){const o=a[1].padStart(2,"0"),l=a[2].padStart(2,"0");return`${parseInt(a[3])<50?`20${a[3]}`:`19${a[3]}`}-${l}-${o}`}const s=t.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/);if(s){const o=s[1].padStart(2,"0"),l=s[2].padStart(2,"0");return`${s[3]}-${l}-${o}`}const i=t.match(/^(\d{1,2})-(\d{1,2})-(\d{4})$/);if(i){const o=i[1].padStart(2,"0"),l=i[2].padStart(2,"0");return`${i[3]}-${l}-${o}`}try{const o=new Date(t);if(!isNaN(o.getTime()))return o.toISOString().split("T")[0]}catch{console.warn("Could not parse date:",t)}return null}function Hue(){console.log("[CRMCommandCenter] Component loaded - Dec 7 2025 v1.2");const{profile:e}=Cr(),[t,r]=Q.useState(null),[a,s]=Q.useState(null),[i,o]=Q.useState(null),[l,c]=Q.useState(!1),d=(h,A)=>{console.log("[CRMCommandCenter] handleEmailSelect called",{email:h,data:A}),r(h),s(A),o(null)},u=async h=>{var A;if(!(!t||!e)){c(!0);try{const{data:{user:x}}=await Z.auth.getUser();if(!x)throw new Error("Not authenticated");let p=null;const b=h.contactEmail.split(/[,;]/)[0].trim();console.log("[CRMCommandCenter] Looking up customer with primaryEmail:",b);const{data:m,error:g}=await Z.from("crm_contacts").select("id, company_name, email, contact_person, phone, address").or(`email.eq.${b},company_name.ilike.${h.companyName}`).limit(1).maybeSingle();if(g)throw console.error("[CRMCommandCenter] Customer lookup error:",g),g;if(m){p=m.id;const j={};h.contactPerson&&!m.contact_person&&(j.contact_person=h.contactPerson),h.contactPhone&&!m.phone&&(j.phone=h.contactPhone),h.contactEmail&&h.contactEmail!==m.email&&(j.email=h.contactEmail),Object.keys(j).length>0&&await Z.from("crm_contacts").update({...j,updated_at:new Date().toISOString()}).eq("id",p)}else{const{data:j,error:N}=await Z.from("crm_contacts").insert({company_name:h.companyName,contact_person:h.contactPerson||null,email:h.contactEmail,phone:h.contactPhone||null,is_active:!0,created_by:x.id}).select().single();if(N)throw console.error("[CRMCommandCenter] Customer creation error:",N),new Error(`Failed to create customer: ${N.message}`);j&&(p=j.id)}if(!p)throw new Error("Failed to get or create customer ID");const y={customer_id:p,inquiry_date:new Date().toISOString().split("T")[0],product_name:h.productName,specification:h.specification||null,quantity:h.quantity,supplier_name:h.supplierName||null,supplier_country:h.supplierCountry||null,company_name:h.companyName,contact_person:h.contactPerson||null,contact_email:h.contactEmail,contact_phone:h.contactPhone||null,mail_subject:t.subject,email_body:t.body,inquiry_source:"email",status:"new",pipeline_status:"new",priority:h.priority,purpose_icons:h.purposeIcons,delivery_date_expected:Que(h.deliveryDateExpected),ai_confidence_score:(a==null?void 0:a.confidenceScore)||0,auto_detected_company:(a==null?void 0:a.autoDetectedCompany)||!1,auto_detected_contact:(a==null?void 0:a.autoDetectedContact)||!1,coa_sent:!1,msds_sent:!1,sample_sent:!1,price_quoted:!1,price_required:h.priceRequested,coa_required:h.coaRequested,sample_required:h.sampleRequested,agency_letter_required:h.agencyLetterRequested||!1,aceerp_no:h.aceerp_no||null,purchase_price:h.purchasePrice?parseFloat(h.purchasePrice):null,purchase_price_currency:h.purchasePriceCurrency||"USD",offered_price:h.offeredPrice?parseFloat(h.offeredPrice):null,offered_price_currency:h.offeredPriceCurrency||"USD",delivery_date:h.deliveryDate||null,delivery_terms:h.deliveryTerms||null,remarks:h.remarks||null,assigned_to:x.id,created_by:x.id,source:"email",source_email_id:t.id.startsWith("gmail-")?null:t.id};let v;if(h.isMultiProduct&&h.products&&h.products.length>0){const j=h.products.map(E=>({...y,product_name:E.productName,specification:E.specification||null,quantity:E.quantity,supplier_name:E.supplierName||y.supplier_name||null,supplier_country:E.supplierCountry||y.supplier_country||null,delivery_date:E.deliveryDate||y.delivery_date||null,delivery_terms:E.deliveryTerms||y.delivery_terms||null,is_multi_product:!1,has_items:!1}));console.log("[CRMCommandCenter] Inserting multi-product inquiries:",j.length,"items");const{data:N,error:B}=await Z.from("crm_inquiries").insert(j).select();if(B)throw console.error("[CRMCommandCenter] Multi-product insert error:",B),B;if(N&&N.length>0){const E=N[0].inquiry_number;for(let C=0;C<N.length;C++)await Z.from("crm_inquiries").update({inquiry_number:`${E}.${C+1}`}).eq("id",N[C].id);v=N[0]}}else{console.log("[CRMCommandCenter] Inserting single product inquiry");const{data:j,error:N}=await Z.from("crm_inquiries").insert([{...y,is_multi_product:!1,has_items:!1}]).select().single();if(N)throw console.error("[CRMCommandCenter] Single product insert error:",N),N;v=j}if(await Z.from("crm_email_inbox").update({is_processed:!0,is_inquiry:!0,converted_to_inquiry:v.id}).eq("id",t.id),h.coaRequested||h.msdsRequested||h.sampleRequested||h.priceRequested||h.agencyLetterRequested){const j=[];h.priceRequested&&j.push({inquiry_id:v.id,reminder_type:"send_price",title:"Send price quote to customer",due_date:new Date(Date.now()+1*24*60*60*1e3).toISOString(),assigned_to:x.id,created_by:x.id}),h.coaRequested&&j.push({inquiry_id:v.id,reminder_type:"send_coa",title:"Send COA to customer",due_date:new Date(Date.now()+2*24*60*60*1e3).toISOString(),assigned_to:x.id,created_by:x.id}),h.msdsRequested&&j.push({inquiry_id:v.id,reminder_type:"send_msds",title:"Send MSDS to customer",due_date:new Date(Date.now()+2*24*60*60*1e3).toISOString(),assigned_to:x.id,created_by:x.id}),h.sampleRequested&&j.push({inquiry_id:v.id,reminder_type:"send_sample",title:"Send sample to customer",due_date:new Date(Date.now()+3*24*60*60*1e3).toISOString(),assigned_to:x.id,created_by:x.id}),h.agencyLetterRequested&&j.push({inquiry_id:v.id,reminder_type:"send_agency_letter",title:"Send agency letter to customer",due_date:new Date(Date.now()+1*24*60*60*1e3).toISOString(),assigned_to:x.id,created_by:x.id}),j.length>0&&await Z.from("crm_reminders").insert(j)}o(v),s(null);const _=h.isMultiProduct&&h.products?`Inquiry #${v.inquiry_number} created successfully with ${h.products.length} product line items!

Use Quick Actions to send documents for each product.`:`Inquiry #${v.inquiry_number} created successfully!

Use Quick Actions to send documents.`;alert(_)}catch(x){if(console.error("[CRMCommandCenter] Error creating inquiry:",x),console.error("[CRMCommandCenter] Error details:",JSON.stringify(x,null,2)),(A=x.message)!=null&&A.includes("duplicate key"))alert("This inquiry number already exists. Please use a different number.");else{const p=x.message||x.details||x.hint||"Unknown error";alert(`Failed to create inquiry: ${p}

Check console for details.`)}}finally{c(!1)}}},f=()=>{o(null),r(null),s(null)};return n.jsx(Un,{children:n.jsxs("div",{className:"h-screen flex flex-col",children:[n.jsx("div",{className:"flex-shrink-0 bg-gradient-to-r from-blue-600 to-blue-700 px-4 py-2 border-b border-blue-800",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(IE,{className:"w-5 h-5 text-white"}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-lg font-bold text-white",children:"CRM Command Center"}),n.jsx("p",{className:"text-blue-100 text-xs",children:"AI-powered inquiry processing"})]})]}),n.jsxs("div",{className:"text-right",children:[n.jsx("p",{className:"text-xs text-blue-200",children:"Quick Actions"}),n.jsx("p",{className:"text-xl font-bold text-white",children:"2 Clicks"})]})]})}),n.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[n.jsx("div",{className:"w-1/4 min-w-[300px] max-w-[400px]",children:n.jsx(Pue,{onEmailSelect:d,selectedEmailId:(t==null?void 0:t.id)||null})}),n.jsx("div",{className:"flex-1",children:n.jsx(Oue,{email:t,parsedData:a,onSave:u,saving:l})}),n.jsx("div",{className:"w-1/4 min-w-[300px] max-w-[400px]",children:n.jsx(Mue,{inquiry:i,onActionComplete:f})})]}),i&&n.jsx("div",{className:"flex-shrink-0 bg-green-50 border-t border-green-200 px-6 py-3",children:n.jsxs("div",{className:"flex items-center justify-center gap-2 text-green-800",children:[n.jsx(Ss,{className:"w-5 h-5"}),n.jsxs("span",{className:"font-medium",children:["Inquiry #",i.inquiry_number," created successfully! Use Quick Actions on the right "]})]})})]})})}function que({isOpen:e,onClose:t,taskId:r,onUpdate:a}){const{user:s}=Cr(),[i,o]=Q.useState(null),[l,c]=Q.useState([]),[d,u]=Q.useState([]),[f,h]=Q.useState(!0),[A,x]=Q.useState(""),[p,b]=Q.useState(!1),[m,g]=Q.useState(""),[y,v]=Q.useState([]),[_,j]=Q.useState(!1),[N,B]=Q.useState(!1),E=Q.useRef(null),C=Q.useRef(null);Q.useEffect(()=>{e&&r&&(k(),w(),T())},[e,r]);const k=async()=>{var L,P,I,H;try{h(!0);const{data:V,error:W}=await Z.from("tasks").select(`
          *,
          creator:created_by(full_name),
          inquiry:crm_inquiries(inquiry_number),
          customer:customers(company_name),
          product:products(name)
        `).eq("id",r).single();if(W)throw W;const M=V.assigned_users||[],{data:se}=await Z.from("user_profiles").select("id, full_name").in("id",M);o({...V,creator_name:(L=V.creator)==null?void 0:L.full_name,assignee_names:(se==null?void 0:se.map(K=>K.full_name))||[],inquiry_number:(P=V.inquiry)==null?void 0:P.inquiry_number,customer_name:(I=V.customer)==null?void 0:I.company_name,product_name:(H=V.product)==null?void 0:H.name})}catch(V){console.error("Error loading task:",V)}finally{h(!1)}},w=async()=>{try{const{data:L,error:P}=await Z.from("task_comments").select(`
          *,
          user:user_id(full_name)
        `).eq("task_id",r).eq("is_deleted",!1).order("created_at",{ascending:!0});if(P)throw P;c((L||[]).map(I=>{var H;return{...I,user_name:((H=I.user)==null?void 0:H.full_name)||"Unknown User"}}))}catch(L){console.error("Error loading comments:",L)}},T=async()=>{try{const{data:L,error:P}=await Z.from("user_profiles").select("id, full_name, email").eq("is_active",!0).order("full_name");if(P)throw P;u(L||[])}catch(L){console.error("Error loading users:",L)}},R=L=>{const P=L.target.value;x(P);const I=P.split(" ").pop()||"";I.startsWith("@")?(g(I.slice(1)),b(!0)):b(!1)},q=(L,P)=>{var H;const I=A.split(" ");I[I.length-1]=`@${L} `,x(I.join(" ")),b(!1),(H=C.current)==null||H.focus()},z=L=>{const P=/@(\w+)/g,I=[];let H;for(;(H=P.exec(L))!==null;){const V=H[1],W=d.find(M=>M.full_name.replace(/\s+/g,"")===V);W&&I.push(W.id)}return I},ee=async()=>{const L=[];for(const P of y){const I=`${Date.now()}_${P.name}`,H=`tasks/${r}/comments/${I}`,{error:V}=await Z.storage.from("task-attachments").upload(H,P);V?console.error("Error uploading file:",V):L.push(H)}return L},Y=async()=>{if(!(!A.trim()&&y.length===0))try{j(!0);const L=await ee(),P=z(A),{error:I}=await Z.from("task_comments").insert([{task_id:r,comment_text:A,user_id:s==null?void 0:s.id,mentions:P,attachment_urls:L}]);if(I)throw I;x(""),v([]),w()}catch(L){console.error("Error adding comment:",L),alert("Failed to add comment")}finally{j(!1)}},G=async L=>{try{B(!0);const{error:P}=await Z.from("tasks").update({status:L}).eq("id",r);if(P)throw P;k(),a()}catch(P){console.error("Error updating status:",P),alert("Failed to update status")}finally{B(!1)}},re=L=>{var I;const P=(I=L.split(".").pop())==null?void 0:I.toLowerCase();return["jpg","jpeg","png","gif","webp"].includes(P||"")?n.jsx(Jw,{className:"w-4 h-4"}):["pdf"].includes(P||"")?n.jsx(Zt,{className:"w-4 h-4"}):n.jsx(Zb,{className:"w-4 h-4"})},U=async L=>{try{const{data:P,error:I}=await Z.storage.from("task-attachments").download(L);if(I)throw I;const H=URL.createObjectURL(P),V=document.createElement("a");V.href=H,V.download=L.split("/").pop()||"download",document.body.appendChild(V),V.click(),document.body.removeChild(V),URL.revokeObjectURL(H)}catch(P){console.error("Error downloading file:",P)}},S=L=>{const P={to_do:"bg-gray-100 text-gray-700 border-gray-300",in_progress:"bg-blue-100 text-blue-700 border-blue-300",waiting:"bg-orange-100 text-orange-700 border-orange-300",completed:"bg-green-100 text-green-700 border-green-300"};return P[L]||P.to_do},D=L=>{const P={low:"bg-gray-100 text-gray-700",medium:"bg-yellow-100 text-yellow-700",high:"bg-orange-100 text-orange-700",urgent:"bg-red-100 text-red-700"};return P[L]||P.medium};return f||!i?n.jsx(Ot,{isOpen:e,onClose:t,title:"Loading...",children:n.jsx("div",{className:"flex items-center justify-center py-12",children:n.jsx(Vo,{className:"w-8 h-8 animate-spin text-blue-600"})})}):n.jsx(Ot,{isOpen:e,onClose:t,title:i.title,size:"xl",children:n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${D(i.priority)}`,children:i.priority.toUpperCase()}),n.jsxs("select",{value:i.status,onChange:L=>G(L.target.value),disabled:N,className:`px-3 py-1 rounded-full text-sm font-medium border-2 ${S(i.status)} cursor-pointer disabled:opacity-50`,children:[n.jsx("option",{value:"to_do",children:"To Do"}),n.jsx("option",{value:"in_progress",children:"In Progress"}),n.jsx("option",{value:"waiting",children:"Waiting"}),n.jsx("option",{value:"completed",children:"Completed"})]})]}),i.description&&n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Description"}),n.jsx("p",{className:"text-gray-900 whitespace-pre-wrap",children:i.description})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[n.jsx(ja,{className:"w-4 h-4 text-gray-500"}),n.jsx("span",{className:"text-gray-700",children:"Deadline:"}),n.jsx("span",{className:"font-medium text-gray-900",children:new Date(i.deadline).toLocaleString()})]}),n.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[n.jsx(Ao,{className:"w-4 h-4 text-gray-500"}),n.jsx("span",{className:"text-gray-700",children:"Created by:"}),n.jsx("span",{className:"font-medium text-gray-900",children:i.creator_name})]}),i.assignee_names.length>0&&n.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[n.jsx(Ao,{className:"w-4 h-4 text-gray-500"}),n.jsx("span",{className:"text-gray-700",children:"Assigned to:"}),n.jsx("span",{className:"font-medium text-gray-900",children:i.assignee_names.join(", ")})]}),i.inquiry_number&&n.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[n.jsx(Qg,{className:"w-4 h-4 text-gray-500"}),n.jsx("span",{className:"text-gray-700",children:"Inquiry:"}),n.jsx("span",{className:"font-medium text-blue-600",children:i.inquiry_number})]}),i.customer_name&&n.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[n.jsx(Ao,{className:"w-4 h-4 text-gray-500"}),n.jsx("span",{className:"text-gray-700",children:"Customer:"}),n.jsx("span",{className:"font-medium text-gray-900",children:i.customer_name})]}),i.product_name&&n.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[n.jsx(Qg,{className:"w-4 h-4 text-gray-500"}),n.jsx("span",{className:"text-gray-700",children:"Product:"}),n.jsx("span",{className:"font-medium text-gray-900",children:i.product_name})]})]}),i.attachment_urls.length>0&&n.jsxs("div",{children:[n.jsxs("h3",{className:"text-sm font-medium text-gray-700 mb-2 flex items-center gap-2",children:[n.jsx(Wo,{className:"w-4 h-4"}),"Attachments (",i.attachment_urls.length,")"]}),n.jsx("div",{className:"grid grid-cols-2 gap-2",children:i.attachment_urls.map((L,P)=>n.jsxs("button",{onClick:()=>U(L),className:"flex items-center gap-2 p-2 border border-gray-200 rounded-lg hover:bg-gray-50 text-left",children:[re(L),n.jsx("span",{className:"text-sm text-gray-700 truncate",children:L.split("/").pop()}),n.jsx(Zn,{className:"w-4 h-4 ml-auto text-gray-400"})]},P))})]}),n.jsxs("div",{className:"border-t pt-6",children:[n.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[n.jsx(U0,{className:"w-5 h-5"}),"Discussion (",l.length,")"]}),n.jsx("div",{className:"space-y-4 mb-4 max-h-96 overflow-y-auto",children:l.length===0?n.jsx("p",{className:"text-sm text-gray-500 text-center py-8",children:"No comments yet. Start the discussion!"}):l.map(L=>n.jsxs("div",{className:"flex gap-3",children:[n.jsx("div",{className:"flex-shrink-0",children:n.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-600 flex items-center justify-center text-white font-medium text-sm",children:L.user_name.charAt(0).toUpperCase()})}),n.jsx("div",{className:"flex-1",children:n.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[n.jsxs("div",{className:"flex items-center justify-between mb-1",children:[n.jsx("span",{className:"font-medium text-sm text-gray-900",children:L.user_name}),n.jsx("span",{className:"text-xs text-gray-500",children:new Date(L.created_at).toLocaleString()})]}),n.jsx("p",{className:"text-sm text-gray-900 whitespace-pre-wrap",children:L.comment_text}),L.attachment_urls.length>0&&n.jsx("div",{className:"mt-2 space-y-1",children:L.attachment_urls.map((P,I)=>n.jsxs("button",{onClick:()=>U(P),className:"flex items-center gap-2 text-xs text-blue-600 hover:text-blue-700",children:[re(P),P.split("/").pop()]},I))})]})})]},L.id))}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"relative",children:[n.jsx("textarea",{ref:C,value:A,onChange:R,placeholder:"Add a comment... Use @ to mention someone",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none",rows:3}),p&&n.jsx("div",{className:"absolute bottom-full left-0 mb-1 w-64 bg-white border border-gray-200 rounded-lg shadow-lg max-h-48 overflow-y-auto z-10",children:d.filter(L=>L.full_name.toLowerCase().includes(m.toLowerCase())).slice(0,5).map(L=>n.jsxs("button",{onClick:()=>q(L.full_name.replace(/\s+/g,""),L.id),className:"w-full px-3 py-2 text-left hover:bg-gray-50 flex items-center gap-2",children:[n.jsx("div",{className:"w-6 h-6 rounded-full bg-blue-600 flex items-center justify-center text-white text-xs",children:L.full_name.charAt(0).toUpperCase()}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-gray-900",children:L.full_name}),n.jsx("p",{className:"text-xs text-gray-500",children:L.email})]})]},L.id))})]}),y.length>0&&n.jsx("div",{className:"flex flex-wrap gap-2",children:y.map((L,P)=>n.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-gray-100 rounded-lg text-sm",children:[n.jsx(Wo,{className:"w-4 h-4 text-gray-500"}),n.jsx("span",{className:"text-gray-700",children:L.name}),n.jsx("button",{onClick:()=>v(I=>I.filter((H,V)=>V!==P)),className:"text-gray-500 hover:text-red-600",children:n.jsx(wr,{className:"w-4 h-4"})})]},P))}),n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("input",{ref:E,type:"file",multiple:!0,onChange:L=>{L.target.files&&v(Array.from(L.target.files))},className:"hidden"}),n.jsxs("button",{onClick:()=>{var L;return(L=E.current)==null?void 0:L.click()},className:"flex items-center gap-2 px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded-lg transition",children:[n.jsx(Wo,{className:"w-4 h-4"}),"Attach Files"]}),n.jsx("button",{onClick:Y,disabled:_||!A.trim()&&y.length===0,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition",children:_?n.jsxs(n.Fragment,{children:[n.jsx(Vo,{className:"w-4 h-4 animate-spin"}),"Posting..."]}):n.jsxs(n.Fragment,{children:[n.jsx($i,{className:"w-4 h-4"}),"Post Comment"]})})]})]})]})]})})}function $ue(){const{user:e,profile:t}=Cr(),[r,a]=Q.useState([]),[s,i]=Q.useState([]),[o,l]=Q.useState(!0),[c,d]=Q.useState(""),[u,f]=Q.useState(!1),[h,A]=Q.useState(null),[x,p]=Q.useState(!1),[b,m]=Q.useState(!1),[g,y]=Q.useState(null),[v,_]=Q.useState({status:[],priority:[],assignedTo:[],view:"my-tasks"}),[j,N]=Q.useState({total:0,pending:0,completed:0,overdue:0});Q.useEffect(()=>{B()},[e]),Q.useEffect(()=>{C()},[r,v,c]);const B=async()=>{try{l(!0);let q=Z.from("tasks").select(`
          *,
          creator:created_by(full_name),
          inquiry:crm_inquiries(inquiry_number),
          customer:customers(company_name),
          product:products(product_name)
        `).eq("is_deleted",!1).order("deadline",{ascending:!0});const{data:z,error:ee}=await q;if(ee)throw ee;const Y=(z==null?void 0:z.map(S=>S.id))||[],{data:G}=await Z.from("task_comments").select("task_id").in("task_id",Y).eq("is_deleted",!1),re={};G==null||G.forEach(S=>{re[S.task_id]=(re[S.task_id]||0)+1});const U=(z||[]).map(S=>{var D,L,P,I;return{...S,creator_name:(D=S.creator)==null?void 0:D.full_name,inquiry_number:(L=S.inquiry)==null?void 0:L.inquiry_number,customer_name:(P=S.customer)==null?void 0:P.company_name,product_name:(I=S.product)==null?void 0:I.product_name,comment_count:re[S.id]||0}});a(U),E(U)}catch(q){console.error("Error loading tasks:",q)}finally{l(!1)}},E=q=>{const z=new Date,ee=q.filter(Y=>Y.assigned_users.includes((e==null?void 0:e.id)||"")||Y.created_by===(e==null?void 0:e.id));N({total:ee.length,pending:ee.filter(Y=>Y.status!=="completed").length,completed:ee.filter(Y=>Y.status==="completed").length,overdue:ee.filter(Y=>Y.status!=="completed"&&new Date(Y.deadline)<z).length})},C=()=>{let q=[...r];if(v.view==="my-tasks")q=q.filter(z=>z.assigned_users.includes((e==null?void 0:e.id)||"")||z.created_by===(e==null?void 0:e.id));else if(v.view==="pending")q=q.filter(z=>z.status!=="completed"&&(z.assigned_users.includes((e==null?void 0:e.id)||"")||z.created_by===(e==null?void 0:e.id)));else if(v.view==="completed")q=q.filter(z=>z.status==="completed"&&(z.assigned_users.includes((e==null?void 0:e.id)||"")||z.created_by===(e==null?void 0:e.id)));else if(v.view==="overdue"){const z=new Date;q=q.filter(ee=>ee.status!=="completed"&&new Date(ee.deadline)<z&&(ee.assigned_users.includes((e==null?void 0:e.id)||"")||ee.created_by===(e==null?void 0:e.id)))}if(v.status.length>0&&(q=q.filter(z=>v.status.includes(z.status))),v.priority.length>0&&(q=q.filter(z=>v.priority.includes(z.priority))),c){const z=c.toLowerCase();q=q.filter(ee=>{var Y,G,re,U;return ee.title.toLowerCase().includes(z)||((Y=ee.description)==null?void 0:Y.toLowerCase().includes(z))||((G=ee.customer_name)==null?void 0:G.toLowerCase().includes(z))||((re=ee.product_name)==null?void 0:re.toLowerCase().includes(z))||((U=ee.inquiry_number)==null?void 0:U.toLowerCase().includes(z))})}i(q)},k=q=>{switch(q){case"urgent":return n.jsx(NE,{className:"w-4 h-4 text-red-600"});case"high":return n.jsx(Yb,{className:"w-4 h-4 text-orange-600"});case"medium":return n.jsx(Mg,{className:"w-4 h-4 text-yellow-600"});default:return n.jsx(bE,{className:"w-4 h-4 text-gray-400"})}},w=q=>{const z={to_do:"bg-gray-100 text-gray-700",in_progress:"bg-blue-100 text-blue-700",waiting:"bg-orange-100 text-orange-700",completed:"bg-green-100 text-green-700"},ee={to_do:"To Do",in_progress:"In Progress",waiting:"Waiting",completed:"Completed"};return n.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${z[q]}`,children:ee[q]})},T=q=>{const z=new Date(q),ee=new Date,Y=z.getTime()-ee.getTime(),G=Math.floor(Y/(1e3*60*60)),re=Math.floor(G/24);return Y<0?n.jsx("span",{className:"text-red-600 font-medium",children:"Overdue"}):G<24?n.jsxs("span",{className:"text-orange-600 font-medium",children:["Due in ",G,"h"]}):re<7?n.jsxs("span",{className:"text-yellow-600 font-medium",children:["Due in ",re,"d"]}):n.jsx("span",{className:"text-gray-600",children:z.toLocaleDateString()})},R=async q=>{if(confirm("Are you sure you want to delete this task?"))try{const{error:z}=await Z.from("tasks").update({is_deleted:!0,deleted_at:new Date().toISOString(),deleted_by:e==null?void 0:e.id}).eq("id",q);if(z)throw z;B()}catch(z){console.error("Error deleting task:",z),alert("Failed to delete task")}};return o?n.jsx(Un,{children:n.jsx("div",{className:"flex items-center justify-center h-64",children:n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})})}):n.jsxs(Un,{children:[n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex justify-between items-start",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Tasks"}),n.jsx("p",{className:"text-gray-600 mt-1",children:"Manage and track team assignments"})]}),n.jsxs("button",{onClick:()=>m(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:[n.jsx(Pr,{className:"w-5 h-5"}),"New Task"]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[n.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:n.jsx(Ss,{className:"w-6 h-6 text-blue-600"})}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-600",children:"Total Tasks"}),n.jsx("p",{className:"text-2xl font-bold text-gray-900",children:j.total})]})]})}),n.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:n.jsx(da,{className:"w-6 h-6 text-yellow-600"})}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-600",children:"Pending"}),n.jsx("p",{className:"text-2xl font-bold text-gray-900",children:j.pending})]})]})}),n.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:n.jsx(Ss,{className:"w-6 h-6 text-green-600"})}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-600",children:"Completed"}),n.jsx("p",{className:"text-2xl font-bold text-gray-900",children:j.completed})]})]})}),n.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:n.jsx(En,{className:"w-6 h-6 text-red-600"})}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-600",children:"Overdue"}),n.jsx("p",{className:"text-2xl font-bold text-gray-900",children:j.overdue})]})]})})]}),n.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[n.jsxs("div",{className:"p-4 border-b border-gray-200",children:[n.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-between",children:[n.jsx("div",{className:"flex gap-2 flex-wrap",children:[{value:"my-tasks",label:"My Tasks"},{value:"pending",label:"Pending"},{value:"completed",label:"Completed"},{value:"overdue",label:"Overdue"},{value:"all",label:"All Tasks"}].map(q=>n.jsx("button",{onClick:()=>_({...v,view:q.value}),className:`px-4 py-2 rounded-lg text-sm font-medium transition ${v.view===q.value?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:q.label},q.value))}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("div",{className:"relative flex-1 sm:flex-none sm:w-64",children:[n.jsx(Ca,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),n.jsx("input",{type:"text",placeholder:"Search tasks...",value:c,onChange:q=>d(q.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),n.jsx("button",{onClick:()=>f(!u),className:`px-4 py-2 border rounded-lg transition ${u?"bg-blue-50 border-blue-300 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,children:n.jsx(v7,{className:"w-5 h-5"})})]})]}),u&&n.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 grid grid-cols-1 sm:grid-cols-3 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),n.jsx("div",{className:"space-y-2",children:["to_do","in_progress","waiting","completed"].map(q=>n.jsxs("label",{className:"flex items-center gap-2",children:[n.jsx("input",{type:"checkbox",checked:v.status.includes(q),onChange:z=>{z.target.checked?_({...v,status:[...v.status,q]}):_({...v,status:v.status.filter(ee=>ee!==q)})},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),n.jsx("span",{className:"text-sm text-gray-700 capitalize",children:q.replace("_"," ")})]},q))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Priority"}),n.jsx("div",{className:"space-y-2",children:["urgent","high","medium","low"].map(q=>n.jsxs("label",{className:"flex items-center gap-2",children:[n.jsx("input",{type:"checkbox",checked:v.priority.includes(q),onChange:z=>{z.target.checked?_({...v,priority:[...v.priority,q]}):_({...v,priority:v.priority.filter(ee=>ee!==q)})},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),n.jsx("span",{className:"text-sm text-gray-700 capitalize",children:q})]},q))})]}),n.jsx("div",{className:"flex items-end",children:n.jsx("button",{onClick:()=>_({...v,status:[],priority:[],assignedTo:[]}),className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"Clear All Filters"})})]})]}),n.jsx("div",{className:"divide-y divide-gray-200",children:s.length===0?n.jsxs("div",{className:"p-12 text-center",children:[n.jsx(Ss,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),n.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No tasks found"}),n.jsx("p",{className:"text-gray-600 mb-6",children:c||v.status.length>0||v.priority.length>0?"Try adjusting your filters or search query":"Create your first task to get started"}),!c&&v.status.length===0&&n.jsxs("button",{onClick:()=>m(!0),className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:[n.jsx(Pr,{className:"w-5 h-5"}),"Create Task"]})]}):s.map(q=>n.jsx("div",{className:"p-4 hover:bg-gray-50 transition cursor-pointer",onClick:()=>{A(q),p(!0)},children:n.jsxs("div",{className:"flex items-start justify-between gap-4",children:[n.jsxs("div",{className:"flex items-start gap-3 flex-1 min-w-0",children:[n.jsx("div",{className:"mt-1",children:k(q.priority)}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-start gap-2",children:[n.jsx("h3",{className:"font-medium text-gray-900 truncate",children:q.title}),q.attachment_urls.length>0&&n.jsx(Wo,{className:"w-4 h-4 text-gray-400 flex-shrink-0"})]}),q.description&&n.jsx("p",{className:"text-sm text-gray-600 mt-1 line-clamp-2",children:q.description}),n.jsxs("div",{className:"flex flex-wrap items-center gap-3 mt-2",children:[w(q.status),n.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-600",children:[n.jsx(ja,{className:"w-4 h-4"}),T(q.deadline)]}),q.comment_count>0&&n.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-600",children:[n.jsx(U0,{className:"w-4 h-4"}),q.comment_count]}),q.inquiry_number&&n.jsxs("div",{className:"flex items-center gap-1 text-xs text-blue-600 bg-blue-50 px-2 py-1 rounded",children:[n.jsx(Gd,{className:"w-3 h-3"}),q.inquiry_number]}),q.customer_name&&n.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600 bg-gray-100 px-2 py-1 rounded",children:[n.jsx(Ao,{className:"w-3 h-3"}),q.customer_name]}),q.tags.length>0&&n.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600",children:[n.jsx(Qg,{className:"w-3 h-3"}),q.tags[0],q.tags.length>1&&` +${q.tags.length-1}`]})]})]})]}),n.jsxs("div",{className:"relative",children:[n.jsx("button",{onClick:z=>{z.stopPropagation(),y(g===q.id?null:q.id)},className:"p-1 hover:bg-gray-100 rounded transition",children:n.jsx(S7,{className:"w-5 h-5 text-gray-600"})}),g===q.id&&n.jsxs("div",{className:"absolute right-0 mt-1 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-10",children:[n.jsxs("button",{onClick:z=>{z.stopPropagation(),A(q),p(!0),y(null)},className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 flex items-center gap-2",children:[n.jsx(bi,{className:"w-4 h-4"}),"View Details"]}),(q.created_by===(e==null?void 0:e.id)||(t==null?void 0:t.role)==="admin")&&n.jsxs(n.Fragment,{children:[n.jsxs("button",{onClick:z=>{z.stopPropagation(),y(null)},className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 flex items-center gap-2",children:[n.jsx(Aa,{className:"w-4 h-4"}),"Edit Task"]}),n.jsxs("button",{onClick:z=>{z.stopPropagation(),R(q.id),y(null)},className:"w-full px-4 py-2 text-left text-sm text-red-600 hover:bg-red-50 flex items-center gap-2",children:[n.jsx(Lr,{className:"w-4 h-4"}),"Delete Task"]})]})]})]})]})},q.id))})]})]}),b&&n.jsx(oD,{isOpen:b,onClose:()=>m(!1),onSuccess:()=>{m(!1),B()}}),x&&h&&n.jsx(que,{isOpen:x,onClose:()=>{p(!1),A(null)},taskId:h.id,onUpdate:B})]})}function Kue({challan:e,items:t,onClose:r}){var u,f,h,A,x,p,b;const a=Q.useRef(null),s=()=>{window.print()},i=async()=>{if(a.current)try{const m=await Zo(a.current,{scale:2,useCORS:!0,allowTaint:!0,logging:!1,backgroundColor:"#ffffff",windowWidth:a.current.scrollWidth,windowHeight:a.current.scrollHeight,onclone:C=>{const k=C.getElementById("challan-print-content");k&&(k.style.width="210mm")}}),g=m.toDataURL("image/png",1),y=new Ut("p","mm","a4"),v=y.internal.pageSize.getWidth(),_=y.internal.pageSize.getHeight(),j=m.width,N=m.height,B=v/j,E=N*B;if(E>_){let C=0,k=E;for(;k>0;)y.addImage(g,"PNG",0,C,v,E),k-=_,C-=_,k>0&&y.addPage()}else y.addImage(g,"PNG",0,0,v,E);y.save(`Delivery-Challan-${e.challan_number}.pdf`)}catch(m){console.error("Error generating PDF:",m),alert("Failed to generate PDF. Please try again.")}},o=m=>{const g=new Date(m),y=g.getDate(),v=g.getMonth()+1,_=g.getFullYear();return`${y.toString().padStart(2,"0")}-${v.toString().padStart(2,"0")}-${_}`},l=m=>{const g=new Date(m),v=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][g.getMonth()],_=g.getFullYear();return`${v} ${_}`},c=t.reduce((m,g)=>m+g.quantity,0),d=((f=(u=t[0])==null?void 0:u.products)==null?void 0:f.unit)||"kg";return n.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto bg-gray-900 bg-opacity-75 print:static print:bg-white print:overflow-visible",children:[n.jsx("div",{className:"flex min-h-screen items-start justify-center p-4 pt-10 print:p-0 print:min-h-0 print:block",children:n.jsxs("div",{className:"relative w-full max-w-5xl bg-white shadow-xl print:shadow-none print:max-w-full",children:[n.jsxs("div",{className:"sticky top-0 z-10 flex items-center justify-between border-b bg-white px-6 py-4 print:hidden",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:["Surat Jalan ",e.challan_number]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("button",{onClick:s,className:"flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-2 text-white hover:bg-blue-700",children:[n.jsx($l,{className:"h-4 w-4"}),"Cetak"]}),n.jsxs("button",{onClick:i,className:"flex items-center gap-2 rounded-lg bg-green-600 px-4 py-2 text-white hover:bg-green-700",children:[n.jsx(Zn,{className:"h-4 w-4"}),"PDF"]}),n.jsx("button",{onClick:r,className:"rounded-lg bg-gray-100 p-2 text-gray-600 hover:bg-gray-200",children:n.jsx(wr,{className:"h-5 w-5"})})]})]}),n.jsxs("div",{id:"challan-print-content",ref:a,className:"p-8",children:[n.jsxs("div",{className:"mb-3 border-2 border-black p-3 print:mb-2 print:p-2",children:[n.jsxs("div",{className:"mb-2 flex items-start justify-between",children:[n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"h-16 w-16 flex items-center justify-center print:h-12 print:w-12",style:{backgroundColor:"#fff"},children:n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",xmlSpace:"preserve",width:"100%",height:"100%",viewBox:"0 0 15686.55 15480.24",style:{shapeRendering:"geometricPrecision",fillRule:"evenodd",clipRule:"evenodd"},children:n.jsxs("g",{children:[n.jsx("path",{fill:"#FDB763",d:"M69.94 10438.12l10353.39 0 0 -1798.67 1665.92 0 0 1868.6 0 320.44 0 4552.28c0,38.48 -31.45,69.94 -69.94,69.94l-11949.38 0c-38.48,0 -69.94,-31.45 -69.94,-69.94l0 -4872.72c0,-38.48 31.45,-69.94 69.94,-69.94zm1605.9 1710.15l8737.57 0c13.58,0 24.68,11.11 24.68,24.68l0 1719.84c0,13.58 -11.11,24.68 -24.68,24.68l-8737.57 0c-13.58,0 -24.68,-11.11 -24.68,-24.68l0 -1719.84c0,-13.58 11.11,-24.68 24.68,-24.68z"}),n.jsx("path",{fill:"#FDB763",d:"M15587.15 5136.67l-10353.49 0 0 1822.07 -1665.92 0 0 -1892.9 0 -324.61 0 -4611.43c0,-39 31.45,-70.87 69.94,-70.87l11949.47 0c38.48,0 69.94,31.87 69.94,70.87l0 4936.04c0,39 -31.45,70.83 -69.94,70.83zm-1605.9 -1732.36l-8737.67 0c-13.58,0 -24.68,-11.27 -24.68,-25l0 -1742.21c0,-13.74 11.11,-25 24.68,-25l8737.67 0c13.58,0 24.68,11.27 24.68,25l0 1742.21c0,13.74 -11.11,25 -24.68,25z"}),n.jsx("polygon",{fill:"#FD6D26",points:"-0,0 1651.16,0 1651.16,6929.27 15657.09,6929.27 15657.09,6958.74 15686.55,6958.74 15686.55,15480.24 14022.85,15480.24 14022.85,8639.45 1651.16,8639.45 -0,8639.45 -0,6929.27"})]})})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-base font-bold print:text-sm",children:"PT. SHUBHAM ANZEN PHARMA JAYA"}),n.jsx("p",{className:"text-xs print:text-[10px]",children:"Komplek Ruko Metro Sunter Blok A1 NO.15, Jl. Metro Indah Raya,"}),n.jsx("p",{className:"text-xs print:text-[10px]",children:"Kelurahan Papanggo, Kec. Tanjung Priok, Jakarta Utara - 14340"}),n.jsx("p",{className:"text-xs print:text-[10px]",children:"Telp: (+62 21) 65832426"})]})]}),n.jsx("div",{className:"text-right",children:n.jsx("h2",{className:"text-3xl font-bold print:text-2xl",children:"SURAT JALAN"})})]}),n.jsxs("div",{className:"text-xs space-y-0.5 print:text-[10px] print:space-y-0",children:[n.jsxs("div",{children:[n.jsx("span",{className:"font-semibold",children:"No izin PBF"}),n.jsx("span",{className:"ml-16",children:": 27092400534390007"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"font-semibold",children:"No Sertifikasi CDOB"}),n.jsx("span",{className:"ml-4",children:": 270924005343900070001"})]})]})]}),n.jsx("div",{className:"mb-3 border-2 border-black p-3 print:mb-2 print:p-2",children:n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("div",{className:"space-y-1 text-xs print:text-[10px] print:space-y-0 flex-1",children:[n.jsx("div",{className:"mb-1",children:n.jsx("span",{className:"font-bold",children:"Company Name:"})}),n.jsx("div",{className:"ml-4 mb-2",children:n.jsx("p",{className:"font-semibold",children:((h=e.customers)==null?void 0:h.company_name)||""})}),n.jsx("div",{className:"mb-1",children:n.jsx("span",{className:"font-bold",children:"Address:"})}),n.jsxs("div",{className:"ml-4 mb-2",children:[n.jsx("p",{children:e.delivery_address||""}),n.jsx("p",{children:((A=e.customers)==null?void 0:A.city)||""})]}),n.jsxs("div",{className:"mb-1",children:[n.jsx("span",{className:"font-bold",children:"Phone:"}),n.jsx("span",{className:"ml-2",children:((x=e.customers)==null?void 0:x.phone)||"-"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"font-bold",children:"No.Izin PBF:"}),n.jsx("span",{className:"ml-2",children:((p=e.customers)==null?void 0:p.pbf_license)||"-"})]})]}),n.jsxs("div",{className:"space-y-1 text-xs print:text-[10px] print:space-y-0 text-right w-64",children:[n.jsxs("div",{className:"mb-1",children:[n.jsx("span",{className:"font-bold",children:"Challan No: "}),n.jsx("span",{children:e.challan_number})]}),n.jsxs("div",{className:"mb-1",children:[n.jsx("span",{className:"font-bold",children:"Challan Date: "}),n.jsx("span",{children:o(e.challan_date)})]}),e.vehicle_number&&n.jsxs("div",{children:[n.jsx("span",{className:"font-bold",children:"Vehicle No: "}),n.jsx("span",{children:e.vehicle_number})]})]})]})}),n.jsx("div",{className:"mb-2 border-2 border-black print:mb-1.5",children:n.jsxs("table",{className:"w-full border-collapse text-[9px] print:text-[8px]",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"border-b-2 border-black",children:[n.jsx("th",{className:"border-r border-black px-1 py-1.5 text-center font-bold print:px-0.5 print:py-1",style:{width:"3%"},children:"No"}),n.jsxs("th",{className:"border-r border-black px-1 py-1.5 text-left font-bold print:px-0.5 print:py-1",style:{width:"27%"},children:["Nama Produk",n.jsx("br",{}),"Product Name"]}),n.jsxs("th",{className:"border-r border-black px-1 py-1.5 text-center font-bold print:px-0.5 print:py-1",style:{width:"13%"},children:["No Batch",n.jsx("br",{}),"Batch No"]}),n.jsxs("th",{className:"border-r border-black px-1 py-1.5 text-center font-bold print:px-0.5 print:py-1",style:{width:"8%"},children:["Exp.",n.jsx("br",{}),"Date"]}),n.jsxs("th",{className:"border-r border-black px-1 py-1.5 text-center font-bold print:px-0.5 print:py-1",style:{width:"15%"},children:["Kemasan",n.jsx("br",{}),"Packaging"]}),n.jsxs("th",{className:"border-r border-black px-1 py-1.5 text-center font-bold print:px-0.5 print:py-1",style:{width:"6%"},children:["Jml",n.jsx("br",{}),"Packs"]}),n.jsxs("th",{className:"px-1 py-1.5 text-center font-bold print:px-0.5 print:py-1",style:{width:"10%"},children:["Kuantitas",n.jsx("br",{}),"Quantity"]})]})}),n.jsxs("tbody",{children:[t.map((m,g)=>{var y,v,_,j,N;return n.jsxs("tr",{className:"border-b border-black",children:[n.jsx("td",{className:"border-r border-black px-1 py-1 text-center print:px-0.5 print:py-0.5",children:g+1}),n.jsx("td",{className:"border-r border-black px-1 py-1 print:px-0.5 print:py-0.5",children:(y=m.products)==null?void 0:y.product_name}),n.jsx("td",{className:"border-r border-black px-1 py-1 text-center print:px-0.5 print:py-0.5",children:(v=m.batches)==null?void 0:v.batch_number}),n.jsx("td",{className:"border-r border-black px-1 py-1 text-center print:px-0.5 print:py-0.5",children:(_=m.batches)!=null&&_.expiry_date?l(m.batches.expiry_date):"-"}),n.jsx("td",{className:"border-r border-black px-1 py-1 text-center print:px-0.5 print:py-0.5",children:m.pack_type&&m.pack_size&&m.number_of_packs?`${m.pack_size} ${((j=m.products)==null?void 0:j.unit)||"kg"}/${m.pack_type}`:m.pack_type&&m.pack_size?`${m.pack_size} ${m.pack_type}`:"-"}),n.jsx("td",{className:"border-r border-black px-1 py-1 text-center print:px-0.5 print:py-0.5",children:m.number_of_packs||"-"}),n.jsxs("td",{className:"px-1 py-1 text-center print:px-0.5 print:py-0.5",children:[m.quantity.toLocaleString()," ",((N=m.products)==null?void 0:N.unit)||d]})]},m.id)}),n.jsxs("tr",{className:"border-t-2 border-black bg-gray-50 font-bold",children:[n.jsx("td",{colSpan:6,className:"border-r border-black px-1 py-1 text-right print:px-0.5 print:py-0.5",children:"Total Kuantitas / Total Quantity:"}),n.jsxs("td",{className:"px-1 py-1 text-center print:px-0.5 print:py-0.5",children:[c.toLocaleString()," ",d]})]})]})]})}),n.jsxs("div",{className:"mb-2 p-1.5 print:mb-1.5 print:p-1",children:[n.jsx("p",{className:"text-[9px] font-semibold print:text-[8px]",children:"Catatan / Notes:"}),e.notes?n.jsx("p",{className:"text-[9px] print:text-[8px] mt-0.5",children:e.notes}):n.jsx("p",{className:"text-[9px] print:text-[8px] mt-0.5",children:"Produk dikirim dalam kondisi sesuai persyaratan penyimpanan / Goods are delivered under controlled storage conditions."})]}),n.jsxs("div",{className:"grid grid-cols-4 gap-2 print:gap-1.5",children:[n.jsxs("div",{className:"border-2 border-black p-1.5 text-center print:p-1",children:[n.jsxs("div",{className:"mb-1.5 text-[9px] font-semibold print:mb-1 print:text-[8px]",children:["Disiapkan Oleh",n.jsx("br",{}),"Prepared By"]}),n.jsx("div",{className:"mb-8 print:mb-6",children:n.jsx("div",{className:"h-10 print:h-8"})}),n.jsxs("div",{className:"border-t-2 border-black pt-1.5 print:pt-1",children:[n.jsx("p",{className:"text-[9px] print:text-[8px]",children:"Tanda Tangan & Tanggal"}),n.jsx("p",{className:"text-[9px] print:text-[8px]",children:"Signature & Date"}),n.jsx("p",{className:"text-[8px] font-semibold mt-0.5 print:text-[7px] print:mt-0",children:"PT. SHUBHAM ANZEN PHARMA JAYA"})]})]}),n.jsxs("div",{className:"border-2 border-black p-1.5 text-center print:p-1",children:[n.jsxs("div",{className:"mb-1.5 text-[9px] font-semibold print:mb-1 print:text-[8px]",children:["Dikirim Oleh",n.jsx("br",{}),"Delivered By"]}),n.jsx("div",{className:"mb-8 print:mb-6",children:n.jsx("div",{className:"h-10 print:h-8"})}),n.jsxs("div",{className:"border-t-2 border-black pt-1.5 print:pt-1",children:[n.jsx("p",{className:"text-[9px] print:text-[8px]",children:"Tanda Tangan & Tanggal"}),n.jsx("p",{className:"text-[9px] print:text-[8px]",children:"Signature & Date"}),n.jsx("p",{className:"text-[8px] font-semibold mt-0.5 print:text-[7px] print:mt-0",children:"PT. SHUBHAM ANZEN PHARMA JAYA"})]})]}),n.jsxs("div",{className:"border-2 border-black p-1.5 text-center print:p-1",children:[n.jsxs("div",{className:"mb-1.5 text-[9px] font-semibold print:mb-1 print:text-[8px]",children:["Farmasi",n.jsx("br",{}),"Pharmacist"]}),n.jsx("div",{className:"mb-8 print:mb-6",children:n.jsx("div",{className:"h-10 print:h-8"})}),n.jsxs("div",{className:"border-t-2 border-black pt-1.5 print:pt-1",children:[n.jsx("p",{className:"text-[9px] print:text-[8px]",children:"Tanda Tangan & Tanggal"}),n.jsx("p",{className:"text-[9px] print:text-[8px]",children:"Signature & Date"}),n.jsx("p",{className:"text-[8px] font-semibold mt-0.5 print:text-[7px] print:mt-0",children:"PT. SHUBHAM ANZEN PHARMA JAYA"})]})]}),n.jsxs("div",{className:"border-2 border-black p-1.5 text-center print:p-1",children:[n.jsxs("div",{className:"mb-1.5 text-[9px] font-semibold print:mb-1 print:text-[8px]",children:["Diterima Oleh",n.jsx("br",{}),"Received By"]}),n.jsx("div",{className:"mb-8 print:mb-6",children:n.jsx("div",{className:"h-10 print:h-8"})}),n.jsxs("div",{className:"border-t-2 border-black pt-1.5 print:pt-1",children:[n.jsx("p",{className:"text-[9px] print:text-[8px]",children:"Tanda Tangan & Tanggal"}),n.jsx("p",{className:"text-[9px] print:text-[8px]",children:"Signature & Date"}),n.jsx("p",{className:"text-[8px] font-semibold mt-0.5 print:text-[7px] print:mt-0",children:((b=e.customers)==null?void 0:b.company_name)||""})]})]})]})]})]})}),n.jsx("style",{children:`
        @media print {
          @page {
            size: A4 portrait;
            margin: 8mm;
          }

          .sticky {
            display: none !important;
          }

          body {
            margin: 0;
            padding: 0;
          }

          body * {
            visibility: hidden;
          }

          #challan-print-content,
          #challan-print-content * {
            visibility: visible;
          }

          #challan-print-content {
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            page-break-inside: avoid;
            page-break-after: auto;
          }

          #challan-print-content > div {
            page-break-inside: avoid;
          }

          table {
            page-break-inside: auto;
          }

          tr {
            page-break-inside: avoid;
            page-break-after: auto;
          }

          thead {
            display: table-header-group;
          }

          tfoot {
            display: table-footer-group;
          }
        }
      `})]})}const Vue=e=>e?new Date(e)<new Date:!1;function Wue(){const{profile:e}=Cr(),{setCurrentPage:t,setNavigationData:r}=Go(),[a,s]=Q.useState([]),[i,o]=Q.useState([]),[l,c]=Q.useState([]),[d,u]=Q.useState([]),[f,h]=Q.useState(!0),[A,x]=Q.useState(!1),[p,b]=Q.useState(!1),[m,g]=Q.useState(null),[y,v]=Q.useState([]),[_,j]=Q.useState(null),[N,B]=Q.useState(null),[E,C]=Q.useState([]),[k,w]=Q.useState(!1),[T,R]=Q.useState(""),[q,z]=Q.useState(null),[ee,Y]=Q.useState({challan_number:"",customer_id:"",sales_order_id:"",challan_date:new Date().toISOString().split("T")[0],delivery_address:"",vehicle_number:"",driver_name:"",notes:""}),[G,re]=Q.useState([]),[U,S]=Q.useState([{product_id:"",batch_id:"",quantity:0,pack_size:null,pack_type:null,number_of_packs:null}]);Q.useEffect(()=>{P(),H(),V(),W(),L()},[]);const D=async Fe=>{try{let oe=Z.from("sales_orders").select(`
          id,
          so_number,
          customer_id,
          status,
          customers(company_name)
        `).in("status",["approved","stock_reserved","shortage","pending_delivery"]).eq("is_archived",!1).order("so_date",{ascending:!1});Fe&&(oe=oe.eq("customer_id",Fe));const{data:ke,error:Ue}=await oe;if(Ue)throw Ue;re(ke||[])}catch(oe){console.error("Error loading sales orders:",oe)}},L=async()=>{try{const{data:Fe,error:oe}=await Z.from("app_settings").select("*").limit(1).maybeSingle();if(oe)throw oe;j(Fe)}catch(Fe){console.error("Error loading company settings:",Fe)}},P=async()=>{try{const{data:Fe,error:oe}=await Z.from("delivery_challans").select("*, customers(company_name, address, city, phone, pbf_license)").order("challan_date",{ascending:!1});if(oe)throw oe;const{data:ke,error:Ue}=await Z.from("dc_invoicing_summary").select("*");Ue&&console.error("Error loading invoicing status:",Ue);const qe=new Map;(ke||[]).forEach(Ne=>{qe.set(Ne.challan_id,{status:Ne.dc_status,total_items:Ne.total_items,not_invoiced_items:Ne.not_invoiced_items,partially_invoiced_items:Ne.partially_invoiced_items,fully_invoiced_items:Ne.fully_invoiced_items,linked_invoices:Ne.linked_invoice_numbers||[]})});const $e=(Fe||[]).map(Ne=>{const Ee=qe.get(Ne.id);return{...Ne,invoicing_status:(Ee==null?void 0:Ee.status)||"not_invoiced",total_items:(Ee==null?void 0:Ee.total_items)||0,invoiced_items:(Ee==null?void 0:Ee.fully_invoiced_items)+(Ee==null?void 0:Ee.partially_invoiced_items)||0,linked_invoices:(Ee==null?void 0:Ee.linked_invoices)||[]}});s($e)}catch(Fe){console.error("Error loading challans:",Fe)}finally{h(!1)}},I=async()=>{try{const{data:Fe,error:oe}=await Z.rpc("get_current_financial_year");if(oe)return console.error("Error getting financial year:",oe),`DO-${new Date().getFullYear().toString().slice(-2)}-0001`;const ke="DO",{data:Ue}=await Z.from("delivery_challans").select("challan_number").or(`challan_number.like.DO-${Fe}%,challan_number.like.DC-${Fe}%`);let qe=1;if(Ue&&Ue.length>0){const Ne=Ue.map(Ee=>{const ze=Ee.challan_number.match(/(\d+)$/);return ze?parseInt(ze[1],10):0}).filter(Ee=>!isNaN(Ee));Ne.length>0&&(qe=Math.max(...Ne)+1)}const $e=String(qe).padStart(4,"0");return`${ke}-${Fe}-${$e}`}catch(Fe){return console.error("Error generating challan number:",Fe),`DO-${new Date().getFullYear().toString().slice(-2)}-0001`}},H=async()=>{try{const{data:Fe,error:oe}=await Z.from("customers").select("id, company_name, address, city").eq("is_active",!0).order("company_name");if(oe)throw oe;o(Fe||[])}catch(Fe){console.error("Error loading customers:",Fe)}},V=async()=>{try{const{data:Fe,error:oe}=await Z.from("products").select("id, product_name, product_code, unit").eq("is_active",!0).order("product_name");if(oe)throw oe;c(Fe||[])}catch(Fe){console.error("Error loading products:",Fe)}},W=async()=>{try{const{data:Fe,error:oe}=await Z.from("batches").select("id, batch_number, product_id, current_stock, reserved_stock, expiry_date, packaging_details, import_date").eq("is_active",!0).gt("current_stock",0).order("import_date",{ascending:!0});if(oe)throw oe;u(Fe||[])}catch(Fe){console.error("Error loading batches:",Fe)}},M=async Fe=>{try{const{data:oe,error:ke}=await Z.from("delivery_challan_items").select("*, products(product_name, product_code, unit), batches(batch_number, expiry_date, packaging_details, current_stock)").eq("challan_id",Fe);if(ke)throw ke;return oe||[]}catch(oe){return console.error("Error loading challan items:",oe),[]}},se=Fe=>d.filter(ke=>ke.product_id===Fe&&!Vue(ke.expiry_date)).sort((ke,Ue)=>{const qe=new Date(ke.import_date).getTime(),$e=new Date(Ue.import_date).getTime();return qe-$e})[0]||null,K=Fe=>{const oe=i.find(ke=>ke.id===Fe);oe&&(Y({...ee,customer_id:Fe,sales_order_id:"",delivery_address:`${oe.address}, ${oe.city}`}),D(Fe))},he=async Fe=>{if(Y({...ee,sales_order_id:Fe}),Fe){const oe=G.find(ke=>ke.id===Fe);if(oe){Y(ke=>({...ke,customer_id:oe.customer_id}));try{const{data:ke,error:Ue}=await Z.from("sales_order_items").select(`
              id,
              product_id,
              quantity,
              products(product_name)
            `).eq("sales_order_id",Fe);if(Ue)throw Ue;if(ke&&ke.length>0){const qe=ke.map($e=>{const Ne=d.filter(mt=>mt.product_id===$e.product_id&&mt.current_stock-(mt.reserved_stock||0)>0),Ee=Ne.length>0?Ne[0]:null;if(!Ee)return{product_id:$e.product_id,batch_id:"",quantity:$e.quantity,pack_size:null,pack_type:null,number_of_packs:null};let ze=null,rt=null,nt=null;if(Ee.packaging_details){const mt=Ee.packaging_details.match(/(\d+)\s+(\w+)s?\s+x\s+(\d+(?:\.\d+)?)kg/i);mt&&(nt=parseInt(mt[1],10),rt=mt[2].toLowerCase(),ze=parseFloat(mt[3]))}return{product_id:$e.product_id,batch_id:Ee.id,quantity:$e.quantity,pack_size:ze,pack_type:rt,number_of_packs:nt||1}});S(qe)}}catch(ke){console.error("Error loading SO items:",ke),alert("Failed to load Sales Order items. Please try again.")}}}else S([{product_id:"",batch_id:"",quantity:0,pack_size:null,pack_type:null,number_of_packs:null}])},ne=(Fe,oe)=>{const ke=d.find(Ue=>Ue.id===oe);if(ke){const Ue=[...U];let qe=null,$e=null,Ne=null;if(ke.packaging_details){const ze=ke.packaging_details.match(/(\d+)\s+(\w+)s?\s+x\s+(\d+(?:\.\d+)?)kg/i);if(ze){$e=ze[2].toLowerCase(),qe=parseFloat(ze[3]);const rt=ke.current_stock-(ke.reserved_stock||0);qe&&qe>0?Ne=Math.floor(rt/qe)>=1?1:0:Ne=1}}const Ee=qe&&Ne?qe*Ne:0;Ue[Fe]={...Ue[Fe],batch_id:oe,pack_size:qe,pack_type:$e,number_of_packs:Ne||1,quantity:Ee},S(Ue)}},te=(Fe,oe)=>{const ke=[...U],Ue=ke[Fe];Ue.pack_size&&(ke[Fe]={...Ue,number_of_packs:oe,quantity:Ue.pack_size*oe},S(ke))},ce=()=>{S([...U,{product_id:"",batch_id:"",quantity:0,pack_size:null,pack_type:null,number_of_packs:null}])},_e=Fe=>{U.length>1&&S(U.filter((oe,ke)=>ke!==Fe))},de=async Fe=>{const{data:oe}=await Z.from("delivery_challans").select("*").eq("id",Fe.id).single();B(Fe),Y({challan_number:Fe.challan_number,customer_id:Fe.customer_id,sales_order_id:(oe==null?void 0:oe.sales_order_id)||"",challan_date:Fe.challan_date,delivery_address:Fe.delivery_address,vehicle_number:Fe.vehicle_number||"",driver_name:Fe.driver_name||"",notes:Fe.notes||""});const ke=await M(Fe.id);C(ke),ke.length>0&&S(ke.map(Ue=>({product_id:Ue.product_id,batch_id:Ue.batch_id,quantity:Ue.quantity,pack_size:Ue.pack_size,pack_type:Ue.pack_type,number_of_packs:Ue.number_of_packs}))),x(!0)},ye=async Fe=>{if(Fe.preventDefault(),U.filter($e=>!$e.product_id||!$e.batch_id||$e.quantity<=0).length>0){alert("Please select product, batch, and enter quantity for all items before saving.");return}if(U.filter($e=>!$e.batch_id||$e.batch_id==="").length>0){alert("Some items do not have a batch selected. Please select a batch for all items.");return}if(U.filter($e=>!$e.product_id||$e.product_id==="").length>0){alert("Some items do not have a product selected. Please select a product for all items.");return}const qe=new Map;for(const $e of U){const Ne=qe.get($e.batch_id)||0;qe.set($e.batch_id,Ne+$e.quantity)}for(const[$e,Ne]of qe.entries()){const Ee=d.find(ze=>ze.id===$e);if(Ee){let ze=Ee.current_stock-(Ee.reserved_stock||0);if(N){const rt=E.filter(nt=>nt.batch_id===$e).reduce((nt,mt)=>nt+mt.quantity,0);ze+=rt}if(Ne>ze){const rt=l.find(mt=>{var gt;return mt.id===((gt=U.find(Nt=>Nt.batch_id===$e))==null?void 0:gt.product_id)}),nt=(rt==null?void 0:rt.unit)||"kg";alert(`Insufficient available stock for batch ${Ee.batch_number}!

Product: ${(rt==null?void 0:rt.product_name)||"Unknown"}
Batch: ${Ee.batch_number}
Available: ${ze} ${nt}
Total Requested (across all items): ${Ne} ${nt}

You are using this batch in multiple items. Please reduce quantities or select different batches.`);return}}}try{const{data:{user:$e}}=await Z.auth.getUser();if(!$e)throw new Error("Not authenticated");let Ne;if(N){const Ee={customer_id:ee.customer_id,sales_order_id:ee.sales_order_id||null,challan_date:ee.challan_date,delivery_address:ee.delivery_address,vehicle_number:ee.vehicle_number||null,driver_name:ee.driver_name||null,notes:ee.notes||null},{data:ze,error:rt}=await Z.from("delivery_challans").update(Ee).eq("id",N.id).select().single();if(rt)throw rt;const nt=U.map(Nt=>({product_id:Nt.product_id,batch_id:Nt.batch_id,quantity:Nt.quantity,pack_size:Nt.pack_size,pack_type:Nt.pack_type,number_of_packs:Nt.number_of_packs})),{data:mt,error:gt}=await Z.rpc("edit_delivery_challan",{p_challan_id:N.id,p_new_items:nt});if(gt)throw console.error("RPC Error:",gt),new Error(`Failed to update DC: ${gt.message}`);if(!(mt!=null&&mt.success))throw console.error("RPC Result Error:",mt==null?void 0:mt.error),new Error((mt==null?void 0:mt.error)||"Failed to update DC items");Ne=ze.id}else{const Ee={challan_number:ee.challan_number,customer_id:ee.customer_id,sales_order_id:ee.sales_order_id||null,challan_date:ee.challan_date,delivery_address:ee.delivery_address,vehicle_number:ee.vehicle_number||null,driver_name:ee.driver_name||null,notes:ee.notes||null,approval_status:"pending_approval",created_by:$e.id},{data:ze,error:rt}=await Z.from("delivery_challans").insert([Ee]).select().single();if(rt)throw rt;Ne=ze.id}if(!N){const Ee=U.map(rt=>({challan_id:Ne,product_id:rt.product_id,batch_id:rt.batch_id,quantity:rt.quantity,pack_size:rt.pack_size,pack_type:rt.pack_type,number_of_packs:rt.number_of_packs})),{error:ze}=await Z.from("delivery_challan_items").insert(Ee);if(ze)throw await Z.from("delivery_challans").delete().eq("id",Ne),ze}if(!N&&ee.sales_order_id){const Ee=U.map(nt=>({product_id:nt.product_id,quantity:nt.quantity})),{error:ze}=await Z.rpc("update_so_delivered_quantity_atomic",{p_sales_order_id:ee.sales_order_id,p_dc_items:Ee});if(ze)throw ze;const{data:rt}=await Z.from("sales_orders").select("status").eq("id",ee.sales_order_id).single();(rt==null?void 0:rt.status)==="delivered"&&await Z.from("sales_orders").update({is_archived:!0,archived_at:new Date().toISOString(),archived_by:$e.id,archive_reason:"Delivery Challan created and all items delivered"}).eq("id",ee.sales_order_id)}x(!1),Re(),P(),W(),alert(`Delivery Challan ${N?"updated":"created"} successfully!`)}catch($e){console.error("Error saving challan:",$e),console.error("Full error object:",JSON.stringify($e,null,2));const Ne=($e==null?void 0:$e.message)||($e==null?void 0:$e.error_description)||($e==null?void 0:$e.msg)||"Unknown error occurred";Ne.toLowerCase().includes("insufficient stock")?alert(`Cannot save: ${Ne}

Please reduce quantities or select different batches with more stock.`):Ne.includes("batch_id")?alert(`Error: Invalid batch selection.

${Ne}

Please ensure all items have a valid batch selected.`):Ne.includes("foreign key")?alert(`Error: Invalid product or batch selection.

${Ne}

Please check your selections.`):alert(`Failed to save challan:

${Ne}`)}},Le=async Fe=>{if(confirm("Are you sure you want to delete this delivery challan? This will revert the linked Sales Order status."))try{const{data:oe}=await Z.from("delivery_challans").select("sales_order_id, id").eq("id",Fe).single(),{error:ke}=await Z.from("delivery_challans").delete().eq("id",Fe);if(ke)throw ke;oe!=null&&oe.sales_order_id&&await Z.from("sales_orders").update({status:"pending_delivery",is_archived:!1,archived_at:null,archived_by:null,archive_reason:null}).eq("id",oe.sales_order_id),P(),alert("Delivery Challan deleted successfully. Sales Order status has been reverted.")}catch(oe){console.error("Error deleting challan:",oe),alert("Failed to delete challan. Please try again.")}},we=async Fe=>{if(confirm("Approve this Delivery Challan? Stock will be deducted and it will be available for invoice creation."))try{const{data:{user:oe}}=await Z.auth.getUser();if(!oe)throw new Error("Not authenticated");const{error:ke}=await Z.from("delivery_challans").update({approval_status:"approved",approved_by:oe.id,approved_at:new Date().toISOString()}).eq("id",Fe);if(ke){console.error("Approval error:",ke);const Ue=ke.message||ke.hint||"Unknown error";throw new Error(Ue)}alert("Delivery Challan approved successfully!"),P()}catch(oe){console.error("Error approving challan:",oe);const ke=(oe==null?void 0:oe.message)||"Unknown error";ke.toLowerCase().includes("insufficient stock")?alert(`Cannot approve - Insufficient Stock!

${ke}

Please edit the DC and reduce quantities or select different batches.`):alert(`Failed to approve challan:

${ke}`)}},ge=async()=>{if(!q||!T.trim()){alert("Please enter a rejection reason");return}try{const{data:{user:Fe}}=await Z.auth.getUser();if(!Fe)throw new Error("Not authenticated");const{error:oe}=await Z.from("delivery_challans").update({approval_status:"rejected",rejected_by:Fe.id,rejected_at:new Date().toISOString(),rejection_reason:T}).eq("id",q);if(oe)throw oe;alert("Delivery Challan rejected"),w(!1),R(""),z(null),P()}catch(Fe){console.error("Error rejecting challan:",Fe.message),alert("Failed to reject challan")}},Re=()=>{B(null),C([]),Y({challan_number:"",customer_id:"",sales_order_id:"",challan_date:new Date().toISOString().split("T")[0],delivery_address:"",vehicle_number:"",driver_name:"",notes:""}),S([{product_id:"",batch_id:"",quantity:0,pack_size:null,pack_type:null,number_of_packs:null}])},et=[{key:"challan_number",label:"DO Number"},{key:"customer",label:"Customer",render:(Fe,oe)=>{var ke;return n.jsx("div",{className:"font-medium",children:(ke=oe.customers)==null?void 0:ke.company_name})}},{key:"challan_date",label:"Date",render:(Fe,oe)=>new Date(oe.challan_date).toLocaleDateString()},{key:"approval_status",label:"Status / Approval",render:(Fe,oe)=>{const ke={pending_approval:"bg-yellow-100 text-yellow-800",approved:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800"},Ue={pending_approval:"Pending Approval",approved:"Approved",rejected:"Rejected"};return n.jsxs("div",{className:"flex items-center justify-center gap-2",children:[n.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${ke[oe.approval_status]}`,children:Ue[oe.approval_status]}),oe.approval_status==="pending_approval"&&(e==null?void 0:e.role)==="admin"&&n.jsxs("div",{className:"flex items-center gap-1 ml-2",children:[n.jsx("button",{onClick:qe=>{qe.stopPropagation(),we(oe.id)},className:"p-2 bg-green-100 hover:bg-green-200 rounded-lg transition-colors",title:"Approve Delivery Challan",children:n.jsx(Zr,{className:"w-6 h-6 text-green-600"})}),n.jsx("button",{onClick:qe=>{qe.stopPropagation(),z(oe.id),w(!0)},className:"p-2 bg-red-100 hover:bg-red-200 rounded-lg transition-colors",title:"Reject Delivery Challan",children:n.jsx(gn,{className:"w-6 h-6 text-red-600"})})]}),oe.approval_status==="approved"&&n.jsx(Zr,{className:"w-5 h-5 text-green-600 ml-2",title:"Approved"}),oe.approval_status==="rejected"&&n.jsx(gn,{className:"w-5 h-5 text-red-600 ml-2",title:"Rejected"})]})}},{key:"invoicing_status",label:"Invoicing Status",render:(Fe,oe)=>{const ke={not_invoiced:"bg-gray-100 text-gray-700",partially_invoiced:"bg-yellow-100 text-yellow-700",fully_invoiced:"bg-blue-100 text-blue-700"},Ue={not_invoiced:"Not Invoiced",partially_invoiced:"Partially Invoiced",fully_invoiced:"Fully Invoiced"},qe=oe.invoicing_status||"not_invoiced";return n.jsxs("div",{className:"space-y-1",children:[n.jsx("span",{className:`inline-block px-2 py-1 rounded-full text-xs font-medium ${ke[qe]}`,children:Ue[qe]}),oe.total_items>0&&n.jsxs("div",{className:"text-xs text-gray-500",children:[oe.invoiced_items||0,"/",oe.total_items," items invoiced"]}),oe.linked_invoices&&oe.linked_invoices.length>0&&n.jsx("div",{className:"text-xs text-blue-600 font-medium",children:oe.linked_invoices.join(", ")})]})}}],Ye=(e==null?void 0:e.role)==="admin"||(e==null?void 0:e.role)==="accounts"||(e==null?void 0:e.role)==="sales"||(e==null?void 0:e.role)==="warehouse",Be={total:a.length};return n.jsx(Un,{children:n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Delivery Challan (Surat Jalan)"}),n.jsx("p",{className:"text-gray-600 mt-1",children:"Manage delivery orders and dispatch records"})]}),Ye&&n.jsxs("button",{onClick:async()=>{Re();const Fe=await I();Y(oe=>({...oe,challan_number:Fe})),x(!0)},className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition",children:[n.jsx(Pr,{className:"w-5 h-5"}),"Create Delivery Challan"]})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[n.jsx("p",{className:"text-sm text-gray-600",children:"Total Delivery Challans"}),n.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:Be.total})]}),n.jsx(Fs,{columns:et,data:a,loading:f,actions:Fe=>n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:async()=>{const oe=await M(Fe.id);g(Fe),v(oe),b(!0)},className:"p-1 text-blue-600 hover:bg-blue-50 rounded",title:"View Challan",children:n.jsx(bi,{className:"w-4 h-4"})}),Ye&&n.jsxs(n.Fragment,{children:[n.jsx("button",{onClick:async()=>{const oe=await M(Fe.id);r({sourceType:"delivery_challan",customerId:Fe.customer_id,challanNumber:Fe.challan_number,challanId:Fe.id,items:oe}),t("sales")},className:"p-1 text-purple-600 hover:bg-purple-50 rounded",title:"Create Invoice from DO",children:n.jsx(Zt,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>de(Fe),className:"p-1 text-green-600 hover:bg-green-50 rounded",title:"Edit Challan",children:n.jsx(Aa,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>Le(Fe.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Delete Challan",children:n.jsx(Lr,{className:"w-4 h-4"})})]})]})}),n.jsx(Ot,{isOpen:A,onClose:()=>{x(!1),Re()},title:N?`Edit DC - ${ee.challan_number}`:`Create DC - ${ee.challan_number}`,size:"xl",children:n.jsxs("form",{onSubmit:ye,className:"space-y-3",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer *"}),n.jsx(Qo,{value:ee.customer_id,onChange:K,options:i.map(Fe=>({value:Fe.id,label:Fe.company_name})),placeholder:"Select Customer",required:!0,disabled:!!ee.sales_order_id})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Linked Sales Order"}),n.jsx(Qo,{value:ee.sales_order_id,onChange:he,options:[{value:"",label:"No Sales Order / Manual Entry"},...G.map(Fe=>({value:Fe.id,label:`${Fe.so_number} (${Fe.status})`}))],placeholder:"Select Sales Order",disabled:!ee.customer_id}),ee.customer_id&&G.length===0&&n.jsx("p",{className:"text-xs text-orange-600 mt-1",children:" No active sales orders for this customer"}),!ee.customer_id&&n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Select a customer first"})]})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vehicle Number"}),n.jsx("input",{type:"text",value:ee.vehicle_number,onChange:Fe=>Y({...ee,vehicle_number:Fe.target.value}),className:"w-full px-3 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"B 1234 XYZ"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Driver Name"}),n.jsx("input",{type:"text",value:ee.driver_name,onChange:Fe=>Y({...ee,driver_name:Fe.target.value}),className:"w-full px-3 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Driver name"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date *"}),n.jsx("input",{type:"date",value:ee.challan_date,onChange:Fe=>Y({...ee,challan_date:Fe.target.value}),className:"w-full px-3 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Delivery Address *"}),n.jsx("textarea",{value:ee.delivery_address,onChange:Fe=>Y({...ee,delivery_address:Fe.target.value}),className:"w-full px-3 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:2,required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),n.jsx("textarea",{value:ee.notes,onChange:Fe=>Y({...ee,notes:Fe.target.value}),className:"w-full px-3 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:2,placeholder:"Additional notes..."})]})]}),n.jsxs("div",{className:"border-t pt-3 mt-3",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:"Items to Dispatch"}),n.jsx("button",{type:"button",onClick:ce,className:"text-sm px-3 py-1 bg-blue-50 text-blue-600 hover:bg-blue-100 rounded-lg font-medium transition-colors",children:"+ Add Item"})]}),n.jsx("div",{className:"space-y-2",children:U.map((Fe,oe)=>{const ke=new Map;U.forEach(($e,Ne)=>{if(Ne!==oe&&$e.batch_id){const Ee=ke.get($e.batch_id)||0;ke.set($e.batch_id,Ee+$e.quantity)}});const Ue=d.filter($e=>{const Ne=$e.current_stock-($e.reserved_stock||0),Ee=ke.get($e.id)||0;return $e.product_id===Fe.product_id&&Ne-Ee>0}),qe=d.find($e=>$e.id===Fe.batch_id);return n.jsxs("div",{className:"relative p-2 bg-gray-50 rounded border border-gray-200",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-2",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-600 mb-0.5",children:"Product *"}),n.jsx(Qo,{value:Fe.product_id,onChange:$e=>{const Ne=[...U];Ne[oe]={...Ne[oe],product_id:$e,batch_id:""},S(Ne)},options:l.map($e=>({value:$e.id,label:$e.product_name})),placeholder:"Select Product",className:"text-xs",required:!0})]}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center justify-between mb-0.5",children:[n.jsx("label",{className:"block text-xs text-gray-600",children:"Batch *"}),Fe.product_id&&Ue.length>0&&n.jsx("button",{type:"button",onClick:()=>{const $e=se(Fe.product_id);$e&&ne(oe,$e.id)},className:"text-[10px] text-blue-600 hover:text-blue-700 font-medium",title:"Select oldest batch (FIFO)",children:"Use FIFO"})]}),Fe.product_id?Ue.length>0?n.jsx(Qo,{value:Fe.batch_id,onChange:$e=>ne(oe,$e),options:Ue.map(($e,Ne)=>{const Ee=Ne===0?" ":"",ze=$e.current_stock-($e.reserved_stock||0),rt=ke.get($e.id)||0,nt=ze-rt;return{value:$e.id,label:`${$e.batch_number} (Avl: ${nt}kg)${Ee}`}}),placeholder:"Select Batch",className:"text-xs",required:!0}):n.jsxs("div",{className:"w-full px-2 py-1 text-xs border border-red-300 rounded bg-red-50 text-red-700 flex items-center gap-1",children:[n.jsx("span",{children:""}),n.jsx("span",{children:"No stock available"})]}):n.jsx("div",{className:"w-full px-2 py-1 text-xs border border-gray-300 rounded bg-gray-100 text-gray-400",children:"Select product first"})]})]}),qe&&n.jsx("div",{className:"mb-2",children:n.jsxs("table",{className:"w-full text-[10px] border border-gray-300",children:[n.jsx("thead",{className:"bg-gray-200",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-1 py-0.5 text-left border-r border-gray-300",children:"Batch"}),n.jsx("th",{className:"px-1 py-0.5 text-left border-r border-gray-300",children:"Expiry"}),n.jsx("th",{className:"px-1 py-0.5 text-left border-r border-gray-300",children:"Packaging"}),n.jsx("th",{className:"px-1 py-0.5 text-right border-r border-gray-300",children:"Total"}),n.jsx("th",{className:"px-1 py-0.5 text-right font-semibold",children:"Available"})]})}),n.jsx("tbody",{children:n.jsxs("tr",{className:"bg-white",children:[n.jsx("td",{className:"px-1 py-0.5 border-r border-gray-300",children:qe.batch_number}),n.jsx("td",{className:"px-1 py-0.5 border-r border-gray-300",children:qe.expiry_date?new Date(qe.expiry_date).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"2-digit"}):"-"}),n.jsx("td",{className:"px-1 py-0.5 border-r border-gray-300",children:qe.packaging_details||"-"}),n.jsxs("td",{className:"px-1 py-0.5 text-right border-r border-gray-300",children:[qe.current_stock,"kg"]}),n.jsxs("td",{className:"px-1 py-0.5 text-right font-bold text-green-600",children:[(()=>{const $e=qe.current_stock-(qe.reserved_stock||0),Ne=ke.get(qe.id)||0;return $e-Ne})(),"kg"]})]})})]})}),Fe.pack_size&&n.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-600 mb-0.5",children:"No. of Packs *"}),n.jsx("input",{type:"number",value:Fe.number_of_packs||"",onChange:$e=>te(oe,Number($e.target.value)),className:"w-full px-2 py-1 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",required:!0,min:"1"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-600 mb-0.5",children:"Pack Size"}),n.jsx("input",{type:"text",value:`${Fe.pack_size} kg`,className:"w-full px-2 py-1 text-xs border border-gray-300 rounded bg-gray-100",disabled:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-600 mb-0.5",children:"Total Qty (Kg)"}),n.jsx("input",{type:"text",value:`${Fe.quantity} kg`,className:"w-full px-2 py-1 text-xs border border-gray-300 rounded bg-gray-100",disabled:!0})]})]}),U.length>1&&n.jsx("button",{type:"button",onClick:()=>_e(oe),className:"absolute top-1 right-1 text-xs text-red-600 hover:text-red-800 bg-white px-2 py-0.5 rounded border border-red-300 shadow-sm",children:"Remove"})]},oe)})})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-3 border-t mt-3",children:[n.jsx("button",{type:"button",onClick:()=>{x(!1),Re()},className:"px-5 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors font-medium",children:"Cancel"}),n.jsx("button",{type:"submit",className:"px-5 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium shadow-sm",children:N?"Update Challan":"Create Challan"})]})]})}),p&&m&&n.jsx(Kue,{challan:m,items:y,onClose:()=>b(!1),companySettings:_}),k&&n.jsx(Ot,{isOpen:k,onClose:()=>{w(!1),R(""),z(null)},title:"Reject Delivery Challan",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Rejection Reason ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("textarea",{value:T,onChange:Fe=>R(Fe.target.value),rows:4,className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500",placeholder:"Enter reason for rejecting this delivery challan..."})]}),n.jsxs("div",{className:"flex gap-2 justify-end",children:[n.jsx("button",{onClick:()=>{w(!1),R(""),z(null)},className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Cancel"}),n.jsx("button",{onClick:ge,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",disabled:!T.trim(),children:"Reject Challan"})]})]})})]})})}function zue({invoice:e,items:t,onClose:r}){const a=Q.useRef(null),{t:s,language:i}=cn(),o=m=>m==null?"Rp 0,00":`Rp ${m.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})}`,l=m=>{const g=new Date(m),y=i==="id"?["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agt","Sep","Okt","Nov","Des"]:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],v=g.getDate(),_=y[g.getMonth()],j=g.getFullYear();return`${v} ${_} ${j}`},c=m=>{const g=new Date(m),v=(i==="id"?["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agt","Sep","Okt","Nov","Des"]:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"])[g.getMonth()],_=g.getFullYear();return`${v} ${_}`},d=m=>i==="id"?u(m):f(m),u=m=>{if(m===0)return"Nol";const g=["","Satu","Dua","Tiga","Empat","Lima","Enam","Tujuh","Delapan","Sembilan"],y=["Sepuluh","Sebelas","Dua Belas","Tiga Belas","Empat Belas","Lima Belas","Enam Belas","Tujuh Belas","Delapan Belas","Sembilan Belas"],v=["","","Dua Puluh","Tiga Puluh","Empat Puluh","Lima Puluh","Enam Puluh","Tujuh Puluh","Delapan Puluh","Sembilan Puluh"],_=j=>{if(j===0)return"";if(j<10)return g[j];if(j>=10&&j<20)return y[j-10];if(j<100){const C=Math.floor(j/10),k=j%10;return v[C]+(k>0?" "+g[k]:"")}const N=Math.floor(j/100),B=j%100;return(N===1?"Seratus":g[N]+" Ratus")+(B>0?" "+_(B):"")};if(m<1e3)return _(m);if(m<1e6){const j=Math.floor(m/1e3),N=m%1e3;return(j===1?"Seribu":_(j)+" Ribu")+(N>0?" "+_(N):"")}if(m<1e9){const j=Math.floor(m/1e6),N=m%1e6,B=_(j)+" Juta",E=N>=1e3?(Math.floor(N/1e3)===1?"Seribu":_(Math.floor(N/1e3))+" Ribu")+(N%1e3>0?" "+_(N%1e3):""):N>0?_(N):"";return B+(E?" "+E:"")}return m.toString()},f=m=>{if(m===0)return"Zero";const g=["","One","Two","Three","Four","Five","Six","Seven","Eight","Nine"],y=["Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"],v=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"],_=j=>{if(j===0)return"";if(j<10)return g[j];if(j>=10&&j<20)return y[j-10];if(j<100){const E=Math.floor(j/10),C=j%10;return v[E]+(C>0?" "+g[C]:"")}const N=Math.floor(j/100),B=j%100;return g[N]+" Hundred"+(B>0?" "+_(B):"")};if(m<1e3)return _(m);if(m<1e6){const j=Math.floor(m/1e3),N=m%1e3;return _(j)+" Thousand"+(N>0?" "+_(N):"")}if(m<1e9){const j=Math.floor(m/1e6),N=m%1e6,B=N>=1e3?_(Math.floor(N/1e3))+" Thousand"+(N%1e3>0?" "+_(N%1e3):""):N>0?_(N):"";return _(j)+" Million"+(B?" "+B:"")}return m.toString()},h=()=>{window.print()},A=async()=>{if(a.current)try{const m=await Zo(a.current,{scale:2,useCORS:!0,allowTaint:!0,logging:!1,backgroundColor:"#ffffff",windowWidth:a.current.scrollWidth,windowHeight:a.current.scrollHeight,onclone:C=>{const k=C.getElementById("invoice-print-content");k&&(k.style.width="210mm")}}),g=m.toDataURL("image/png",1),y=new Ut("p","mm","a4"),v=y.internal.pageSize.getWidth(),_=y.internal.pageSize.getHeight(),j=m.width,N=m.height,B=v/j,E=N*B;if(E>_){let C=0,k=E;for(;k>0;)y.addImage(g,"PNG",0,C,v,E),k-=_,C-=_,k>0&&y.addPage()}else y.addImage(g,"PNG",0,0,v,E);y.save(`Invoice-${e.invoice_number}.pdf`)}catch(m){console.error("Error generating PDF:",m),alert("Failed to generate PDF. Please try again.")}},x=e.customers,p=e.payment_terms_days||30,b=()=>p===0?"Advance / Immediate":`${p} ${i==="id"?"Hari":"Days"}`;return n.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto bg-gray-900 bg-opacity-75 print:static print:bg-white print:overflow-visible",children:[n.jsx("div",{className:"flex min-h-screen items-start justify-center p-4 pt-10 print:p-0 print:min-h-0 print:block",children:n.jsxs("div",{className:"relative w-full max-w-5xl bg-white shadow-xl print:shadow-none print:max-w-full",children:[n.jsxs("div",{className:"sticky top-0 z-10 flex items-center justify-between border-b bg-white px-6 py-4",style:{printColorAdjust:"exact",WebkitPrintColorAdjust:"exact"},children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:[i==="id"?"Faktur":"Invoice"," ",e.invoice_number]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("button",{onClick:h,className:"flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-2 text-white hover:bg-blue-700",children:[n.jsx($l,{className:"h-4 w-4"}),i==="id"?"Cetak":"Print"]}),n.jsxs("button",{onClick:A,className:"flex items-center gap-2 rounded-lg bg-green-600 px-4 py-2 text-white hover:bg-green-700",children:[n.jsx(Zn,{className:"h-4 w-4"}),"PDF"]}),n.jsx("button",{onClick:r,className:"rounded-lg bg-gray-100 p-2 text-gray-600 hover:bg-gray-200",children:n.jsx(wr,{className:"h-5 w-5"})})]})]}),n.jsxs("div",{id:"invoice-print-content",ref:a,className:"p-8",children:[n.jsxs("div",{className:"mb-3 border-2 border-black p-3 print:mb-2 print:p-2",children:[n.jsxs("div",{className:"mb-2 flex items-start justify-between",children:[n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"h-16 w-16 flex items-center justify-center print:h-12 print:w-12",style:{backgroundColor:"#fff"},children:n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",xmlSpace:"preserve",width:"100%",height:"100%",viewBox:"0 0 15686.55 15480.24",style:{shapeRendering:"geometricPrecision",fillRule:"evenodd",clipRule:"evenodd"},children:n.jsxs("g",{children:[n.jsx("path",{fill:"#FDB763",d:"M69.94 10438.12l10353.39 0 0 -1798.67 1665.92 0 0 1868.6 0 320.44 0 4552.28c0,38.48 -31.45,69.94 -69.94,69.94l-11949.38 0c-38.48,0 -69.94,-31.45 -69.94,-69.94l0 -4872.72c0,-38.48 31.45,-69.94 69.94,-69.94zm1605.9 1710.15l8737.57 0c13.58,0 24.68,11.11 24.68,24.68l0 1719.84c0,13.58 -11.11,24.68 -24.68,24.68l-8737.57 0c-13.58,0 -24.68,-11.11 -24.68,-24.68l0 -1719.84c0,-13.58 11.11,-24.68 24.68,-24.68z"}),n.jsx("path",{fill:"#FDB763",d:"M15587.15 5136.67l-10353.49 0 0 1822.07 -1665.92 0 0 -1892.9 0 -324.61 0 -4611.43c0,-39 31.45,-70.87 69.94,-70.87l11949.47 0c38.48,0 69.94,31.87 69.94,70.87l0 4936.04c0,39 -31.45,70.83 -69.94,70.83zm-1605.9 -1732.36l-8737.67 0c-13.58,0 -24.68,-11.27 -24.68,-25l0 -1742.21c0,-13.74 11.11,-25 24.68,-25l8737.67 0c13.58,0 24.68,11.27 24.68,25l0 1742.21c0,13.74 -11.11,25 -24.68,25z"}),n.jsx("polygon",{fill:"#FD6D26",points:"-0,0 1651.16,0 1651.16,6929.27 15657.09,6929.27 15657.09,6958.74 15686.55,6958.74 15686.55,15480.24 14022.85,15480.24 14022.85,8639.45 1651.16,8639.45 -0,8639.45 -0,6929.27"})]})})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-base font-bold print:text-sm",children:"PT. SHUBHAM ANZEN PHARMA JAYA"}),n.jsx("p",{className:"text-xs print:text-[10px]",children:"Komplek Ruko Metro Sunter Blok A1 NO.15, Jl. Metro Indah Raya,"}),n.jsx("p",{className:"text-xs print:text-[10px]",children:"Kelurahan Papanggo, Kec. Tanjung Priok, Jakarta Utara - 14340"}),n.jsx("p",{className:"text-xs print:text-[10px]",children:"Telp: (+62 21) 65832426"})]})]}),n.jsx("div",{className:"text-right",children:n.jsx("h2",{className:"text-3xl font-bold print:text-2xl",children:"INVOICE"})})]}),n.jsxs("div",{className:"text-xs space-y-0.5 print:text-[10px] print:space-y-0",children:[n.jsxs("div",{children:[n.jsx("span",{className:"font-semibold",children:"No izin PBF"}),n.jsx("span",{className:"ml-16",children:": 27092400534390007"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"font-semibold",children:"No Sertifikasi CDOB"}),n.jsx("span",{className:"ml-4",children:": 270924005343900070001"})]})]})]}),n.jsx("div",{className:"mb-3 border-2 border-black p-3 print:mb-2 print:p-2",children:n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("div",{className:"space-y-1 text-xs print:text-[10px] print:space-y-0 flex-1",children:[n.jsxs("div",{children:[n.jsx("span",{className:"font-bold",children:"Company Name:"}),n.jsxs("span",{className:"font-semibold",children:[" ",(x==null?void 0:x.company_name)||""]})]}),n.jsxs("div",{className:"pt-1 flex",children:[n.jsx("span",{className:"font-bold",style:{minWidth:"72px"},children:"Address:"}),n.jsxs("div",{children:[n.jsx("p",{children:(x==null?void 0:x.address)||""}),n.jsx("p",{children:(x==null?void 0:x.city)||""})]})]}),n.jsxs("div",{className:"flex pt-1",children:[n.jsx("span",{className:"font-bold",style:{minWidth:"72px"},children:"Phone:"}),n.jsx("span",{children:(x==null?void 0:x.phone)||""})]}),n.jsxs("div",{className:"flex",children:[n.jsx("span",{className:"font-bold",style:{minWidth:"72px"},children:"NPWP:"}),n.jsx("span",{children:(x==null?void 0:x.npwp)||""})]})]}),n.jsxs("div",{className:"space-y-1 text-xs print:text-[10px] print:space-y-0 text-right",style:{minWidth:"200px"},children:[n.jsxs("div",{children:[n.jsx("span",{className:"font-bold",children:"Invoice No:"}),n.jsx("span",{className:"ml-2",children:e.invoice_number})]}),n.jsxs("div",{children:[n.jsx("span",{className:"font-bold",children:"Invoice Date:"}),n.jsx("span",{className:"ml-2",children:l(e.invoice_date)})]}),n.jsxs("div",{className:"pt-1",children:[n.jsx("span",{className:"font-bold",children:"Po No:"}),n.jsx("span",{className:"ml-2",children:e.po_number||"N/A"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"font-bold",children:"Payment Terms:"}),n.jsx("span",{className:"ml-2",children:b()})]})]})]})}),n.jsx("div",{children:n.jsxs("table",{className:"w-full border-2 border-black text-xs print:text-[10px]",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"border-b-2 border-black bg-white",children:[n.jsx("th",{className:"border-r border-black p-1.5 text-center font-bold print:p-1",children:"No."}),n.jsx("th",{className:"border-r border-black p-1.5 text-left font-bold print:p-1",children:"Product Name"}),n.jsx("th",{className:"border-r border-black p-1.5 text-center font-bold print:p-1",children:"Batch No."}),n.jsx("th",{className:"border-r border-black p-1.5 text-center font-bold print:p-1",children:"Exp. Date"}),n.jsx("th",{className:"border-r border-black p-1.5 text-center font-bold print:p-1",children:"Total Qty"}),n.jsx("th",{className:"border-r border-black p-1.5 text-center font-bold print:p-1",children:"UOM"}),n.jsx("th",{className:"border-r border-black p-1.5 text-right font-bold print:p-1",children:"Unit Price (IDR)"}),n.jsx("th",{className:"p-1.5 text-right font-bold print:p-1",children:"Sub Total (IDR)"})]})}),n.jsxs("tbody",{children:[t.map((m,g)=>{var N,B,E,C;const y=m.quantity||0,v=m.unit_price||0,_=y*v,j=(N=m.batches)!=null&&N.expiry_date?c(m.batches.expiry_date):"-";return n.jsxs("tr",{className:"border-b border-black",children:[n.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:g+1}),n.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:((B=m.products)==null?void 0:B.product_name)||"Unknown Product"}),n.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:((E=m.batches)==null?void 0:E.batch_number)||"N/A"}),n.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:j}),n.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:y.toLocaleString()}),n.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:((C=m.products)==null?void 0:C.unit)||"Kg"}),n.jsx("td",{className:"border-r border-black p-1.5 text-right print:p-1",children:o(v)}),n.jsx("td",{className:"p-1.5 text-right print:p-1",children:o(_)})]},m.id||g)}),t.length<2&&Array.from({length:2-t.length}).map((m,g)=>n.jsxs("tr",{className:"border-b border-black",children:[n.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:""}),n.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),n.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),n.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),n.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),n.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),n.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),n.jsx("td",{className:"p-1.5 print:p-1",children:""})]},`empty-${g}`))]})]})}),n.jsxs("div",{className:"border-2 border-black border-t-0",children:[n.jsxs("div",{className:"flex items-stretch border-b-2 border-black",children:[n.jsxs("div",{className:"flex-1 p-2 border-r-2 border-black print:p-1.5",children:[n.jsx("p",{className:"text-xs font-bold print:text-[10px]",children:i==="id"?"Amount In words:":"Amount in words:"}),n.jsxs("p",{className:"text-xs mt-0.5 font-bold uppercase print:text-[10px] print:mt-0",children:["IDR ",d(Math.round(e.total_amount))," RUPIAH"]})]}),n.jsxs("div",{className:"w-80 text-xs p-2 print:text-[10px] print:p-1.5",children:[n.jsxs("div",{className:"flex justify-between py-1 print:py-0.5",children:[n.jsx("span",{className:"font-bold",children:"Sub Total"}),n.jsx("span",{className:"font-bold",children:o(e.subtotal)})]}),n.jsxs("div",{className:"flex justify-between border-t border-black py-1 print:py-0.5",children:[n.jsx("span",{className:"font-bold",children:"VAT (PPN) 11%"}),n.jsx("span",{className:"font-bold",children:o(e.tax_amount)})]}),n.jsxs("div",{className:"flex justify-between border-t-2 border-black py-1 print:py-0.5",children:[n.jsx("span",{className:"font-bold",children:"Grand Total"}),n.jsx("span",{className:"font-bold text-sm print:text-xs",children:o(e.total_amount)})]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-0 text-xs print:text-[10px]",children:[n.jsxs("div",{className:"p-3 border-r-2 border-black print:p-2",children:[n.jsx("p",{className:"font-semibold mb-2 print:mb-1",children:"Bank Details:"}),n.jsxs("div",{className:"space-y-0.5 print:space-y-0",children:[n.jsxs("div",{className:"flex",children:[n.jsx("span",{className:"font-semibold",style:{minWidth:"95px"},children:"Bank Name"}),n.jsx("span",{className:"mr-2",children:":"}),n.jsx("span",{children:"BCA"})]}),n.jsxs("div",{className:"flex",children:[n.jsx("span",{className:"font-semibold",style:{minWidth:"95px"},children:"Branch"}),n.jsx("span",{className:"mr-2",children:":"}),n.jsx("span",{children:"Sunter Mall, Jakarta"})]}),n.jsxs("div",{className:"flex",children:[n.jsx("span",{className:"font-semibold",style:{minWidth:"95px"},children:"Account Name"}),n.jsx("span",{className:"mr-2",children:":"}),n.jsx("span",{className:"whitespace-nowrap",children:"PT. Shubham Anzen Pharma Jaya"})]}),n.jsxs("div",{className:"flex",children:[n.jsx("span",{className:"font-semibold",style:{minWidth:"95px"},children:"Account No."}),n.jsx("span",{className:"mr-2",children:":"}),n.jsx("span",{children:"0930 2010 14 (IDR)"})]})]})]}),n.jsxs("div",{className:"p-3 print:p-2",children:[n.jsx("p",{className:"font-semibold mb-1",children:"Authorized Signatory:"}),n.jsx("p",{className:"font-semibold mb-10 print:mb-8",children:"PT. SHUBHAM ANZEN PHARMA JAYA"}),n.jsx("div",{className:"w-4/5 border-t border-black pt-1",children:"Pharmacist"})]})]})]}),n.jsx("div",{className:"border-2 border-black border-t-0 p-2.5 print:p-2",children:n.jsx("p",{className:"text-xs font-semibold text-center print:text-[10px]",children:i==="id"?`Pembayaran jatuh tempo dalam ${b()} sejak tanggal barang dikirim.`:`Payment is due within ${b()} from the date on which the goods are delivered.`})}),e.notes&&n.jsx("div",{className:"mt-3 border-2 border-black p-2 print:mt-2 print:p-1.5",children:n.jsxs("p",{className:"text-xs print:text-[10px]",children:[n.jsx("span",{className:"font-bold",children:"Notes: "}),n.jsx("span",{children:e.notes})]})})]}),n.jsxs("div",{className:"mt-6 p-6 bg-blue-50 border-2 border-blue-200 rounded-lg print:hidden",children:[n.jsx("h3",{className:"text-lg font-bold text-blue-900 mb-4",children:"Cost Analysis & Profitability (Internal Use Only)"}),n.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:[n.jsxs("table",{className:"min-w-full divide-y divide-gray-300",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-700",children:"Product"}),n.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-700",children:"Qty"}),n.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-700",children:"Selling Price"}),n.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-700",children:"Revenue"}),n.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-700",children:"COGS/Unit"}),n.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-700",children:"Total COGS"}),n.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-700",children:"Gross Profit"}),n.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-700",children:"Margin %"})]})}),n.jsx("tbody",{className:"divide-y divide-gray-200",children:t.map((m,g)=>{var C;const y=m.quantity||0,v=m.unit_price||0,_=y*v,j=0,N=j*y,B=_-N,E=_>0?B/_*100:0;return n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsxs("td",{className:"px-4 py-3 text-sm text-gray-900",children:[n.jsx("div",{className:"font-medium",children:(C=m.products)==null?void 0:C.product_name}),m.batches&&n.jsxs("div",{className:"text-xs text-gray-500",children:["Batch: ",m.batches.batch_number]})]}),n.jsx("td",{className:"px-4 py-3 text-sm text-right text-gray-900",children:y}),n.jsx("td",{className:"px-4 py-3 text-sm text-right text-gray-900",children:o(v)}),n.jsx("td",{className:"px-4 py-3 text-sm text-right font-medium text-gray-900",children:o(_)}),n.jsx("td",{className:"px-4 py-3 text-sm text-right text-gray-600",children:n.jsx("span",{className:"text-orange-600 font-medium",children:o(j)})}),n.jsx("td",{className:"px-4 py-3 text-sm text-right font-medium text-orange-600",children:o(N)}),n.jsx("td",{className:"px-4 py-3 text-sm text-right font-semibold text-green-600",children:o(B)}),n.jsx("td",{className:"px-4 py-3 text-sm text-right",children:n.jsxs("span",{className:`font-semibold ${E>=20?"text-green-600":E>=10?"text-yellow-600":"text-red-600"}`,children:[E.toFixed(1),"%"]})})]},g)})}),n.jsx("tfoot",{className:"bg-gray-50 border-t-2 border-gray-300",children:n.jsxs("tr",{children:[n.jsx("td",{colSpan:3,className:"px-4 py-3 text-sm font-bold text-gray-900 text-right",children:"TOTALS:"}),n.jsx("td",{className:"px-4 py-3 text-sm font-bold text-gray-900 text-right",children:o(e.subtotal)}),n.jsx("td",{}),n.jsx("td",{className:"px-4 py-3 text-sm font-bold text-orange-600 text-right",children:o(0)}),n.jsx("td",{className:"px-4 py-3 text-sm font-bold text-green-600 text-right",children:o(e.subtotal-0)}),n.jsx("td",{className:"px-4 py-3 text-sm font-bold text-right",children:n.jsxs("span",{className:`${(e.subtotal>0?(e.subtotal-0)/e.subtotal*100:0)>=20?"text-green-600":"text-yellow-600"}`,children:[(e.subtotal>0?(e.subtotal-0)/e.subtotal*100:0).toFixed(1),"%"]})})]})})]}),n.jsxs("div",{className:"mt-6 grid grid-cols-3 gap-4",children:[n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[n.jsx("div",{className:"text-xs font-medium text-blue-700 mb-1",children:"Total Revenue (excl. Tax)"}),n.jsx("div",{className:"text-xl font-bold text-blue-900",children:o(e.subtotal)})]}),n.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:[n.jsx("div",{className:"text-xs font-medium text-orange-700 mb-1",children:"Total COGS"}),n.jsx("div",{className:"text-xl font-bold text-orange-900",children:o(0)}),n.jsx("div",{className:"text-xs text-orange-600 mt-1",children:"Cost of goods sold"})]}),n.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[n.jsx("div",{className:"text-xs font-medium text-green-700 mb-1",children:"Gross Profit"}),n.jsx("div",{className:"text-xl font-bold text-green-900",children:o(e.subtotal-0)}),n.jsxs("div",{className:"text-xs text-green-600 mt-1",children:["Margin: ",(e.subtotal>0?(e.subtotal-0)/e.subtotal*100:0).toFixed(1),"%"]})]})]}),n.jsx("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:n.jsxs("div",{className:"flex items-start gap-2",children:[n.jsx("svg",{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:n.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),n.jsxs("div",{className:"text-xs text-yellow-800",children:[n.jsx("p",{className:"font-semibold",children:"Note:"}),n.jsx("p",{className:"mt-1",children:"This cost analysis is for internal management use only. COGS data is pulled from batch landed costs (including import costs). This section will NOT appear when printing the invoice."})]})]})})]})]})]})}),n.jsx("style",{children:`
        @media print {
          @page {
            size: A4 portrait;
            margin: 8mm;
          }

          .sticky {
            display: none !important;
          }

          body {
            margin: 0;
            padding: 0;
          }

          body * {
            visibility: hidden;
          }

          #invoice-print-content,
          #invoice-print-content * {
            visibility: visible;
          }

          #invoice-print-content {
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            page-break-inside: avoid;
            page-break-after: auto;
          }

          #invoice-print-content > div {
            page-break-inside: avoid;
          }

          table {
            page-break-inside: auto;
          }

          tr {
            page-break-inside: avoid;
            page-break-after: auto;
          }

          thead {
            display: table-header-group;
          }

          tfoot {
            display: table-footer-group;
          }
        }
      `})]})}function Gue({options:e,selectedDCIds:t,onChange:r,placeholder:a="Select Delivery Challans"}){var x;const[s,i]=Q.useState(!1),[o,l]=Q.useState(""),c=Q.useRef(null);Q.useEffect(()=>{function p(b){c.current&&!c.current.contains(b.target)&&i(!1)}return document.addEventListener("mousedown",p),()=>document.removeEventListener("mousedown",p)},[]);const d=e.filter(p=>p.challan_number.toLowerCase().includes(o.toLowerCase())),u=p=>{t.includes(p)?r(t.filter(b=>b!==p)):r([...t,p])},f=()=>{t.length===d.length?r([]):r(d.map(p=>p.challan_id))},h=t.length,A=h===0?a:h===1?((x=e.find(p=>p.challan_id===t[0]))==null?void 0:x.challan_number)||`${h} DCs selected`:`${h} DCs selected`;return n.jsxs("div",{className:"relative",ref:c,children:[n.jsxs("button",{type:"button",onClick:()=>i(!s),className:"w-full px-2 py-1.5 text-sm text-left bg-white border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 focus:border-transparent flex items-center justify-between",children:[n.jsx("span",{className:h===0?"text-gray-400":"text-gray-900",children:A}),n.jsx(Cs,{className:`w-3 h-3 transition-transform ${s?"transform rotate-180":""}`})]}),s&&n.jsxs("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-96 overflow-hidden flex flex-col",children:[n.jsx("div",{className:"p-2 border-b border-gray-200",children:n.jsxs("div",{className:"relative",children:[n.jsx(Ca,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),n.jsx("input",{type:"text",value:o,onChange:p=>l(p.target.value),placeholder:"Search...",className:"w-full pl-9 pr-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500",onClick:p=>p.stopPropagation()})]})}),n.jsxs("div",{className:"overflow-y-auto max-h-80",children:[d.length>1&&n.jsx("div",{className:"px-3 py-2 hover:bg-gray-50 cursor-pointer border-b border-gray-200 sticky top-0 bg-white",onClick:f,children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:`w-5 h-5 rounded border-2 flex items-center justify-center ${t.length===d.length?"bg-green-600 border-green-600":t.length>0?"bg-gray-300 border-gray-300":"border-gray-300"}`,children:t.length>0&&n.jsx(Jb,{className:"w-3 h-3 text-white"})}),n.jsx("span",{className:"font-medium text-gray-900",children:"(Select All)"})]})}),d.length===0?n.jsx("div",{className:"px-3 py-4 text-center text-gray-500",children:"No delivery challans found"}):d.map(p=>{const b=t.includes(p.challan_id);return n.jsx("div",{className:"px-3 py-2 hover:bg-gray-50 cursor-pointer",onClick:()=>u(p.challan_id),children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:`w-5 h-5 rounded border-2 flex items-center justify-center ${b?"bg-green-600 border-green-600":"border-gray-300"}`,children:b&&n.jsx(Jb,{className:"w-3 h-3 text-white"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:"font-medium text-gray-900",children:p.challan_number}),n.jsxs("div",{className:"text-xs text-gray-500",children:[new Date(p.challan_date).toLocaleDateString(),"  ",p.item_count," items pending"]})]})]})},p.challan_id)})]})]})]})}function Xue(){const{t:e}=cn(),{profile:t}=Cr(),{navigationData:r,clearNavigationData:a,setCurrentPage:s}=Go(),[i,o]=Q.useState([]),[l,c]=Q.useState([]),[d,u]=Q.useState([]),[f,h]=Q.useState([]),[A,x]=Q.useState([]),[p,b]=Q.useState([]),[m,g]=Q.useState([]),[y,v]=Q.useState(""),[_,j]=Q.useState([]),[N,B]=Q.useState(new Map),[E,C]=Q.useState(new Set),[k,w]=Q.useState(!0),[T,R]=Q.useState(!1),[q,z]=Q.useState(!1),[ee,Y]=Q.useState(null),[G,re]=Q.useState(null),[U,S]=Q.useState([]),[D,L]=Q.useState({invoice_number:"",customer_id:"",invoice_date:new Date().toISOString().split("T")[0],payment_terms:"30",discount:0,delivery_challan_number:"",po_number:"",notes:""}),[P,I]=Q.useState([{product_id:"",batch_id:null,quantity:1,unit_price:0,tax_rate:11,total:0}]);Q.useEffect(()=>{V(),M(),se(),K()},[]),Q.useEffect(()=>{(r==null?void 0:r.sourceType)==="delivery_challan"&&(ce(r),a())},[r]),Q.useEffect(()=>{m.length>0&&D.customer_id&&!ee&&H()},[m]);const H=async()=>{try{const{data:Ne,error:Ee}=await Z.from("pending_dc_items_by_customer").select("*").eq("customer_id",D.customer_id).in("challan_id",m);if(Ee)throw Ee;const ze=await Promise.all((Ne||[]).map(async rt=>{const nt=rt.selling_price||rt.unit_price||0;return{product_id:rt.product_id,batch_id:rt.batch_id,quantity:rt.remaining_quantity,unit_price:nt,tax_rate:11,total:0,delivery_challan_item_id:rt.dc_item_id,dc_number:rt.challan_number,max_quantity:rt.remaining_quantity}}));ze.length>0?I(ze.map(rt=>({...rt,total:de(rt)}))):I([{product_id:"",batch_id:null,quantity:1,unit_price:0,tax_rate:11,total:0}])}catch(Ne){console.error("Error loading DC items:",Ne)}},V=async()=>{try{const{data:Ne,error:Ee}=await Z.from("sales_invoices").select("*, customers(company_name, address, city, phone, npwp, pharmacy_license, gst_vat_type)").order("invoice_date",{ascending:!1});if(Ee)throw Ee;const ze=await Promise.all((Ne||[]).map(async rt=>{const{data:nt}=await Z.rpc("get_invoice_paid_amount",{p_invoice_id:rt.id}),mt=nt||0,gt=rt.total_amount-mt;return{...rt,paid_amount:mt,balance_amount:gt}}));o(ze)}catch(Ne){console.error("Error loading invoices:",Ne)}finally{w(!1)}},W=async()=>{try{const{data:Ne}=await Z.from("app_settings").select("invoice_prefix, invoice_start_number").maybeSingle(),Ee=(Ne==null?void 0:Ne.invoice_prefix)||"SAPJ",ze=(Ne==null?void 0:Ne.invoice_start_number)||1,{data:rt,error:nt}=await Z.rpc("get_current_financial_year");if(nt){console.error("Error getting financial year:",nt);const yt=new Date().getFullYear().toString().slice(-2);return`${Ee}-${yt}-001`}const{data:mt}=await Z.from("sales_invoices").select("invoice_number").like("invoice_number",`${Ee}-${rt}%`);let gt=ze;if(mt&&mt.length>0){const yt=mt.map(Et=>{const It=Et.invoice_number.match(/(\d+)$/);return It?parseInt(It[1],10):0}).filter(Et=>!isNaN(Et));yt.length>0&&(gt=Math.max(...yt)+1)}const Nt=String(gt).padStart(3,"0");return`${Ee}-${rt}-${Nt}`}catch(Ne){return console.error("Error generating invoice number:",Ne),`SAPJ-${new Date().getFullYear().toString().slice(-2)}-001`}},M=async()=>{try{const{data:Ne,error:Ee}=await Z.from("customers").select("id, company_name, gst_vat_type").eq("is_active",!0).order("company_name");if(Ee)throw Ee;c(Ne||[])}catch(Ne){console.error("Error loading customers:",Ne)}},se=async()=>{try{const{data:Ne,error:Ee}=await Z.from("products").select("id, product_name, product_code").eq("is_active",!0).order("product_name");if(Ee)throw Ee;u(Ne||[])}catch(Ne){console.error("Error loading products:",Ne)}},K=async()=>{try{const{data:Ne,error:Ee}=await Z.from("batches").select("id, batch_number, product_id, current_stock, import_price, duty_charges, freight_charges, other_charges, import_quantity, import_date, expiry_date").eq("is_active",!0).order("import_date",{ascending:!0});if(Ee)throw Ee;h(Ne||[])}catch(Ne){console.error("Error loading batches:",Ne)}},he=async Ne=>{try{const{data:Ee,error:ze}=await Z.from("delivery_challans").select("id, challan_number, challan_date, delivery_address, vehicle_number, notes").eq("customer_id",Ne).order("challan_date",{ascending:!1});if(ze)throw ze;const{data:rt,error:nt}=await Z.from("sales_invoices").select("linked_challan_ids").not("linked_challan_ids","is",null);if(nt)throw nt;const mt=new Set;rt==null||rt.forEach(Nt=>{var yt;(yt=Nt.linked_challan_ids)==null||yt.forEach(Et=>mt.add(Et))});const gt=(Ee==null?void 0:Ee.filter(Nt=>!mt.has(Nt.id)))||[];x(gt)}catch(Ee){console.error("Error loading pending challans:",Ee),x([])}},ne=async Ne=>{try{const{data:Ee,error:ze}=await Z.from("dc_invoicing_summary").select("challan_id, challan_number, challan_date, total_quantity, total_remaining_quantity").eq("customer_id",Ne).gt("total_remaining_quantity",0).order("challan_date",{ascending:!1});if(ze)throw ze;const rt=(Ee||[]).map(nt=>({challan_id:nt.challan_id,challan_number:nt.challan_number,challan_date:nt.challan_date,item_count:nt.total_remaining_quantity}));b(rt)}catch(Ee){console.error("Error loading pending DC options:",Ee),b([])}},te=()=>{I([...P,{product_id:"",batch_id:null,quantity:1,unit_price:0,tax_rate:11,total:0,delivery_challan_item_id:null}])},ce=async Ne=>{const Ee=await W();L({invoice_number:Ee,customer_id:Ne.customerId,invoice_date:new Date().toISOString().split("T")[0],payment_terms:"30",discount:0,delivery_challan_number:Ne.challanNumber,po_number:"",notes:`Created from Delivery Challan: ${Ne.challanNumber}`}),Ne.customerId&&await he(Ne.customerId);const ze=Ne.items.map(rt=>{const nt=f.find(Nt=>Nt.id===rt.batch_id),gt=(nt?(nt.import_price+nt.duty_charges+nt.freight_charges+nt.other_charges)/nt.import_quantity:0)*1.25;return{product_id:rt.product_id,batch_id:rt.batch_id,quantity:rt.quantity,unit_price:Math.round(gt),tax_rate:11,total:0,delivery_challan_item_id:rt.id||null}});I(ze.map(rt=>({...rt,total:de(rt)}))),R(!0)},_e=async Ne=>{try{const{data:Ee,error:ze}=await Z.from("sales_invoice_items").select(`
          *,
          products(product_name, product_code, unit),
          batches(batch_number, expiry_date),
          delivery_challan_item_id
        `).eq("invoice_id",Ne);if(ze)throw ze;const rt=await Promise.all((Ee||[]).map(async nt=>{var mt;if(nt.delivery_challan_item_id){const{data:gt}=await Z.from("delivery_challan_items").select("challan_id, delivery_challans(challan_number)").eq("id",nt.delivery_challan_item_id).maybeSingle();return{...nt,dc_number:(mt=gt==null?void 0:gt.delivery_challans)==null?void 0:mt.challan_number}}return nt}));return S(rt||[]),rt||[]}catch(Ee){return console.error("Error loading invoice items:",Ee),[]}},de=Ne=>{const Ee=Ne.quantity*Ne.unit_price,ze=Ee*(Ne.tax_rate/100);return Ee+ze},ye=Ne=>{if(!Ne)return 0;const Ee=f.find(rt=>rt.id===Ne);return!Ee||!Ee.import_quantity?0:(Ee.import_price+Ee.duty_charges+Ee.freight_charges+Ee.other_charges)/Ee.import_quantity},Le=(Ne,Ee)=>Ee===0?0:(Ne-Ee)/Ne*100,we=(Ne,Ee=25)=>{const ze=ye(Ne);return Math.round(ze*(1+Ee/100))},ge=(Ne,Ee)=>{const ze=de(Ee),rt=[...P];rt[Ne]={...Ee,total:ze},I(rt)},Re=Ne=>{P.length>1&&I(P.filter((Ee,ze)=>ze!==Ne))},et=()=>{const Ne=P.reduce((rt,nt)=>rt+nt.quantity*nt.unit_price,0),Ee=P.reduce((rt,nt)=>{const mt=nt.quantity*nt.unit_price;return rt+mt*(nt.tax_rate/100)},0),ze=Ne+Ee-D.discount;return{subtotal:Ne,taxAmount:Ee,total:ze}},Ye=async Ne=>{Ne.preventDefault();try{const{data:{user:Ee}}=await Z.auth.getUser();if(!Ee)throw new Error("Not authenticated");if(P.filter(yt=>yt.product_id&&yt.product_id.trim()!=="").length===0){alert("Please add at least one product to the invoice before saving.");return}const rt=et(),nt=new Date(D.invoice_date);let mt=new Date(nt),gt=30;D.payment_terms==="advance"||D.payment_terms==="50-50"?gt=0:(gt=parseInt(D.payment_terms),isNaN(gt)||mt.setDate(mt.getDate()+gt));let Nt;if(ee){const yt=new Map;P.filter(At=>At.product_id&&At.product_id.trim()!=="").forEach(At=>{const wt=`${At.product_id}-${At.batch_id}-${At.delivery_challan_item_id||"manual"}`;yt.has(wt)||yt.set(wt,{product_id:At.product_id,batch_id:At.batch_id,quantity:At.quantity,unit_price:At.unit_price,tax_rate:At.tax_rate,total_amount:At.total,delivery_challan_item_id:At.delivery_challan_item_id||null,max_quantity:At.max_quantity||null})});const Et=Array.from(yt.values()),{data:It,error:ir}=await Z.rpc("update_sales_invoice_atomic",{p_invoice_id:ee.id,p_invoice_updates:{invoice_date:D.invoice_date,due_date:mt.toISOString().split("T")[0],customer_id:D.customer_id,subtotal:rt.subtotal,tax_amount:rt.taxAmount,total_amount:rt.total,discount_amount:D.discount,po_number:D.po_number||null,payment_terms_days:gt,notes:D.notes||null},p_new_items:Et});if(ir)throw ir;const{data:Oe,error:tt}=await Z.from("sales_invoices").select().eq("id",ee.id).single();if(tt)throw tt;Nt=Oe}else{let yt=D.invoice_number;const{data:Et}=await Z.from("sales_invoices").select("invoice_number").eq("invoice_number",yt).maybeSingle();Et&&(yt=await W(),L(ht=>({...ht,invoice_number:yt})));const{data:It,error:ir}=await Z.from("sales_invoices").insert([{invoice_number:yt,customer_id:D.customer_id,invoice_date:D.invoice_date,due_date:mt.toISOString().split("T")[0],discount_amount:D.discount,delivery_challan_number:null,po_number:D.po_number||null,payment_terms_days:gt,notes:D.notes||null,subtotal:rt.subtotal,tax_amount:rt.taxAmount,total_amount:rt.total,payment_status:"pending",created_by:Ee.id,linked_challan_ids:m.length>0?m:null}]).select().single();if(ir)throw ir;Nt=It;const Oe=P.filter(ht=>ht.product_id&&ht.product_id.trim()!=="").map(ht=>({invoice_id:Nt.id,product_id:ht.product_id,batch_id:ht.batch_id,quantity:ht.quantity,unit_price:ht.unit_price,tax_rate:ht.tax_rate,delivery_challan_item_id:ht.delivery_challan_item_id||null})),{error:tt}=await Z.from("sales_invoice_items").insert(Oe);if(tt)throw console.error("Error inserting invoice items:",tt),console.error("Invoice items data:",Oe),new Error(`Failed to save invoice items: ${tt.message}`);const{data:At,error:wt}=await Z.from("sales_invoice_items").select("id").eq("invoice_id",Nt.id);if(wt)console.error("Error verifying items:",wt);else if(!At||At.length===0)throw new Error("Invoice items were not saved. Please try again.")}await V(),await K(),R(!1),ke()}catch(Ee){console.error("Error saving invoice:",Ee),alert(`Failed to save invoice: ${Ee.message||"Unknown error"}. Please check console for details.`)}},Be=async Ne=>{re(Ne),await _e(Ne.id),z(!0)},Fe=async Ne=>{Y(Ne),L({invoice_number:Ne.invoice_number,customer_id:Ne.customer_id,invoice_date:Ne.invoice_date,payment_terms:String(Ne.payment_terms_days||30),discount:Ne.discount_amount,delivery_challan_number:Ne.delivery_challan_number||"",po_number:Ne.po_number||"",notes:Ne.notes||""});const Ee=await _e(Ne.id);Ee.length>0&&I(Ee.map(ze=>{const rt={product_id:ze.product_id,batch_id:ze.batch_id,quantity:ze.quantity,unit_price:ze.unit_price,tax_rate:ze.tax_rate,total:0,delivery_challan_item_id:ze.delivery_challan_item_id,dc_number:ze.dc_number};return{...rt,total:de(rt)}})),await ne(Ne.customer_id),Ne.linked_challan_ids&&Ne.linked_challan_ids.length>0&&g(Ne.linked_challan_ids),R(!0)},oe=async Ne=>{if(confirm("Are you sure you want to delete this invoice?"))try{const{error:Ee}=await Z.from("sales_invoices").delete().eq("id",Ne);if(Ee)throw Ee;V()}catch(Ee){console.error("Error deleting invoice:",Ee),alert("Failed to delete invoice. Please try again.")}},ke=()=>{Y(null),v(""),x([]),b([]),g([]),L({invoice_number:"",customer_id:"",invoice_date:new Date().toISOString().split("T")[0],payment_terms:"30",discount:0,delivery_challan_number:"",po_number:"",notes:""}),I([{product_id:"",batch_id:null,quantity:1,unit_price:0,tax_rate:11,total:0}])},Ue=[{key:"invoice_number",label:"Invoice #"},{key:"customer",label:"Customer",render:(Ne,Ee)=>{var ze;return n.jsx("div",{className:"font-medium",children:(ze=Ee.customers)==null?void 0:ze.company_name})}},{key:"invoice_date",label:"Date",render:(Ne,Ee)=>new Date(Ee.invoice_date).toLocaleDateString()},{key:"total_amount",label:"Total Amount",render:(Ne,Ee)=>n.jsxs("span",{className:"font-medium",children:["Rp ",Ee.total_amount.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})},{key:"paid_amount",label:"Paid Amount",render:(Ne,Ee)=>n.jsxs("span",{className:"text-green-600 font-medium",children:["Rp ",(Ee.paid_amount||0).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})},{key:"balance_amount",label:"Balance",render:(Ne,Ee)=>n.jsxs("span",{className:`font-medium ${(Ee.balance_amount||0)===0?"text-gray-400":"text-orange-600"}`,children:["Rp ",(Ee.balance_amount||0).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})},{key:"payment_status",label:"Payment Status",render:(Ne,Ee)=>n.jsx("span",{className:`inline-block px-2 py-1 rounded-full text-xs font-medium ${Ee.payment_status==="paid"?"bg-green-100 text-green-800":Ee.payment_status==="partial"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:Ee.payment_status==="pending"?"Unpaid":Ee.payment_status==="partial"?"Partially Paid":"Paid"})}],qe=(t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="accounts"||(t==null?void 0:t.role)==="sales",$e={total:i.length,totalRevenue:i.reduce((Ne,Ee)=>Ne+Ee.total_amount,0),pending:i.filter(Ne=>Ne.payment_status==="pending").length,paid:i.filter(Ne=>Ne.payment_status==="paid").length};return n.jsx(Un,{children:n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Sales Invoices"}),n.jsx("p",{className:"text-gray-600 mt-1",children:"Manage sales invoices and track payments"})]}),qe&&n.jsxs("div",{className:"flex gap-3",children:[n.jsxs("button",{onClick:async()=>{ke();const Ne=await W();L(Ee=>({...Ee,invoice_number:Ne})),R(!0)},className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition",children:[n.jsx(Pr,{className:"w-5 h-5"}),"Create Invoice"]}),n.jsxs("button",{onClick:()=>{s("credit-notes")},className:"flex items-center gap-2 bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition",children:[n.jsx(y7,{className:"w-5 h-5"}),"Credit Notes"]})]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[n.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[n.jsx("p",{className:"text-sm text-gray-600",children:"Total Invoices"}),n.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:$e.total})]}),n.jsxs("div",{className:"bg-blue-50 rounded-lg shadow p-6",children:[n.jsx("p",{className:"text-sm text-blue-600",children:"Total Revenue"}),n.jsxs("p",{className:"text-2xl font-bold text-blue-600 mt-1",children:["Rp ",$e.totalRevenue.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),n.jsxs("div",{className:"bg-red-50 rounded-lg shadow p-6",children:[n.jsx("p",{className:"text-sm text-red-600",children:"Pending Payment"}),n.jsx("p",{className:"text-2xl font-bold text-red-600 mt-1",children:$e.pending})]}),n.jsxs("div",{className:"bg-green-50 rounded-lg shadow p-6",children:[n.jsx("p",{className:"text-sm text-green-600",children:"Paid"}),n.jsx("p",{className:"text-2xl font-bold text-green-600 mt-1",children:$e.paid})]})]}),n.jsx(Fs,{columns:Ue,data:i,loading:k,actions:qe?Ne=>n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>Be(Ne),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",title:"View Invoice",children:n.jsx(bi,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>Fe(Ne),className:"p-1 text-green-600 hover:bg-green-50 rounded",title:"Edit Invoice",children:n.jsx(Aa,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>oe(Ne.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Delete Invoice",children:n.jsx(Lr,{className:"w-4 h-4"})})]}):void 0}),n.jsx(Ot,{isOpen:T,onClose:()=>{R(!1),ke()},title:ee?"Edit Sales Invoice":"Create Sales Invoice",size:"xl",children:n.jsxs("form",{onSubmit:Ye,className:"space-y-3",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Invoice No *"}),n.jsx("input",{type:"text",value:D.invoice_number,className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded bg-gray-100",required:!0,readOnly:!0,disabled:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Invoice Date *"}),n.jsx("input",{type:"date",value:D.invoice_date,onChange:Ne=>L({...D,invoice_date:Ne.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Payment Terms *"}),n.jsxs("select",{value:D.payment_terms,onChange:Ne=>L({...D,payment_terms:Ne.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",required:!0,children:[n.jsx("option",{value:"0",children:"Immediate"}),n.jsx("option",{value:"15",children:"15 Days"}),n.jsx("option",{value:"30",children:"30 Days"}),n.jsx("option",{value:"45",children:"45 Days"}),n.jsx("option",{value:"60",children:"60 Days"}),n.jsx("option",{value:"advance",children:"Advance"}),n.jsx("option",{value:"50-50",children:"50% Adv & 50% on Delivery"})]})]})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Customer *"}),n.jsx(Qo,{value:D.customer_id,onChange:Ne=>{L({...D,customer_id:Ne}),v(""),x([]),g([]),I([{product_id:"",batch_id:null,quantity:1,unit_price:0,tax_rate:11,total:0}]),Ne?ne(Ne):b([])},options:l.map(Ne=>({value:Ne.id,label:Ne.company_name})),placeholder:"Select Customer",className:"text-sm",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Delivery Challans"}),n.jsx(Gue,{options:p,selectedDCIds:m,onChange:g,placeholder:"Select DCs"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"PO Number"}),n.jsx("input",{type:"text",value:D.po_number,onChange:Ne=>L({...D,po_number:Ne.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",placeholder:"Customer PO Number"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Notes"}),n.jsx("input",{type:"text",value:D.notes,onChange:Ne=>L({...D,notes:Ne.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",placeholder:"Additional notes"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Discount (Rp)"}),n.jsx("input",{type:"number",value:D.discount===0?"":D.discount,onChange:Ne=>L({...D,discount:Ne.target.value===""?0:Number(Ne.target.value)}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",min:"0",placeholder:"0"})]})]})]}),n.jsxs("div",{className:"border-t pt-3",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("h4",{className:"text-xs font-semibold text-gray-900",children:"Line Items"}),n.jsx("button",{type:"button",onClick:te,className:"text-xs text-blue-600 hover:text-blue-700 font-medium",children:"+ Add Manual Item"})]}),n.jsx("div",{className:"space-y-1.5",children:P.map((Ne,Ee)=>{var Nt;const ze=f.filter(yt=>yt.product_id===Ne.product_id),rt=ye(Ne.batch_id),nt=Le(Ne.unit_price,rt),mt=we(Ne.batch_id),gt=!!Ne.delivery_challan_item_id;return n.jsxs("div",{className:"p-2 bg-gray-50 rounded space-y-1 border-l-2",style:{borderLeftColor:gt?"#3b82f6":"#10b981"},children:[n.jsxs("div",{className:"flex items-center justify-between mb-1",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[gt?n.jsxs("span",{className:"px-1.5 py-0.5 text-[10px] font-medium bg-blue-100 text-blue-700 rounded",children:["From DC: ",Ne.dc_number]}):n.jsx("span",{className:"px-1.5 py-0.5 text-[10px] font-medium bg-green-100 text-green-700 rounded",children:"Manual Item"}),gt&&Ne.max_quantity&&n.jsxs("span",{className:"text-[10px] text-gray-500",children:["Max: ",Ne.max_quantity," units"]})]}),!gt&&P.length>1&&n.jsx("button",{type:"button",onClick:()=>Re(Ee),className:"text-red-600 hover:text-red-700",children:n.jsx(Lr,{className:"w-3 h-3"})})]}),n.jsxs("div",{className:"grid grid-cols-12 gap-2 items-end",children:[n.jsxs("div",{className:"col-span-3",children:[n.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Product *"}),n.jsxs("select",{value:Ne.product_id,onChange:yt=>ge(Ee,{...Ne,product_id:yt.target.value,batch_id:null}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",disabled:gt,required:!0,children:[n.jsx("option",{value:"",children:"Select Product"}),d.map(yt=>n.jsx("option",{value:yt.id,children:yt.product_name},yt.id))]})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Batch"}),n.jsxs("select",{value:Ne.batch_id||"",onChange:yt=>{const Et=yt.target.value||null,It=we(Et);ge(Ee,{...Ne,batch_id:Et,unit_price:It})},className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",disabled:!Ne.product_id||y!==""||gt,children:[n.jsx("option",{value:"",children:"Select Batch"}),ze.filter(yt=>yt.current_stock>0).map(yt=>n.jsxs("option",{value:yt.id,children:[yt.batch_number," (",yt.current_stock," stock)"]},yt.id)),Ne.batch_id&&ze.find(yt=>yt.id===Ne.batch_id&&yt.current_stock===0)&&n.jsxs("option",{value:Ne.batch_id,children:[(Nt=ze.find(yt=>yt.id===Ne.batch_id))==null?void 0:Nt.batch_number," (from challan)"]},Ne.batch_id)]})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Quantity *"}),n.jsx("input",{type:"number",value:Ne.quantity===0?"":Ne.quantity,onChange:yt=>ge(Ee,{...Ne,quantity:yt.target.value===""?1:Number(yt.target.value)}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",required:!0,min:"0.001",step:"0.001",placeholder:"0.25"})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Unit Price *"}),n.jsx("input",{type:"number",step:"0.01",value:Ne.unit_price===0?"":Ne.unit_price,onChange:yt=>ge(Ee,{...Ne,unit_price:yt.target.value===""?0:parseFloat(yt.target.value)||0}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",required:!0,min:"0",placeholder:"0"})]}),n.jsxs("div",{className:"col-span-1",children:[n.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Tax %"}),n.jsx("input",{type:"number",value:Ne.tax_rate===0?"":Ne.tax_rate,onChange:yt=>ge(Ee,{...Ne,tax_rate:yt.target.value===""?0:Number(yt.target.value)}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",min:"0",placeholder:"11"})]}),n.jsxs("div",{className:"col-span-2 flex items-end gap-2",children:[n.jsxs("div",{className:"flex-1",children:[n.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Total"}),n.jsx("input",{type:"text",value:(Ne.total||0).toFixed(2),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded bg-gray-100",disabled:!0})]}),P.length>1&&n.jsx("button",{type:"button",onClick:()=>Re(Ee),className:"p-1.5 text-red-600 hover:bg-red-50 rounded",title:"Remove Item",children:n.jsx(Lr,{className:"w-4 h-4"})})]})]}),Ne.batch_id&&rt>0&&n.jsxs("div",{className:"flex items-center gap-2 text-[10px] px-2 py-1 bg-white rounded border border-gray-200",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("span",{className:"text-gray-600",children:"Cost/Unit:"}),n.jsxs("span",{className:"font-semibold text-gray-900",children:["Rp ",rt.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),n.jsx("div",{className:"h-3 w-px bg-gray-300"}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("span",{className:"text-gray-600",children:"Suggested Price (25%):"}),n.jsxs("span",{className:"font-semibold text-blue-600",children:["Rp ",mt.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),n.jsx("div",{className:"h-3 w-px bg-gray-300"}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsxs("span",{className:"text-gray-600",children:["Margin ",n.jsx("span",{className:"text-xs italic",children:"(Provisional)"}),":"]}),n.jsxs("span",{className:`font-semibold ${nt>=20?"text-green-600":nt>=10?"text-yellow-600":"text-red-600"}`,children:[nt.toFixed(1),"%"]})]}),n.jsx("div",{className:"h-3 w-px bg-gray-300"}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsxs("span",{className:"text-gray-600",children:["Profit/Unit ",n.jsx("span",{className:"text-xs italic",children:"(Provisional)"}),":"]}),n.jsxs("span",{className:`font-semibold ${Ne.unit_price>rt?"text-green-600":"text-red-600"}`,children:["Rp ",(Ne.unit_price-rt).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})]},Ee)})}),n.jsx("div",{className:"mt-2 p-2 bg-blue-50 rounded",children:n.jsxs("div",{className:"space-y-1 text-xs",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{children:"Subtotal:"}),n.jsxs("span",{className:"font-medium",children:["Rp ",et().subtotal.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{children:"Tax:"}),n.jsxs("span",{className:"font-medium",children:["Rp ",et().taxAmount.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{children:"Discount:"}),n.jsxs("span",{className:"font-medium",children:["-Rp ",D.discount.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),n.jsxs("div",{className:"flex justify-between text-sm font-bold border-t pt-1",children:[n.jsx("span",{children:"Total:"}),n.jsxs("span",{className:"text-blue-600",children:["Rp ",et().total.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})})]}),n.jsxs("div",{className:"flex justify-end gap-2 pt-3 border-t",children:[n.jsx("button",{type:"button",onClick:()=>{R(!1),ke()},className:"px-3 py-1.5 text-sm border border-gray-300 rounded hover:bg-gray-50 transition",children:"Cancel"}),n.jsx("button",{type:"submit",className:"px-3 py-1.5 text-sm bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:ee?"Update Invoice":"Create Invoice"})]})]})}),q&&G&&n.jsx(zue,{invoice:G,items:U,onClose:()=>{z(!1),re(null),S([])}})]})})}const uD=Q.createContext(void 0);function Yue({children:e}){const[t,r]=Q.useState({startDate:new Date(new Date().getFullYear(),0,1).toISOString().split("T")[0],endDate:new Date().toISOString().split("T")[0]}),[a,s]=Q.useState(0),i=()=>{s(o=>o+1)};return Q.useEffect(()=>{console.log("Finance date range changed:",t)},[t]),n.jsx(uD.Provider,{value:{dateRange:t,setDateRange:r,refreshTrigger:a,triggerRefresh:i},children:e})}function rl(){const e=Q.useContext(uD);if(e===void 0)throw new Error("useFinance must be used within a FinanceProvider");return e}function Jue({canManage:e}){var L;const[t,r]=Q.useState([]),[a,s]=Q.useState([]),[i,o]=Q.useState([]),[l,c]=Q.useState([]),[d,u]=Q.useState(!0),[f,h]=Q.useState(!1),[A,x]=Q.useState(!1),[p,b]=Q.useState(null),[m,g]=Q.useState(""),[y,v]=Q.useState(!1),[_,j]=Q.useState({invoice_number:"",supplier_id:"",invoice_date:new Date().toISOString().split("T")[0],due_date:"",currency:"IDR",exchange_rate:1,faktur_pajak_number:"",notes:"",document_urls:[]}),[N,B]=Q.useState([{item_type:"inventory",product_id:null,description:"",quantity:1,unit:"pcs",unit_price:0,line_total:0,expense_account_id:null,asset_account_id:null,tax_amount:0}]);Q.useEffect(()=>{E(),C(),k(),w()},[]);const E=async()=>{try{const{data:P,error:I}=await Z.from("purchase_invoices").select("*, suppliers(company_name, pkp_status)").order("invoice_date",{ascending:!1});if(I)throw I;r(P||[])}catch(P){console.error("Error loading invoices:",P)}finally{u(!1)}},C=async()=>{const{data:P}=await Z.from("suppliers").select("id, company_name, npwp, pkp_status, address, contact_person, phone, email").order("company_name");s(P||[])},k=async()=>{const{data:P}=await Z.from("products").select("id, product_name, unit, current_stock").order("product_name");o(P||[])},w=async()=>{const{data:P}=await Z.from("chart_of_accounts").select("id, code, name, account_type").in("account_type",["Expense","Asset","Cost of Goods Sold"]).order("code");c(P||[])},T=a.find(P=>P.id===_.supplier_id),R=()=>{B([...N,{item_type:"inventory",product_id:null,description:"",quantity:1,unit:"pcs",unit_price:0,line_total:0,expense_account_id:null,asset_account_id:null,tax_amount:0}])},q=P=>{N.length>1&&B(N.filter((I,H)=>H!==P))},z=(P,I,H)=>{const V=[...N];if(V[P]={...V[P],[I]:H},(I==="quantity"||I==="unit_price")&&(V[P].line_total=V[P].quantity*V[P].unit_price),I==="item_type"&&(V[P].product_id=null,V[P].expense_account_id=null,V[P].asset_account_id=null,V[P].description=""),I==="product_id"&&H){const W=i.find(M=>M.id===H);W&&(V[P].description=W.product_name,V[P].unit=W.unit,V[P].product_name=W.product_name)}B(V)},ee=()=>{const P=N.reduce((V,W)=>V+W.line_total,0),I=N.reduce((V,W)=>V+W.tax_amount,0),H=P+I;return{subtotal:P,taxTotal:I,total:H}},Y=async P=>{var H;if(P.preventDefault(),!e){alert("You do not have permission to create purchase invoices");return}if(!_.supplier_id){alert("Please select a supplier");return}if(N.length===0||N.every(V=>V.line_total===0)){alert("Please add at least one line item");return}if(_.currency==="USD"&&_.exchange_rate<=1){alert("Please enter a valid exchange rate for USD");return}for(let V=0;V<N.length;V++){const W=N[V];if(W.item_type==="inventory"&&!W.product_id){alert(`Line ${V+1}: Please select a product for inventory items`);return}if(W.item_type==="expense"&&!W.expense_account_id){alert(`Line ${V+1}: Please select an expense account`);return}if(W.item_type==="fixed_asset"&&!W.asset_account_id){alert(`Line ${V+1}: Please select an asset account`);return}if(!W.description.trim()){alert(`Line ${V+1}: Please enter a description`);return}}const I=ee();try{const{data:V}=await Z.auth.getUser(),W={invoice_number:_.invoice_number.trim(),supplier_id:_.supplier_id,invoice_date:_.invoice_date,due_date:_.due_date||null,currency:_.currency,exchange_rate:_.exchange_rate,subtotal:I.subtotal,tax_amount:I.taxTotal,total_amount:I.total,paid_amount:0,balance_amount:I.total,status:"unpaid",faktur_pajak_number:_.faktur_pajak_number.trim()||null,notes:_.notes.trim()||null,document_urls:_.document_urls,requires_faktur_pajak:(T==null?void 0:T.pkp_status)||!1,created_by:(H=V.user)==null?void 0:H.id},{data:M,error:se}=await Z.from("purchase_invoices").insert([W]).select().single();if(se)throw se;const K=N.map(ne=>({purchase_invoice_id:M.id,item_type:ne.item_type,product_id:ne.product_id,description:ne.description,quantity:ne.quantity,unit:ne.unit,unit_price:ne.unit_price,line_total:ne.line_total,tax_amount:ne.tax_amount,expense_account_id:ne.expense_account_id,asset_account_id:ne.asset_account_id})),{error:he}=await Z.from("purchase_invoice_items").insert(K);if(he)throw he;alert("Purchase invoice created successfully!"),U(),h(!1),E()}catch(V){console.error("Error creating purchase invoice:",V),alert(`Error: ${V.message}`)}},G=async P=>{v(!0);try{const I=[];for(const H of P){const V=H.name.split(".").pop(),M=`purchase-invoices/${`${Date.now()}-${Math.random().toString(36).substring(7)}.${V}`}`,{error:se,data:K}=await Z.storage.from("documents").upload(M,H);if(se)throw se;const{data:{publicUrl:he}}=Z.storage.from("documents").getPublicUrl(M);I.push(he)}j(H=>({...H,document_urls:[...H.document_urls,...I]}))}catch(I){console.error("Error uploading files:",I),alert(`Error uploading files: ${I.message}`)}finally{v(!1)}},re=P=>{j(I=>({...I,document_urls:I.document_urls.filter((H,V)=>V!==P)}))},U=()=>{j({invoice_number:"",supplier_id:"",invoice_date:new Date().toISOString().split("T")[0],due_date:"",currency:"IDR",exchange_rate:1,faktur_pajak_number:"",notes:"",document_urls:[]}),B([{item_type:"inventory",product_id:null,description:"",quantity:1,unit:"pcs",unit_price:0,line_total:0,expense_account_id:null,asset_account_id:null,tax_amount:0}])},S=t.filter(P=>{var I,H;return P.invoice_number.toLowerCase().includes(m.toLowerCase())||((H=(I=P.suppliers)==null?void 0:I.company_name)==null?void 0:H.toLowerCase().includes(m.toLowerCase()))}),D=ee();return d?n.jsx("div",{className:"p-8 text-center",children:"Loading..."}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Purchase Invoices"}),e&&n.jsxs("button",{onClick:()=>{U(),h(!0)},className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[n.jsx(Pr,{className:"w-4 h-4"}),"New Purchase Invoice"]})]}),n.jsx("div",{className:"flex items-center gap-4",children:n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(Ca,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),n.jsx("input",{type:"text",placeholder:"Search by invoice number or supplier...",value:m,onChange:P=>g(P.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),n.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Invoice #"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Supplier"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Currency"}),n.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"}),n.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Balance"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),n.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:S.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:8,className:"px-6 py-12 text-center text-gray-500",children:"No purchase invoices found. Create your first one!"})}):S.map(P=>{var I;return n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:P.invoice_number}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(I=P.suppliers)==null?void 0:I.company_name}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(P.invoice_date).toLocaleDateString()}),n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[P.currency,P.currency==="USD"&&n.jsxs("span",{className:"text-xs text-gray-400 ml-1",children:["@ ",P.exchange_rate.toLocaleString()]})]}),n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right text-gray-900 font-medium",children:[P.currency," ",P.total_amount.toLocaleString()]}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right font-medium",children:n.jsxs("span",{className:P.balance_amount>0?"text-red-600":"text-green-600",children:[P.currency," ",P.balance_amount.toLocaleString()]})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${P.status==="paid"?"bg-green-100 text-green-800":P.status==="partial"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:P.status})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:n.jsx("button",{onClick:()=>{b(P),x(!0)},className:"text-blue-600 hover:text-blue-900 mr-3",title:"View Details",children:n.jsx(bi,{className:"w-4 h-4"})})})]},P.id)})})]})}),n.jsx(Ot,{isOpen:f,onClose:()=>{h(!1),U()},title:"New Purchase Invoice",children:n.jsxs("form",{onSubmit:Y,className:"space-y-6",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Supplier *"}),n.jsxs("select",{value:_.supplier_id,onChange:P=>j({..._,supplier_id:P.target.value}),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"",children:"Select Supplier"}),a.map(P=>n.jsxs("option",{value:P.id,children:[P.company_name," ",P.pkp_status&&"(PKP)"]},P.id))]}),T&&T.npwp&&n.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["NPWP: ",T.npwp]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Invoice Number *"}),n.jsx("input",{type:"text",value:_.invoice_number,onChange:P=>j({..._,invoice_number:P.target.value}),required:!0,placeholder:"INV-001",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Invoice Date *"}),n.jsx("input",{type:"date",value:_.invoice_date,onChange:P=>j({..._,invoice_date:P.target.value}),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Due Date"}),n.jsx("input",{type:"date",value:_.due_date,onChange:P=>j({..._,due_date:P.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Currency *"}),n.jsxs("select",{value:_.currency,onChange:P=>j({..._,currency:P.target.value,exchange_rate:P.target.value==="IDR"?1:_.exchange_rate}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"IDR",children:"IDR"}),n.jsx("option",{value:"USD",children:"USD"})]})]}),_.currency==="USD"&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Exchange Rate * (1 USD = ? IDR)"}),n.jsx("input",{type:"number",value:_.exchange_rate,onChange:P=>j({..._,exchange_rate:parseFloat(P.target.value)||1}),min:"1",step:"0.01",required:!0,placeholder:"15750",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),(T==null?void 0:T.pkp_status)&&n.jsxs("div",{className:"col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Faktur Pajak Number"}),n.jsx("input",{type:"text",value:_.faktur_pajak_number,onChange:P=>j({..._,faktur_pajak_number:P.target.value}),placeholder:"010.000-00.00000000",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),n.jsx("textarea",{value:_.notes,onChange:P=>j({..._,notes:P.target.value}),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Attachments (Supplier Invoice)"}),n.jsx(LE,{onUpload:G,accept:".pdf,.jpg,.jpeg,.png",multiple:!0,disabled:y}),_.document_urls.length>0&&n.jsx("div",{className:"mt-2 space-y-1",children:_.document_urls.map((P,I)=>n.jsxs("div",{className:"flex items-center justify-between bg-gray-50 px-3 py-2 rounded",children:[n.jsx("span",{className:"text-sm text-gray-600 truncate",children:P.split("/").pop()}),n.jsx("button",{type:"button",onClick:()=>re(I),className:"text-red-600 hover:text-red-800",children:n.jsx(wr,{className:"w-4 h-4"})})]},I))})]})]}),n.jsxs("div",{className:"border-t pt-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Line Items"}),n.jsxs("button",{type:"button",onClick:R,className:"inline-flex items-center gap-1 px-3 py-1 text-sm bg-blue-600 text-white rounded hover:bg-blue-700",children:[n.jsx(Pr,{className:"w-4 h-4"}),"Add Line"]})]}),n.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:N.map((P,I)=>n.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 space-y-3",children:[n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["Line ",I+1]}),N.length>1&&n.jsx("button",{type:"button",onClick:()=>q(I),className:"text-red-600 hover:text-red-800",children:n.jsx(wr,{className:"w-4 h-4"})})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Type *"}),n.jsxs("select",{value:P.item_type,onChange:H=>z(I,"item_type",H.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"inventory",children:"Inventory (Stock)"}),n.jsx("option",{value:"fixed_asset",children:"Fixed Asset"}),n.jsx("option",{value:"expense",children:"Expense"}),n.jsx("option",{value:"freight",children:"Freight"}),n.jsx("option",{value:"duty",children:"Import Duty"}),n.jsx("option",{value:"insurance",children:"Insurance"}),n.jsx("option",{value:"clearing",children:"Clearing & Forwarding"}),n.jsx("option",{value:"other",children:"Other Cost"})]})]}),P.item_type==="inventory"?n.jsxs("div",{className:"col-span-2",children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Product *"}),n.jsxs("select",{value:P.product_id||"",onChange:H=>z(I,"product_id",H.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"",children:"Select Product"}),i.map(H=>n.jsxs("option",{value:H.id,children:[H.product_name," (Stock: ",H.current_stock,")"]},H.id))]})]}):P.item_type==="expense"?n.jsxs("div",{className:"col-span-2",children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Expense Account *"}),n.jsxs("select",{value:P.expense_account_id||"",onChange:H=>z(I,"expense_account_id",H.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"",children:"Select Account"}),l.filter(H=>H.account_type==="Expense"||H.account_type==="Cost of Goods Sold").map(H=>n.jsxs("option",{value:H.id,children:[H.code," - ",H.name]},H.id))]})]}):P.item_type==="fixed_asset"?n.jsxs("div",{className:"col-span-2",children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Asset Account *"}),n.jsxs("select",{value:P.asset_account_id||"",onChange:H=>z(I,"asset_account_id",H.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"",children:"Select Account"}),l.filter(H=>H.account_type==="Asset").map(H=>n.jsxs("option",{value:H.id,children:[H.code," - ",H.name]},H.id))]})]}):n.jsxs("div",{className:"col-span-2",children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Ledger (Optional - defaults to Inventory)"}),n.jsxs("select",{value:P.expense_account_id||"",onChange:H=>z(I,"expense_account_id",H.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"",children:"Capitalize to Inventory (Default)"}),l.filter(H=>H.account_type==="Expense"||H.account_type==="Cost of Goods Sold").map(H=>n.jsxs("option",{value:H.id,children:[H.code," - ",H.name]},H.id))]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Description *"}),n.jsx("input",{type:"text",value:P.description,onChange:H=>z(I,"description",H.target.value),placeholder:"Item description",className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"})]}),n.jsxs("div",{className:"grid grid-cols-5 gap-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Qty *"}),n.jsx("input",{type:"number",value:P.quantity,onChange:H=>z(I,"quantity",parseFloat(H.target.value)||0),min:"0",step:"0.01",className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Unit"}),n.jsx("input",{type:"text",value:P.unit,onChange:H=>z(I,"unit",H.target.value),placeholder:"pcs",className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Rate *"}),n.jsx("input",{type:"number",value:P.unit_price,onChange:H=>z(I,"unit_price",parseFloat(H.target.value)||0),min:"0",step:"0.01",className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Tax"}),n.jsx("input",{type:"number",value:P.tax_amount,onChange:H=>z(I,"tax_amount",parseFloat(H.target.value)||0),min:"0",step:"0.01",className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Amount"}),n.jsx("input",{type:"text",value:P.line_total.toLocaleString(),readOnly:!0,className:"w-full px-2 py-1.5 text-sm border border-gray-200 rounded bg-gray-50 font-medium"})]})]})]},I))}),n.jsxs("div",{className:"mt-6 border-t pt-4 space-y-2",children:[n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{className:"text-gray-600",children:"Subtotal:"}),n.jsxs("span",{className:"font-medium",children:[_.currency," ",D.subtotal.toLocaleString()]})]}),n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{className:"text-gray-600",children:"Tax:"}),n.jsxs("span",{className:"font-medium",children:[_.currency," ",D.taxTotal.toLocaleString()]})]}),n.jsxs("div",{className:"flex justify-between text-lg font-bold border-t pt-2",children:[n.jsx("span",{children:"Total:"}),n.jsxs("span",{className:"text-blue-600",children:[_.currency," ",D.total.toLocaleString()]})]}),_.currency==="USD"&&_.exchange_rate>1&&n.jsxs("div",{className:"flex justify-between text-sm text-gray-500",children:[n.jsx("span",{children:"Equivalent (IDR):"}),n.jsxs("span",{children:["IDR ",(D.total*_.exchange_rate).toLocaleString()]})]})]})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-6 border-t",children:[n.jsx("button",{type:"button",onClick:()=>{h(!1),U()},className:"px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancel"}),n.jsx("button",{type:"submit",disabled:y,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:y?"Uploading...":"Create Invoice"})]})]})}),p&&n.jsx(Ot,{isOpen:A,onClose:()=>{x(!1),b(null)},title:`Purchase Invoice: ${p.invoice_number}`,children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-gray-600",children:"Supplier:"}),n.jsx("p",{className:"font-medium",children:(L=p.suppliers)==null?void 0:L.company_name})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-gray-600",children:"Invoice Date:"}),n.jsx("p",{className:"font-medium",children:new Date(p.invoice_date).toLocaleDateString()})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-gray-600",children:"Currency:"}),n.jsx("p",{className:"font-medium",children:p.currency})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-gray-600",children:"Total:"}),n.jsxs("p",{className:"font-medium text-lg",children:[p.currency," ",p.total_amount.toLocaleString()]})]})]}),p.notes&&n.jsxs("div",{children:[n.jsx("p",{className:"text-gray-600 text-sm",children:"Notes:"}),n.jsx("p",{className:"text-sm",children:p.notes})]})]})})]})}function Zue({canManage:e}){var se,K,he,ne,te;const t=Q.useRef(null),[r,a]=Q.useState([]),[s,i]=Q.useState([]),[o,l]=Q.useState([]),[c,d]=Q.useState([]),[u,f]=Q.useState(!0),[h,A]=Q.useState(!1),[x,p]=Q.useState(!1),[b,m]=Q.useState(!1),[g,y]=Q.useState(null),[v,_]=Q.useState([]),[j,N]=Q.useState(""),[B,E]=Q.useState([]),[C,k]=Q.useState(""),[w,T]=Q.useState(""),[R,q]=Q.useState({voucher_date:new Date().toISOString().split("T")[0],customer_id:"",payment_method:"bank_transfer",bank_account_id:"",reference_number:"",amount:0,description:""});Q.useEffect(()=>{ee(),Y(),G(),z()},[]);const z=async()=>{const{data:ce}=await Z.from("app_settings").select("company_name, company_address").single();ce&&(k(ce.company_name||""),T(ce.company_address||""))};Q.useEffect(()=>{R.customer_id?re(R.customer_id):(d([]),E([]))},[R.customer_id]);const ee=async()=>{try{const{data:ce,error:_e}=await Z.from("receipt_vouchers").select("*, customers(company_name), bank_accounts(account_name, bank_name, alias)").order("voucher_date",{ascending:!1});if(_e)throw _e;const de=await Promise.all((ce||[]).map(async ye=>{const{data:Le}=await Z.from("voucher_allocations").select(`
              allocated_amount,
              sales_invoice_id,
              sales_order_id,
              sales_invoices(invoice_number),
              sales_orders(so_number)
            `).eq("receipt_voucher_id",ye.id);let we="-";if(Le&&Le.length>0){const ge=Le.map(Re=>Re.sales_invoice_id&&Re.sales_invoices?`${Re.sales_invoices.invoice_number} (Invoice)`:Re.sales_order_id&&Re.sales_orders?`${Re.sales_orders.so_number} (Advance)`:null).filter(Boolean);we=ge.length>0?ge.join(", "):"-"}return{...ye,allocated_to:we}}));a(de)}catch(ce){console.error("Error loading vouchers:",ce)}finally{f(!1)}},Y=async()=>{const{data:ce}=await Z.from("customers").select("id, company_name").order("company_name");i(ce||[])},G=async()=>{const{data:ce}=await Z.from("bank_accounts").select("id, account_name, bank_name, account_number, alias").eq("is_active",!0);l(ce||[])},re=async(ce,_e=!1,de)=>{try{const{data:ye}=await Z.rpc("get_invoices_with_balance",{customer_uuid:ce}),Le=(ye||[]).filter(ke=>ke.balance_amount>0),{data:we}=await Z.from("sales_orders").select("id, so_number, so_date, total_amount, advance_payment_amount, advance_payment_status, status").eq("customer_id",ce).not("status","in","(cancelled,closed)").order("so_date");let ge=[],Re=[];if(de){const{data:ke}=await Z.from("voucher_allocations").select("sales_invoice_id, sales_order_id").eq("receipt_voucher_id",de);if(ke){const Ue=ke.filter($e=>$e.sales_invoice_id).map($e=>$e.sales_invoice_id),qe=ke.filter($e=>$e.sales_order_id).map($e=>$e.sales_order_id);if(Ue.length>0){const{data:$e}=await Z.rpc("get_invoices_with_balance",{customer_uuid:ce});ge=($e||[]).filter(Ne=>Ue.includes(Ne.id))}if(qe.length>0){const{data:$e}=await Z.from("sales_orders").select("id, so_number, so_date, total_amount, advance_payment_amount, advance_payment_status, status").in("id",qe);Re=$e||[]}}}const et=[...Le||[],...ge],Ye=Array.from(new Map(et.map(ke=>[ke.id,ke])).values()),Be=[...we||[],...Re],oe=[...Array.from(new Map(Be.map(ke=>[ke.id,ke])).values()).filter(ke=>ke.advance_payment_status!=="full").map(ke=>({...ke,balance_due:ke.total_amount-(ke.advance_payment_amount||0),type:"salesorder"})),...Ye.map(ke=>({...ke,type:"invoice"}))];d(oe),_e||E([])}catch(ye){console.error("Error loading allocation targets:",ye)}},U=async()=>{const ce=new Date().getFullYear().toString().slice(-2),_e=(new Date().getMonth()+1).toString().padStart(2,"0"),{count:de}=await Z.from("receipt_vouchers").select("*",{count:"exact",head:!0}).like("voucher_number",`RV${ce}${_e}%`);return`RV${ce}${_e}-${String((de||0)+1).padStart(4,"0")}`},S=(ce,_e,de)=>{E(ye=>ye.find(we=>we.targetId===ce)?de<=0?ye.filter(we=>we.targetId!==ce):ye.map(we=>we.targetId===ce?{...we,amount:de}:we):de>0?[...ye,{targetId:ce,targetType:_e,amount:de}]:ye)},D=B.reduce((ce,_e)=>ce+_e.amount,0),L=async()=>{if(!(!t.current||!g))try{const ce=await Zo(t.current,{scale:2,useCORS:!0,logging:!1}),_e=ce.toDataURL("image/png"),de=new Ut("p","mm","a4"),ye=de.internal.pageSize.getWidth(),Le=ce.height*ye/ce.width;de.addImage(_e,"PNG",0,0,ye,Le),de.save(`Receipt-${g.voucher_number}.pdf`)}catch(ce){console.error("Error generating PDF:",ce),alert("Error generating PDF. Please try again.")}},P=async ce=>{if(ce.preventDefault(),B.length>0&&D>R.amount){alert("Total allocated amount cannot exceed payment amount");return}try{const{data:{user:_e}}=await Z.auth.getUser();if(!_e)throw new Error("Not authenticated");let de;if(b&&g){const{data:ye,error:Le}=await Z.from("receipt_vouchers").update({voucher_date:R.voucher_date,payment_method:R.payment_method,bank_account_id:R.bank_account_id||null,reference_number:R.reference_number||null,amount:R.amount,description:R.description||null}).eq("id",g.id).select().single();if(Le)throw Le;de=ye,await Z.from("voucher_allocations").delete().eq("receipt_voucher_id",g.id)}else{const ye=await U(),{data:Le,error:we}=await Z.from("receipt_vouchers").insert([{voucher_number:ye,voucher_date:R.voucher_date,customer_id:R.customer_id,payment_method:R.payment_method,bank_account_id:R.bank_account_id||null,reference_number:R.reference_number||null,amount:R.amount,description:R.description||null,created_by:_e.id}]).select().single();if(we)throw we;de=Le}for(const ye of B)if(ye.targetType==="invoice"){await Z.from("voucher_allocations").insert({voucher_type:"receipt",receipt_voucher_id:de.id,sales_invoice_id:ye.targetId,allocated_amount:ye.amount});const Le=c.find(we=>we.type==="invoice"&&we.id===ye.targetId);if(Le){const we=(Le.paid_amount||0)+ye.amount,ge=Le.total_amount-we;await Z.from("sales_invoices").update({paid_amount:we,balance_amount:ge,payment_status:ge<=0?"paid":"partial"}).eq("id",ye.targetId)}}else ye.targetType==="salesorder"&&await Z.from("voucher_allocations").insert({voucher_type:"receipt",receipt_voucher_id:de.id,sales_order_id:ye.targetId,allocated_amount:ye.amount});A(!1),I(),ee()}catch(_e){console.error("Error saving voucher:",_e),alert("Failed to save: "+_e.message)}},I=()=>{q({voucher_date:new Date().toISOString().split("T")[0],customer_id:"",payment_method:"bank_transfer",bank_account_id:"",reference_number:"",amount:0,description:""}),E([]),d([]),m(!1),y(null)},H=async ce=>{y(ce);const{data:_e}=await Z.from("voucher_allocations").select(`
        *,
        sales_invoices(invoice_number, total_amount),
        sales_orders(so_number, total_amount)
      `).eq("receipt_voucher_id",ce.id);_(_e||[]),p(!0)},V=async ce=>{y(ce),m(!0),q({voucher_date:ce.voucher_date,customer_id:ce.customer_id,payment_method:ce.payment_method,bank_account_id:ce.bank_account_id||"",reference_number:ce.reference_number||"",amount:ce.amount,description:ce.description||""}),await re(ce.customer_id,!1,ce.id);const{data:_e}=await Z.from("voucher_allocations").select("*").eq("receipt_voucher_id",ce.id);if(_e){const de=_e.map(ye=>({targetId:ye.sales_invoice_id||ye.sales_order_id,targetType:ye.sales_invoice_id?"invoice":"salesorder",amount:Number(ye.allocated_amount)}));E(de)}A(!0)},W=async ce=>{if(confirm(`Delete receipt voucher ${ce.voucher_number}? This will remove all allocations and cannot be undone.`))try{await Z.from("voucher_allocations").delete().eq("receipt_voucher_id",ce.id);const{error:_e}=await Z.from("receipt_vouchers").delete().eq("id",ce.id);if(_e)throw _e;alert("Receipt voucher deleted successfully"),ee()}catch(_e){console.error("Error deleting voucher:",_e),alert("Failed to delete: "+_e.message)}},M=r.filter(ce=>{var _e,de;return ce.voucher_number.toLowerCase().includes(j.toLowerCase())||((de=(_e=ce.customers)==null?void 0:_e.company_name)==null?void 0:de.toLowerCase().includes(j.toLowerCase()))});return u?n.jsx("div",{className:"flex justify-center py-8",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"relative flex-1 max-w-md",children:[n.jsx(Ca,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),n.jsx("input",{type:"text",placeholder:"Search receipts...",value:j,onChange:ce=>N(ce.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg"})]}),e&&n.jsxs("button",{onClick:()=>{I(),A(!0)},className:"flex items-center gap-2 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700",children:[n.jsx(Gb,{className:"w-5 h-5"}),"New Receipt"]})]}),n.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Voucher No"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Customer"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Method"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Bank"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Allocated To"}),n.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Amount"}),n.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),n.jsxs("tbody",{className:"divide-y",children:[M.map(ce=>{var _e,de,ye;return n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-4 py-3 font-mono text-sm",children:ce.voucher_number}),n.jsx("td",{className:"px-4 py-3",children:new Date(ce.voucher_date).toLocaleDateString("id-ID")}),n.jsx("td",{className:"px-4 py-3",children:(_e=ce.customers)==null?void 0:_e.company_name}),n.jsx("td",{className:"px-4 py-3",children:n.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 rounded text-xs capitalize",children:ce.payment_method.replace("_"," ")})}),n.jsx("td",{className:"px-4 py-3 text-sm",children:((de=ce.bank_accounts)==null?void 0:de.alias)||((ye=ce.bank_accounts)==null?void 0:ye.account_name)||"-"}),n.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:ce.allocated_to}),n.jsxs("td",{className:"px-4 py-3 text-right font-medium text-green-600",children:["Rp ",ce.amount.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]}),n.jsx("td",{className:"px-4 py-3",children:n.jsxs("div",{className:"flex items-center justify-center gap-2",children:[n.jsx("button",{onClick:()=>H(ce),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",title:"View Details",children:n.jsx(bi,{className:"w-4 h-4"})}),e&&n.jsxs(n.Fragment,{children:[n.jsx("button",{onClick:()=>V(ce),className:"p-1 text-amber-600 hover:bg-amber-50 rounded",title:"Edit",children:n.jsx(OA,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>W(ce),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Delete",children:n.jsx(Lr,{className:"w-4 h-4"})})]})]})})]},ce.id)}),M.length===0&&n.jsx("tr",{children:n.jsx("td",{colSpan:7,className:"px-4 py-8 text-center text-gray-500",children:"No receipt vouchers found"})})]})]})}),n.jsx(Ot,{isOpen:h,onClose:()=>{A(!1),I()},title:b?"Edit Receipt Voucher":"New Receipt Voucher",children:n.jsxs("form",{onSubmit:P,className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date *"}),n.jsx("input",{type:"date",required:!0,value:R.voucher_date,onChange:ce=>q({...R,voucher_date:ce.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer *"}),b?n.jsx("div",{className:"w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50",children:((se=s.find(ce=>ce.id===R.customer_id))==null?void 0:se.company_name)||"Unknown"}):n.jsxs("select",{required:!0,value:R.customer_id,onChange:ce=>q({...R,customer_id:ce.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[n.jsx("option",{value:"",children:"Select customer"}),s.map(ce=>n.jsx("option",{value:ce.id,children:ce.company_name},ce.id))]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Method *"}),n.jsxs("select",{required:!0,value:R.payment_method,onChange:ce=>q({...R,payment_method:ce.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[n.jsx("option",{value:"cash",children:"Cash"}),n.jsx("option",{value:"bank_transfer",children:"Bank Transfer"}),n.jsx("option",{value:"check",children:"Check"}),n.jsx("option",{value:"giro",children:"Giro"}),n.jsx("option",{value:"other",children:"Other"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount (Rp) *"}),n.jsx("input",{type:"number",required:!0,value:R.amount,onChange:ce=>q({...R,amount:parseFloat(ce.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]})]}),R.payment_method!=="cash"&&n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bank Account"}),n.jsxs("select",{value:R.bank_account_id,onChange:ce=>q({...R,bank_account_id:ce.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[n.jsx("option",{value:"",children:"Select account"}),o.map(ce=>n.jsx("option",{value:ce.id,children:ce.alias||`${ce.bank_name} - ${ce.account_name}`},ce.id))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reference No."}),n.jsx("input",{type:"text",value:R.reference_number,onChange:ce=>q({...R,reference_number:ce.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"Check/Transfer reference"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),n.jsx("textarea",{value:R.description,onChange:ce=>q({...R,description:ce.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",rows:2})]}),(c.length>0||B.length>0||b)&&n.jsxs("div",{className:"border-t pt-4",children:[n.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"Allocate Payment"}),n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-3",children:[n.jsx("p",{className:"text-sm text-blue-900 font-medium mb-1",children:"How to allocate:"}),n.jsxs("ul",{className:"text-xs text-blue-800 space-y-1 ml-4 list-disc",children:[n.jsxs("li",{children:[n.jsx("strong",{className:"text-purple-700",children:"SO (Advance)"})," = Record advance payment against Sales Order"]}),n.jsxs("li",{children:[n.jsx("strong",{className:"text-blue-700",children:"Invoice"})," = Record payment against Sales Invoice"]}),n.jsx("li",{children:'Enter amount in "Allocate (Rp)" column to link payment to document'}),n.jsx("li",{children:"You can allocate partial amounts to multiple documents"})]})]}),c.length>0?n.jsx("div",{className:"max-h-64 overflow-y-auto border rounded-lg",children:n.jsxs("table",{className:"w-full text-sm",children:[n.jsx("thead",{className:"bg-gray-50 sticky top-0",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-3 py-2 text-left",children:"Document"}),n.jsx("th",{className:"px-3 py-2 text-center",children:"Type"}),n.jsx("th",{className:"px-3 py-2 text-right",children:"Balance Due"}),n.jsx("th",{className:"px-3 py-2 text-right",children:"Allocate (Rp)"})]})}),n.jsx("tbody",{className:"divide-y",children:c.map(ce=>{var Le;const _e=ce.type==="invoice"?ce.balance_amount:ce.balance_due,de=ce.type==="invoice"?ce.invoice_number:ce.so_number,ye=ce.type==="invoice"?ce.invoice_date:ce.so_date;return n.jsxs("tr",{children:[n.jsxs("td",{className:"px-3 py-2",children:[n.jsx("div",{className:"font-mono text-xs",children:de}),n.jsx("div",{className:"text-gray-500 text-xs",children:new Date(ye).toLocaleDateString("id-ID")})]}),n.jsx("td",{className:"px-3 py-2 text-center",children:n.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${ce.type==="salesorder"?"bg-purple-100 text-purple-700":"bg-blue-100 text-blue-700"}`,children:ce.type==="salesorder"?"SO (Advance)":"Invoice"})}),n.jsxs("td",{className:"px-3 py-2 text-right text-red-600 font-medium",children:["Rp ",_e.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]}),n.jsx("td",{className:"px-3 py-2",children:n.jsx("input",{type:"number",min:0,max:_e,value:((Le=B.find(we=>we.targetId===ce.id))==null?void 0:Le.amount)||"",onChange:we=>S(ce.id,ce.type,parseFloat(we.target.value)||0),className:"w-28 px-2 py-1 border rounded text-right text-xs",placeholder:"0"})})]},`${ce.type}-${ce.id}`)})})]})}):n.jsxs("div",{className:"border rounded-lg p-4 text-center text-gray-500 text-sm",children:[n.jsx("p",{children:"No unpaid invoices or sales orders found for this customer."}),b&&B.length>0&&n.jsx("p",{className:"mt-2 text-xs",children:"This voucher had allocations that are now fully paid or no longer available."})]}),n.jsxs("div",{className:"mt-3 flex justify-between items-center text-sm",children:[n.jsxs("div",{className:"text-gray-600",children:[n.jsx("span",{className:"font-medium",children:B.length})," allocation(s)"]}),n.jsxs("div",{className:"text-right",children:[n.jsx("span",{className:"text-gray-500",children:"Total Allocated:"}),n.jsxs("span",{className:`ml-2 font-bold text-lg ${D>R.amount?"text-red-600":"text-green-600"}`,children:["Rp ",D.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]}),n.jsxs("span",{className:"text-gray-400 ml-1",children:["/ Rp ",R.amount.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[n.jsx("button",{type:"button",onClick:()=>{A(!1),I()},className:"px-4 py-2 text-gray-700 border rounded-lg hover:bg-gray-50",children:"Cancel"}),n.jsx("button",{type:"submit",className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:b?"Update Receipt":"Save Receipt"})]})]})}),n.jsx(Ot,{isOpen:x,onClose:()=>{p(!1),y(null),_([])},title:"Receipt Voucher Details",children:g&&n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Voucher Number"}),n.jsx("p",{className:"font-mono font-medium",children:g.voucher_number})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Date"}),n.jsx("p",{children:new Date(g.voucher_date).toLocaleDateString("id-ID")})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Customer"}),n.jsx("p",{children:(K=g.customers)==null?void 0:K.company_name})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Payment Method"}),n.jsx("p",{className:"capitalize",children:g.payment_method.replace("_"," ")})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Bank Account"}),n.jsx("p",{children:((he=g.bank_accounts)==null?void 0:he.alias)||(g.bank_accounts?`${g.bank_accounts.bank_name} - ${g.bank_accounts.account_name}`:"-")})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Reference"}),n.jsx("p",{children:g.reference_number||"-"})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Amount"}),n.jsxs("p",{className:"text-2xl font-bold text-green-600",children:["Rp ",g.amount.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),g.description&&n.jsxs("div",{className:"col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Description"}),n.jsx("p",{className:"text-gray-700",children:g.description})]})]}),n.jsxs("div",{className:"border-t pt-4",children:[n.jsx("h4",{className:"font-medium text-gray-700 mb-3",children:"Allocations"}),v.length>0?n.jsx("div",{className:"border rounded-lg overflow-hidden",children:n.jsxs("table",{className:"w-full text-sm",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-3 py-2 text-left",children:"Document"}),n.jsx("th",{className:"px-3 py-2 text-center",children:"Type"}),n.jsx("th",{className:"px-3 py-2 text-right",children:"Amount"})]})}),n.jsx("tbody",{className:"divide-y",children:v.map((ce,_e)=>{var de;return n.jsxs("tr",{children:[n.jsx("td",{className:"px-3 py-2 font-mono text-xs",children:ce.sales_invoices?ce.sales_invoices.invoice_number:(de=ce.sales_orders)==null?void 0:de.so_number}),n.jsx("td",{className:"px-3 py-2 text-center",children:n.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${ce.sales_order_id?"bg-purple-100 text-purple-700":"bg-blue-100 text-blue-700"}`,children:ce.sales_order_id?"SO (Advance)":"Invoice"})}),n.jsxs("td",{className:"px-3 py-2 text-right font-medium",children:["Rp ",ce.allocated_amount.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]},_e)})})]})}):n.jsx("p",{className:"text-gray-500 text-sm",children:"No allocations"})]}),n.jsxs("div",{className:"flex justify-between pt-4",children:[n.jsxs("button",{onClick:L,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[n.jsx($l,{className:"w-4 h-4"}),"Print PDF"]}),n.jsx("button",{onClick:()=>{p(!1),y(null),_([])},className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700",children:"Close"})]})]})}),g&&n.jsxs("div",{ref:t,style:{position:"absolute",left:"-9999px",width:"210mm",padding:"15mm",backgroundColor:"#fff"},children:[n.jsxs("div",{style:{textAlign:"center",marginBottom:"20px",borderBottom:"2px solid #333",paddingBottom:"15px"},children:[n.jsx("h1",{style:{fontSize:"24px",fontWeight:"bold",margin:"0 0 5px 0",color:"#1a1a1a"},children:C||"Company Name"}),w&&n.jsx("p",{style:{fontSize:"11px",margin:"0",color:"#666"},children:w}),n.jsx("h2",{style:{fontSize:"18px",fontWeight:"bold",margin:"15px 0 0 0",color:"#2563eb"},children:"RECEIPT VOUCHER"})]}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"15px",marginBottom:"20px"},children:[n.jsxs("div",{children:[n.jsx("p",{style:{fontSize:"11px",fontWeight:"600",color:"#666",margin:"0 0 3px 0"},children:"Voucher No:"}),n.jsx("p",{style:{fontSize:"14px",fontWeight:"bold",margin:"0",fontFamily:"monospace"},children:g.voucher_number})]}),n.jsxs("div",{children:[n.jsx("p",{style:{fontSize:"11px",fontWeight:"600",color:"#666",margin:"0 0 3px 0"},children:"Date:"}),n.jsx("p",{style:{fontSize:"14px",fontWeight:"bold",margin:"0"},children:new Date(g.voucher_date).toLocaleDateString("id-ID",{day:"2-digit",month:"long",year:"numeric"})})]})]}),n.jsxs("div",{style:{marginBottom:"20px",padding:"12px",backgroundColor:"#f3f4f6",borderRadius:"6px"},children:[n.jsx("p",{style:{fontSize:"11px",fontWeight:"600",color:"#666",margin:"0 0 5px 0"},children:"Received From:"}),n.jsx("p",{style:{fontSize:"15px",fontWeight:"bold",margin:"0",color:"#1a1a1a"},children:(ne=g.customers)==null?void 0:ne.company_name})]}),n.jsxs("div",{style:{marginBottom:"20px",padding:"15px",backgroundColor:"#dbeafe",borderRadius:"8px",border:"2px solid #2563eb"},children:[n.jsx("p",{style:{fontSize:"11px",fontWeight:"600",color:"#1e40af",margin:"0 0 5px 0"},children:"Amount Received:"}),n.jsxs("p",{style:{fontSize:"24px",fontWeight:"bold",margin:"0",color:"#1e40af"},children:["Rp ",g.amount.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),n.jsx("div",{style:{marginBottom:"20px"},children:n.jsx("table",{style:{width:"100%",fontSize:"12px",borderCollapse:"collapse"},children:n.jsxs("tbody",{children:[n.jsxs("tr",{children:[n.jsx("td",{style:{padding:"8px 0",fontWeight:"600",color:"#666",width:"35%"},children:"Payment Method:"}),n.jsx("td",{style:{padding:"8px 0",textTransform:"capitalize"},children:g.payment_method.replace("_"," ")})]}),n.jsxs("tr",{children:[n.jsx("td",{style:{padding:"8px 0",fontWeight:"600",color:"#666"},children:"Bank Account:"}),n.jsx("td",{style:{padding:"8px 0"},children:((te=g.bank_accounts)==null?void 0:te.alias)||(g.bank_accounts?`${g.bank_accounts.bank_name} - ${g.bank_accounts.account_name}`:"-")})]}),g.reference_number&&n.jsxs("tr",{children:[n.jsx("td",{style:{padding:"8px 0",fontWeight:"600",color:"#666"},children:"Reference:"}),n.jsx("td",{style:{padding:"8px 0",fontFamily:"monospace"},children:g.reference_number})]})]})})}),v.length>0&&n.jsxs("div",{style:{marginBottom:"20px"},children:[n.jsx("p",{style:{fontSize:"13px",fontWeight:"bold",margin:"0 0 10px 0",color:"#1a1a1a"},children:"Allocation Details:"}),n.jsxs("table",{style:{width:"100%",fontSize:"11px",borderCollapse:"collapse",border:"1px solid #d1d5db"},children:[n.jsx("thead",{children:n.jsxs("tr",{style:{backgroundColor:"#f3f4f6"},children:[n.jsx("th",{style:{padding:"8px",textAlign:"left",borderBottom:"1px solid #d1d5db"},children:"Document"}),n.jsx("th",{style:{padding:"8px",textAlign:"center",borderBottom:"1px solid #d1d5db"},children:"Type"}),n.jsx("th",{style:{padding:"8px",textAlign:"right",borderBottom:"1px solid #d1d5db"},children:"Amount"})]})}),n.jsx("tbody",{children:v.map((ce,_e)=>{var de;return n.jsxs("tr",{children:[n.jsx("td",{style:{padding:"8px",borderBottom:_e<v.length-1?"1px solid #e5e7eb":"none",fontFamily:"monospace"},children:ce.sales_invoices?ce.sales_invoices.invoice_number:(de=ce.sales_orders)==null?void 0:de.so_number}),n.jsx("td",{style:{padding:"8px",textAlign:"center",borderBottom:_e<v.length-1?"1px solid #e5e7eb":"none"},children:ce.sales_order_id?"SO (Advance)":"Invoice"}),n.jsxs("td",{style:{padding:"8px",textAlign:"right",borderBottom:_e<v.length-1?"1px solid #e5e7eb":"none",fontWeight:"600"},children:["Rp ",ce.allocated_amount.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]},_e)})})]})]}),g.description&&n.jsxs("div",{style:{marginBottom:"20px"},children:[n.jsx("p",{style:{fontSize:"11px",fontWeight:"600",color:"#666",margin:"0 0 5px 0"},children:"Description:"}),n.jsx("p",{style:{fontSize:"12px",margin:"0",color:"#1a1a1a"},children:g.description})]}),n.jsxs("div",{style:{marginTop:"40px",display:"grid",gridTemplateColumns:"1fr 1fr",gap:"40px"},children:[n.jsxs("div",{style:{textAlign:"center"},children:[n.jsx("div",{style:{height:"60px"}}),n.jsx("div",{style:{borderTop:"1px solid #333",paddingTop:"5px"},children:n.jsx("p",{style:{fontSize:"11px",fontWeight:"600",margin:"0"},children:"Received By"})})]}),n.jsxs("div",{style:{textAlign:"center"},children:[n.jsx("div",{style:{height:"60px"}}),n.jsx("div",{style:{borderTop:"1px solid #333",paddingTop:"5px"},children:n.jsx("p",{style:{fontSize:"11px",fontWeight:"600",margin:"0"},children:"Approved By"})})]})]}),n.jsx("div",{style:{marginTop:"30px",textAlign:"center",paddingTop:"15px",borderTop:"1px solid #e5e7eb"},children:n.jsx("p",{style:{fontSize:"10px",color:"#999",margin:"0"},children:"This is a computer-generated document. No signature required."})})]})]})}function eAe({canManage:e}){Q.useRef(null);const[t,r]=Q.useState([]),[a,s]=Q.useState([]),[i,o]=Q.useState([]),[l,c]=Q.useState([]),[d,u]=Q.useState([]),[f,h]=Q.useState(!0),[A,x]=Q.useState(!1),[p,b]=Q.useState(!1),[m,g]=Q.useState(null),[y,v]=Q.useState([]),[_,j]=Q.useState(""),[N,B]=Q.useState([]),[E,C]=Q.useState(""),[k,w]=Q.useState(""),[T,R]=Q.useState({voucher_date:new Date().toISOString().split("T")[0],supplier_id:"",payment_method:"bank_transfer",bank_account_id:"",reference_number:"",amount:0,pph_code_id:"",pph_amount:0,description:""});Q.useEffect(()=>{q(),z(),ee(),Y()},[]),Q.useEffect(()=>{T.supplier_id?G(T.supplier_id):(c([]),B([]))},[T.supplier_id]),Q.useEffect(()=>{if(T.pph_code_id&&T.amount>0){const I=d.find(H=>H.id===T.pph_code_id);if(I){const H=T.amount*(I.rate/100);R(V=>({...V,pph_amount:Math.round(H)}))}}else R(I=>({...I,pph_amount:0}))},[T.pph_code_id,T.amount,d]);const q=async()=>{try{const{data:I,error:H}=await Z.from("payment_vouchers").select("*, suppliers(company_name), bank_accounts(account_name, bank_name)").order("voucher_date",{ascending:!1});if(H)throw H;r(I||[])}catch(I){console.error("Error loading vouchers:",I)}finally{h(!1)}},z=async()=>{const{data:I}=await Z.from("suppliers").select("id, company_name").order("company_name");s(I||[])},ee=async()=>{const{data:I}=await Z.from("bank_accounts").select("id, account_name, bank_name").eq("is_active",!0);o(I||[])},Y=async()=>{const{data:I}=await Z.from("tax_codes").select("id, code, name, rate").eq("is_withholding",!0);u(I||[])},G=async I=>{const{data:H}=await Z.from("purchase_invoices").select("id, invoice_number, invoice_date, total_amount, paid_amount, balance_amount").eq("supplier_id",I).gt("balance_amount",0).order("invoice_date");c(H||[]),B([])},re=async()=>{const I=new Date().getFullYear().toString().slice(-2),H=(new Date().getMonth()+1).toString().padStart(2,"0"),{count:V}=await Z.from("payment_vouchers").select("*",{count:"exact",head:!0}).like("voucher_number",`PV${I}${H}%`);return`PV${I}${H}-${String((V||0)+1).padStart(4,"0")}`},U=(I,H)=>{B(V=>V.find(M=>M.invoiceId===I)?H<=0?V.filter(M=>M.invoiceId!==I):V.map(M=>M.invoiceId===I?{...M,amount:H}:M):H>0?[...V,{invoiceId:I,amount:H}]:V)};N.reduce((I,H)=>I+H.amount,0);const S=T.amount-T.pph_amount,D=async I=>{I.preventDefault();try{const{data:{user:H}}=await Z.auth.getUser();if(!H)throw new Error("Not authenticated");const V=await re(),{data:W,error:M}=await Z.from("payment_vouchers").insert([{voucher_number:V,voucher_date:T.voucher_date,supplier_id:T.supplier_id,payment_method:T.payment_method,bank_account_id:T.bank_account_id||null,reference_number:T.reference_number||null,amount:T.amount,pph_amount:T.pph_amount,pph_code_id:T.pph_code_id||null,description:T.description||null,created_by:H.id}]).select().single();if(M)throw M;for(const se of N){await Z.from("voucher_allocations").insert({voucher_type:"payment",payment_voucher_id:W.id,purchase_invoice_id:se.invoiceId,allocated_amount:se.amount});const K=l.find(he=>he.id===se.invoiceId);if(K){const he=(K.paid_amount||0)+se.amount,ne=K.total_amount-he;await Z.from("purchase_invoices").update({paid_amount:he,status:ne<=0?"paid":"partial"}).eq("id",se.invoiceId)}}x(!1),L(),q()}catch(H){console.error("Error saving voucher:",H),alert("Failed to save: "+H.message)}},L=()=>{R({voucher_date:new Date().toISOString().split("T")[0],supplier_id:"",payment_method:"bank_transfer",bank_account_id:"",reference_number:"",amount:0,pph_code_id:"",pph_amount:0,description:""}),B([]),c([])},P=t.filter(I=>{var H,V;return I.voucher_number.toLowerCase().includes(_.toLowerCase())||((V=(H=I.suppliers)==null?void 0:H.company_name)==null?void 0:V.toLowerCase().includes(_.toLowerCase()))});return f?n.jsx("div",{className:"flex justify-center py-8",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"relative flex-1 max-w-md",children:[n.jsx(Ca,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),n.jsx("input",{type:"text",placeholder:"Search payments...",value:_,onChange:I=>j(I.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg"})]}),e&&n.jsxs("button",{onClick:()=>{L(),x(!0)},className:"flex items-center gap-2 bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700",children:[n.jsx(Xb,{className:"w-5 h-5"}),"New Payment"]})]}),n.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Voucher No"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Supplier"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Method"}),n.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Gross"}),n.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"PPh"}),n.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Net Paid"})]})}),n.jsxs("tbody",{className:"divide-y",children:[P.map(I=>{var H;return n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-4 py-3 font-mono text-sm",children:I.voucher_number}),n.jsx("td",{className:"px-4 py-3",children:new Date(I.voucher_date).toLocaleDateString("id-ID")}),n.jsx("td",{className:"px-4 py-3",children:(H=I.suppliers)==null?void 0:H.company_name}),n.jsx("td",{className:"px-4 py-3",children:n.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 rounded text-xs capitalize",children:I.payment_method.replace("_"," ")})}),n.jsxs("td",{className:"px-4 py-3 text-right",children:["Rp ",I.amount.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]}),n.jsx("td",{className:"px-4 py-3 text-right text-orange-600",children:I.pph_amount>0?`Rp ${I.pph_amount.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})}`:"-"}),n.jsxs("td",{className:"px-4 py-3 text-right font-medium text-red-600",children:["Rp ",I.net_amount.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]},I.id)}),P.length===0&&n.jsx("tr",{children:n.jsx("td",{colSpan:7,className:"px-4 py-8 text-center text-gray-500",children:"No payment vouchers found"})})]})]})}),n.jsx(Ot,{isOpen:A,onClose:()=>x(!1),title:"New Payment Voucher",children:n.jsxs("form",{onSubmit:D,className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date *"}),n.jsx("input",{type:"date",required:!0,value:T.voucher_date,onChange:I=>R({...T,voucher_date:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Supplier *"}),n.jsxs("select",{required:!0,value:T.supplier_id,onChange:I=>R({...T,supplier_id:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[n.jsx("option",{value:"",children:"Select supplier"}),a.map(I=>n.jsx("option",{value:I.id,children:I.company_name},I.id))]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Method *"}),n.jsxs("select",{required:!0,value:T.payment_method,onChange:I=>R({...T,payment_method:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[n.jsx("option",{value:"cash",children:"Cash"}),n.jsx("option",{value:"bank_transfer",children:"Bank Transfer"}),n.jsx("option",{value:"check",children:"Check"}),n.jsx("option",{value:"giro",children:"Giro"}),n.jsx("option",{value:"other",children:"Other"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gross Amount (Rp) *"}),n.jsx("input",{type:"number",required:!0,value:T.amount,onChange:I=>R({...T,amount:parseFloat(I.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]})]}),T.payment_method!=="cash"&&n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bank Account"}),n.jsxs("select",{value:T.bank_account_id,onChange:I=>R({...T,bank_account_id:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[n.jsx("option",{value:"",children:"Select account"}),i.map(I=>n.jsxs("option",{value:I.id,children:[I.bank_name," - ",I.account_name]},I.id))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reference No."}),n.jsx("input",{type:"text",value:T.reference_number,onChange:I=>R({...T,reference_number:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]})]}),n.jsxs("div",{className:"border-t pt-4",children:[n.jsx("h4",{className:"font-medium text-gray-700 mb-3",children:"PPh Withholding (Potong Pajak)"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"PPh Type"}),n.jsxs("select",{value:T.pph_code_id,onChange:I=>R({...T,pph_code_id:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[n.jsx("option",{value:"",children:"No withholding"}),d.map(I=>n.jsxs("option",{value:I.id,children:[I.code," - ",I.name," (",I.rate,"%)"]},I.id))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"PPh Amount"}),n.jsx("input",{type:"number",value:T.pph_amount,onChange:I=>R({...T,pph_amount:parseFloat(I.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-orange-50"})]})]}),n.jsxs("div",{className:"mt-2 p-3 bg-gray-50 rounded-lg",children:[n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{children:"Gross Amount:"}),n.jsxs("span",{children:["Rp ",T.amount.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),n.jsxs("div",{className:"flex justify-between text-sm text-orange-600",children:[n.jsx("span",{children:"Less: PPh Withholding:"}),n.jsxs("span",{children:["-Rp ",T.pph_amount.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),n.jsxs("div",{className:"flex justify-between font-medium text-lg border-t mt-2 pt-2",children:[n.jsx("span",{children:"Net Payment:"}),n.jsxs("span",{className:"text-red-600",children:["Rp ",S.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),n.jsx("textarea",{value:T.description,onChange:I=>R({...T,description:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",rows:2})]}),l.length>0&&n.jsxs("div",{className:"border-t pt-4",children:[n.jsx("h4",{className:"font-medium text-gray-700 mb-3",children:"Allocate to Purchase Invoices"}),n.jsx("div",{className:"max-h-48 overflow-y-auto border rounded-lg",children:n.jsxs("table",{className:"w-full text-sm",children:[n.jsx("thead",{className:"bg-gray-50 sticky top-0",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-3 py-2 text-left",children:"Invoice"}),n.jsx("th",{className:"px-3 py-2 text-right",children:"Balance"}),n.jsx("th",{className:"px-3 py-2 text-right",children:"Allocate"})]})}),n.jsx("tbody",{className:"divide-y",children:l.map(I=>{var H;return n.jsxs("tr",{children:[n.jsxs("td",{className:"px-3 py-2",children:[n.jsx("div",{className:"font-mono",children:I.invoice_number}),n.jsx("div",{className:"text-gray-500 text-xs",children:new Date(I.invoice_date).toLocaleDateString("id-ID")})]}),n.jsxs("td",{className:"px-3 py-2 text-right text-red-600",children:["Rp ",I.balance_amount.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]}),n.jsx("td",{className:"px-3 py-2",children:n.jsx("input",{type:"number",min:0,max:I.balance_amount,value:((H=N.find(V=>V.invoiceId===I.id))==null?void 0:H.amount)||"",onChange:V=>U(I.id,parseFloat(V.target.value)||0),className:"w-24 px-2 py-1 border rounded text-right",placeholder:"0"})})]},I.id)})})]})})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[n.jsx("button",{type:"button",onClick:()=>x(!1),className:"px-4 py-2 text-gray-700 border rounded-lg hover:bg-gray-50",children:"Cancel"}),n.jsx("button",{type:"submit",className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Save Payment"})]})]})})]})}const _s=[{value:"duty_customs",label:"Duty & Customs (BM)",type:"import",icon:_n,description:"Import duties and customs charges - CAPITALIZED to inventory",requiresContainer:!0,group:"Import Costs"},{value:"ppn_import",label:"PPN Import",type:"operations",icon:hn,description:"Import VAT - EXPENSED to P&L",requiresContainer:!1,group:"Operations"},{value:"pph_import",label:"PPh Import",type:"import",icon:_n,description:"Import withholding tax - CAPITALIZED to inventory",requiresContainer:!0,group:"Import Costs"},{value:"freight_import",label:"Freight (Import)",type:"import",icon:Rr,description:"International freight charges - CAPITALIZED to inventory",requiresContainer:!0,group:"Import Costs"},{value:"clearing_forwarding",label:"Clearing & Forwarding",type:"import",icon:_n,description:"Customs clearance - CAPITALIZED to inventory",requiresContainer:!0,group:"Import Costs"},{value:"port_charges",label:"Port Charges",type:"import",icon:_n,description:"Port handling charges - CAPITALIZED to inventory",requiresContainer:!0,group:"Import Costs"},{value:"container_handling",label:"Container Handling",type:"import",icon:Rr,description:"Container unloading - CAPITALIZED to inventory",requiresContainer:!0,group:"Import Costs"},{value:"transport_import",label:"Transportation (Import)",type:"import",icon:us,description:"Port to godown transport - CAPITALIZED to inventory",requiresContainer:!0,group:"Import Costs"},{value:"loading_import",label:"Loading / Unloading (Import)",type:"import",icon:us,description:"Import container loading/unloading - CAPITALIZED to inventory",requiresContainer:!0,group:"Import Costs"},{value:"bpom_ski_fees",label:"BPOM / SKI Fees",type:"import",icon:Zt,description:"BPOM/SKI regulatory fees - CAPITALIZED to inventory",requiresContainer:!0,group:"Import Costs"},{value:"other_import",label:"Other (Import)",type:"import",icon:hn,description:"Other import-related expenses - CAPITALIZED to inventory",requiresContainer:!0,group:"Import Costs"},{value:"delivery_sales",label:"Delivery / Dispatch (Sales)",type:"sales",icon:us,description:"Customer delivery - EXPENSED to P&L",requiresContainer:!1,group:"Sales & Distribution"},{value:"loading_sales",label:"Loading / Unloading (Sales)",type:"sales",icon:us,description:"Sales loading charges - EXPENSED to P&L",requiresContainer:!1,group:"Sales & Distribution"},{value:"other_sales",label:"Other (Sales)",type:"sales",icon:hn,description:"Other sales-related expenses - EXPENSED to P&L",requiresContainer:!1,group:"Sales & Distribution"},{value:"salary",label:"Salary",type:"staff",icon:hn,description:"Staff salaries - EXPENSED to P&L",requiresContainer:!1,group:"Staff Costs"},{value:"staff_overtime",label:"Staff Overtime",type:"staff",icon:hn,description:"Overtime payments - EXPENSED to P&L",requiresContainer:!1,group:"Staff Costs"},{value:"staff_welfare",label:"Staff Welfare / Allowances",type:"staff",icon:hn,description:"Driver food, snacks, overtime meals, welfare - EXPENSED to P&L",requiresContainer:!1,group:"Staff Costs"},{value:"travel_conveyance",label:"Travel & Conveyance",type:"staff",icon:us,description:"Local travel, taxi, fuel reimbursements, tolls - EXPENSED to P&L",requiresContainer:!1,group:"Staff Costs"},{value:"warehouse_rent",label:"Warehouse Rent",type:"operations",icon:_n,description:"Rent expense - EXPENSED to P&L",requiresContainer:!1,group:"Operations"},{value:"utilities",label:"Utilities",type:"operations",icon:_n,description:"Electricity, water, etc - EXPENSED to P&L",requiresContainer:!1,group:"Operations"},{value:"bank_charges",label:"Bank Charges",type:"operations",icon:hn,description:"Bank fees, charges, and transaction costs - EXPENSED to P&L",requiresContainer:!1,group:"Operations"},{value:"office_admin",label:"Office & Admin",type:"admin",icon:_n,description:"General admin expenses - EXPENSED to P&L",requiresContainer:!1,group:"Administrative"},{value:"office_shifting_renovation",label:"Office Shifting & Renovation",type:"admin",icon:_n,description:"Office shifting, partition work, electrical, cabling, interior renovation - EXPENSED to P&L",requiresContainer:!1,group:"Administrative"},{value:"other",label:"Other",type:"admin",icon:hn,description:"Miscellaneous expenses - EXPENSED to P&L",requiresContainer:!1,group:"Administrative"}];function tAe({canManage:e}){var Be,Fe;const[t,r]=Q.useState([]),[a,s]=Q.useState([]),[i,o]=Q.useState([]),[l,c]=Q.useState([]),[d,u]=Q.useState([]),[f,h]=Q.useState(new Set),[A,x]=Q.useState([]),[p,b]=Q.useState(""),[m,g]=Q.useState(!0),[y,v]=Q.useState(!1),[_,j]=Q.useState(null),[N,B]=Q.useState(null),[E,C]=Q.useState(!1),[k,w]=Q.useState("all"),[T,R]=Q.useState("all"),[q,z]=Q.useState("all"),[ee,Y]=Q.useState([]),[G,re]=Q.useState(!1),[U,S]=Q.useState(null),{dateRange:D}=rl(),L=D.startDate,P=D.endDate,[I,H]=Q.useState({expense_category:"other",amount:0,expense_date:new Date().toISOString().split("T")[0],description:"",batch_id:"",import_container_id:"",delivery_challan_id:"",payment_method:"bank_transfer",bank_account_id:"",payment_reference:"",document_urls:[]});Q.useEffect(()=>{V();const oe=Z.channel("expense-changes").on("postgres_changes",{event:"*",schema:"public",table:"finance_expenses"},()=>{V()}).subscribe(),ke=Z.channel("bank-statement-changes").on("postgres_changes",{event:"*",schema:"public",table:"bank_statement_lines"},()=>{V()}).subscribe();return()=>{oe.unsubscribe(),ke.unsubscribe()}},[D]),Q.useEffect(()=>{const oe=ke=>{var $e;if(!y)return;const Ue=($e=ke.clipboardData)==null?void 0:$e.items;if(!Ue)return;const qe=[];for(let Ne=0;Ne<Ue.length;Ne++){const Ee=Ue[Ne];if(Ee.type.indexOf("image")!==-1){ke.preventDefault();const ze=Ee.getAsFile();if(ze){const rt=`pasted-image-${Date.now()}.png`,nt=new File([ze],rt,{type:ze.type});qe.push(nt)}}}qe.length>0&&(Y([...ee,...qe]),re(!0),setTimeout(()=>re(!1),2e3))};return document.addEventListener("paste",oe),()=>document.removeEventListener("paste",oe)},[y,ee]);const V=async()=>{try{g(!0);const[oe,ke,Ue,qe,$e,Ne]=await Promise.all([Z.from("finance_expenses").select(`
            *,
            batches(batch_number),
            import_containers(container_ref),
            delivery_challans(challan_number),
            bank_accounts(bank_name, account_number, alias, currency),
            bank_statement_lines(
              id,
              transaction_date,
              description,
              debit_amount,
              credit_amount,
              bank_account_id,
              bank_accounts(bank_name, account_number, alias, currency)
            )
          `).order("expense_date",{ascending:!1}).order("created_at",{ascending:!1}),Z.from("batches").select("id, batch_number").order("batch_number"),Z.from("import_containers").select("id, container_ref").order("container_ref"),Z.from("delivery_challans").select("id, challan_number, challan_date, customers(company_name)").order("challan_number",{ascending:!1}).limit(50),Z.from("bank_accounts").select("id, bank_name, account_number, alias, currency").order("bank_name"),Z.from("bank_statement_lines").select("matched_expense_id").not("matched_expense_id","is",null)]);if(oe.error)throw oe.error;r(oe.data||[]),s(ke.data||[]),o(Ue.data||[]),c(qe.data||[]),u($e.data||[]);const Ee=new Set;Ne.data&&Ne.data.forEach(ze=>{ze.matched_expense_id&&Ee.add(ze.matched_expense_id)}),h(Ee)}catch(oe){console.error("Error loading data:",oe.message),alert("Failed to load expenses")}finally{g(!1)}},W=async(oe,ke)=>{try{let Ue=Z.from("bank_statement_lines").select(`
          id,
          transaction_date,
          description,
          debit_amount,
          credit_amount,
          bank_account_id,
          bank_accounts(bank_name, account_number, alias, currency)
        `).or(`matched_expense_id.is.null,matched_expense_id.eq.${ke||"NULL"}`).is("matched_receipt_id",null).is("matched_petty_cash_id",null).is("matched_entry_id",null).is("matched_fund_transfer_id",null).order("transaction_date",{ascending:!1});oe&&(Ue=Ue.eq("bank_account_id",oe));const{data:qe,error:$e}=await Ue;if($e)throw $e;const Ne=(qe||[]).filter(Ee=>Ee.debit_amount&&Ee.debit_amount>0);x(Ne)}catch(Ue){console.error("Error loading unlinked transactions:",Ue)}},M=async oe=>{oe.preventDefault(),console.log("=== EXPENSE FORM SUBMIT ==="),console.log("Editing:",!!_),console.log("Files to upload:",ee.length),console.log("Existing URLs:",I.document_urls);try{const ke=_s.find(Ne=>Ne.value===I.expense_category),Ue=[];if(ee.length>0){console.log("=== UPLOADING",ee.length,"FILES ===");for(const Ne of ee){console.log("Uploading file:",Ne.name,"(",Ne.size,"bytes)");const Ee=`${Date.now()}_${Ne.name.replace(/[^a-zA-Z0-9.-]/g,"_")}`,ze=`${I.expense_category}/${Ee}`;console.log("Storage path:",ze);const{data:rt,error:nt}=await Z.storage.from("expense-documents").upload(ze,Ne,{cacheControl:"3600",upsert:!1});if(nt)throw console.error("Upload error:",nt),new Error(`Failed to upload ${Ne.name}: ${nt.message}`);console.log("Upload successful:",rt);const{data:{publicUrl:mt}}=Z.storage.from("expense-documents").getPublicUrl(ze);console.log("Public URL:",mt),Ue.push(mt)}console.log("All uploads complete. Uploaded URLs:",Ue)}else console.log("No new files to upload");const qe=[...I.document_urls,...Ue];console.log("Combined document URLs:",qe);const $e={expense_category:I.expense_category,expense_type:(ke==null?void 0:ke.type)||"admin",amount:I.amount,expense_date:I.expense_date,description:I.description||null,batch_id:I.batch_id||null,import_container_id:I.import_container_id||null,delivery_challan_id:I.delivery_challan_id||null,payment_method:I.payment_method,bank_account_id:I.bank_account_id||null,payment_reference:I.payment_reference||null,paid_by:"bank",document_urls:qe.length>0?qe:null};if(console.log("=== EXPENSE DATA TO SAVE ==="),console.log("document_urls:",$e.document_urls),console.log("Full expense data:",$e),_){console.log("=== UPDATING EXPENSE ==="),console.log("Expense ID:",_.id);const{error:Ne}=await Z.from("finance_expenses").update($e).eq("id",_.id);if(Ne)throw console.error("Update error:",Ne),Ne;console.log("Update successful! Fetching updated data...");const{data:Ee,error:ze}=await Z.from("finance_expenses").select(`
            *,
            batches (batch_number),
            import_containers (container_ref),
            delivery_challans (challan_number),
            bank_accounts (bank_name, account_number),
            bank_statement_lines (
              id,
              transaction_date,
              description,
              debit_amount,
              credit_amount,
              bank_account_id,
              bank_accounts (bank_name, account_number)
            )
          `).eq("id",_.id).single();if(ze)throw console.error("Fetch error:",ze),ze;if(console.log("=== FETCHED UPDATED EXPENSE ==="),console.log("document_urls from DB:",Ee.document_urls),console.log("Full updated expense:",Ee),r(rt=>rt.map(nt=>nt.id===_.id?Ee:nt)),p){const{data:{user:rt}}=await Z.auth.getUser(),{error:nt}=await Z.from("bank_statement_lines").update({matched_expense_id:_.id,reconciliation_status:"matched",matched_at:new Date().toISOString(),matched_by:rt==null?void 0:rt.id}).eq("id",p);if(nt)console.error("Error linking to bank transaction:",nt),alert("Expense updated but failed to link to bank transaction. Please link manually from Bank Reconciliation.");else{const{data:mt,error:gt}=await Z.from("finance_expenses").select(`
                *,
                batches (batch_number),
                import_containers (container_ref),
                delivery_challans (challan_number),
                bank_accounts (bank_name, account_number),
                bank_statement_lines (
                  id,
                  transaction_date,
                  description,
                  debit_amount,
                  credit_amount,
                  bank_account_id,
                  bank_accounts (bank_name, account_number)
                )
              `).eq("id",_.id).single();!gt&&mt&&(r(Nt=>Nt.map(yt=>yt.id===_.id?mt:yt)),x(Nt=>Nt.filter(yt=>yt.id!==p)),h(Nt=>new Set(Nt).add(_.id)))}}alert("Expense updated successfully")}else{const{data:{user:Ne}}=await Z.auth.getUser();if(!Ne)throw new Error("Not authenticated");console.log("=== CREATING NEW EXPENSE ===");const{data:Ee,error:ze}=await Z.from("finance_expenses").insert([{...$e,created_by:Ne.id}]).select(`
            *,
            batches (batch_number),
            import_containers (container_ref),
            delivery_challans (challan_number),
            bank_accounts (bank_name, account_number),
            bank_statement_lines (
              id,
              transaction_date,
              description,
              debit_amount,
              credit_amount,
              bank_account_id,
              bank_accounts (bank_name, account_number)
            )
          `).single();if(ze)throw console.error("Insert error:",ze),ze;console.log("=== NEW EXPENSE CREATED ==="),console.log("document_urls from DB:",Ee==null?void 0:Ee.document_urls),console.log("Full new expense:",Ee);let rt=Ee;if(p&&Ee){const{error:nt}=await Z.from("bank_statement_lines").update({matched_expense_id:Ee.id,reconciliation_status:"matched",matched_at:new Date().toISOString(),matched_by:Ne.id}).eq("id",p);if(nt)console.error("Error linking to bank transaction:",nt),alert("Expense created but failed to link to bank transaction. Please link manually from Bank Reconciliation.");else{const{data:mt,error:gt}=await Z.from("finance_expenses").select(`
                *,
                batches (batch_number),
                import_containers (container_ref),
                delivery_challans (challan_number),
                bank_accounts (bank_name, account_number),
                bank_statement_lines (
                  id,
                  transaction_date,
                  description,
                  debit_amount,
                  credit_amount,
                  bank_account_id,
                  bank_accounts (bank_name, account_number)
                )
              `).eq("id",Ee.id).single();!gt&&mt&&(rt=mt,x(Nt=>Nt.filter(yt=>yt.id!==p)),h(Nt=>new Set(Nt).add(Ee.id)))}}r(nt=>[rt,...nt]),alert("Expense recorded successfully")}v(!1),ce()}catch(ke){console.error("Error saving expense:",ke.message);const Ue=ke.message||"Unknown error occurred";Ue.includes("Import expenses must be linked")?alert(` Context Required

Import expenses must be linked to an Import Container.
Please select a container before saving.`):alert(`Failed to save expense:

`+Ue)}},se=async oe=>{j(oe);const ke=oe.bank_statement_lines&&oe.bank_statement_lines.length>0?oe.bank_statement_lines[0]:null,Ue=(ke==null?void 0:ke.bank_account_id)||oe.bank_account_id||"",qe=ke!=null&&ke.bank_account_id?"bank_transfer":oe.payment_method||"bank_transfer";H({expense_category:oe.expense_category,amount:oe.amount,expense_date:oe.expense_date,description:oe.description||"",batch_id:oe.batch_id||"",import_container_id:oe.import_container_id||"",delivery_challan_id:oe.delivery_challan_id||"",payment_method:qe,bank_account_id:Ue,payment_reference:oe.payment_reference||"",document_urls:oe.document_urls||[]}),b((ke==null?void 0:ke.id)||""),Ue&&await W(Ue,oe.id),v(!0)},K=async oe=>{if(confirm("Are you sure you want to delete this expense?"))try{const{error:ke}=await Z.from("finance_expenses").delete().eq("id",oe);if(ke)throw ke;r(Ue=>Ue.filter(qe=>qe.id!==oe)),alert("Expense deleted successfully")}catch(ke){console.error("Error deleting expense:",ke.message),alert("Failed to delete expense: "+ke.message)}},he=async oe=>{if(confirm(`Are you sure you want to unlink this expense from the bank statement?

The bank statement line will be set back to "Unmatched" status.`))try{const{error:ke}=await Z.from("bank_statement_lines").update({expense_id:null,status:"unmatched",matched_date:null}).eq("expense_id",oe);if(ke)throw ke;const{data:Ue,error:qe}=await Z.from("finance_expenses").select(`
          *,
          batches (batch_number),
          import_containers (container_ref),
          delivery_challans (challan_number),
          bank_accounts (bank_name, account_number),
          bank_statement_lines (
            id,
            transaction_date,
            description,
            debit_amount,
            credit_amount,
            bank_account_id,
            bank_accounts (bank_name, account_number)
          )
        `).eq("id",oe).single();if(qe)throw qe;r($e=>$e.map(Ne=>Ne.id===oe?Ue:Ne)),alert("Expense unlinked from bank statement successfully"),v(!1),j(null),ce()}catch(ke){console.error("Error unlinking expense:",ke.message),alert("Failed to unlink expense: "+ke.message)}},ne=oe=>{H({...I,document_urls:I.document_urls.filter(ke=>ke!==oe)})},te=oe=>{Y(ee.filter((ke,Ue)=>Ue!==oe))},ce=()=>{j(null),Y([]),H({expense_category:"other",amount:0,expense_date:new Date().toISOString().split("T")[0],description:"",batch_id:"",import_container_id:"",delivery_challan_id:"",payment_method:"bank_transfer",bank_account_id:"",payment_reference:"",document_urls:[]})},_e=_s.find(oe=>oe.value===I.expense_category),de=(_e==null?void 0:_e.type)==="import",ye=(_e==null?void 0:_e.type)==="sales",Le=t.filter(oe=>{if(k!=="all"){const ke=_s.find(Ue=>Ue.value===oe.expense_category);if((ke==null?void 0:ke.type)!==k)return!1}if(q!=="all"&&oe.expense_category!==q)return!1;if(T==="reconciled"){if(!f.has(oe.id))return!1}else if(T==="not_reconciled"&&f.has(oe.id))return!1;return!(L&&oe.expense_date<L||P&&oe.expense_date>P)}),we=oe=>{let ke="asc";U&&U.key===oe&&U.direction==="asc"&&(ke="desc"),S({key:oe,direction:ke})},ge=[...Le].sort((oe,ke)=>{var Ee,ze;if(!U)return 0;const{key:Ue,direction:qe}=U;let $e,Ne;if(Ue==="date")$e=new Date(oe.expense_date).getTime(),Ne=new Date(ke.expense_date).getTime();else if(Ue==="category"){const rt=_s.find(mt=>mt.value===oe.expense_category),nt=_s.find(mt=>mt.value===ke.expense_category);$e=((Ee=rt==null?void 0:rt.label)==null?void 0:Ee.toLowerCase())||"",Ne=((ze=nt==null?void 0:nt.label)==null?void 0:ze.toLowerCase())||""}else if(Ue==="amount")$e=Number(oe.amount)||0,Ne=Number(ke.amount)||0;else if(Ue==="description")$e=(oe.description||"").toLowerCase(),Ne=(ke.description||"").toLowerCase();else if(Ue==="payment_method")$e=(oe.payment_method||"unknown").toLowerCase(),Ne=(ke.payment_method||"unknown").toLowerCase();else if(Ue==="reconciliation"){const rt=oe.bank_statement_lines&&oe.bank_statement_lines.length>0,nt=ke.bank_statement_lines&&ke.bank_statement_lines.length>0;$e=rt?1:0,Ne=nt?1:0}else $e=oe[Ue],Ne=ke[Ue],typeof $e=="string"&&($e=$e.toLowerCase()),typeof Ne=="string"&&(Ne=Ne.toLowerCase());return $e<Ne?qe==="asc"?-1:1:$e>Ne?qe==="asc"?1:-1:0}),Re=()=>{if(Le.length===0){alert("No expenses to export");return}const oe=["Date","Category","Description","Amount"],ke=Le.map(Ee=>{const ze=_s.find(rt=>rt.value===Ee.expense_category);return[Ee.expense_date,(ze==null?void 0:ze.label)||Ee.expense_category,Ee.description||"",Ee.amount.toString()]}),Ue=[oe.join(","),...ke.map(Ee=>Ee.map(ze=>`"${ze}"`).join(","))].join(`
`),qe=new Blob([Ue],{type:"text/csv;charset=utf-8;"}),$e=document.createElement("a"),Ne=URL.createObjectURL(qe);$e.setAttribute("href",Ne),$e.setAttribute("download",`expenses_${L||"all"}_to_${P||"all"}.csv`),$e.style.visibility="hidden",document.body.appendChild($e),$e.click(),document.body.removeChild($e)},et=oe=>{switch(oe){case"import":return"bg-blue-100 text-blue-800 border-blue-300";case"sales":return"bg-green-100 text-green-800 border-green-300";case"staff":return"bg-purple-100 text-purple-800 border-purple-300";case"operations":return"bg-orange-100 text-orange-800 border-orange-300";case"admin":return"bg-gray-100 text-gray-800 border-gray-300";default:return"bg-gray-100 text-gray-800 border-gray-300"}},Ye=oe=>{const ke=new Date(oe),Ue=String(ke.getDate()).padStart(2,"0"),qe=String(ke.getMonth()+1).padStart(2,"0"),$e=ke.getFullYear();return`${Ue}/${qe}/${$e}`};return n.jsxs("div",{className:"space-y-4",children:[n.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 rounded-lg p-2.5 text-white shadow-md",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("h2",{className:"text-sm font-bold",children:"Expense Tracker"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("div",{className:"bg-white/20 rounded px-2.5 py-1",children:[n.jsx("div",{className:"text-blue-100 text-[9px] leading-tight",children:"Total"}),n.jsxs("div",{className:"text-xs font-bold",children:["Rp ",Le.reduce((oe,ke)=>oe+ke.amount,0).toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]})]}),n.jsxs("div",{className:"bg-white/20 rounded px-2.5 py-1",children:[n.jsx("div",{className:"text-blue-100 text-[9px] leading-tight",children:"Reconciled"}),n.jsxs("div",{className:"text-xs font-bold",children:[t.filter(oe=>f.has(oe.id)).length," / ",t.length]})]})]})]}),e&&n.jsxs("button",{onClick:()=>{ce(),v(!0)},className:"flex items-center gap-1.5 px-2.5 py-1.5 bg-white text-blue-600 rounded hover:bg-blue-50 font-medium transition-all shadow-sm text-xs",children:[n.jsx(Pr,{className:"w-3.5 h-3.5"}),"New"]})]})}),n.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-2",children:n.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[n.jsx("div",{className:"flex gap-1",children:[{value:"all",label:"All",icon:""},{value:"import",label:"Import",icon:""},{value:"sales",label:"Sales",icon:""},{value:"staff",label:"Staff",icon:""},{value:"operations",label:"Ops",icon:""},{value:"admin",label:"Admin",icon:""}].map(oe=>n.jsxs("button",{onClick:()=>w(oe.value),className:`px-3 py-1.5 rounded-md text-xs font-medium transition-all ${k===oe.value?"bg-blue-600 text-white shadow-sm":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[oe.icon," ",oe.label]},oe.value))}),n.jsx("div",{className:"h-6 w-px bg-gray-300"}),n.jsx("div",{className:"flex gap-1",children:[{value:"all",label:"All"},{value:"reconciled",label:" Linked"},{value:"not_reconciled",label:" Unlinked"}].map(oe=>n.jsx("button",{onClick:()=>R(oe.value),className:`px-3 py-1.5 rounded-md text-xs font-medium transition-all ${T===oe.value?"bg-green-600 text-white shadow-sm":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:oe.label},oe.value))}),n.jsxs("select",{value:q,onChange:oe=>z(oe.target.value),className:"px-2 py-1 border border-gray-300 rounded-md text-xs",children:[n.jsx("option",{value:"all",children:"All Categories"}),_s.sort((oe,ke)=>{const Ue={"Import Costs":1,"Sales & Distribution":2,"Staff Costs":3,Operations:4,Administrative:5},qe=Ue[oe.group]||999,$e=Ue[ke.group]||999;return qe!==$e?qe-$e:oe.label.localeCompare(ke.label)}).map(oe=>n.jsx("option",{value:oe.value,children:oe.label},oe.value))]}),n.jsxs("button",{onClick:Re,disabled:Le.length===0,className:"ml-auto px-3 py-1.5 bg-green-600 text-white rounded-md text-xs hover:bg-green-700 disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center gap-1.5 font-medium",children:[n.jsx(Zn,{className:"w-3.5 h-3.5"}),"Export (",Le.length,")"]})]})}),n.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-x-auto",children:n.jsxs("table",{className:"min-w-full",children:[n.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:n.jsxs("tr",{children:[n.jsx("th",{onClick:()=>we("date"),className:"px-4 py-2.5 text-left text-xs font-semibold text-gray-600 cursor-pointer hover:bg-gray-100 select-none",children:n.jsxs("div",{className:"flex items-center gap-1",children:["Date",(U==null?void 0:U.key)==="date"&&n.jsx("span",{className:"text-blue-600 text-sm",children:U.direction==="asc"?"":""})]})}),n.jsx("th",{onClick:()=>we("category"),className:"px-4 py-2.5 text-left text-xs font-semibold text-gray-600 cursor-pointer hover:bg-gray-100 select-none",children:n.jsxs("div",{className:"flex items-center gap-1",children:["Category",(U==null?void 0:U.key)==="category"&&n.jsx("span",{className:"text-blue-600 text-sm",children:U.direction==="asc"?"":""})]})}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-semibold text-gray-600",children:"Context"}),n.jsx("th",{onClick:()=>we("description"),className:"px-4 py-2.5 text-left text-xs font-semibold text-gray-600 cursor-pointer hover:bg-gray-100 select-none",children:n.jsxs("div",{className:"flex items-center gap-1",children:["Description",(U==null?void 0:U.key)==="description"&&n.jsx("span",{className:"text-blue-600 text-sm",children:U.direction==="asc"?"":""})]})}),n.jsx("th",{onClick:()=>we("amount"),className:"px-4 py-2.5 text-right text-xs font-semibold text-gray-600 cursor-pointer hover:bg-gray-100 select-none",children:n.jsxs("div",{className:"flex items-center justify-end gap-1",children:["Amount",(U==null?void 0:U.key)==="amount"&&n.jsx("span",{className:"text-blue-600 text-sm",children:U.direction==="asc"?"":""})]})}),n.jsx("th",{onClick:()=>we("payment_method"),className:"px-4 py-2.5 text-center text-xs font-semibold text-gray-600 cursor-pointer hover:bg-gray-100 transition-colors",children:n.jsxs("div",{className:"flex items-center justify-center gap-1",children:["Payment",(U==null?void 0:U.key)==="payment_method"&&n.jsx("span",{className:"text-blue-600 text-sm",children:U.direction==="asc"?"":""})]})}),n.jsx("th",{className:"px-4 py-2.5 text-center text-xs font-semibold text-gray-600",children:"Type"}),n.jsx("th",{onClick:()=>we("reconciliation"),className:"px-4 py-2.5 text-center text-xs font-semibold text-gray-600 cursor-pointer hover:bg-gray-100 transition-colors",children:n.jsxs("div",{className:"flex items-center justify-center gap-1",children:["Status",(U==null?void 0:U.key)==="reconciliation"&&n.jsx("span",{className:"text-blue-600 text-sm",children:U.direction==="asc"?"":""})]})}),e&&n.jsx("th",{className:"px-4 py-2.5 text-center text-xs font-semibold text-gray-600",children:"Actions"})]})}),n.jsxs("tbody",{className:"divide-y divide-gray-100",children:[m?n.jsx("tr",{children:n.jsx("td",{colSpan:e?9:8,className:"px-6 py-8 text-center text-gray-500",children:"Loading..."})}):Le.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:e?9:8,className:"px-6 py-8 text-center text-gray-500",children:"No expenses found"})}):ge.map(oe=>{var $e;const ke=_s.find(Ne=>Ne.value===oe.expense_category),Ue=oe.bank_statement_lines&&oe.bank_statement_lines.length>0,qe=Ue?oe.bank_statement_lines[0].bank_accounts:null;return n.jsxs("tr",{className:"hover:bg-blue-50/50 transition-colors",children:[n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap",children:n.jsx("div",{className:"text-xs text-gray-900 font-medium",children:Ye(oe.expense_date)})}),n.jsx("td",{className:"px-4 py-2.5",children:n.jsx("div",{className:"text-xs font-medium text-gray-900",children:(ke==null?void 0:ke.label)||oe.expense_category})}),n.jsx("td",{className:"px-4 py-2.5",children:oe.import_container_id&&oe.import_containers?n.jsxs("div",{className:"flex items-center gap-1.5 text-xs",children:[n.jsx(Rr,{className:"w-3.5 h-3.5 text-blue-600 flex-shrink-0"}),n.jsx("span",{className:"text-blue-700 font-medium",children:oe.import_containers.container_ref})]}):oe.delivery_challan_id&&oe.delivery_challans?n.jsxs("div",{className:"flex items-center gap-1.5 text-xs",children:[n.jsx(us,{className:"w-3.5 h-3.5 text-green-600 flex-shrink-0"}),n.jsx("span",{className:"text-green-700 font-medium",children:oe.delivery_challans.challan_number})]}):ke!=null&&ke.requiresContainer?n.jsx("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 text-[10px] font-medium text-red-700 bg-red-50 border border-red-200 rounded",children:" Missing"}):n.jsx("span",{className:"text-gray-400 text-xs",children:""})}),n.jsx("td",{className:"px-4 py-2.5",children:n.jsx("div",{className:"text-xs text-gray-700 line-clamp-1",children:oe.description||""})}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-right",children:n.jsxs("div",{className:"text-xs font-semibold text-gray-900",children:[(($e=oe.bank_accounts)==null?void 0:$e.currency)==="USD"?"$":"Rp"," ",oe.amount.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]})}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-center",children:Ue&&qe?n.jsx("div",{className:"text-xs",children:n.jsx("div",{className:"font-medium text-blue-700",children:qe.alias||qe.bank_name})}):oe.bank_account_id&&oe.bank_accounts?n.jsx("div",{className:"text-xs",children:n.jsx("div",{className:"font-medium text-gray-700",children:oe.bank_accounts.alias||oe.bank_accounts.bank_name})}):n.jsx("span",{className:"text-xs text-gray-600",children:oe.payment_method?oe.payment_method.replace("_"," "):""})}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-center",children:n.jsxs("span",{className:`inline-flex px-1.5 py-0.5 text-[10px] font-bold rounded ${et((ke==null?void 0:ke.type)||"admin")}`,children:[(ke==null?void 0:ke.type)==="import"&&"CAP",(ke==null?void 0:ke.type)==="sales"&&"EXP",(ke==null?void 0:ke.type)==="staff"&&"EXP",(ke==null?void 0:ke.type)==="operations"&&"EXP",(ke==null?void 0:ke.type)==="admin"&&"EXP"]})}),n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-center",children:Ue?n.jsx("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 text-[10px] font-bold text-green-700 bg-green-50 border border-green-300 rounded",children:" LINKED"}):n.jsx("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 text-[10px] font-bold text-orange-700 bg-orange-50 border border-orange-300 rounded",children:" UNLINKED"})}),e&&n.jsx("td",{className:"px-4 py-2.5 whitespace-nowrap text-center",children:n.jsxs("div",{className:"flex items-center justify-center gap-1.5",children:[n.jsx("button",{onClick:()=>{B(oe),C(!0)},className:"p-1 text-blue-600 hover:bg-blue-50 rounded transition-colors",title:"View",children:n.jsx(bi,{className:"w-3.5 h-3.5"})}),n.jsx("button",{onClick:()=>se(oe),className:"p-1 text-green-600 hover:bg-green-50 rounded transition-colors",title:"Edit",children:n.jsx(g7,{className:"w-3.5 h-3.5"})}),n.jsx("button",{onClick:()=>K(oe.id),className:"p-1 text-red-600 hover:bg-red-50 rounded transition-colors",title:"Delete",children:n.jsx(Lr,{className:"w-3.5 h-3.5"})})]})})]},oe.id)}),!m&&ge.length>0&&n.jsxs("tr",{className:"bg-gradient-to-r from-blue-50 to-blue-100 border-t-2 border-blue-200 font-bold",children:[n.jsxs("td",{colSpan:4,className:"px-4 py-2.5 text-right text-xs text-gray-900",children:["TOTAL (",ge.length," expenses):"]}),n.jsxs("td",{className:"px-4 py-2.5 text-right text-sm text-blue-900 font-bold",children:["Rp ",ge.reduce((oe,ke)=>oe+ke.amount,0).toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]}),n.jsx("td",{colSpan:e?4:3})]})]})]})}),y&&n.jsx(Ot,{isOpen:y,onClose:()=>{v(!1),ce()},title:_?"Edit Expense":"Record New Expense",maxWidth:"max-w-2xl",children:n.jsxs("form",{onSubmit:M,className:"space-y-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Expense Category ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("select",{value:I.expense_category,onChange:oe=>{const ke=oe.target.value,Ue=_s.find(qe=>qe.value===ke);H({...I,expense_category:ke,import_container_id:(Ue==null?void 0:Ue.type)==="import"?I.import_container_id:"",delivery_challan_id:(Ue==null?void 0:Ue.type)==="sales"?I.delivery_challan_id:""})},className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",required:!0,children:[n.jsx("option",{value:"",children:"Select Category"}),n.jsx("optgroup",{label:" IMPORT COSTS (Capitalized to Inventory) ",children:_s.filter(oe=>oe.group==="Import Costs").map(oe=>n.jsxs("option",{value:oe.value,children:[oe.label," [Requires Container]"]},oe.value))}),n.jsx("optgroup",{label:" SALES & DISTRIBUTION (P&L Expense) ",children:_s.filter(oe=>oe.group==="Sales & Distribution").map(oe=>n.jsx("option",{value:oe.value,children:oe.label},oe.value))}),n.jsx("optgroup",{label:" STAFF COSTS (P&L Expense) ",children:_s.filter(oe=>oe.group==="Staff Costs").map(oe=>n.jsx("option",{value:oe.value,children:oe.label},oe.value))}),n.jsx("optgroup",{label:" OPERATIONS (P&L Expense) ",children:_s.filter(oe=>oe.group==="Operations").map(oe=>n.jsx("option",{value:oe.value,children:oe.label},oe.value))}),n.jsx("optgroup",{label:" ADMINISTRATIVE (P&L Expense) ",children:_s.filter(oe=>oe.group==="Administrative").map(oe=>n.jsx("option",{value:oe.value,children:oe.label},oe.value))})]}),_e&&n.jsxs("div",{className:`mt-2 p-3 rounded-lg border ${et(_e.type)}`,children:[n.jsx("p",{className:"text-sm font-medium",children:_e.description}),_e.requiresContainer&&n.jsx("p",{className:"text-xs font-semibold text-red-600 mt-1",children:" Must be linked to Import Container"})]})]}),de&&n.jsxs("div",{className:"bg-blue-50 border-2 border-blue-300 rounded-lg p-4",children:[n.jsxs("label",{className:"block text-sm font-medium text-blue-900 mb-2",children:[n.jsx(Rr,{className:"w-4 h-4 inline mr-1"}),"Import Container ",n.jsx("span",{className:"text-red-500",children:"* REQUIRED"})]}),n.jsxs("select",{value:I.import_container_id,onChange:oe=>H({...I,import_container_id:oe.target.value}),className:"w-full px-3 py-2 border border-blue-300 rounded-lg bg-white",required:de,children:[n.jsx("option",{value:"",children:"Select Container (Required)"}),i.map(oe=>n.jsx("option",{value:oe.id,children:oe.container_ref},oe.id))]}),n.jsx("p",{className:"mt-2 text-xs text-blue-800 font-medium",children:" This expense will be CAPITALIZED to inventory and allocated to batches"}),n.jsx("p",{className:"mt-1 text-xs text-red-700 font-semibold",children:" Backend will block saving without a container selection"})]}),ye&&n.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[n.jsx("label",{className:"block text-sm font-medium text-green-900 mb-2",children:"Delivery Challan (Optional)"}),n.jsxs("select",{value:I.delivery_challan_id,onChange:oe=>H({...I,delivery_challan_id:oe.target.value}),className:"w-full px-3 py-2 border border-green-300 rounded-lg",children:[n.jsx("option",{value:"",children:"Select DC (Optional)"}),l.map(oe=>{var ke;return n.jsxs("option",{value:oe.id,children:[oe.challan_number," - ",new Date(oe.challan_date).toLocaleDateString("en-GB")," - ",((ke=oe.customers)==null?void 0:ke.company_name)||"No Customer"]},oe.id)})]}),n.jsx("p",{className:"mt-2 text-xs text-green-700",children:"This expense will be EXPENSED to P&L (not capitalized)"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Date ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"date",value:I.expense_date,onChange:oe=>H({...I,expense_date:oe.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Amount (Rp) ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"number",step:"0.01",value:I.amount,onChange:oe=>H({...I,amount:parseFloat(oe.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0})]})]}),n.jsxs("div",{className:"border-2 border-blue-200 rounded-lg p-4 bg-blue-50",children:[n.jsx("h3",{className:"text-sm font-semibold text-blue-900 mb-3",children:"Payment Details"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Payment Method ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("select",{value:I.payment_method,onChange:oe=>H({...I,payment_method:oe.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0,children:[n.jsx("option",{value:"bank_transfer",children:" Bank Transfer"}),n.jsx("option",{value:"check",children:" Check"}),n.jsx("option",{value:"giro",children:" Giro"}),n.jsx("option",{value:"other",children:" Other"})]}),n.jsx("p",{className:"text-xs text-gray-600 mt-1",children:" Will appear in Bank Reconciliation"}),n.jsx("p",{className:"text-xs text-blue-600 mt-1",children:" For cash expenses, use Petty Cash Manager"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Bank Account ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("select",{value:I.bank_account_id,onChange:oe=>{H({...I,bank_account_id:oe.target.value}),oe.target.value?W(oe.target.value,_==null?void 0:_.id):x([]),b("")},className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0,children:[n.jsx("option",{value:"",children:"Select Bank Account"}),d.map(oe=>n.jsxs("option",{value:oe.id,children:[oe.bank_name," - ",oe.alias||oe.account_number]},oe.id))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Link to Bank Transaction"}),I.bank_account_id&&A.length>0?n.jsxs(n.Fragment,{children:[n.jsxs("select",{value:p,onChange:oe=>b(oe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[n.jsx("option",{value:"",children:"Choose a transaction..."}),A.map(oe=>{var Ee,ze;const ke=new Date(oe.transaction_date),Ue=String(ke.getDate()).padStart(2,"0"),qe=String(ke.getMonth()+1).padStart(2,"0"),$e=String(ke.getFullYear()).slice(-2),Ne=`${Ue}/${qe}/${$e}`;return n.jsxs("option",{value:oe.id,children:[Ne," - ",((Ee=oe.description)==null?void 0:Ee.substring(0,50))||"No description"," - Rp ",(ze=oe.debit_amount)==null?void 0:ze.toLocaleString()]},oe.id)})]}),n.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:[A.length," unreconciled transaction",A.length!==1?"s":""]})]}):I.bank_account_id?n.jsx("div",{className:"text-sm text-gray-500 italic py-2 px-3 bg-gray-50 rounded-lg border border-gray-200",children:"No unreconciled transactions"}):n.jsx("input",{type:"text",value:I.payment_reference,onChange:oe=>H({...I,payment_reference:oe.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"Enter reference number"})]})]})]}),_&&_.bank_statement_lines&&_.bank_statement_lines.length>0&&n.jsxs("div",{className:"p-4 bg-green-50 border border-green-300 rounded-lg",children:[n.jsxs("div",{className:"flex items-start justify-between mb-3",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Zt,{className:"w-5 h-5 text-green-600"}),n.jsx("h4",{className:"font-semibold text-green-900",children:"Linked Bank Transaction"})]}),e&&n.jsx("button",{type:"button",onClick:()=>he(_.id),className:"text-sm text-red-600 hover:text-red-700 font-medium",children:"Unlink"})]}),_.bank_statement_lines.map(oe=>{var ke,Ue,qe;return n.jsxs("div",{className:"space-y-2 text-sm bg-white p-3 rounded border border-green-200",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Bank:"}),n.jsxs("span",{className:"font-medium text-gray-900",children:[((ke=oe.bank_accounts)==null?void 0:ke.alias)||((Ue=oe.bank_accounts)==null?void 0:Ue.bank_name)," - ",(qe=oe.bank_accounts)==null?void 0:qe.account_number]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Transaction Date:"}),n.jsx("span",{className:"font-medium text-gray-900",children:new Date(oe.transaction_date).toLocaleDateString("id-ID")})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Amount:"}),n.jsxs("span",{className:"font-medium text-gray-900",children:["Rp ",(oe.debit_amount||oe.credit_amount||0).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),oe.description&&n.jsxs("div",{className:"pt-2 border-t border-green-200",children:[n.jsx("div",{className:"text-gray-600 mb-1",children:"Bank Description:"}),n.jsx("div",{className:"text-gray-900 font-medium",children:oe.description})]})]},oe.id)})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),n.jsx("textarea",{value:I.description,onChange:oe=>H({...I,description:oe.target.value}),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),n.jsxs("div",{className:"border-t pt-4",children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[n.jsx(Zt,{className:"w-4 h-4 inline mr-1"}),"Supporting Documents (Invoices, Receipts, Bills)"]}),I.document_urls.length>0&&n.jsxs("div",{className:"mb-3 space-y-2",children:[n.jsx("p",{className:"text-xs text-gray-600 font-medium",children:"Uploaded Documents:"}),I.document_urls.map((oe,ke)=>n.jsxs("div",{className:"flex items-center gap-2 p-2 bg-green-50 border border-green-200 rounded",children:[n.jsx(Zt,{className:"w-4 h-4 text-green-600 flex-shrink-0"}),n.jsxs("a",{href:oe,target:"_blank",rel:"noopener noreferrer",className:"flex-1 text-sm text-green-700 hover:text-green-900 truncate",children:["Document ",ke+1]}),n.jsx("a",{href:oe,target:"_blank",rel:"noopener noreferrer",className:"p-1 text-green-600 hover:bg-green-100 rounded",children:n.jsx(Gd,{className:"w-3 h-3"})}),n.jsx("button",{type:"button",onClick:()=>ne(oe),className:"p-1 text-red-600 hover:bg-red-100 rounded",children:n.jsx(wr,{className:"w-3 h-3"})})]},ke))]}),ee.length>0&&n.jsxs("div",{className:"mb-3 space-y-2",children:[n.jsx("p",{className:"text-xs text-gray-600 font-medium",children:"Files to Upload:"}),ee.map((oe,ke)=>n.jsxs("div",{className:"flex items-center gap-2 p-2 bg-blue-50 border border-blue-200 rounded",children:[n.jsx(Rl,{className:"w-4 h-4 text-blue-600 flex-shrink-0"}),n.jsx("span",{className:"flex-1 text-sm text-blue-700 truncate",children:oe.name}),n.jsxs("span",{className:"text-xs text-blue-600",children:[(oe.size/1024).toFixed(1)," KB"]}),n.jsx("button",{type:"button",onClick:()=>te(ke),className:"p-1 text-red-600 hover:bg-red-100 rounded",children:n.jsx(wr,{className:"w-3 h-3"})})]},ke))]}),n.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4 text-center hover:border-gray-400 transition-colors",onMouseEnter:()=>re(!0),onMouseLeave:()=>re(!1),children:[n.jsx("input",{type:"file",multiple:!0,accept:"image/*,.pdf,.doc,.docx,.xls,.xlsx",onChange:oe=>{const ke=oe.target.files;ke&&ke.length>0&&Y([...ee,...Array.from(ke)])},className:"hidden",id:"expense-file-upload"}),n.jsxs("label",{htmlFor:"expense-file-upload",className:"cursor-pointer flex flex-col items-center",children:[n.jsx(Rl,{className:"w-8 h-8 text-gray-400 mb-2"}),n.jsx("span",{className:"text-sm text-blue-600 font-medium",children:"Click to upload files"}),n.jsx("span",{className:"text-xs text-gray-500 mt-1",children:"PDF, images, or documents (max 10MB each)"})]}),G&&n.jsxs("div",{className:"flex items-center justify-center gap-2 text-xs text-green-600 font-medium animate-pulse mt-2",children:[n.jsx(wE,{className:"w-4 h-4"}),n.jsx("span",{children:"Press Ctrl+V to paste images from clipboard"})]})]})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[n.jsx("button",{type:"button",onClick:()=>{v(!1),ce()},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),n.jsxs("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[_?"Update":"Record"," Expense"]})]})]})}),E&&N&&n.jsx(Ot,{isOpen:E,onClose:()=>{C(!1),B(null)},title:"Expense Details",maxWidth:"max-w-3xl",children:n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-6 pb-4 border-b",children:[n.jsxs("div",{children:[n.jsx("label",{className:"text-xs text-gray-500 font-medium uppercase",children:"Date"}),n.jsx("p",{className:"text-sm text-gray-900 mt-1 font-medium",children:new Date(N.expense_date).toLocaleDateString()})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-xs text-gray-500 font-medium uppercase",children:"Amount"}),n.jsxs("p",{className:"text-lg text-gray-900 mt-1 font-bold",children:["Rp ",N.amount.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-xs text-gray-500 font-medium uppercase",children:"Category"}),n.jsx("p",{className:"text-sm text-gray-900 mt-1",children:((Be=_s.find(oe=>oe.value===N.expense_category))==null?void 0:Be.label)||N.expense_category})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-xs text-gray-500 font-medium uppercase",children:"Type"}),n.jsx("p",{className:"text-sm text-gray-900 mt-1 capitalize",children:N.expense_type||"-"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-xs text-gray-500 font-medium uppercase",children:"Description"}),n.jsx("p",{className:"text-sm text-gray-900 mt-1",children:N.description||"-"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-6 pb-4 border-b",children:[n.jsxs("div",{children:[n.jsx("label",{className:"text-xs text-gray-500 font-medium uppercase",children:"Payment Method"}),n.jsx("p",{className:"text-sm text-gray-900 mt-1 capitalize",children:((Fe=N.payment_method)==null?void 0:Fe.replace("_"," "))||"-"})]}),N.bank_accounts&&n.jsxs("div",{children:[n.jsx("label",{className:"text-xs text-gray-500 font-medium uppercase",children:"Bank Account"}),n.jsxs("p",{className:"text-sm text-gray-900 mt-1",children:[N.bank_accounts.alias||N.bank_accounts.bank_name," - ",N.bank_accounts.account_number]})]}),N.payment_reference&&n.jsxs("div",{children:[n.jsx("label",{className:"text-xs text-gray-500 font-medium uppercase",children:"Payment Reference"}),n.jsx("p",{className:"text-sm text-gray-900 mt-1",children:N.payment_reference})]})]}),(N.batches||N.import_containers||N.delivery_challans)&&n.jsxs("div",{className:"space-y-3 pb-4 border-b",children:[n.jsx("label",{className:"text-xs text-gray-500 font-medium uppercase",children:"Linked To"}),N.batches&&n.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[n.jsx(Rr,{className:"w-4 h-4 text-blue-600"}),n.jsxs("span",{className:"text-blue-700 font-medium",children:["Batch: ",N.batches.batch_number]})]}),N.import_containers&&n.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[n.jsx(Rr,{className:"w-4 h-4 text-green-600"}),n.jsxs("span",{className:"text-green-700 font-medium",children:["Container: ",N.import_containers.container_ref]})]}),N.delivery_challans&&n.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[n.jsx(us,{className:"w-4 h-4 text-green-600"}),n.jsxs("span",{className:"text-green-700 font-medium",children:["Delivery Challan: ",N.delivery_challans.challan_number]})]})]}),N.bank_statement_lines&&N.bank_statement_lines.length>0&&n.jsxs("div",{className:"pb-4 border-b",children:[n.jsxs("label",{className:"text-xs text-gray-500 font-medium uppercase mb-3 block",children:[n.jsx(Zt,{className:"w-4 h-4 inline mr-1"}),"Bank Reconciliation"]}),n.jsx("div",{className:"space-y-3",children:N.bank_statement_lines.map(oe=>{var ke,Ue,qe;return n.jsxs("div",{className:"p-4 bg-green-50 border border-green-300 rounded-lg",children:[n.jsx("div",{className:"flex items-center gap-2 mb-3",children:n.jsx("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-bold text-green-700 bg-green-200 rounded",children:" LINKED TO BANK"})}),n.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-gray-600 font-medium mb-1",children:"Bank Account"}),n.jsx("div",{className:"text-gray-900 font-semibold",children:((ke=oe.bank_accounts)==null?void 0:ke.alias)||((Ue=oe.bank_accounts)==null?void 0:Ue.bank_name)}),n.jsx("div",{className:"text-xs text-gray-600",children:(qe=oe.bank_accounts)==null?void 0:qe.account_number})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-gray-600 font-medium mb-1",children:"Transaction Date"}),n.jsx("div",{className:"text-gray-900 font-semibold",children:new Date(oe.transaction_date).toLocaleDateString("id-ID")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-gray-600 font-medium mb-1",children:"Bank Transaction Amount"}),n.jsxs("div",{className:"text-lg text-green-700 font-bold",children:["Rp ",(oe.debit_amount||oe.credit_amount||0).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-gray-600 font-medium mb-1",children:"Expense Amount"}),n.jsxs("div",{className:"text-lg text-gray-900 font-bold",children:["Rp ",N.amount.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]}),oe.description&&n.jsxs("div",{className:"mt-3 pt-3 border-t border-green-200",children:[n.jsx("div",{className:"text-xs text-gray-600 font-medium mb-1",children:"Bank Statement Description"}),n.jsx("div",{className:"text-sm text-gray-900 font-medium bg-white p-2 rounded border border-green-200",children:oe.description})]})]},oe.id)})})]}),N.document_urls&&N.document_urls.length>0&&n.jsxs("div",{children:[n.jsxs("label",{className:"text-xs text-gray-500 font-medium uppercase mb-3 block",children:[n.jsx(Zt,{className:"w-4 h-4 inline mr-1"}),"Supporting Documents (",N.document_urls.length,")"]}),n.jsx("div",{className:"grid grid-cols-1 gap-3",children:N.document_urls.map((oe,ke)=>{const Ue=/\.(jpg|jpeg|png|gif|bmp|webp)$/i.test(oe);return n.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg hover:bg-blue-100 transition-colors",children:[n.jsxs("div",{className:"flex items-start justify-between mb-2",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(Zt,{className:"w-5 h-5 text-blue-600 flex-shrink-0"}),n.jsxs("span",{className:"text-sm text-blue-900 font-medium",children:["Document ",ke+1]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("a",{href:oe,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 px-3 py-1.5 text-xs font-medium text-blue-700 bg-white border border-blue-300 rounded hover:bg-blue-50",children:[n.jsx(Gd,{className:"w-3 h-3"}),"View"]}),n.jsxs("a",{href:oe,download:!0,className:"flex items-center gap-1 px-3 py-1.5 text-xs font-medium text-green-700 bg-white border border-green-300 rounded hover:bg-green-50",children:[n.jsx(Zn,{className:"w-3 h-3"}),"Download"]})]})]}),Ue&&n.jsx("div",{className:"mt-2",children:n.jsx("a",{href:oe,target:"_blank",rel:"noopener noreferrer",children:n.jsx("img",{src:oe,alt:`Document ${ke+1}`,className:"w-full max-w-md rounded-lg border-2 border-gray-300 hover:border-blue-400 cursor-pointer shadow-sm hover:shadow-md transition-all",style:{maxHeight:"300px",objectFit:"contain"}})})})]},ke)})})]}),(!N.document_urls||N.document_urls.length===0)&&n.jsx("div",{className:"text-center py-4 text-gray-500 text-sm italic",children:"No supporting documents attached"}),n.jsx("div",{className:"flex justify-end pt-4 border-t",children:n.jsx("button",{onClick:()=>{C(!1),B(null)},className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700",children:"Close"})})]})})]})}const Jh=[{value:"duty_customs",label:"Duty & Customs (BM)",type:"import",icon:_n,description:"Import duties and customs charges - CAPITALIZED to inventory",requiresContainer:!0,group:"Import Costs"},{value:"ppn_import",label:"PPN Import",type:"operations",icon:hn,description:"Import VAT - EXPENSED to P&L",requiresContainer:!1,group:"Operations"},{value:"pph_import",label:"PPh Import",type:"import",icon:_n,description:"Import withholding tax - CAPITALIZED to inventory",requiresContainer:!0,group:"Import Costs"},{value:"freight_import",label:"Freight (Import)",type:"import",icon:Rr,description:"International freight charges - CAPITALIZED to inventory",requiresContainer:!0,group:"Import Costs"},{value:"clearing_forwarding",label:"Clearing & Forwarding",type:"import",icon:_n,description:"Customs clearance - CAPITALIZED to inventory",requiresContainer:!0,group:"Import Costs"},{value:"port_charges",label:"Port Charges",type:"import",icon:_n,description:"Port handling charges - CAPITALIZED to inventory",requiresContainer:!0,group:"Import Costs"},{value:"container_handling",label:"Container Handling",type:"import",icon:Rr,description:"Container unloading - CAPITALIZED to inventory",requiresContainer:!0,group:"Import Costs"},{value:"transport_import",label:"Transportation (Import)",type:"import",icon:us,description:"Port to godown transport - CAPITALIZED to inventory",requiresContainer:!0,group:"Import Costs"},{value:"loading_import",label:"Loading / Unloading (Import)",type:"import",icon:us,description:"Import container loading/unloading - CAPITALIZED to inventory",requiresContainer:!0,group:"Import Costs"},{value:"bpom_ski_fees",label:"BPOM / SKI Fees",type:"import",icon:Zt,description:"BPOM/SKI regulatory fees - CAPITALIZED to inventory",requiresContainer:!0,group:"Import Costs"},{value:"other_import",label:"Other (Import)",type:"import",icon:hn,description:"Other import-related expenses - CAPITALIZED to inventory",requiresContainer:!0,group:"Import Costs"},{value:"delivery_sales",label:"Delivery / Dispatch (Sales)",type:"sales",icon:us,description:"Customer delivery - EXPENSED to P&L",requiresContainer:!1,group:"Sales & Distribution"},{value:"loading_sales",label:"Loading / Unloading (Sales)",type:"sales",icon:us,description:"Sales loading charges - EXPENSED to P&L",requiresContainer:!1,group:"Sales & Distribution"},{value:"other_sales",label:"Other (Sales)",type:"sales",icon:hn,description:"Other sales-related expenses - EXPENSED to P&L",requiresContainer:!1,group:"Sales & Distribution"},{value:"salary",label:"Salary",type:"staff",icon:hn,description:"Staff salaries - EXPENSED to P&L",requiresContainer:!1,group:"Staff Costs"},{value:"staff_overtime",label:"Staff Overtime",type:"staff",icon:hn,description:"Overtime payments - EXPENSED to P&L",requiresContainer:!1,group:"Staff Costs"},{value:"staff_welfare",label:"Staff Welfare / Allowances",type:"staff",icon:hn,description:"Driver food, snacks, overtime meals, welfare - EXPENSED to P&L",requiresContainer:!1,group:"Staff Costs"},{value:"travel_conveyance",label:"Travel & Conveyance",type:"staff",icon:us,description:"Local travel, taxi, fuel reimbursements, tolls - EXPENSED to P&L",requiresContainer:!1,group:"Staff Costs"},{value:"warehouse_rent",label:"Warehouse Rent",type:"operations",icon:_n,description:"Rent expense - EXPENSED to P&L",requiresContainer:!1,group:"Operations"},{value:"utilities",label:"Utilities",type:"operations",icon:_n,description:"Electricity, water, etc - EXPENSED to P&L",requiresContainer:!1,group:"Operations"},{value:"bank_charges",label:"Bank Charges",type:"operations",icon:hn,description:"Bank fees, charges, and transaction costs - EXPENSED to P&L",requiresContainer:!1,group:"Operations"},{value:"office_admin",label:"Office & Admin",type:"admin",icon:_n,description:"General admin expenses - EXPENSED to P&L",requiresContainer:!1,group:"Administrative"},{value:"office_shifting_renovation",label:"Office Shifting & Renovation",type:"admin",icon:_n,description:"Office shifting, partition work, electrical, cabling, interior renovation - EXPENSED to P&L",requiresContainer:!1,group:"Administrative"},{value:"fixed_assets",label:"Fixed Assets / Equipment",type:"assets",icon:Rr,description:"Purchase of fixed assets - CAPITALIZED (see Asset Guide)",requiresContainer:!1,group:"Assets"},{value:"other",label:"Other",type:"admin",icon:hn,description:"Miscellaneous expenses - EXPENSED to P&L",requiresContainer:!1,group:"Administrative"}];function rAe({canManage:e,onNavigateToFundTransfer:t}){const[r,a]=Q.useState([]),[s,i]=Q.useState([]),[o,l]=Q.useState([]),[c,d]=Q.useState([]),[u,f]=Q.useState(!0),[h,A]=Q.useState(!1),[x,p]=Q.useState(!1),[b,m]=Q.useState(null),[g,y]=Q.useState(null),[v,_]=Q.useState(0),[j,N]=Q.useState(!1),[B,E]=Q.useState([]),[C,k]=Q.useState([]),[w,T]=Q.useState(null),[R,q]=Q.useState(!1),[z,ee]=Q.useState("all"),[Y,G]=Q.useState("all"),{dateRange:re}=rl(),{profile:U}=Cr(),S=re.startDate,D=re.endDate,[L,P]=Q.useState({transaction_type:"expense",transaction_date:new Date().toISOString().split("T")[0],amount:0,description:"",expense_category:"",bank_account_id:"",paid_to:"",paid_by_staff_name:"",paid_by:"cash",source:"",received_by_staff_name:"",import_container_id:"",delivery_challan_id:""}),I=Q.useCallback(async()=>{try{const[Be,Fe,oe,ke,Ue]=await Promise.all([Z.from("petty_cash_transactions").select(`
            *,
            bank_accounts:bank_account_id (
              account_name,
              bank_name,
              alias,
              currency
            ),
            import_containers:import_container_id (
              container_ref
            ),
            delivery_challans:delivery_challan_id (
              challan_number
            ),
            petty_cash_documents (*)
          `).gte("transaction_date",S).lte("transaction_date",D).order("transaction_date",{ascending:!1}).order("transaction_number",{ascending:!1}),Z.rpc("get_petty_cash_balance"),Z.from("import_containers").select("id, container_ref").order("container_ref",{ascending:!1}),Z.from("delivery_challans").select(`
            id,
            challan_number,
            challan_date,
            customers:customer_id (
              company_name
            )
          `).order("challan_date",{ascending:!1}),Z.from("bank_accounts").select("*").order("bank_name",{ascending:!0})]);if(Be.error)throw Be.error;if(Fe.error)throw Fe.error;a(Be.data||[]),_(Fe.data||0),i(oe.data||[]),l(ke.data||[]),d(Ue.data||[])}catch(Be){console.error("Error loading petty cash data:",Be),alert("Failed to load petty cash data: "+Be.message)}finally{f(!1),N(!1)}},[S,D]);Q.useEffect(()=>{I();const Be=Z.channel("petty-cash-changes").on("postgres_changes",{event:"*",schema:"public",table:"petty_cash_transactions"},()=>{I()}).subscribe();return()=>{Be.unsubscribe()}},[I]);const H=async Be=>{const Fe=Array.from(Be.target.files||[]);Fe.length!==0&&E(Fe)},V=async Be=>{const oe=Array.from(Be.clipboardData.items).filter(ke=>ke.type.startsWith("image/"));if(oe.length>0){Be.preventDefault();const Ue=(await Promise.all(oe.map(qe=>{const $e=qe.getAsFile();return $e?new File([$e],`pasted-image-${Date.now()}.png`,{type:$e.type}):null}))).filter(qe=>qe!==null);Ue.length>0&&E(qe=>[...qe,...Ue])}},W=Be=>{E(Fe=>Fe.filter((oe,ke)=>ke!==Be))},M=async Be=>{if(confirm("Are you sure you want to delete this document?"))try{const{error:Fe}=await Z.from("petty_cash_documents").delete().eq("id",Be);if(Fe)throw Fe;k(oe=>oe.filter(ke=>ke.id!==Be)),alert("Document deleted successfully!")}catch(Fe){console.error("Error deleting document:",Fe),alert("Failed to delete document")}},se=()=>{A(!1),y(null),k([]),E([])},K=()=>{y(null),P({transaction_type:"expense",transaction_date:new Date().toISOString().split("T")[0],amount:0,description:"",expense_category:"",bank_account_id:"",paid_to:"",paid_by_staff_name:"",paid_by:"cash",source:"",received_by_staff_name:"",import_container_id:"",delivery_challan_id:""}),k([]),E([]),A(!0)},he=Be=>{y(Be),P({transaction_type:Be.transaction_type,transaction_date:Be.transaction_date,amount:Be.amount,description:Be.description,expense_category:Be.expense_category||"",bank_account_id:Be.bank_account_id||"",paid_to:Be.paid_to||"",paid_by_staff_name:Be.paid_by_staff_name||"",paid_by:"cash",source:Be.source||"",received_by_staff_name:Be.received_by_staff_name||"",import_container_id:Be.import_container_id||"",delivery_challan_id:Be.delivery_challan_id||""}),k(Be.petty_cash_documents||[]),E([]),A(!0)},ne=async Be=>{if(Be.preventDefault(),L.transaction_type==="expense"&&!L.expense_category){alert("Please select an expense category");return}const Fe=Jh.find(oe=>oe.value===L.expense_category);if(Fe!=null&&Fe.requiresContainer&&!L.import_container_id){alert(`${Fe.label} requires linking to an import container`);return}try{const oe={transaction_type:L.transaction_type,transaction_date:L.transaction_date,amount:L.amount,description:L.description,expense_category:L.transaction_type==="expense"?L.expense_category:null,bank_account_id:L.transaction_type==="withdraw"?L.bank_account_id:null,paid_to:L.transaction_type==="expense"?L.paid_to:null,paid_by_staff_name:L.transaction_type==="expense"?L.paid_by_staff_name:null,source:L.transaction_type==="withdraw"?L.source:null,received_by_staff_name:L.transaction_type==="withdraw"?L.received_by_staff_name:null,import_container_id:L.import_container_id||null,delivery_challan_id:L.delivery_challan_id||null};let ke;if(g){const{error:Ue}=await Z.from("petty_cash_transactions").update(oe).eq("id",g.id);if(Ue)throw Ue;ke=g.id}else{const{data:Ue,error:qe}=await Z.from("petty_cash_transactions").insert([oe]).select("id").single();if(qe)throw qe;if(!Ue)throw new Error("Failed to create transaction");ke=Ue.id}if(B.length>0){const Ue=B.map(async qe=>{const $e=qe.name.split(".").pop(),Ee=`${`${ke}_${Date.now()}.${$e}`}`,{error:ze}=await Z.storage.from("petty-cash-receipts").upload(Ee,qe);if(ze)throw ze;const{data:{publicUrl:rt}}=Z.storage.from("petty-cash-receipts").getPublicUrl(Ee);let nt="proof";qe.type.startsWith("image/")?nt="photo":qe.type==="application/pdf"&&(nt="invoice");const{error:mt}=await Z.from("petty_cash_documents").insert([{petty_cash_transaction_id:ke,file_type:nt,file_name:qe.name,file_url:rt,file_size:qe.size,uploaded_by:U==null?void 0:U.id}]);if(mt)throw mt});await Promise.all(Ue)}alert(g?"Petty cash transaction updated successfully!":"Petty cash transaction added successfully!"),se(),I()}catch(oe){console.error("Error saving petty cash transaction:",oe),alert("Failed to save transaction: "+oe.message)}},te=async Be=>{if(confirm("Are you sure you want to delete this transaction?"))try{const{data:Fe}=await Z.from("petty_cash_documents").select("file_url").eq("petty_cash_transaction_id",Be),{error:oe}=await Z.from("petty_cash_transactions").delete().eq("id",Be);if(oe)throw oe;if(Fe&&Fe.length>0){const ke=Fe.map(Ue=>Ue.file_url.split("/").pop()||"").filter(Boolean);ke.length>0&&await Z.storage.from("petty-cash-receipts").remove(ke)}alert("Transaction deleted successfully!"),await I()}catch(Fe){console.error("Error deleting transaction:",Fe),alert("Failed to delete transaction: "+Fe.message)}},ce=()=>{if(Le.length===0){alert("No transactions to export");return}const Be=["Date","Number","Type","Category","Description","Amount","Paid To"],Fe=Le.map($e=>{const Ne=$e.expense_category?we($e.expense_category):null;return[$e.transaction_date,$e.transaction_number,$e.transaction_type==="withdraw"?"Withdrawal":"Expense",(Ne==null?void 0:Ne.label)||"",$e.description,$e.amount.toString(),$e.paid_to||""]}),oe=[Be.join(","),...Fe.map($e=>$e.map(Ne=>`"${Ne}"`).join(","))].join(`
`),ke=new Blob([oe],{type:"text/csv;charset=utf-8;"}),Ue=document.createElement("a"),qe=URL.createObjectURL(ke);Ue.setAttribute("href",qe),Ue.setAttribute("download",`petty_cash_${S||"all"}_to_${D||"all"}.csv`),Ue.style.visibility="hidden",document.body.appendChild(Ue),Ue.click(),document.body.removeChild(Ue)},_e=Be=>{m(Be),p(!0)},de=Be=>{let Fe="asc";w&&w.key===Be&&w.direction==="asc"&&(Fe="desc"),T({key:Be,direction:Fe})},Le=[...r].sort((Be,Fe)=>{if(!w)return 0;const oe=Be[w.key],ke=Fe[w.key];return oe==null?1:ke==null?-1:oe<ke?w.direction==="asc"?-1:1:oe>ke?w.direction==="asc"?1:-1:0}).filter(Be=>{if(z!=="all"&&Be.transaction_type==="expense"){const Fe=Jh.find(oe=>oe.value===Be.expense_category);if(!Fe||Fe.type!==z)return!1}return!(Y!=="all"&&Be.expense_category!==Y)}),we=Be=>Jh.find(Fe=>Fe.value===Be),ge=we(L.expense_category);if(u)return n.jsx("div",{className:"flex items-center justify-center h-64",children:"Loading petty cash data..."});const Re=Le.filter(Be=>Be.transaction_type==="expense").reduce((Be,Fe)=>Be+Number(Fe.amount),0),et=Le.filter(Be=>Be.transaction_type==="withdraw").reduce((Be,Fe)=>Be+Number(Fe.amount),0),Ye=Jh.reduce((Be,Fe)=>(Be[Fe.group]||(Be[Fe.group]=[]),Be[Fe.group].push(Fe),Be),{});return n.jsxs("div",{className:"space-y-4",children:[n.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Petty Cash"}),n.jsx("p",{className:"text-xs text-gray-600 mt-0.5",children:"Track cash withdrawals and expenses"})]}),n.jsxs("div",{className:"flex items-center gap-4 ml-8",children:[n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-xs text-gray-500",children:"Balance"}),n.jsxs("div",{className:"text-sm font-bold text-green-600",children:["Rp ",v.toLocaleString()]})]}),n.jsx("div",{className:"h-6 w-px bg-gray-300"}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-xs text-gray-500",children:"Withdrawals"}),n.jsxs("div",{className:"text-sm font-bold text-blue-600",children:["Rp ",et.toLocaleString()]})]}),n.jsx("div",{className:"h-6 w-px bg-gray-300"}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-xs text-gray-500",children:"Expenses"}),n.jsxs("div",{className:"text-sm font-bold text-red-600",children:["Rp ",Re.toLocaleString()]})]})]})]}),e&&n.jsxs("button",{onClick:K,className:"flex items-center gap-1.5 px-2.5 py-1.5 bg-white text-blue-600 rounded hover:bg-blue-50 font-medium transition-all shadow-sm text-xs",children:[n.jsx(Pr,{className:"w-3.5 h-3.5"}),"New"]})]})}),n.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-2",children:n.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[n.jsx("div",{className:"flex gap-1",children:[{value:"all",label:"All",icon:""},{value:"import",label:"Import",icon:""},{value:"sales",label:"Sales",icon:""},{value:"staff",label:"Staff",icon:""},{value:"operations",label:"Ops",icon:""},{value:"admin",label:"Admin",icon:""},{value:"assets",label:"Assets",icon:""}].map(Be=>n.jsxs("button",{onClick:()=>ee(Be.value),className:`px-3 py-1.5 rounded-md text-xs font-medium transition-all ${z===Be.value?"bg-blue-600 text-white shadow-sm":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[Be.icon," ",Be.label]},Be.value))}),n.jsx("div",{className:"h-6 w-px bg-gray-300"}),n.jsxs("select",{value:Y,onChange:Be=>G(Be.target.value),className:"px-2 py-1 border border-gray-300 rounded-md text-xs",children:[n.jsx("option",{value:"all",children:"All Categories"}),Jh.map(Be=>n.jsx("option",{value:Be.value,children:Be.label},Be.value))]}),n.jsxs("button",{onClick:ce,disabled:Le.length===0,className:"ml-auto px-3 py-1.5 bg-green-600 text-white rounded-md text-xs hover:bg-green-700 disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center gap-1.5 font-medium",children:[n.jsx(Zn,{className:"w-3.5 h-3.5"}),"Export (",Le.length,")"]})]})}),n.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-x-auto",children:n.jsxs("table",{className:"min-w-full",children:[n.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:n.jsxs("tr",{children:[n.jsx("th",{onClick:()=>de("transaction_date"),className:"px-4 py-2.5 text-left text-xs font-semibold text-gray-600 cursor-pointer hover:bg-gray-100 select-none",children:n.jsxs("div",{className:"flex items-center gap-1",children:["Date",(w==null?void 0:w.key)==="transaction_date"&&n.jsx("span",{className:"text-blue-600 text-sm",children:w.direction==="asc"?"":""})]})}),n.jsx("th",{onClick:()=>de("transaction_number"),className:"px-4 py-2.5 text-left text-xs font-semibold text-gray-600 cursor-pointer hover:bg-gray-100 select-none",children:n.jsxs("div",{className:"flex items-center gap-1",children:["Number",(w==null?void 0:w.key)==="transaction_number"&&n.jsx("span",{className:"text-blue-600 text-sm",children:w.direction==="asc"?"":""})]})}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-semibold text-gray-600",children:"Type"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-semibold text-gray-600",children:"Category"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-semibold text-gray-600",children:"Description"}),n.jsx("th",{className:"px-4 py-2.5 text-left text-xs font-semibold text-gray-600",children:"Linked To"}),n.jsx("th",{onClick:()=>de("amount"),className:"px-4 py-2.5 text-right text-xs font-semibold text-gray-600 cursor-pointer hover:bg-gray-100 select-none",children:n.jsxs("div",{className:"flex items-center justify-end gap-1",children:["Amount",(w==null?void 0:w.key)==="amount"&&n.jsx("span",{className:"text-blue-600 text-sm",children:w.direction==="asc"?"":""})]})}),e&&n.jsx("th",{className:"px-4 py-2.5 text-center text-xs font-semibold text-gray-600",children:"Actions"})]})}),n.jsx("tbody",{className:"divide-y divide-gray-100",children:u?n.jsx("tr",{children:n.jsx("td",{colSpan:e?8:7,className:"px-6 py-8 text-center text-gray-500",children:"Loading..."})}):Le.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:e?8:7,className:"px-6 py-8 text-center text-gray-500",children:"No transactions found"})}):Le.map(Be=>{const Fe=Be.expense_category?we(Be.expense_category):null,oe=Fe==null?void 0:Fe.icon;return n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:new Date(Be.transaction_date).toLocaleDateString()}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-sm font-medium text-blue-600",children:Be.transaction_number}),Be.voucher_number&&n.jsx("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded",children:Be.voucher_number})]})}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:n.jsx("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${Be.transaction_type==="withdraw"?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"}`,children:Be.transaction_type==="withdraw"?n.jsxs(n.Fragment,{children:[n.jsx(Gb,{className:"h-3 w-3"}),"Withdrawal"]}):n.jsxs(n.Fragment,{children:[n.jsx(Xb,{className:"h-3 w-3"}),"Expense"]})})}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:Fe&&n.jsxs("div",{className:"flex items-center gap-2",children:[oe&&n.jsx(oe,{className:"h-4 w-4 text-gray-500"}),n.jsx("span",{className:"text-sm text-gray-900",children:Fe.label})]})}),n.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:n.jsxs("div",{className:"max-w-xs truncate",children:[Be.description,Be.paid_to&&n.jsxs("div",{className:"text-xs text-gray-500",children:["To: ",Be.paid_to]})]})}),n.jsx("td",{className:"px-4 py-3 text-sm",children:n.jsxs("div",{className:"space-y-1",children:[Be.import_containers&&n.jsxs("div",{className:"flex items-center gap-1 text-purple-600",children:[n.jsx(Rr,{className:"h-3 w-3"}),n.jsx("span",{className:"text-xs",children:Be.import_containers.container_ref})]}),Be.delivery_challans&&n.jsxs("div",{className:"flex items-center gap-1 text-green-600",children:[n.jsx(us,{className:"h-3 w-3"}),n.jsx("span",{className:"text-xs",children:Be.delivery_challans.challan_number})]})]})}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-right",children:n.jsxs("span",{className:`text-sm font-medium ${Be.transaction_type==="withdraw"?"text-blue-600":"text-red-600"}`,children:["Rp ",Number(Be.amount).toLocaleString()]})}),n.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-right text-sm",children:n.jsxs("div",{className:"flex items-center justify-end gap-2",children:[n.jsx("button",{onClick:()=>_e(Be),className:"text-blue-600 hover:text-blue-900",title:"View Details",children:n.jsx(bi,{className:"h-4 w-4"})}),e&&n.jsxs(n.Fragment,{children:[n.jsx("button",{onClick:()=>he(Be),className:"text-yellow-600 hover:text-yellow-900",title:"Edit",children:n.jsx(OA,{className:"h-4 w-4"})}),n.jsx("button",{onClick:()=>te(Be.id),className:"text-red-600 hover:text-red-900",title:"Delete",children:n.jsx(Lr,{className:"h-4 w-4"})})]})]})})]},Be.id)})})]})}),n.jsx(Ot,{isOpen:h,onClose:se,title:g?"Edit Transaction":"Add Petty Cash Transaction",children:n.jsxs("form",{onSubmit:ne,className:"space-y-4",onPaste:V,children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Transaction Type"}),n.jsxs("select",{value:L.transaction_type,onChange:Be=>P({...L,transaction_type:Be.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0,children:[n.jsx("option",{value:"expense",children:"Expense (Cash Out)"}),n.jsx("option",{value:"withdraw",children:"Withdraw from Bank"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),n.jsx("input",{type:"date",value:L.transaction_date,onChange:Be=>P({...L,transaction_date:Be.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount (Rp)"}),n.jsx("input",{type:"number",value:L.amount||"",onChange:Be=>P({...L,amount:parseFloat(Be.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0,min:"0",step:"0.01"})]})]}),L.transaction_type==="expense"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Expense Category ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("select",{value:L.expense_category,onChange:Be=>P({...L,expense_category:Be.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[n.jsx("option",{value:"",children:"Select expense category..."}),Object.entries(Ye).map(([Be,Fe])=>n.jsx("optgroup",{label:Be,children:Fe.map(oe=>n.jsx("option",{value:oe.value,children:oe.label},oe.value))},Be))]}),L.expense_category&&ge&&n.jsx("p",{className:"mt-1 text-xs text-gray-600",children:ge.description})]}),(ge==null?void 0:ge.requiresContainer)&&n.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-3",children:n.jsxs("div",{className:"flex items-start gap-2",children:[n.jsx(Rr,{className:"h-5 w-5 text-orange-600 flex-shrink-0 mt-0.5"}),n.jsxs("div",{children:[n.jsx("div",{className:"text-sm font-medium text-orange-900",children:"Import Container Required"}),n.jsx("div",{className:"text-xs text-orange-700 mt-1",children:"This expense category requires linking to an import container for proper cost allocation"})]})]})}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Link to Container ",(ge==null?void 0:ge.requiresContainer)&&n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("select",{value:L.import_container_id,onChange:Be=>P({...L,import_container_id:Be.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:ge==null?void 0:ge.requiresContainer,children:[n.jsx("option",{value:"",children:"None"}),s.map(Be=>n.jsx("option",{value:Be.id,children:Be.container_ref},Be.id))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Link to Delivery Challan (Sales)"}),n.jsxs("select",{value:L.delivery_challan_id,onChange:Be=>P({...L,delivery_challan_id:Be.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[n.jsx("option",{value:"",children:"None"}),o.map(Be=>{var Fe;return n.jsxs("option",{value:Be.id,children:[Be.challan_number," - ",(Fe=Be.customers)==null?void 0:Fe.company_name," (",new Date(Be.challan_date).toLocaleDateString(),")"]},Be.id)})]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Paid To"}),n.jsx("input",{type:"text",value:L.paid_to,onChange:Be=>P({...L,paid_to:Be.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"Vendor/Supplier name"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Paid By (Staff)"}),n.jsx("input",{type:"text",value:L.paid_by_staff_name,onChange:Be=>P({...L,paid_by_staff_name:Be.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"Staff member name"})]})]})]}),L.transaction_type==="withdraw"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bank Account"}),n.jsxs("select",{value:L.bank_account_id,onChange:Be=>P({...L,bank_account_id:Be.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0,children:[n.jsx("option",{value:"",children:"Select bank account"}),c.map(Be=>n.jsxs("option",{value:Be.id,children:[Be.alias||Be.bank_name," - ",Be.account_number," (",Be.currency,")"]},Be.id))]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Source/Reference"}),n.jsx("input",{type:"text",value:L.source,onChange:Be=>P({...L,source:Be.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"Check number, transfer ref"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Received By"}),n.jsx("input",{type:"text",value:L.received_by_staff_name,onChange:Be=>P({...L,received_by_staff_name:Be.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"Staff member name"})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),n.jsx("textarea",{value:L.description,onChange:Be=>P({...L,description:Be.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",rows:3,required:!0,placeholder:"Enter transaction details"})]}),g&&C.length>0&&n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Existing Documents (",C.length,")"]}),n.jsx("div",{className:"grid grid-cols-2 gap-3 mb-4",children:C.map(Be=>n.jsxs("div",{className:"group relative border border-gray-200 rounded-lg overflow-hidden hover:border-red-500 transition-colors",children:[Be.file_type==="photo"?n.jsx("div",{className:"aspect-square bg-gray-100 relative",children:n.jsx("img",{src:Be.file_url,alt:Be.file_name,className:"w-full h-full object-cover"})}):n.jsxs("div",{className:"aspect-square bg-red-50 flex flex-col items-center justify-center p-3",children:[n.jsx(Zt,{className:"h-10 w-10 text-red-600 mb-2"}),n.jsx("p",{className:"text-xs text-center text-gray-700 line-clamp-2 px-2",children:Be.file_name})]}),n.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-black bg-opacity-60 text-white text-xs px-2 py-1.5 flex items-center justify-between",children:[n.jsxs("span",{children:[(Be.file_size/1024).toFixed(0)," KB"]}),n.jsxs("div",{className:"flex gap-1",children:[n.jsx("a",{href:Be.file_url,target:"_blank",rel:"noopener noreferrer",className:"p-1 hover:bg-white hover:bg-opacity-20 rounded",onClick:Fe=>Fe.stopPropagation(),children:n.jsx(Gd,{className:"h-3.5 w-3.5"})}),n.jsx("button",{type:"button",onClick:()=>M(Be.id),className:"p-1 hover:bg-red-500 rounded",children:n.jsx(wr,{className:"h-3.5 w-3.5"})})]})]})]},Be.id))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:g?"Upload Additional Documents/Receipts":"Upload Documents/Receipts"}),n.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4 text-center hover:border-blue-500 transition-colors",children:[n.jsx("input",{type:"file",onChange:H,accept:"image/*,.pdf",multiple:!0,className:"hidden",id:"file-upload"}),n.jsxs("label",{htmlFor:"file-upload",className:"cursor-pointer",children:[n.jsx(Rl,{className:"h-8 w-8 text-gray-400 mx-auto mb-2"}),n.jsx("p",{className:"text-sm text-gray-600",children:"Click to upload or drag and drop"}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Images or PDF files"})]}),!R&&B.length===0&&n.jsx("button",{type:"button",onClick:()=>q(!0),className:"text-xs text-blue-600 hover:text-blue-700 mt-2",children:" You can also paste images here"})]}),B.length>0&&n.jsxs("div",{className:"mt-3 space-y-2",children:[n.jsxs("p",{className:"text-sm font-medium text-gray-700",children:[B.length," file(s) ready:"]}),n.jsx("div",{className:"space-y-1",children:B.map((Be,Fe)=>n.jsxs("div",{className:"flex items-center justify-between bg-gray-50 px-3 py-2 rounded",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[Be.type.startsWith("image/")?n.jsx(Jw,{className:"h-4 w-4 text-blue-600"}):n.jsx(Zt,{className:"h-4 w-4 text-red-600"}),n.jsx("span",{className:"text-sm text-gray-700",children:Be.name}),n.jsxs("span",{className:"text-xs text-gray-500",children:["(",(Be.size/1024).toFixed(1)," KB)"]})]}),n.jsx("button",{type:"button",onClick:()=>W(Fe),className:"text-red-600 hover:text-red-800",children:n.jsx(wr,{className:"h-4 w-4"})})]},Fe))})]})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[n.jsx("button",{type:"button",onClick:se,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Cancel"}),n.jsxs("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[g?"Update":"Save"," Transaction"]})]})]})}),n.jsx(Ot,{isOpen:x,onClose:()=>p(!1),title:"Petty Cash Receipt",maxWidth:"max-w-lg",children:b&&n.jsxs("div",{className:"space-y-3 text-sm",children:[n.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 text-white px-3 py-2 rounded -mt-1 -mx-1",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-xs opacity-90",children:"Transaction #"}),n.jsx("p",{className:"text-base font-bold",children:b.transaction_number})]}),n.jsxs("div",{className:"text-right",children:[n.jsx("p",{className:"text-xs opacity-90",children:"Date"}),n.jsx("p",{className:"text-base font-semibold",children:new Date(b.transaction_date).toLocaleDateString("id-ID",{day:"2-digit",month:"short",year:"numeric"})})]})]})}),n.jsx("div",{className:"py-2 border-b border-gray-200",children:n.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-3",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-xs text-gray-500 mb-0.5",children:"Type"}),n.jsx("div",{className:"flex items-center gap-1",children:b.transaction_type==="withdraw"?n.jsxs(n.Fragment,{children:[n.jsx(Gb,{className:"h-3.5 w-3.5 text-blue-600"}),n.jsx("span",{className:"text-sm font-medium text-blue-900",children:"Withdrawal"})]}):n.jsxs(n.Fragment,{children:[n.jsx(Xb,{className:"h-3.5 w-3.5 text-red-600"}),n.jsx("span",{className:"text-sm font-medium text-red-900",children:"Expense"})]})})]}),b.expense_category&&n.jsxs("div",{children:[n.jsx("p",{className:"text-xs text-gray-500 mb-0.5",children:"Category"}),n.jsx("div",{className:"flex items-center gap-1.5",children:(()=>{const Be=we(b.expense_category),Fe=Be==null?void 0:Be.icon;return n.jsxs(n.Fragment,{children:[Fe&&n.jsx(Fe,{className:"h-4 w-4 text-amber-600"}),n.jsx("span",{className:"text-sm font-medium text-gray-900",children:Be==null?void 0:Be.label})]})})()})]})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-xs text-gray-500 mb-0.5",children:"Amount"}),n.jsxs("p",{className:"text-lg font-bold text-gray-900",children:["Rp ",Number(b.amount).toLocaleString("id-ID")]})]})]})}),n.jsxs("div",{className:"py-2 border-b border-gray-200",children:[n.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Description"}),n.jsx("p",{className:"text-sm font-semibold text-gray-900",children:b.description})]}),n.jsxs("div",{className:"py-2 border-b border-gray-200 space-y-1.5",children:[(b.paid_to||b.paid_by_staff_name)&&n.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[b.paid_to&&n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsx("p",{className:"text-xs text-gray-500",children:"Paid To:"}),n.jsx("p",{className:"text-sm font-medium text-gray-900",children:b.paid_to})]}),b.paid_by_staff_name&&n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsx("p",{className:"text-xs text-gray-500",children:"Paid By:"}),n.jsx("p",{className:"text-sm font-medium text-gray-900",children:b.paid_by_staff_name})]})]}),b.received_by_staff_name&&n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsx("p",{className:"text-xs text-gray-500",children:"Received By:"}),n.jsx("p",{className:"text-sm font-medium text-gray-900",children:b.received_by_staff_name})]}),b.source&&n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsx("p",{className:"text-xs text-gray-500",children:"Source:"}),n.jsx("p",{className:"text-sm font-medium text-gray-900",children:b.source})]})]}),(b.import_containers||b.delivery_challans||b.bank_accounts)&&n.jsxs("div",{className:"py-2 border-b border-gray-200",children:[n.jsx("p",{className:"text-xs text-gray-500 mb-1.5",children:"Linked To"}),n.jsxs("div",{className:"space-y-1",children:[b.import_containers&&n.jsxs("div",{className:"flex items-center gap-1.5 text-xs",children:[n.jsx(Rr,{className:"h-3.5 w-3.5 text-purple-600"}),n.jsx("span",{className:"text-gray-600",children:"Container:"}),n.jsx("span",{className:"font-medium text-gray-900",children:b.import_containers.container_ref})]}),b.delivery_challans&&n.jsxs("div",{className:"flex items-center gap-1.5 text-xs",children:[n.jsx(us,{className:"h-3.5 w-3.5 text-green-600"}),n.jsx("span",{className:"text-gray-600",children:"Challan:"}),n.jsx("span",{className:"font-medium text-gray-900",children:b.delivery_challans.challan_number})]}),b.bank_accounts&&n.jsxs("div",{className:"flex items-center gap-1.5 text-xs",children:[n.jsx(_n,{className:"h-3.5 w-3.5 text-blue-600"}),n.jsx("span",{className:"text-gray-600",children:"Bank:"}),n.jsx("span",{className:"font-medium text-gray-900",children:b.bank_accounts.alias||b.bank_accounts.bank_name})]})]})]}),b.petty_cash_documents&&b.petty_cash_documents.length>0&&n.jsxs("div",{className:"pt-2",children:[n.jsxs("p",{className:"text-xs text-gray-500 mb-2",children:["Attachments (",b.petty_cash_documents.length,")"]}),n.jsx("div",{className:"grid grid-cols-2 gap-2",children:b.petty_cash_documents.map(Be=>n.jsxs("a",{href:Be.file_url,target:"_blank",rel:"noopener noreferrer",className:"group relative border border-gray-200 rounded overflow-hidden hover:border-blue-500 transition-colors",children:[Be.file_type==="photo"?n.jsxs("div",{className:"aspect-square bg-gray-100 relative",children:[n.jsx("img",{src:Be.file_url,alt:Be.file_name,className:"w-full h-full object-cover"}),n.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-10 transition-opacity flex items-center justify-center",children:n.jsx(Gd,{className:"h-5 w-5 text-white opacity-0 group-hover:opacity-100 transition-opacity"})})]}):n.jsxs("div",{className:"aspect-square bg-red-50 flex flex-col items-center justify-center p-3",children:[n.jsx(Zt,{className:"h-8 w-8 text-red-600 mb-2"}),n.jsx("p",{className:"text-xs text-center text-gray-700 line-clamp-2",children:Be.file_name})]}),Be.file_size&&n.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-black bg-opacity-60 text-white text-xs px-2 py-0.5",children:[(Be.file_size/1024).toFixed(0)," KB"]})]},Be.id))})]})]})}),n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx(Zt,{className:"h-5 w-5 text-blue-600 flex-shrink-0 mt-0.5"}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h4",{className:"text-sm font-semibold text-blue-900 mb-2",children:"Recording Fixed Assets"}),n.jsxs("div",{className:"text-sm text-blue-800 space-y-2",children:[n.jsx("p",{children:n.jsx("strong",{children:"For Equipment/Asset Purchases:"})}),n.jsxs("ol",{className:"list-decimal list-inside space-y-1 ml-2",children:[n.jsx("li",{children:'Use category "Fixed Assets / Equipment"'}),n.jsx("li",{children:"Record the purchase here with full details"}),n.jsx("li",{children:'This creates a debit to "Fixed Assets" account'}),n.jsx("li",{children:"Assets are CAPITALIZED (not expensed immediately)"}),n.jsx("li",{children:"Later: Finance team will set up depreciation schedule"})]}),n.jsx("p",{className:"text-xs mt-2 bg-blue-100 p-2 rounded",children:" Examples: Computers, machinery, furniture, vehicles, AC units, shelving"})]})]})]})})]})}const H1=e=>{const t=new Date(e),r=t.getDate().toString().padStart(2,"0"),a=(t.getMonth()+1).toString().padStart(2,"0"),s=t.getFullYear().toString().slice(-2);return`${r}/${a}/${s}`};function nAe({canManage:e}){const[t,r]=Q.useState([]),[a,s]=Q.useState([]),[i,o]=Q.useState([]),[l,c]=Q.useState([]),[d,u]=Q.useState(!0),[f,h]=Q.useState(!1),[A,x]=Q.useState(null),[p,b]=Q.useState({transfer_date:new Date().toISOString().split("T")[0],from_amount:0,to_amount:0,from_account_type:"bank",to_account_type:"bank",from_bank_account_id:"",to_bank_account_id:"",from_bank_statement_line_id:"",to_bank_statement_line_id:"",description:""});Q.useEffect(()=>{m();const w=Z.channel("bank-statement-fund-transfer-changes").on("postgres_changes",{event:"*",schema:"public",table:"bank_statement_lines"},()=>{p.from_bank_account_id&&g(p.from_bank_account_id,"from",(A==null?void 0:A.from_bank_statement_line_id)||void 0),p.to_bank_account_id&&g(p.to_bank_account_id,"to",(A==null?void 0:A.to_bank_statement_line_id)||void 0)}).subscribe();return()=>{w.unsubscribe()}},[p.from_bank_account_id,p.to_bank_account_id]);const m=async()=>{var w;try{console.log("loadData: Starting to load fund transfers..."),u(!0);const[T,R]=await Promise.all([Z.from("vw_fund_transfers_detailed").select("*").order("transfer_date",{ascending:!1}).order("created_at",{ascending:!1}).limit(100),Z.from("bank_accounts").select("id, bank_name, account_number, alias, currency").eq("is_active",!0).order("bank_name")]);if(console.log("loadData: Transfers result:",(w=T.data)==null?void 0:w.length,"records"),T.error)throw T.error;if(R.error)throw R.error;r(T.data||[]),s(R.data||[])}catch(T){console.error("Error loading fund transfers:",T.message),alert("Failed to load fund transfers")}finally{u(!1)}},g=async(w,T,R)=>{if(!w){T==="from"?o([]):c([]);return}try{let q=Z.from("bank_statement_lines").select("id, transaction_date, description, debit_amount, credit_amount, reconciliation_status").eq("bank_account_id",w).is("matched_fund_transfer_id",null).is("matched_expense_id",null).is("matched_receipt_id",null).is("matched_petty_cash_id",null).is("matched_entry_id",null).order("transaction_date",{ascending:!1});const{data:z,error:ee}=await q;if(ee)throw ee;let Y=z||[];if(R){const{data:G}=await Z.from("bank_statement_lines").select("id, transaction_date, description, debit_amount, credit_amount, reconciliation_status").eq("id",R).single();G&&!Y.find(re=>re.id===G.id)&&(Y=[G,...Y])}T==="from"?o(Y):c(Y)}catch(q){console.error("Error loading bank statements:",q)}},y=()=>{if(p.from_account_type==="bank"&&p.from_bank_account_id){const w=a.find(T=>T.id===p.from_bank_account_id);return(w==null?void 0:w.currency)||"IDR"}return"IDR"},v=()=>{if(p.to_account_type==="bank"&&p.to_bank_account_id){const w=a.find(T=>T.id===p.to_bank_account_id);return(w==null?void 0:w.currency)||"IDR"}return"IDR"},_=()=>{const w=y(),T=v();return p.from_amount>0&&p.to_amount>0&&w!==T?p.to_amount/p.from_amount:null},j=async w=>{if(w.preventDefault(),p.from_amount<=0){alert("From Amount must be greater than 0");return}if(p.to_amount<=0){alert("To Amount must be greater than 0");return}if(p.from_account_type===p.to_account_type)if(p.from_account_type==="bank"){if(p.from_bank_account_id===p.to_bank_account_id){alert("Cannot transfer to the same bank account");return}}else{alert("Cannot transfer to the same account type");return}if(p.from_account_type==="bank"&&!p.from_bank_account_id){alert("Please select source bank account");return}if(p.to_account_type==="bank"&&!p.to_bank_account_id){alert("Please select destination bank account");return}try{const{data:{user:T}}=await Z.auth.getUser();if(!T)throw new Error("Not authenticated");const R=_();if(A){const q={transfer_date:p.transfer_date,amount:p.from_amount,from_amount:p.from_amount,to_amount:p.to_amount,exchange_rate:R,from_account_type:p.from_account_type,to_account_type:p.to_account_type,description:p.description||null,from_bank_account_id:p.from_account_type==="bank"?p.from_bank_account_id:null,to_bank_account_id:p.to_account_type==="bank"?p.to_bank_account_id:null,from_bank_statement_line_id:p.from_bank_statement_line_id||null,to_bank_statement_line_id:p.to_bank_statement_line_id||null};console.log("Updating fund transfer:",A.id,q);const{data:z,error:ee}=await Z.from("fund_transfers").update(q).eq("id",A.id).select();if(console.log("Update result:",{updatedData:z,error:ee}),ee)throw ee;alert("Fund transfer updated successfully!")}else{const{data:q,error:z}=await Z.rpc("generate_fund_transfer_number");if(z)throw z;const ee={transfer_number:q,transfer_date:p.transfer_date,amount:p.from_amount,from_amount:p.from_amount,to_amount:p.to_amount,exchange_rate:R,from_account_type:p.from_account_type,to_account_type:p.to_account_type,description:p.description||null,created_by:T.id};p.from_account_type==="bank"&&(ee.from_bank_account_id=p.from_bank_account_id),p.to_account_type==="bank"&&(ee.to_bank_account_id=p.to_bank_account_id),p.from_bank_statement_line_id&&(ee.from_bank_statement_line_id=p.from_bank_statement_line_id),p.to_bank_statement_line_id&&(ee.to_bank_statement_line_id=p.to_bank_statement_line_id);const{data:Y,error:G}=await Z.from("fund_transfers").insert([ee]).select().single();if(G)throw G;if(p.to_account_type==="petty_cash"&&Y){const re="PCW",U=new Date().getFullYear().toString().slice(-2),S=(new Date().getMonth()+1).toString().padStart(2,"0"),{count:D}=await Z.from("petty_cash_transactions").select("*",{count:"exact",head:!0}).like("transaction_number",`${re}${U}${S}%`),L=`${re}${U}${S}-${String((D||0)+1).padStart(4,"0")}`;let P="Bank";if(p.from_account_type==="bank"&&p.from_bank_account_id){const H=a.find(V=>V.id===p.from_bank_account_id);P=(H==null?void 0:H.alias)||(H==null?void 0:H.bank_name)||"Bank"}const{error:I}=await Z.from("petty_cash_transactions").insert([{transaction_number:L,transaction_date:p.transfer_date,transaction_type:"withdraw",amount:p.to_amount,description:p.description||`Fund transfer from ${P}`,bank_account_id:p.from_account_type==="bank"?p.from_bank_account_id:null,source:`Fund Transfer ${q}`,fund_transfer_id:Y.id,created_by:T.id}]);I?(console.error("Error creating petty cash transaction:",I),alert("Warning: Fund transfer created but petty cash entry failed: "+I.message)):console.log("Petty cash transaction created successfully:",L)}p.from_bank_statement_line_id&&Y&&await Z.from("bank_statement_lines").update({matched_fund_transfer_id:Y.id,reconciliation_status:"matched",matched_at:new Date().toISOString(),matched_by:T.id,notes:`Linked to Fund Transfer ${q}`}).eq("id",p.from_bank_statement_line_id),p.to_bank_statement_line_id&&Y&&await Z.from("bank_statement_lines").update({matched_fund_transfer_id:Y.id,reconciliation_status:"matched",matched_at:new Date().toISOString(),matched_by:T.id,notes:`Linked to Fund Transfer ${q}`}).eq("id",p.to_bank_statement_line_id),alert("Fund transfer created and posted successfully!")}h(!1),N(),m()}catch(T){console.error("Error with fund transfer:",T.message),alert("Failed to save fund transfer: "+T.message)}},N=()=>{b({transfer_date:new Date().toISOString().split("T")[0],from_amount:0,to_amount:0,from_account_type:"bank",to_account_type:"bank",from_bank_account_id:"",to_bank_account_id:"",from_bank_statement_line_id:"",to_bank_statement_line_id:"",description:""}),o([]),c([]),x(null)},B=async w=>{x(w),b({transfer_date:w.transfer_date,from_amount:w.from_amount,to_amount:w.to_amount,from_account_type:w.from_account_type,to_account_type:w.to_account_type,from_bank_account_id:w.from_bank_account_id||"",to_bank_account_id:w.to_bank_account_id||"",from_bank_statement_line_id:w.from_bank_statement_line_id||"",to_bank_statement_line_id:w.to_bank_statement_line_id||"",description:w.description||""}),w.from_bank_account_id&&g(w.from_bank_account_id,"from",w.from_bank_statement_line_id||void 0),w.to_bank_account_id&&g(w.to_bank_account_id,"to",w.to_bank_statement_line_id||void 0),h(!0)},E=async w=>{if(confirm("Are you sure you want to delete this fund transfer? This will also delete the associated petty cash transaction and journal entry."))try{const{error:T}=await Z.from("petty_cash_transactions").delete().eq("fund_transfer_id",w);T&&console.error("Error deleting petty cash transaction:",T),await Z.from("bank_statement_lines").update({matched_fund_transfer_id:null,reconciliation_status:"unmatched",matched_at:null,matched_by:null,notes:null}).eq("matched_fund_transfer_id",w);const{error:R}=await Z.from("fund_transfers").delete().eq("id",w);if(R)throw R;alert("Fund transfer deleted successfully!"),m()}catch(T){console.error("Error deleting fund transfer:",T.message),alert("Failed to delete fund transfer: "+T.message)}},C=w=>{switch(w){case"petty_cash":return"Petty Cash";case"cash_on_hand":return"Cash on Hand";case"bank":return"Bank Account";default:return w}},k=w=>{switch(w){case"posted":return n.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium text-green-700 bg-green-50 border border-green-200 rounded",children:[n.jsx(Zr,{className:"w-3 h-3"}),"Posted"]});case"pending":return n.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium text-yellow-700 bg-yellow-50 border border-yellow-200 rounded",children:[n.jsx(da,{className:"w-3 h-3"}),"Pending"]});default:return n.jsx("span",{className:"text-xs text-gray-500",children:w})}};return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Fund Transfers"}),n.jsx("p",{className:"text-sm text-gray-600",children:"Transfer funds between accounts"})]}),e&&n.jsxs("button",{onClick:()=>{N(),h(!0)},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[n.jsx(Pr,{className:"w-4 h-4"}),"New Transfer"]})]}),n.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Transfer #"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"From"}),n.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:""}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"To"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Description"}),n.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Amount"}),n.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Status"}),e&&n.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:d?n.jsx("tr",{children:n.jsx("td",{colSpan:e?9:8,className:"px-6 py-8 text-center text-gray-500",children:"Loading..."})}):t.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:e?9:8,className:"px-6 py-8 text-center text-gray-500",children:"No fund transfers found"})}):t.map(w=>n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:H1(w.transfer_date)}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap font-mono text-sm text-gray-900",children:w.transfer_number}),n.jsxs("td",{className:"px-6 py-4 text-sm text-gray-900",children:[n.jsx("div",{className:"font-medium",children:w.from_account_name}),n.jsx("div",{className:"text-xs text-gray-500",children:C(w.from_account_type)})]}),n.jsx("td",{className:"px-6 py-4 text-center",children:n.jsx(x5,{className:"w-4 h-4 text-blue-600 inline"})}),n.jsxs("td",{className:"px-6 py-4 text-sm text-gray-900",children:[n.jsx("div",{className:"font-medium",children:w.to_account_name}),n.jsx("div",{className:"text-xs text-gray-500",children:C(w.to_account_type)})]}),n.jsx("td",{className:"px-6 py-4 text-sm text-gray-700",children:w.description||"-"}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium text-gray-900",children:w.from_currency===w.to_currency?n.jsxs("div",{children:[w.from_currency==="USD"?"$":"Rp"," ",w.from_amount.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]}):n.jsxs("div",{className:"space-y-1",children:[n.jsxs("div",{className:"text-red-600",children:[w.from_currency==="USD"?"$":"Rp"," ",w.from_amount.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]}),n.jsx("div",{className:"text-xs text-gray-500",children:""}),n.jsxs("div",{className:"text-green-600",children:[w.to_currency==="USD"?"$":"Rp"," ",w.to_amount.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]}),w.exchange_rate&&n.jsxs("div",{className:"text-xs text-gray-500",children:["Rate: ",w.exchange_rate.toFixed(6)]})]})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:k(w.status)}),e&&n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:n.jsxs("div",{className:"flex items-center justify-center gap-2",children:[n.jsx("button",{onClick:()=>B(w),className:"text-blue-600 hover:text-blue-800",title:"Edit Transfer",children:n.jsx(Aa,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>E(w.id),className:"text-red-600 hover:text-red-800",title:"Delete Transfer",children:n.jsx(Lr,{className:"w-4 h-4"})})]})})]},w.id))})]})}),f&&n.jsx(Ot,{isOpen:f,onClose:()=>{h(!1),N()},title:A?"Edit Fund Transfer":"New Fund Transfer",maxWidth:"max-w-2xl",children:n.jsxs("form",{onSubmit:j,className:"space-y-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Transfer Date ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"date",value:p.transfer_date,onChange:w=>b({...p,transfer_date:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0})]}),n.jsxs("div",{className:"border-2 border-blue-200 rounded-lg p-4 bg-blue-50",children:[n.jsx("h3",{className:"text-sm font-semibold text-blue-900 mb-3",children:"From (Source Account)"}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Account Type ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("select",{value:p.from_account_type,onChange:w=>b({...p,from_account_type:w.target.value,from_bank_account_id:w.target.value==="bank"?p.from_bank_account_id:""}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0,children:[n.jsx("option",{value:"bank",children:"Bank Account"}),n.jsx("option",{value:"cash_on_hand",children:"Cash on Hand"}),n.jsx("option",{value:"petty_cash",children:"Petty Cash"})]})]}),p.from_account_type==="bank"&&n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Bank Account ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("select",{value:p.from_bank_account_id,onChange:w=>{b({...p,from_bank_account_id:w.target.value,from_bank_statement_line_id:""}),g(w.target.value,"from")},className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0,children:[n.jsx("option",{value:"",children:"Select Bank Account"}),a.map(w=>n.jsxs("option",{value:w.id,children:[w.alias||w.bank_name," - ",w.account_number," (",w.currency,")"]},w.id))]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Amount (",y(),") ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"number",step:"0.01",value:p.from_amount||"",onChange:w=>{const T=parseFloat(w.target.value)||0,R=y(),q=v();b(R===q?{...p,from_amount:T,to_amount:T}:{...p,from_amount:T})},className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0,min:"0.01"})]}),p.from_bank_account_id&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" Link to Bank Statement (Optional)"}),i.length>0?n.jsxs(n.Fragment,{children:[n.jsxs("select",{value:p.from_bank_statement_line_id,onChange:w=>b({...p,from_bank_statement_line_id:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[n.jsx("option",{value:"",children:"No link"}),i.map(w=>{var T;return n.jsxs("option",{value:w.id,children:[H1(w.transaction_date)," - ",(T=w.description)==null?void 0:T.substring(0,40)," -",y()==="USD"?"$":"Rp"," ",(w.debit_amount||w.credit_amount||0).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]},w.id)})]}),n.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:[i.length," unlinked transaction",i.length!==1?"s":""," available"]})]}):n.jsx("div",{className:"text-sm text-gray-500 italic py-2 px-3 bg-gray-50 rounded-lg border border-gray-200",children:"No unlinked transactions available"})]})]})]}),n.jsx("div",{className:"flex justify-center",children:n.jsx(x5,{className:"w-6 h-6 text-gray-400"})}),n.jsxs("div",{className:"border-2 border-green-200 rounded-lg p-4 bg-green-50",children:[n.jsx("h3",{className:"text-sm font-semibold text-green-900 mb-3",children:"To (Destination Account)"}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Account Type ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("select",{value:p.to_account_type,onChange:w=>b({...p,to_account_type:w.target.value,to_bank_account_id:w.target.value==="bank"?p.to_bank_account_id:""}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0,children:[n.jsx("option",{value:"petty_cash",children:"Petty Cash"}),n.jsx("option",{value:"cash_on_hand",children:"Cash on Hand"}),n.jsx("option",{value:"bank",children:"Bank Account"})]})]}),p.to_account_type==="bank"&&n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Bank Account ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("select",{value:p.to_bank_account_id,onChange:w=>{b({...p,to_bank_account_id:w.target.value,to_bank_statement_line_id:""}),g(w.target.value,"to")},className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0,children:[n.jsx("option",{value:"",children:"Select Bank Account"}),a.map(w=>n.jsxs("option",{value:w.id,children:[w.alias||w.bank_name," - ",w.account_number," (",w.currency,")"]},w.id))]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Amount (",v(),") ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"number",step:"0.01",value:p.to_amount||"",onChange:w=>b({...p,to_amount:parseFloat(w.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0,min:"0.01"}),y()!==v()&&p.from_amount>0&&p.to_amount>0&&n.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Exchange Rate: 1 USD = ",(y()==="USD"?p.to_amount/p.from_amount:p.from_amount/p.to_amount).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})," IDR"]})]}),p.to_bank_account_id&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" Link to Bank Statement (Optional)"}),l.length>0?n.jsxs(n.Fragment,{children:[n.jsxs("select",{value:p.to_bank_statement_line_id,onChange:w=>b({...p,to_bank_statement_line_id:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[n.jsx("option",{value:"",children:"No link"}),l.map(w=>{var T;return n.jsxs("option",{value:w.id,children:[H1(w.transaction_date)," - ",(T=w.description)==null?void 0:T.substring(0,40)," -",v()==="USD"?"$":"Rp"," ",(w.debit_amount||w.credit_amount||0).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]},w.id)})]}),n.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:[l.length," unlinked transaction",l.length!==1?"s":""," available"]})]}):n.jsx("div",{className:"text-sm text-gray-500 italic py-2 px-3 bg-gray-50 rounded-lg border border-gray-200",children:"No unlinked transactions available"})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),n.jsx("textarea",{value:p.description,onChange:w=>b({...p,description:w.target.value}),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"Purpose of transfer (optional)"})]}),n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:n.jsxs("p",{className:"text-sm text-blue-800",children:[n.jsx("strong",{children:"Note:"})," The journal entry will be posted automatically when you create this transfer. Both accounts will be updated immediately."]})}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[n.jsx("button",{type:"button",onClick:()=>{h(!1),N()},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),n.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Create Transfer"})]})]})})]})}const aAe={sales_invoice:"Sales Invoice",sales_invoice_cogs:"COGS Entry",purchase_invoice:"Purchase Invoice",receipt:"Receipt Voucher",payment:"Payment Voucher",petty_cash:"Petty Cash",fund_transfer:"Fund Transfer",manual:"Manual Entry"};function sAe({canManage:e}){const{dateRange:t}=rl(),[r,a]=Q.useState([]),[s,i]=Q.useState(!0),[o,l]=Q.useState(""),[c,d]=Q.useState(null),[u,f]=Q.useState([]),[h,A]=Q.useState(!1),[x,p]=Q.useState("all");Q.useEffect(()=>{b()},[t,x]);const b=async()=>{try{i(!0);let _=Z.from("journal_voucher_view").select("*").gte("date",t.startDate).lte("date",t.endDate);x!=="all"&&(_=_.eq("source_module",x));const{data:j,error:N}=await _;if(N)throw N;a(j||[])}catch(_){console.error("Error loading voucher journal:",_)}finally{i(!1)}},m=async _=>{try{const{data:j,error:N}=await Z.from("journal_entry_lines").select("*, chart_of_accounts(code, name), customers(company_name), suppliers(company_name)").eq("journal_entry_id",_).order("line_number");if(N)throw N;f(j||[])}catch(j){console.error("Error loading lines:",j)}},g=async _=>{try{const{data:j,error:N}=await Z.from("journal_entries").select("*").eq("id",_.journal_entry_id).single();if(N)throw N;d(j),await m(_.journal_entry_id),A(!0)}catch(j){console.error("Error loading voucher details:",j)}},y=r.filter(_=>_.voucher_no.toLowerCase().includes(o.toLowerCase())||_.debit_account&&_.debit_account.toLowerCase().includes(o.toLowerCase())||_.credit_account&&_.credit_account.toLowerCase().includes(o.toLowerCase())||_.narration&&_.narration.toLowerCase().includes(o.toLowerCase())||_.reference_number&&_.reference_number.toLowerCase().includes(o.toLowerCase())),v={debit:y.reduce((_,j)=>_+j.amount,0),credit:y.reduce((_,j)=>_+j.amount,0)};return s?n.jsx("div",{className:"flex justify-center py-8",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[n.jsxs("div",{className:"relative flex-1 min-w-[200px]",children:[n.jsx(Ca,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),n.jsx("input",{type:"text",placeholder:"Search voucher, accounts, narration...",value:o,onChange:_=>l(_.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg"})]}),n.jsxs("select",{value:x,onChange:_=>p(_.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg",children:[n.jsx("option",{value:"all",children:"All Sources"}),n.jsx("option",{value:"sales_invoice",children:"Sales Invoices"}),n.jsx("option",{value:"sales_invoice_cogs",children:"COGS"}),n.jsx("option",{value:"purchase_invoice",children:"Purchase Invoices"}),n.jsx("option",{value:"receipt",children:"Receipts"}),n.jsx("option",{value:"payment",children:"Payments"}),n.jsx("option",{value:"petty_cash",children:"Petty Cash"}),n.jsx("option",{value:"fund_transfer",children:"Fund Transfers"}),n.jsx("option",{value:"manual",children:"Manual"})]})]}),n.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full text-sm",children:[n.jsx("thead",{className:"bg-gray-50 sticky top-0",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-r",children:"Date"}),n.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-r",children:"Journal No"}),n.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-r",children:"Type"}),n.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-r",children:"Debit Account"}),n.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-r",children:"Credit Account"}),n.jsx("th",{className:"px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider border-r",children:"Amount"}),n.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-r",children:"Narration"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Details"})]})}),n.jsxs("tbody",{className:"divide-y divide-gray-200 bg-white",children:[y.map(_=>n.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-gray-900 border-r",children:new Date(_.date).toLocaleDateString("id-ID",{day:"2-digit",month:"2-digit",year:"numeric"})}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap font-mono text-blue-600 border-r",children:_.voucher_no}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap border-r",children:n.jsx("span",{className:"px-2 py-1 text-xs bg-gray-100 text-gray-700 rounded",children:_.voucher_type})}),n.jsx("td",{className:"px-3 py-2 border-r",children:n.jsx("div",{className:"text-xs text-gray-900 max-w-xs truncate",children:_.debit_account||"-"})}),n.jsx("td",{className:"px-3 py-2 border-r",children:n.jsx("div",{className:"text-xs text-gray-900 max-w-xs truncate",children:_.credit_account||"-"})}),n.jsx("td",{className:"px-3 py-2 text-right whitespace-nowrap border-r",children:n.jsxs("span",{className:"text-gray-900 font-medium",children:["Rp ",_.amount.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})}),n.jsx("td",{className:"px-3 py-2 text-gray-600 text-xs border-r",children:n.jsx("div",{className:"max-w-md truncate",children:_.narration||"-"})}),n.jsx("td",{className:"px-3 py-2 text-center",children:_.is_multi_line&&n.jsx("button",{onClick:()=>g(_),className:"text-blue-600 hover:text-blue-800",title:"View detailed breakdown",children:n.jsx(Zt,{className:"w-4 h-4"})})})]},_.journal_entry_id)),y.length===0&&n.jsx("tr",{children:n.jsx("td",{colSpan:8,className:"px-4 py-8 text-center text-gray-500",children:"No journal entries found"})})]}),n.jsx("tfoot",{className:"bg-gray-50 font-bold",children:n.jsxs("tr",{children:[n.jsx("td",{colSpan:5,className:"px-3 py-2 text-right",children:"Total:"}),n.jsxs("td",{className:"px-3 py-2 text-right text-gray-900 border-r",children:["Rp ",v.debit.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]}),n.jsx("td",{colSpan:2})]})})]})})}),n.jsx(Ot,{isOpen:h,onClose:()=>A(!1),title:`Journal Entry: ${c==null?void 0:c.entry_number}`,children:c&&n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-500",children:"Date:"}),n.jsx("span",{className:"ml-2 font-medium",children:new Date(c.entry_date).toLocaleDateString("id-ID")})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-500",children:"Source:"}),n.jsx("span",{className:"ml-2",children:c.source_module?aAe[c.source_module]:"Manual"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-500",children:"Reference:"}),n.jsx("span",{className:"ml-2 font-mono",children:c.reference_number||"-"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-500",children:"Posted:"}),n.jsx("span",{className:"ml-2",children:new Date(c.posted_at).toLocaleString("id-ID")})]})]}),c.description&&n.jsx("div",{className:"p-3 bg-gray-50 rounded-lg text-sm",children:c.description}),n.jsx("div",{className:"border rounded-lg overflow-hidden",children:n.jsxs("table",{className:"w-full text-sm",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-3 py-2 text-left",children:"Account"}),n.jsx("th",{className:"px-3 py-2 text-left",children:"Description"}),n.jsx("th",{className:"px-3 py-2 text-right",children:"Debit"}),n.jsx("th",{className:"px-3 py-2 text-right",children:"Credit"})]})}),n.jsx("tbody",{className:"divide-y",children:u.map(_=>{var j,N;return n.jsxs("tr",{children:[n.jsxs("td",{className:"px-3 py-2",children:[n.jsx("div",{className:"font-mono text-xs text-gray-500",children:(j=_.chart_of_accounts)==null?void 0:j.code}),n.jsx("div",{children:(N=_.chart_of_accounts)==null?void 0:N.name}),_.customers&&n.jsx("div",{className:"text-xs text-blue-600",children:_.customers.company_name}),_.suppliers&&n.jsx("div",{className:"text-xs text-purple-600",children:_.suppliers.company_name})]}),n.jsx("td",{className:"px-3 py-2 text-gray-600",children:_.description||"-"}),n.jsx("td",{className:"px-3 py-2 text-right text-blue-600",children:_.debit>0?`Rp ${_.debit.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})}`:""}),n.jsx("td",{className:"px-3 py-2 text-right text-green-600",children:_.credit>0?`Rp ${_.credit.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})}`:""})]},_.id)})}),n.jsx("tfoot",{className:"bg-gray-50 font-medium",children:n.jsxs("tr",{children:[n.jsx("td",{colSpan:2,className:"px-3 py-2 text-right",children:"Total:"}),n.jsxs("td",{className:"px-3 py-2 text-right text-blue-700",children:["Rp ",c.total_debit.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]}),n.jsxs("td",{className:"px-3 py-2 text-right text-green-700",children:["Rp ",c.total_credit.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})})]})}),c.total_debit!==c.total_credit&&n.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:"Warning: Debit and Credit totals do not match!"})]})})]})}function iAe(){const{dateRange:e}=rl(),[t,r]=Q.useState([]),[a,s]=Q.useState(null),[i,o]=Q.useState([]),[l,c]=Q.useState(0),[d,u]=Q.useState(!0),[f,h]=Q.useState("");Q.useEffect(()=>{A()},[]),Q.useEffect(()=>{a&&x()},[a,e]);const A=async()=>{try{const{data:y,error:v}=await Z.from("chart_of_accounts").select("*").eq("is_active",!0).eq("is_header",!1).order("code");if(v)throw v;r(y||[])}catch(y){console.error("Error loading accounts:",y)}finally{u(!1)}},x=async()=>{if(a)try{u(!0);const{data:y,error:v}=await Z.from("journal_entry_lines").select("debit, credit, journal_entries!inner(entry_date)").eq("account_id",a.id).lt("journal_entries.entry_date",e.startDate);if(v)throw v;let _=0;y==null||y.forEach(k=>{a.normal_balance==="debit"?_+=k.debit-k.credit:_+=k.credit-k.debit}),c(_);const{data:j,error:N}=await Z.from("journal_entry_lines").select(`
          *,
          journal_entries!inner(
            id,
            entry_number,
            entry_date,
            source_module,
            reference_number
          )
        `).eq("account_id",a.id).gte("journal_entries.entry_date",e.startDate).lte("journal_entries.entry_date",e.endDate).order("line_number");if(N)throw console.error("Error loading ledger:",N),N;const B=(j||[]).sort((k,w)=>{const T=new Date(k.journal_entries.entry_date).getTime(),R=new Date(w.journal_entries.entry_date).getTime();return T!==R?T-R:k.line_number-w.line_number});let E=_;const C=B.map(k=>{const w=k.journal_entries;return a.normal_balance==="debit"?E+=k.debit-k.credit:E+=k.credit-k.debit,{id:k.id,line_number:k.line_number,journal_entry_id:w.id,entry_date:w.entry_date,entry_number:w.entry_number,source_module:w.source_module,reference_number:w.reference_number,description:k.description,debit:k.debit,credit:k.credit,balance:E}});o(C)}catch(y){console.error("Error loading ledger:",y)}finally{u(!1)}},p=()=>{window.print()},b=t.filter(y=>y.code.toLowerCase().includes(f.toLowerCase())||y.name.toLowerCase().includes(f.toLowerCase())),m=i.length>0?i[i.length-1].balance:l,g=i.reduce((y,v)=>({debit:y.debit+v.debit,credit:y.credit+v.credit}),{debit:0,credit:0});return n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("div",{className:"relative flex-1",children:[n.jsx(Ca,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),n.jsx("input",{type:"text",placeholder:"Search account by code or name...",value:f,onChange:y=>h(y.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg"})]}),n.jsxs("select",{value:(a==null?void 0:a.id)||"",onChange:y=>{const v=t.find(_=>_.id===y.target.value);s(v||null)},className:"px-4 py-2 border border-gray-300 rounded-lg min-w-[300px]",children:[n.jsx("option",{value:"",children:"Select Account..."}),b.map(y=>n.jsxs("option",{value:y.id,children:[y.code," - ",y.name]},y.id))]}),a&&n.jsxs("button",{onClick:p,className:"flex items-center gap-2 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700",children:[n.jsx($l,{className:"w-4 h-4"}),"Print"]})]}),!a&&n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6 text-center",children:[n.jsx("p",{className:"text-blue-800 font-medium mb-2",children:"Select an account to view its ledger"}),n.jsx("p",{className:"text-blue-600 text-sm mb-4",children:"Use the dropdown above to choose an account, or search by code or name."}),n.jsxs("div",{className:"bg-white border border-blue-200 rounded p-3 text-left max-w-md mx-auto",children:[n.jsxs("p",{className:"text-sm text-gray-700 mb-1",children:[n.jsx("span",{className:"font-semibold",children:"Tip:"})," To view all journal entries across all accounts:"]}),n.jsxs("p",{className:"text-sm text-blue-700",children:["Go to ",n.jsx("span",{className:"font-mono bg-blue-100 px-2 py-0.5 rounded",children:"Journal Register"})," in the Books menu (Ctrl+J)"]})]})]}),a&&n.jsx(n.Fragment,{children:n.jsxs("div",{className:"bg-white border rounded-lg p-4 print:border-0",children:[n.jsxs("div",{className:"text-center mb-4",children:[n.jsx("h2",{className:"text-xl font-bold",children:"Account Ledger"}),n.jsxs("h3",{className:"text-lg font-medium mt-1",children:[a.code," - ",a.name]}),n.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Period: ",new Date(e.startDate).toLocaleDateString("id-ID")," to ",new Date(e.endDate).toLocaleDateString("id-ID")]})]}),n.jsxs("div",{className:"flex justify-between items-center py-2 border-t border-b font-medium bg-gray-50 px-3",children:[n.jsx("span",{children:"Opening Balance:"}),n.jsxs("span",{className:l>=0?"text-green-600":"text-red-600",children:["Rp ",Math.abs(l).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2}),l<0&&" (Cr)"]})]}),n.jsx("div",{className:"mt-4 overflow-x-auto",children:n.jsxs("table",{className:"w-full text-sm",children:[n.jsx("thead",{className:"bg-gray-50 border-b-2 border-gray-200",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-700 uppercase",children:"Date"}),n.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-700 uppercase",children:"Voucher No"}),n.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-700 uppercase",children:"Type"}),n.jsx("th",{className:"px-3 py-2 text-right text-xs font-medium text-gray-700 uppercase",children:"Debit"}),n.jsx("th",{className:"px-3 py-2 text-right text-xs font-medium text-gray-700 uppercase",children:"Credit"}),n.jsx("th",{className:"px-3 py-2 text-right text-xs font-medium text-gray-700 uppercase",children:"Balance"}),n.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-700 uppercase",children:"Narration"})]})}),n.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:i.map(y=>n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:new Date(y.entry_date).toLocaleDateString("id-ID",{day:"2-digit",month:"2-digit",year:"numeric"})}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap font-mono text-blue-600",children:y.entry_number}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:n.jsx("span",{className:"px-2 py-1 text-xs bg-gray-100 rounded",children:y.source_module||"Manual"})}),n.jsx("td",{className:"px-3 py-2 text-right whitespace-nowrap text-blue-600",children:y.debit>0?`Rp ${y.debit.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})}`:""}),n.jsx("td",{className:"px-3 py-2 text-right whitespace-nowrap text-green-600",children:y.credit>0?`Rp ${y.credit.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})}`:""}),n.jsx("td",{className:"px-3 py-2 text-right whitespace-nowrap font-medium",children:n.jsxs("span",{className:y.balance>=0?"text-green-600":"text-red-600",children:["Rp ",Math.abs(y.balance).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})}),n.jsx("td",{className:"px-3 py-2 text-gray-600 text-xs max-w-xs truncate",children:y.description||y.reference_number||"-"})]},y.id))}),n.jsxs("tfoot",{className:"bg-gray-50 border-t-2 border-gray-200 font-bold",children:[n.jsxs("tr",{children:[n.jsx("td",{colSpan:3,className:"px-3 py-2 text-right",children:"Total:"}),n.jsxs("td",{className:"px-3 py-2 text-right text-blue-700",children:["Rp ",g.debit.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]}),n.jsxs("td",{className:"px-3 py-2 text-right text-green-700",children:["Rp ",g.credit.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]}),n.jsx("td",{colSpan:2})]}),n.jsxs("tr",{children:[n.jsx("td",{colSpan:5,className:"px-3 py-2 text-right",children:"Closing Balance:"}),n.jsx("td",{className:"px-3 py-2 text-right",children:n.jsxs("span",{className:m>=0?"text-green-700":"text-red-700",children:["Rp ",Math.abs(m).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2}),m<0&&" (Cr)"]})}),n.jsx("td",{})]})]})]})}),i.length===0&&!d&&n.jsx("div",{className:"text-center py-8 text-gray-500",children:"No transactions found for this account in the selected period."})]})}),!a&&!d&&n.jsxs("div",{className:"text-center py-12 text-gray-500 bg-white rounded-lg border",children:[n.jsx(oAe,{className:"w-12 h-12 mx-auto text-gray-300 mb-3"}),n.jsx("p",{children:"Select an account to view its ledger"})]})]})}function oAe(e){return n.jsx("svg",{...e,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})}function lAe(){const{dateRange:e}=rl(),t=Q.useRef(null),[r,a]=Q.useState("customer"),[s,i]=Q.useState([]),[o,l]=Q.useState(""),[c,d]=Q.useState([]),[u,f]=Q.useState(!1),[h,A]=Q.useState(0),[x,p]=Q.useState(!1);Q.useEffect(()=>{b()},[r]),Q.useEffect(()=>{o?m():(d([]),A(0))},[o,e.startDate,e.endDate]);const b=async()=>{const k=r==="customer"?"customers":"suppliers",{data:w}=await Z.from(k).select("id, company_name, email, phone, address, city, npwp").order("company_name");w&&i(w.map(T=>({...T,name:T.company_name,type:r}))),l("")},m=async()=>{if(o){f(!0);try{const k=[];if(r==="customer"){const{data:T}=await Z.from("sales_invoices").select("id, invoice_date, invoice_number, total_amount, payment_status").eq("customer_id",o).gte("invoice_date",e.startDate).lte("invoice_date",e.endDate).order("invoice_date");T&&T.forEach(z=>{k.push({id:z.id,entry_date:z.invoice_date,particulars:`Sales Invoice - ${z.payment_status||"Unpaid"}`,reference:z.invoice_number,debit:z.total_amount,credit:0,running_balance:0,type:"invoice"})});const{data:R}=await Z.from("receipt_vouchers").select("id, voucher_date, voucher_number, amount, description").eq("customer_id",o).gte("voucher_date",e.startDate).lte("voucher_date",e.endDate).order("voucher_date");R&&R.forEach(z=>{k.push({id:z.id,entry_date:z.voucher_date,particulars:z.description||"Receipt",reference:z.voucher_number,debit:0,credit:z.amount,running_balance:0,type:"receipt"})});const{data:q}=await Z.from("credit_notes").select("id, credit_note_date, credit_note_number, total_amount").eq("customer_id",o).gte("credit_note_date",e.startDate).lte("credit_note_date",e.endDate).eq("status","approved").order("credit_note_date");q&&q.forEach(z=>{k.push({id:z.id,entry_date:z.credit_note_date,particulars:"Credit Note",reference:z.credit_note_number,debit:0,credit:z.total_amount,running_balance:0,type:"receipt"})})}else{const{data:T}=await Z.from("purchase_invoices").select("id, invoice_date, invoice_number, total_amount, payment_status").eq("supplier_id",o).gte("invoice_date",e.startDate).lte("invoice_date",e.endDate).order("invoice_date");T&&T.forEach(q=>{k.push({id:q.id,entry_date:q.invoice_date,particulars:`Purchase Invoice - ${q.payment_status||"Unpaid"}`,reference:q.invoice_number,debit:0,credit:q.total_amount,running_balance:0,type:"invoice"})});const{data:R}=await Z.from("payment_vouchers").select("id, voucher_date, voucher_number, amount, description").eq("supplier_id",o).gte("voucher_date",e.startDate).lte("voucher_date",e.endDate).order("voucher_date");R&&R.forEach(q=>{k.push({id:q.id,entry_date:q.voucher_date,particulars:q.description||"Payment",reference:q.voucher_number,debit:q.amount,credit:0,running_balance:0,type:"payment"})})}k.sort((T,R)=>new Date(T.entry_date).getTime()-new Date(R.entry_date).getTime());let w=h;k.forEach(T=>{w+=T.debit-T.credit,T.running_balance=w}),d(k)}catch(k){console.error("Error loading ledger:",k),alert("Failed to load ledger data. Please check console for details.")}finally{f(!1)}}},g=k=>k===0?"-":`Rp ${k.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})}`,y=k=>{const w=Math.abs(k),T=k>=0?"Dr":"Cr";return`${g(w)} ${T}`},v=c.reduce((k,w)=>k+w.debit,0),_=c.reduce((k,w)=>k+w.credit,0),j=h+v-_,N=Math.abs(j),B=async()=>{if(t.current)try{const k=await Zo(t.current,{scale:2,useCORS:!0,allowTaint:!0,logging:!1,backgroundColor:"#ffffff"}),w=k.toDataURL("image/png",1),T=new Ut("p","mm","a4"),R=T.internal.pageSize.getWidth(),q=T.internal.pageSize.getHeight(),z=k.width,ee=k.height,Y=R/z,G=ee*Y;if(G>q){let U=0,S=G;for(;S>0;)T.addImage(w,"PNG",0,U,R,G),S-=q,U-=q,S>0&&T.addPage()}else T.addImage(w,"PNG",0,0,R,G);const re=s.find(U=>U.id===o);T.save(`${r}_Ledger_${re==null?void 0:re.name.replace(/\s+/g,"_")}_${new Date().toISOString().split("T")[0]}.pdf`)}catch(k){console.error("Error generating PDF:",k),alert("Failed to generate PDF. Please try again.")}},E=async()=>{const k=s.find(w=>w.id===o);if(!k||!k.email){alert("No email address found for this party");return}confirm(`Send Statement of Account to ${k.email}?`)&&(p(!0),await B(),alert(`PDF downloaded. Please attach and send to ${k.email}`),p(!1))},C=s.find(k=>k.id===o);return n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[r==="customer"?n.jsx(vo,{className:"w-5 h-5 text-blue-600"}):n.jsx(_n,{className:"w-5 h-5 text-purple-600"}),n.jsxs("h2",{className:"text-xl font-semibold text-gray-800",children:[r==="customer"?"Customer":"Supplier"," Ledger"]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("button",{onClick:m,disabled:!o||u,className:"flex items-center gap-2 px-3 py-1.5 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[n.jsx(Hs,{className:`w-4 h-4 ${u?"animate-spin":""}`}),"Refresh"]}),n.jsxs("button",{onClick:B,disabled:!o||c.length===0,className:"flex items-center gap-2 px-3 py-1.5 bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[n.jsx(Zn,{className:"w-4 h-4"}),"Export PDF"]}),n.jsxs("button",{onClick:E,disabled:!o||c.length===0||x,className:"flex items-center gap-2 px-3 py-1.5 bg-purple-600 text-white rounded hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[n.jsx(ua,{className:"w-4 h-4"}),x?"Sending...":"Email SOA"]})]})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Party Type"}),n.jsxs("select",{value:r,onChange:k=>{a(k.target.value),l("")},className:"w-full px-3 py-2 border rounded-lg",children:[n.jsx("option",{value:"customer",children:"Customer (Debtor)"}),n.jsx("option",{value:"supplier",children:"Supplier (Creditor)"})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Select ",r==="customer"?"Customer":"Supplier"]}),n.jsxs("select",{value:o,onChange:k=>l(k.target.value),className:"w-full px-3 py-2 border rounded-lg",children:[n.jsx("option",{value:"",children:"Select Party"}),s.map(k=>n.jsx("option",{value:k.id,children:k.name},k.id))]})]}),n.jsx("div",{className:"col-span-2",children:n.jsx("p",{className:"text-xs text-gray-500 mt-6",children:"Period is controlled by global date range at top"})})]}),C&&c.length>0&&n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 p-4 bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase",children:"Opening Balance"}),n.jsx("p",{className:"text-lg font-bold text-gray-900",children:y(h)})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase",children:"Total Debit"}),n.jsx("p",{className:"text-lg font-bold text-red-600",children:g(v)})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase",children:"Total Credit"}),n.jsx("p",{className:"text-lg font-bold text-green-600",children:g(_)})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-xs font-medium text-gray-600 uppercase",children:"Outstanding"}),n.jsx("p",{className:"text-lg font-bold text-orange-600",children:g(N)})]})]})]}),o&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Date"}),n.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Particulars"}),n.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Ref No"}),n.jsx("th",{className:"px-3 py-3 text-right text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Debit (Dr)"}),n.jsx("th",{className:"px-3 py-3 text-right text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Credit (Cr)"}),n.jsx("th",{className:"px-3 py-3 text-right text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Balance"})]})}),n.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[n.jsxs("tr",{className:"bg-blue-50 font-semibold",children:[n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-900",colSpan:3,children:"Opening Balance"}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-900 text-right",children:"-"}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-900 text-right",children:"-"}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-900 text-right font-bold",children:y(h)})]}),u?n.jsx("tr",{children:n.jsx("td",{colSpan:6,className:"px-3 py-8 text-center text-gray-500",children:"Loading entries..."})}):c.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:6,className:"px-3 py-8 text-center text-gray-500",children:"No transactions found for this period"})}):c.map(k=>n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-900",children:new Date(k.entry_date).toLocaleDateString("id-ID")}),n.jsx("td",{className:"px-3 py-2 text-sm text-gray-900",children:k.particulars}),n.jsx("td",{className:"px-3 py-2 text-sm text-gray-600 font-mono",children:k.reference}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-red-600 text-right font-medium",children:k.debit>0?g(k.debit):"-"}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-green-600 text-right font-medium",children:k.credit>0?g(k.credit):"-"}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-900 text-right font-semibold",children:y(k.running_balance)})]},k.id)),c.length>0&&n.jsxs("tr",{className:"bg-gray-100 font-semibold border-t-2 border-gray-300",children:[n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-900",colSpan:3,children:"Closing Balance"}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-red-600 text-right font-bold",children:g(v)}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-green-600 text-right font-bold",children:g(_)}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-900 text-right font-bold",children:y(j)})]})]})]})})}),C&&c.length>0&&n.jsx("div",{style:{position:"absolute",left:"-9999px",top:0},children:n.jsxs("div",{ref:t,style:{width:"210mm",padding:"20mm",backgroundColor:"#ffffff"},children:[n.jsx("div",{style:{marginBottom:"15px",borderWidth:"2px",borderColor:"#000",borderStyle:"solid",padding:"15px"},children:n.jsx("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between"},children:n.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"15px"},children:[n.jsx("div",{style:{width:"60px",height:"60px",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#fff"},children:n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",xmlSpace:"preserve",width:"100%",height:"100%",viewBox:"0 0 15686.55 15480.24",children:n.jsxs("g",{children:[n.jsx("path",{fill:"#FDB763",d:"M69.94 10438.12l10353.39 0 0 -1798.67 1665.92 0 0 1868.6 0 320.44 0 4552.28c0,38.48 -31.45,69.94 -69.94,69.94l-11949.38 0c-38.48,0 -69.94,-31.45 -69.94,-69.94l0 -4872.72c0,-38.48 31.45,-69.94 69.94,-69.94zm1605.9 1710.15l8737.57 0c13.58,0 24.68,11.11 24.68,24.68l0 1719.84c0,13.58 -11.11,24.68 -24.68,24.68l-8737.57 0c-13.58,0 -24.68,-11.11 -24.68,-24.68l0 -1719.84c0,-13.58 11.11,-24.68 24.68,-24.68z"}),n.jsx("path",{fill:"#FDB763",d:"M15587.15 5136.67l-10353.49 0 0 1822.07 -1665.92 0 0 -1892.9 0 -324.61 0 -4611.43c0,-39 31.45,-70.87 69.94,-70.87l11949.47 0c38.48,0 69.94,31.87 69.94,70.87l0 4936.04c0,39 -31.45,70.83 -69.94,70.83zm-1605.9 -1732.36l-8737.67 0c-13.58,0 -24.68,-11.27 -24.68,-25l0 -1742.21c0,-13.74 11.11,-25 24.68,-25l8737.67 0c13.58,0 24.68,11.27 24.68,25l0 1742.21c0,13.74 -11.11,25 -24.68,25z"}),n.jsx("polygon",{fill:"#FD6D26",points:"-0,0 1651.16,0 1651.16,6929.27 15657.09,6929.27 15657.09,6958.74 15686.55,6958.74 15686.55,15480.24 14022.85,15480.24 14022.85,8639.45 1651.16,8639.45 -0,8639.45 -0,6929.27"})]})})}),n.jsxs("div",{children:[n.jsx("h1",{style:{fontSize:"16px",fontWeight:"bold",marginBottom:"5px"},children:"PT. SHUBHAM ANZEN PHARMA JAYA"}),n.jsx("p",{style:{fontSize:"11px",margin:"2px 0"},children:"Komplek Ruko Metro Sunter Blok A1 NO.15, Jl. Metro Indah Raya,"}),n.jsx("p",{style:{fontSize:"11px",margin:"2px 0"},children:"Kelurahan Papanggo, Kec. Tanjung Priok, Jakarta Utara - 14340"}),n.jsx("p",{style:{fontSize:"11px",margin:"2px 0"},children:"Telp: (+62 21) 65832426"}),n.jsx("p",{style:{fontSize:"11px",margin:"2px 0"},children:"NPWP: 03.174.071.8-093.000"})]})]})})}),n.jsxs("div",{style:{textAlign:"center",marginBottom:"20px"},children:[n.jsx("h2",{style:{fontSize:"18px",fontWeight:"bold",marginBottom:"5px"},children:"STATEMENT OF ACCOUNT"}),n.jsxs("p",{style:{fontSize:"12px",color:"#666"},children:["Period: ",new Date(e.startDate).toLocaleDateString("id-ID")," to ",new Date(e.endDate).toLocaleDateString("id-ID")]})]}),n.jsxs("div",{style:{marginBottom:"20px",padding:"12px",backgroundColor:"#f3f4f6",borderRadius:"8px"},children:[n.jsxs("p",{style:{fontSize:"13px",fontWeight:"bold",marginBottom:"5px"},children:[r==="customer"?"Customer:":"Supplier:"," ",C.name]}),C.address&&n.jsx("p",{style:{fontSize:"11px",margin:"2px 0"},children:C.address}),C.city&&n.jsx("p",{style:{fontSize:"11px",margin:"2px 0"},children:C.city}),C.phone&&n.jsxs("p",{style:{fontSize:"11px",margin:"2px 0"},children:["Phone: ",C.phone]}),C.npwp&&n.jsxs("p",{style:{fontSize:"11px",margin:"2px 0"},children:["NPWP: ",C.npwp]})]}),n.jsxs("div",{style:{marginBottom:"15px",display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"10px"},children:[n.jsxs("div",{style:{padding:"10px",backgroundColor:"#eff6ff",borderRadius:"6px"},children:[n.jsx("p",{style:{fontSize:"10px",fontWeight:"600",color:"#666",marginBottom:"3px"},children:"OPENING BALANCE"}),n.jsx("p",{style:{fontSize:"13px",fontWeight:"bold"},children:y(h)})]}),n.jsxs("div",{style:{padding:"10px",backgroundColor:"#fef2f2",borderRadius:"6px"},children:[n.jsx("p",{style:{fontSize:"10px",fontWeight:"600",color:"#666",marginBottom:"3px"},children:"TOTAL DEBIT"}),n.jsx("p",{style:{fontSize:"13px",fontWeight:"bold",color:"#dc2626"},children:g(v)})]}),n.jsxs("div",{style:{padding:"10px",backgroundColor:"#f0fdf4",borderRadius:"6px"},children:[n.jsx("p",{style:{fontSize:"10px",fontWeight:"600",color:"#666",marginBottom:"3px"},children:"TOTAL CREDIT"}),n.jsx("p",{style:{fontSize:"13px",fontWeight:"bold",color:"#16a34a"},children:g(_)})]}),n.jsxs("div",{style:{padding:"10px",backgroundColor:"#fff7ed",borderRadius:"6px"},children:[n.jsx("p",{style:{fontSize:"10px",fontWeight:"600",color:"#666",marginBottom:"3px"},children:"OUTSTANDING"}),n.jsx("p",{style:{fontSize:"13px",fontWeight:"bold",color:"#ea580c"},children:g(N)})]})]}),n.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",marginBottom:"20px"},children:[n.jsx("thead",{children:n.jsxs("tr",{style:{backgroundColor:"#f9fafb",borderBottom:"2px solid #000"},children:[n.jsx("th",{style:{padding:"8px",textAlign:"left",fontSize:"10px",fontWeight:"600",borderRight:"1px solid #e5e7eb"},children:"Date"}),n.jsx("th",{style:{padding:"8px",textAlign:"left",fontSize:"10px",fontWeight:"600",borderRight:"1px solid #e5e7eb"},children:"Particulars"}),n.jsx("th",{style:{padding:"8px",textAlign:"left",fontSize:"10px",fontWeight:"600",borderRight:"1px solid #e5e7eb"},children:"Ref No"}),n.jsx("th",{style:{padding:"8px",textAlign:"right",fontSize:"10px",fontWeight:"600",borderRight:"1px solid #e5e7eb"},children:"Debit (Dr)"}),n.jsx("th",{style:{padding:"8px",textAlign:"right",fontSize:"10px",fontWeight:"600",borderRight:"1px solid #e5e7eb"},children:"Credit (Cr)"}),n.jsx("th",{style:{padding:"8px",textAlign:"right",fontSize:"10px",fontWeight:"600"},children:"Balance"})]})}),n.jsxs("tbody",{children:[n.jsxs("tr",{style:{backgroundColor:"#eff6ff",borderBottom:"1px solid #e5e7eb"},children:[n.jsx("td",{colSpan:3,style:{padding:"6px 8px",fontSize:"11px",fontWeight:"600"},children:"Opening Balance"}),n.jsx("td",{style:{padding:"6px 8px",textAlign:"right",fontSize:"11px"},children:"-"}),n.jsx("td",{style:{padding:"6px 8px",textAlign:"right",fontSize:"11px"},children:"-"}),n.jsx("td",{style:{padding:"6px 8px",textAlign:"right",fontSize:"11px",fontWeight:"bold"},children:y(h)})]}),c.map(k=>n.jsxs("tr",{style:{borderBottom:"1px solid #e5e7eb"},children:[n.jsx("td",{style:{padding:"6px 8px",fontSize:"10px"},children:new Date(k.entry_date).toLocaleDateString("id-ID")}),n.jsx("td",{style:{padding:"6px 8px",fontSize:"10px"},children:k.particulars}),n.jsx("td",{style:{padding:"6px 8px",fontSize:"10px",fontFamily:"monospace"},children:k.reference}),n.jsx("td",{style:{padding:"6px 8px",textAlign:"right",fontSize:"10px",color:k.debit>0?"#dc2626":"#000"},children:k.debit>0?g(k.debit):"-"}),n.jsx("td",{style:{padding:"6px 8px",textAlign:"right",fontSize:"10px",color:k.credit>0?"#16a34a":"#000"},children:k.credit>0?g(k.credit):"-"}),n.jsx("td",{style:{padding:"6px 8px",textAlign:"right",fontSize:"10px",fontWeight:"600"},children:y(k.running_balance)})]},k.id)),n.jsxs("tr",{style:{backgroundColor:"#f3f4f6",borderTop:"2px solid #000",borderBottom:"2px solid #000"},children:[n.jsx("td",{colSpan:3,style:{padding:"8px",fontSize:"11px",fontWeight:"bold"},children:"Closing Balance"}),n.jsx("td",{style:{padding:"8px",textAlign:"right",fontSize:"11px",fontWeight:"bold",color:"#dc2626"},children:g(v)}),n.jsx("td",{style:{padding:"8px",textAlign:"right",fontSize:"11px",fontWeight:"bold",color:"#16a34a"},children:g(_)}),n.jsx("td",{style:{padding:"8px",textAlign:"right",fontSize:"11px",fontWeight:"bold"},children:y(j)})]})]})]}),n.jsxs("div",{style:{marginTop:"30px",padding:"12px",backgroundColor:"#f9fafb",borderRadius:"8px"},children:[n.jsxs("p",{style:{fontSize:"11px",color:"#666",marginBottom:"8px"},children:[n.jsx("strong",{children:"Note:"})," This is a computer-generated statement of account."]}),n.jsx("p",{style:{fontSize:"11px",color:"#666"},children:"Please review the above transactions and confirm. If you have any questions or discrepancies, please contact us immediately."})]}),n.jsxs("div",{style:{marginTop:"20px",textAlign:"center",borderTop:"1px solid #e5e7eb",paddingTop:"10px"},children:[n.jsxs("p",{style:{fontSize:"10px",color:"#999"},children:["Generated on ",new Date().toLocaleString("id-ID")]}),n.jsx("p",{style:{fontSize:"10px",color:"#999"},children:"PT. SHUBHAM ANZEN PHARMA JAYA"})]})]})})]})]})}function cAe({selectedBank:e}){var re;const{dateRange:t}=rl(),[r,a]=Q.useState([]),[s,i]=Q.useState(""),[o,l]=Q.useState([]),[c,d]=Q.useState(!1),[u,f]=Q.useState(null),[h,A]=Q.useState(!1),[x,p]=Q.useState([]),[b,m]=Q.useState(!1),[g,y]=Q.useState(0),[v,_]=Q.useState(!1),[j,N]=Q.useState({balance:0,date:"2025-01-01"});Q.useEffect(()=>{E()},[]),Q.useEffect(()=>{e&&i(e)},[e]),Q.useEffect(()=>{s&&C()},[s,t.startDate,t.endDate]),Q.useEffect(()=>{h&&u&&u.type==="expense"&&B()},[h,u]);const B=async()=>{if(!(!u||u.type!=="expense")){m(!0);try{const{data:U}=await Z.storage.from("expense-documents").list(`${u.id}/`);if(U&&U.length>0){const S=U.map(D=>{const{data:L}=Z.storage.from("expense-documents").getPublicUrl(`${u.id}/${D.name}`);return L.publicUrl});p(S)}else p([])}catch(U){console.error("Error loading expense documents:",U),p([])}finally{m(!1)}}},E=async()=>{const{data:U}=await Z.from("bank_accounts").select("*").order("bank_name");U&&a(U)},C=async()=>{if(s){d(!0);try{const U=r.find(se=>se.id===s),S=(U==null?void 0:U.opening_balance)||0,D=(U==null?void 0:U.opening_balance_date)||"2025-01-01";console.log(" Loading ledger for bank:",U==null?void 0:U.bank_name,U==null?void 0:U.account_number,"ID:",s),console.log(" Opening Balance:",S,"as of",D),console.log(" Date Range:",t.startDate,"to",t.endDate);let L=S;if(t.startDate>D){console.log(" Calculating opening balance from",D,"to",t.startDate);const{data:se}=await Z.rpc("calculate_balance_between_dates",{p_bank_account_id:s,p_start_date:D,p_end_date:t.startDate});if(se&&se.length>0){const K=se[0].net_change||0;L=S+K,console.log(" Net change:",K," Effective opening balance:",L)}}y(L);const P=[],I=new Date(t.endDate);I.setDate(I.getDate()+1);const H=I.toISOString().split("T")[0],{data:V}=await Z.from("bank_statement_lines").select("id, transaction_date, description, reference, debit_amount, credit_amount, matched_expense_id, matched_receipt_id, matched_entry_id, notes").eq("bank_account_id",s).gte("transaction_date",t.startDate).lt("transaction_date",H).order("transaction_date");console.log(" Bank statement lines found:",(V==null?void 0:V.length)||0),V&&V.forEach(se=>{P.push({id:se.id,entry_date:se.transaction_date,particulars:se.description||"Bank Transaction",reference:se.reference||"-",debit:Number(se.debit_amount||0),credit:Number(se.credit_amount||0),type:"bank",linkedId:se.matched_expense_id||se.matched_receipt_id||se.matched_entry_id,notes:se.notes})}),P.sort((se,K)=>{const he=new Date(se.entry_date).getTime()-new Date(K.entry_date).getTime();if(he!==0)return he;const ne=se.credit>0,te=K.credit>0;return ne&&!te?-1:!ne&&te?1:0});let W=L;const M=P.map(se=>{const K=se.debit||0,he=se.credit||0;return W+=he-K,{id:se.id,entry_date:se.entry_date,particulars:se.particulars,reference:se.reference,debit:K,credit:he,running_balance:W}});l(M)}catch(U){console.error("Error loading ledger:",U)}finally{d(!1)}}},k=async()=>{if(s)try{const{error:U}=await Z.from("bank_accounts").update({opening_balance:j.balance,opening_balance_date:j.date}).eq("id",s);if(U)throw U;_(!1),await E(),await C()}catch(U){alert("Failed to update opening balance: "+U.message)}},w=()=>{const U=r.find(S=>S.id===s);U&&(N({balance:U.opening_balance,date:U.opening_balance_date||"2025-01-01"}),_(!0))},T=U=>({IDR:"Rp",USD:"$",EUR:""})[U]||U,R=(U,S)=>U===0?"-":`${T(S)} ${U.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})}`,q=()=>{const U=r.find(H=>H.id===s);if(!U)return;const S=["Date","Particulars","Reference","Debit (Dr)","Credit (Cr)","Balance"],D=o.map(H=>[new Date(H.entry_date).toLocaleDateString("id-ID"),H.particulars,H.reference,H.debit>0?R(H.debit,U.currency):"",H.credit>0?R(H.credit,U.currency):"",R(H.running_balance,U.currency)]),L=[`Bank Ledger - ${U.bank_name} (${U.account_number})`,`Period: ${new Date(t.startDate).toLocaleDateString("id-ID")} to ${new Date(t.endDate).toLocaleDateString("id-ID")}`,`Opening Balance: ${R(g,U.currency)}`,"",S.join(","),...D.map(H=>H.join(","))].join(`
`),P=new Blob([L],{type:"text/csv;charset=utf-8;"}),I=document.createElement("a");I.href=URL.createObjectURL(P),I.download=`bank_ledger_${U.bank_name}_${new Date().toISOString().split("T")[0]}.csv`,I.click()},z=r.find(U=>U.id===s),ee=o.reduce((U,S)=>U+S.debit,0),Y=o.reduce((U,S)=>U+S.credit,0),G=g+Y-ee;return n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(l7,{className:"w-5 h-5 text-blue-600"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Bank Ledger (Bank Book)"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("button",{onClick:C,disabled:!s||c,className:"flex items-center gap-2 px-3 py-1.5 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[n.jsx(Hs,{className:`w-4 h-4 ${c?"animate-spin":""}`}),"Refresh"]}),n.jsxs("button",{onClick:q,disabled:!s||o.length===0,className:"flex items-center gap-2 px-3 py-1.5 bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[n.jsx(Zn,{className:"w-4 h-4"}),"Export"]})]})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4",children:[n.jsxs("div",{className:"mb-4",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bank Account"}),n.jsxs("select",{value:s,onChange:U=>i(U.target.value),className:"w-full px-3 py-2 border rounded-lg max-w-md",children:[n.jsx("option",{value:"",children:"Select Bank Account"}),r.map(U=>n.jsxs("option",{value:U.id,children:[U.bank_name," - ",U.account_number," (",U.currency,")"]},U.id))]}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Period is controlled by global date range at top"})]}),z&&n.jsx("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsxs("p",{className:"text-sm font-medium text-gray-700",children:["Opening Balance (as of ",new Date(t.startDate).toLocaleDateString("id-ID"),")"]}),n.jsx("p",{className:"text-lg font-bold text-blue-600",children:R(g,z.currency)}),t.startDate>z.opening_balance_date&&n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Adjusted for filtered date range"})]}),n.jsx("button",{onClick:w,className:"px-3 py-1 text-sm bg-blue-600 text-white rounded hover:bg-blue-700",children:"Update"})]})})]}),s&&n.jsx("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Date"}),n.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Particulars"}),n.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Ref No"}),n.jsx("th",{className:"px-3 py-3 text-right text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Debit (Dr)"}),n.jsx("th",{className:"px-3 py-3 text-right text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Credit (Cr)"}),n.jsx("th",{className:"px-3 py-3 text-right text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Balance"})]})}),n.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[n.jsxs("tr",{className:"bg-blue-50 font-semibold",children:[n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-900",children:new Date(t.startDate).toLocaleDateString("id-ID")}),n.jsxs("td",{className:"px-3 py-2 text-sm text-gray-900",colSpan:2,children:["Opening Balance",t.startDate>((z==null?void 0:z.opening_balance_date)||"")&&n.jsx("span",{className:"ml-2 text-xs font-normal text-gray-600",children:"(adjusted for date filter)"})]}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-900 text-right",children:"-"}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-900 text-right",children:"-"}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-900 text-right font-bold",children:z&&R(g,z.currency)})]}),c?n.jsx("tr",{children:n.jsx("td",{colSpan:6,className:"px-3 py-8 text-center text-gray-500",children:"Loading entries..."})}):o.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:6,className:"px-3 py-8 text-center text-gray-500",children:"No recorded transactions found for this period"})}):o.map(U=>n.jsxs("tr",{className:"hover:bg-blue-50 cursor-pointer transition-colors",onClick:()=>{f(U),A(!0)},children:[n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-900",children:new Date(U.entry_date).toLocaleDateString("id-ID")}),n.jsx("td",{className:"px-3 py-2 text-sm text-gray-900",children:U.particulars}),n.jsx("td",{className:"px-3 py-2 text-sm text-gray-600 font-mono",children:U.reference}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-red-600 text-right font-medium",children:z&&(U.debit>0?R(U.debit,z.currency):"-")}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-green-600 text-right font-medium",children:z&&(U.credit>0?R(U.credit,z.currency):"-")}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-900 text-right font-semibold",children:z&&R(U.running_balance,z.currency)})]},U.id)),o.length>0&&n.jsxs("tr",{className:"bg-gray-100 font-semibold border-t-2 border-gray-300",children:[n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-900",colSpan:3,children:"Closing Balance"}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-red-600 text-right font-bold",children:z&&R(ee,z.currency)}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-green-600 text-right font-bold",children:z&&R(Y,z.currency)}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-900 text-right font-bold",children:z&&R(G,z.currency)})]})]})]})})}),h&&u&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:()=>A(!1),children:n.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full mx-4 max-h-[80vh] overflow-y-auto",onClick:U=>U.stopPropagation(),children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Transaction Details"}),n.jsx("button",{onClick:()=>A(!1),className:"text-gray-400 hover:text-gray-600",children:n.jsx("span",{className:"text-2xl",children:""})})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-600",children:"Date"}),n.jsx("p",{className:"font-medium",children:new Date(u.entry_date).toLocaleDateString("id-ID")})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-600",children:"Reference"}),n.jsx("p",{className:"font-medium font-mono",children:u.reference})]})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-600",children:"Particulars"}),n.jsx("p",{className:"font-medium",children:u.particulars})]}),u.description&&n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-600",children:"Description"}),n.jsx("p",{className:"font-medium",children:u.description})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-600",children:"Debit"}),n.jsx("p",{className:"font-medium text-red-600",children:z&&(u.debit>0?R(u.debit,z.currency):"-")})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-600",children:"Credit"}),n.jsx("p",{className:"font-medium text-green-600",children:z&&(u.credit>0?R(u.credit,z.currency):"-")})]})]}),u.type==="expense"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-600",children:"Expense Category"}),n.jsx("p",{className:"font-medium capitalize",children:(re=u.expenseCategory)==null?void 0:re.replace("_"," ")})]}),b?n.jsx("div",{className:"text-center py-4",children:n.jsx("p",{className:"text-sm text-gray-500",children:"Loading documents..."})}):x.length>0?n.jsxs("div",{children:[n.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["Attached Documents (",x.length,")"]}),n.jsx("div",{className:"grid grid-cols-2 gap-2",children:x.map((U,S)=>n.jsxs("a",{href:U,target:"_blank",rel:"noopener noreferrer",className:"block p-2 border rounded hover:bg-gray-50 text-sm text-blue-600 hover:text-blue-800 truncate",children:["Document ",S+1]},S))})]}):n.jsx("div",{className:"text-center py-2",children:n.jsx("p",{className:"text-sm text-gray-400",children:"No documents attached"})})]}),u.type==="receipt"&&u.customerName&&n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-600",children:"Customer"}),n.jsx("p",{className:"font-medium",children:u.customerName})]}),u.type==="payment"&&u.supplierName&&n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-600",children:"Supplier"}),n.jsx("p",{className:"font-medium",children:u.supplierName})]}),u.type==="bank"&&u.notes&&n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-600",children:"Notes"}),n.jsx("p",{className:"font-medium",children:u.notes})]}),u.type==="bank"&&u.linkedId&&n.jsx("div",{className:"bg-blue-50 p-3 rounded-lg",children:n.jsx("p",{className:"text-sm text-blue-900 font-medium",children:"This transaction is matched to a system entry"})})]}),n.jsx("div",{className:"mt-6 flex justify-end",children:n.jsx("button",{onClick:()=>A(!1),className:"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700",children:"Close"})})]})}),n.jsx(Ot,{isOpen:v,onClose:()=>_(!1),title:"Update Opening Balance",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Opening Balance Amount *"}),n.jsx("input",{type:"number",value:j.balance,onChange:U=>N({...j,balance:parseFloat(U.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,step:"0.01"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Opening Balance Date *"}),n.jsx("input",{type:"date",value:j.date,onChange:U=>N({...j,date:U.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Set the date when this opening balance is effective. All transactions from this date onwards will be included in the ledger."})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[n.jsx("button",{type:"button",onClick:()=>_(!1),className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),n.jsx("button",{onClick:k,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Update"})]})]})})]})}function q1({initialReport:e="trial_balance"}){const{dateRange:t}=rl(),{t:r}=cn(),[a,s]=Q.useState(e),[i,o]=Q.useState(!1),[l,c]=Q.useState([]);Q.useEffect(()=>{d()},[a,t]);const d=async()=>{o(!0);try{const{data:y,error:v}=await Z.rpc("get_trial_balance",{p_start_date:t.startDate,p_end_date:t.endDate});if(!v&&y)c(y);else{const{data:_,error:j}=await Z.from("trial_balance_view").select("*").order("code");if(j)throw j;c(_||[])}}catch(y){console.error("Error loading report:",y)}finally{o(!1)}},u=l.reduce((y,v)=>({debit:y.debit+v.total_debit,credit:y.credit+v.total_credit}),{debit:0,credit:0}),f=l.filter(y=>y.account_type==="revenue").reduce((y,v)=>y+Math.abs(v.balance),0),h=l.filter(y=>y.account_type==="expense").reduce((y,v)=>y+Math.abs(v.balance),0),A=f-h,x=l.filter(y=>y.account_type==="asset").reduce((y,v)=>y+v.balance,0),p=l.filter(y=>{var v;return y.account_type==="contra"&&((v=y.account_group)==null?void 0:v.includes("Assets"))}).reduce((y,v)=>y+Math.abs(v.balance),0),b=l.filter(y=>y.account_type==="liability").reduce((y,v)=>y+Math.abs(v.balance),0),m=l.filter(y=>y.account_type==="equity").reduce((y,v)=>y+Math.abs(v.balance),0),g=[{id:"trial_balance",label:r("trial_balance","Trial Balance"),label_id:"Neraca Saldo"},{id:"pnl",label:r("pnl","Profit & Loss"),label_id:"Laba Rugi"},{id:"balance_sheet",label:r("balance_sheet","Balance Sheet"),label_id:"Neraca"}];return n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center justify-between gap-3 bg-white rounded-lg shadow-sm border border-gray-200 p-2",children:[n.jsx("div",{className:"flex gap-1.5",children:g.map(y=>n.jsx("button",{onClick:()=>s(y.id),className:`px-3 py-1.5 rounded text-xs font-medium transition ${a===y.id?"bg-blue-600 text-white":"bg-gray-50 text-gray-700 hover:bg-gray-100"}`,children:y.label},y.id))}),n.jsxs("button",{onClick:d,className:"flex items-center gap-1.5 px-2.5 py-1.5 bg-gray-50 text-gray-700 rounded text-xs hover:bg-gray-100",children:[n.jsx(Hs,{className:"w-3.5 h-3.5"}),r("refresh","Refresh")]})]}),i?n.jsx("div",{className:"flex justify-center py-8",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):n.jsxs(n.Fragment,{children:[a==="trial_balance"&&n.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[n.jsxs("div",{className:"px-3 py-2 border-b bg-gray-50",children:[n.jsx("h3",{className:"font-semibold text-sm",children:r("trial_balance","Trial Balance")}),n.jsxs("p",{className:"text-xs text-gray-500",children:[r("as_of","As of")," ",new Date(t.endDate).toLocaleDateString("id-ID")]})]}),n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-3 py-2 text-left text-[10px] font-medium text-gray-500 uppercase",children:r("code","Code")}),n.jsx("th",{className:"px-3 py-2 text-left text-[10px] font-medium text-gray-500 uppercase",children:r("account_name","Account Name")}),n.jsx("th",{className:"px-3 py-2 text-right text-[10px] font-medium text-gray-500 uppercase",children:r("debit","Debit")}),n.jsx("th",{className:"px-3 py-2 text-right text-[10px] font-medium text-gray-500 uppercase",children:r("credit","Credit")})]})}),n.jsxs("tbody",{className:"divide-y divide-gray-100",children:[l.map(y=>n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-3 py-1.5 font-mono text-xs",children:y.code}),n.jsxs("td",{className:"px-3 py-1.5 text-sm",children:[n.jsx("div",{children:y.name}),y.name_id&&n.jsx("div",{className:"text-xs text-gray-500",children:y.name_id})]}),n.jsx("td",{className:"px-3 py-1.5 text-right text-sm text-blue-600",children:y.balance>0?`Rp ${y.balance.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})}`:""}),n.jsx("td",{className:"px-3 py-1.5 text-right text-sm text-green-600",children:y.balance<0?`Rp ${Math.abs(y.balance).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})}`:""})]},y.code)),l.length===0&&n.jsx("tr",{children:n.jsx("td",{colSpan:4,className:"px-3 py-6 text-center text-sm text-gray-500",children:r("no_data","No transactions found")})})]}),n.jsx("tfoot",{className:"bg-gray-100 font-bold",children:n.jsxs("tr",{children:[n.jsxs("td",{colSpan:2,className:"px-3 py-2 text-right text-sm",children:[r("total","Total"),":"]}),n.jsxs("td",{className:"px-3 py-2 text-right text-sm text-blue-700",children:["Rp ",u.debit.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]}),n.jsxs("td",{className:"px-3 py-2 text-right text-sm text-green-700",children:["Rp ",u.credit.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})})]})]}),a==="pnl"&&n.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[n.jsxs("div",{className:"px-3 py-2 border-b bg-gray-50",children:[n.jsx("h3",{className:"font-semibold text-sm",children:r("pnl","Profit & Loss Statement")}),n.jsxs("p",{className:"text-xs text-gray-500",children:[r("period","Period"),": ",new Date(t.startDate).toLocaleDateString("id-ID")," - ",new Date(t.endDate).toLocaleDateString("id-ID")]}),n.jsx("p",{className:"text-[10px] text-amber-600 mt-0.5 italic",children:r("pnl_note","Note: Costs may change as import expenses are updated")})]}),n.jsxs("div",{className:"p-3",children:[n.jsxs("div",{className:"mb-4",children:[n.jsxs("h4",{className:"font-semibold text-green-700 text-xs mb-1.5 border-b pb-1",children:[r("revenue","Revenue")," (Pendapatan)"]}),n.jsx("table",{className:"w-full",children:n.jsxs("tbody",{children:[l.filter(y=>y.account_type==="revenue").map(y=>n.jsxs("tr",{children:[n.jsx("td",{className:"py-0.5 font-mono text-[10px] text-gray-500",children:y.code}),n.jsx("td",{className:"py-0.5 text-xs",children:y.name}),n.jsxs("td",{className:"py-0.5 text-right text-xs text-green-600",children:["Rp ",Math.abs(y.balance).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]},y.code)),n.jsxs("tr",{className:"font-semibold border-t",children:[n.jsx("td",{colSpan:2,className:"py-1.5 text-xs",children:r("total_revenue","Total Revenue")}),n.jsxs("td",{className:"py-1.5 text-right text-xs text-green-700",children:["Rp ",f.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})})]}),n.jsxs("div",{className:"mb-4",children:[n.jsxs("h4",{className:"font-semibold text-red-700 text-xs mb-1.5 border-b pb-1",children:[r("expenses","Expenses")," (Beban)"]}),n.jsx("table",{className:"w-full",children:n.jsxs("tbody",{children:[l.filter(y=>y.account_type==="expense").map(y=>n.jsxs("tr",{children:[n.jsx("td",{className:"py-0.5 font-mono text-[10px] text-gray-500",children:y.code}),n.jsx("td",{className:"py-0.5 text-xs",children:y.name}),n.jsxs("td",{className:"py-0.5 text-right text-xs text-red-600",children:["Rp ",Math.abs(y.balance).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]},y.code)),n.jsxs("tr",{className:"font-semibold border-t",children:[n.jsx("td",{colSpan:2,className:"py-1.5 text-xs",children:r("total_expenses","Total Expenses")}),n.jsxs("td",{className:"py-1.5 text-right text-xs text-red-700",children:["Rp ",h.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})})]}),n.jsx("div",{className:`p-2.5 rounded ${A>=0?"bg-green-50":"bg-red-50"}`,children:n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsxs("span",{className:"font-bold text-sm",children:[r("net_income","Net Income")," ",n.jsxs("span",{className:"text-xs font-normal italic",children:["(",r("provisional","Provisional"),")"]})]}),n.jsxs("span",{className:`font-bold text-base ${A>=0?"text-green-700":"text-red-700"}`,children:["Rp ",A.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})})]})]}),a==="balance_sheet"&&n.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[n.jsxs("div",{className:"px-3 py-2 border-b bg-gray-50",children:[n.jsxs("h3",{className:"font-semibold text-sm",children:[r("balance_sheet","Balance Sheet")," (Neraca)"]}),n.jsxs("p",{className:"text-xs text-gray-500",children:[r("as_of","As of")," ",new Date(t.endDate).toLocaleDateString("id-ID")]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 p-3",children:[n.jsxs("div",{children:[n.jsxs("h4",{className:"font-semibold text-blue-700 text-xs mb-1.5 border-b pb-1",children:[r("assets","Assets")," (Aset)"]}),n.jsx("table",{className:"w-full",children:n.jsxs("tbody",{children:[l.filter(y=>y.account_type==="asset").map(y=>n.jsxs("tr",{children:[n.jsxs("td",{className:"py-0.5 text-xs",children:[n.jsx("span",{className:"font-mono text-[10px] text-gray-500 mr-1.5",children:y.code}),y.name]}),n.jsxs("td",{className:"py-0.5 text-right text-xs text-blue-600",children:["Rp ",y.balance.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]},y.code)),l.filter(y=>{var v;return y.account_type==="contra"&&((v=y.account_group)==null?void 0:v.includes("Assets"))}).map(y=>n.jsxs("tr",{className:"text-gray-500",children:[n.jsxs("td",{className:"py-0.5 text-xs",children:[n.jsx("span",{className:"font-mono text-[10px] mr-1.5",children:y.code}),y.name]}),n.jsxs("td",{className:"py-0.5 text-right text-xs",children:["(",Math.abs(y.balance).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2}),")"]})]},y.code)),n.jsxs("tr",{className:"font-semibold border-t-2",children:[n.jsx("td",{className:"py-1.5 text-xs",children:r("total_assets","Total Assets")}),n.jsxs("td",{className:"py-1.5 text-right text-xs text-blue-700",children:["Rp ",(x-p).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})})]}),n.jsxs("div",{children:[n.jsxs("h4",{className:"font-semibold text-red-700 text-xs mb-1.5 border-b pb-1",children:[r("liabilities","Liabilities")," (Kewajiban)"]}),n.jsx("table",{className:"w-full",children:n.jsxs("tbody",{children:[l.filter(y=>y.account_type==="liability").map(y=>n.jsxs("tr",{children:[n.jsxs("td",{className:"py-0.5 text-xs",children:[n.jsx("span",{className:"font-mono text-[10px] text-gray-500 mr-1.5",children:y.code}),y.name]}),n.jsxs("td",{className:"py-0.5 text-right text-xs text-red-600",children:["Rp ",Math.abs(y.balance).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]},y.code)),n.jsxs("tr",{className:"font-semibold border-t",children:[n.jsx("td",{className:"py-1.5 text-xs",children:r("total_liabilities","Total Liabilities")}),n.jsxs("td",{className:"py-1.5 text-right text-xs text-red-700",children:["Rp ",b.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})}),n.jsxs("h4",{className:"font-semibold text-purple-700 text-xs mb-1.5 border-b pb-1 mt-4",children:[r("equity","Equity")," (Modal)"]}),n.jsx("table",{className:"w-full",children:n.jsxs("tbody",{children:[l.filter(y=>y.account_type==="equity").map(y=>n.jsxs("tr",{children:[n.jsxs("td",{className:"py-0.5 text-xs",children:[n.jsx("span",{className:"font-mono text-[10px] text-gray-500 mr-1.5",children:y.code}),y.name]}),n.jsxs("td",{className:"py-0.5 text-right text-xs text-purple-600",children:["Rp ",Math.abs(y.balance).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]},y.code)),n.jsxs("tr",{children:[n.jsx("td",{className:"py-0.5 text-xs",children:r("current_year_earnings","Current Year Earnings")}),n.jsxs("td",{className:`py-0.5 text-right text-xs ${A>=0?"text-green-600":"text-red-600"}`,children:["Rp ",A.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),n.jsxs("tr",{className:"font-semibold border-t",children:[n.jsx("td",{className:"py-1.5 text-xs",children:r("total_equity","Total Equity")}),n.jsxs("td",{className:"py-1.5 text-right text-xs text-purple-700",children:["Rp ",(m+A).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})}),n.jsx("div",{className:"mt-3 p-2 bg-gray-100 rounded",children:n.jsxs("div",{className:"flex justify-between font-bold text-xs",children:[n.jsx("span",{children:r("total_liabilities_equity","Total Liabilities + Equity")}),n.jsxs("span",{children:["Rp ",(b+m+A).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})})]})]})]})]})]})}function dAe({canManage:e}){var q;const{setCurrentPage:t}=Go(),[r,a]=Q.useState("invoices"),[s,i]=Q.useState([]),[o,l]=Q.useState([]),[c,d]=Q.useState([]),[u,f]=Q.useState(!0),[h,A]=Q.useState(!1),[x,p]=Q.useState(!1),[b,m]=Q.useState(null),[g,y]=Q.useState([]),[v,_]=Q.useState({}),[j,N]=Q.useState({payment_number:"",payment_date:new Date().toISOString().split("T")[0],amount:0,payment_method:"bank_transfer",bank_account_id:"",reference_number:"",notes:""}),B=Q.useCallback(async()=>{try{const[z,ee,Y]=await Promise.all([Z.from("sales_invoices").select("*, customers(company_name)").in("payment_status",["pending","partial"]).order("due_date",{ascending:!0}),Z.from("receipt_vouchers").select(`
            *,
            customers(company_name),
            bank_accounts(account_name, alias)
          `).order("voucher_date",{ascending:!1}).limit(50),Z.from("bank_accounts").select("id, account_name, bank_name, alias").eq("is_active",!0).order("account_name")]);if(z.error)throw console.error("Error loading invoices:",z.error),z.error;if(ee.error)throw console.error("Error loading payments:",ee.error),ee.error;if(Y.error)throw console.error("Error loading banks:",Y.error),Y.error;const G=await Promise.all((z.data||[]).map(async U=>{try{const{data:S,error:D}=await Z.from("voucher_allocations").select("allocated_amount").eq("sales_invoice_id",U.id).eq("voucher_type","receipt");D&&console.error("Error loading allocations for invoice:",U.id,D);const L=(S==null?void 0:S.reduce((P,I)=>P+(Number(I.allocated_amount)||0),0))||0;return{...U,paid_amount:L,customers:U.customers||null}}catch(S){return console.error("Error processing invoice:",U.id,S),{...U,paid_amount:0,customers:U.customers||null}}})),re=await Promise.all((ee.data||[]).map(async U=>{try{const{data:S,error:D}=await Z.from("voucher_allocations").select("allocated_amount, sales_invoices(invoice_number)").eq("receipt_voucher_id",U.id).eq("voucher_type","receipt");return D&&console.error("Error loading allocations for voucher:",U.id,D),{...U,allocations:S||[],customers:U.customers||null,bank_accounts:U.bank_accounts||null}}catch(S){return console.error("Error processing voucher:",U.id,S),{...U,allocations:[],customers:U.customers||null,bank_accounts:U.bank_accounts||null}}}));i(G),l(re),d(Y.data||[])}catch(z){console.error("Error loading data:",z)}finally{f(!1),A(!1)}},[]);Q.useEffect(()=>{B();const z=setInterval(B,3e4);return()=>clearInterval(z)},[B]);const E=()=>{A(!0),B()},C=async z=>{m(z);const ee=z.total_amount-(z.paid_amount||0);N({...j,payment_number:`PAY-${Date.now()}`,amount:ee});try{const{data:Y,error:G}=await Z.from("sales_invoices").select("*").eq("customer_id",z.customer_id).in("payment_status",["pending","partial"]).order("invoice_date",{ascending:!0});if(G)throw console.error("Error loading customer invoices:",G),G;const re=await Promise.all((Y||[]).map(async U=>{try{const{data:S,error:D}=await Z.from("voucher_allocations").select("allocated_amount").eq("sales_invoice_id",U.id).eq("voucher_type","receipt");D&&console.error("Error loading allocations for invoice:",U.id,D);const L=(S==null?void 0:S.reduce((P,I)=>P+(Number(I.allocated_amount)||0),0))||0;return{...U,paid_amount:L,customers:U.customers||null}}catch(S){return console.error("Error processing invoice:",U.id,S),{...U,paid_amount:0,customers:U.customers||null}}}));y(re),_({[z.id]:ee})}catch(Y){console.error("Error loading customer invoices:",Y)}p(!0)},k=async z=>{if(z.preventDefault(),!b)return;const ee=Object.values(v).reduce((Y,G)=>Y+G,0);if(ee>j.amount){alert("Total allocated amount cannot exceed payment amount");return}if(ee===0){alert("Please allocate the payment to at least one invoice");return}try{const{data:{user:Y}}=await Z.auth.getUser();if(!Y)throw new Error("Not authenticated");const G=new Date().getFullYear().toString().slice(-2),re=(new Date().getMonth()+1).toString().padStart(2,"0"),{count:U}=await Z.from("receipt_vouchers").select("*",{count:"exact",head:!0}).like("voucher_number",`RV${G}${re}%`),S=`RV${G}${re}-${String((U||0)+1).padStart(4,"0")}`,{data:D,error:L}=await Z.from("receipt_vouchers").insert([{voucher_number:S,voucher_date:j.payment_date,customer_id:b.customer_id,payment_method:j.payment_method,bank_account_id:j.bank_account_id||null,reference_number:j.reference_number||null,amount:j.amount,description:j.notes||null,created_by:Y.id}]).select().single();if(L)throw L;for(const[P,I]of Object.entries(v))I<=0||await Z.from("voucher_allocations").insert({voucher_type:"receipt",receipt_voucher_id:D.id,sales_invoice_id:P,allocated_amount:I});p(!1),m(null),y([]),_({}),w(),B(),alert(`Receipt voucher ${S} created and allocated successfully!`)}catch(Y){console.error("Error recording payment:",Y),alert(`Failed to record payment: ${Y.message}`)}},w=()=>{N({payment_number:"",payment_date:new Date().toISOString().split("T")[0],amount:0,payment_method:"bank_transfer",bank_account_id:"",reference_number:"",notes:""})},T=[{key:"invoice_number",label:"Invoice #",render:z=>n.jsx("button",{onClick:()=>t("sales"),className:"text-blue-600 hover:underline font-medium",children:z.invoice_number})},{key:"customer",label:"Customer",render:z=>{var ee;return((ee=z.customers)==null?void 0:ee.company_name)||"N/A"}},{key:"invoice_date",label:"Date",render:z=>new Date(z.invoice_date).toLocaleDateString()},{key:"due_date",label:"Due Date",render:z=>{const ee=new Date(z.due_date),G=ee<new Date&&z.payment_status!=="paid";return n.jsx("span",{className:G?"text-red-600 font-semibold":"",children:ee.toLocaleDateString()})}},{key:"total_amount",label:"Amount",render:z=>`Rp ${z.total_amount.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})}`},{key:"paid",label:"Paid",render:z=>n.jsxs("span",{className:"text-green-600",children:["Rp ",(z.paid_amount||0).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})},{key:"balance",label:"Balance",render:z=>n.jsxs("span",{className:"font-semibold text-red-600",children:["Rp ",(z.total_amount-(z.paid_amount||0)).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})},{key:"status",label:"Status",render:z=>n.jsx("span",{className:`inline-block px-2 py-1 rounded-full text-xs font-medium ${z.payment_status==="partial"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:z.payment_status})}],R=[{key:"voucher_number",label:"Voucher #",render:z=>z.voucher_number},{key:"voucher_date",label:"Date",render:z=>new Date(z.voucher_date).toLocaleDateString()},{key:"customer",label:"Customer",render:z=>{var ee;return((ee=z.customers)==null?void 0:ee.company_name)||"N/A"}},{key:"invoices",label:"Invoices",render:z=>!z.allocations||z.allocations.length===0?"Unallocated":z.allocations.map(ee=>{var Y;return((Y=ee.sales_invoices)==null?void 0:Y.invoice_number)||"N/A"}).join(", ")},{key:"amount",label:"Amount",render:z=>n.jsxs("span",{className:"font-semibold text-green-600",children:["Rp ",z.amount.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})},{key:"method",label:"Method",render:z=>n.jsx("span",{className:"capitalize",children:z.payment_method.replace("_"," ")})},{key:"bank",label:"Bank Account",render:z=>z.bank_accounts?z.bank_accounts.alias||z.bank_accounts.account_name:"Cash"}];return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("button",{onClick:()=>a("invoices"),className:`px-4 py-2 rounded-lg font-medium transition ${r==="invoices"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["Outstanding Invoices (",s.length,")"]}),n.jsx("button",{onClick:()=>a("payments"),className:`px-4 py-2 rounded-lg font-medium transition ${r==="payments"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Payment History"})]}),n.jsxs("button",{onClick:E,disabled:h,className:"flex items-center gap-2 px-3 py-2 text-gray-600 hover:bg-gray-100 rounded-lg transition",title:"Refresh data",children:[n.jsx(Hs,{className:`w-4 h-4 ${h?"animate-spin":""}`}),n.jsx("span",{className:"text-sm",children:"Refresh"})]})]}),r==="invoices"&&s.length>0&&n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 flex items-start gap-3",children:[n.jsx("div",{className:"bg-blue-100 rounded-full p-2",children:n.jsx(zo,{className:"w-5 h-5 text-blue-600"})}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-blue-900",children:"Recording Customer Payments"}),n.jsxs("p",{className:"text-sm text-blue-700 mt-1",children:["Click the green ",n.jsx("span",{className:"font-semibold",children:'"Record Payment"'}),' button next to any invoice to record payment received from customers. The invoice status will automatically change from "pending" to "paid" once full payment is allocated.']})]})]}),r==="invoices"?n.jsx(n.Fragment,{children:s.length===0&&!u?n.jsxs("div",{className:"text-center py-12 text-gray-500",children:[n.jsx(zo,{className:"w-16 h-16 mx-auto mb-4 text-gray-400"}),n.jsx("p",{className:"text-lg font-medium",children:"All Caught Up!"}),n.jsx("p",{className:"text-sm mt-2",children:"No outstanding invoices - all payments received!"})]}):n.jsx(Fs,{columns:T,data:s,loading:u,actions:e?z=>n.jsxs("button",{onClick:()=>C(z),className:"flex items-center gap-1.5 px-4 py-2 bg-green-600 text-white text-sm font-medium rounded-lg hover:bg-green-700 transition shadow-sm",children:[n.jsx("span",{className:"text-lg",children:"+"}),"Record Payment"]}):void 0})}):n.jsx(Fs,{columns:R,data:o,loading:u}),n.jsx(Ot,{isOpen:x,onClose:()=>{p(!1),m(null),y([]),_({}),w()},title:"Record Customer Payment",size:"lg",children:n.jsxs("form",{onSubmit:k,className:"space-y-4",children:[b&&n.jsx("div",{className:"bg-blue-50 p-4 rounded-lg",children:n.jsxs("div",{className:"text-sm",children:[n.jsx("div",{className:"font-medium text-lg mb-2",children:(q=b.customers)==null?void 0:q.company_name}),n.jsx("div",{className:"text-gray-600",children:"Recording payment for customer invoices"})]})}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Number *"}),n.jsx("input",{type:"text",value:j.payment_number,onChange:z=>N({...j,payment_number:z.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Date *"}),n.jsx("input",{type:"date",value:j.payment_date,onChange:z=>N({...j,payment_date:z.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount (Rp) *"}),n.jsx("input",{type:"number",value:j.amount===0?"":j.amount,onChange:z=>N({...j,amount:z.target.value===""?0:Number(z.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,min:"0",step:"0.01"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Method *"}),n.jsxs("select",{value:j.payment_method,onChange:z=>N({...j,payment_method:z.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[n.jsx("option",{value:"cash",children:"Cash"}),n.jsx("option",{value:"bank_transfer",children:"Bank Transfer"}),n.jsx("option",{value:"cheque",children:"Cheque"}),n.jsx("option",{value:"credit_card",children:"Credit Card"}),n.jsx("option",{value:"other",children:"Other"})]})]}),j.payment_method!=="cash"&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bank Account"}),n.jsxs("select",{value:j.bank_account_id,onChange:z=>N({...j,bank_account_id:z.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"",children:"Select Bank Account"}),c.map(z=>n.jsx("option",{value:z.id,children:z.alias||`${z.account_name} - ${z.bank_name}`},z.id))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reference Number"}),n.jsx("input",{type:"text",value:j.reference_number,onChange:z=>N({...j,reference_number:z.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Bank reference or cheque number"})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),n.jsx("textarea",{value:j.notes,onChange:z=>N({...j,notes:z.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:2})]})]}),g.length>0&&n.jsxs("div",{className:"border rounded-lg p-4 space-y-3 max-h-96 overflow-y-auto",children:[n.jsx("h3",{className:"font-medium text-gray-900",children:"Allocate Payment to Invoices"}),n.jsx("p",{className:"text-sm text-gray-600",children:"Select invoices and enter amount to allocate to each"}),g.map(z=>{const ee=z.total_amount-(z.paid_amount||0),Y=v[z.id]!==void 0,G=v[z.id]||0;return n.jsx("div",{className:"border rounded p-3 space-y-2",children:n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[n.jsx("input",{type:"checkbox",checked:Y,onChange:re=>{if(re.target.checked)_(U=>({...U,[z.id]:Math.min(ee,j.amount-Object.values(v).reduce((S,D)=>S+D,0))}));else{const U={...v};delete U[z.id],_(U)}},className:"mt-1"}),n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:"font-medium text-sm",children:z.invoice_number}),n.jsxs("div",{className:"text-xs text-gray-600",children:["Date: ",new Date(z.invoice_date).toLocaleDateString()]}),n.jsxs("div",{className:"text-xs mt-1",children:["Total: Rp ",z.total_amount.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]}),n.jsxs("div",{className:"text-xs text-orange-600 font-medium",children:["Balance: Rp ",ee.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]}),Y&&n.jsx("div",{className:"ml-3 w-32",children:n.jsx("input",{type:"number",value:G||"",onChange:re=>{const U=parseFloat(re.target.value)||0;if(U>ee){alert("Cannot allocate more than balance");return}_(S=>({...S,[z.id]:U}))},className:"w-full px-2 py-1 border rounded text-sm",placeholder:"Amount",min:"0",max:ee,step:"0.01"})})]})},z.id)}),n.jsxs("div",{className:"border-t pt-3 space-y-1",children:[n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{className:"font-medium",children:"Payment Amount:"}),n.jsxs("span",{className:"font-bold",children:["Rp ",j.amount.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{children:"Allocated:"}),n.jsxs("span",{className:Object.values(v).reduce((z,ee)=>z+ee,0)>j.amount?"text-red-600 font-bold":"text-green-600",children:["Rp ",Object.values(v).reduce((z,ee)=>z+ee,0).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{children:"Unallocated:"}),n.jsxs("span",{className:"text-gray-600",children:["Rp ",(j.amount-Object.values(v).reduce((z,ee)=>z+ee,0)).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[n.jsx("button",{type:"button",onClick:()=>{p(!1),m(null),y([]),_({}),w()},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),n.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",disabled:Object.values(v).reduce((z,ee)=>z+ee,0)===0,children:"Record Payment"})]})]})})]})}function uAe({canManage:e}){const{profile:t}=Cr(),[r,a]=Q.useState("bills"),[s,i]=Q.useState([]),[o,l]=Q.useState([]),[c,d]=Q.useState([]),[u,f]=Q.useState(!0),[h,A]=Q.useState(!1),[x,p]=Q.useState(!1),[b,m]=Q.useState(null),[g,y]=Q.useState(null),[v,_]=Q.useState({bill_number:"",vendor_name:"",vendor_id:"",bill_date:new Date().toISOString().split("T")[0],due_date:"",amount:0,tax_amount:0,category:"expense",description:""}),[j,N]=Q.useState({bill_id:"",payment_date:new Date().toISOString().split("T")[0],amount:0,payment_method:"bank_transfer",bank_account_id:"",reference_number:"",notes:""});Q.useEffect(()=>{B()},[]);const B=async()=>{f(!0),await Promise.all([E(),C(),k()]),f(!1)},E=async()=>{try{const{data:M,error:se}=await Z.from("vendor_bills").select("*").order("bill_date",{ascending:!1});if(se)throw se;i(M||[])}catch(M){console.error("Error loading bills:",M)}},C=async()=>{try{const{data:M,error:se}=await Z.from("vendor_payments").select(`
          *,
          vendor_bills (
            bill_number,
            vendor_name
          ),
          bank_accounts (
            account_name,
            bank_name
          )
        `).order("payment_date",{ascending:!1});if(se)throw se;l(M||[])}catch(M){console.error("Error loading payments:",M)}},k=async()=>{try{const{data:M,error:se}=await Z.from("bank_accounts").select("id, account_name, bank_name").eq("is_active",!0).order("account_name");if(se)throw se;d(M||[])}catch(M){console.error("Error loading bank accounts:",M)}},w=async()=>{const M="BILL",se=new Date().getFullYear(),{data:K}=await Z.from("vendor_bills").select("bill_number").like("bill_number",`${M}-${se}%`).order("created_at",{ascending:!1}).limit(1).maybeSingle();if(K!=null&&K.bill_number){const he=parseInt(K.bill_number.split("-")[2]);return`${M}-${se}-${String(he+1).padStart(5,"0")}`}return`${M}-${se}-00001`},T=async()=>{const M="VPAY",se=new Date().getFullYear(),{data:K}=await Z.from("vendor_payments").select("payment_number").like("payment_number",`${M}-${se}%`).order("created_at",{ascending:!1}).limit(1).maybeSingle();if(K!=null&&K.payment_number){const he=parseInt(K.payment_number.split("-")[2]);return`${M}-${se}-${String(he+1).padStart(5,"0")}`}return`${M}-${se}-00001`},R=async M=>{M.preventDefault();try{const{data:{user:se}}=await Z.auth.getUser();if(!se)throw new Error("Not authenticated");const K=v.amount+v.tax_amount;if(b){const{error:he}=await Z.from("vendor_bills").update({vendor_name:v.vendor_name,vendor_id:v.vendor_id||null,bill_date:v.bill_date,due_date:v.due_date||null,amount:v.amount,tax_amount:v.tax_amount,total_amount:K,category:v.category,description:v.description||null}).eq("id",b.id);if(he)throw he}else{const he=await w(),{error:ne}=await Z.from("vendor_bills").insert([{bill_number:he,vendor_name:v.vendor_name,vendor_id:v.vendor_id||null,bill_date:v.bill_date,due_date:v.due_date||null,amount:v.amount,tax_amount:v.tax_amount,total_amount:K,category:v.category,description:v.description||null,created_by:se.id}]);if(ne)throw ne}A(!1),re(),E()}catch(se){console.error("Error saving bill:",se),alert("Failed to save bill. Please try again.")}},q=async M=>{M.preventDefault();try{const{data:{user:se}}=await Z.auth.getUser();if(!se)throw new Error("Not authenticated");if(g){const{error:K}=await Z.from("vendor_payments").update({payment_date:j.payment_date,amount:j.amount,payment_method:j.payment_method,bank_account_id:j.bank_account_id||null,reference_number:j.reference_number||null,notes:j.notes||null}).eq("id",g.id);if(K)throw K}else{const K=await T(),{error:he}=await Z.from("vendor_payments").insert([{payment_number:K,bill_id:j.bill_id,payment_date:j.payment_date,amount:j.amount,payment_method:j.payment_method,bank_account_id:j.bank_account_id||null,reference_number:j.reference_number||null,notes:j.notes||null,created_by:se.id}]);if(he)throw he}p(!1),U(),C(),E()}catch(se){console.error("Error saving payment:",se),alert("Failed to save payment. Please try again.")}},z=M=>{m(M),_({bill_number:M.bill_number,vendor_name:M.vendor_name,vendor_id:M.vendor_id||"",bill_date:M.bill_date,due_date:M.due_date||"",amount:M.amount,tax_amount:M.tax_amount,category:M.category,description:M.description||""}),A(!0)},ee=M=>{y(M),N({bill_id:M.bill_id,payment_date:M.payment_date,amount:M.amount,payment_method:M.payment_method,bank_account_id:M.bank_account_id||"",reference_number:M.reference_number||"",notes:M.notes||""}),p(!0)},Y=async M=>{if(confirm("Are you sure you want to delete this bill?"))try{const{error:se}=await Z.from("vendor_bills").delete().eq("id",M);if(se)throw se;E()}catch(se){console.error("Error deleting bill:",se),alert("Failed to delete bill. Please try again.")}},G=async M=>{if(confirm("Are you sure you want to delete this payment?"))try{const{error:se}=await Z.from("vendor_payments").delete().eq("id",M);if(se)throw se;C(),E()}catch(se){console.error("Error deleting payment:",se),alert("Failed to delete payment. Please try again.")}},re=()=>{m(null),_({bill_number:"",vendor_name:"",vendor_id:"",bill_date:new Date().toISOString().split("T")[0],due_date:"",amount:0,tax_amount:0,category:"expense",description:""})},U=()=>{y(null),N({bill_id:"",payment_date:new Date().toISOString().split("T")[0],amount:0,payment_method:"bank_transfer",bank_account_id:"",reference_number:"",notes:""})},S=M=>{switch(M){case"paid":return"bg-green-100 text-green-800";case"partial":return"bg-yellow-100 text-yellow-800";case"pending":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},D=M=>M?{inventory:"Inventory",expense:"Expense",asset:"Asset",other:"Other"}[M]||M:"N/A",L=M=>({cash:"Cash",bank_transfer:"Bank Transfer",cheque:"Cheque",credit_card:"Credit Card",other:"Other"})[M]||M,P=s.filter(M=>M.payment_status!=="paid").reduce((M,se)=>M+se.total_amount,0),I=s.filter(M=>!M.due_date||M.payment_status==="paid"?!1:new Date(M.due_date)<new Date),H=[{key:"bill_number",label:"Bill Number",render:M=>n.jsx("span",{className:"font-medium text-gray-900",children:M.bill_number})},{key:"vendor_name",label:"Vendor",render:M=>M.vendor_name},{key:"bill_date",label:"Bill Date",render:M=>new Date(M.bill_date).toLocaleDateString()},{key:"due_date",label:"Due Date",render:M=>{if(!M.due_date)return"N/A";const se=new Date(M.due_date),K=se<new Date&&M.payment_status!=="paid";return n.jsxs("span",{className:K?"text-red-600 font-medium":"",children:[se.toLocaleDateString(),K&&n.jsx(En,{className:"w-3 h-3 inline ml-1"})]})}},{key:"category",label:"Category",render:M=>D(M.category)},{key:"total_amount",label:"Total Amount",render:M=>n.jsxs("span",{className:"font-semibold text-red-600",children:["Rp ",M.total_amount.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})},{key:"payment_status",label:"Status",render:M=>n.jsx("span",{className:`inline-block px-2 py-1 rounded-full text-xs font-medium ${S(M.payment_status)}`,children:M.payment_status.toUpperCase()})}],V=[{key:"payment_number",label:"Payment Number",render:M=>n.jsx("span",{className:"font-medium text-gray-900",children:M.payment_number})},{key:"bill",label:"Bill Number",render:M=>{var se;return((se=M.vendor_bills)==null?void 0:se.bill_number)||"N/A"}},{key:"vendor",label:"Vendor",render:M=>{var se;return((se=M.vendor_bills)==null?void 0:se.vendor_name)||"N/A"}},{key:"payment_date",label:"Payment Date",render:M=>new Date(M.payment_date).toLocaleDateString()},{key:"amount",label:"Amount",render:M=>n.jsxs("span",{className:"font-semibold text-green-600",children:["Rp ",M.amount.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})},{key:"payment_method",label:"Method",render:M=>L(M.payment_method)},{key:"bank_account",label:"Bank Account",render:M=>M.bank_accounts?`${M.bank_accounts.account_name} - ${M.bank_accounts.bank_name}`:"N/A"}],W=s.filter(M=>M.payment_status!=="paid");return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsx("div",{className:"bg-gradient-to-br from-red-500 to-red-600 rounded-lg shadow p-6 text-white",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-red-100",children:"Total Payable"}),n.jsxs("p",{className:"text-2xl font-bold mt-1",children:["Rp ",P.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),n.jsx(hn,{className:"w-8 h-8 text-red-200"})]})}),n.jsx("div",{className:"bg-orange-50 rounded-lg shadow p-6",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-orange-600",children:"Overdue Bills"}),n.jsx("p",{className:"text-2xl font-bold text-orange-600 mt-1",children:I.length})]}),n.jsx(En,{className:"w-8 h-8 text-orange-400"})]})}),n.jsx("div",{className:"bg-blue-50 rounded-lg shadow p-6",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-blue-600",children:"Total Bills"}),n.jsx("p",{className:"text-2xl font-bold text-blue-600 mt-1",children:s.length})]}),n.jsx(Zt,{className:"w-8 h-8 text-blue-400"})]})})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("button",{onClick:()=>a("bills"),className:`px-4 py-2 rounded-lg transition ${r==="bills"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[n.jsx(Zt,{className:"w-4 h-4 inline mr-2"}),"Bills"]}),n.jsxs("button",{onClick:()=>a("payments"),className:`px-4 py-2 rounded-lg transition ${r==="payments"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[n.jsx(hn,{className:"w-4 h-4 inline mr-2"}),"Payments"]})]}),e&&n.jsxs("div",{className:"flex gap-2",children:[r==="bills"&&n.jsxs("button",{onClick:()=>{re(),A(!0)},className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition",children:[n.jsx(Pr,{className:"w-5 h-5"}),"Add Bill"]}),r==="payments"&&n.jsxs("button",{onClick:()=>{U(),p(!0)},className:"flex items-center gap-2 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition",children:[n.jsx(Pr,{className:"w-5 h-5"}),"Record Payment"]})]})]}),r==="bills"?n.jsx(Fs,{columns:H,data:s,loading:u,actions:e?M=>n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>z(M),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",children:n.jsx(Aa,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>Y(M.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",children:n.jsx(Lr,{className:"w-4 h-4"})})]}):void 0}):n.jsx(Fs,{columns:V,data:o,loading:u,actions:e?M=>n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>ee(M),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",children:n.jsx(Aa,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>G(M.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",children:n.jsx(Lr,{className:"w-4 h-4"})})]}):void 0}),n.jsx(Ot,{isOpen:h,onClose:()=>{A(!1),re()},title:b?"Edit Vendor Bill":"Add Vendor Bill",children:n.jsxs("form",{onSubmit:R,className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vendor Name *"}),n.jsx("input",{type:"text",value:v.vendor_name,onChange:M=>_({...v,vendor_name:M.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vendor ID (Optional)"}),n.jsx("input",{type:"text",value:v.vendor_id,onChange:M=>_({...v,vendor_id:M.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category *"}),n.jsxs("select",{value:v.category||"",onChange:M=>_({...v,category:M.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[n.jsx("option",{value:"expense",children:"Expense"}),n.jsx("option",{value:"inventory",children:"Inventory"}),n.jsx("option",{value:"asset",children:"Asset"}),n.jsx("option",{value:"other",children:"Other"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bill Date *"}),n.jsx("input",{type:"date",value:v.bill_date,onChange:M=>_({...v,bill_date:M.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Due Date"}),n.jsx("input",{type:"date",value:v.due_date,onChange:M=>_({...v,due_date:M.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount (Rp) *"}),n.jsx("input",{type:"number",value:v.amount===0?"":v.amount,onChange:M=>_({...v,amount:M.target.value===""?0:Number(M.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,min:"0",step:"0.01"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tax Amount (Rp)"}),n.jsx("input",{type:"number",value:v.tax_amount===0?"":v.tax_amount,onChange:M=>_({...v,tax_amount:M.target.value===""?0:Number(M.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"0",step:"0.01"})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Total Amount"}),n.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:["Rp ",(v.amount+v.tax_amount).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),n.jsx("textarea",{value:v.description,onChange:M=>_({...v,description:M.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:3})]})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[n.jsx("button",{type:"button",onClick:()=>{A(!1),re()},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),n.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:b?"Update Bill":"Add Bill"})]})]})}),n.jsx(Ot,{isOpen:x,onClose:()=>{p(!1),U()},title:g?"Edit Payment":"Record Payment",children:n.jsxs("form",{onSubmit:q,className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bill *"}),n.jsxs("select",{value:j.bill_id,onChange:M=>{const se=M.target.value,K=W.find(he=>he.id===se);N({...j,bill_id:se,amount:K?K.total_amount:0})},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,disabled:!!g,children:[n.jsx("option",{value:"",children:"Select a bill"}),W.map(M=>n.jsxs("option",{value:M.id,children:[M.bill_number," - ",M.vendor_name," (Rp ",M.total_amount.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2}),")"]},M.id))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Date *"}),n.jsx("input",{type:"date",value:j.payment_date,onChange:M=>N({...j,payment_date:M.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount (Rp) *"}),n.jsx("input",{type:"number",value:j.amount===0?"":j.amount,onChange:M=>N({...j,amount:M.target.value===""?0:Number(M.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,min:"0",step:"0.01"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Method *"}),n.jsxs("select",{value:j.payment_method,onChange:M=>N({...j,payment_method:M.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[n.jsx("option",{value:"bank_transfer",children:"Bank Transfer"}),n.jsx("option",{value:"cash",children:"Cash"}),n.jsx("option",{value:"cheque",children:"Cheque"}),n.jsx("option",{value:"credit_card",children:"Credit Card"}),n.jsx("option",{value:"other",children:"Other"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bank Account"}),n.jsxs("select",{value:j.bank_account_id,onChange:M=>N({...j,bank_account_id:M.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"",children:"Select bank account"}),c.map(M=>n.jsxs("option",{value:M.id,children:[M.account_name," - ",M.bank_name]},M.id))]})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reference Number"}),n.jsx("input",{type:"text",value:j.reference_number,onChange:M=>N({...j,reference_number:M.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Transaction/Check number"})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),n.jsx("textarea",{value:j.notes,onChange:M=>N({...j,notes:M.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:3})]})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[n.jsx("button",{type:"button",onClick:()=>{p(!1),U()},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),n.jsx("button",{type:"submit",className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition",children:g?"Update Payment":"Record Payment"})]})]})})]})}function AAe(){const{t:e}=cn(),[t,r]=Q.useState([]),[a,s]=Q.useState(!0),[i,o]=Q.useState(new Date().toISOString().split("T")[0]),[l,c]=Q.useState(new Set);Q.useEffect(()=>{d()},[i]);const d=async()=>{try{s(!0);const{data:m,error:g}=await Z.from("sales_invoices").select("*, customers(company_name)").in("payment_status",["pending","partial"]).order("due_date");if(g)throw g;const y=await Promise.all((m||[]).map(async j=>{var T;const{data:N}=await Z.rpc("get_invoice_paid_amount",{p_invoice_id:j.id}),B=N||0,E=j.total_amount-B,C=new Date(j.due_date),k=new Date(i),w=Math.floor((k.getTime()-C.getTime())/(1e3*60*60*24));return{id:j.id,customer_id:j.customer_id,customer_name:((T=j.customers)==null?void 0:T.company_name)||"Unknown",invoice_number:j.invoice_number,invoice_date:j.invoice_date,due_date:j.due_date,total_amount:j.total_amount,paid_amount:B,balance:E,days_overdue:w}})),v=new Map;y.forEach(j=>{const N=j.customer_id;v.has(N)||v.set(N,{customer_id:N,customer_name:j.customer_name,total_outstanding:0,invoice_count:0,oldest_overdue_days:-999,invoices:[]});const B=v.get(N);B.total_outstanding+=j.balance,B.invoice_count+=1,B.oldest_overdue_days=Math.max(B.oldest_overdue_days,j.days_overdue),B.invoices.push(j)});const _=Array.from(v.values()).sort((j,N)=>j.oldest_overdue_days!==N.oldest_overdue_days?N.oldest_overdue_days-j.oldest_overdue_days:N.total_outstanding-j.total_outstanding);r(_)}catch(m){console.error("Error loading ageing data:",m),alert("Failed to load ageing report")}finally{s(!1)}},u=m=>{const g=new Set(l);g.has(m)?g.delete(m):g.add(m),c(g)},f=()=>{const m=[];m.push(["Customer","Total Outstanding","Invoices","Oldest Overdue (Days)","Status"]),t.forEach(j=>{m.push([j.customer_name,j.total_outstanding.toString(),j.invoice_count.toString(),j.oldest_overdue_days.toString(),j.oldest_overdue_days>90?"CRITICAL":j.oldest_overdue_days>0?"OVERDUE":"CURRENT"]),m.push(["","Invoice #","Invoice Date","Due Date","Amount","Paid","Balance","Days Overdue"]),j.invoices.forEach(N=>{m.push(["",N.invoice_number,N.invoice_date,N.due_date,N.total_amount.toString(),N.paid_amount.toString(),N.balance.toString(),N.days_overdue.toString()])}),m.push([""])});const g=m.map(j=>j.join(",")).join(`
`),y=new Blob([g],{type:"text/csv"}),v=URL.createObjectURL(y),_=document.createElement("a");_.href=v,_.download=`ageing_report_${i}.csv`,_.click(),URL.revokeObjectURL(v)},h=m=>m<0?"text-green-600":m===0?"text-gray-600":m<=30?"text-yellow-600":m<=60?"text-orange-600":m<=90?"text-red-600":"text-red-900 font-bold",A=m=>m<0?{text:e("not_due","Not Due"),color:"bg-green-100 text-green-800"}:m===0?{text:e("due_today","Due Today"),color:"bg-gray-100 text-gray-800"}:m<=30?{text:`${m}d ${e("overdue","Overdue")}`,color:"bg-yellow-100 text-yellow-800"}:m<=60?{text:`${m}d ${e("overdue","Overdue")}`,color:"bg-orange-100 text-orange-800"}:m<=90?{text:`${m}d ${e("overdue","Overdue")}`,color:"bg-red-100 text-red-800"}:{text:`${m}d ${e("critical","CRITICAL")}`,color:"bg-red-200 text-red-900 font-bold"},x=t.reduce((m,g)=>m+g.total_outstanding,0),p=t.reduce((m,g)=>m+g.invoice_count,0),b=t.filter(m=>m.oldest_overdue_days>90).length;return n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center justify-between bg-white rounded-lg shadow-sm border border-gray-200 p-2",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("div",{className:"text-xs font-medium text-gray-700",children:[e("as_of_date","As of Date"),":"]}),n.jsx("input",{type:"date",value:i,onChange:m=>o(m.target.value),className:"border border-gray-300 rounded px-2 py-1 text-xs focus:ring-2 focus:ring-blue-500"})]}),n.jsxs("button",{onClick:f,disabled:t.length===0,className:"flex items-center gap-1.5 bg-green-600 text-white px-2.5 py-1.5 rounded text-xs hover:bg-green-700 transition disabled:opacity-50",children:[n.jsx(x7,{className:"w-3.5 h-3.5"}),e("export_csv","Export CSV")]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-2",children:[n.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-2.5 border-l-4 border-blue-500",children:[n.jsx("p",{className:"text-[10px] text-gray-600",children:e("total_outstanding","Total Outstanding")}),n.jsxs("p",{className:"text-base font-bold text-gray-900 mt-0.5",children:["Rp ",x.toLocaleString("id-ID",{minimumFractionDigits:2})]})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-2.5 border-l-4 border-gray-400",children:[n.jsx("p",{className:"text-[10px] text-gray-600",children:e("total_invoices","Total Invoices")}),n.jsx("p",{className:"text-base font-bold text-gray-900 mt-0.5",children:p})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-2.5 border-l-4 border-orange-500",children:[n.jsx("p",{className:"text-[10px] text-gray-600",children:e("customers","Customers")}),n.jsx("p",{className:"text-base font-bold text-gray-900 mt-0.5",children:t.length})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-2.5 border-l-4 border-red-600",children:[n.jsxs("p",{className:"text-[10px] text-gray-600 flex items-center gap-1",children:[n.jsx(Ga,{className:"w-3 h-3 text-red-600"}),e("critical_90_days","Critical (90+ days)")]}),n.jsx("p",{className:"text-base font-bold text-red-900 mt-0.5",children:b})]})]}),n.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:a?n.jsxs("div",{className:"p-8 text-center",children:[n.jsx("div",{className:"inline-block animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),n.jsxs("p",{className:"mt-2 text-sm text-gray-500",children:[e("loading","Loading ageing data"),"..."]})]}):t.length===0?n.jsxs("div",{className:"p-8 text-center text-gray-500",children:[n.jsx("p",{className:"text-sm font-medium",children:e("no_outstanding","No Outstanding Invoices")}),n.jsx("p",{className:"text-xs mt-1",children:e("all_paid","All invoices are fully paid!")})]}):n.jsx("div",{className:"divide-y divide-gray-200",children:t.map(m=>{const g=l.has(m.customer_id),y=A(m.oldest_overdue_days);return n.jsxs("div",{children:[n.jsxs("div",{onClick:()=>u(m.customer_id),className:"p-2.5 hover:bg-gray-50 cursor-pointer flex items-center justify-between",children:[n.jsxs("div",{className:"flex-1 flex items-center gap-3",children:[n.jsx("button",{className:"text-gray-400 hover:text-gray-600",children:g?n.jsx(Rg,{className:"w-4 h-4"}):n.jsx(Cs,{className:"w-4 h-4"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-medium text-sm text-gray-900",children:m.customer_name}),n.jsxs("p",{className:"text-xs text-gray-500",children:[m.invoice_count," ",e("invoices","invoice(s)")]})]})]}),n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"text-right",children:n.jsxs("p",{className:"font-bold text-sm text-gray-900",children:["Rp ",m.total_outstanding.toLocaleString("id-ID",{minimumFractionDigits:2})]})}),n.jsx("div",{className:"w-28",children:n.jsx("span",{className:`inline-block px-2 py-0.5 rounded-full text-[10px] ${y.color}`,children:y.text})})]})]}),g&&n.jsx("div",{className:"bg-gray-50 px-3 pb-3",children:n.jsxs("table",{className:"w-full text-xs",children:[n.jsx("thead",{className:"border-b border-gray-300",children:n.jsxs("tr",{className:"text-[10px] text-gray-600",children:[n.jsx("th",{className:"text-left py-1.5 px-2",children:e("invoice_number","Invoice #")}),n.jsx("th",{className:"text-left py-1.5 px-2",children:e("invoice_date","Invoice Date")}),n.jsx("th",{className:"text-left py-1.5 px-2",children:e("due_date","Due Date")}),n.jsx("th",{className:"text-right py-1.5 px-2",children:e("amount","Amount")}),n.jsx("th",{className:"text-right py-1.5 px-2",children:e("paid","Paid")}),n.jsx("th",{className:"text-right py-1.5 px-2",children:e("balance","Balance")}),n.jsx("th",{className:"text-center py-1.5 px-2",children:e("days_overdue","Days Overdue")})]})}),n.jsx("tbody",{className:"divide-y divide-gray-200",children:m.invoices.map(v=>n.jsxs("tr",{className:"hover:bg-gray-100",children:[n.jsx("td",{className:"py-1.5 px-2 font-mono text-blue-600",children:v.invoice_number}),n.jsx("td",{className:"py-1.5 px-2",children:new Date(v.invoice_date).toLocaleDateString("id-ID")}),n.jsx("td",{className:"py-1.5 px-2",children:new Date(v.due_date).toLocaleDateString("id-ID")}),n.jsxs("td",{className:"py-1.5 px-2 text-right",children:["Rp ",v.total_amount.toLocaleString("id-ID",{minimumFractionDigits:2})]}),n.jsxs("td",{className:"py-1.5 px-2 text-right text-green-600",children:["Rp ",v.paid_amount.toLocaleString("id-ID",{minimumFractionDigits:2})]}),n.jsxs("td",{className:"py-1.5 px-2 text-right font-medium",children:["Rp ",v.balance.toLocaleString("id-ID",{minimumFractionDigits:2})]}),n.jsx("td",{className:"py-1.5 px-2 text-center",children:n.jsx("span",{className:`font-medium ${h(v.days_overdue)}`,children:v.days_overdue<0?`${e("due_in","Due in")} ${Math.abs(v.days_overdue)}d`:v.days_overdue===0?e("today","Today"):`${v.days_overdue}d`})})]},v.id))})]})})]},m.customer_id)})})})]})}function hAe({canManage:e}){var yt,Et,It,ir;const[t,r]=Q.useState([]),[a,s]=Q.useState(""),[i,o]=Q.useState(null),[l,c]=Q.useState([]),[d,u]=Q.useState(!1),[f,h]=Q.useState(!1),[A,x]=Q.useState("unmatched"),[p,b]=Q.useState(null),{dateRange:m}=rl(),g={start:m.startDate,end:m.endDate},[y,v]=Q.useState(null),[_,j]=Q.useState(!1),[N,B]=Q.useState([]),[E,C]=Q.useState(!1),k=Q.useRef(null),[w,T]=Q.useState(null),[R,q]=Q.useState(null),[z,ee]=Q.useState(null),[Y,G]=Q.useState(null),[re,U]=Q.useState(!1),[S,D]=Q.useState({debit:0,credit:0,description:""}),[L,P]=Q.useState(null),[I,H]=Q.useState(!1),[V,W]=Q.useState([]),M=[{value:"duty_customs",label:"Duty & Customs (BM)",type:"import",requiresContainer:!0,group:"Import Costs"},{value:"ppn_import",label:"PPN Import",type:"operations",requiresContainer:!1,group:"Operations"},{value:"pph_import",label:"PPh Import",type:"import",requiresContainer:!0,group:"Import Costs"},{value:"freight_import",label:"Freight (Import)",type:"import",requiresContainer:!0,group:"Import Costs"},{value:"clearing_forwarding",label:"Clearing & Forwarding",type:"import",requiresContainer:!0,group:"Import Costs"},{value:"port_charges",label:"Port Charges",type:"import",requiresContainer:!0,group:"Import Costs"},{value:"container_handling",label:"Container Handling",type:"import",requiresContainer:!0,group:"Import Costs"},{value:"transport_import",label:"Transportation (Import)",type:"import",requiresContainer:!0,group:"Import Costs"},{value:"loading_import",label:"Loading / Unloading (Import)",type:"import",requiresContainer:!0,group:"Import Costs"},{value:"bpom_ski_fees",label:"BPOM / SKI Fees",type:"import",requiresContainer:!0,group:"Import Costs"},{value:"other_import",label:"Other (Import)",type:"import",requiresContainer:!0,group:"Import Costs"},{value:"delivery_sales",label:"Delivery / Dispatch (Sales)",type:"sales",requiresContainer:!1,group:"Sales & Distribution"},{value:"loading_sales",label:"Loading / Unloading (Sales)",type:"sales",requiresContainer:!1,group:"Sales & Distribution"},{value:"other_sales",label:"Other (Sales)",type:"sales",requiresContainer:!1,group:"Sales & Distribution"},{value:"salary",label:"Salary",type:"staff",requiresContainer:!1,group:"Staff Costs"},{value:"staff_overtime",label:"Staff Overtime",type:"staff",requiresContainer:!1,group:"Staff Costs"},{value:"staff_welfare",label:"Staff Welfare / Allowances",type:"staff",requiresContainer:!1,group:"Staff Costs"},{value:"travel_conveyance",label:"Travel & Conveyance",type:"staff",requiresContainer:!1,group:"Staff Costs"},{value:"warehouse_rent",label:"Warehouse Rent",type:"operations",requiresContainer:!1,group:"Operations"},{value:"utilities",label:"Utilities",type:"operations",requiresContainer:!1,group:"Operations"},{value:"bank_charges",label:"Bank Charges",type:"operations",requiresContainer:!1,group:"Operations"},{value:"office_admin",label:"Office & Admin",type:"admin",requiresContainer:!1,group:"Administrative"},{value:"office_shifting_renovation",label:"Office Shifting & Renovation",type:"admin",requiresContainer:!1,group:"Administrative"},{value:"other",label:"Other",type:"admin",requiresContainer:!1,group:"Administrative"}];Q.useEffect(()=>{K(),he(),se();const Oe=Z.channel("bank-statement-recon-changes").on("postgres_changes",{event:"*",schema:"public",table:"bank_statement_lines"},()=>{a&&ne()}).subscribe(),tt=Z.channel("expense-recon-changes").on("postgres_changes",{event:"*",schema:"public",table:"finance_expenses"},()=>{he(),a&&ne()}).subscribe();return()=>{Oe.unsubscribe(),tt.unsubscribe()}},[]);const se=async()=>{const{data:Oe}=await Z.from("customers").select("id, company_name").order("company_name");Oe&&W(Oe)};Q.useEffect(()=>{if(a){const Oe=t.find(tt=>tt.id===a);o(Oe||null),ne()}},[a,m]);const K=async()=>{try{const{data:Oe,error:tt}=await Z.from("bank_accounts").select("id, account_name, bank_name, account_number, currency").eq("is_active",!0).order("account_name");if(tt)throw tt;if(r(Oe||[]),Oe&&Oe.length>0){const At=Oe.find(wt=>wt.bank_name==="BCA Bank"&&wt.account_number==="0930 2010 22"&&wt.currency==="IDR");s((At==null?void 0:At.id)||Oe[0].id)}}catch(Oe){console.error("Error loading bank accounts:",Oe)}},he=async()=>{try{const{data:Oe,error:tt}=await Z.from("finance_expenses").select(`
          id,
          expense_date,
          description,
          amount,
          expense_category,
          voucher_number
        `).order("expense_date",{ascending:!1});if(tt)throw tt;const{data:At}=await Z.from("bank_statement_lines").select("matched_expense_id").not("matched_expense_id","is",null),wt=new Set((At||[]).map(Ft=>Ft.matched_expense_id)),ht=(Oe||[]).filter(Ft=>!wt.has(Ft.id));B(ht)}catch(Oe){console.error("Error loading expenses:",Oe)}},ne=async()=>{if(a){u(!0);try{const Oe=new Date(g.end);Oe.setDate(Oe.getDate()+1);const tt=Oe.toISOString().split("T")[0],{data:At,error:wt}=await Z.from("bank_statement_lines").select("*").eq("bank_account_id",a).gte("transaction_date",g.start).lt("transaction_date",tt).order("transaction_date",{ascending:!1});if(wt)throw wt;const ht=(At||[]).map(ue=>ue.matched_expense_id).filter(Boolean),Ft=(At||[]).map(ue=>ue.matched_receipt_id).filter(Boolean),Ht=(At||[]).map(ue=>ue.matched_fund_transfer_id).filter(Boolean),vr=new Map;if(ht.length>0){const{data:ue}=await Z.from("finance_expenses").select("id, expense_category, amount, description, expense_date, voucher_number").in("id",ht);ue==null||ue.forEach(ie=>vr.set(ie.id,ie))}const xr=new Map;if(Ft.length>0){const{data:ue}=await Z.from("receipt_vouchers").select("id, amount, voucher_date, voucher_number, customer_id, customers(company_name)").in("id",Ft);ue==null||ue.forEach(ie=>{var Ae;xr.set(ie.id,{id:ie.id,amount:ie.amount,payment_date:ie.voucher_date,payment_number:ie.voucher_number,customer_name:(Ae=ie.customers)==null?void 0:Ae.company_name})})}const Jt=new Map;if(Ht.length>0){const{data:ue}=await Z.from("fund_transfers").select("id, transfer_number, amount, description, transfer_date, from_account_type, to_account_type").in("id",Ht);ue==null||ue.forEach(ie=>Jt.set(ie.id,ie))}const Wt=(At||[]).map(ue=>({id:ue.id,date:ue.transaction_date,description:ue.description||"",reference:ue.reference||"",debit:ue.debit_amount||0,credit:ue.credit_amount||0,balance:ue.running_balance||0,currency:ue.currency||"IDR",status:ue.reconciliation_status||"unmatched",matchedEntry:ue.matched_entry_id,matchedExpenseId:ue.matched_expense_id,matchedReceiptId:ue.matched_receipt_id,matchedFundTransferId:ue.matched_fund_transfer_id,matchedExpense:ue.matched_expense_id?vr.get(ue.matched_expense_id):null,matchedReceipt:ue.matched_receipt_id?xr.get(ue.matched_receipt_id):null,matchedFundTransfer:ue.matched_fund_transfer_id?Jt.get(ue.matched_fund_transfer_id):null,notes:ue.notes}));c(Wt)}catch(Oe){console.error("Error loading statement lines:",Oe),c([])}finally{u(!1)}}},te=Oe=>{if(!Oe)return 0;const tt=Oe.replace(/[^\d,\.]/g,"");if(tt.includes(",")&&tt.includes(".")){const At=tt.lastIndexOf(","),wt=tt.lastIndexOf(".");return At>wt?parseFloat(tt.replace(/\./g,"").replace(/,/g,"."))||0:parseFloat(tt.replace(/,/g,""))||0}else return tt.includes(",")?parseFloat(tt.replace(/,/g,"."))||0:parseFloat(tt.replace(/,/g,""))||0},ce=(Oe,tt=";")=>{const At=[];let wt="",ht=!1;for(let Ft=0;Ft<Oe.length;Ft++){const Ht=Oe[Ft];Ht==='"'?ht=!ht:Ht===tt&&!ht?(At.push(wt.trim()),wt=""):wt+=Ht}return At.push(wt.trim()),At},_e=async Oe=>{try{const tt=new FileReader;tt.onload=async At=>{var wt,ht;try{const Ft=(wt=At.target)==null?void 0:wt.result,Ht=Ft.split(`
`).slice(0,5).join(`
`),vr=(Ht.match(/,/g)||[]).length,xr=(Ht.match(/;/g)||[]).length,Jt=vr>xr?",":";";console.log(` Detected delimiter: "${Jt}" (commas: ${vr}, semicolons: ${xr})`);const Wt=[];let ue="",ie=!1;for(let Pt=0;Pt<Ft.length;Pt++){const jr=Ft[Pt];if(jr==='"')ie=!ie,ue+=jr;else if(jr===`
`&&!ie){if(ue.trim()){const tr=ce(ue,Jt);Wt.push(tr)}ue=""}else jr!=="\r"&&(ue+=jr)}if(ue.trim()){const Pt=ce(ue,Jt);Wt.push(Pt)}console.log(" CSV rows parsed:",Wt.length),console.log(" First 10 rows:"),Wt.slice(0,10).forEach((Pt,jr)=>{console.log(`Row ${jr}:`,Pt)});const Ae=new Date().getFullYear(),le=prompt(`CSV contains dates without year (e.g., 01/12).
Which year is this statement for?`,String(Ae-1));if(!le){alert(" Year is required to process the CSV");return}const ve=parseInt(le);if(isNaN(ve)||ve<2e3||ve>2100){alert(" Invalid year provided");return}const{lines:me,metadata:Pe}=Re(Wt,ve);if(console.log(" Parsed lines:",me.length),console.log(" Metadata:",Pe),me.length===0){alert(" No transactions found in the CSV file. Check browser console for details.");return}const{data:Qe,error:Ke}=await Z.from("bank_statement_uploads").insert({bank_account_id:a,statement_period:Pe.period||`${new Date().toLocaleString("default",{month:"long"})} ${new Date().getFullYear()}`,statement_start_date:Pe.startDate||g.start,statement_end_date:Pe.endDate||g.end,currency:(i==null?void 0:i.currency)||"IDR",opening_balance:Pe.openingBalance||0,closing_balance:Pe.closingBalance||((ht=me[me.length-1])==null?void 0:ht.balance)||0,total_debits:Pe.totalDebits||me.reduce((Pt,jr)=>Pt+jr.debit,0),total_credits:Pe.totalCredits||me.reduce((Pt,jr)=>Pt+jr.credit,0),transaction_count:me.length,status:"completed"}).select().single();if(Ke)throw Ke;const{data:{user:Xe}}=await Z.auth.getUser(),Me=me.map(Pt=>({upload_id:Qe.id,bank_account_id:a,transaction_date:Pt.date,description:Pt.description,reference:Pt.reference,debit_amount:Pt.debit,credit_amount:Pt.credit,running_balance:Pt.balance,statement_balance:Pt.balance,currency:(i==null?void 0:i.currency)||"IDR",reconciliation_status:"unmatched",created_by:Xe==null?void 0:Xe.id})),{data:Ce}=await Z.from("bank_statement_lines").select("transaction_date, description, debit_amount, credit_amount, running_balance").eq("bank_account_id",a),We=Me.filter(Pt=>Ce==null?void 0:Ce.some(jr=>jr.transaction_date===Pt.transaction_date&&jr.description===Pt.description&&jr.debit_amount===Pt.debit_amount&&jr.credit_amount===Pt.credit_amount&&jr.running_balance===Pt.running_balance));let Je=Me;if(We.length>0){let Pt=` Found ${We.length} potential duplicate transaction(s):

`;We.slice(0,5).forEach((tr,Er)=>{const Hr=new Date(tr.transaction_date).toLocaleDateString("en-GB"),Gs=tr.debit_amount||tr.credit_amount;Pt+=`${Er+1}. ${Hr} - ${tr.description.substring(0,40)} - Rp ${Gs.toLocaleString()}
`}),We.length>5&&(Pt+=`... and ${We.length-5} more
`),Pt+=`
Do you want to ADD them anyway?
(Click OK to add, Cancel to skip duplicates)`,confirm(Pt)||(Je=Me.filter(tr=>!(Ce!=null&&Ce.some(Er=>Er.transaction_date===tr.transaction_date&&Er.description===tr.description&&Er.debit_amount===tr.debit_amount&&Er.credit_amount===tr.credit_amount&&Er.running_balance===tr.running_balance))))}if(Je.length===0){alert(" No new transactions to import (all were duplicates and skipped)");return}const{data:ot,error:lt}=await Z.from("bank_statement_lines").insert(Je).select();if(lt)throw console.error("Insert error:",lt),lt;const kt=(ot==null?void 0:ot.length)||0,Xt=Me.length-Je.length;let $t=` CSV Import complete!
`;$t+=`   Total processed: ${Me.length} transaction(s)
`,$t+=`   New transactions added: ${kt}
`,Xt>0&&($t+=`   Duplicates skipped: ${Xt}`),alert($t);try{await ne()}catch(Pt){console.error("Load statement lines error:",Pt)}if(kt>0)try{await et()}catch(Pt){console.error("Auto-match error:",Pt)}}catch(Ft){console.error("CSV parsing error:",Ft),alert(` Error parsing CSV: ${Ft.message}`)}},tt.onerror=()=>{console.error("FileReader error"),alert(" Failed to read CSV file")},tt.readAsText(Oe)}catch(tt){console.error("CSV upload error:",tt),alert(` Failed to read CSV: ${tt.message}`)}},de=async Oe=>{var At;const tt=(At=Oe.target.files)==null?void 0:At[0];if(!(!tt||!a||!i)){h(!0);try{const wt=tt.type==="application/pdf"||tt.name.toLowerCase().endsWith(".pdf"),ht=tt.type.startsWith("image/")||tt.name.match(/\.(png|jpg|jpeg)$/i),Ft=tt.name.toLowerCase().endsWith(".csv");wt?await ye(tt):ht?await ye(tt,!0):Ft?await _e(tt):await ge(tt)}catch(wt){console.error("File upload error:",wt)}finally{h(!1),k.current&&(k.current.value="")}}},ye=async(Oe,tt=!1,At=!1)=>{try{h(!0),T(null);const wt=new FormData;wt.append("file",Oe),wt.append("bankAccountId",a),tt&&wt.append("useOCR","true"),At&&wt.append("previewOnly","true");const{data:{session:ht}}=await Z.auth.getSession();if(!ht)throw new Error("Not authenticated");const Ft=await fetch("https://dkrtsqienlhpouohmfki.supabase.co/functions/v1/parse-bca-statement",{method:"POST",headers:{Authorization:`Bearer ${ht.access_token}`},body:wt}),Ht=await Ft.json();if(!Ft.ok){if(Ht.canUseOCR)T({message:Ht.error,canUseOCR:!0,suggestions:Ht.suggestions}),ee(Oe);else throw new Error(Ht.error||"Failed to parse PDF");return}if(Ht.preview){q(Ht);return}const vr=Ht.usedOCR?" (via OCR)":"";let xr=` Import complete from ${Ht.period}${vr}
`;xr+=`   Imported: ${Ht.insertedCount||Ht.transactionCount} transaction(s)`,Ht.duplicateCount>0&&(xr+=`
   Skipped (duplicates): ${Ht.duplicateCount} transaction(s)`),alert(xr),T(null),ee(null);try{await ne()}catch(Wt){console.error("Load statement lines error:",Wt)}if((Ht.insertedCount||Ht.transactionCount||0)>0)try{await et()}catch(Wt){console.error("Auto-match error:",Wt)}}catch(wt){console.error("PDF upload error:",wt),alert(` Failed to parse PDF: ${wt.message}`)}finally{h(!1)}},Le=async()=>{if(z){h(!0),T(null);try{await ye(z,!0,!0)}catch(Oe){alert(` OCR failed: ${Oe.message}`),h(!1)}}},we=async()=>{if(z){q(null),h(!0);try{await ye(z,!0,!1)}catch(Oe){alert(` Failed to save: ${Oe.message}`)}finally{h(!1)}}},ge=async Oe=>{try{const tt=new FileReader;tt.onload=async At=>{var wt,ht;try{const Ft=(wt=At.target)==null?void 0:wt.result,Ht=xx(Ft,{type:"binary"}),vr=Ht.SheetNames[0],xr=Ht.Sheets[vr],Jt=va.sheet_to_json(xr,{header:1});console.log(" Raw Excel data rows:",Jt.length),console.log(" First 10 rows:"),Jt.slice(0,10).forEach((Je,ot)=>{console.log(`Row ${ot}:`,Je)});const{lines:Wt,metadata:ue}=Re(Jt);if(console.log(" Parsed lines:",Wt.length),console.log(" Metadata:",ue),Wt.length>0&&console.log(" First 3 transactions:",Wt.slice(0,3)),Wt.length===0){alert(" No valid transactions found in the file. Check browser console (F12) for details.");return}const{data:ie,error:Ae}=await Z.from("bank_statement_uploads").insert({bank_account_id:a,statement_period:ue.period||`${new Date().toLocaleString("default",{month:"long"})} ${new Date().getFullYear()}`,statement_start_date:ue.startDate||g.start,statement_end_date:ue.endDate||g.end,currency:(i==null?void 0:i.currency)||"IDR",opening_balance:ue.openingBalance||0,closing_balance:ue.closingBalance||((ht=Wt[Wt.length-1])==null?void 0:ht.balance)||0,total_debits:ue.totalDebits||Wt.reduce((Je,ot)=>Je+ot.debit,0),total_credits:ue.totalCredits||Wt.reduce((Je,ot)=>Je+ot.credit,0),transaction_count:Wt.length,status:"completed"}).select().single();if(Ae)throw Ae;const{data:{user:le}}=await Z.auth.getUser(),ve=Wt.map(Je=>({upload_id:ie.id,bank_account_id:a,transaction_date:Je.date,description:Je.description,reference:Je.reference,debit_amount:Je.debit,credit_amount:Je.credit,running_balance:Je.balance,statement_balance:Je.balance,currency:(i==null?void 0:i.currency)||"IDR",reconciliation_status:"unmatched",created_by:le==null?void 0:le.id})),{data:me}=await Z.from("bank_statement_lines").select("transaction_date, description, debit_amount, credit_amount, running_balance").eq("bank_account_id",a),Pe=ve.filter(Je=>me==null?void 0:me.some(ot=>ot.transaction_date===Je.transaction_date&&ot.description===Je.description&&ot.debit_amount===Je.debit_amount&&ot.credit_amount===Je.credit_amount&&ot.running_balance===Je.running_balance));let Qe=ve;if(Pe.length>0){let Je=` Found ${Pe.length} potential duplicate transaction(s):

`;Pe.slice(0,5).forEach((lt,kt)=>{const Xt=new Date(lt.transaction_date).toLocaleDateString("en-GB"),$t=lt.debit_amount||lt.credit_amount;Je+=`${kt+1}. ${Xt} - ${lt.description.substring(0,40)} - Rp ${$t.toLocaleString()}
`}),Pe.length>5&&(Je+=`... and ${Pe.length-5} more
`),Je+=`
Do you want to ADD them anyway?
(Click OK to add, Cancel to skip duplicates)`,confirm(Je)||(Qe=ve.filter(lt=>!(me!=null&&me.some(kt=>kt.transaction_date===lt.transaction_date&&kt.description===lt.description&&kt.debit_amount===lt.debit_amount&&kt.credit_amount===lt.credit_amount&&kt.running_balance===lt.running_balance))))}if(Qe.length===0){alert(" No new transactions to import (all were duplicates and skipped)");return}const{data:Ke,error:Xe}=await Z.from("bank_statement_lines").insert(Qe).select();if(Xe)throw console.error("Insert error:",Xe),Xe;const Me=(Ke==null?void 0:Ke.length)||0,Ce=ve.length-Qe.length;let We=` Excel Import complete!
`;We+=`   Total processed: ${ve.length} transaction(s)
`,We+=`   New transactions added: ${Me}
`,Ce>0&&(We+=`   Duplicates skipped: ${Ce}`),alert(We);try{await ne()}catch(Je){console.error("Load statement lines error:",Je)}if(Me>0)try{await et()}catch(Je){console.error("Auto-match error:",Je)}}catch(Ft){console.error("Error parsing file:",Ft),alert(" Failed to parse file: "+Ft.message)}},tt.readAsBinaryString(Oe)}catch(tt){console.error("Excel upload error:",tt),alert(` Failed to process file: ${tt.message}`)}},Re=(Oe,tt)=>{const At=[],wt={period:"",startDate:"",endDate:"",openingBalance:0,closingBalance:0,totalDebits:0,totalCredits:0};let ht=tt||new Date().getFullYear();new Date().getMonth()+1;for(let ve=0;ve<Math.min(10,Oe.length);ve++){const me=Oe[ve];if(!me||me.length===0)continue;const Pe=String(me[0]||"");if(Pe.includes("Periode")){const Qe=Pe.match(/(\d{2})\/(\d{2})\/(\d{4})\s*-\s*(\d{2})\/(\d{2})\/(\d{4})/);if(Qe){const Ke=parseInt(Qe[1]),Xe=parseInt(Qe[2]),Me=parseInt(Qe[3]),Ce=parseInt(Qe[4]),We=parseInt(Qe[5]),Je=parseInt(Qe[6]);ht=Me,wt.startDate=`${Me}-${String(Xe).padStart(2,"0")}-${String(Ke).padStart(2,"0")}`,wt.endDate=`${Je}-${String(We).padStart(2,"0")}-${String(Ce).padStart(2,"0")}`;const ot=["","JANUARI","FEBRUARI","MARET","APRIL","MEI","JUNI","JULI","AGUSTUS","SEPTEMBER","OKTOBER","NOVEMBER","DESEMBER"];wt.period=`${ot[Xe]} ${Me}`}}}let Ft=-1;for(let ve=0;ve<Math.min(20,Oe.length);ve++){const me=Oe[ve];if(!me||me.length===0)continue;const Pe=me.map(Qe=>String(Qe||"").toLowerCase()).join("|");if((Pe.includes("tanggal")||Pe.includes("date")||Pe.includes("tgl"))&&(Pe.includes("keterangan")||Pe.includes("description")||Pe.includes("desc")||Pe.includes("mutasi")||Pe.includes("amount")||Pe.includes("saldo")||Pe.includes("balance"))){Ft=ve,console.log(` Found header at row ${ve}:`,me);break}}if(console.log(" Header row index:",Ft),Ft===-1)return console.error(" Could not find column headers"),console.log(" All rows checked:"),Oe.slice(0,20).forEach((ve,me)=>{console.log(`  Row ${me}:`,ve)}),{lines:At,metadata:wt};const Ht=Oe[Ft];let vr=-1,xr=-1,Jt=-1,Wt=-1,ue=-1,ie=-1,Ae=-1;if(Ht.forEach((ve,me)=>{const Pe=String(ve||"").toLowerCase();(Pe.includes("tanggal")||Pe.includes("date")||Pe.includes("tgl"))&&(vr=me),(Pe.includes("keterangan")||Pe.includes("description")||Pe.includes("desc"))&&(xr=me),(Pe.includes("cabang")||Pe.includes("branch"))&&(Jt=me),Pe.includes("mutasi")&&!Pe.includes("debet")&&!Pe.includes("kredit")&&(Wt=me),(Pe.includes("debet")||Pe.includes("debit")||Pe.includes("db"))&&(ie=me),(Pe.includes("kredit")||Pe.includes("credit")||Pe.includes("cr"))&&(Ae=me),(Pe.includes("saldo")||Pe.includes("balance"))&&(ue=me)}),console.log(" Column positions:",{dateCol:vr,descCol:xr,branchCol:Jt,amountCol:Wt,debitCol:ie,creditCol:Ae,balanceCol:ue}),console.log(" Header row cells:",Ht.map((ve,me)=>`[${me}]: "${ve}"`)),vr===-1)return console.error(" Missing date column"),console.log(" Header row:",Ht),{lines:At,metadata:wt};let le=0;for(let ve=Ft+1;ve<Oe.length;ve++){const me=Oe[ve];if(!me||me.length===0){le++;continue}const Pe=String(me[0]||"");if(Pe.includes("Saldo Awal")||Pe.includes("Mutasi Debet")||Pe.includes("Mutasi Kredit")||Pe.includes("Saldo Akhir")){console.log(` Stopped at footer row ${ve}: ${Pe}`);break}const Qe=me[vr];if(!Qe){le++,ve<Ft+5&&console.log(` Row ${ve}: No date value`);continue}let Ke="";if(typeof Qe=="number"){const ot=new Date(1900,0,1),lt=Qe-2,kt=new Date(ot.getTime()+lt*24*60*60*1e3);Ke=`${kt.getFullYear()}-${String(kt.getMonth()+1).padStart(2,"0")}-${String(kt.getDate()).padStart(2,"0")}`,ve<Ft+5&&console.log(` Row ${ve}: Excel serial ${Qe}  ${Ke}`)}else{const ot=String(Qe).trim(),lt=ot.match(/^(\d{1,2})\/(\d{1,2})$/);if(!lt){le++,ve<Ft+5&&console.log(` Row ${ve}: Date doesn't match pattern: "${ot}"`);continue}const kt=parseInt(lt[1]),Xt=parseInt(lt[2]);if(kt<1||kt>31||Xt<1||Xt>12){le++;continue}Ke=`${ht}-${String(Xt).padStart(2,"0")}-${String(kt).padStart(2,"0")}`}let Xe=0,Me=0;if(ie>=0&&Ae>=0){const ot=String(me[ie]||"").trim(),lt=String(me[Ae]||"").trim();Xe=te(ot),Me=te(lt)}else if(Wt>=0){const ot=String(me[Wt]||"").trim(),lt=me[Wt+1]?String(me[Wt+1]).trim().toUpperCase():"",kt=lt==="CR"||ot.includes(" CR"),Xt=lt==="DB"||ot.includes(" DB"),$t=te(ot);ve<Ft+3&&console.log(` Row ${ve} amount parsing:`,{amountStr:ot,dbCrIndicator:lt,isCR:kt,isDB:Xt,amount:$t}),kt?Me=$t:(Xt||$t>0)&&(Xe=$t)}let Ce=0;if(ue>=0){const ot=String(me[ue]||"").trim();Ce=te(ot)}let We="";if(xr>=0){const ot=String(me[xr]||"").trim(),lt=String(me[xr+1]||"").trim();We=ot+(lt?"; "+lt:"")}const Je=Jt>=0?String(me[Jt]||"").trim():"";ve<Ft+3&&console.log(` Row ${ve} parsed:`,{date:Ke,debit:Xe,credit:Me,balance:Ce,description:We.substring(0,50)}),At.push({id:`temp-${ve}`,date:Ke,description:We,reference:Je,debit:Xe,credit:Me,balance:Ce,currency:(i==null?void 0:i.currency)||"IDR",status:"unmatched"})}console.log(` Parsing complete: ${At.length} transactions, ${le} rows skipped`);for(let ve=0;ve<Oe.length;ve++){const me=Oe[ve];if(!me||me.length===0)continue;const Pe=String(me[0]||"");if(Pe.includes("Saldo Awal")||Pe.includes("SALDO AWAL"))for(let Qe=0;Qe<me.length;Qe++){const Ke=String(me[Qe]||"");if(Ke&&/[\d,\.]+/.test(Ke)){wt.openingBalance=te(Ke);break}}if(Pe.includes("Mutasi Debet")||Pe.includes("MUTASI DB")||Pe.includes("Mutasi DB"))for(let Qe=0;Qe<me.length;Qe++){const Ke=String(me[Qe]||"");if(Ke&&/[\d,\.]+/.test(Ke)){wt.totalDebits=te(Ke);break}}if(Pe.includes("Mutasi Kredit")||Pe.includes("MUTASI CR")||Pe.includes("Mutasi CR"))for(let Qe=0;Qe<me.length;Qe++){const Ke=String(me[Qe]||"");if(Ke&&/[\d,\.]+/.test(Ke)){wt.totalCredits=te(Ke);break}}if(Pe.includes("Saldo Akhir")||Pe.includes("SALDO AKHIR"))for(let Qe=0;Qe<me.length;Qe++){const Ke=String(me[Qe]||"");if(Ke&&/[\d,\.]+/.test(Ke)){wt.closingBalance=te(Ke);break}}}return{lines:At,metadata:wt}},et=async()=>{if(a)try{const{data:Oe,error:tt}=await Z.rpc("auto_match_smart");if(tt)throw tt;const At=Oe==null?void 0:Oe[0],wt=(At==null?void 0:At.matched_count)||0,ht=(At==null?void 0:At.suggested_count)||0,Ft=(At==null?void 0:At.skipped_count)||0;await ne();let Ht=` Auto-match complete!

`;Ht+=` Matched (85%+ confidence): ${wt}
`,Ht+=` Needs Review (70-84%): ${ht}
`,Ft>0&&(Ht+=` Skipped (already matched): ${Ft}
`),Ht+=`
 Date tolerance: 7 days maximum`,alert(Ht)}catch(Oe){console.error("Error auto-matching:",Oe),alert(" Auto-match failed: "+Oe.message)}},Ye=async()=>{if(a)try{const{data:Oe,error:tt}=await Z.rpc("preview_bank_statement_delete",{p_bank_account_id:a,p_start_date:g.start,p_end_date:g.end});if(tt)throw tt;P(Oe),H(!0)}catch(Oe){console.error("Error previewing delete:",Oe),alert(" Failed to preview: "+Oe.message)}},Be=async()=>{if(!(!a||!L))try{const{data:Oe,error:tt}=await Z.rpc("safe_delete_bank_statement_lines",{p_bank_account_id:a,p_start_date:g.start,p_end_date:g.end});if(tt)throw tt;Oe.success?(alert(` Successfully deleted ${Oe.deleted_count} unmatched transaction(s)`),H(!1),P(null),await ne()):alert(` ${Oe.error}`)}catch(Oe){console.error("Error clearing data:",Oe),alert(" Failed to clear data: "+Oe.message)}},Fe=async Oe=>{try{await Z.from("bank_statement_lines").update({reconciliation_status:"matched"}).eq("id",Oe),c(tt=>tt.map(At=>At.id===Oe?{...At,status:"matched"}:At))}catch(tt){console.error("Error confirming match:",tt)}},oe=async Oe=>{try{await Z.from("bank_statement_lines").update({reconciliation_status:"unmatched",matched_entry_id:null}).eq("id",Oe),c(tt=>tt.map(At=>At.id===Oe?{...At,status:"unmatched",matchedEntry:void 0,matched_entry_id:void 0}:At))}catch(tt){console.error("Error rejecting match:",tt)}},ke=Oe=>{v(Oe),j(!0)},Ue=async(Oe,tt,At)=>{try{const{data:{user:wt}}=await Z.auth.getUser();if(!wt)throw new Error("Not authenticated");const{data:ht,error:Ft}=await Z.from("finance_expenses").insert({expense_category:tt,amount:Oe.debit,expense_date:Oe.date,description:At||Oe.description,created_by:wt.id}).select().single();if(Ft)throw Ft;const{error:Ht}=await Z.from("bank_statement_lines").update({reconciliation_status:"recorded",matched_expense_id:ht.id,matched_at:new Date().toISOString(),matched_by:wt.id}).eq("id",Oe.id).select().single();if(Ht)throw Ht;j(!1),v(null),await ne(),alert(" Expense recorded and linked successfully")}catch(wt){console.error("Error recording expense:",wt),alert(" "+wt.message)}},qe=async(Oe,tt)=>{try{const{data:{user:At}}=await Z.auth.getUser();if(!At)throw new Error("Not authenticated");const{error:wt}=await Z.from("bank_statement_lines").update({reconciliation_status:"matched",matched_expense_id:tt,matched_at:new Date().toISOString(),matched_by:At.id}).eq("id",Oe.id).select().single();if(wt)throw wt;j(!1),v(null),C(!1),await ne(),alert(" Linked to expense successfully")}catch(At){console.error("Error linking to expense:",At),alert(" "+At.message)}},$e=async(Oe,tt,At,wt)=>{try{const{data:{user:ht}}=await Z.auth.getUser();if(!ht)throw new Error("Not authenticated");if(tt==="customer_payment"){if(!At)throw new Error("Please select a customer");const{data:Ft,error:Ht}=await Z.rpc("generate_voucher_number",{p_prefix:"RV"});if(Ht)throw Ht;const{data:vr,error:xr}=await Z.from("receipt_vouchers").insert({voucher_number:Ft,voucher_date:Oe.date,customer_id:At,payment_method:"bank_transfer",bank_account_id:a,reference_number:Oe.reference,amount:Oe.credit,description:wt||Oe.description,created_by:ht.id}).select().single();if(xr)throw xr;const{error:Jt}=await Z.from("bank_statement_lines").update({reconciliation_status:"recorded",matched_receipt_id:vr.id,matched_at:new Date().toISOString(),matched_by:ht.id}).eq("id",Oe.id);if(Jt)throw Jt;alert(` Receipt Voucher ${Ft} created successfully`)}else{const{error:Ft}=await Z.from("bank_statement_lines").update({reconciliation_status:"recorded",notes:`${tt}: ${wt}`,matched_at:new Date().toISOString(),matched_by:ht.id}).eq("id",Oe.id);if(Ft)throw Ft;alert(" Receipt recorded successfully")}j(!1),v(null),ne()}catch(ht){console.error("Error recording receipt:",ht),alert(" "+ht.message)}},Ne=l.filter(Oe=>A==="all"?!0:Oe.status===A),Ee=Oe=>{let tt="asc";p&&p.key===Oe&&p.direction==="asc"&&(tt="desc"),b({key:Oe,direction:tt})},ze=[...Ne].sort((Oe,tt)=>{if(!p)return 0;const{key:At,direction:wt}=p;let ht=Oe[At],Ft=tt[At];return At==="date"&&(ht=new Date(ht).getTime(),Ft=new Date(Ft).getTime()),(At==="debit"||At==="credit")&&(ht=Number(ht)||0,Ft=Number(Ft)||0),typeof ht=="string"&&(ht=ht.toLowerCase(),Ft=Ft.toLowerCase()),ht<Ft?wt==="asc"?-1:1:ht>Ft?wt==="asc"?1:-1:0}),rt={total:l.length,matched:l.filter(Oe=>Oe.status==="matched"||Oe.status==="recorded").length,suggested:l.filter(Oe=>Oe.status==="suggested").length,unmatched:l.filter(Oe=>Oe.status==="unmatched").length},nt=Oe=>Oe==="USD"?"$":"Rp",mt=Oe=>{G(Oe),D({debit:Oe.debit,credit:Oe.credit,description:Oe.description}),U(!0)},gt=async Oe=>{if(Oe.preventDefault(),!!Y)try{const{error:tt}=await Z.from("bank_statement_lines").update({debit_amount:S.debit,credit_amount:S.credit,description:S.description}).eq("id",Y.id);if(tt)throw tt;c(At=>At.map(wt=>wt.id===Y.id?{...wt,debit:S.debit,credit:S.credit,description:S.description}:wt)),U(!1),G(null),alert(" Bank statement line updated successfully")}catch(tt){console.error("Error updating line:",tt),alert(" "+tt.message)}},Nt=async()=>{if(!(!Y||!window.confirm(`Are you sure you want to unlink this transaction?

This will set its status back to "Unmatched" and remove the link to the expense/receipt.`)))try{const{error:tt}=await Z.from("bank_statement_lines").update({matched_expense_id:null,matched_receipt_id:null,matched_fund_transfer_id:null,matched_entry_id:null,reconciliation_status:"unmatched",matched_at:null,matched_by:null,notes:null}).eq("id",Y.id);if(tt)throw tt;c(At=>At.map(wt=>wt.id===Y.id?{...wt,status:"unmatched",matchedExpenseId:void 0,matchedReceiptId:void 0,matchedFundTransferId:void 0,matchedExpense:null,matchedReceipt:null,matchedFundTransfer:null,notes:void 0}:wt)),U(!1),G(null),alert(" Transaction unlinked successfully")}catch(tt){console.error("Error unlinking transaction:",tt),alert(" "+tt.message)}};return n.jsxs("div",{className:"space-y-4",children:[n.jsx("div",{className:"bg-gradient-to-r from-slate-700 to-slate-800 rounded-lg p-2.5 text-white shadow-md",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("h3",{className:"text-sm font-bold",children:"Bank Reconciliation"}),i&&n.jsxs("span",{className:"text-slate-300 text-xs",children:[i.bank_name," - ",i.account_number]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("div",{className:"bg-white/20 rounded px-2.5 py-1",children:[n.jsx("div",{className:"text-slate-200 text-[9px] leading-tight",children:"Matched"}),n.jsx("div",{className:"text-xs font-bold text-green-400",children:rt.matched})]}),n.jsxs("div",{className:"bg-white/20 rounded px-2.5 py-1",children:[n.jsx("div",{className:"text-slate-200 text-[9px] leading-tight",children:"Unmatched"}),n.jsx("div",{className:"text-xs font-bold text-red-400",children:rt.unmatched})]})]})]}),n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsxs("button",{onClick:()=>{et()},disabled:!a,className:"flex items-center gap-1.5 px-2.5 py-1.5 text-xs bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50 font-medium shadow-sm",title:"Auto-match",children:[n.jsx(Hs,{className:"w-3.5 h-3.5"}),"Match"]}),e&&n.jsxs(n.Fragment,{children:[n.jsx("button",{onClick:Ye,disabled:!a,className:"p-1.5 bg-white/20 rounded hover:bg-white/30 disabled:opacity-50",title:"Clear",children:n.jsx(gn,{className:"w-3.5 h-3.5"})}),n.jsx("input",{ref:k,type:"file",accept:".pdf,.xlsx,.xls,.csv,.png,.jpg,.jpeg",onChange:de,className:"hidden"}),n.jsxs("button",{onClick:()=>{var Oe;return(Oe=k.current)==null?void 0:Oe.click()},disabled:f||!a,className:"flex items-center gap-1.5 px-2.5 py-1.5 text-xs bg-white text-slate-700 rounded hover:bg-slate-50 disabled:opacity-50 font-medium shadow-sm",title:"Upload",children:[n.jsx(Rl,{className:"w-3.5 h-3.5"}),f?"Uploading":"Upload"]})]})]})]})}),n.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-2",children:n.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[n.jsx("select",{value:a,onChange:Oe=>s(Oe.target.value),className:"px-3 py-1.5 border border-gray-300 rounded-md text-xs font-medium",children:t.map(Oe=>n.jsxs("option",{value:Oe.id,children:[Oe.bank_name," - ",Oe.account_number]},Oe.id))}),n.jsx("div",{className:"h-6 w-px bg-gray-300"}),n.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[n.jsx(ja,{className:"w-3 h-3"}),n.jsxs("span",{children:[new Date(g.start).toLocaleDateString("en-GB"),"  ",new Date(g.end).toLocaleDateString("en-GB")]})]}),n.jsx("div",{className:"h-6 w-px bg-gray-300"}),n.jsxs("div",{className:"flex gap-1",children:[n.jsxs("button",{onClick:()=>x("all"),className:`px-3 py-1.5 rounded-md text-xs font-medium transition-all ${A==="all"?"bg-slate-700 text-white shadow-sm":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:["All (",rt.total,")"]}),n.jsxs("button",{onClick:()=>x("matched"),className:`px-3 py-1.5 rounded-md text-xs font-medium transition-all ${A==="matched"?"bg-green-600 text-white shadow-sm":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[" Matched (",rt.matched,")"]}),n.jsxs("button",{onClick:()=>x("suggested"),className:`px-3 py-1.5 rounded-md text-xs font-medium transition-all ${A==="suggested"?"bg-yellow-600 text-white shadow-sm":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[" Review (",rt.suggested,")"]}),n.jsxs("button",{onClick:()=>x("unmatched"),className:`px-3 py-1.5 rounded-md text-xs font-medium transition-all ${A==="unmatched"?"bg-red-600 text-white shadow-sm":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[" Unmatched (",rt.unmatched,")"]})]})]})}),d?n.jsx("div",{className:"flex items-center justify-center py-12 bg-white rounded-lg",children:n.jsx(Hs,{className:"w-6 h-6 animate-spin text-blue-600"})}):Ne.length===0?n.jsxs("div",{className:"text-center py-12 bg-white rounded-lg border-2 border-dashed",children:[n.jsx(_7,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),n.jsx("h3",{className:"text-lg font-medium text-gray-600 mb-1",children:"No Bank Transactions"}),n.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Upload a BCA PDF statement or Excel/CSV file to start reconciling"}),e&&n.jsxs("button",{onClick:()=>{var Oe;return(Oe=k.current)==null?void 0:Oe.click()},className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[n.jsx(Rl,{className:"w-4 h-4"}),"Upload Statement"]})]}):n.jsx("div",{className:"bg-white border rounded-lg overflow-hidden",children:n.jsxs("table",{className:"w-full text-sm",children:[n.jsx("thead",{className:"bg-gray-50 border-b",children:n.jsxs("tr",{children:[n.jsx("th",{onClick:()=>Ee("date"),className:"px-3 py-2 text-left font-medium text-gray-600 cursor-pointer hover:bg-gray-100 select-none",children:n.jsxs("div",{className:"flex items-center gap-1",children:["Date",(p==null?void 0:p.key)==="date"&&n.jsx("span",{className:"text-blue-600",children:p.direction==="asc"?"":""})]})}),n.jsx("th",{onClick:()=>Ee("description"),className:"px-3 py-2 text-left font-medium text-gray-600 cursor-pointer hover:bg-gray-100 select-none",children:n.jsxs("div",{className:"flex items-center gap-1",children:["Description",(p==null?void 0:p.key)==="description"&&n.jsx("span",{className:"text-blue-600",children:p.direction==="asc"?"":""})]})}),n.jsx("th",{onClick:()=>Ee("debit"),className:"px-3 py-2 text-right font-medium text-gray-600 cursor-pointer hover:bg-gray-100 select-none",children:n.jsxs("div",{className:"flex items-center justify-end gap-1",children:["Debit",(p==null?void 0:p.key)==="debit"&&n.jsx("span",{className:"text-blue-600",children:p.direction==="asc"?"":""})]})}),n.jsx("th",{onClick:()=>Ee("credit"),className:"px-3 py-2 text-right font-medium text-gray-600 cursor-pointer hover:bg-gray-100 select-none",children:n.jsxs("div",{className:"flex items-center justify-end gap-1",children:["Credit",(p==null?void 0:p.key)==="credit"&&n.jsx("span",{className:"text-blue-600",children:p.direction==="asc"?"":""})]})}),n.jsx("th",{onClick:()=>Ee("status"),className:"px-3 py-2 text-center font-medium text-gray-600 cursor-pointer hover:bg-gray-100 select-none",children:n.jsxs("div",{className:"flex items-center justify-center gap-1",children:["Status",(p==null?void 0:p.key)==="status"&&n.jsx("span",{className:"text-blue-600",children:p.direction==="asc"?"":""})]})}),n.jsx("th",{className:"px-3 py-2 text-center font-medium text-gray-600",children:"Actions"})]})}),n.jsxs("tbody",{className:"divide-y divide-gray-100",children:[ze.map(Oe=>n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-3 py-2 text-gray-700 whitespace-nowrap",children:new Date(Oe.date).toLocaleDateString("id-ID")}),n.jsxs("td",{className:"px-3 py-2 text-gray-700 max-w-md",children:[n.jsx("div",{className:"whitespace-pre-wrap text-sm leading-tight",children:Oe.description}),Oe.reference&&n.jsx("div",{className:"text-xs text-gray-500 font-mono mt-1",children:Oe.reference})]}),n.jsx("td",{className:"px-3 py-2 text-right text-red-600 font-medium whitespace-nowrap",children:Oe.debit>0?`${nt(Oe.currency)} ${Oe.debit.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})}`:"-"}),n.jsx("td",{className:"px-3 py-2 text-right text-green-600 font-medium whitespace-nowrap",children:Oe.credit>0?`${nt(Oe.currency)} ${Oe.credit.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})}`:"-"}),n.jsx("td",{className:"px-3 py-2",children:n.jsxs("div",{className:"flex flex-col gap-1",children:[(Oe.status==="matched"||Oe.status==="recorded")&&n.jsxs(n.Fragment,{children:[n.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-700",children:[n.jsx(Ss,{className:"w-3 h-3"})," Recorded"]}),Oe.matchedExpense&&n.jsxs("span",{className:"text-xs text-gray-600",children:[" Expense: ",Oe.matchedExpense.expense_category]}),Oe.matchedReceipt&&n.jsxs("span",{className:"text-xs text-gray-600",children:[" Receipt: ",Oe.matchedReceipt.customer_name||"Customer"]}),Oe.matchedFundTransfer&&n.jsxs("span",{className:"text-xs text-gray-600",children:[" Fund Transfer: ",Oe.matchedFundTransfer.from_account_type,"  ",Oe.matchedFundTransfer.to_account_type]}),!Oe.matchedExpense&&!Oe.matchedReceipt&&!Oe.matchedFundTransfer&&!Oe.matchedEntry&&n.jsx("span",{className:"text-xs text-orange-600 font-medium",children:" No link found"})]}),Oe.status==="suggested"&&n.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-700",children:[n.jsx(En,{className:"w-3 h-3"})," Review"]}),Oe.status==="unmatched"&&n.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-700",children:[n.jsx(gn,{className:"w-3 h-3"})," Unrecorded"]})]})}),n.jsx("td",{className:"px-3 py-2 text-center",children:n.jsxs("div",{className:"flex items-center justify-center gap-1",children:[Oe.status==="suggested"&&n.jsxs(n.Fragment,{children:[n.jsx("button",{onClick:()=>Fe(Oe.id),className:"p-1 text-green-600 hover:bg-green-50 rounded",title:"Confirm Match",children:n.jsx(Ss,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>oe(Oe.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Reject Match",children:n.jsx(gn,{className:"w-4 h-4"})})]}),Oe.status==="unmatched"&&e&&n.jsxs("button",{onClick:()=>ke(Oe),className:"inline-flex items-center gap-1 px-2 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700",title:"Record transaction",children:[n.jsx(Pr,{className:"w-3 h-3"}),"Record"]}),e&&n.jsx("button",{onClick:()=>mt(Oe),className:"p-1 text-gray-600 hover:bg-gray-100 rounded",title:"Edit debit/credit",children:n.jsx(Aa,{className:"w-4 h-4"})})]})})]},Oe.id)),n.jsxs("tr",{className:"bg-blue-50 border-t-2 border-blue-200 font-bold",children:[n.jsxs("td",{colSpan:2,className:"px-3 py-3 text-right text-gray-900",children:["TOTAL (",ze.length," transactions):"]}),n.jsxs("td",{className:"px-3 py-3 text-right text-red-700 font-bold whitespace-nowrap",children:[nt((i==null?void 0:i.currency)||"IDR")," ",ze.reduce((Oe,tt)=>Oe+tt.debit,0).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]}),n.jsxs("td",{className:"px-3 py-3 text-right text-green-700 font-bold whitespace-nowrap",children:[nt((i==null?void 0:i.currency)||"IDR")," ",ze.reduce((Oe,tt)=>Oe+tt.credit,0).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]}),n.jsxs("td",{colSpan:2,className:"px-3 py-3 text-center text-gray-600 text-sm",children:["Net: ",nt((i==null?void 0:i.currency)||"IDR")," ",(ze.reduce((Oe,tt)=>Oe+tt.credit,0)-ze.reduce((Oe,tt)=>Oe+tt.debit,0)).toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})]})}),n.jsx(Ot,{isOpen:_,onClose:()=>{j(!1),v(null),C(!1)},title:"Record Transaction",children:y&&n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[n.jsxs("div",{className:"flex items-center justify-between text-sm",children:[n.jsx("span",{className:"text-gray-600",children:"Date:"}),n.jsx("span",{className:"font-medium",children:new Date(y.date).toLocaleDateString("id-ID")})]}),n.jsxs("div",{className:"mt-2 text-sm",children:[n.jsx("span",{className:"text-gray-600",children:"Description:"}),n.jsx("p",{className:"font-medium mt-1",children:y.description})]}),y.debit>0&&n.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[n.jsx("span",{className:"text-sm text-gray-600",children:"Amount:"}),n.jsxs("span",{className:"text-lg font-bold text-red-600",children:[nt(y.currency)," ",y.debit.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),y.credit>0&&n.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[n.jsx("span",{className:"text-sm text-gray-600",children:"Amount:"}),n.jsxs("span",{className:"text-lg font-bold text-green-600",children:[nt(y.currency)," ",y.credit.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]}),y.debit>0&&n.jsxs("div",{children:[n.jsxs("div",{className:"flex gap-2 mb-3",children:[n.jsx("button",{onClick:()=>C(!1),className:`flex-1 py-2 px-3 rounded-lg text-sm font-medium ${E?"bg-gray-100 text-gray-700":"bg-blue-600 text-white"}`,children:"Create New Expense"}),n.jsx("button",{onClick:()=>C(!0),className:`flex-1 py-2 px-3 rounded-lg text-sm font-medium ${E?"bg-blue-600 text-white":"bg-gray-100 text-gray-700"}`,children:"Link to Existing Expense"})]}),E?n.jsxs("form",{onSubmit:Oe=>{Oe.preventDefault();const At=new FormData(Oe.currentTarget).get("expense_id");if(!At){alert("Please select an expense");return}qe(y,At)},className:"space-y-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Expense *"}),n.jsxs("select",{name:"expense_id",required:!0,className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 text-sm",disabled:N.length===0,children:[n.jsx("option",{value:"",children:N.length===0?"No expenses found":"Choose an expense..."}),N.map(Oe=>{const tt=new Date(Oe.expense_date),At=String(tt.getDate()).padStart(2,"0"),wt=String(tt.getMonth()+1).padStart(2,"0"),ht=String(tt.getFullYear()).slice(-2),Ft=`${At}/${wt}/${ht}`;return n.jsxs("option",{value:Oe.id,children:[Ft," - ",Oe.voucher_number?`[${Oe.voucher_number}] `:"",Oe.description," - Rp ",Oe.amount.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]},Oe.id)})]}),n.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Showing ",N.length," unlinked expense",N.length!==1?"s":"",". Match by voucher number or amount."]})]}),n.jsx("button",{type:"submit",className:"w-full py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Link to Expense"})]}):n.jsxs("form",{onSubmit:Oe=>{Oe.preventDefault();const tt=new FormData(Oe.currentTarget),At=tt.get("category"),wt=tt.get("description");Ue(y,At,wt)},className:"space-y-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category *"}),n.jsxs("select",{name:"category",required:!0,className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"",children:"Select category..."}),n.jsx("optgroup",{label:" IMPORT COSTS (Capitalized to Inventory) ",children:M.filter(Oe=>Oe.group==="Import Costs").map(Oe=>n.jsx("option",{value:Oe.value,children:Oe.label},Oe.value))}),n.jsx("optgroup",{label:" SALES & DISTRIBUTION (P&L Expense) ",children:M.filter(Oe=>Oe.group==="Sales & Distribution").map(Oe=>n.jsx("option",{value:Oe.value,children:Oe.label},Oe.value))}),n.jsx("optgroup",{label:" STAFF COSTS (P&L Expense) ",children:M.filter(Oe=>Oe.group==="Staff Costs").map(Oe=>n.jsx("option",{value:Oe.value,children:Oe.label},Oe.value))}),n.jsx("optgroup",{label:" OPERATIONS (P&L Expense) ",children:M.filter(Oe=>Oe.group==="Operations").map(Oe=>n.jsx("option",{value:Oe.value,children:Oe.label},Oe.value))}),n.jsx("optgroup",{label:" ADMINISTRATIVE (P&L Expense) ",children:M.filter(Oe=>Oe.group==="Administrative").map(Oe=>n.jsx("option",{value:Oe.value,children:Oe.label},Oe.value))})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),n.jsx("input",{type:"text",name:"description",defaultValue:y.description,className:"w-full px-3 py-2 border rounded-lg",placeholder:"Optional: Override description"})]}),n.jsx("button",{type:"submit",className:"w-full py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Create & Link Expense"})]})]}),y.credit>0&&n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium mb-2",children:"Record as Receipt"}),n.jsxs("form",{onSubmit:Oe=>{Oe.preventDefault();const tt=new FormData(Oe.currentTarget),At=tt.get("type"),wt=tt.get("customer_id"),ht=tt.get("description");$e(y,At,wt,ht)},className:"space-y-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type *"}),n.jsxs("select",{name:"type",id:"receiptType",required:!0,className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500",onChange:Oe=>{const tt=document.getElementById("customerField");tt&&(tt.style.display=Oe.target.value==="customer_payment"?"block":"none")},children:[n.jsx("option",{value:"",children:"Select type..."}),n.jsx("option",{value:"customer_payment",children:"Customer Payment"}),n.jsx("option",{value:"capital",children:"Capital Injection"}),n.jsx("option",{value:"other_income",children:"Other Income"}),n.jsx("option",{value:"loan",children:"Loan/Financing"})]})]}),n.jsxs("div",{id:"customerField",style:{display:"none"},children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer *"}),n.jsxs("select",{name:"customer_id",className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"",children:"Select customer..."}),V.map(Oe=>n.jsx("option",{value:Oe.id,children:Oe.company_name},Oe.id))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),n.jsx("input",{type:"text",name:"description",defaultValue:y.description,className:"w-full px-3 py-2 border rounded-lg",placeholder:"Optional: Override description"})]}),n.jsx("button",{type:"submit",className:"w-full py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Record Receipt"})]})]})]})}),w&&n.jsx(Ot,{isOpen:!0,onClose:()=>{T(null),ee(null)},title:"PDF Extraction Failed",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[n.jsx("p",{className:"text-yellow-800 text-sm font-medium mb-2",children:w.message}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("p",{className:"text-sm text-yellow-700 font-medium",children:"Recommended options:"}),n.jsx("ul",{className:"list-disc list-inside space-y-1 text-sm text-yellow-700",children:w.suggestions.map((Oe,tt)=>n.jsx("li",{children:Oe},tt))})]})]}),w.canUseOCR&&n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[n.jsx("p",{className:"text-blue-800 text-sm font-medium mb-2",children:"Advanced Option: OCR Processing"}),n.jsx("p",{className:"text-blue-700 text-xs mb-3",children:"Optical Character Recognition (OCR) can extract text from image-based or encrypted PDFs. This process takes 30-60 seconds and requires Google Vision API configuration. You'll be able to preview the results before saving."}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{onClick:Le,disabled:f,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 text-sm font-medium",children:f?"Processing with OCR...":"Run OCR Anyway"}),n.jsx("button",{onClick:()=>{T(null),ee(null)},className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 text-sm font-medium",children:"Cancel"})]})]})]})}),R&&n.jsx(Ot,{isOpen:!0,onClose:()=>q(null),title:"OCR Preview - Confirm Before Saving",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[n.jsxs("p",{className:"text-green-800 text-sm font-medium mb-2",children:[" OCR extracted ",R.transactionCount," transactions"]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-600",children:"Period:"}),n.jsx("span",{className:"ml-2 font-medium text-gray-900",children:R.period})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-600",children:"Opening Balance:"}),n.jsxs("span",{className:"ml-2 font-medium text-gray-900",children:[i==null?void 0:i.currency," ",R.openingBalance.toLocaleString()]})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-600",children:"Closing Balance:"}),n.jsxs("span",{className:"ml-2 font-medium text-gray-900",children:[i==null?void 0:i.currency," ",R.closingBalance.toLocaleString()]})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-gray-600",children:"Transactions:"}),n.jsx("span",{className:"ml-2 font-medium text-gray-900",children:R.transactionCount})]})]})]}),n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Sample Transactions (First 10):"}),n.jsx("div",{className:"border rounded-lg overflow-hidden",children:n.jsxs("table",{className:"w-full text-xs",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-2 py-1 text-left",children:"Date"}),n.jsx("th",{className:"px-2 py-1 text-left",children:"Description"}),n.jsx("th",{className:"px-2 py-1 text-right",children:"Amount"})]})}),n.jsx("tbody",{children:R.transactions.map((Oe,tt)=>n.jsxs("tr",{className:"border-t",children:[n.jsx("td",{className:"px-2 py-1",children:Oe.date}),n.jsx("td",{className:"px-2 py-1 truncate max-w-xs",children:Oe.description}),n.jsxs("td",{className:"px-2 py-1 text-right",children:[i==null?void 0:i.currency," ",(Oe.debitAmount||Oe.creditAmount).toLocaleString()]})]},tt))})]})})]}),n.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:n.jsx("p",{className:"text-yellow-800 text-xs",children:" Please verify the extracted data looks correct before confirming. OCR may have minor errors in dates, amounts, or descriptions."})}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{onClick:we,disabled:f,className:"flex-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 font-medium",children:f?"Saving...":"Confirm & Save"}),n.jsx("button",{onClick:()=>q(null),className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 font-medium",children:"Cancel"})]})]})}),n.jsx(Ot,{isOpen:I,onClose:()=>{H(!1),P(null)},title:"Confirm Clear Data",children:L&&n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[n.jsx("h4",{className:"font-medium text-yellow-900 mb-2",children:"Warning: Data Deletion"}),n.jsx("p",{className:"text-sm text-yellow-800",children:"You are about to clear bank statement data. This action cannot be undone."})]}),n.jsxs("div",{className:"bg-gray-50 border rounded-lg p-4 space-y-3",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Bank Account"}),n.jsxs("div",{className:"font-medium text-gray-900",children:[(yt=L.bank_info)==null?void 0:yt.bank_name," - ",(Et=L.bank_info)==null?void 0:Et.account_number,n.jsx("span",{className:"ml-2 px-2 py-0.5 bg-blue-100 text-blue-700 rounded text-xs",children:(It=L.bank_info)==null?void 0:It.currency})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Date Range"}),n.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[new Date(L.start_date).toLocaleDateString("id-ID")," -"," ",new Date(L.end_date).toLocaleDateString("id-ID")]})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Total Transactions"}),n.jsx("div",{className:"text-2xl font-bold text-gray-900",children:L.total_count})]})]}),n.jsxs("div",{className:"border-t pt-3 grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-red-600 font-medium mb-1",children:"Reconciled (Protected)"}),n.jsx("div",{className:"text-lg font-bold text-red-600",children:L.reconciled_count}),n.jsx("div",{className:"text-xs text-gray-500",children:"Cannot be deleted"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-gray-600 font-medium mb-1",children:"Unmatched (Deletable)"}),n.jsx("div",{className:"text-lg font-bold text-gray-900",children:L.unmatched_count}),n.jsx("div",{className:"text-xs text-gray-500",children:"Will be deleted"})]})]})]}),L.warning&&n.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:n.jsx("p",{className:"text-sm text-red-800 font-medium",children:L.warning})}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[n.jsx("button",{type:"button",onClick:()=>{H(!1),P(null)},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),n.jsx("button",{type:"button",onClick:Be,disabled:!L.can_delete,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed",children:L.can_delete?`Delete ${L.unmatched_count} Transaction(s)`:"Cannot Delete"})]})]})}),n.jsx(Ot,{isOpen:re,onClose:()=>{U(!1),G(null)},title:"Edit Bank Statement Line",children:Y&&n.jsxs("form",{onSubmit:gt,className:"space-y-4",children:[n.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[n.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Date:"}),n.jsx("div",{className:"font-medium",children:new Date(Y.date).toLocaleDateString("id-ID")}),Y.reference&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"text-sm text-gray-600 mt-2 mb-1",children:"Reference:"}),n.jsx("div",{className:"font-medium font-mono text-sm",children:Y.reference})]}),n.jsx("div",{className:"text-sm text-gray-600 mt-2 mb-1",children:"Status:"}),n.jsxs("div",{className:"inline-flex items-center gap-1.5",children:[Y.status==="matched"&&n.jsxs(n.Fragment,{children:[n.jsx(Ss,{className:"w-4 h-4 text-green-600"}),n.jsx("span",{className:"text-green-700 font-medium",children:"Matched"})]}),Y.status==="recorded"&&n.jsxs(n.Fragment,{children:[n.jsx(Ss,{className:"w-4 h-4 text-green-600"}),n.jsx("span",{className:"text-green-700 font-medium",children:"Recorded"})]}),Y.status==="suggested"&&n.jsxs(n.Fragment,{children:[n.jsx(En,{className:"w-4 h-4 text-yellow-600"}),n.jsx("span",{className:"text-yellow-700 font-medium",children:"Suggested"})]}),Y.status==="unmatched"&&n.jsxs(n.Fragment,{children:[n.jsx(gn,{className:"w-4 h-4 text-gray-400"}),n.jsx("span",{className:"text-gray-600 font-medium",children:"Unmatched"})]})]})]}),(Y.matchedExpense||Y.matchedReceipt||Y.matchedFundTransfer)&&n.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[n.jsxs("div",{className:"flex items-start justify-between mb-3",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Zt,{className:"w-5 h-5 text-blue-600"}),n.jsx("h4",{className:"font-semibold text-blue-900",children:"Linked Transaction"})]}),e&&n.jsx("button",{type:"button",onClick:Nt,className:"text-sm text-red-600 hover:text-red-700 font-medium",children:"Unlink"})]}),Y.matchedExpense&&n.jsxs("div",{className:"space-y-2 text-sm",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Type:"}),n.jsx("span",{className:"font-medium text-gray-900",children:"Expense"})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Category:"}),n.jsx("span",{className:"font-medium text-gray-900",children:((ir=M.find(Oe=>{var tt;return Oe.value===((tt=Y.matchedExpense)==null?void 0:tt.expense_category)}))==null?void 0:ir.label)||Y.matchedExpense.expense_category})]}),Y.matchedExpense.voucher_number&&n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Voucher:"}),n.jsx("span",{className:"font-medium text-gray-900 font-mono",children:Y.matchedExpense.voucher_number})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Amount:"}),n.jsxs("span",{className:"font-medium text-gray-900",children:[Y.currency==="USD"?"$":"Rp"," ",Y.matchedExpense.amount.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Date:"}),n.jsx("span",{className:"font-medium text-gray-900",children:new Date(Y.matchedExpense.expense_date).toLocaleDateString("id-ID")})]}),Y.matchedExpense.description&&n.jsxs("div",{className:"pt-2 border-t border-blue-200",children:[n.jsx("div",{className:"text-gray-600 mb-1",children:"Description:"}),n.jsx("div",{className:"text-gray-900",children:Y.matchedExpense.description})]})]}),Y.matchedReceipt&&n.jsxs("div",{className:"space-y-2 text-sm",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Type:"}),n.jsx("span",{className:"font-medium text-gray-900",children:"Receipt"})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Payment Number:"}),n.jsx("span",{className:"font-medium text-gray-900 font-mono",children:Y.matchedReceipt.payment_number})]}),Y.matchedReceipt.customer_name&&n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Customer:"}),n.jsx("span",{className:"font-medium text-gray-900",children:Y.matchedReceipt.customer_name})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Amount:"}),n.jsxs("span",{className:"font-medium text-gray-900",children:[Y.currency==="USD"?"$":"Rp"," ",Y.matchedReceipt.amount.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Date:"}),n.jsx("span",{className:"font-medium text-gray-900",children:new Date(Y.matchedReceipt.payment_date).toLocaleDateString("id-ID")})]})]}),Y.matchedFundTransfer&&n.jsxs("div",{className:"space-y-2 text-sm",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Type:"}),n.jsx("span",{className:"font-medium text-gray-900",children:"Fund Transfer"})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Transfer No:"}),n.jsx("span",{className:"font-medium text-gray-900 font-mono",children:Y.matchedFundTransfer.transfer_number})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"From:"}),n.jsx("span",{className:"font-medium text-gray-900",children:Y.matchedFundTransfer.from_account_type})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"To:"}),n.jsx("span",{className:"font-medium text-gray-900",children:Y.matchedFundTransfer.to_account_type})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Amount:"}),n.jsxs("span",{className:"font-medium text-gray-900",children:[Y.currency==="USD"?"$":"Rp"," ",Y.matchedFundTransfer.amount.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Date:"}),n.jsx("span",{className:"font-medium text-gray-900",children:new Date(Y.matchedFundTransfer.transfer_date).toLocaleDateString("id-ID")})]}),Y.matchedFundTransfer.description&&n.jsxs("div",{className:"pt-2 border-t border-blue-200",children:[n.jsx("div",{className:"text-gray-600 mb-1",children:"Description:"}),n.jsx("div",{className:"text-gray-900",children:Y.matchedFundTransfer.description})]})]}),Y.notes&&n.jsxs("div",{className:"mt-3 pt-3 border-t border-blue-200",children:[n.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Match Notes:"}),n.jsx("div",{className:"text-sm text-gray-700 italic",children:Y.notes})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),n.jsx("textarea",{value:S.description,onChange:Oe=>D({...S,description:Oe.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-red-700 mb-1",children:"Debit Amount"}),n.jsx("input",{type:"number",step:"0.01",value:S.debit,onChange:Oe=>D({...S,debit:parseFloat(Oe.target.value)||0,credit:0}),className:"w-full px-3 py-2 border border-red-300 rounded-lg"}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Money OUT (expenses)"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-green-700 mb-1",children:"Credit Amount"}),n.jsx("input",{type:"number",step:"0.01",value:S.credit,onChange:Oe=>D({...S,credit:parseFloat(Oe.target.value)||0,debit:0}),className:"w-full px-3 py-2 border border-green-300 rounded-lg"}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Money IN (receipts)"})]})]}),n.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:n.jsxs("p",{className:"text-xs text-yellow-800",children:[" ",n.jsx("strong",{children:"Note:"})," Each transaction should have either a Debit OR a Credit amount, not both. When you enter one, the other will be cleared."]})}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[n.jsx("button",{type:"button",onClick:()=>{U(!1),G(null)},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),n.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Update"})]})]})})]})}const $1=[{value:"asset",label:"Asset",color:"bg-blue-100 text-blue-800"},{value:"liability",label:"Liability",color:"bg-red-100 text-red-800"},{value:"equity",label:"Equity",color:"bg-purple-100 text-purple-800"},{value:"revenue",label:"Revenue",color:"bg-green-100 text-green-800"},{value:"expense",label:"Expense",color:"bg-orange-100 text-orange-800"},{value:"contra",label:"Contra",color:"bg-gray-100 text-gray-800"}];function fAe({canManage:e}){const[t,r]=Q.useState([]),[a,s]=Q.useState(!0),[i,o]=Q.useState(!1),[l,c]=Q.useState(null),[d,u]=Q.useState(new Set(["asset","liability","equity","revenue","expense"])),[f,h]=Q.useState(""),[A,x]=Q.useState({code:"",name:"",name_id:"",account_type:"expense",account_group:"",parent_id:"",is_header:!1,normal_balance:"debit",description:""});Q.useEffect(()=>{p()},[]);const p=async()=>{try{const{data:N,error:B}=await Z.from("chart_of_accounts").select("*").order("code");if(B)throw B;r(N||[])}catch(N){console.error("Error loading accounts:",N)}finally{s(!1)}},b=async N=>{N.preventDefault();try{const B={...A,parent_id:A.parent_id||null,name_id:A.name_id||null,description:A.description||null};if(l){const{error:E}=await Z.from("chart_of_accounts").update(B).eq("id",l.id);if(E)throw E}else{const{error:E}=await Z.from("chart_of_accounts").insert([B]);if(E)throw E}o(!1),y(),p()}catch(B){console.error("Error saving account:",B),alert("Failed to save account: "+B.message)}},m=N=>{c(N),x({code:N.code,name:N.name,name_id:N.name_id||"",account_type:N.account_type,account_group:N.account_group||"",parent_id:N.parent_id||"",is_header:N.is_header,normal_balance:N.normal_balance,description:N.description||""}),o(!0)},g=async N=>{if(confirm("Are you sure you want to delete this account?"))try{const{error:B}=await Z.from("chart_of_accounts").delete().eq("id",N);if(B)throw B;p()}catch(B){console.error("Error deleting account:",B),alert("Failed to delete account: "+B.message)}},y=()=>{c(null),x({code:"",name:"",name_id:"",account_type:"expense",account_group:"",parent_id:"",is_header:!1,normal_balance:"debit",description:""})},v=N=>{const B=new Set(d);B.has(N)?B.delete(N):B.add(N),u(B)},_=t.filter(N=>N.code.toLowerCase().includes(f.toLowerCase())||N.name.toLowerCase().includes(f.toLowerCase())||N.name_id&&N.name_id.toLowerCase().includes(f.toLowerCase())),j=$1.reduce((N,B)=>(N[B.value]=_.filter(E=>E.account_type===B.value),N),{});return a?n.jsx("div",{className:"flex justify-center py-8",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"relative flex-1 max-w-md",children:[n.jsx(Ca,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),n.jsx("input",{type:"text",placeholder:"Search accounts...",value:f,onChange:N=>h(N.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e&&n.jsxs("button",{onClick:()=>{y(),o(!0)},className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:[n.jsx(Pr,{className:"w-5 h-5"}),"Add Account"]})]}),n.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:$1.map(N=>{var B,E;return n.jsxs("div",{className:"border-b last:border-b-0",children:[n.jsx("button",{onClick:()=>v(N.value),className:"w-full flex items-center justify-between px-4 py-3 bg-gray-50 hover:bg-gray-100",children:n.jsxs("div",{className:"flex items-center gap-2",children:[d.has(N.value)?n.jsx(Cs,{className:"w-5 h-5"}):n.jsx(Rc,{className:"w-5 h-5"}),n.jsx("span",{className:`px-2 py-1 rounded text-sm font-medium ${N.color}`,children:N.label}),n.jsxs("span",{className:"text-gray-500 text-sm",children:["(",((B=j[N.value])==null?void 0:B.length)||0," accounts)"]})]})}),d.has(N.value)&&((E=j[N.value])==null?void 0:E.length)>0&&n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-gray-50 text-xs text-gray-500 uppercase",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2 text-left",children:"Code"}),n.jsx("th",{className:"px-4 py-2 text-left",children:"Account Name"}),n.jsx("th",{className:"px-4 py-2 text-left",children:"Indonesian Name"}),n.jsx("th",{className:"px-4 py-2 text-left",children:"Group"}),n.jsx("th",{className:"px-4 py-2 text-center",children:"Normal"}),e&&n.jsx("th",{className:"px-4 py-2 text-right",children:"Actions"})]})}),n.jsx("tbody",{className:"divide-y",children:j[N.value].map(C=>n.jsxs("tr",{className:`hover:bg-gray-50 ${C.is_header?"font-semibold bg-gray-50":""}`,children:[n.jsx("td",{className:"px-4 py-2 font-mono text-sm",children:C.code}),n.jsx("td",{className:"px-4 py-2",children:C.name}),n.jsx("td",{className:"px-4 py-2 text-gray-500",children:C.name_id||"-"}),n.jsx("td",{className:"px-4 py-2 text-sm text-gray-500",children:C.account_group||"-"}),n.jsx("td",{className:"px-4 py-2 text-center",children:n.jsx("span",{className:`text-xs px-2 py-1 rounded ${C.normal_balance==="debit"?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700"}`,children:C.normal_balance})}),e&&n.jsxs("td",{className:"px-4 py-2 text-right",children:[n.jsx("button",{onClick:()=>m(C),className:"text-blue-600 hover:text-blue-800 mr-2",children:n.jsx(Aa,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>g(C.id),className:"text-red-600 hover:text-red-800",children:n.jsx(Lr,{className:"w-4 h-4"})})]})]},C.id))})]})]},N.value)})}),n.jsx(Ot,{isOpen:i,onClose:()=>o(!1),title:l?"Edit Account":"Add Account",children:n.jsxs("form",{onSubmit:b,className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Account Code *"}),n.jsx("input",{type:"text",required:!0,value:A.code,onChange:N=>x({...A,code:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"e.g., 1101"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Account Type *"}),n.jsx("select",{required:!0,value:A.account_type,onChange:N=>x({...A,account_type:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:$1.map(N=>n.jsx("option",{value:N.value,children:N.label},N.value))})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Account Name (English) *"}),n.jsx("input",{type:"text",required:!0,value:A.name,onChange:N=>x({...A,name:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Account Name (Indonesian)"}),n.jsx("input",{type:"text",value:A.name_id,onChange:N=>x({...A,name_id:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Account Group"}),n.jsx("input",{type:"text",value:A.account_group,onChange:N=>x({...A,account_group:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Normal Balance *"}),n.jsxs("select",{required:!0,value:A.normal_balance,onChange:N=>x({...A,normal_balance:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[n.jsx("option",{value:"debit",children:"Debit"}),n.jsx("option",{value:"credit",children:"Credit"})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Parent Account"}),n.jsxs("select",{value:A.parent_id,onChange:N=>x({...A,parent_id:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[n.jsx("option",{value:"",children:"None (Top Level)"}),t.filter(N=>N.is_header).map(N=>n.jsxs("option",{value:N.id,children:[N.code," - ",N.name]},N.id))]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{type:"checkbox",id:"is_header",checked:A.is_header,onChange:N=>x({...A,is_header:N.target.checked}),className:"rounded"}),n.jsx("label",{htmlFor:"is_header",className:"text-sm text-gray-700",children:"This is a header/group account (not for posting)"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),n.jsx("textarea",{value:A.description,onChange:N=>x({...A,description:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",rows:2})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[n.jsx("button",{type:"button",onClick:()=>o(!1),className:"px-4 py-2 text-gray-700 border rounded-lg hover:bg-gray-50",children:"Cancel"}),n.jsxs("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[l?"Update":"Create"," Account"]})]})]})})]})}function pAe({canManage:e}){const[t,r]=Q.useState([]),[a,s]=Q.useState(!0),[i,o]=Q.useState(!1),[l,c]=Q.useState(null),[d,u]=Q.useState(""),[f,h]=Q.useState({supplier_code:"",company_name:"",contact_person:"",email:"",phone:"",address:"",city:"",country:"Indonesia",npwp:"",pkp_status:!1,payment_terms_days:30,bank_name:"",bank_account_number:"",bank_account_name:""});Q.useEffect(()=>{A()},[]);const A=async()=>{try{const{data:v,error:_}=await Z.from("suppliers").select("*").order("company_name");if(_)throw _;r(v||[])}catch(v){console.error("Error loading suppliers:",v)}finally{s(!1)}},x=async()=>{const v=new Date().getFullYear().toString().slice(-2),{count:_}=await Z.from("suppliers").select("*",{count:"exact",head:!0});return`SUP${v}-${String((_||0)+1).padStart(4,"0")}`},p=async v=>{v.preventDefault();try{const{data:{user:_}}=await Z.auth.getUser();if(!_)throw new Error("Not authenticated");const j={...f,supplier_code:f.supplier_code||await x(),contact_person:f.contact_person||null,email:f.email||null,phone:f.phone||null,address:f.address||null,city:f.city||null,npwp:f.npwp||null,bank_name:f.bank_name||null,bank_account_number:f.bank_account_number||null,bank_account_name:f.bank_account_name||null};if(l){const{error:N}=await Z.from("suppliers").update(j).eq("id",l.id);if(N)throw N}else{const{error:N}=await Z.from("suppliers").insert([{...j,created_by:_.id}]);if(N)throw N}o(!1),g(),A()}catch(_){console.error("Error saving supplier:",_),alert("Failed to save supplier: "+_.message)}},b=v=>{c(v),h({supplier_code:v.supplier_code||"",company_name:v.company_name,contact_person:v.contact_person||"",email:v.email||"",phone:v.phone||"",address:v.address||"",city:v.city||"",country:v.country,npwp:v.npwp||"",pkp_status:v.pkp_status,payment_terms_days:v.payment_terms_days,bank_name:v.bank_name||"",bank_account_number:v.bank_account_number||"",bank_account_name:v.bank_account_name||""}),o(!0)},m=async v=>{if(confirm("Are you sure you want to delete this supplier?"))try{const{error:_}=await Z.from("suppliers").delete().eq("id",v);if(_)throw _;A()}catch(_){console.error("Error deleting supplier:",_),alert("Failed to delete supplier: "+_.message)}},g=()=>{c(null),h({supplier_code:"",company_name:"",contact_person:"",email:"",phone:"",address:"",city:"",country:"Indonesia",npwp:"",pkp_status:!1,payment_terms_days:30,bank_name:"",bank_account_number:"",bank_account_name:""})},y=t.filter(v=>v.company_name.toLowerCase().includes(d.toLowerCase())||v.supplier_code&&v.supplier_code.toLowerCase().includes(d.toLowerCase())||v.npwp&&v.npwp.includes(d));return a?n.jsx("div",{className:"flex justify-center py-8",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"relative flex-1 max-w-md",children:[n.jsx(Ca,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),n.jsx("input",{type:"text",placeholder:"Search suppliers...",value:d,onChange:v=>u(v.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg"})]}),e&&n.jsxs("button",{onClick:()=>{g(),o(!0)},className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:[n.jsx(Pr,{className:"w-5 h-5"}),"Add Supplier"]})]}),n.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Code"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Company Name"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Contact"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"NPWP"}),n.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"PKP"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Terms"}),e&&n.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),n.jsxs("tbody",{className:"divide-y",children:[y.map(v=>n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-4 py-3 font-mono text-sm",children:v.supplier_code||"-"}),n.jsx("td",{className:"px-4 py-3",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(_n,{className:"w-4 h-4 text-gray-400"}),n.jsxs("div",{children:[n.jsx("div",{className:"font-medium",children:v.company_name}),v.city&&n.jsx("div",{className:"text-sm text-gray-500",children:v.city})]})]})}),n.jsxs("td",{className:"px-4 py-3",children:[n.jsx("div",{className:"text-sm",children:v.contact_person||"-"}),v.phone&&n.jsx("div",{className:"text-sm text-gray-500",children:v.phone})]}),n.jsx("td",{className:"px-4 py-3 font-mono text-sm",children:v.npwp||"-"}),n.jsx("td",{className:"px-4 py-3 text-center",children:v.pkp_status?n.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-700 text-xs rounded",children:"PKP"}):n.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded",children:"Non-PKP"})}),n.jsxs("td",{className:"px-4 py-3 text-sm",children:[v.payment_terms_days," days"]}),e&&n.jsxs("td",{className:"px-4 py-3 text-right",children:[n.jsx("button",{onClick:()=>b(v),className:"text-blue-600 hover:text-blue-800 mr-2",children:n.jsx(Aa,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>m(v.id),className:"text-red-600 hover:text-red-800",children:n.jsx(Lr,{className:"w-4 h-4"})})]})]},v.id)),y.length===0&&n.jsx("tr",{children:n.jsx("td",{colSpan:7,className:"px-4 py-8 text-center text-gray-500",children:"No suppliers found"})})]})]})}),n.jsx(Ot,{isOpen:i,onClose:()=>o(!1),title:l?"Edit Supplier":"Add Supplier",children:n.jsxs("form",{onSubmit:p,className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Supplier Code"}),n.jsx("input",{type:"text",value:f.supplier_code,onChange:v=>h({...f,supplier_code:v.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"Auto-generated if empty"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Company Name *"}),n.jsx("input",{type:"text",required:!0,value:f.company_name,onChange:v=>h({...f,company_name:v.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contact Person"}),n.jsx("input",{type:"text",value:f.contact_person,onChange:v=>h({...f,contact_person:v.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),n.jsx("input",{type:"text",value:f.phone,onChange:v=>h({...f,phone:v.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),n.jsx("input",{type:"email",value:f.email,onChange:v=>h({...f,email:v.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),n.jsx("textarea",{value:f.address,onChange:v=>h({...f,address:v.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",rows:2})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"City"}),n.jsx("input",{type:"text",value:f.city,onChange:v=>h({...f,city:v.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Country"}),n.jsx("input",{type:"text",value:f.country,onChange:v=>h({...f,country:v.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]})]}),n.jsxs("div",{className:"border-t pt-4",children:[n.jsx("h4",{className:"font-medium text-gray-700 mb-3",children:"Tax Information"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"NPWP"}),n.jsx("input",{type:"text",value:f.npwp,onChange:v=>h({...f,npwp:v.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"00.000.000.0-000.000"})]}),n.jsxs("div",{className:"flex items-center gap-2 pt-6",children:[n.jsx("input",{type:"checkbox",id:"pkp_status",checked:f.pkp_status,onChange:v=>h({...f,pkp_status:v.target.checked}),className:"rounded"}),n.jsx("label",{htmlFor:"pkp_status",className:"text-sm text-gray-700",children:"PKP (Pengusaha Kena Pajak)"})]})]})]}),n.jsxs("div",{className:"border-t pt-4",children:[n.jsx("h4",{className:"font-medium text-gray-700 mb-3",children:"Bank Details"}),n.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bank Name"}),n.jsx("input",{type:"text",value:f.bank_name,onChange:v=>h({...f,bank_name:v.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Account Number"}),n.jsx("input",{type:"text",value:f.bank_account_number,onChange:v=>h({...f,bank_account_number:v.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Account Name"}),n.jsx("input",{type:"text",value:f.bank_account_name,onChange:v=>h({...f,bank_account_name:v.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Terms (Days)"}),n.jsx("input",{type:"number",value:f.payment_terms_days,onChange:v=>h({...f,payment_terms_days:parseInt(v.target.value)||30}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[n.jsx("button",{type:"button",onClick:()=>o(!1),className:"px-4 py-2 text-gray-700 border rounded-lg hover:bg-gray-50",children:"Cancel"}),n.jsxs("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[l?"Update":"Create"," Supplier"]})]})]})})]})}function mAe({canManage:e}){const[t,r]=Q.useState([]),[a,s]=Q.useState(!0),[i,o]=Q.useState(!1),[l,c]=Q.useState(null),[d,u]=Q.useState({account_name:"",bank_name:"",account_number:"",account_type:"current",currency:"IDR",opening_balance:0,opening_balance_date:"2025-01-01",alias:""});Q.useEffect(()=>{f()},[]);const f=async()=>{try{const{data:b,error:m}=await Z.from("bank_accounts").select("*").order("created_at",{ascending:!1});if(m)throw m;r(b||[])}catch(b){console.error("Error loading bank accounts:",b)}finally{s(!1)}},h=async b=>{b.preventDefault();try{const{data:{user:m}}=await Z.auth.getUser();if(!m)throw new Error("Not authenticated");if(l){const{error:g}=await Z.from("bank_accounts").update(d).eq("id",l.id);if(g)throw g}else{const{error:g}=await Z.from("bank_accounts").insert([{...d,current_balance:d.opening_balance,created_by:m.id}]);if(g)throw g}o(!1),x(),f()}catch(m){console.error("Error saving bank account:",m),alert(`Failed to save bank account: ${m.message}`)}},A=b=>{c(b),u({account_name:b.account_name,bank_name:b.bank_name,account_number:b.account_number,account_type:b.account_type,currency:b.currency,opening_balance:b.opening_balance,opening_balance_date:b.opening_balance_date||"2025-01-01",alias:b.alias||""}),o(!0)},x=()=>{c(null),u({account_name:"",bank_name:"",account_number:"",account_type:"current",currency:"IDR",opening_balance:0,opening_balance_date:"2025-01-01",alias:""})},p=[{key:"account_name",label:"Account Name"},{key:"bank_name",label:"Bank"},{key:"account_number",label:"Account #"},{key:"type",label:"Type",render:b=>n.jsx("span",{className:"capitalize",children:b.account_type})},{key:"balance",label:"Balance",render:b=>n.jsxs("span",{className:"font-semibold",children:["Rp ",b.current_balance.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]})},{key:"status",label:"Status",render:b=>n.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${b.is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:b.is_active?"Active":"Inactive"})}];return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h2",{className:"text-xl font-semibold",children:"Bank Accounts"}),e&&n.jsxs("button",{onClick:()=>{x(),o(!0)},className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:[n.jsx(Pr,{className:"w-5 h-5"}),"Add Bank Account"]})]}),n.jsx(Fs,{columns:p,data:t,loading:a,actions:e?b=>n.jsx("button",{onClick:()=>A(b),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",children:n.jsx(Aa,{className:"w-4 h-4"})}):void 0}),n.jsx(Ot,{isOpen:i,onClose:()=>{o(!1),x()},title:l?"Edit Bank Account":"Add Bank Account",children:n.jsxs("form",{onSubmit:h,className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Account Name *"}),n.jsx("input",{type:"text",value:d.account_name,onChange:b=>u({...d,account_name:b.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bank Name *"}),n.jsx("input",{type:"text",value:d.bank_name,onChange:b=>u({...d,bank_name:b.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Display Alias"}),n.jsx("input",{type:"text",value:d.alias,onChange:b=>u({...d,alias:b.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"e.g., BCA IDR, Mandiri USD"}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Short name for easier identification in lists"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Account Number *"}),n.jsx("input",{type:"text",value:d.account_number,onChange:b=>u({...d,account_number:b.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Account Type *"}),n.jsxs("select",{value:d.account_type,onChange:b=>u({...d,account_type:b.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[n.jsx("option",{value:"savings",children:"Savings"}),n.jsx("option",{value:"current",children:"Current"}),n.jsx("option",{value:"credit_card",children:"Credit Card"}),n.jsx("option",{value:"other",children:"Other"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Currency *"}),n.jsxs("select",{value:d.currency,onChange:b=>u({...d,currency:b.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[n.jsx("option",{value:"IDR",children:"IDR (Indonesian Rupiah)"}),n.jsx("option",{value:"USD",children:"USD (US Dollar)"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Opening Balance"}),n.jsx("input",{type:"number",value:d.opening_balance===0?"":d.opening_balance,onChange:b=>u({...d,opening_balance:b.target.value===""?0:Number(b.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",step:"0.01",placeholder:"0"}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Leave blank if opening balance is zero"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Opening Balance Date *"}),n.jsx("input",{type:"date",value:d.opening_balance_date,onChange:b=>u({...d,opening_balance_date:b.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Date when the opening balance is effective"})]})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[n.jsx("button",{type:"button",onClick:()=>{o(!1),x()},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),n.jsxs("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[l?"Update":"Add"," Account"]})]})]})})]})}function gAe(){const{t:e}=cn(),[t,r]=Q.useState([]),[a,s]=Q.useState([]),[i,o]=Q.useState([]),[l,c]=Q.useState(!0),[d,u]=Q.useState("summary"),[f,h]=Q.useState("");Q.useEffect(()=>{A()},[]);const A=async()=>{try{c(!0);const[g,y,v]=await Promise.all([Z.from("vw_monthly_tax_summary").select("*").order("month",{ascending:!1}),Z.from("vw_input_ppn_report").select("*"),Z.from("vw_output_ppn_report").select("*")]);if(g.error)throw g.error;if(y.error)throw y.error;if(v.error)throw v.error;o(g.data||[]),r(y.data||[]),s(v.data||[])}catch(g){console.error("Error loading tax reports:",g.message),alert("Failed to load tax reports")}finally{c(!1)}},x=g=>`Rp ${g==null?void 0:g.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})}`,p=g=>g?new Date(g).toLocaleDateString("en-US",{year:"numeric",month:"long"}):"-",b=f?t.filter(g=>g.month===f):t,m=f?a.filter(g=>g.month===f):a;return n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex items-center justify-between bg-white p-2 rounded-lg shadow-sm",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"text-sm font-semibold text-gray-900",children:e("finance.taxReports")||"Tax Reports (PPN)"}),n.jsx("p",{className:"text-[10px] text-gray-600",children:e("finance.taxReportsDesc")||"Monthly Input PPN, Output PPN, Net PPN"})]}),n.jsxs("button",{onClick:()=>window.print(),className:"flex items-center gap-1.5 px-2.5 py-1.5 border border-gray-300 rounded-lg hover:bg-gray-50 text-xs",children:[n.jsx(Zn,{className:"w-3.5 h-3.5"}),e("common.print")||"Print"]})]}),n.jsx("div",{className:"flex gap-1.5 border-b border-gray-200 bg-white",children:[{value:"summary",label:e("finance.monthlySummary")||"Monthly Summary",icon:ja},{value:"input",label:e("finance.inputPPN")||"Input PPN",icon:FE},{value:"output",label:e("finance.outputPPN")||"Output PPN",icon:zo}].map(g=>{const y=g.icon;return n.jsxs("button",{onClick:()=>u(g.value),className:`flex items-center gap-1.5 px-2.5 py-1.5 text-xs font-medium transition-colors ${d===g.value?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"}`,children:[n.jsx(y,{className:"w-3.5 h-3.5"}),g.label]},g.value)})}),l?n.jsx("div",{className:"text-center py-8 text-gray-500 text-xs",children:e("common.loading")||"Loading tax reports..."}):n.jsxs(n.Fragment,{children:[d==="summary"&&n.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[n.jsxs("div",{className:"px-3 py-2 bg-gray-50 border-b border-gray-200",children:[n.jsx("h3",{className:"text-sm font-medium text-gray-900",children:e("finance.monthlySummary")||"Monthly Tax Summary"}),n.jsx("p",{className:"text-[10px] text-gray-600",children:e("finance.netPPNFormula")||"Net PPN = Output PPN - Input PPN"})]}),n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-3 py-1.5 text-left text-[10px] font-medium text-gray-500 uppercase",children:e("common.month")||"Month"}),n.jsx("th",{className:"px-3 py-1.5 text-right text-[10px] font-medium text-gray-500 uppercase",children:e("finance.inputPPNPaid")||"Input PPN"}),n.jsx("th",{className:"px-3 py-1.5 text-right text-[10px] font-medium text-gray-500 uppercase",children:e("finance.outputPPNCollected")||"Output PPN"}),n.jsx("th",{className:"px-3 py-1.5 text-right text-[10px] font-medium text-gray-500 uppercase",children:e("finance.netPPNPayable")||"Net PPN Payable"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:i.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:4,className:"px-3 py-4 text-center text-gray-500 text-xs",children:e("common.noData")||"No tax data available"})}):i.map((g,y)=>n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:n.jsx("div",{className:"text-xs font-medium text-gray-900",children:p(g.month)})}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-right",children:n.jsx("div",{className:"text-xs text-blue-600 font-medium",children:x(g.input_ppn_paid)})}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-right",children:n.jsx("div",{className:"text-xs text-green-600 font-medium",children:x(g.output_ppn_collected)})}),n.jsxs("td",{className:"px-3 py-2 whitespace-nowrap text-right",children:[n.jsx("div",{className:`text-xs font-bold ${g.net_ppn_payable>0?"text-red-600":g.net_ppn_payable<0?"text-blue-600":"text-gray-600"}`,children:x(g.net_ppn_payable)}),n.jsx("div",{className:"text-[10px] text-gray-500",children:g.net_ppn_payable>0?e("finance.payToTax")||"Pay to tax office":g.net_ppn_payable<0?e("finance.carryForward")||"Carry forward":e("finance.balanced")||"Balanced"})]})]},y))})]})]}),d==="input"&&n.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[n.jsxs("div",{className:"px-3 py-2 bg-blue-50 border-b border-blue-200",children:[n.jsx("h3",{className:"text-sm font-medium text-blue-900",children:e("finance.inputPPNReport")||"Input PPN Report"}),n.jsx("p",{className:"text-[10px] text-blue-700",children:e("finance.inputPPNDesc")||"PPN paid on imports - can be claimed as tax credit"})]}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-3 py-1.5 text-left text-[10px] font-medium text-gray-500 uppercase",children:e("common.date")||"Date"}),n.jsx("th",{className:"px-3 py-1.5 text-left text-[10px] font-medium text-gray-500 uppercase",children:e("common.container")||"Container"}),n.jsx("th",{className:"px-3 py-1.5 text-left text-[10px] font-medium text-gray-500 uppercase",children:e("common.supplier")||"Supplier"}),n.jsx("th",{className:"px-3 py-1.5 text-right text-[10px] font-medium text-gray-500 uppercase",children:e("finance.invoiceValue")||"Invoice Value"}),n.jsx("th",{className:"px-3 py-1.5 text-right text-[10px] font-medium text-gray-500 uppercase",children:e("finance.ppnAmount")||"PPN Amount (11%)"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:b.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:5,className:"px-3 py-4 text-center text-gray-500 text-xs",children:e("common.noRecords")||"No input PPN records"})}):b.map((g,y)=>n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-xs text-gray-900",children:new Date(g.expense_date).toLocaleDateString()}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-xs font-medium text-gray-900",children:g.container_ref}),n.jsx("td",{className:"px-3 py-2 text-xs text-gray-700",children:g.supplier}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-xs text-right text-gray-900",children:x(g.import_invoice_value)}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-xs text-right font-medium text-blue-600",children:x(g.ppn_amount)})]},y))})]})})]}),d==="output"&&n.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[n.jsxs("div",{className:"px-3 py-2 bg-green-50 border-b border-green-200",children:[n.jsx("h3",{className:"text-sm font-medium text-green-900",children:e("finance.outputPPNReport")||"Output PPN Report"}),n.jsx("p",{className:"text-[10px] text-green-700",children:e("finance.outputPPNDesc")||"PPN collected from customers - must be paid to tax office"}),n.jsx("p",{className:"text-[10px] font-semibold text-red-700 mt-1",children:e("finance.taxPayableWarning")||" Tax is payable based on INVOICE DATE, not payment status!"})]}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-3 py-1.5 text-left text-[10px] font-medium text-gray-500 uppercase",children:e("common.date")||"Date"}),n.jsx("th",{className:"px-3 py-1.5 text-left text-[10px] font-medium text-gray-500 uppercase",children:e("common.invoiceNo")||"Invoice #"}),n.jsx("th",{className:"px-3 py-1.5 text-left text-[10px] font-medium text-gray-500 uppercase",children:e("common.customer")||"Customer"}),n.jsx("th",{className:"px-3 py-1.5 text-left text-[10px] font-medium text-gray-500 uppercase",children:"NPWP"}),n.jsx("th",{className:"px-3 py-1.5 text-right text-[10px] font-medium text-gray-500 uppercase",children:e("finance.subtotal")||"Subtotal"}),n.jsx("th",{className:"px-3 py-1.5 text-right text-[10px] font-medium text-gray-500 uppercase",children:e("finance.ppnAmount")||"PPN Amount (11%)"}),n.jsxs("th",{className:"px-3 py-1.5 text-center text-[10px] font-medium text-gray-500 uppercase",children:[e("common.paymentStatus")||"Payment Status",n.jsx("div",{className:"text-[10px] font-normal text-gray-500 normal-case",children:e("finance.forInfoOnly")||"(For info only - tax due regardless)"})]})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:m.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:7,className:"px-3 py-4 text-center text-gray-500 text-xs",children:e("common.noRecords")||"No output PPN records"})}):m.map((g,y)=>n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-xs text-gray-900",children:new Date(g.invoice_date).toLocaleDateString()}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-xs font-medium text-gray-900",children:g.invoice_number}),n.jsx("td",{className:"px-3 py-2 text-xs text-gray-700",children:g.customer}),n.jsx("td",{className:"px-3 py-2 text-xs text-gray-600",children:g.customer_npwp||"-"}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-xs text-right text-gray-900",children:x(g.subtotal)}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-xs text-right font-medium text-green-600",children:x(g.ppn_amount)}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center",children:n.jsx("span",{className:`inline-flex px-1.5 py-0.5 text-[10px] font-medium rounded ${g.payment_status==="paid"?"bg-green-100 text-green-800":g.payment_status==="partial"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:g.payment_status})})]},y))})]})})]})]}),n.jsxs("div",{className:"bg-red-50 border border-red-300 rounded-lg p-2",children:[n.jsx("h4",{className:"text-xs font-semibold text-red-900 mb-1",children:e("finance.taxRuleWarning")||" CRITICAL: Indonesian PPN Tax Rule"}),n.jsxs("div",{className:"text-[10px] text-red-800 space-y-1",children:[n.jsx("p",{className:"font-semibold",children:e("finance.ppnPayableRule")||"PPN is payable based on INVOICE DATE, NOT payment date!"}),n.jsxs("ul",{className:"list-disc list-inside space-y-0.5 ml-1",children:[n.jsx("li",{children:e("finance.taxRule1")||"When you issue an invoice  PPN is immediately owed to tax office"}),n.jsx("li",{children:e("finance.taxRule2")||"Payment status does NOT matter for tax"}),n.jsx("li",{children:e("finance.taxRule3")||"You must pay PPN to government even if customer hasn't paid you yet"}),n.jsx("li",{children:e("finance.taxRule4")||"All invoices in a month = PPN payable for that month"})]})]})]}),n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-2",children:[n.jsx("h4",{className:"text-xs font-semibold text-blue-900 mb-1",children:e("finance.taxFilingGuide")||" Tax Filing Guide"}),n.jsxs("ul",{className:"text-[10px] text-blue-800 space-y-0.5",children:[n.jsxs("li",{children:[" ",n.jsx("strong",{children:e("finance.inputPPN")||"Input PPN"}),": ",e("finance.inputPPNDesc2")||"PPN paid on imports (can be claimed back)"]}),n.jsxs("li",{children:[" ",n.jsx("strong",{children:e("finance.outputPPN")||"Output PPN"}),": ",e("finance.outputPPNDesc2")||"PPN collected from customers (must pay to tax office)"]}),n.jsxs("li",{children:[" ",n.jsx("strong",{children:e("finance.netPPNPayable")||"Net PPN Payable"}),": ",e("finance.netPPNFormula2")||"Output PPN - Input PPN"]}),n.jsxs("li",{children:[" ",e("finance.taxRule5")||"If positive: Pay to tax office by month-end"]}),n.jsxs("li",{children:[" ",e("finance.taxRule6")||"If negative: Carry forward to next month or claim refund"]}),n.jsxs("li",{children:[" ",n.jsx("strong",{children:e("finance.ppnRate")||"PPN Rate"}),": 11% ",e("finance.asPerLaw")||"(as per Indonesian tax law)"]})]})]})]})}function xAe(){var B;const{profile:e}=Cr(),{dateRange:t}=rl(),[r,a]=Q.useState("inventory_movement"),[s,i]=Q.useState(!1),[o,l]=Q.useState(null),[c,d]=Q.useState(null),u={from:t.startDate,to:t.endDate},f=[{id:"coa",name:"Chart of Accounts",icon:Zt,description:"Complete COA list"},{id:"cash_ledger",name:"Cash Ledger",icon:Zt,description:"Cash on Hand & Petty Cash"},{id:"bank_ledger",name:"Bank Ledger",icon:_n,description:"All bank accounts"},{id:"sales_register",name:"Sales Register",icon:zo,description:"All sales invoices"},{id:"purchase_register",name:"Purchase Register",icon:Zt,description:"All purchase invoices"},{id:"inventory_movement",name:"Inventory Movement",icon:Rr,description:"Stock Opening + In + Out + Closing",highlight:!0},{id:"journal_register",name:"Journal Register",icon:Zt,description:"All journal entries"},{id:"general_ledger",name:"General Ledger",icon:Zt,description:"All account ledgers combined"},{id:"trial_balance",name:"Trial Balance",icon:Zt,description:"Debit/Credit summary"},{id:"fixed_assets",name:"Fixed Asset Register",icon:_n,description:"Assets with depreciation"}];Q.useEffect(()=>{r&&h()},[r,t.startDate,t.endDate]);const h=async()=>{i(!0),d(null);try{let E=null;switch(r){case"coa":E=await A();break;case"cash_ledger":E=await x();break;case"bank_ledger":E=await p();break;case"sales_register":E=await b();break;case"purchase_register":E=await m();break;case"inventory_movement":E=await g();break;case"journal_register":E=await y();break;case"general_ledger":E=await v();break;case"trial_balance":E=await _();break;case"fixed_assets":E=await j();break}l(E)}catch(E){console.error("Error loading report:",E),d(E.message||"Failed to load report")}finally{i(!1)}},A=async()=>{const{data:E,error:C}=await Z.from("chart_of_accounts").select("code, name, account_type").order("code");if(C)throw C;return E||[]},x=async()=>{const{data:E}=await Z.from("chart_of_accounts").select("id, code, name").in("code",["1101","1102"]);if(!E||E.length===0)return[];const C=E.map(z=>z.id),{data:k}=await Z.from("journal_entries").select("id, entry_date, entry_number, source_module").gte("entry_date",u.from).lte("entry_date",u.to).order("entry_date",{ascending:!0});if(!k||k.length===0)return[];const w=k.map(z=>z.id),{data:T,error:R}=await Z.from("journal_entry_lines").select("journal_entry_id, account_id, debit, credit, description").in("journal_entry_id",w).in("account_id",C);if(R)throw R;return(T==null?void 0:T.map(z=>{const ee=k.find(G=>G.id===z.journal_entry_id),Y=E.find(G=>G.id===z.account_id);return{date:ee==null?void 0:ee.entry_date,voucher_no:ee==null?void 0:ee.entry_number,account_name:Y==null?void 0:Y.name,debit:z.debit,credit:z.credit,narration:z.description}}))||[]},p=async()=>{const{data:E}=await Z.from("chart_of_accounts").select("id, code, name").like("code","1111%");if(!E||E.length===0)return[];const C=E.map(z=>z.id),{data:k}=await Z.from("journal_entries").select("id, entry_date, entry_number, source_module").gte("entry_date",u.from).lte("entry_date",u.to).order("entry_date",{ascending:!0});if(!k||k.length===0)return[];const w=k.map(z=>z.id),{data:T,error:R}=await Z.from("journal_entry_lines").select("journal_entry_id, account_id, debit, credit, description").in("journal_entry_id",w).in("account_id",C);if(R)throw R;return(T==null?void 0:T.map(z=>{const ee=k.find(G=>G.id===z.journal_entry_id),Y=E.find(G=>G.id===z.account_id);return{date:ee==null?void 0:ee.entry_date,voucher_no:ee==null?void 0:ee.entry_number,account_name:Y==null?void 0:Y.name,debit:z.debit,credit:z.credit,narration:z.description}}))||[]},b=async()=>{const{data:E,error:C}=await Z.from("sales_invoices").select(`
        invoice_number,
        invoice_date,
        customer_id,
        subtotal,
        tax_amount,
        total_amount,
        faktur_pajak_number,
        customers(company_name)
      `).gte("invoice_date",u.from).lte("invoice_date",u.to).order("invoice_date",{ascending:!0});if(C)throw C;return(E==null?void 0:E.map(k=>{var w;return{invoice_date:k.invoice_date,invoice_number:k.invoice_number,customer_name:(w=k.customers)==null?void 0:w.company_name,tax_invoice_no:k.faktur_pajak_number,net_amount:k.subtotal,ppn:k.tax_amount,total_amount:k.total_amount}}))||[]},m=async()=>{const{data:E,error:C}=await Z.from("purchase_orders").select(`
        po_number,
        po_date,
        supplier_id,
        subtotal,
        tax_amount,
        total_amount,
        currency,
        suppliers(company_name)
      `).gte("po_date",u.from).lte("po_date",u.to).order("po_date",{ascending:!0});if(C)throw C;return(E==null?void 0:E.map(k=>{var w;return{po_date:k.po_date,po_number:k.po_number,supplier_name:(w=k.suppliers)==null?void 0:w.company_name,net_amount:k.subtotal,ppn:k.tax_amount,total_amount:k.total_amount,currency:k.currency}}))||[]},g=async()=>{const{data:E}=await Z.from("inventory_transactions").select(`
        product_id,
        quantity,
        transaction_type
      `).lt("transaction_date",u.from),{data:C}=await Z.from("inventory_transactions").select(`
        product_id,
        transaction_date,
        quantity,
        transaction_type,
        reference_type,
        reference_number
      `).gte("transaction_date",u.from).lte("transaction_date",u.to),{data:k}=await Z.from("products").select("id, product_code, product_name, unit");if(!k)return[];const w=new Map;return k.forEach(T=>{w.set(T.id,{product_code:T.product_code,product_name:T.product_name,unit:T.unit||"PCS",opening:0,in_qty:0,out_qty:0,closing:0})}),E==null||E.forEach(T=>{if(w.has(T.product_id)){const R=w.get(T.product_id);T.quantity>0,R.opening+=parseFloat(T.quantity)}}),C==null||C.forEach(T=>{if(w.has(T.product_id)){const R=w.get(T.product_id);parseFloat(T.quantity)>0?R.in_qty+=parseFloat(T.quantity):R.out_qty+=Math.abs(parseFloat(T.quantity))}}),Array.from(w.values()).forEach(T=>{T.closing=T.opening+T.in_qty-T.out_qty}),Array.from(w.values())},y=async()=>{const{data:E}=await Z.from("journal_entries").select("id, entry_date, entry_number, source_module, description").gte("entry_date",u.from).lte("entry_date",u.to).order("entry_date",{ascending:!0}).order("entry_number",{ascending:!0});if(!E||E.length===0)return[];const C=E.map(q=>q.id),{data:k}=await Z.from("journal_entry_lines").select("journal_entry_id, line_number, account_id, debit, credit, description").in("journal_entry_id",C).order("line_number",{ascending:!0}),{data:w}=await Z.from("chart_of_accounts").select("id, code, name"),T=new Map((w==null?void 0:w.map(q=>[q.id,q]))||[]);return(k==null?void 0:k.map(q=>{const z=E.find(Y=>Y.id===q.journal_entry_id),ee=T.get(q.account_id);return{entry_date:z==null?void 0:z.entry_date,entry_number:z==null?void 0:z.entry_number,voucher_type:z==null?void 0:z.source_module,account_code:ee==null?void 0:ee.code,account_name:ee==null?void 0:ee.name,debit:q.debit,credit:q.credit,narration:q.description||(z==null?void 0:z.description)}}))||[]},v=async()=>{const{data:E}=await Z.from("journal_entries").select("id, entry_date, entry_number, source_module").gte("entry_date",u.from).lte("entry_date",u.to);if(!E||E.length===0)return[];const C=E.map(q=>q.id),{data:k}=await Z.from("journal_entry_lines").select("journal_entry_id, account_id, debit, credit, description").in("journal_entry_id",C),{data:w}=await Z.from("chart_of_accounts").select("id, code, name, account_type"),T=new Map((w==null?void 0:w.map(q=>[q.id,q]))||[]);return((k==null?void 0:k.map(q=>{const z=E.find(Y=>Y.id===q.journal_entry_id),ee=T.get(q.account_id);return{account_code:ee==null?void 0:ee.code,account_name:ee==null?void 0:ee.name,entry_date:z==null?void 0:z.entry_date,voucher_number:z==null?void 0:z.entry_number,debit:q.debit,credit:q.credit,description:q.description}}))||[]).sort((q,z)=>q.account_code!==z.account_code?(q.account_code||"").localeCompare(z.account_code||""):(q.entry_date||"").localeCompare(z.entry_date||""))},_=async()=>{const{data:E}=await Z.from("journal_entries").select("id").gte("entry_date",u.from).lte("entry_date",u.to);if(!E||E.length===0)return[];const C=E.map(R=>R.id),{data:k}=await Z.from("journal_entry_lines").select("account_id, debit, credit").in("journal_entry_id",C),{data:w}=await Z.from("chart_of_accounts").select("id, code, name, account_type"),T=new Map;return w==null||w.forEach(R=>{T.set(R.id,{code:R.code,name:R.name,account_type:R.account_type,debit:0,credit:0})}),k==null||k.forEach(R=>{if(T.has(R.account_id)){const q=T.get(R.account_id);q.debit+=parseFloat(R.debit||0),q.credit+=parseFloat(R.credit||0)}}),Array.from(T.values()).filter(R=>R.debit!==0||R.credit!==0).sort((R,q)=>R.code.localeCompare(q.code))},j=async()=>{const{data:E,error:C}=await Z.from("chart_of_accounts").select("code, name").gte("code","1500").lt("code","2000").order("code");if(C)throw C;return(E==null?void 0:E.map(k=>({asset_code:k.code,asset_name:k.name,acquisition_date:"",cost:"",accumulated_depreciation:"",net_book_value:""})))||[]},N=async()=>{if(!o||o.length===0){alert("No data to export");return}const{data:E}=await Z.from("app_settings").select("company_name").single(),C=(E==null?void 0:E.company_name)||"Your Company Name";let k=[],w="",T="",R=!1;switch(r){case"coa":T="CHART OF ACCOUNTS",k=o.map(U=>({"Account Code":U.code,"Account Name":U.name,"Account Type":U.account_type})),w="Chart_of_Accounts.xlsx";break;case"inventory_movement":T="INVENTORY MOVEMENT REPORT",R=!0,k=o.map(U=>({"Product Code":U.product_code,"Product Name":U.product_name,Unit:U.unit,"Opening Qty":U.opening,"Qty In":U.in_qty,"Qty Out":U.out_qty,"Closing Qty":U.closing})),w=`Inventory_Movement_${u.from}_to_${u.to}.xlsx`;break;case"sales_register":T="SALES REGISTER",R=!0,k=o.map(U=>({Date:U.invoice_date,"Invoice No":U.invoice_number,Customer:U.customer_name,"Tax Invoice No":U.tax_invoice_no,"Net Amount":U.net_amount,PPN:U.ppn,Total:U.total_amount})),w=`Sales_Register_${u.from}_to_${u.to}.xlsx`;break;case"purchase_register":T="PURCHASE REGISTER",R=!0,k=o.map(U=>({Date:U.po_date,"PO Number":U.po_number,Supplier:U.supplier_name,"Net Amount":U.net_amount,PPN:U.ppn,Total:U.total_amount,Currency:U.currency})),w=`Purchase_Register_${u.from}_to_${u.to}.xlsx`;break;case"journal_register":T="JOURNAL REGISTER",R=!0,k=o.map(U=>({Date:U.entry_date,"Entry No":U.entry_number,"Voucher Type":U.voucher_type,"Account Code":U.account_code,"Account Name":U.account_name,Debit:U.debit,Credit:U.credit,Narration:U.narration})),w=`Journal_Register_${u.from}_to_${u.to}.xlsx`;break;case"general_ledger":T="GENERAL LEDGER",R=!0,k=o.map(U=>({"Account Code":U.account_code,"Account Name":U.account_name,Date:U.entry_date,"Voucher No":U.voucher_number,Debit:U.debit,Credit:U.credit,Description:U.description})),w=`General_Ledger_${u.from}_to_${u.to}.xlsx`;break;case"trial_balance":T="TRIAL BALANCE",R=!0,k=o.map(U=>({"Account Code":U.code,"Account Name":U.name,Debit:U.debit,Credit:U.credit})),w=`Trial_Balance_${u.from}_to_${u.to}.xlsx`;break;case"cash_ledger":T="CASH LEDGER",R=!0,k=o.map(U=>({Date:U.date,"Voucher No":U.voucher_no,Account:U.account_name,Debit:U.debit,Credit:U.credit,Narration:U.narration})),w=`Cash_Ledger_${u.from}_to_${u.to}.xlsx`;break;case"bank_ledger":T="BANK LEDGER",R=!0,k=o.map(U=>({Date:U.date,"Voucher No":U.voucher_no,"Bank Account":U.account_name,Debit:U.debit,Credit:U.credit,Narration:U.narration})),w=`Bank_Ledger_${u.from}_to_${u.to}.xlsx`;break;case"fixed_assets":T="FIXED ASSET REGISTER",k=o.map(U=>({"Asset Code":U.asset_code,"Asset Name":U.asset_name,"Acquisition Date":U.acquisition_date,Cost:U.cost,"Accumulated Depreciation":U.accumulated_depreciation,"Net Book Value":U.net_book_value})),w="Fixed_Asset_Register.xlsx";break}const q=[[C],[T]];if(R){const U=new Date(u.from).toLocaleDateString("en-GB"),S=new Date(u.to).toLocaleDateString("en-GB");q.push([`Period: ${U} to ${S}`])}q.push([]);const z=Object.keys(k[0]||{}),ee=k.map(U=>z.map(S=>U[S])),Y=[...q,z,...ee],G=va.aoa_to_sheet(Y);G["!cols"]=z.map(()=>({wch:15}));const re=va.book_new();va.book_append_sheet(re,G,"Report"),E0(re,w)};return n.jsxs("div",{className:"space-y-6",children:[n.jsx("div",{className:"flex items-center justify-between",children:n.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"CA Reports - Tax Consultant Excel Exports"})}),n.jsx("div",{className:"grid grid-cols-5 gap-4",children:f.map(E=>{const C=E.icon;return n.jsxs("button",{onClick:()=>a(E.id),className:`p-4 rounded-lg border-2 text-left transition-all ${r===E.id?"border-emerald-500 bg-emerald-50":E.highlight?"border-amber-500 bg-amber-50 hover:border-amber-600":"border-slate-200 bg-white hover:border-slate-300"}`,children:[n.jsx(C,{className:`w-6 h-6 mb-2 ${r===E.id?"text-emerald-600":E.highlight?"text-amber-600":"text-slate-600"}`}),n.jsx("h3",{className:"font-semibold text-sm text-slate-900",children:E.name}),n.jsx("p",{className:"text-xs text-slate-500 mt-1",children:E.description})]},E.id)})}),n.jsxs("div",{className:"bg-white rounded-lg border border-slate-200 p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:(B=f.find(E=>E.id===r))==null?void 0:B.name}),n.jsxs("button",{onClick:N,disabled:s||!o||o.length===0,className:"px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[n.jsx(Zn,{className:"w-4 h-4"}),"Export to Excel"]})]}),s?n.jsx("div",{className:"text-center py-12 text-slate-500",children:"Loading report..."}):c?n.jsxs("div",{className:"text-center py-12",children:[n.jsx("div",{className:"text-red-600 font-semibold mb-2",children:"Error Loading Report"}),n.jsx("div",{className:"text-slate-600",children:c}),n.jsx("button",{onClick:h,className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Retry"})]}):!o||o.length===0?n.jsx("div",{className:"text-center py-12 text-slate-500",children:"No data available for selected period"}):n.jsxs("div",{className:"overflow-x-auto max-h-[600px] overflow-y-auto",children:[n.jsxs("div",{className:"text-sm text-slate-600 mb-2",children:[o.length," record(s) found"]}),n.jsxs("table",{className:"min-w-full divide-y divide-slate-200 text-sm",children:[n.jsx("thead",{className:"bg-slate-50 sticky top-0",children:n.jsxs("tr",{children:[r==="inventory_movement"&&n.jsxs(n.Fragment,{children:[n.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Product Code"}),n.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Product Name"}),n.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Unit"}),n.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"Opening"}),n.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700 bg-green-50",children:"In"}),n.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700 bg-red-50",children:"Out"}),n.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700 bg-blue-50",children:"Closing"})]}),r==="coa"&&n.jsxs(n.Fragment,{children:[n.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Code"}),n.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Account Name"}),n.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Type"})]}),r==="sales_register"&&n.jsxs(n.Fragment,{children:[n.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Date"}),n.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Invoice No"}),n.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Customer"}),n.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Tax Invoice"}),n.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"Net"}),n.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"PPN"}),n.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"Total"})]}),r==="purchase_register"&&n.jsxs(n.Fragment,{children:[n.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Date"}),n.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"PO No"}),n.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Supplier"}),n.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"Net"}),n.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"PPN"}),n.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"Total"}),n.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Currency"})]}),r==="cash_ledger"&&n.jsxs(n.Fragment,{children:[n.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Date"}),n.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Voucher No"}),n.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Account"}),n.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"Debit"}),n.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"Credit"}),n.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Narration"})]}),r==="bank_ledger"&&n.jsxs(n.Fragment,{children:[n.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Date"}),n.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Voucher No"}),n.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Bank Account"}),n.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"Debit"}),n.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"Credit"}),n.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Narration"})]}),r==="journal_register"&&n.jsxs(n.Fragment,{children:[n.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Date"}),n.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Entry No"}),n.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Voucher Type"}),n.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Account Code"}),n.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Account Name"}),n.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"Debit"}),n.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"Credit"}),n.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Narration"})]}),r==="general_ledger"&&n.jsxs(n.Fragment,{children:[n.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Account Code"}),n.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Account Name"}),n.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Date"}),n.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Voucher No"}),n.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"Debit"}),n.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"Credit"}),n.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Description"})]}),r==="trial_balance"&&n.jsxs(n.Fragment,{children:[n.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Code"}),n.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Account Name"}),n.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"Debit"}),n.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"Credit"})]}),r==="fixed_assets"&&n.jsxs(n.Fragment,{children:[n.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Asset Code"}),n.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Asset Name"}),n.jsx("th",{className:"px-4 py-3 text-left font-medium text-slate-700",children:"Acquisition Date"}),n.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"Cost"}),n.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"Acc. Depreciation"}),n.jsx("th",{className:"px-4 py-3 text-right font-medium text-slate-700",children:"Net Book Value"})]})]})}),n.jsxs("tbody",{className:"bg-white divide-y divide-slate-200",children:[r==="inventory_movement"&&o.slice(0,100).map((E,C)=>n.jsxs("tr",{className:"hover:bg-slate-50",children:[n.jsx("td",{className:"px-4 py-3 text-slate-900",children:E.product_code}),n.jsx("td",{className:"px-4 py-3 text-slate-900",children:E.product_name}),n.jsx("td",{className:"px-4 py-3 text-slate-600",children:E.unit}),n.jsx("td",{className:"px-4 py-3 text-right text-slate-900",children:E.opening}),n.jsx("td",{className:"px-4 py-3 text-right text-green-600 bg-green-50",children:E.in_qty}),n.jsx("td",{className:"px-4 py-3 text-right text-red-600 bg-red-50",children:E.out_qty}),n.jsx("td",{className:"px-4 py-3 text-right font-semibold text-blue-600 bg-blue-50",children:E.closing})]},C)),r==="coa"&&o.map((E,C)=>n.jsxs("tr",{className:"hover:bg-slate-50",children:[n.jsx("td",{className:"px-4 py-3 text-slate-900 font-mono",children:E.code}),n.jsx("td",{className:"px-4 py-3 text-slate-900",children:E.name}),n.jsx("td",{className:"px-4 py-3 text-slate-600",children:E.account_type})]},C)),r==="sales_register"&&o.slice(0,100).map((E,C)=>n.jsxs("tr",{className:"hover:bg-slate-50",children:[n.jsx("td",{className:"px-4 py-3 text-slate-900",children:E.invoice_date}),n.jsx("td",{className:"px-4 py-3 text-slate-900",children:E.invoice_number}),n.jsx("td",{className:"px-4 py-3 text-slate-900",children:E.customer_name}),n.jsx("td",{className:"px-4 py-3 text-slate-600",children:E.tax_invoice_no}),n.jsx("td",{className:"px-4 py-3 text-right text-slate-900",children:parseFloat(E.net_amount||0).toFixed(2)}),n.jsx("td",{className:"px-4 py-3 text-right text-slate-900",children:parseFloat(E.ppn||0).toFixed(2)}),n.jsx("td",{className:"px-4 py-3 text-right font-semibold text-slate-900",children:parseFloat(E.total_amount||0).toFixed(2)})]},C)),r==="purchase_register"&&o.slice(0,100).map((E,C)=>n.jsxs("tr",{className:"hover:bg-slate-50",children:[n.jsx("td",{className:"px-4 py-3 text-slate-900",children:E.po_date}),n.jsx("td",{className:"px-4 py-3 text-slate-900",children:E.po_number}),n.jsx("td",{className:"px-4 py-3 text-slate-900",children:E.supplier_name}),n.jsx("td",{className:"px-4 py-3 text-right text-slate-900",children:parseFloat(E.net_amount||0).toFixed(2)}),n.jsx("td",{className:"px-4 py-3 text-right text-slate-900",children:parseFloat(E.ppn||0).toFixed(2)}),n.jsx("td",{className:"px-4 py-3 text-right font-semibold text-slate-900",children:parseFloat(E.total_amount||0).toFixed(2)}),n.jsx("td",{className:"px-4 py-3 text-slate-600",children:E.currency})]},C)),r==="cash_ledger"&&o.slice(0,100).map((E,C)=>n.jsxs("tr",{className:"hover:bg-slate-50",children:[n.jsx("td",{className:"px-4 py-3 text-slate-900",children:E.date}),n.jsx("td",{className:"px-4 py-3 text-slate-900",children:E.voucher_no}),n.jsx("td",{className:"px-4 py-3 text-slate-900",children:E.account_name}),n.jsx("td",{className:"px-4 py-3 text-right text-slate-900",children:parseFloat(E.debit||0).toFixed(2)}),n.jsx("td",{className:"px-4 py-3 text-right text-slate-900",children:parseFloat(E.credit||0).toFixed(2)}),n.jsx("td",{className:"px-4 py-3 text-slate-600",children:E.narration})]},C)),r==="bank_ledger"&&o.slice(0,100).map((E,C)=>n.jsxs("tr",{className:"hover:bg-slate-50",children:[n.jsx("td",{className:"px-4 py-3 text-slate-900",children:E.date}),n.jsx("td",{className:"px-4 py-3 text-slate-900",children:E.voucher_no}),n.jsx("td",{className:"px-4 py-3 text-slate-900",children:E.account_name}),n.jsx("td",{className:"px-4 py-3 text-right text-slate-900",children:parseFloat(E.debit||0).toFixed(2)}),n.jsx("td",{className:"px-4 py-3 text-right text-slate-900",children:parseFloat(E.credit||0).toFixed(2)}),n.jsx("td",{className:"px-4 py-3 text-slate-600",children:E.narration})]},C)),r==="journal_register"&&o.slice(0,100).map((E,C)=>n.jsxs("tr",{className:"hover:bg-slate-50",children:[n.jsx("td",{className:"px-4 py-3 text-slate-900",children:E.entry_date}),n.jsx("td",{className:"px-4 py-3 text-slate-900",children:E.entry_number}),n.jsx("td",{className:"px-4 py-3 text-slate-600",children:E.voucher_type}),n.jsx("td",{className:"px-4 py-3 text-slate-900 font-mono",children:E.account_code}),n.jsx("td",{className:"px-4 py-3 text-slate-900",children:E.account_name}),n.jsx("td",{className:"px-4 py-3 text-right text-slate-900",children:parseFloat(E.debit||0).toFixed(2)}),n.jsx("td",{className:"px-4 py-3 text-right text-slate-900",children:parseFloat(E.credit||0).toFixed(2)}),n.jsx("td",{className:"px-4 py-3 text-slate-600",children:E.narration})]},C)),r==="general_ledger"&&o.slice(0,100).map((E,C)=>n.jsxs("tr",{className:"hover:bg-slate-50",children:[n.jsx("td",{className:"px-4 py-3 text-slate-900 font-mono",children:E.account_code}),n.jsx("td",{className:"px-4 py-3 text-slate-900",children:E.account_name}),n.jsx("td",{className:"px-4 py-3 text-slate-900",children:E.entry_date}),n.jsx("td",{className:"px-4 py-3 text-slate-900",children:E.voucher_number}),n.jsx("td",{className:"px-4 py-3 text-right text-slate-900",children:parseFloat(E.debit||0).toFixed(2)}),n.jsx("td",{className:"px-4 py-3 text-right text-slate-900",children:parseFloat(E.credit||0).toFixed(2)}),n.jsx("td",{className:"px-4 py-3 text-slate-600",children:E.description})]},C)),r==="trial_balance"&&o.slice(0,100).map((E,C)=>n.jsxs("tr",{className:"hover:bg-slate-50",children:[n.jsx("td",{className:"px-4 py-3 text-slate-900 font-mono",children:E.code}),n.jsx("td",{className:"px-4 py-3 text-slate-900",children:E.name}),n.jsx("td",{className:"px-4 py-3 text-right text-slate-900",children:parseFloat(E.debit||0).toFixed(2)}),n.jsx("td",{className:"px-4 py-3 text-right text-slate-900",children:parseFloat(E.credit||0).toFixed(2)})]},C)),r==="fixed_assets"&&o.slice(0,100).map((E,C)=>n.jsxs("tr",{className:"hover:bg-slate-50",children:[n.jsx("td",{className:"px-4 py-3 text-slate-900 font-mono",children:E.asset_code}),n.jsx("td",{className:"px-4 py-3 text-slate-900",children:E.asset_name}),n.jsx("td",{className:"px-4 py-3 text-slate-900",children:E.acquisition_date}),n.jsx("td",{className:"px-4 py-3 text-right text-slate-900",children:E.cost}),n.jsx("td",{className:"px-4 py-3 text-right text-slate-900",children:E.accumulated_depreciation}),n.jsx("td",{className:"px-4 py-3 text-right text-slate-900",children:E.net_book_value})]},C))]})]}),o.length>100&&n.jsxs("div",{className:"text-center py-4 text-slate-500 text-sm",children:["Showing first 100 records. Export to Excel to see all ",o.length," records."]})]})]})]})}const yAe=e=>[{label:e.finance.vouchers,items:[{id:"purchase",label:e.finance.purchase,shortcut:"F9"},{id:"receipt",label:e.finance.receipt,shortcut:"F6"},{id:"payment",label:e.finance.payment,shortcut:"F5"},{id:"journal",label:e.finance.journal,shortcut:"F7"},{id:"contra",label:e.finance.contra,shortcut:"F4"},{id:"expenses",label:e.finance.expenses,shortcut:"F8"},{id:"petty_cash",label:e.finance.pettyCash}]},{label:e.finance.books,items:[{id:"ledger",label:e.finance.ledger,shortcut:"Ctrl+L"},{id:"journal_register",label:e.finance.journalRegister,shortcut:"Ctrl+J"},{id:"bank_ledger",label:e.finance.bankLedger},{id:"party_ledger",label:e.finance.partyLedger},{id:"bank_recon",label:e.finance.bankReconciliation}]},{label:e.finance.reports,collapsible:!0,items:[{id:"ca_reports",label:" "+e.finance.caReports,shortcut:"Ctrl+R"},{id:"trial_balance",label:e.finance.trialBalance},{id:"pnl",label:e.finance.profitLoss},{id:"balance_sheet",label:e.finance.balanceSheet},{id:"receivables",label:e.finance.receivables},{id:"payables",label:e.finance.payables},{id:"ageing",label:e.finance.ageing},{id:"tax",label:e.finance.taxReports}]},{label:e.finance.masters,collapsible:!0,items:[{id:"coa",label:e.finance.chartOfAccounts},{id:"suppliers",label:e.finance.suppliers},{id:"banks",label:e.finance.banks}]}];function vAe(){const{profile:e}=Cr(),{t}=cn(),{dateRange:r,setDateRange:a}=rl(),[s,i]=Q.useState("purchase"),[o,l]=Q.useState(new Set),[c,d]=Q.useState(!1),u=(e==null?void 0:e.role)==="admin"||(e==null?void 0:e.role)==="accounts",f=Q.useMemo(()=>!t||!t.finance?[]:yAe(t),[t]),h=x=>{l(p=>{const b=new Set(p);return b.has(x)?b.delete(x):b.add(x),b})};Q.useEffect(()=>{const x=p=>{if(!["INPUT","TEXTAREA","SELECT"].includes(p.target.tagName))if(p.key==="F2"){p.preventDefault();const b=document.querySelector('input[type="date"]');b&&b.focus()}else p.key==="F4"?(p.preventDefault(),i("contra")):p.key==="F5"?(p.preventDefault(),i("payment")):p.key==="F6"?(p.preventDefault(),i("receipt")):p.key==="F7"?(p.preventDefault(),i("journal")):p.key==="F8"?(p.preventDefault(),i("expenses")):p.key==="F9"?(p.preventDefault(),i("purchase")):p.key==="F10"?(p.preventDefault(),window.location.hash="sales"):p.ctrlKey&&p.key==="l"?(p.preventDefault(),i("ledger")):p.ctrlKey&&p.key==="j"&&(p.preventDefault(),i("journal_register"))};return window.addEventListener("keydown",x),()=>window.removeEventListener("keydown",x)},[]);const A=()=>{var x,p,b;switch(s){case"purchase":return n.jsx(Jue,{canManage:u});case"receipt":return n.jsx(Zue,{canManage:u});case"payment":return n.jsx(eAe,{canManage:u});case"journal":return n.jsxs("div",{className:"text-center p-8 text-gray-500",children:[((x=t==null?void 0:t.finance)==null?void 0:x.journal)||"Journal"," - ",((p=t==null?void 0:t.common)==null?void 0:p.loading)||"Loading..."]});case"contra":return n.jsx(nAe,{canManage:u});case"expenses":return n.jsx(tAe,{canManage:u});case"petty_cash":return n.jsx(rAe,{canManage:u,onNavigateToFundTransfer:()=>i("contra")});case"ledger":return n.jsx(iAe,{});case"journal_register":return n.jsx(sAe,{canManage:u});case"bank_ledger":return n.jsx(cAe,{});case"party_ledger":return n.jsx(lAe,{});case"bank_recon":return n.jsx(hAe,{canManage:u});case"trial_balance":return n.jsx(q1,{initialReport:"trial_balance"});case"pnl":return n.jsx(q1,{initialReport:"pnl"});case"balance_sheet":return n.jsx(q1,{initialReport:"balance_sheet"});case"receivables":return n.jsx(dAe,{canManage:u});case"payables":return n.jsx(uAe,{canManage:u});case"ageing":return n.jsx(AAe,{});case"tax":return n.jsx(gAe,{});case"ca_reports":return n.jsx(xAe,{});case"coa":return n.jsx(fAe,{canManage:u});case"suppliers":return n.jsx(pAe,{canManage:u});case"banks":return n.jsx(mAe,{canManage:u});default:return n.jsx("div",{className:"text-center p-8 text-gray-500",children:((b=t==null?void 0:t.common)==null?void 0:b.noData)||"No data available"})}};return n.jsx(Un,{children:n.jsxs("div",{className:"flex h-screen bg-gray-50",children:[!c&&n.jsx("div",{className:"w-48 bg-white border-r border-gray-200 flex flex-col",children:n.jsx("div",{className:"flex-1 overflow-y-auto",children:f.map((x,p)=>{const b=o.has(x.label),m=x.collapsible;return n.jsxs("div",{className:p>0?"border-t border-gray-200":"",children:[m?n.jsxs("button",{onClick:()=>h(x.label),className:"w-full px-2 py-1.5 text-[10px] font-semibold text-gray-500 uppercase tracking-wider flex items-center justify-between hover:bg-gray-50",children:[n.jsx("span",{children:x.label}),b?n.jsx(Rc,{className:"w-3 h-3"}):n.jsx(Cs,{className:"w-3 h-3"})]}):n.jsx("div",{className:"px-2 py-1.5 text-[10px] font-semibold text-gray-500 uppercase tracking-wider",children:x.label}),!b&&n.jsx("div",{children:x.items.map(g=>n.jsx("button",{onClick:()=>i(g.id),className:`w-full text-left px-3 py-1.5 text-xs transition-colors ${s===g.id?"bg-blue-50 text-blue-700 font-medium border-l-2 border-blue-600":"text-gray-700 hover:bg-gray-50 border-l-2 border-transparent"}`,children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{children:g.label}),g.shortcut&&n.jsx("span",{className:"text-[10px] text-gray-400",children:g.shortcut})]})},g.id))})]},x.label)})})}),n.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[n.jsxs("div",{className:"bg-white border-b border-gray-200 px-6 py-3 flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("button",{onClick:()=>d(!c),className:"p-1.5 hover:bg-gray-100 rounded transition-colors",title:c?"Show Menu":"Hide Menu",children:c?n.jsx(e_,{className:"w-5 h-5 text-gray-600"}):n.jsx(wr,{className:"w-5 h-5 text-gray-600"})}),n.jsx("h1",{className:"text-lg font-semibold text-gray-900",children:t.finance.title})]}),n.jsxs("div",{className:"flex items-center gap-3 bg-gray-50 px-4 py-2 rounded border border-gray-300",children:[n.jsx(ja,{className:"w-4 h-4 text-gray-500"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("span",{className:"text-xs text-gray-600",children:[t.finance.dateRange,":"]}),n.jsx("input",{type:"date",value:r.startDate,onChange:x=>a({...r,startDate:x.target.value}),className:"px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),n.jsx("span",{className:"text-gray-500",children:t.finance.to}),n.jsx("input",{type:"date",value:r.endDate,onChange:x=>a({...r,endDate:x.target.value}),className:"px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]})]}),n.jsx("div",{className:"flex-1 overflow-auto bg-white",children:n.jsx("div",{className:"p-6",children:A()})})]})]})})}function bAe(){return n.jsx(Yue,{children:n.jsx(vAe,{})})}function _Ae(){const[e,t]=Q.useState(null),[r,a]=Q.useState(!0),[s,i]=Q.useState(!1);Q.useEffect(()=>{o();const f=setInterval(()=>{o()},5e3);return()=>clearInterval(f)},[]);const o=async()=>{try{console.log("[GmailSettings] === LOADING CONNECTION ===");const{data:{user:f}}=await Z.auth.getUser();if(console.log("[GmailSettings] Current user:",f==null?void 0:f.id),!f)return;const{data:h,error:A}=await Z.from("gmail_connections").select("*").eq("user_id",f.id).eq("is_connected",!0).order("created_at",{ascending:!1}).limit(1).maybeSingle();if(console.log("[GmailSettings] Query result - data:",h),console.log("[GmailSettings] Query result - error:",A),A&&A.code!=="PGRST116")throw A;t(h),console.log("[GmailSettings] Connection set:",h==null?void 0:h.email_address)}catch(f){console.error("[GmailSettings] Error loading Gmail connection:",f)}finally{a(!1)}},l=()=>{const f="90568246766-durgkfgje103589m6cuk99sv8kim69ec.apps.googleusercontent.com",h=`${window.location.origin}/auth/gmail/callback`;if(console.log(" Gmail OAuth Configuration:"),console.log("Redirect URI:",h),console.log(`
 Add this to Google Cloud Console:`),console.log("   https://console.cloud.google.com/apis/credentials"),!confirm(` IMPORTANT: Before connecting Gmail

You must add this redirect URI to Google Cloud Console:

${h}

Steps:
1. Go to: https://console.cloud.google.com/apis/credentials
2. Click your OAuth Client ID
3. Under "Authorized redirect URIs", add:
   ${h}
4. Click "Save"
5. Wait 5 minutes for changes to propagate

Have you completed these steps?`))return;const x=["https://www.googleapis.com/auth/gmail.readonly","https://www.googleapis.com/auth/gmail.modify","https://www.googleapis.com/auth/gmail.send","https://www.googleapis.com/auth/userinfo.email","https://www.googleapis.com/auth/userinfo.profile"].join(" "),p=`https://accounts.google.com/o/oauth2/v2/auth?client_id=${f}&redirect_uri=${encodeURIComponent(h)}&response_type=code&scope=${encodeURIComponent(x)}&access_type=offline&prompt=consent`,b=600,m=700,g=window.screenX+(window.outerWidth-b)/2,y=window.screenY+(window.outerHeight-m)/2;window.open(p,"Gmail OAuth",`width=${b},height=${m},left=${g},top=${y},toolbar=no,menubar=no`)},c=async()=>{if(confirm("Are you sure you want to disconnect your Gmail account? Email syncing will stop."))try{const{data:{user:f}}=await Z.auth.getUser();if(!f)return;const{error:h}=await Z.from("gmail_connections").delete().eq("user_id",f.id);if(h)throw h;alert("Gmail account disconnected successfully"),o()}catch(f){console.error("Error disconnecting Gmail:",f),alert("Failed to disconnect Gmail account")}},d=async()=>{if(e)try{const{error:f}=await Z.from("gmail_connections").update({sync_enabled:!e.sync_enabled}).eq("id",e.id);if(f)throw f;o()}catch(f){console.error("Error toggling sync:",f),alert("Failed to update sync settings")}},u=async()=>{if(s)return;i(!0),console.log({title:"Email Sync Started",message:"Syncing emails in background. You can continue using the app."});try{const{data:{session:h}}=await Z.auth.getSession();if(!h){alert("Please sign in to sync emails"),i(!1);return}const A="https://dkrtsqienlhpouohmfki.supabase.co/functions/v1/sync-gmail-emails",x=new AbortController,p=setTimeout(()=>x.abort(),12e4),b=await fetch(A,{method:"POST",headers:{Authorization:`Bearer ${h.access_token}`,"Content-Type":"application/json"},signal:x.signal});if(clearTimeout(p),!b.ok){const g=await b.text();throw new Error(`Server error (${b.status}): ${g}`)}const m=await b.json();if(m.success)alert(`Email sync completed!

 Total messages found: ${m.totalMessages}
 New emails processed: ${m.processedCount}
 New inquiries: ${m.newInquiriesCount}`),o();else throw new Error(m.error||"Sync failed")}catch(h){console.error("Error syncing emails:",h),h instanceof Error&&h.name==="AbortError"?alert("Sync is taking longer than expected. It will continue in the background. Check back in a few minutes."):alert(`Failed to sync emails: ${h instanceof Error?h.message:"Unknown error"}`)}finally{i(!1)}};return r?n.jsx("div",{className:"flex justify-center items-center py-12",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(BE,{className:"w-5 h-5 text-blue-600"}),n.jsx("h3",{className:"text-lg font-semibold",children:"Gmail Integration"})]}),e!=null&&e.is_connected?n.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-green-50 border border-green-200 rounded-lg",children:[n.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),n.jsx("span",{className:"text-sm font-medium text-green-700",children:"Connected"})]}):n.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-gray-100 border border-gray-300 rounded-lg",children:[n.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full"}),n.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Not Connected"})]})]}),e!=null&&e.is_connected?n.jsxs("div",{className:"space-y-4",children:[n.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[n.jsx("div",{className:"p-3 bg-green-50 rounded-lg",children:n.jsx(Zr,{className:"w-8 h-8 text-green-600"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h4",{className:"font-semibold text-gray-900 mb-1",children:"Gmail Connected"}),n.jsx("p",{className:"text-sm text-gray-600 mb-3",children:e.email_address}),e.last_sync&&n.jsxs("p",{className:"text-xs text-gray-500",children:["Last synced: ",new Date(e.last_sync).toLocaleString()]}),e.access_token_expires_at&&n.jsxs("p",{className:"text-xs text-gray-500",children:["Token expires: ",new Date(e.access_token_expires_at).toLocaleString()]})]})]}),n.jsxs("button",{onClick:c,className:"flex items-center gap-2 px-4 py-2 text-sm text-red-600 hover:bg-red-50 rounded-lg transition",children:[n.jsx(SE,{className:"w-4 h-4"}),"Disconnect"]})]})}),n.jsxs("div",{className:"bg-white rounded-lg shadow p-6 space-y-4",children:[n.jsx("h4",{className:"font-semibold text-gray-900",children:"Sync Settings"}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Automatic Email Sync"}),n.jsx("p",{className:"text-xs text-gray-500",children:"Fetch new emails every 10 minutes"})]}),n.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:e.sync_enabled,onChange:d,className:"sr-only peer"}),n.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),n.jsx("div",{className:"pt-4 border-t",children:n.jsxs("button",{onClick:u,disabled:s,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition text-sm font-medium disabled:opacity-50",children:[n.jsx(Hs,{className:`w-4 h-4 ${s?"animate-spin":""}`}),s?"Syncing...":"Sync Now"]})})]}),n.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx(En,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}),n.jsxs("div",{className:"text-sm text-yellow-800",children:[n.jsx("p",{className:"font-medium mb-1",children:"Important Security Information"}),n.jsxs("ul",{className:"space-y-1 text-xs",children:[n.jsx("li",{children:" Your Gmail password is never stored or accessed by this app"}),n.jsx("li",{children:" Access tokens are encrypted in the database"}),n.jsx("li",{children:" You can revoke access anytime from Google Account settings"}),n.jsx("li",{children:" Only emails marked as inquiry-related are processed"})]})]})]})})]}):n.jsx("div",{className:"bg-white rounded-lg shadow p-6 space-y-4",children:n.jsxs("div",{className:"flex items-start gap-4",children:[n.jsx("div",{className:"p-3 bg-blue-50 rounded-lg",children:n.jsx(ua,{className:"w-8 h-8 text-blue-600"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Connect Your Gmail Account"}),n.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Securely connect your Gmail account to automatically fetch pharmaceutical inquiry emails. Your password is never stored - we use Google's OAuth2 for maximum security."}),n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:[n.jsx("p",{className:"text-sm font-medium text-blue-900 mb-2",children:"What you'll get:"}),n.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[n.jsx("li",{children:" Automatic email fetching every 10 minutes"}),n.jsx("li",{children:" AI-powered inquiry extraction from emails"}),n.jsx("li",{children:" Send emails directly from CRM"}),n.jsx("li",{children:" Complete email activity tracking"})]})]}),n.jsxs("button",{onClick:l,className:"flex items-center gap-2 bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition font-medium",children:[n.jsx(ua,{className:"w-5 h-5"}),"Connect Gmail Account"]}),n.jsxs("p",{className:"text-xs text-gray-500 mt-3",children:["By connecting, you authorize this app to read and send emails on your behalf. You can revoke access anytime from your ",n.jsx("a",{href:"https://myaccount.google.com/permissions",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"Google Account settings"}),"."]})]})]})}),!1]})}function wAe({users:e,onRefresh:t}){const[r,a]=Q.useState(!1),[s,i]=Q.useState(!1),[o,l]=Q.useState(!1),[c,d]=Q.useState(null),[u,f]=Q.useState(null),[h,A]=Q.useState(!1),[x,p]=Q.useState(""),[b,m]=Q.useState({username:"",email:"",password:"",full_name:"",role:"sales"}),g=async C=>{C.preventDefault(),A(!0);try{const{data:k,error:w}=await Z.auth.signUp({email:b.email,password:b.password,options:{data:{full_name:b.full_name,email_verified:!0}}});if(w)throw w;if(!k.user)throw new Error("Failed to create user");const{error:T}=await Z.from("user_profiles").insert([{id:k.user.id,username:b.username.toLowerCase(),email:b.email,full_name:b.full_name,role:b.role,is_active:!0}]);if(T)throw T;alert(`User ${b.full_name} created successfully! Username: ${b.username}`),a(!1),m({username:"",email:"",password:"",full_name:"",role:"sales"}),t()}catch(k){console.error("Error creating user:",k),alert(k.message||"Failed to create user. Please try again.")}finally{A(!1)}},y=async C=>{if(C.preventDefault(),!!c){A(!0);try{const{error:k}=await Z.from("user_profiles").update({username:b.username.toLowerCase(),full_name:b.full_name,role:b.role}).eq("id",c.id);if(k)throw k;alert(`User ${b.full_name} updated successfully!`),i(!1),d(null),m({username:"",email:"",password:"",full_name:"",role:"sales"}),t()}catch(k){console.error("Error updating user:",k),alert(k.message||"Failed to update user. Please try again.")}finally{A(!1)}}},v=C=>{d(C),m({username:C.username,email:C.email,password:"",full_name:C.full_name,role:C.role}),i(!0)},_=async(C,k)=>{if(confirm(`Are you sure you want to ${k?"deactivate":"activate"} this user?`))try{const{error:T}=await Z.from("user_profiles").update({is_active:!k}).eq("id",C);if(T)throw T;alert(`User ${k?"deactivated":"activated"} successfully!`),t()}catch(T){console.error("Error updating user status:",T),alert("Failed to update user status.")}},j=async(C,k)=>{if(confirm(`Are you sure you want to permanently delete user "${k}"? This action cannot be undone.`))try{const{error:w}=await Z.from("user_profiles").delete().eq("id",C);if(w)throw w;alert("User deleted successfully!"),t()}catch(w){console.error("Error deleting user:",w),alert("Failed to delete user. The user may have associated records.")}},N=C=>{f(C),p(""),l(!0)},B=async C=>{if(C.preventDefault(),!!u){if(x.length<6){alert("Password must be at least 6 characters long");return}A(!0);try{const{data:{session:k}}=await Z.auth.getSession();if(!k)throw new Error("Not authenticated");const w=await fetch("https://dkrtsqienlhpouohmfki.supabase.co/functions/v1/admin-update-password",{method:"POST",headers:{Authorization:`Bearer ${k.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({user_id:u.id,new_password:x})}),T=await w.json();if(!w.ok)throw new Error(T.error||"Failed to update password");alert(`Password updated successfully for ${u.full_name}!`),l(!1),f(null),p("")}catch(k){console.error("Error changing password:",k),alert(k.message||"Failed to change password. Please try again.")}finally{A(!1)}}},E=C=>{switch(C){case"admin":return"bg-purple-100 text-purple-800 border-purple-300";case"sales":return"bg-blue-100 text-blue-800 border-blue-300";case"accounts":return"bg-green-100 text-green-800 border-green-300";case"warehouse":return"bg-orange-100 text-orange-800 border-orange-300";default:return"bg-gray-100 text-gray-800 border-gray-300"}};return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[n.jsx(Ao,{className:"w-5 h-5"}),"User Management"]}),n.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Manage system users, roles, and access permissions"})]}),n.jsxs("button",{onClick:()=>a(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition flex items-center gap-2",children:[n.jsx(r_,{className:"w-4 h-4"}),"Add New User"]})]}),n.jsx("div",{className:"space-y-3",children:e.length===0?n.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg border border-gray-200",children:[n.jsx(Ao,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),n.jsx("p",{className:"text-gray-600",children:"No users found"}),n.jsx("button",{onClick:()=>a(!0),className:"mt-4 text-blue-600 hover:text-blue-700 font-medium",children:"Add your first user"})]}):e.map(C=>n.jsxs("div",{className:"flex items-center justify-between p-4 bg-white rounded-lg border border-gray-200 hover:border-gray-300 transition",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center shadow-md",children:n.jsx("span",{className:"text-white font-bold text-lg",children:C.full_name.charAt(0).toUpperCase()})}),n.jsxs("div",{children:[n.jsx("p",{className:"font-semibold text-gray-900",children:C.full_name}),n.jsxs("p",{className:"text-sm text-gray-600 font-mono",children:["@",C.username]}),n.jsxs("p",{className:"text-sm text-gray-500 flex items-center gap-1 mt-0.5",children:[n.jsx(ua,{className:"w-3 h-3"}),C.email]}),n.jsxs("p",{className:"text-xs text-gray-400 mt-0.5",children:["Created: ",new Date(C.created_at).toLocaleDateString()]})]})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("span",{className:`px-3 py-1 border rounded-full text-xs font-medium capitalize flex items-center gap-1.5 ${E(C.role)}`,children:[n.jsx(kv,{className:"w-3 h-3"}),C.role]}),n.jsx("button",{onClick:()=>v(C),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition",title:"Edit user",children:n.jsx(OA,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>N(C),className:"p-2 text-orange-600 hover:bg-orange-50 rounded-lg transition",title:"Change password",children:n.jsx(af,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>_(C.id,C.is_active),className:`px-4 py-1.5 rounded-lg text-sm font-medium transition flex items-center gap-1.5 ${C.is_active?"bg-green-100 text-green-800 hover:bg-green-200 border border-green-300":"bg-red-100 text-red-800 hover:bg-red-200 border border-red-300"}`,title:C.is_active?"Click to deactivate":"Click to activate",children:C.is_active?n.jsxs(n.Fragment,{children:[n.jsx(Zr,{className:"w-3.5 h-3.5"}),"Active"]}):n.jsxs(n.Fragment,{children:[n.jsx(gn,{className:"w-3.5 h-3.5"}),"Inactive"]})}),n.jsx("button",{onClick:()=>j(C.id,C.username),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition",title:"Delete user",children:n.jsx(Lr,{className:"w-4 h-4"})})]})]},C.id))}),n.jsx(Ot,{isOpen:r,onClose:()=>{a(!1),m({username:"",email:"",password:"",full_name:"",role:"sales"})},title:"Add New User",children:n.jsxs("form",{onSubmit:g,className:"space-y-4",children:[n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4",children:n.jsx("p",{className:"text-sm text-blue-800",children:"Create a new user account. The user will be able to log in with their username and password."})}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-1.5",children:[n.jsx(Ao,{className:"w-4 h-4"}),"Full Name ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:b.full_name,onChange:C=>m({...b,full_name:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"John Doe",required:!0})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-1.5",children:[n.jsx(Ao,{className:"w-4 h-4"}),"Username ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:b.username,onChange:C=>m({...b,username:C.target.value.toLowerCase().replace(/[^a-z0-9]/g,"")}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-mono",placeholder:"johndoe",pattern:"[a-z0-9]+",required:!0}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Lowercase letters and numbers only. This will be used to log in."})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-1.5",children:[n.jsx(ua,{className:"w-4 h-4"}),"Email Address ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"email",value:b.email,onChange:C=>m({...b,email:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"user@company.com",required:!0}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"For system notifications only. Login uses username."})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-1.5",children:[n.jsx(af,{className:"w-4 h-4"}),"Password ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"password",value:b.password,onChange:C=>m({...b,password:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Minimum 6 characters",minLength:6,required:!0}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Minimum 6 characters. User can change this after logging in."})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-1.5",children:[n.jsx(kv,{className:"w-4 h-4"}),"Role ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("select",{value:b.role,onChange:C=>m({...b,role:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,children:[n.jsx("option",{value:"sales",children:"Sales - CRM, customers, and sales invoices"}),n.jsx("option",{value:"accounts",children:"Accounts - Finance and invoicing"}),n.jsx("option",{value:"warehouse",children:"Warehouse - Inventory management"}),n.jsx("option",{value:"admin",children:"Admin - Full system access"})]}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Role determines which modules the user can access"})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[n.jsx("button",{type:"button",onClick:()=>{a(!1),m({username:"",email:"",password:"",full_name:"",role:"sales"})},className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition",disabled:h,children:"Cancel"}),n.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",disabled:h,children:h?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Creating..."]}):n.jsxs(n.Fragment,{children:[n.jsx(r_,{className:"w-4 h-4"}),"Create User"]})})]})]})}),n.jsx(Ot,{isOpen:s,onClose:()=>{i(!1),d(null),m({username:"",email:"",password:"",full_name:"",role:"sales"})},title:"Edit User",children:n.jsxs("form",{onSubmit:y,className:"space-y-4",children:[n.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3 mb-4",children:n.jsx("p",{className:"text-sm text-amber-800",children:"Editing user profile. Email cannot be changed. To reset password, user must use password reset feature."})}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-1.5",children:[n.jsx(Ao,{className:"w-4 h-4"}),"Full Name ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:b.full_name,onChange:C=>m({...b,full_name:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"John Doe",required:!0})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-1.5",children:[n.jsx(Ao,{className:"w-4 h-4"}),"Username ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:b.username,onChange:C=>m({...b,username:C.target.value.toLowerCase().replace(/[^a-z0-9]/g,"")}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-mono",placeholder:"johndoe",pattern:"[a-z0-9]+",required:!0}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Lowercase letters and numbers only. This will be used to log in."})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-1.5",children:[n.jsx(ua,{className:"w-4 h-4"}),"Email Address"]}),n.jsx("input",{type:"email",value:b.email,className:"w-full px-3 py-2 border border-gray-200 rounded-lg bg-gray-50 text-gray-500 cursor-not-allowed",disabled:!0}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Email cannot be changed"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-1.5",children:[n.jsx(kv,{className:"w-4 h-4"}),"Role ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("select",{value:b.role,onChange:C=>m({...b,role:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,children:[n.jsx("option",{value:"sales",children:"Sales - CRM, customers, and sales invoices"}),n.jsx("option",{value:"accounts",children:"Accounts - Finance and invoicing"}),n.jsx("option",{value:"warehouse",children:"Warehouse - Inventory management"}),n.jsx("option",{value:"admin",children:"Admin - Full system access"})]}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Role determines which modules the user can access"})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[n.jsx("button",{type:"button",onClick:()=>{i(!1),d(null),m({username:"",email:"",password:"",full_name:"",role:"sales"})},className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition",disabled:h,children:"Cancel"}),n.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",disabled:h,children:h?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Saving..."]}):n.jsxs(n.Fragment,{children:[n.jsx(OA,{className:"w-4 h-4"}),"Save Changes"]})})]})]})}),n.jsx(Ot,{isOpen:o,onClose:()=>{l(!1),f(null),p("")},title:"Change User Password",children:n.jsxs("form",{onSubmit:B,className:"space-y-4",children:[n.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-3 mb-4",children:[n.jsx("p",{className:"text-sm text-orange-800 font-medium mb-2",children:"Admin Password Reset"}),n.jsxs("p",{className:"text-sm text-orange-800",children:["You are about to change the password for ",n.jsx("strong",{children:u==null?void 0:u.full_name})," (",u==null?void 0:u.username,"). The user will be able to log in immediately with the new password."]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-1.5",children:[n.jsx(af,{className:"w-4 h-4"}),"New Password ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"password",value:x,onChange:C=>p(C.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500",placeholder:"Enter new password (minimum 6 characters)",minLength:6,required:!0,autoFocus:!0}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Minimum 6 characters. Make sure to communicate the new password to the user securely."})]}),n.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:n.jsxs("p",{className:"text-sm text-yellow-800",children:[n.jsx("strong",{children:"Security Note:"})," After changing the password, communicate it to the user through a secure channel. Encourage them to change it after logging in."]})}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[n.jsx("button",{type:"button",onClick:()=>{l(!1),f(null),p("")},className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition",disabled:h,children:"Cancel"}),n.jsx("button",{type:"submit",className:"px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",disabled:h,children:h?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Updating..."]}):n.jsxs(n.Fragment,{children:[n.jsx(af,{className:"w-4 h-4"}),"Change Password"]})})]})]})})]})}function NAe(){const[e,t]=Q.useState([]),[r,a]=Q.useState(!0),[s,i]=Q.useState(!1),[o,l]=Q.useState(null),[c,d]=Q.useState({template_name:"",subject:"",body:"",category:"custom",variables:[]}),u=[{value:"price_quote",label:"Price Quote"},{value:"coa_msds",label:"COA/MSDS"},{value:"follow_up",label:"Follow-up"},{value:"thank_you",label:"Thank You"},{value:"custom",label:"Custom"}],f=["{{contact_person}}","{{company_name}}","{{product_name}}","{{specification}}","{{quantity}}","{{supplier_name}}","{{supplier_country}}","{{inquiry_number}}","{{user_name}}"];Q.useEffect(()=>{h()},[]);const h=async()=>{try{const{data:v,error:_}=await Z.from("crm_email_templates").select("*").order("created_at",{ascending:!1});if(_)throw _;t(v||[])}catch(v){console.error("Error loading templates:",v)}finally{a(!1)}},A=async v=>{v.preventDefault();try{const{data:{user:_}}=await Z.auth.getUser();if(!_)throw new Error("Not authenticated");if(o){const{error:j}=await Z.from("crm_email_templates").update({template_name:c.template_name,subject:c.subject,body:c.body,category:c.category,variables:c.variables,updated_at:new Date().toISOString()}).eq("id",o.id);if(j)throw j;alert("Template updated successfully!")}else{const{error:j}=await Z.from("crm_email_templates").insert([{...c,created_by:_.id,is_active:!0,use_count:0}]);if(j)throw j;alert("Template created successfully!")}y(),i(!1),h()}catch(_){console.error("Error saving template:",_),alert(_.message||"Failed to save template")}},x=v=>{l(v),d({template_name:v.template_name,subject:v.subject,body:v.body,category:v.category,variables:v.variables||[]}),i(!0)},p=async v=>{try{const{data:{user:_}}=await Z.auth.getUser();if(!_)throw new Error("Not authenticated");const{error:j}=await Z.from("crm_email_templates").insert([{template_name:`${v.template_name} (Copy)`,subject:v.subject,body:v.body,category:v.category,variables:v.variables,created_by:_.id,is_active:!0,use_count:0}]);if(j)throw j;alert("Template duplicated successfully!"),h()}catch(_){console.error("Error duplicating template:",_),alert("Failed to duplicate template")}},b=async(v,_)=>{if(confirm(`Are you sure you want to delete "${_}"?`))try{const{error:j}=await Z.from("crm_email_templates").delete().eq("id",v);if(j)throw j;alert("Template deleted successfully!"),h()}catch(j){console.error("Error deleting template:",j),alert("Failed to delete template")}},m=async(v,_)=>{try{const{error:j}=await Z.from("crm_email_templates").update({is_active:!_}).eq("id",v);if(j)throw j;h()}catch(j){console.error("Error updating template:",j),alert("Failed to update template status")}},g=v=>{d(_=>({..._,body:_.body+" "+v,variables:_.variables.includes(v)?_.variables:[..._.variables,v]}))},y=()=>{l(null),d({template_name:"",subject:"",body:"",category:"custom",variables:[]})};return r?n.jsx("div",{className:"flex justify-center py-12",children:n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[n.jsx(Zt,{className:"w-5 h-5"}),"Email Templates"]}),n.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Create and manage reusable email templates with variable placeholders"})]}),n.jsxs("button",{onClick:()=>{y(),i(!0)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition flex items-center gap-2",children:[n.jsx(Pr,{className:"w-4 h-4"}),"New Template"]})]}),n.jsx("div",{className:"grid grid-cols-1 gap-4",children:e.length===0?n.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg border border-gray-200",children:[n.jsx(Zt,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),n.jsx("p",{className:"text-gray-600",children:"No templates found"}),n.jsx("button",{onClick:()=>i(!0),className:"mt-4 text-blue-600 hover:text-blue-700 font-medium",children:"Create your first template"})]}):e.map(v=>{var _,j;return n.jsx("div",{className:"p-4 bg-white rounded-lg border border-gray-200 hover:border-gray-300 transition",children:n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("h4",{className:"font-semibold text-gray-900",children:v.template_name}),n.jsx("span",{className:"px-2 py-0.5 text-xs bg-gray-100 text-gray-700 rounded",children:((_=u.find(N=>N.value===v.category))==null?void 0:_.label)||v.category})]}),n.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:[n.jsx("strong",{children:"Subject:"})," ",v.subject]}),n.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[n.jsxs("span",{children:["Used ",v.use_count," times"]}),((j=v.variables)==null?void 0:j.length)>0&&n.jsxs("span",{children:["Variables: ",v.variables.length]})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>m(v.id,v.is_active),className:`p-2 rounded-lg transition ${v.is_active?"text-green-600 hover:bg-green-50":"text-gray-400 hover:bg-gray-50"}`,title:v.is_active?"Active":"Inactive",children:v.is_active?n.jsx(Zr,{className:"w-4 h-4"}):n.jsx(gn,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>p(v),className:"p-2 text-gray-600 hover:bg-gray-50 rounded-lg transition",title:"Duplicate",children:n.jsx(m7,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>x(v),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition",title:"Edit",children:n.jsx(OA,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>b(v.id,v.template_name),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition",title:"Delete",children:n.jsx(Lr,{className:"w-4 h-4"})})]})]})},v.id)})}),n.jsx(Ot,{isOpen:s,onClose:()=>{i(!1),y()},title:o?"Edit Template":"Create New Template",children:n.jsxs("form",{onSubmit:A,className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Template Name *"}),n.jsx("input",{type:"text",value:c.template_name,onChange:v=>d({...c,template_name:v.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,placeholder:"e.g., Price Quote - English"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category *"}),n.jsx("select",{value:c.category,onChange:v=>d({...c,category:v.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:u.map(v=>n.jsx("option",{value:v.value,children:v.label},v.value))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Subject *"}),n.jsx("input",{type:"text",value:c.subject,onChange:v=>d({...c,subject:v.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,placeholder:"Use variables like {{product_name}}"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Body (HTML) *"}),n.jsx("div",{className:"mb-2 flex flex-wrap gap-1",children:f.map(v=>n.jsx("button",{type:"button",onClick:()=>g(v),className:"px-2 py-1 text-xs bg-gray-100 hover:bg-gray-200 text-gray-700 rounded",children:v},v))}),n.jsx("textarea",{value:c.body,onChange:v=>d({...c,body:v.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:15,placeholder:"Enter email template body..."})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[n.jsx("button",{type:"button",onClick:()=>{i(!1),y()},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),n.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:o?"Update Template":"Create Template"})]})]})})]})}function jAe(){const[e,t]=Q.useState(!1),[r,a]=Q.useState(!1),[s,i]=Q.useState(!1),[o,l]=Q.useState(!0),[c,d]=Q.useState([]),[u,f]=Q.useState(null),[h,A]=Q.useState(new Set),[x,p]=Q.useState(100);Q.useEffect(()=>{b()},[]);const b=async()=>{l(!0);try{const{data:{user:N}}=await Z.auth.getUser();if(!N)return;const{data:B,error:E}=await Z.from("extracted_contacts").select("*").eq("user_id",N.id).order("created_at",{ascending:!1});if(E)throw E;if(B){const C=B.map(k=>({id:k.id,companyName:k.company_name,customerName:k.customer_name,emailIds:k.email_ids,phone:k.phone,mobile:k.mobile,website:k.website,address:k.address,source:k.source,confidence:k.confidence,extracted_at:k.extracted_at}));d(C),A(new Set(C.map((k,w)=>w)))}}catch(N){console.error("Error loading contacts:",N)}finally{l(!1)}},m=async()=>{t(!0);try{const{data:{user:N}}=await Z.auth.getUser();if(!N){alert("Please log in to extract contacts.");return}const{data:B,error:E}=await Z.from("gmail_connections").select("*").eq("user_id",N.id).eq("is_connected",!0).maybeSingle();if(E&&E.code!=="PGRST116"){console.error("Error fetching Gmail connection:",E),alert(`Database error: ${E.message}. Please contact support.`);return}if(!B||!B.access_token||!B.refresh_token){alert("Gmail is not connected properly. Please reconnect Gmail in Settings  Gmail tab.");return}const C="https://dkrtsqienlhpouohmfki.supabase.co/functions/v1/extract-gmail-contacts";console.log("Calling edge function:",C);const k=await fetch(C,{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRrcnRzcWllbmxocG91b2htZmtpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE5MTQxNzQsImV4cCI6MjA3NzQ5MDE3NH0.Kjo9RU0WAfQSSEm2vTWmuN5BIYk_hvanKDQkm5qdCGY","Content-Type":"application/json"},body:JSON.stringify({access_token:B.access_token,refresh_token:B.refresh_token,max_emails:x,user_id:N.id,connection_id:B.id})});console.log("Response status:",k.status);const w=await k.json();if(console.log("Response data:",w),!k.ok)throw new Error(w.error||`HTTP ${k.status}: ${k.statusText}`);if(w.success){if(w.contacts&&w.contacts.length>0){const T=w.contacts.map(q=>({user_id:N.id,company_name:q.companyName||"",customer_name:q.customerName||"",email_ids:q.emailIds||"",phone:q.phone||"",mobile:q.mobile||"",website:q.website||"",address:q.address||"",source:q.source||"Gmail",confidence:q.confidence||.5,extracted_at:new Date().toISOString()})),{error:R}=await Z.from("extracted_contacts").insert(T);if(R){console.error("Error saving contacts:",R),alert("Contacts extracted but failed to save to database. Please try again.");return}await b()}f({total_emails:w.total_emails_scanned||w.total_emails,total_contacts:w.total_contacts}),w.message&&alert(`Success! ${w.message}

Contacts saved to database and will persist across refreshes.`)}else throw new Error(w.error||"Failed to extract contacts")}catch(N){console.error("Error extracting contacts:",N);const B=N.message||"Unknown error occurred";alert(`Failed to extract contacts: ${B}

Please check:
1. Gmail is connected in Settings  Gmail tab
2. Your Gmail connection hasn't expired
3. Try reconnecting Gmail if issues persist`)}finally{t(!1)}},g=()=>{if(c.length===0){alert("No contacts to export");return}const N=c.filter((k,w)=>h.has(w)),B=va.json_to_sheet(N.map(k=>({"Company Name":k.companyName,"Customer Name":k.customerName,"Email IDs":k.emailIds,Phone:k.phone,Mobile:k.mobile,Website:k.website,Address:k.address,Source:k.source}))),E=va.book_new();va.book_append_sheet(E,B,"Clients");const C=[{wch:30},{wch:25},{wch:40},{wch:18},{wch:18},{wch:30},{wch:40},{wch:12}];B["!cols"]=C,E0(E,`Extracted_Contacts_${new Date().toISOString().split("T")[0]}.xlsx`)},y=async()=>{if(h.size===0){alert("Please select contacts to import");return}if(confirm(`Are you sure you want to import ${h.size} contact(s) to the Customers database?

This will create new customer records for selected contacts.`)){a(!0);try{const E=c.filter((w,T)=>h.has(T)).map(w=>{var T;return{company_name:w.companyName||"Unknown Company",contact_person:w.customerName||"",email:((T=w.emailIds.split(";")[0])==null?void 0:T.trim())||"",phone:w.phone||w.mobile||"",website:w.website||"",address:w.address||"",country:"Indonesia",city:"Jakarta Pusat",is_active:!0}}),{data:C,error:k}=await Z.from("customers").upsert(E,{onConflict:"email",ignoreDuplicates:!1}).select();if(k)throw k;alert(`Successfully imported ${(C==null?void 0:C.length)||h.size} customer(s)!`)}catch(B){console.error("Error importing customers:",B),alert("Failed to import some customers. They may already exist in the database.")}finally{a(!1)}}},v=async()=>{if(c.length===0){alert("No contacts to clear");return}if(confirm(`Are you sure you want to PERMANENTLY DELETE all ${c.length} extracted contact(s)?

This action cannot be undone!`)){i(!0);try{const{data:{user:B}}=await Z.auth.getUser();if(!B)return;const{error:E}=await Z.from("extracted_contacts").delete().eq("user_id",B.id);if(E)throw E;d([]),A(new Set),f(null),alert("All extracted contacts have been cleared successfully!")}catch(B){console.error("Error clearing contacts:",B),alert("Failed to clear contacts. Please try again.")}finally{i(!1)}}},_=()=>{h.size===c.length?A(new Set):A(new Set(c.map((N,B)=>B)))},j=N=>{const B=new Set(h);B.has(N)?B.delete(N):B.add(N),A(B)};return o?n.jsxs("div",{className:"flex items-center justify-center py-12",children:[n.jsx(Hs,{className:"h-8 w-8 animate-spin text-blue-600"}),n.jsx("span",{className:"ml-3 text-gray-600",children:"Loading extracted contacts..."})]}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Extract Data from Gmail"}),n.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-green-50 border border-green-200 rounded-lg",children:[n.jsx(vo,{className:"h-5 w-5 text-green-600"}),n.jsxs("span",{className:"text-sm font-medium text-green-900",children:[c.length," Total Contacts Saved"]})]})]}),n.jsx("p",{className:"text-sm text-gray-600",children:"AI-powered extraction of contact information from Gmail using OpenAI. The system intelligently extracts company names, contacts, phone numbers, and websites from email signatures. All extracted data is saved to database and persists across page refreshes."}),n.jsxs("div",{className:"mt-2 bg-blue-50 border border-blue-200 rounded-lg p-3",children:[n.jsx("p",{className:"text-xs text-blue-900 font-medium",children:"AI-Powered Features:"}),n.jsxs("ul",{className:"text-xs text-blue-700 mt-1 space-y-1 ml-4 list-disc",children:[n.jsx("li",{children:'AI extracts REAL company names from signatures (e.g., "PT Genero Pharmaceuticals")'}),n.jsx("li",{children:"Filters out email greetings, body text, and system emails"}),n.jsx("li",{children:"Tracks processed emails - click again to get NEXT batch of NEW emails"}),n.jsx("li",{children:"All extracted contacts are saved permanently in database"}),n.jsx("li",{children:"High-quality extraction - processes 100-500 emails (takes time for AI quality)"})]})]})]}),n.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("div",{className:"flex-1",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Maximum Emails to Scan"}),n.jsx("input",{type:"number",value:x,onChange:N=>p(Math.max(50,Math.min(500,parseInt(N.target.value)||100))),min:"50",max:"500",step:"50",className:"w-48 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Range: 50 - 500 emails. Recommended: 100-200 for quality"})]}),n.jsx("div",{className:"flex-shrink-0 pt-6",children:n.jsx("button",{onClick:m,disabled:e,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:e?n.jsxs(n.Fragment,{children:[n.jsx(Hs,{className:"h-5 w-5 animate-spin"}),"Extracting..."]}):n.jsxs(n.Fragment,{children:[n.jsx(ua,{className:"h-5 w-5"}),"Extract Contacts"]})})})]}),u&&n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:n.jsxs("div",{className:"flex items-start",children:[n.jsx(Zr,{className:"h-5 w-5 text-blue-600 mr-2 mt-0.5 flex-shrink-0"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-blue-900 font-medium",children:"AI Extraction completed successfully!"}),n.jsxs("p",{className:"text-xs text-blue-700 mt-1",children:["AI processed ",u.total_emails," NEW unprocessed emails and extracted ",u.total_contacts," high-quality contacts"]}),n.jsx("p",{className:"text-xs text-blue-600 mt-1",children:'Click "Extract Contacts" again to process the next batch of NEW emails'})]})]})})]}),c.length>0&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("h3",{className:"text-md font-semibold text-gray-900",children:["Extracted Contacts (",h.size," selected)"]}),n.jsx("button",{onClick:_,className:"text-sm text-blue-600 hover:text-blue-700",children:h.size===c.length?"Deselect All":"Select All"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("button",{onClick:g,disabled:h.size===0,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[n.jsx(Zn,{className:"h-4 w-4"}),"Export to Excel"]}),n.jsx("button",{onClick:y,disabled:r||h.size===0,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:r?n.jsxs(n.Fragment,{children:[n.jsx(Hs,{className:"h-4 w-4 animate-spin"}),"Importing..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Rl,{className:"h-4 w-4"}),"Import to Customers"]})}),n.jsx("button",{onClick:v,disabled:s||c.length===0,className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed",children:s?n.jsxs(n.Fragment,{children:[n.jsx(Hs,{className:"h-4 w-4 animate-spin"}),"Clearing..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Lr,{className:"h-4 w-4"}),"Clear All Data"]})})]})]}),n.jsx("div",{className:"overflow-x-auto max-h-96 overflow-y-auto border border-gray-200 rounded-lg",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50 sticky top-0",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-3 text-left",children:n.jsx("input",{type:"checkbox",checked:h.size===c.length,onChange:_,className:"rounded border-gray-300"})}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Company"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Contact Person"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Email IDs"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Phone"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Mobile"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Website"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:c.map((N,B)=>n.jsxs("tr",{className:`hover:bg-gray-50 ${h.has(B)?"bg-blue-50":""}`,children:[n.jsx("td",{className:"px-4 py-3",children:n.jsx("input",{type:"checkbox",checked:h.has(B),onChange:()=>j(B),className:"rounded border-gray-300"})}),n.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:N.companyName||"-"}),n.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:N.customerName||"-"}),n.jsx("td",{className:"px-4 py-3 text-sm text-gray-600 max-w-xs truncate",title:N.emailIds,children:N.emailIds||"-"}),n.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:N.phone||"-"}),n.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:N.mobile||"-"}),n.jsx("td",{className:"px-4 py-3 text-sm text-blue-600 max-w-xs truncate",title:N.website,children:N.website||"-"})]},B))})]})})]}),n.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:n.jsxs("div",{className:"flex items-start",children:[n.jsx(En,{className:"h-5 w-5 text-yellow-600 mr-2 mt-0.5 flex-shrink-0"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-yellow-900 font-medium",children:"Review before importing"}),n.jsx("p",{className:"text-xs text-yellow-700 mt-1",children:"Please review the extracted contacts carefully. The system attempts to deduplicate and merge contacts from the same company, but you should verify the data before importing to your customer database."})]})]})})]})]})}function kAe(){const[e,t]=Q.useState([]),[r,a]=Q.useState([]),[s,i]=Q.useState(!0),[o,l]=Q.useState(""),[c,d]=Q.useState(!1),[u,f]=Q.useState(null),[h,A]=Q.useState({company_name:"",contact_person:"",email:"",phone:"",address:"",city:"",postal_code:"",npwp:"",payment_terms_days:30,is_active:!0});Q.useEffect(()=>{x()},[]),Q.useEffect(()=>{p()},[o,e]);const x=async()=>{try{i(!0);const{data:_,error:j}=await Z.from("suppliers").select("*").order("company_name");if(j)throw j;t(_||[])}catch(_){console.error("Error fetching suppliers:",_.message),alert("Failed to load suppliers")}finally{i(!1)}},p=()=>{if(!o){a(e);return}const _=e.filter(j=>{var N,B,E;return j.company_name.toLowerCase().includes(o.toLowerCase())||((N=j.contact_person)==null?void 0:N.toLowerCase().includes(o.toLowerCase()))||((B=j.email)==null?void 0:B.toLowerCase().includes(o.toLowerCase()))||((E=j.phone)==null?void 0:E.toLowerCase().includes(o.toLowerCase()))});a(_)},b=()=>{f(null),A({company_name:"",contact_person:"",email:"",phone:"",address:"",city:"",postal_code:"",npwp:"",payment_terms_days:30,is_active:!0}),d(!0)},m=_=>{f(_),A({company_name:_.company_name,contact_person:_.contact_person||"",email:_.email||"",phone:_.phone||"",address:_.address||"",city:_.city||"",postal_code:_.postal_code||"",npwp:_.npwp||"",payment_terms_days:_.payment_terms_days||30,is_active:_.is_active}),d(!0)},g=async _=>{if(_.preventDefault(),!h.company_name.trim()){alert("Company name is required");return}try{if(u){const{error:j}=await Z.from("suppliers").update(h).eq("id",u.id);if(j)throw j;alert("Supplier updated successfully!")}else{const{error:j}=await Z.from("suppliers").insert([h]);if(j)throw j;alert("Supplier created successfully!")}d(!1),x()}catch(j){console.error("Error saving supplier:",j.message),alert("Failed to save supplier: "+j.message)}},y=async _=>{if(confirm("Are you sure you want to delete this supplier?"))try{const{error:j}=await Z.from("suppliers").delete().eq("id",_);if(j)throw j;alert("Supplier deleted successfully!"),x()}catch(j){console.error("Error deleting supplier:",j.message),alert("Failed to delete supplier: "+j.message)}},v=async _=>{try{const{error:j}=await Z.from("suppliers").update({is_active:!_.is_active}).eq("id",_.id);if(j)throw j;x()}catch(j){console.error("Error updating supplier status:",j.message),alert("Failed to update supplier status")}};return s?n.jsx("div",{className:"flex items-center justify-center py-12",children:n.jsx("div",{className:"text-gray-500",children:"Loading suppliers..."})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Suppliers Management"}),n.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Manage your suppliers and vendors"})]}),n.jsxs("button",{onClick:b,className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:[n.jsx(Pr,{className:"w-4 h-4"}),"Add Supplier"]})]}),n.jsx("div",{className:"flex gap-4",children:n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(Ca,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),n.jsx("input",{type:"text",placeholder:"Search suppliers...",value:o,onChange:_=>l(_.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]})}),n.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Company Name"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact Person"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Phone"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:6,className:"px-6 py-12 text-center text-gray-500",children:"No suppliers found"})}):r.map(_=>n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("div",{className:"text-sm font-medium text-gray-900",children:_.company_name})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("div",{className:"text-sm text-gray-500",children:_.contact_person||"-"})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("div",{className:"text-sm text-gray-500",children:_.email||"-"})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("div",{className:"text-sm text-gray-500",children:_.phone||"-"})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("button",{onClick:()=>v(_),className:`px-2 py-1 text-xs font-medium rounded-full ${_.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:_.is_active?"Active":"Inactive"})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{onClick:()=>m(_),className:"text-blue-600 hover:text-blue-800",title:"Edit",children:n.jsx(Aa,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>y(_.id),className:"text-red-600 hover:text-red-800",title:"Delete",children:n.jsx(Lr,{className:"w-4 h-4"})})]})})]},_.id))})]})}),c&&n.jsx(Ot,{isOpen:c,onClose:()=>d(!1),title:u?"Edit Supplier":"Add New Supplier",maxWidth:"max-w-4xl",children:n.jsxs("form",{onSubmit:g,className:"space-y-6",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"col-span-2",children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Company Name ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:h.company_name,onChange:_=>A({...h,company_name:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contact Person"}),n.jsx("input",{type:"text",value:h.contact_person,onChange:_=>A({...h,contact_person:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),n.jsx("input",{type:"text",value:h.phone,onChange:_=>A({...h,phone:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),n.jsx("input",{type:"email",value:h.email,onChange:_=>A({...h,email:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"NPWP"}),n.jsx("input",{type:"text",value:h.npwp,onChange:_=>A({...h,npwp:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),n.jsx("textarea",{value:h.address,onChange:_=>A({...h,address:_.target.value}),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"City"}),n.jsx("input",{type:"text",value:h.city,onChange:_=>A({...h,city:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Postal Code"}),n.jsx("input",{type:"text",value:h.postal_code,onChange:_=>A({...h,postal_code:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Terms (Days)"}),n.jsx("input",{type:"number",value:h.payment_terms_days,onChange:_=>A({...h,payment_terms_days:parseInt(_.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"0"})]}),n.jsxs("div",{className:"flex items-center",children:[n.jsx("input",{type:"checkbox",id:"is_active",checked:h.is_active,onChange:_=>A({...h,is_active:_.target.checked}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),n.jsx("label",{htmlFor:"is_active",className:"ml-2 block text-sm text-gray-700",children:"Active"})]})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[n.jsxs("button",{type:"button",onClick:()=>d(!1),className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-2",children:[n.jsx(wr,{className:"w-4 h-4"}),"Cancel"]}),n.jsxs("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[n.jsx(eg,{className:"w-4 h-4"}),u?"Update":"Create"," Supplier"]})]})]})})]})}function CAe(){const{t:e}=cn(),{profile:t}=Cr(),r=()=>(t==null?void 0:t.role)==="sales"?"gmail":((t==null?void 0:t.role)==="accounts","company"),[a,s]=Q.useState(r()),[i,o]=Q.useState(!0),[l,c]=Q.useState(!1),[d,u]=Q.useState(null),[f,h]=Q.useState([]),[A,x]=Q.useState({company_name:"",company_address:"",company_phone:"",company_email:"",tax_rate:11,invoice_prefix:"SAPJ",invoice_start_number:1,email_host:"",email_port:587,email_username:"",low_stock_threshold:100,expiry_alert_days:30,default_language:"en",financial_year_start:"2024-01-01",financial_year_end:"2024-12-31",current_financial_year:"2024"});Q.useEffect(()=>{(t==null?void 0:t.role)==="admin"?(p(),b()):(t==null?void 0:t.role)==="accounts"?p():o(!1)},[t]);const p=async()=>{try{const{data:_,error:j}=await Z.from("app_settings").select("*").limit(1).maybeSingle();if(j)throw j;_&&(u(_),x({company_name:_.company_name||"",company_address:_.company_address||"",company_phone:_.company_phone||"",company_email:_.company_email||"",tax_rate:_.tax_rate||11,invoice_prefix:_.invoice_prefix||"SAPJ",invoice_start_number:_.invoice_start_number||1,email_host:_.email_host||"",email_port:_.email_port||587,email_username:_.email_username||"",low_stock_threshold:_.low_stock_threshold||100,expiry_alert_days:_.expiry_alert_days||30,default_language:_.default_language||"en",financial_year_start:_.financial_year_start||"2024-01-01",financial_year_end:_.financial_year_end||"2024-12-31",current_financial_year:_.current_financial_year||"2024"}))}catch(_){console.error("Error loading settings:",_)}finally{o(!1)}},b=async()=>{try{const{data:_,error:j}=await Z.from("user_profiles").select("id, email, full_name, role, is_active, created_at, username").order("created_at",{ascending:!1});if(j)throw j;h(_||[])}catch(_){console.error("Error loading users:",_),h([])}},m=async _=>{_.preventDefault(),c(!0);try{if(d){const{error:j}=await Z.from("app_settings").update({...A,email_host:A.email_host||null,email_username:A.email_username||null}).eq("id",d.id);if(j)throw j}else{const{error:j}=await Z.from("app_settings").insert([{...A,email_host:A.email_host||null,email_username:A.email_username||null}]);if(j)throw j}alert("Settings saved successfully!"),p()}catch(j){console.error("Error saving settings:",j),alert("Failed to save settings. Please try again.")}finally{c(!1)}},g=(t==null?void 0:t.role)==="admin",y=(t==null?void 0:t.role)==="sales",v=(t==null?void 0:t.role)==="accounts";return!g&&!y&&!v?n.jsx(Un,{children:n.jsxs("div",{className:"text-center py-12",children:[n.jsx("p",{className:"text-xl text-gray-600",children:"You do not have permission to access settings."}),n.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Only administrators can view and modify system settings."})]})}):i?n.jsx(Un,{children:n.jsx("div",{className:"flex items-center justify-center py-12",children:n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})})}):n.jsx(Un,{children:n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Settings"}),n.jsx("p",{className:"text-gray-600 mt-1",children:"Configure system settings and manage users"})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow",children:[n.jsx("div",{className:"border-b border-gray-200",children:n.jsxs("nav",{className:"flex -mb-px",children:[(g||v)&&n.jsx("button",{onClick:()=>s("company"),className:`px-6 py-3 text-sm font-medium border-b-2 transition ${a==="company"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(_n,{className:"w-4 h-4"}),"Company Profile"]})}),g&&n.jsx("button",{onClick:()=>s("users"),className:`px-6 py-3 text-sm font-medium border-b-2 transition ${a==="users"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(vo,{className:"w-4 h-4"}),"Users"]})}),(g||v||y)&&n.jsx("button",{onClick:()=>s("suppliers"),className:`px-6 py-3 text-sm font-medium border-b-2 transition ${a==="suppliers"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Rr,{className:"w-4 h-4"}),"Suppliers"]})}),g&&n.jsx("button",{onClick:()=>s("financial"),className:`px-6 py-3 text-sm font-medium border-b-2 transition ${a==="financial"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ja,{className:"w-4 h-4"}),"Financial Year"]})}),g&&n.jsx("button",{onClick:()=>s("system"),className:`px-6 py-3 text-sm font-medium border-b-2 transition ${a==="system"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Rr,{className:"w-4 h-4"}),"System"]})}),(g||y)&&n.jsx("button",{onClick:()=>s("gmail"),className:`px-6 py-3 text-sm font-medium border-b-2 transition ${a==="gmail"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ua,{className:"w-4 h-4"}),"Gmail"]})}),(g||y)&&n.jsx("button",{onClick:()=>s("templates"),className:`px-6 py-3 text-sm font-medium border-b-2 transition ${a==="templates"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Zt,{className:"w-4 h-4"}),"Email Templates"]})}),(g||y)&&n.jsx("button",{onClick:()=>s("extract"),className:`px-6 py-3 text-sm font-medium border-b-2 transition ${a==="extract"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Zn,{className:"w-4 h-4"}),"Extract Data"]})})]})}),n.jsxs("div",{className:"p-6",children:[a==="gmail"&&n.jsx(_Ae,{}),a==="templates"&&n.jsx(NAe,{}),a==="extract"&&n.jsx(jAe,{}),a==="suppliers"&&n.jsx(kAe,{}),a==="company"&&n.jsxs("form",{onSubmit:m,className:"space-y-6",children:[n.jsxs("div",{children:[n.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[n.jsx(_n,{className:"w-5 h-5"}),"Company Information"]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Company Name *"}),n.jsx("input",{type:"text",value:A.company_name,onChange:_=>x({...A,company_name:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),n.jsx("textarea",{value:A.company_address,onChange:_=>x({...A,company_address:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:3})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),n.jsx("input",{type:"text",value:A.company_phone,onChange:_=>x({...A,company_phone:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),n.jsx("input",{type:"email",value:A.company_email,onChange:_=>x({...A,company_email:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]})]})]}),n.jsxs("div",{className:"border-t pt-6",children:[n.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[n.jsx(hn,{className:"w-5 h-5"}),"Financial Settings"]}),n.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Default Tax Rate (%)"}),n.jsx("input",{type:"number",value:A.tax_rate,onChange:_=>x({...A,tax_rate:Number(_.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"0",max:"100",step:"0.1"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Invoice Prefix"}),n.jsx("input",{type:"text",value:A.invoice_prefix,onChange:_=>x({...A,invoice_prefix:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Invoice Start Number"}),n.jsx("input",{type:"number",value:A.invoice_start_number,onChange:_=>x({...A,invoice_start_number:Number(_.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"1"})]})]})]}),n.jsx("div",{className:"flex justify-end",children:n.jsxs("button",{type:"submit",disabled:l,className:"flex items-center gap-2 bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition disabled:opacity-50",children:[n.jsx(eg,{className:"w-5 h-5"}),l?"Saving...":"Save Settings"]})})]}),a==="users"&&n.jsx(wAe,{users:f,onRefresh:b}),a==="financial"&&n.jsxs("form",{onSubmit:m,className:"space-y-6",children:[n.jsxs("div",{children:[n.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[n.jsx(ja,{className:"w-5 h-5"}),"Financial Year Configuration"]}),n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:n.jsx("p",{className:"text-sm text-blue-800",children:"Configure your company's financial year period. This will be used to filter reports and dashboard statistics. The system will automatically organize data based on the selected financial year."})}),n.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Financial Year *"}),n.jsxs("select",{value:A.current_financial_year,onChange:_=>{const j=_.target.value;x({...A,current_financial_year:j,financial_year_start:`${j}-01-01`,financial_year_end:`${j}-12-31`})},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[n.jsx("option",{value:"2023",children:"2023"}),n.jsx("option",{value:"2024",children:"2024"}),n.jsx("option",{value:"2025",children:"2025"}),n.jsx("option",{value:"2026",children:"2026"}),n.jsx("option",{value:"2027",children:"2027"})]}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Select the active financial year"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date *"}),n.jsx("input",{type:"date",value:A.financial_year_start,onChange:_=>x({...A,financial_year_start:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Financial year start date"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date *"}),n.jsx("input",{type:"date",value:A.financial_year_end,onChange:_=>x({...A,financial_year_end:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Financial year end date"})]})]}),n.jsxs("div",{className:"mt-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:[n.jsx("p",{className:"text-sm font-medium text-green-800 mb-2",children:"Active Financial Year Period:"}),n.jsxs("p",{className:"text-lg font-bold text-green-900",children:[new Date(A.financial_year_start).toLocaleDateString()," - ",new Date(A.financial_year_end).toLocaleDateString()]})]})]}),n.jsx("div",{className:"flex justify-end",children:n.jsxs("button",{type:"submit",disabled:l,className:"flex items-center gap-2 bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition disabled:opacity-50",children:[n.jsx(eg,{className:"w-5 h-5"}),l?"Saving...":"Save Financial Year"]})})]}),a==="system"&&n.jsxs("form",{onSubmit:m,className:"space-y-6",children:[n.jsxs("div",{children:[n.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[n.jsx(Rr,{className:"w-5 h-5"}),"Inventory Alerts"]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Low Stock Threshold"}),n.jsx("input",{type:"number",value:A.low_stock_threshold,onChange:_=>x({...A,low_stock_threshold:Number(_.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"0"}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Alert when stock falls below this quantity"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Expiry Alert Days"}),n.jsx("input",{type:"number",value:A.expiry_alert_days,onChange:_=>x({...A,expiry_alert_days:Number(_.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"0"}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Alert when products will expire within this many days"})]})]})]}),n.jsxs("div",{className:"border-t pt-6",children:[n.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[n.jsx(ua,{className:"w-5 h-5"}),"Email Configuration (Optional)"]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"SMTP Host"}),n.jsx("input",{type:"text",value:A.email_host,onChange:_=>x({...A,email_host:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"smtp.example.com"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"SMTP Port"}),n.jsx("input",{type:"number",value:A.email_port,onChange:_=>x({...A,email_port:Number(_.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Username"}),n.jsx("input",{type:"text",value:A.email_username,onChange:_=>x({...A,email_username:_.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"user@example.com"})]})]})]}),n.jsxs("div",{className:"border-t pt-6",children:[n.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Language Preference"}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Default Language"}),n.jsxs("select",{value:A.default_language,onChange:_=>x({...A,default_language:_.target.value}),className:"w-full md:w-1/3 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"en",children:"English"}),n.jsx("option",{value:"id",children:"Indonesian"})]})]})]}),n.jsx("div",{className:"flex justify-end",children:n.jsxs("button",{type:"submit",disabled:l,className:"flex items-center gap-2 bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition disabled:opacity-50",children:[n.jsx(eg,{className:"w-5 h-5"}),l?"Saving...":"Save Settings"]})})]})]})]})]})})}const K1=[{email:"admin@pharma.com",password:"admin123",fullName:"Admin User",role:"admin"},{email:"accounts@pharma.com",password:"accounts123",fullName:"Accounts Manager",role:"accounts"},{email:"sales@pharma.com",password:"sales123",fullName:"Sales Representative",role:"sales"},{email:"warehouse@pharma.com",password:"warehouse123",fullName:"Warehouse Staff",role:"warehouse"}];function SAe(){const[e,t]=Q.useState(!1),[r,a]=Q.useState([]),[s,i]=Q.useState(!0),o=async()=>{t(!0),a([]);const l=[];for(const c of K1){try{const{data:d,error:u}=await Z.auth.signUp({email:c.email,password:c.password});if(u){l.push({email:c.email,success:!1,message:`Auth error: ${u.message}`});continue}if(!d.user){l.push({email:c.email,success:!1,message:"No user data returned"});continue}const{error:f}=await Z.from("user_profiles").insert({id:d.user.id,email:c.email,full_name:c.fullName,role:c.role,language:"en",is_active:!0});if(f){l.push({email:c.email,success:!1,message:`Profile error: ${f.message}`});continue}l.push({email:c.email,success:!0,message:`Created successfully (${c.role})`})}catch(d){l.push({email:c.email,success:!1,message:`Error: ${d.message}`})}a([...l])}t(!1)};return n.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-slate-100 flex items-center justify-center p-4",children:n.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-2xl p-8",children:[n.jsx("div",{className:"flex items-center justify-center mb-6",children:n.jsx("div",{className:"bg-blue-600 p-3 rounded-full",children:n.jsx(r_,{className:"w-8 h-8 text-white"})})}),n.jsx("h1",{className:"text-3xl font-bold text-center text-gray-900 mb-2",children:"Database Setup"}),n.jsx("p",{className:"text-gray-600 text-center mb-8",children:"Create sample users for your Pharma Trading System"}),s&&n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[n.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"Important Instructions:"}),n.jsxs("ol",{className:"text-sm text-blue-800 space-y-2 list-decimal list-inside",children:[n.jsx("li",{children:"This page will create 4 test users with their profiles"}),n.jsx("li",{children:"Make sure your Supabase email confirmation is disabled in your project settings"}),n.jsx("li",{children:"If email confirmation is enabled, you'll need to confirm emails manually"}),n.jsx("li",{children:"Click the button below to create all users at once"})]}),n.jsx("button",{onClick:()=>i(!1),className:"mt-3 text-sm text-blue-600 hover:text-blue-700 font-medium",children:"Got it, hide this"})]}),n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Users to create:"}),n.jsx("div",{className:"space-y-2",children:K1.map(l=>n.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-3 rounded-lg",children:[n.jsxs("div",{children:[n.jsx("div",{className:"font-medium text-gray-900",children:l.email}),n.jsxs("div",{className:"text-sm text-gray-600",children:["Password: ",l.password," | Role: ",l.role]})]}),n.jsx("span",{className:`px-2 py-1 text-xs rounded ${l.role==="admin"?"bg-red-100 text-red-700":l.role==="accounts"?"bg-green-100 text-green-700":l.role==="sales"?"bg-blue-100 text-blue-700":"bg-yellow-100 text-yellow-700"}`,children:l.role})]},l.email))})]}),n.jsx("button",{onClick:o,disabled:e,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed font-medium text-lg mb-6",children:e?"Creating Users...":"Create All Users"}),r.length>0&&n.jsxs("div",{className:"space-y-2",children:[n.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Results:"}),r.map((l,c)=>n.jsxs("div",{className:`flex items-start gap-3 p-3 rounded-lg ${l.success?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"}`,children:[l.success?n.jsx(Zr,{className:"w-5 h-5 text-green-600 flex-shrink-0 mt-0.5"}):n.jsx(gn,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:`font-medium ${l.success?"text-green-900":"text-red-900"}`,children:l.email}),n.jsx("div",{className:`text-sm ${l.success?"text-green-700":"text-red-700"}`,children:l.message})]})]},c))]}),r.length>0&&r.every(l=>l.success)&&n.jsxs("div",{className:"mt-6 bg-green-50 border border-green-200 rounded-lg p-4",children:[n.jsx("h3",{className:"font-semibold text-green-900 mb-2",children:"Success!"}),n.jsx("p",{className:"text-sm text-green-800 mb-3",children:"All users created successfully. You can now navigate to the login page and use any of these credentials:"}),n.jsx("div",{className:"text-sm text-green-800 space-y-1",children:K1.map(l=>n.jsxs("div",{children:[" ",l.email," / ",l.password]},l.email))}),n.jsx("button",{onClick:()=>window.location.href="/",className:"mt-4 w-full bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 transition font-medium",children:"Go to Login"})]}),r.length>0&&r.some(l=>!l.success)&&n.jsxs("div",{className:"mt-6 bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[n.jsx("h3",{className:"font-semibold text-yellow-900 mb-2",children:"Partial Success"}),n.jsx("p",{className:"text-sm text-yellow-800 mb-2",children:"Some users failed to create. This is usually because:"}),n.jsxs("ul",{className:"text-sm text-yellow-800 list-disc list-inside space-y-1",children:[n.jsx("li",{children:"The email already exists"}),n.jsx("li",{children:"Email confirmation is required (check Supabase Auth settings)"}),n.jsx("li",{children:"RLS policies prevented profile creation"})]}),n.jsx("p",{className:"text-sm text-yellow-800 mt-3",children:"See CREATE_USERS.md for manual setup instructions."})]})]})})}function BAe(){const[e,t]=Q.useState("loading"),[r,a]=Q.useState("Processing Gmail connection...");Q.useEffect(()=>{s()},[]);const s=async()=>{try{console.log("Starting Gmail OAuth callback...");const i=new URLSearchParams(window.location.search),o=i.get("code"),l=i.get("error");if(console.log("Callback params:",{hasCode:!!o,error:l}),l){t("error"),a(`Authorization failed: ${l}`),setTimeout(()=>window.close(),3e3);return}if(!o){t("error"),a("No authorization code received"),setTimeout(()=>window.close(),3e3);return}console.log("[GmailCallback] === CHECKING AUTH ===");const{data:{user:c}}=await Z.auth.getUser();if(console.log("[GmailCallback] Current user:",c==null?void 0:c.id),!c){console.error("[GmailCallback] No user found!"),t("error"),a("User not authenticated"),setTimeout(()=>window.close(),3e3);return}const d="90568246766-durgkfgje103589m6cuk99sv8kim69ec.apps.googleusercontent.com",u="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",f=`${window.location.origin}/auth/gmail/callback`;console.log("OAuth config:",{hasClientId:!!d,hasClientSecret:!!u,redirectUri:f}),console.log("Exchanging code for token...");const h=await fetch("https://oauth2.googleapis.com/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({code:o,client_id:d,client_secret:u,redirect_uri:f,grant_type:"authorization_code"})});if(!h.ok){const y=await h.text();throw console.error("Token exchange failed:",y),new Error(`Token exchange failed: ${y}`)}const A=await h.json();console.log("Token received, fetching profile...");const x=await fetch("https://www.googleapis.com/oauth2/v2/userinfo",{headers:{Authorization:`Bearer ${A.access_token}`}});if(!x.ok){const y=await x.text();throw console.error("Profile fetch failed:",{status:x.status,statusText:x.statusText,body:y}),new Error(`Failed to fetch Gmail profile (${x.status}): ${y}`)}const p=await x.json();console.log("Profile fetched:",p.email);const b=new Date;b.setSeconds(b.getSeconds()+A.expires_in),console.log("[GmailCallback] === SAVING TO DATABASE ==="),console.log("[GmailCallback] Saving for user_id:",c.id),console.log("[GmailCallback] Email:",p.email),console.log("[GmailCallback] Expires at:",b.toISOString());const{data:m,error:g}=await Z.from("gmail_connections").upsert({user_id:c.id,email_address:p.email,access_token:A.access_token,refresh_token:A.refresh_token,access_token_expires_at:b.toISOString(),is_connected:!0,sync_enabled:!0,last_sync:null},{onConflict:"user_id,email_address"}).select();if(console.log("[GmailCallback] Insert result:",m),console.log("[GmailCallback] Insert error:",g),g)throw console.error("[GmailCallback] Database error:",g),g;console.log("[GmailCallback] Gmail connection saved to database successfully"),t("success"),a("Gmail connected successfully! You can close this window."),setTimeout(()=>{window.opener&&window.opener.location.reload(),window.close()},2e3)}catch(i){console.error("Callback error:",i),t("error"),a(i instanceof Error?i.message:"Failed to connect Gmail"),setTimeout(()=>window.close(),5e3)}};return n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-md w-full text-center",children:[e==="loading"&&n.jsxs(n.Fragment,{children:[n.jsx(Vo,{className:"w-16 h-16 text-blue-600 mx-auto mb-4 animate-spin"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Connecting Gmail..."}),n.jsx("p",{className:"text-gray-600",children:r})]}),e==="success"&&n.jsxs(n.Fragment,{children:[n.jsx(Zr,{className:"w-16 h-16 text-green-600 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Success!"}),n.jsx("p",{className:"text-gray-600",children:r})]}),e==="error"&&n.jsxs(n.Fragment,{children:[n.jsx(gn,{className:"w-16 h-16 text-red-600 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Connection Failed"}),n.jsx("p",{className:"text-gray-600",children:r}),n.jsx("button",{onClick:()=>window.close(),className:"mt-4 px-4 py-2 bg-gray-200 hover:bg-gray-300 rounded-lg transition",children:"Close Window"})]})]})})}function EAe({existingOrder:e,onSuccess:t,onCancel:r}){const{user:a}=Cr(),{t:s}=cn(),[i,o]=Q.useState([]),[l,c]=Q.useState([]),[d,u]=Q.useState({}),[f,h]=Q.useState(!1),[A,x]=Q.useState({customer_id:"",customer_po_number:"",customer_po_date:new Date().toISOString().split("T")[0],so_date:new Date().toISOString().split("T")[0],expected_delivery_date:"",notes:"",currency:"IDR"}),[p,b]=Q.useState(null),[m,g]=Q.useState([{product_id:"",quantity:1,unit_price:0,discount_percent:0,discount_amount:0,tax_percent:0,tax_amount:0,line_total:0,item_delivery_date:"",notes:""}]);Q.useEffect(()=>{y(),v()},[]),Q.useEffect(()=>{if(e&&(x({customer_id:e.customer_id,customer_po_number:e.customer_po_number,customer_po_date:e.customer_po_date,so_date:e.so_date,expected_delivery_date:e.expected_delivery_date||"",notes:e.notes||"",currency:e.currency||"IDR"}),e.sales_order_items&&e.sales_order_items.length>0)){const Y=e.sales_order_items.map(G=>({product_id:G.product_id,quantity:G.quantity,unit_price:G.unit_price,discount_percent:G.discount_percent,discount_amount:G.discount_amount,tax_percent:G.tax_percent,tax_amount:G.tax_amount,line_total:G.line_total,item_delivery_date:G.item_delivery_date||"",notes:G.notes||""}));g(Y),Y.forEach(G=>{G.product_id&&_(G.product_id)})}},[e]);const y=async()=>{try{const{data:Y,error:G}=await Z.from("customers").select("id, company_name").eq("is_active",!0).order("company_name");if(G)throw G;o(Y||[])}catch(Y){console.error("Error fetching customers:",Y.message)}},v=async()=>{try{const{data:Y,error:G}=await Z.from("products").select("id, product_name, product_code").eq("is_active",!0).order("product_name");if(G)throw G;c(Y||[])}catch(Y){console.error("Error fetching products:",Y.message)}},_=async Y=>{try{const{data:G,error:re}=await Z.from("batches").select("id, current_stock").eq("product_id",Y);if(re)throw re;const U=(G==null?void 0:G.reduce((P,I)=>P+Number(I.current_stock),0))||0,{data:S}=await Z.from("stock_reservations").select("reserved_quantity").eq("product_id",Y).eq("status","active"),D=(S==null?void 0:S.reduce((P,I)=>P+Number(I.reserved_quantity),0))||0,L=U-D;u(P=>({...P,[Y]:{total_stock:U,reserved_stock:D,free_stock:L}}))}catch(G){console.error("Error fetching stock info:",G.message)}},j=(Y,G)=>{if(!l.find(S=>S.id===G))return;const U=[...m];U[Y].product_id=G,U[Y].unit_price=0,g(U),N(Y),_(G)},N=Y=>{const G=m[Y],re=G.quantity*G.unit_price,U=G.discount_percent>0?re*G.discount_percent/100:G.discount_amount,S=re-U,D=S*G.tax_percent/100,L=S+D,P=[...m];P[Y]={...G,discount_amount:U,tax_amount:D,line_total:L},g(P)},B=(Y,G,re)=>{const U=[...m];U[Y]={...U[Y],[G]:re};const S=U[Y],D=S.quantity*S.unit_price,L=S.discount_percent>0?D*S.discount_percent/100:S.discount_amount,P=D-L,I=P*S.tax_percent/100,H=P+I;U[Y]={...S,discount_amount:L,tax_amount:I,line_total:H},g(U)},E=()=>{g([...m,{product_id:"",quantity:1,unit_price:0,discount_percent:0,discount_amount:0,tax_percent:0,tax_amount:0,line_total:0,item_delivery_date:"",notes:""}])},C=Y=>{if(m.length===1){alert("At least one item is required");return}console.log("Removing item at index:",Y,"Current items count:",m.length);const G=m.filter((re,U)=>U!==Y);console.log("New items count after removal:",G.length),g(G)},k=async()=>{if(!p)return null;try{console.log("Starting file upload:",p.name);const Y=p.name.split(".").pop(),re=`customer-po/${`${Date.now()}_${Math.random().toString(36).substring(7)}.${Y}`}`;console.log("Uploading to path:",re);const{data:U,error:S}=await Z.storage.from("sales-order-documents").upload(re,p,{cacheControl:"3600",upsert:!1});if(S)throw console.error("Upload error:",S),S;console.log("File uploaded successfully:",U);const{data:{publicUrl:D}}=Z.storage.from("sales-order-documents").getPublicUrl(re);return console.log("Public URL generated:",D),D}catch(Y){throw console.error("Error uploading file:",Y),alert(`Failed to upload PO file: ${Y.message||"Unknown error"}`),Y}},w=async(Y,G=!1)=>{if(Y.preventDefault(),!A.customer_id){alert("Please select a customer");return}if(!A.customer_po_number.trim()){alert("Please enter customer PO number");return}if(m.length===0||m.some(U=>!U.product_id||U.quantity<=0)){alert("Please add valid items to the order");return}const re=e&&["approved","stock_reserved","shortage","pending_approval"].includes(e.status);if(!(re&&e&&!confirm(` Warning: This order has been approved or is awaiting approval.

Editing will:
 Release existing stock reservations
 Require re-approval from admin
 Reset status to "Pending Approval"

Do you want to continue?`)))try{h(!0);let U=(e==null?void 0:e.customer_po_file_url)||null;if(p&&(console.log("Uploading PO file..."),U=await k(),console.log("PO file URL:",U),!U))throw new Error("File upload returned no URL");const S=m.reduce((P,I)=>P+(I.quantity*I.unit_price-I.discount_amount),0),D=m.reduce((P,I)=>P+I.tax_amount,0),L=m.reduce((P,I)=>P+I.line_total,0);if(e){if(re){console.log("Releasing stock reservations for order:",e.id);const{error:K}=await Z.rpc("fn_release_reservation_by_so_id",{p_so_id:e.id,p_released_by:a==null?void 0:a.id});K&&console.error("Error releasing reservations:",K)}let P;re||G?P="pending_approval":P="draft",console.log("Updating order. Items count:",m.length);const{error:I}=await Z.from("sales_orders").update({customer_id:A.customer_id,customer_po_number:A.customer_po_number,customer_po_date:A.customer_po_date,customer_po_file_url:U,so_date:A.so_date,currency:A.currency,expected_delivery_date:A.expected_delivery_date||null,notes:A.notes||null,status:P,subtotal_amount:S,tax_amount:D,total_amount:L,updated_at:new Date().toISOString()}).eq("id",e.id);if(I)throw I;const{error:H}=await Z.from("sales_order_items").delete().eq("sales_order_id",e.id);if(H)throw H;const V=m.map(K=>({sales_order_id:e.id,product_id:K.product_id,quantity:K.quantity,unit_price:K.unit_price,discount_percent:K.discount_percent,discount_amount:K.discount_amount,tax_percent:K.tax_percent,tax_amount:K.tax_amount,line_total:K.line_total,item_delivery_date:K.item_delivery_date||null,notes:K.notes||null}));console.log("Inserting items. Count:",V.length);const{data:W,error:M}=await Z.from("sales_order_items").insert(V).select();if(M)throw M;console.log("Items inserted successfully. Count:",(W==null?void 0:W.length)||0),W&&W.length!==m.length&&(console.error("WARNING: Item count mismatch!",{expected:m.length,inserted:W.length}),alert(` Warning: Expected ${m.length} items but only ${W.length} were saved. Please verify the order.`)),alert(`Sales order updated successfully${re?" and submitted for re-approval. Stock reservations have been released.":G?" and submitted for approval":""}!`)}else{const{data:P,error:I}=await Z.from("sales_orders").insert({so_number:"",customer_id:A.customer_id,customer_po_number:A.customer_po_number,customer_po_date:A.customer_po_date,customer_po_file_url:U,so_date:A.so_date,currency:A.currency,expected_delivery_date:A.expected_delivery_date||null,notes:A.notes||null,status:G?"pending_approval":"draft",subtotal_amount:S,tax_amount:D,total_amount:L,created_by:a==null?void 0:a.id}).select().single();if(I)throw I;const H=m.map(W=>({sales_order_id:P.id,product_id:W.product_id,quantity:W.quantity,unit_price:W.unit_price,discount_percent:W.discount_percent,discount_amount:W.discount_amount,tax_percent:W.tax_percent,tax_amount:W.tax_amount,line_total:W.line_total,item_delivery_date:W.item_delivery_date||null,notes:W.notes||null})),{error:V}=await Z.from("sales_order_items").insert(H);if(V)throw V;alert(`Sales order created successfully${G?" and submitted for approval":""}!`)}t()}catch(U){console.error(e?"Error updating sales order:":"Error creating sales order:",U.message),alert((e?"Failed to update sales order: ":"Failed to create sales order: ")+U.message)}finally{h(!1)}},T=(Y,G)=>{const re=d[Y];if(!re)return null;const U=re.free_stock>=G;return n.jsxs("div",{className:`text-xs ${U?"text-green-600":"text-red-600"}`,children:[s("salesOrders.freeStock"),": ",re.free_stock," ",!U&&"(Insufficient!)"]})},R=m.reduce((Y,G)=>Y+(G.quantity*G.unit_price-G.discount_amount),0),q=m.reduce((Y,G)=>Y+G.tax_amount,0),z=m.reduce((Y,G)=>Y+G.line_total,0),ee=Y=>A.currency==="USD"?`$ ${Y.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`:`Rp ${Y.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})}`;return n.jsxs("form",{className:"space-y-6",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s("sales.customer")," *"]}),n.jsxs("select",{value:A.customer_id,onChange:Y=>x({...A,customer_id:Y.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0,children:[n.jsxs("option",{value:"",children:[s("common.filter")," ",s("sales.customer")]}),i.map(Y=>n.jsx("option",{value:Y.id,children:Y.company_name},Y.id))]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s("salesOrders.customerPoNumber")," *"]}),n.jsx("input",{type:"text",value:A.customer_po_number,onChange:Y=>x({...A,customer_po_number:Y.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s("salesOrders.customerPoDate")," *"]}),n.jsx("input",{type:"date",value:A.customer_po_date,onChange:Y=>x({...A,customer_po_date:Y.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:s("salesOrders.soDate")}),n.jsx("input",{type:"date",value:A.so_date,onChange:Y=>x({...A,so_date:Y.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Currency *"}),n.jsxs("select",{value:A.currency,onChange:Y=>x({...A,currency:Y.target.value}),className:"w-full border rounded-lg px-3 py-2",required:!0,children:[n.jsx("option",{value:"IDR",children:"IDR (Rp)"}),n.jsx("option",{value:"USD",children:"USD ($)"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:s("salesOrders.expectedDeliveryDate")}),n.jsx("input",{type:"date",value:A.expected_delivery_date,onChange:Y=>x({...A,expected_delivery_date:Y.target.value}),className:"w-full border rounded-lg px-3 py-2"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:s("salesOrders.uploadPo")}),(e==null?void 0:e.customer_po_file_url)&&!p&&n.jsxs("div",{className:"mb-2 p-2 bg-blue-50 border border-blue-200 rounded-lg flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Zt,{className:"w-4 h-4 text-blue-600"}),n.jsx("span",{className:"text-sm text-blue-700",children:"PO file already uploaded"})]}),n.jsx("a",{href:e.customer_po_file_url,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-800 underline",children:"View"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{type:"file",accept:".pdf,.jpg,.jpeg,.png",onChange:Y=>{var G;return b(((G=Y.target.files)==null?void 0:G[0])||null)},className:"w-full border rounded-lg px-3 py-2"}),p&&n.jsx("button",{type:"button",onClick:()=>b(null),className:"text-red-600 hover:text-red-800",title:"Remove selected file",children:n.jsx(wr,{className:"w-5 h-5"})})]}),p&&n.jsxs("p",{className:"mt-1 text-sm text-green-600 flex items-center gap-1",children:[n.jsx(Zt,{className:"w-4 h-4"}),"Ready to upload: ",p.name]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:s("salesOrders.notes")}),n.jsx("textarea",{value:A.notes,onChange:Y=>x({...A,notes:Y.target.value}),className:"w-full border rounded-lg px-3 py-2",rows:2})]}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex justify-between items-center mb-3",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Order Items"}),n.jsxs("button",{type:"button",onClick:E,className:"flex items-center gap-1 text-blue-600 hover:text-blue-800 text-sm",children:[n.jsx(Pr,{className:"w-4 h-4"})," ",s("sales.addItem")]})]}),n.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:m.map((Y,G)=>n.jsxs("div",{className:"border rounded-lg p-3 bg-gray-50",children:[n.jsxs("div",{className:"grid grid-cols-6 gap-2",children:[n.jsxs("div",{className:"col-span-2",children:[n.jsxs("label",{className:"text-xs text-gray-600",children:[s("salesOrders.product")," *"]}),n.jsxs("select",{value:Y.product_id,onChange:re=>j(G,re.target.value),className:"w-full border rounded px-2 py-1 text-sm",required:!0,children:[n.jsx("option",{value:"",children:"Select Product"}),l.map(re=>n.jsx("option",{value:re.id,children:re.product_name},re.id))]}),Y.product_id&&T(Y.product_id,Y.quantity)]}),n.jsxs("div",{children:[n.jsxs("label",{className:"text-xs text-gray-600",children:[s("sales.quantity")," *"]}),n.jsx("input",{type:"text",value:Y.quantity===0?"":Y.quantity,onChange:re=>{const U=re.target.value;if(U==="")B(G,"quantity",0);else{const S=parseFloat(U);isNaN(S)||B(G,"quantity",S)}},onBlur:re=>{re.target.value===""&&B(G,"quantity",0)},className:"w-full border rounded px-2 py-1 text-sm",placeholder:"Enter quantity",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-xs text-gray-600",children:s("sales.unitPrice")}),n.jsx("input",{type:"text",value:Y.unit_price===0?"":Y.unit_price,onChange:re=>{const U=re.target.value;if(U==="")B(G,"unit_price",0);else{const S=parseFloat(U);isNaN(S)||B(G,"unit_price",S)}},onBlur:re=>{re.target.value===""&&B(G,"unit_price",0)},className:"w-full border rounded px-2 py-1 text-sm",placeholder:"Enter price"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-xs text-gray-600",children:s("salesOrders.discountPercent")}),n.jsx("input",{type:"text",value:Y.discount_percent===0?"":Y.discount_percent,onChange:re=>{const U=re.target.value;if(U==="")B(G,"discount_percent",0);else{const S=parseFloat(U);!isNaN(S)&&S>=0&&S<=100&&B(G,"discount_percent",S)}},onBlur:re=>{re.target.value===""&&B(G,"discount_percent",0)},className:"w-full border rounded px-2 py-1 text-sm",placeholder:"0"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-xs text-gray-600",children:s("salesOrders.taxPercent")}),n.jsx("input",{type:"text",value:Y.tax_percent===0?"":Y.tax_percent,onChange:re=>{const U=re.target.value;if(U==="")B(G,"tax_percent",0);else{const S=parseFloat(U);!isNaN(S)&&S>=0&&S<=100&&B(G,"tax_percent",S)}},onBlur:re=>{re.target.value===""&&B(G,"tax_percent",0)},className:"w-full border rounded px-2 py-1 text-sm",placeholder:"0"})]})]}),n.jsxs("div",{className:"grid grid-cols-6 gap-2 mt-2",children:[n.jsxs("div",{className:"col-span-2",children:[n.jsx("label",{className:"text-xs text-gray-600",children:"Item Delivery Date"}),n.jsx("input",{type:"date",value:Y.item_delivery_date,onChange:re=>B(G,"item_delivery_date",re.target.value),className:"w-full border rounded px-2 py-1 text-sm"})]}),n.jsxs("div",{className:"col-span-3",children:[n.jsx("label",{className:"text-xs text-gray-600",children:"Notes"}),n.jsx("input",{type:"text",value:Y.notes,onChange:re=>B(G,"notes",re.target.value),className:"w-full border rounded px-2 py-1 text-sm"})]}),n.jsxs("div",{className:"flex items-end justify-between",children:[n.jsxs("div",{children:[n.jsx("label",{className:"text-xs text-gray-600",children:s("salesOrders.lineTotal")}),n.jsx("div",{className:"text-sm font-medium",children:ee(Y.line_total)})]}),n.jsx("button",{type:"button",onClick:()=>C(G),className:"text-red-600 hover:text-red-800",children:n.jsx(Lr,{className:"w-4 h-4"})})]})]})]},G))})]}),n.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsxs("span",{children:[s("sales.subtotal"),":"]}),n.jsx("span",{className:"font-medium",children:ee(R)})]}),n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsxs("span",{children:[s("sales.tax"),":"]}),n.jsx("span",{className:"font-medium",children:ee(q)})]}),n.jsxs("div",{className:"flex justify-between text-lg font-bold border-t pt-2",children:[n.jsxs("span",{children:[s("salesOrders.grandTotal"),":"]}),n.jsx("span",{children:ee(z)})]})]})}),n.jsxs("div",{className:"flex justify-end gap-3",children:[n.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 border rounded-lg hover:bg-gray-50",disabled:f,children:s("common.cancel")}),!(e&&["approved","stock_reserved","shortage","pending_approval"].includes(e.status))&&n.jsx("button",{type:"button",onClick:Y=>w(Y,!1),className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700",disabled:f,children:s(f?"common.loading":"salesOrders.saveAsDraft")}),n.jsx("button",{type:"button",onClick:Y=>w(Y,!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",disabled:f,children:f?`${s("common.submit")}...`:e&&["approved","stock_reserved","shortage","pending_approval"].includes(e.status)?"Submit for Re-Approval":s("salesOrders.submitForApproval")})]})]})}function FAe({salesOrder:e,items:t,onClose:r}){const a=Q.useRef(null),{t:s,language:i}=cn(),o=e.currency||"IDR",l=o==="IDR"?"Rp":o==="USD"?"$":o,c=m=>m==null?`${l} 0,00`:o==="IDR"?`${m.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})}`:`${l} ${m.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`,d=m=>{const g=new Date(m),y=i==="id"?["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agt","Sep","Okt","Nov","Des"]:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],v=g.getDate(),_=y[g.getMonth()],j=g.getFullYear();return`${v} ${_} ${j}`},u=m=>i==="id"?f(m):h(m),f=m=>{if(m===0)return"Nol";const g=["","Satu","Dua","Tiga","Empat","Lima","Enam","Tujuh","Delapan","Sembilan"],y=["Sepuluh","Sebelas","Dua Belas","Tiga Belas","Empat Belas","Lima Belas","Enam Belas","Tujuh Belas","Delapan Belas","Sembilan Belas"],v=["","","Dua Puluh","Tiga Puluh","Empat Puluh","Lima Puluh","Enam Puluh","Tujuh Puluh","Delapan Puluh","Sembilan Puluh"],_=j=>{if(j===0)return"";if(j<10)return g[j];if(j>=10&&j<20)return y[j-10];if(j<100){const C=Math.floor(j/10),k=j%10;return v[C]+(k>0?" "+g[k]:"")}const N=Math.floor(j/100),B=j%100;return(N===1?"Seratus":g[N]+" Ratus")+(B>0?" "+_(B):"")};if(m<1e3)return _(m);if(m<1e6){const j=Math.floor(m/1e3),N=m%1e3;return(j===1?"Seribu":_(j)+" Ribu")+(N>0?" "+_(N):"")}if(m<1e9){const j=Math.floor(m/1e6),N=m%1e6,B=_(j)+" Juta",E=N>=1e3?(Math.floor(N/1e3)===1?"Seribu":_(Math.floor(N/1e3))+" Ribu")+(N%1e3>0?" "+_(N%1e3):""):N>0?_(N):"";return B+(E?" "+E:"")}return m.toString()},h=m=>{if(m===0)return"Zero";const g=["","One","Two","Three","Four","Five","Six","Seven","Eight","Nine"],y=["Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"],v=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"],_=j=>{if(j===0)return"";if(j<10)return g[j];if(j>=10&&j<20)return y[j-10];if(j<100){const E=Math.floor(j/10),C=j%10;return v[E]+(C>0?" "+g[C]:"")}const N=Math.floor(j/100),B=j%100;return g[N]+" Hundred"+(B>0?" "+_(B):"")};if(m<1e3)return _(m);if(m<1e6){const j=Math.floor(m/1e3),N=m%1e3;return _(j)+" Thousand"+(N>0?" "+_(N):"")}if(m<1e9){const j=Math.floor(m/1e6),N=m%1e6,B=N>=1e3?_(Math.floor(N/1e3))+" Thousand"+(N%1e3>0?" "+_(N%1e3):""):N>0?_(N):"";return _(j)+" Million"+(B?" "+B:"")}return m.toString()},A=()=>{window.print()},x=async()=>{if(a.current)try{const m=await Zo(a.current,{scale:2,useCORS:!0,allowTaint:!0,logging:!1,backgroundColor:"#ffffff",windowWidth:a.current.scrollWidth,windowHeight:a.current.scrollHeight,onclone:C=>{const k=C.getElementById("proforma-print-content");k&&(k.style.width="210mm")}}),g=m.toDataURL("image/png",1),y=new Ut("p","mm","a4"),v=y.internal.pageSize.getWidth(),_=y.internal.pageSize.getHeight(),j=m.width,N=m.height,B=v/j,E=N*B;if(E>_){let C=0,k=E;for(;k>0;)y.addImage(g,"PNG",0,C,v,E),k-=_,C-=_,k>0&&y.addPage()}else y.addImage(g,"PNG",0,0,v,E);y.save(`Proforma-Invoice-${e.so_number}.pdf`)}catch(m){console.error("Error generating PDF:",m),alert("Failed to generate PDF. Please try again.")}},p=e.customers,b=t.some(m=>(m.discount_amount||0)>0);return n.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto bg-gray-900 bg-opacity-75 print:static print:bg-white print:overflow-visible",children:[n.jsx("div",{className:"flex min-h-screen items-start justify-center p-4 pt-10 print:p-0 print:min-h-0 print:block",children:n.jsxs("div",{className:"relative w-full max-w-5xl bg-white shadow-xl print:shadow-none print:max-w-full",children:[n.jsxs("div",{className:"sticky top-0 z-10 flex items-center justify-between border-b bg-white px-6 py-4",style:{printColorAdjust:"exact",WebkitPrintColorAdjust:"exact"},children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:[i==="id"?"Faktur Proforma":"Proforma Invoice"," ",e.so_number]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("button",{onClick:A,className:"flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-2 text-white hover:bg-blue-700",children:[n.jsx($l,{className:"h-4 w-4"}),i==="id"?"Cetak":"Print"]}),n.jsxs("button",{onClick:x,className:"flex items-center gap-2 rounded-lg bg-green-600 px-4 py-2 text-white hover:bg-green-700",children:[n.jsx(Zn,{className:"h-4 w-4"}),"PDF"]}),n.jsx("button",{onClick:r,className:"rounded-lg bg-gray-100 p-2 text-gray-600 hover:bg-gray-200",children:n.jsx(wr,{className:"h-5 w-5"})})]})]}),n.jsxs("div",{id:"proforma-print-content",ref:a,className:"p-8",children:[n.jsxs("div",{className:"mb-3 border-2 border-black p-3 print:mb-2 print:p-2",children:[n.jsxs("div",{className:"mb-2 flex items-start justify-between",children:[n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"h-16 w-16 flex items-center justify-center print:h-12 print:w-12",style:{backgroundColor:"#fff"},children:n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",xmlSpace:"preserve",width:"100%",height:"100%",viewBox:"0 0 15686.55 15480.24",style:{shapeRendering:"geometricPrecision",fillRule:"evenodd",clipRule:"evenodd"},children:n.jsxs("g",{children:[n.jsx("path",{fill:"#FDB763",d:"M69.94 10438.12l10353.39 0 0 -1798.67 1665.92 0 0 1868.6 0 320.44 0 4552.28c0,38.48 -31.45,69.94 -69.94,69.94l-11949.38 0c-38.48,0 -69.94,-31.45 -69.94,-69.94l0 -4872.72c0,-38.48 31.45,-69.94 69.94,-69.94zm1605.9 1710.15l8737.57 0c13.58,0 24.68,11.11 24.68,24.68l0 1719.84c0,13.58 -11.11,24.68 -24.68,24.68l-8737.57 0c-13.58,0 -24.68,-11.11 -24.68,-24.68l0 -1719.84c0,-13.58 11.11,-24.68 24.68,-24.68z"}),n.jsx("path",{fill:"#FDB763",d:"M15587.15 5136.67l-10353.49 0 0 1822.07 -1665.92 0 0 -1892.9 0 -324.61 0 -4611.43c0,-39 31.45,-70.87 69.94,-70.87l11949.47 0c38.48,0 69.94,31.87 69.94,70.87l0 4936.04c0,39 -31.45,70.83 -69.94,70.83zm-1605.9 -1732.36l-8737.67 0c-13.58,0 -24.68,-11.27 -24.68,-25l0 -1742.21c0,-13.74 11.11,-25 24.68,-25l8737.67 0c13.58,0 24.68,11.27 24.68,25l0 1742.21c0,13.74 -11.11,25 -24.68,25z"}),n.jsx("polygon",{fill:"#FD6D26",points:"-0,0 1651.16,0 1651.16,6929.27 15657.09,6929.27 15657.09,6958.74 15686.55,6958.74 15686.55,15480.24 14022.85,15480.24 14022.85,8639.45 1651.16,8639.45 -0,8639.45 -0,6929.27"})]})})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-base font-bold print:text-sm",children:"PT. SHUBHAM ANZEN PHARMA JAYA"}),n.jsx("p",{className:"text-xs print:text-[10px]",children:"Komplek Ruko Metro Sunter Blok A1 NO.15, Jl. Metro Indah Raya,"}),n.jsx("p",{className:"text-xs print:text-[10px]",children:"Kelurahan Papanggo, Kec. Tanjung Priok, Jakarta Utara - 14340"}),n.jsx("p",{className:"text-xs print:text-[10px]",children:"Telp: (+62 21) 65832426"})]})]}),n.jsx("div",{className:"text-right",children:n.jsx("h2",{className:"text-3xl font-bold print:text-2xl",children:i==="id"?"FAKTUR PROFORMA":"PROFORMA INVOICE"})})]}),n.jsxs("div",{className:"text-xs space-y-0.5 print:text-[10px] print:space-y-0",children:[n.jsxs("div",{children:[n.jsx("span",{className:"font-semibold",children:"No izin PBF"}),n.jsx("span",{className:"ml-16",children:": 27092400534390007"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"font-semibold",children:"No Sertifikasi CDOB"}),n.jsx("span",{className:"ml-4",children:": 270924005343900070001"})]})]})]}),n.jsx("div",{className:"mb-3 border-2 border-black p-3 print:mb-2 print:p-2",children:n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("div",{className:"space-y-1 text-xs print:text-[10px] print:space-y-0 flex-1",children:[n.jsxs("div",{children:[n.jsx("span",{className:"font-bold",children:"Company Name:"}),n.jsxs("span",{className:"font-semibold",children:[" ",(p==null?void 0:p.company_name)||""]})]}),n.jsxs("div",{className:"pt-1 flex",children:[n.jsx("span",{className:"font-bold",style:{minWidth:"72px"},children:"Address:"}),n.jsxs("div",{children:[n.jsx("p",{children:(p==null?void 0:p.address)||""}),n.jsx("p",{children:(p==null?void 0:p.city)||""})]})]}),n.jsxs("div",{className:"flex pt-1",children:[n.jsx("span",{className:"font-bold",style:{minWidth:"72px"},children:"Phone:"}),n.jsx("span",{children:(p==null?void 0:p.phone)||""})]}),n.jsxs("div",{className:"flex",children:[n.jsx("span",{className:"font-bold",style:{minWidth:"72px"},children:"NPWP:"}),n.jsx("span",{children:(p==null?void 0:p.npwp)||""})]})]}),n.jsxs("div",{className:"space-y-1 text-xs print:text-[10px] print:space-y-0 text-right",style:{minWidth:"220px"},children:[n.jsxs("div",{children:[n.jsx("span",{className:"font-bold",children:"SO Number:"}),n.jsx("span",{className:"ml-2",children:e.so_number})]}),n.jsxs("div",{children:[n.jsx("span",{className:"font-bold",children:"SO Date:"}),n.jsx("span",{className:"ml-2",children:d(e.so_date)})]}),n.jsxs("div",{className:"pt-1",children:[n.jsx("span",{className:"font-bold",children:"Customer PO No:"}),n.jsx("span",{className:"ml-2",children:e.customer_po_number})]}),n.jsxs("div",{children:[n.jsx("span",{className:"font-bold",children:"Customer PO Date:"}),n.jsx("span",{className:"ml-2",children:d(e.customer_po_date)})]}),e.expected_delivery_date&&n.jsxs("div",{children:[n.jsx("span",{className:"font-bold",children:"Expected Delivery:"}),n.jsx("span",{className:"ml-2",children:d(e.expected_delivery_date)})]})]})]})}),n.jsx("div",{children:n.jsxs("table",{className:"w-full border-2 border-black text-xs print:text-[10px]",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"border-b-2 border-black bg-white",children:[n.jsx("th",{className:"border-r border-black p-1.5 text-center font-bold print:p-1",children:"No."}),n.jsx("th",{className:"border-r border-black p-1.5 text-left font-bold print:p-1",children:"Product Name"}),n.jsx("th",{className:"border-r border-black p-1.5 text-center font-bold print:p-1",children:"Total Qty"}),n.jsx("th",{className:"border-r border-black p-1.5 text-center font-bold print:p-1",children:"UOM"}),n.jsx("th",{className:"border-r border-black p-1.5 text-right font-bold print:p-1 ",children:i==="id"?`Unit Price (${o})`:`Unit Price (${o})`}),b&&n.jsx("th",{className:"border-r border-black p-1.5 text-right font-bold print:p-1",children:"Discount"}),n.jsx("th",{className:"p-1.5 text-right font-bold print:p-1",children:i==="id"?`Sub Total (${o})`:`Sub Total (${o})`})]})}),n.jsxs("tbody",{children:[t.map((m,g)=>{var N,B;const y=m.quantity||0,v=m.unit_price||0,_=m.discount_amount||0,j=y*v-_;return n.jsxs("tr",{className:"border-b border-black",children:[n.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:g+1}),n.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:((N=m.products)==null?void 0:N.product_name)||"Unknown Product"}),n.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:y.toLocaleString()}),n.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:((B=m.products)==null?void 0:B.unit)||"Kg"}),n.jsx("td",{className:"border-r border-black p-1.5 text-right print:p-1 ",children:c(v)}),b&&n.jsx("td",{className:"border-r border-black p-1.5 text-right print:p-1",children:c(_)}),n.jsx("td",{className:"p-1.5 text-right print:p-1",children:c(j)})]},m.id||g)}),t.length<2&&Array.from({length:2-t.length}).map((m,g)=>n.jsxs("tr",{className:"border-b border-black",children:[n.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:""}),n.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),n.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),n.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),n.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),b&&n.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),n.jsx("td",{className:"p-1.5 print:p-1",children:""})]},`empty-${g}`))]})]})}),n.jsxs("div",{className:"border-2 border-black border-t-0",children:[n.jsxs("div",{className:"flex items-stretch border-b-2 border-black",children:[n.jsxs("div",{className:"flex-1 p-2 border-r-2 border-black print:p-1.5",children:[n.jsx("p",{className:"text-xs font-bold print:text-[10px]",children:i==="id"?"Amount In words:":"Amount in words:"}),n.jsxs("p",{className:"text-xs mt-0.5 font-bold uppercase print:text-[10px] print:mt-0",children:[o," ",u(Math.round(e.total_amount))," ",o==="IDR"?"RUPIAH":o==="USD"?"DOLLARS":""]})]}),n.jsxs("div",{className:"w-80 text-xs p-2 print:text-[10px] print:p-1.5",children:[n.jsxs("div",{className:"flex justify-between py-1 print:py-0.5",children:[n.jsx("span",{className:"font-bold",children:"Sub Total"}),n.jsx("span",{className:"font-bold",children:c(e.subtotal_amount)})]}),n.jsxs("div",{className:"flex justify-between border-t border-black py-1 print:py-0.5",children:[n.jsx("span",{className:"font-bold",children:"VAT (PPN) 11%"}),n.jsx("span",{className:"font-bold",children:c(e.tax_amount)})]}),n.jsxs("div",{className:"flex justify-between border-t-2 border-black py-1 print:py-0.5",children:[n.jsx("span",{className:"font-bold",children:"Grand Total"}),n.jsx("span",{className:"font-bold text-sm print:text-xs",children:c(e.total_amount)})]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-0 text-xs print:text-[10px]",children:[n.jsxs("div",{className:"p-3 border-r-2 border-black print:p-2",children:[n.jsx("p",{className:"font-semibold mb-2 print:mb-1",children:"Bank Details:"}),n.jsxs("div",{className:"space-y-0.5 print:space-y-0",children:[n.jsxs("div",{className:"flex",children:[n.jsx("span",{className:"font-semibold",style:{minWidth:"95px"},children:"Bank Name"}),n.jsx("span",{className:"mr-2",children:":"}),n.jsx("span",{children:"BCA"})]}),n.jsxs("div",{className:"flex",children:[n.jsx("span",{className:"font-semibold",style:{minWidth:"95px"},children:"Branch"}),n.jsx("span",{className:"mr-2",children:":"}),n.jsx("span",{children:"Sunter Mall, Jakarta"})]}),n.jsxs("div",{className:"flex",children:[n.jsx("span",{className:"font-semibold",style:{minWidth:"95px"},children:"Account Name"}),n.jsx("span",{className:"mr-2",children:":"}),n.jsx("span",{className:"whitespace-nowrap",children:"PT. Shubham Anzen Pharma Jaya"})]}),n.jsxs("div",{className:"flex",children:[n.jsx("span",{className:"font-semibold",style:{minWidth:"95px"},children:"Account No."}),n.jsx("span",{className:"mr-2",children:":"}),n.jsx("span",{children:"0930 2010 14 (IDR)"})]})]})]}),n.jsxs("div",{className:"p-3 print:p-2",children:[n.jsx("p",{className:"font-semibold mb-1",children:"Authorized Signatory:"}),n.jsx("p",{className:"font-semibold mb-10 print:mb-8",children:"PT. SHUBHAM ANZEN PHARMA JAYA"}),n.jsx("div",{className:"w-4/5 border-t border-black pt-1",children:"Pharmacist"})]})]})]}),e.notes&&n.jsx("div",{className:"border-2 border-black border-t-0 p-2 print:p-1.5",children:n.jsxs("p",{className:"text-xs print:text-[10px]",children:[n.jsx("span",{className:"font-bold",children:"Notes: "}),n.jsx("span",{children:e.notes})]})}),n.jsx("div",{className:"border-2 border-black border-t-0 p-2.5 print:p-2",children:n.jsx("p",{className:"text-xs font-semibold text-center print:text-[10px]",children:i==="id"?"Ini adalah Faktur Proforma dan bukan tagihan resmi. Faktur resmi akan diterbitkan setelah pengiriman barang.":"This is a Proforma Invoice and not an official bill. Official invoice will be issued after delivery of goods."})})]})]})}),n.jsx("style",{children:`
        @media print {
          @page {
            size: A4 portrait;
            margin: 8mm;
          }

          .sticky {
            display: none !important;
          }

          body {
            margin: 0;
            padding: 0;
          }

          body * {
            visibility: hidden;
          }

          #proforma-print-content,
          #proforma-print-content * {
            visibility: visible;
          }

          #proforma-print-content {
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            page-break-inside: avoid;
            page-break-after: auto;
          }

          #proforma-print-content > div {
            page-break-inside: avoid;
          }

          table {
            page-break-inside: auto;
          }

          tr {
            page-break-inside: avoid;
            page-break-after: auto;
          }

          thead {
            display: table-header-group;
          }

          tfoot {
            display: table-footer-group;
          }
        }
      `})]})}function TAe(){const{user:e,profile:t}=Cr(),{t:r}=cn(),[a,s]=Q.useState("active"),[i,o]=Q.useState([]),[l,c]=Q.useState([]),[d,u]=Q.useState([]),[f,h]=Q.useState(!0),[A,x]=Q.useState(""),[p,b]=Q.useState("all"),[m,g]=Q.useState(!1),[y,v]=Q.useState(null),[_,j]=Q.useState(!1),[N,B]=Q.useState(""),[E,C]=Q.useState(null),[k,w]=Q.useState(!1),[T,R]=Q.useState(null),[q,z]=Q.useState(!1),[ee,Y]=Q.useState(""),[G,re]=Q.useState(null),[U,S]=Q.useState(!1),[D,L]=Q.useState(null);Q.useEffect(()=>{P(),I()},[a]),Q.useEffect(()=>{V()},[A,p,i,a]);const P=async()=>{try{h(!0);let we=Z.from("sales_orders").select(`
          *,
          customers (
            id,
            company_name,
            address,
            city,
            phone,
            npwp,
            pharmacy_license,
            gst_vat_type
          ),
          sales_order_items (
            id,
            product_id,
            quantity,
            unit_price,
            discount_percent,
            discount_amount,
            tax_percent,
            tax_amount,
            line_total,
            item_delivery_date,
            notes,
            delivered_quantity,
            products (
              id,
              product_name,
              product_code,
              unit
            )
          )
        `);a==="active"?we=we.eq("is_archived",!1):we=we.eq("is_archived",!0);const{data:ge,error:Re}=await we.order("created_at",{ascending:!1});if(Re)throw Re;o(ge||[])}catch(we){console.error("Error fetching sales orders:",we.message),alert("Failed to load sales orders")}finally{h(!1)}},I=async()=>{try{const{data:we,error:ge}=await Z.from("customers").select("id, company_name").eq("is_active",!0).order("company_name");if(ge)throw ge;u(we||[])}catch(we){console.error("Error fetching customers:",we.message)}},H=(we,ge)=>ge==="USD"?`$ ${we.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`:`Rp ${we.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})}`,V=()=>{let we=i;A&&(we=we.filter(ge=>{var Re;return ge.so_number.toLowerCase().includes(A.toLowerCase())||ge.customer_po_number.toLowerCase().includes(A.toLowerCase())||((Re=ge.customers)==null?void 0:Re.company_name.toLowerCase().includes(A.toLowerCase()))})),p!=="all"&&(we=we.filter(ge=>ge.status===p)),c(we)},W=we=>{const Re={draft:{color:"bg-gray-100 text-gray-800",label:"Draft"},pending_approval:{color:"bg-yellow-100 text-yellow-800",label:"Pending Approval"},approved:{color:"bg-green-100 text-green-800",label:"Approved"},rejected:{color:"bg-red-100 text-red-800",label:"Rejected"},stock_reserved:{color:"bg-blue-100 text-blue-800",label:"Stock Reserved"},shortage:{color:"bg-orange-100 text-orange-800",label:"Shortage"},pending_delivery:{color:"bg-purple-100 text-purple-800",label:"Pending Delivery"},partially_delivered:{color:"bg-indigo-100 text-indigo-800",label:"Partially Delivered"},delivered:{color:"bg-teal-100 text-teal-800",label:"Delivered"},closed:{color:"bg-gray-100 text-gray-800",label:"Closed"},cancelled:{color:"bg-red-100 text-red-800",label:"Cancelled"}}[we]||{color:"bg-gray-100 text-gray-800",label:we};return n.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${Re.color}`,children:Re.label})},M=async we=>{if(confirm("Submit this sales order for approval?"))try{const{error:ge}=await Z.from("sales_orders").update({status:"pending_approval",updated_at:new Date().toISOString()}).eq("id",we);if(ge)throw ge;alert("Sales order submitted for approval successfully!"),P()}catch(ge){console.error("Error submitting for approval:",ge.message),alert("Failed to submit for approval")}},se=async()=>{if(!G||!ee.trim()){alert("Please enter an archive reason");return}try{const{data:{user:we}}=await Z.auth.getUser();if(!we)throw new Error("Not authenticated");const{error:ge}=await Z.from("sales_orders").update({is_archived:!0,archived_at:new Date().toISOString(),archived_by:we.id,archive_reason:ee,updated_at:new Date().toISOString()}).eq("id",G);if(ge)throw ge;alert("Sales order archived successfully!"),z(!1),Y(""),re(null),P()}catch(we){console.error("Error archiving order:",we.message),alert("Failed to archive order")}},K=async we=>{if(confirm("Unarchive this sales order?"))try{const{error:ge}=await Z.from("sales_orders").update({is_archived:!1,archived_at:null,archived_by:null,archive_reason:null,updated_at:new Date().toISOString()}).eq("id",we);if(ge)throw ge;alert("Sales order unarchived successfully!"),P()}catch(ge){console.error("Error unarchiving order:",ge.message),alert("Failed to unarchive order")}},he=async we=>{const ge=prompt("Enter cancellation reason:");if(ge)try{const{data:{user:Re}}=await Z.auth.getUser();if(!Re)throw new Error("Not authenticated");const{error:et}=await Z.rpc("fn_cancel_sales_order",{p_so_id:we,p_canceller_id:Re.id,p_reason:ge});if(et)throw et;alert("Sales order cancelled successfully!"),P()}catch(Re){console.error("Error cancelling order:",Re.message),alert("Failed to cancel order")}},ne=async we=>{if(confirm("Are you sure you want to delete this sales order?"))try{const{error:ge}=await Z.from("sales_orders").delete().eq("id",we);if(ge)throw ge;alert("Sales order deleted successfully!"),P()}catch(ge){console.error("Error deleting order:",ge.message),alert("Failed to delete order")}},te=we=>{L(we),S(!0)},ce=we=>{v(we),g(!0)},_e=async we=>{if(confirm("Approve this sales order? Stock will be reserved automatically."))try{const{data:{user:ge}}=await Z.auth.getUser();if(!ge)throw new Error("Not authenticated");const{error:Re}=await Z.from("sales_orders").update({status:"approved",approved_by:ge.id,approved_at:new Date().toISOString(),updated_at:new Date().toISOString()}).eq("id",we);if(Re)throw Re;const{data:et,error:Ye}=await Z.rpc("fn_reserve_stock_for_so_v2",{p_so_id:we});if(Ye)console.error("Error reserving stock:",Ye),console.error("Supabase request failed",Ye),alert("Order approved but stock reservation failed: "+Ye.message);else if(et&&et.length>0){const Be=et[0];Be.success?alert(" Sales order approved and stock fully reserved!"):alert(` Order approved with stock shortage.

`+Be.message+`

Import requirements have been created automatically.`)}else alert("Sales order approved!");P()}catch(ge){console.error("Error approving order:",ge.message),alert("Failed to approve order")}},de=async()=>{if(!E||!N.trim()){alert("Please enter a rejection reason");return}try{const{data:{user:we}}=await Z.auth.getUser();if(!we)throw new Error("Not authenticated");const{error:ge}=await Z.from("sales_orders").update({status:"rejected",rejected_by:we.id,rejected_at:new Date().toISOString(),rejection_reason:N,updated_at:new Date().toISOString()}).eq("id",E);if(ge)throw ge;alert("Sales order rejected"),j(!1),B(""),C(null),P()}catch(we){console.error("Error rejecting order:",we.message),alert("Failed to reject order")}},ye=we=>{R(we),w(!0)},Le={total:i.length,pending_approval:i.filter(we=>we.status==="pending_approval").length,stock_reserved:i.filter(we=>we.status==="stock_reserved").length,shortage:i.filter(we=>we.status==="shortage").length,delivered:i.filter(we=>we.status==="delivered").length};return n.jsx(Un,{children:n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"flex justify-between items-center mb-6",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Sales Orders"}),n.jsx("p",{className:"text-gray-600 mt-1",children:"Manage customer purchase orders and track delivery"})]}),n.jsxs("button",{onClick:()=>g(!0),className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:[n.jsx(Pr,{className:"w-5 h-5"}),"New Sales Order"]})]}),n.jsx("div",{className:"mb-6 border-b border-gray-200",children:n.jsxs("nav",{className:"flex gap-4",children:[n.jsx("button",{onClick:()=>s("active"),className:`px-4 py-2 font-medium border-b-2 transition ${a==="active"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Active Orders"}),n.jsx("button",{onClick:()=>s("archived"),className:`px-4 py-2 font-medium border-b-2 transition ${a==="archived"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Archived Orders"})]})}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3 md:gap-4 mb-6",children:[n.jsxs("div",{className:"bg-white p-3 md:p-4 rounded-lg shadow",children:[n.jsx("div",{className:"text-xs md:text-sm text-gray-600 truncate",children:"Total Orders"}),n.jsx("div",{className:"text-xl md:text-2xl font-bold text-gray-900",children:Le.total})]}),n.jsxs("div",{className:"bg-white p-3 md:p-4 rounded-lg shadow",children:[n.jsx("div",{className:"text-xs md:text-sm text-gray-600 truncate",children:"Pending Approval"}),n.jsx("div",{className:"text-xl md:text-2xl font-bold text-yellow-600",children:Le.pending_approval})]}),n.jsxs("div",{className:"bg-white p-3 md:p-4 rounded-lg shadow",children:[n.jsx("div",{className:"text-xs md:text-sm text-gray-600 truncate",children:"Stock Reserved"}),n.jsx("div",{className:"text-xl md:text-2xl font-bold text-blue-600",children:Le.stock_reserved})]}),n.jsxs("div",{className:"bg-white p-3 md:p-4 rounded-lg shadow",children:[n.jsx("div",{className:"text-xs md:text-sm text-gray-600 truncate",children:"Shortage"}),n.jsx("div",{className:"text-xl md:text-2xl font-bold text-orange-600",children:Le.shortage})]}),n.jsxs("div",{className:"bg-white p-3 md:p-4 rounded-lg shadow",children:[n.jsx("div",{className:"text-xs md:text-sm text-gray-600 truncate",children:"Delivered"}),n.jsx("div",{className:"text-xl md:text-2xl font-bold text-green-600",children:Le.delivered})]})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow mb-6",children:[n.jsxs("div",{className:"p-4 border-b flex gap-4",children:[n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(Ca,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),n.jsx("input",{type:"text",placeholder:"Search by SO number, PO number, or customer...",value:A,onChange:we=>x(we.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg"})]}),n.jsxs("select",{value:p,onChange:we=>b(we.target.value),className:"border rounded-lg px-4 py-2",children:[n.jsx("option",{value:"all",children:"All Status"}),n.jsx("option",{value:"draft",children:"Draft"}),n.jsx("option",{value:"pending_approval",children:"Pending Approval"}),n.jsx("option",{value:"approved",children:"Approved"}),n.jsx("option",{value:"stock_reserved",children:"Stock Reserved"}),n.jsx("option",{value:"shortage",children:"Shortage"}),n.jsx("option",{value:"pending_delivery",children:"Pending Delivery"}),n.jsx("option",{value:"partially_delivered",children:"Partially Delivered"}),n.jsx("option",{value:"delivered",children:"Delivered"}),n.jsx("option",{value:"rejected",children:"Rejected"}),n.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"SO Number"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Customer"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"PO Number"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"SO Date"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Delivery Date"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Amount"}),n.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Docs"}),n.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Status / Approval"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:f?n.jsx("tr",{children:n.jsx("td",{colSpan:9,className:"px-6 py-4 text-center text-gray-500",children:"Loading..."})}):l.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:9,className:"px-6 py-4 text-center text-gray-500",children:"No sales orders found"})}):l.map(we=>{var ge;return n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("div",{className:"text-sm font-medium text-gray-900",children:we.so_number})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("div",{className:"text-sm text-gray-900",children:(ge=we.customers)==null?void 0:ge.company_name})}),n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[n.jsx("div",{className:"text-sm text-gray-900",children:we.customer_po_number}),n.jsx("div",{className:"text-xs text-gray-500",children:new Date(we.customer_po_date).toLocaleDateString()})]}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(we.so_date).toLocaleDateString()}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:we.expected_delivery_date?new Date(we.expected_delivery_date).toLocaleDateString():"-"}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:H(we.total_amount,we.currency||"IDR")}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("div",{className:"flex items-center justify-center",children:we.customer_po_file_url?n.jsxs("button",{onClick:()=>ye(we.customer_po_file_url),className:"inline-flex items-center gap-1 px-3 py-1.5 bg-blue-50 text-blue-700 rounded-lg border border-blue-200 hover:bg-blue-100 transition",title:"View Customer PO",children:[n.jsx(Zt,{className:"w-4 h-4"}),n.jsx("span",{className:"text-sm font-medium",children:"1"})]}):n.jsx("span",{className:"text-gray-400 text-sm",children:"-"})})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsxs("div",{className:"flex items-center justify-center gap-2",children:[W(we.status),we.status==="pending_approval"&&(t==null?void 0:t.role)==="admin"&&n.jsxs("div",{className:"flex items-center gap-1 ml-2",children:[n.jsx("button",{onClick:Re=>{Re.stopPropagation(),_e(we.id)},className:"p-2 bg-green-100 hover:bg-green-200 rounded-lg transition-colors",title:"Approve Order",children:n.jsx(Zr,{className:"w-6 h-6 text-green-600"})}),n.jsx("button",{onClick:Re=>{Re.stopPropagation(),C(we.id),j(!0)},className:"p-2 bg-red-100 hover:bg-red-200 rounded-lg transition-colors",title:"Reject Order",children:n.jsx(gn,{className:"w-6 h-6 text-red-600"})})]}),we.status==="approved"&&n.jsx(Zr,{className:"w-5 h-5 text-green-600 ml-2",title:"Approved"}),we.status==="rejected"&&n.jsx(gn,{className:"w-5 h-5 text-red-600 ml-2",title:"Rejected"})]})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>te(we),className:"text-blue-600 hover:text-blue-800",title:"View Proforma Invoice",children:n.jsx(bi,{className:"w-4 h-4"})}),!["delivered","closed","cancelled","partially_delivered","pending_delivery"].includes(we.status)&&n.jsx("button",{onClick:()=>ce(we),className:"text-indigo-600 hover:text-indigo-800",title:"Edit",children:n.jsx(Aa,{className:"w-4 h-4"})}),we.status==="draft"&&n.jsxs(n.Fragment,{children:[n.jsx("button",{onClick:()=>M(we.id),className:"text-green-600 hover:text-green-800",title:"Submit for Approval",children:n.jsx(v5,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>ne(we.id),className:"text-red-600 hover:text-red-800",title:"Delete",children:n.jsx(Lr,{className:"w-4 h-4"})})]}),!["cancelled","closed","delivered","rejected"].includes(we.status)&&a==="active"&&n.jsx("button",{onClick:()=>he(we.id),className:"text-orange-600 hover:text-orange-800",title:"Cancel",children:n.jsx(gn,{className:"w-4 h-4"})}),a==="active"&&["admin","sales"].includes((t==null?void 0:t.role)||"")&&["delivered","cancelled"].includes(we.status)&&n.jsx("button",{onClick:()=>{re(we.id),z(!0)},className:"text-gray-600 hover:text-gray-800",title:"Archive Order",children:n.jsx(Zt,{className:"w-4 h-4"})}),a==="archived"&&["admin","sales"].includes((t==null?void 0:t.role)||"")&&n.jsx("button",{onClick:()=>K(we.id),className:"text-green-600 hover:text-green-800",title:"Unarchive Order",children:n.jsx(v5,{className:"w-4 h-4"})})]})})]},we.id)})})]})})]}),m&&n.jsx(Ot,{isOpen:m,onClose:()=>{g(!1),v(null)},title:y?"Edit Sales Order":"Create Sales Order",maxWidth:"max-w-6xl",children:n.jsx(EAe,{existingOrder:y||void 0,onSuccess:()=>{g(!1),v(null),P()},onCancel:()=>{g(!1),v(null)}})}),_&&n.jsx(Ot,{isOpen:_,onClose:()=>{j(!1),B(""),C(null)},title:"Reject Sales Order",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Rejection Reason ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("textarea",{value:N,onChange:we=>B(we.target.value),rows:4,className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-red-500",placeholder:"Enter reason for rejecting this sales order..."})]}),n.jsxs("div",{className:"flex gap-2 justify-end",children:[n.jsx("button",{onClick:()=>{j(!1),B(""),C(null)},className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Cancel"}),n.jsx("button",{onClick:de,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",disabled:!N.trim(),children:"Reject Order"})]})]})}),q&&n.jsx(Ot,{isOpen:q,onClose:()=>{z(!1),Y(""),re(null)},title:"Archive Sales Order",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Archive Reason ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("textarea",{value:ee,onChange:we=>Y(we.target.value),rows:4,className:"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter reason for archiving this sales order (e.g., Completed and delivered, Cancelled by customer)..."})]}),n.jsxs("div",{className:"flex gap-2 justify-end",children:[n.jsx("button",{onClick:()=>{z(!1),Y(""),re(null)},className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Cancel"}),n.jsx("button",{onClick:se,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",disabled:!ee.trim(),children:"Archive Order"})]})]})}),k&&T&&n.jsx(Ot,{isOpen:k,onClose:()=>{w(!1),R(null)},title:"Customer Purchase Order",children:n.jsxs("div",{className:"space-y-3",children:[n.jsxs("a",{href:T,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 p-4 bg-gray-50 rounded-lg border border-gray-200 hover:bg-blue-50 hover:border-blue-300 transition",children:[n.jsx(Zt,{className:"w-6 h-6 text-blue-600 flex-shrink-0"}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Customer Purchase Order"}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Click to open in new tab"})]}),n.jsx(Gd,{className:"w-5 h-5 text-gray-400 flex-shrink-0"})]}),n.jsx("div",{className:"text-xs text-gray-500 text-center pt-2",children:"Document opens in a new browser tab"})]})}),U&&D&&n.jsx(FAe,{salesOrder:D,items:D.sales_order_items||[],onClose:()=>{S(!1),L(null)}})]})})}function IAe({requirements:e,onRefresh:t,canEdit:r}){const[a,s]=Q.useState(null),[i,o]=Q.useState(""),l=Q.useRef(null),c=[{value:"high",label:"High",color:"text-red-600",bgColor:"bg-red-50"},{value:"medium",label:"Medium",color:"text-orange-600",bgColor:"bg-orange-50"},{value:"low",label:"Low",color:"text-green-600",bgColor:"bg-green-50"}],d=[{value:"pending",label:"Pending",color:"text-gray-600",bgColor:"bg-gray-50"},{value:"ordered",label:"Ordered",color:"text-blue-600",bgColor:"bg-blue-50"},{value:"partially_received",label:"Partially Received",color:"text-yellow-600",bgColor:"bg-yellow-50"},{value:"received",label:"Received",color:"text-green-600",bgColor:"bg-green-50"},{value:"cancelled",label:"Cancelled",color:"text-red-600",bgColor:"bg-red-50"}];Q.useEffect(()=>{a&&l.current&&l.current.focus()},[a]);const u=(g,y,v)=>{if(console.log("startEditing called:",{id:g,field:y,currentValue:v,canEdit:r}),!r){console.log("Cannot edit - canEdit is false");return}s({id:g,field:y}),o(v||""),console.log("Editing cell set:",{id:g,field:y})},f=()=>{s(null),o("")},h=async(g,y)=>{try{const v={};y==="required_quantity"||y==="shortage_quantity"||y==="lead_time_days"?v[y]=Number(i):v[y]=i;const{error:_}=await Z.from("import_requirements").update(v).eq("id",g);if(_)throw _;t(),f()}catch(v){console.error("Error updating import requirement:",v),alert("Failed to update")}},A=(g,y,v)=>{g.key==="Enter"?h(y,v):g.key==="Escape"&&f()},x=g=>c.find(v=>v.value===g)||c[1],p=g=>d.find(v=>v.value===g)||d[0],b=g=>{const y=new Date,_=new Date(g).getTime()-y.getTime();return Math.ceil(_/(1e3*60*60*24))},m=g=>g<0?"text-red-700 font-bold":g<=7?"text-red-600 font-semibold":g<=30?"text-orange-600":"text-gray-600";return n.jsxs("div",{className:"overflow-x-auto border border-gray-200 rounded-lg",children:[n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Product"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Sales Order"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Customer"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Required Qty"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Shortage Qty"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Delivery Date"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Priority"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Status"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Lead Time"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Notes"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(g=>{var j,N,B,E;const y=b(g.required_delivery_date),v=x(g.priority),_=p(g.status);return n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsxs("td",{className:"px-4 py-3",children:[n.jsx("div",{className:"text-sm font-medium text-gray-900",children:(j=g.products)==null?void 0:j.product_name}),n.jsx("div",{className:"text-xs text-gray-500",children:(N=g.products)==null?void 0:N.product_code})]}),n.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:(B=g.sales_orders)==null?void 0:B.so_number}),n.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:(E=g.customers)==null?void 0:E.company_name}),n.jsx("td",{className:"px-4 py-3",children:(a==null?void 0:a.id)===g.id&&a.field==="required_quantity"?n.jsx("input",{ref:l,type:"number",value:i,onChange:C=>o(C.target.value),onBlur:()=>h(g.id,"required_quantity"),onKeyDown:C=>A(C,g.id,"required_quantity"),className:"w-full px-2 py-1 border border-blue-400 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"}):n.jsx("div",{onClick:()=>u(g.id,"required_quantity",g.required_quantity),className:`text-sm ${r?"cursor-pointer hover:bg-gray-100 px-2 py-1 rounded":""}`,children:g.required_quantity.toLocaleString()})}),n.jsx("td",{className:"px-4 py-3 text-sm text-red-600 font-semibold",children:g.shortage_quantity.toLocaleString()}),n.jsx("td",{className:"px-4 py-3",children:(a==null?void 0:a.id)===g.id&&a.field==="required_delivery_date"?n.jsx("input",{ref:l,type:"date",value:i,onChange:C=>o(C.target.value),onBlur:()=>h(g.id,"required_delivery_date"),onKeyDown:C=>A(C,g.id,"required_delivery_date"),className:"w-full px-2 py-1 border border-blue-400 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"}):n.jsxs("div",{onClick:()=>u(g.id,"required_delivery_date",g.required_delivery_date),className:`${r?"cursor-pointer hover:bg-gray-100 px-2 py-1 rounded":""}`,children:[n.jsx("div",{className:"text-sm",children:new Date(g.required_delivery_date).toLocaleDateString()}),n.jsx("div",{className:`text-xs ${m(y)}`,children:y<0?`${Math.abs(y)} days overdue`:`${y} days`})]})}),n.jsx("td",{className:"px-4 py-3",children:(a==null?void 0:a.id)===g.id&&a.field==="priority"?n.jsx("select",{ref:l,value:i,onChange:C=>o(C.target.value),onBlur:()=>h(g.id,"priority"),className:"w-full px-2 py-1 border border-blue-400 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",children:c.map(C=>n.jsx("option",{value:C.value,children:C.label},C.value))}):n.jsx("div",{onClick:()=>u(g.id,"priority",g.priority),className:`inline-flex px-3 py-1 text-xs font-semibold rounded-full ${v.color} ${v.bgColor} ${r?"cursor-pointer hover:opacity-80":""}`,children:v.label})}),n.jsx("td",{className:"px-4 py-3",children:(a==null?void 0:a.id)===g.id&&a.field==="status"?n.jsx("select",{ref:l,value:i,onChange:C=>o(C.target.value),onBlur:()=>h(g.id,"status"),className:"w-full px-2 py-1 border border-blue-400 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",children:d.map(C=>n.jsx("option",{value:C.value,children:C.label},C.value))}):n.jsx("div",{onClick:()=>u(g.id,"status",g.status),className:`inline-flex px-3 py-1 text-xs font-semibold rounded-full ${_.color} ${_.bgColor} ${r?"cursor-pointer hover:opacity-80":""}`,children:_.label})}),n.jsx("td",{className:"px-4 py-3",children:(a==null?void 0:a.id)===g.id&&a.field==="lead_time_days"?n.jsx("input",{ref:l,type:"number",value:i,onChange:C=>o(C.target.value),onBlur:()=>h(g.id,"lead_time_days"),onKeyDown:C=>A(C,g.id,"lead_time_days"),className:"w-full px-2 py-1 border border-blue-400 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"}):n.jsxs("div",{onClick:()=>u(g.id,"lead_time_days",g.lead_time_days),className:`text-sm ${r?"cursor-pointer hover:bg-gray-100 px-2 py-1 rounded":""}`,children:[g.lead_time_days," days"]})}),n.jsx("td",{className:"px-4 py-3",children:(a==null?void 0:a.id)===g.id&&a.field==="notes"?n.jsx("textarea",{ref:l,value:i,onChange:C=>o(C.target.value),onBlur:()=>h(g.id,"notes"),rows:2,className:"w-full px-2 py-1 border border-blue-400 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"}):n.jsx("div",{onClick:()=>u(g.id,"notes",g.notes),className:`text-sm text-gray-600 max-w-xs truncate ${r?"cursor-pointer hover:bg-gray-100 px-2 py-1 rounded":""}`,title:g.notes||"Click to add notes",children:g.notes||"-"})})]},g.id)})})]}),e.length===0&&n.jsx("div",{className:"text-center py-8 text-gray-500",children:"No import requirements found"})]})}function DAe(){const{profile:e}=Cr(),[t,r]=Q.useState([]),[a,s]=Q.useState({}),[i,o]=Q.useState(!0),[l,c]=Q.useState("pending"),[d,u]=Q.useState("all"),f=!0;Q.useEffect(()=>{h()},[l]);const h=async()=>{try{o(!0);let b=Z.from("import_requirements").select(`
          *,
          products (product_name, product_code),
          sales_orders (so_number),
          customers (company_name)
        `).order("priority",{ascending:!0}).order("required_delivery_date",{ascending:!0});l!=="all"&&(b=b.eq("status",l));const{data:m,error:g}=await b;if(g)throw g;r(m||[]);const y=[...new Set(m==null?void 0:m.map(v=>v.product_id))];y.length>0&&await A(y)}catch(b){console.error("Error fetching import requirements:",b.message),alert("Failed to load import requirements")}finally{o(!1)}},A=async b=>{try{const m={};for(const g of b){const{data:y}=await Z.from("batches").select("current_stock").eq("product_id",g),v=(y==null?void 0:y.reduce((N,B)=>N+Number(B.current_stock),0))||0,{data:_}=await Z.from("stock_reservations").select("reserved_quantity").eq("product_id",g).eq("status","active"),j=(_==null?void 0:_.reduce((N,B)=>N+Number(B.reserved_quantity),0))||0;m[g]={product_id:g,total_stock:v,reserved_stock:j,free_stock:v-j}}s(m)}catch(m){console.error("Error fetching stock info:",m.message)}},x=t.filter(b=>d==="all"?!0:b.priority===d),p={total:t.length,high_priority:t.filter(b=>b.priority==="high"&&b.status==="pending").length,pending:t.filter(b=>b.status==="pending").length,ordered:t.filter(b=>b.status==="ordered").length};return n.jsx(Un,{children:n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"mb-6",children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Import Requirements"}),n.jsx("p",{className:"text-gray-600 mt-1",children:"Track and manage product import needs based on stock shortages"})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 md:gap-4 mb-6",children:[n.jsx("div",{className:"bg-white p-3 md:p-4 rounded-lg shadow",children:n.jsxs("div",{className:"flex items-center gap-2 md:gap-3",children:[n.jsx(Rr,{className:"w-5 h-5 md:w-6 md:h-6 text-blue-600 flex-shrink-0"}),n.jsxs("div",{className:"min-w-0 flex-1",children:[n.jsx("div",{className:"text-xs md:text-sm text-gray-600 truncate",children:"Total Requirements"}),n.jsx("div",{className:"text-xl md:text-2xl font-bold text-gray-900",children:p.total})]})]})}),n.jsx("div",{className:"bg-white p-3 md:p-4 rounded-lg shadow",children:n.jsxs("div",{className:"flex items-center gap-2 md:gap-3",children:[n.jsx(Ga,{className:"w-5 h-5 md:w-6 md:h-6 text-red-600 flex-shrink-0"}),n.jsxs("div",{className:"min-w-0 flex-1",children:[n.jsx("div",{className:"text-xs md:text-sm text-gray-600 truncate",children:"High Priority"}),n.jsx("div",{className:"text-xl md:text-2xl font-bold text-red-600",children:p.high_priority})]})]})}),n.jsx("div",{className:"bg-white p-3 md:p-4 rounded-lg shadow",children:n.jsxs("div",{className:"flex items-center gap-2 md:gap-3",children:[n.jsx(ja,{className:"w-5 h-5 md:w-6 md:h-6 text-yellow-600 flex-shrink-0"}),n.jsxs("div",{className:"min-w-0 flex-1",children:[n.jsx("div",{className:"text-xs md:text-sm text-gray-600 truncate",children:"Pending"}),n.jsx("div",{className:"text-xl md:text-2xl font-bold text-yellow-600",children:p.pending})]})]})}),n.jsx("div",{className:"bg-white p-3 md:p-4 rounded-lg shadow",children:n.jsxs("div",{className:"flex items-center gap-2 md:gap-3",children:[n.jsx(zo,{className:"w-5 h-5 md:w-6 md:h-6 text-green-600 flex-shrink-0"}),n.jsxs("div",{className:"min-w-0 flex-1",children:[n.jsx("div",{className:"text-xs md:text-sm text-gray-600 truncate",children:"Ordered"}),n.jsx("div",{className:"text-xl md:text-2xl font-bold text-green-600",children:p.ordered})]})]})})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow mb-6",children:[n.jsxs("div",{className:"p-4 border-b flex gap-4",children:[n.jsxs("select",{value:l,onChange:b=>c(b.target.value),className:"border rounded-lg px-4 py-2",children:[n.jsx("option",{value:"all",children:"All Status"}),n.jsx("option",{value:"pending",children:"Pending"}),n.jsx("option",{value:"ordered",children:"Ordered"}),n.jsx("option",{value:"partially_received",children:"Partially Received"}),n.jsx("option",{value:"received",children:"Received"}),n.jsx("option",{value:"cancelled",children:"Cancelled"})]}),n.jsxs("select",{value:d,onChange:b=>u(b.target.value),className:"border rounded-lg px-4 py-2",children:[n.jsx("option",{value:"all",children:"All Priorities"}),n.jsx("option",{value:"high",children:"High Priority"}),n.jsx("option",{value:"medium",children:"Medium Priority"}),n.jsx("option",{value:"low",children:"Low Priority"})]}),n.jsxs("div",{className:"ml-auto text-sm text-gray-600 flex items-center gap-2",children:[n.jsx(Rr,{className:"w-4 h-4"}),"Click any cell to edit"]})]}),i?n.jsx("div",{className:"p-8 text-center text-gray-500",children:"Loading..."}):n.jsx(IAe,{requirements:x,onRefresh:h,canEdit:f})]}),n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx(Ga,{className:"w-5 h-5 text-blue-600 mt-0.5"}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-medium text-blue-900",children:"About Import Requirements"}),n.jsx("p",{className:"text-sm text-blue-700 mt-1",children:"Import requirements are automatically generated when sales orders are approved but stock is insufficient. The system tracks shortages and helps procurement plan imports based on customer delivery dates and priorities."})]})]})})]})})}function LAe(){const{user:e}=Cr(),[t,r]=Q.useState([]),[a,s]=Q.useState([]),[i,o]=Q.useState(!0),[l,c]=Q.useState(!1),[d,u]=Q.useState(null),[f,h]=Q.useState([]),[A,x]=Q.useState({container_ref:"",supplier_id:"",import_date:new Date().toISOString().split("T")[0],import_invoice_value:0,currency:"USD",exchange_rate:15e3,duty_bm:0,ppn_import:0,pph_import:0,freight_charges:0,clearing_forwarding:0,port_charges:0,container_handling:0,transportation:0,loading_import:0,bpom_ski_fees:0,other_import_costs:0,notes:""});Q.useEffect(()=>{p(),b();const C=Z.channel("container-changes").on("postgres_changes",{event:"*",schema:"public",table:"import_containers"},()=>{p()}).subscribe(),k=Z.channel("expense-container-changes").on("postgres_changes",{event:"*",schema:"public",table:"finance_expenses"},()=>{p()}).subscribe();return()=>{C.unsubscribe(),k.unsubscribe()}},[]);const p=async()=>{try{o(!0);const{data:C,error:k}=await Z.from("import_containers").select(`
          *,
          suppliers (
            id,
            company_name
          )
        `).order("created_at",{ascending:!1});if(k)throw k;const w=await Promise.all((C||[]).map(async T=>{const{data:R}=await Z.from("finance_expenses").select("amount").eq("import_container_id",T.id),q=(R==null?void 0:R.reduce((z,ee)=>z+Number(ee.amount),0))||0;return{...T,linked_expenses_total:q}}));r(w)}catch(C){console.error("Error fetching containers:",C.message),alert("Failed to load import containers")}finally{o(!1)}},b=async()=>{try{const{data:C,error:k}=await Z.from("suppliers").select("id, company_name").eq("is_active",!0).order("company_name");if(k)throw k;s(C||[])}catch(C){console.error("Error fetching suppliers:",C.message)}},m=async C=>{C.preventDefault();try{const k={...A,created_by:e==null?void 0:e.id};if(d){const{error:w}=await Z.from("import_containers").update(k).eq("id",d.id);if(w)throw w;alert("Container updated successfully")}else{const{error:w}=await Z.from("import_containers").insert([k]);if(w)throw w;alert("Container created successfully")}c(!1),u(null),y(),p()}catch(k){console.error("Error saving container:",k.message),alert("Failed to save container: "+k.message)}},g=async C=>{var k;if(confirm("Are you sure you want to allocate import costs to batches? This cannot be undone."))try{const{data:w,error:T}=await Z.rpc("allocate_import_costs_to_batches",{p_container_id:C});if(T)throw T;const R=w;R.success?(alert(`Success! Allocated costs to ${R.batches_allocated} batches.
Total cost: Rp ${(k=R.total_cost)==null?void 0:k.toLocaleString()}`),p()):alert("Error: "+R.error)}catch(w){console.error("Error allocating costs:",w.message),alert("Failed to allocate costs: "+w.message)}},y=()=>{x({container_ref:"",supplier_id:"",import_date:new Date().toISOString().split("T")[0],import_invoice_value:0,currency:"USD",exchange_rate:15e3,duty_bm:0,ppn_import:0,pph_import:0,freight_charges:0,clearing_forwarding:0,port_charges:0,container_handling:0,transportation:0,other_import_costs:0,notes:""}),h([])},v=async C=>{try{const{data:k,error:w}=await Z.from("finance_expenses").select("id, expense_category, amount, expense_date, description").eq("import_container_id",C).order("expense_date",{ascending:!1});if(w)throw w;h(k||[])}catch(k){console.error("Error loading linked expenses:",k),h([])}},_=C=>({duty_customs:"Duty & Customs (BM)",ppn_import:"PPN Import",pph_import:"PPh Import",freight_import:"Freight (Import)",clearing_forwarding:"Clearing & Forwarding",port_charges:"Port Charges",container_handling:"Container Handling",transport_import:"Transportation (Import)",loading_import:"Loading / Unloading (Import)",bpom_ski_fees:"BPOM / SKI Fees"})[C]||C,j=async C=>{u(C),x({container_ref:C.container_ref,supplier_id:C.supplier_id,import_date:C.import_date,import_invoice_value:C.import_invoice_value,currency:C.currency,exchange_rate:C.exchange_rate,duty_bm:C.duty_bm||0,ppn_import:C.ppn_import||0,pph_import:C.pph_import||0,freight_charges:C.freight_charges||0,clearing_forwarding:C.clearing_forwarding||0,port_charges:C.port_charges||0,container_handling:C.container_handling||0,transportation:C.transportation||0,loading_import:C.loading_import||0,bpom_ski_fees:C.bpom_ski_fees||0,other_import_costs:C.other_import_costs||0,notes:C.notes||""}),await v(C.id),c(!0)},N=C=>{const k={draft:{color:"bg-gray-100 text-gray-800",label:"Draft",icon:Aa},allocated:{color:"bg-green-100 text-green-800",label:"Allocated",icon:Zr},locked:{color:"bg-blue-100 text-blue-800",label:"Locked",icon:af}},w=k[C]||k.draft,T=w.icon;return n.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 text-xs font-medium rounded ${w.color}`,children:[n.jsx(T,{className:"w-3 h-3"}),w.label]})},B=(C,k="IDR")=>k==="USD"?`$ ${C==null?void 0:C.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`:`Rp ${C==null?void 0:C.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})}`,E=()=>(A.duty_bm||0)+(A.ppn_import||0)+(A.pph_import||0)+(A.freight_charges||0)+(A.clearing_forwarding||0)+(A.port_charges||0)+(A.container_handling||0)+(A.transportation||0)+(A.loading_import||0)+(A.bpom_ski_fees||0)+(A.other_import_costs||0);return n.jsx(Un,{children:n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:n.jsx(Rr,{className:"w-6 h-6 text-blue-600"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Import Containers"}),n.jsx("p",{className:"text-sm text-gray-600",children:"Track import shipments and allocate costs to batches"})]})]}),n.jsxs("button",{onClick:()=>{u(null),y(),c(!0)},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[n.jsx(Pr,{className:"w-5 h-5"}),"New Container"]})]}),n.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Container Ref"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Supplier"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Import Date"}),n.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Invoice Value"}),n.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Import Expenses"}),n.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Status"}),n.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:i?n.jsx("tr",{children:n.jsx("td",{colSpan:7,className:"px-6 py-8 text-center text-gray-500",children:"Loading..."})}):t.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:7,className:"px-6 py-8 text-center text-gray-500",children:"No import containers found. Create your first container to start tracking costs."})}):t.map(C=>{var k;return n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("div",{className:"text-sm font-medium text-gray-900",children:C.container_ref})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("div",{className:"text-sm text-gray-900",children:(k=C.suppliers)==null?void 0:k.company_name})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("div",{className:"text-sm text-gray-900",children:new Date(C.import_date).toLocaleDateString()})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:n.jsx("div",{className:"text-sm text-gray-900",children:B(C.import_invoice_value,C.currency)})}),n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:[n.jsx("div",{className:"text-sm text-gray-900 font-semibold",children:B(C.linked_expenses_total||0,"IDR")}),C.total_import_expenses>0&&C.total_import_expenses!==C.linked_expenses_total&&n.jsxs("div",{className:"text-xs text-gray-500",children:["Direct: ",B(C.total_import_expenses,"IDR")]})]}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:N(C.status)}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:n.jsxs("div",{className:"flex items-center justify-center gap-2",children:[C.status==="draft"&&n.jsxs(n.Fragment,{children:[n.jsx("button",{onClick:()=>j(C),className:"text-blue-600 hover:text-blue-800",title:"Edit",children:n.jsx(Aa,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>g(C.id),className:"text-green-600 hover:text-green-800",title:"Allocate Costs",children:n.jsx(Zr,{className:"w-4 h-4"})})]}),C.status!=="draft"&&n.jsx("span",{className:"text-gray-400 text-xs",children:"Locked"})]})})]},C.id)})})]})}),l&&n.jsx(Ot,{isOpen:l,onClose:()=>{c(!1),u(null),y()},title:d?"Edit Import Container":"New Import Container",maxWidth:"max-w-4xl",children:n.jsxs("form",{onSubmit:m,className:"space-y-6",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Container Ref ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"text",value:A.container_ref,onChange:C=>x({...A,container_ref:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Supplier ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsxs("select",{value:A.supplier_id,onChange:C=>x({...A,supplier_id:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0,children:[n.jsx("option",{value:"",children:"Select Supplier"}),a.map(C=>n.jsx("option",{value:C.id,children:C.company_name},C.id))]})]})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Import Date ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"date",value:A.import_date,onChange:C=>x({...A,import_date:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Currency"}),n.jsxs("select",{value:A.currency,onChange:C=>x({...A,currency:C.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[n.jsx("option",{value:"USD",children:"USD"}),n.jsx("option",{value:"IDR",children:"IDR"}),n.jsx("option",{value:"CNY",children:"CNY"}),n.jsx("option",{value:"INR",children:"INR"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Exchange Rate"}),n.jsx("input",{type:"number",step:"0.01",value:A.exchange_rate,onChange:C=>x({...A,exchange_rate:parseFloat(C.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Invoice Value ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx("input",{type:"number",step:"0.01",value:A.import_invoice_value,onChange:C=>x({...A,import_invoice_value:parseFloat(C.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0})]}),n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[n.jsx("h3",{className:"text-sm font-semibold text-blue-900 mb-3",children:"Import Cost Breakdown (IDR)"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"BM (Duty)"}),n.jsx("input",{type:"number",step:"0.01",value:A.duty_bm,onChange:C=>x({...A,duty_bm:parseFloat(C.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"PPN Import"}),n.jsx("input",{type:"number",step:"0.01",value:A.ppn_import,onChange:C=>x({...A,ppn_import:parseFloat(C.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"PPh Import"}),n.jsx("input",{type:"number",step:"0.01",value:A.pph_import,onChange:C=>x({...A,pph_import:parseFloat(C.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Freight Charges"}),n.jsx("input",{type:"number",step:"0.01",value:A.freight_charges,onChange:C=>x({...A,freight_charges:parseFloat(C.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Clearing & Forwarding"}),n.jsx("input",{type:"number",step:"0.01",value:A.clearing_forwarding,onChange:C=>x({...A,clearing_forwarding:parseFloat(C.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Port Charges"}),n.jsx("input",{type:"number",step:"0.01",value:A.port_charges,onChange:C=>x({...A,port_charges:parseFloat(C.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Container Handling"}),n.jsx("input",{type:"number",step:"0.01",value:A.container_handling,onChange:C=>x({...A,container_handling:parseFloat(C.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Transportation"}),n.jsx("input",{type:"number",step:"0.01",value:A.transportation,onChange:C=>x({...A,transportation:parseFloat(C.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Loading / Unloading"}),n.jsx("input",{type:"number",step:"0.01",value:A.loading_import,onChange:C=>x({...A,loading_import:parseFloat(C.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"BPOM / SKI Fees"}),n.jsx("input",{type:"number",step:"0.01",value:A.bpom_ski_fees,onChange:C=>x({...A,bpom_ski_fees:parseFloat(C.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Other Import Costs",n.jsx("span",{className:"text-xs text-blue-600 ml-2",children:" Auto-calculated from expenses"})]}),n.jsx("input",{type:"number",step:"0.01",value:A.other_import_costs,readOnly:!0,disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm bg-gray-100 cursor-not-allowed",title:"This is automatically calculated from all 'Other (Import)' expenses linked to this container"}),n.jsx("p",{className:"text-xs text-gray-600 mt-1",children:'Add expenses with category "Other (Import)" in Finance  Expenses to update this'})]})]}),n.jsx("div",{className:"mt-4 pt-4 border-t border-blue-200",children:n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{className:"text-sm font-semibold text-blue-900",children:"Total Import Expenses:"}),n.jsx("span",{className:"text-lg font-bold text-blue-900",children:B(E(),"IDR")})]})})]}),d&&f.length>0&&n.jsxs("div",{className:"bg-green-50 border-2 border-green-200 rounded-lg p-4",children:[n.jsx("h3",{className:"text-sm font-semibold text-green-900 mb-3",children:" Linked Expenses from Finance Tracker"}),n.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:f.map(C=>n.jsxs("div",{className:"bg-white rounded p-3 flex justify-between items-center",children:[n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:"font-medium text-sm text-gray-900",children:_(C.expense_category)}),n.jsxs("div",{className:"text-xs text-gray-600",children:[C.expense_date,"  ",C.description||"No description"]})]}),n.jsx("div",{className:"text-right",children:n.jsx("div",{className:"font-semibold text-green-700",children:B(C.amount,"IDR")})})]},C.id))}),n.jsxs("div",{className:"mt-3 pt-3 border-t border-green-300 flex justify-between items-center",children:[n.jsx("span",{className:"text-sm font-semibold text-green-900",children:"Total from Linked Expenses:"}),n.jsx("span",{className:"text-lg font-bold text-green-900",children:B(f.reduce((C,k)=>C+k.amount,0),"IDR")})]}),n.jsx("p",{className:"mt-2 text-xs text-green-700",children:" These expenses are automatically linked to this container. Add new expenses in the Finance > Expense Manager and select this container."})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),n.jsx("textarea",{value:A.notes,onChange:C=>x({...A,notes:C.target.value}),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),n.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3",children:n.jsxs("div",{className:"flex gap-2",children:[n.jsx(En,{className:"w-5 h-5 text-amber-600 flex-shrink-0"}),n.jsxs("div",{className:"text-sm text-amber-800",children:[n.jsx("p",{className:"font-medium mb-1",children:"Important:"}),n.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[n.jsx("li",{children:"Link batches to this container before allocating costs"}),n.jsx("li",{children:"Once allocated, container and batch costs are locked"}),n.jsx("li",{children:"Costs are allocated proportionally by invoice value"}),n.jsx("li",{children:"All import costs will be CAPITALIZED to inventory"})]})]})]})}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[n.jsx("button",{type:"button",onClick:()=>{c(!1),u(null),y()},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),n.jsxs("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[d?"Update":"Create"," Container"]})]})]})})]})})}function PAe({creditNote:e,items:t,onClose:r}){const a=Q.useRef(null),{language:s}=cn(),i=A=>A==null?"Rp 0,00":`Rp ${A.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})}`,o=A=>{const x=new Date(A),p=s==="id"?["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agt","Sep","Okt","Nov","Des"]:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],b=x.getDate(),m=p[x.getMonth()],g=x.getFullYear();return`${b} ${m} ${g}`},l=A=>s==="id"?c(A):d(A),c=A=>{if(A===0)return"Nol";const x=["","Satu","Dua","Tiga","Empat","Lima","Enam","Tujuh","Delapan","Sembilan"],p=["Sepuluh","Sebelas","Dua Belas","Tiga Belas","Empat Belas","Lima Belas","Enam Belas","Tujuh Belas","Delapan Belas","Sembilan Belas"],b=["","","Dua Puluh","Tiga Puluh","Empat Puluh","Lima Puluh","Enam Puluh","Tujuh Puluh","Delapan Puluh","Sembilan Puluh"],m=g=>{if(g===0)return"";if(g<10)return x[g];if(g>=10&&g<20)return p[g-10];if(g<100){const j=Math.floor(g/10),N=g%10;return b[j]+(N>0?" "+x[N]:"")}const y=Math.floor(g/100),v=g%100;return(y===1?"Seratus":x[y]+" Ratus")+(v>0?" "+m(v):"")};if(A<1e3)return m(A);if(A<1e6){const g=Math.floor(A/1e3),y=A%1e3;return(g===1?"Seribu":m(g)+" Ribu")+(y>0?" "+m(y):"")}if(A<1e9){const g=Math.floor(A/1e6),y=A%1e6,v=m(g)+" Juta",_=y>=1e3?(Math.floor(y/1e3)===1?"Seribu":m(Math.floor(y/1e3))+" Ribu")+(y%1e3>0?" "+m(y%1e3):""):y>0?m(y):"";return v+(_?" "+_:"")}return A.toString()},d=A=>{if(A===0)return"Zero";const x=["","One","Two","Three","Four","Five","Six","Seven","Eight","Nine"],p=["Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"],b=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"],m=g=>{if(g===0)return"";if(g<10)return x[g];if(g>=10&&g<20)return p[g-10];if(g<100){const _=Math.floor(g/10),j=g%10;return b[_]+(j>0?" "+x[j]:"")}const y=Math.floor(g/100),v=g%100;return x[y]+" Hundred"+(v>0?" "+m(v):"")};if(A<1e3)return m(A);if(A<1e6){const g=Math.floor(A/1e3),y=A%1e3;return m(g)+" Thousand"+(y>0?" "+m(y):"")}if(A<1e9){const g=Math.floor(A/1e6),y=A%1e6,v=y>=1e3?m(Math.floor(y/1e3))+" Thousand"+(y%1e3>0?" "+m(y%1e3):""):y>0?m(y):"";return m(g)+" Million"+(v?" "+v:"")}return A.toString()},u=()=>{window.print()},f=async()=>{if(a.current)try{const A=await Zo(a.current,{scale:2,useCORS:!0,allowTaint:!0,logging:!1,backgroundColor:"#ffffff",windowWidth:a.current.scrollWidth,windowHeight:a.current.scrollHeight,onclone:j=>{const N=j.getElementById("credit-note-print-content");N&&(N.style.width="210mm")}}),x=A.toDataURL("image/png",1),p=new Ut("p","mm","a4"),b=p.internal.pageSize.getWidth(),m=p.internal.pageSize.getHeight(),g=A.width,y=A.height,v=b/g,_=y*v;if(_>m){let j=0,N=_;for(;N>0;)p.addImage(x,"PNG",0,j,b,_),N-=m,j-=m,N>0&&p.addPage()}else p.addImage(x,"PNG",0,0,b,_);p.save(`CreditNote-${e.credit_note_number}.pdf`)}catch(A){console.error("Error generating PDF:",A),alert("Failed to generate PDF. Please try again.")}},h=e.customers;return n.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto bg-gray-900 bg-opacity-75 print:static print:bg-white print:overflow-visible",children:[n.jsx("div",{className:"flex min-h-screen items-start justify-center p-4 pt-10 print:p-0 print:min-h-0 print:block",children:n.jsxs("div",{className:"relative w-full max-w-5xl bg-white shadow-xl print:shadow-none print:max-w-full",children:[n.jsxs("div",{className:"sticky top-0 z-10 flex items-center justify-between border-b bg-white px-6 py-4",style:{printColorAdjust:"exact",WebkitPrintColorAdjust:"exact"},children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:[s==="id"?"Nota Kredit":"Credit Note"," ",e.credit_note_number]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("button",{onClick:u,className:"flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-2 text-white hover:bg-blue-700",children:[n.jsx($l,{className:"h-4 w-4"}),s==="id"?"Cetak":"Print"]}),n.jsxs("button",{onClick:f,className:"flex items-center gap-2 rounded-lg bg-green-600 px-4 py-2 text-white hover:bg-green-700",children:[n.jsx(Zn,{className:"h-4 w-4"}),"PDF"]}),n.jsx("button",{onClick:r,className:"rounded-lg bg-gray-100 p-2 text-gray-600 hover:bg-gray-200",children:n.jsx(wr,{className:"h-5 w-5"})})]})]}),n.jsxs("div",{id:"credit-note-print-content",ref:a,className:"p-8",children:[n.jsxs("div",{className:"mb-3 border-2 border-black p-3 print:mb-2 print:p-2",children:[n.jsxs("div",{className:"mb-2 flex items-start justify-between",children:[n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"h-16 w-16 flex items-center justify-center print:h-12 print:w-12",style:{backgroundColor:"#fff"},children:n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",xmlSpace:"preserve",width:"100%",height:"100%",viewBox:"0 0 15686.55 15480.24",style:{shapeRendering:"geometricPrecision",fillRule:"evenodd",clipRule:"evenodd"},children:n.jsxs("g",{children:[n.jsx("path",{fill:"#FDB763",d:"M69.94 10438.12l10353.39 0 0 -1798.67 1665.92 0 0 1868.6 0 320.44 0 4552.28c0,38.48 -31.45,69.94 -69.94,69.94l-11949.38 0c-38.48,0 -69.94,-31.45 -69.94,-69.94l0 -4872.72c0,-38.48 31.45,-69.94 69.94,-69.94zm1605.9 1710.15l8737.57 0c13.58,0 24.68,11.11 24.68,24.68l0 1719.84c0,13.58 -11.11,24.68 -24.68,24.68l-8737.57 0c-13.58,0 -24.68,-11.11 -24.68,-24.68l0 -1719.84c0,-13.58 11.11,-24.68 24.68,-24.68z"}),n.jsx("path",{fill:"#FDB763",d:"M15587.15 5136.67l-10353.49 0 0 1822.07 -1665.92 0 0 -1892.9 0 -324.61 0 -4611.43c0,-39 31.45,-70.87 69.94,-70.87l11949.47 0c38.48,0 69.94,31.87 69.94,70.87l0 4936.04c0,39 -31.45,70.83 -69.94,70.83zm-1605.9 -1732.36l-8737.67 0c-13.58,0 -24.68,-11.27 -24.68,-25l0 -1742.21c0,-13.74 11.11,-25 24.68,-25l8737.67 0c13.58,0 24.68,11.27 24.68,25l0 1742.21c0,13.74 -11.11,25 -24.68,25z"}),n.jsx("polygon",{fill:"#FD6D26",points:"-0,0 1651.16,0 1651.16,6929.27 15657.09,6929.27 15657.09,6958.74 15686.55,6958.74 15686.55,15480.24 14022.85,15480.24 14022.85,8639.45 1651.16,8639.45 -0,8639.45 -0,6929.27"})]})})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-base font-bold print:text-sm",children:"PT. SHUBHAM ANZEN PHARMA JAYA"}),n.jsx("p",{className:"text-xs print:text-[10px]",children:"Komplek Ruko Metro Sunter Blok A1 NO.15, Jl. Metro Indah Raya,"}),n.jsx("p",{className:"text-xs print:text-[10px]",children:"Kelurahan Papanggo, Kec. Tanjung Priok, Jakarta Utara - 14340"}),n.jsx("p",{className:"text-xs print:text-[10px]",children:"Telp: (+62 21) 65832426"})]})]}),n.jsx("div",{className:"text-right",children:n.jsx("h2",{className:"text-3xl font-bold text-red-600 print:text-2xl",children:"CREDIT NOTE"})})]}),n.jsxs("div",{className:"text-xs space-y-0.5 print:text-[10px] print:space-y-0",children:[n.jsxs("div",{children:[n.jsx("span",{className:"font-semibold",children:"No izin PBF"}),n.jsx("span",{className:"ml-16",children:": 27092400534390007"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"font-semibold",children:"No Sertifikasi CDOB"}),n.jsx("span",{className:"ml-4",children:": 270924005343900070001"})]})]})]}),n.jsx("div",{className:"mb-3 border-2 border-black p-3 print:mb-2 print:p-2",children:n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("div",{className:"space-y-1 text-xs print:text-[10px] print:space-y-0 flex-1",children:[n.jsxs("div",{children:[n.jsx("span",{className:"font-bold",children:"Company Name:"}),n.jsxs("span",{className:"font-semibold",children:[" ",(h==null?void 0:h.company_name)||""]})]}),n.jsxs("div",{className:"pt-1 flex",children:[n.jsx("span",{className:"font-bold",style:{minWidth:"72px"},children:"Address:"}),n.jsxs("div",{children:[n.jsx("p",{children:(h==null?void 0:h.address)||""}),n.jsx("p",{children:(h==null?void 0:h.city)||""})]})]}),n.jsxs("div",{className:"flex pt-1",children:[n.jsx("span",{className:"font-bold",style:{minWidth:"72px"},children:"Phone:"}),n.jsx("span",{children:(h==null?void 0:h.phone)||""})]}),n.jsxs("div",{className:"flex",children:[n.jsx("span",{className:"font-bold",style:{minWidth:"72px"},children:"NPWP:"}),n.jsx("span",{children:(h==null?void 0:h.npwp)||""})]})]}),n.jsxs("div",{className:"space-y-1 text-xs print:text-[10px] print:space-y-0 text-right",style:{minWidth:"200px"},children:[n.jsxs("div",{children:[n.jsx("span",{className:"font-bold",children:"Credit Note No:"}),n.jsx("span",{className:"ml-2",children:e.credit_note_number})]}),n.jsxs("div",{children:[n.jsx("span",{className:"font-bold",children:"Date:"}),n.jsx("span",{className:"ml-2",children:o(e.credit_note_date)})]}),e.original_invoice_number&&n.jsxs("div",{className:"pt-1",children:[n.jsx("span",{className:"font-bold",children:"Original Invoice:"}),n.jsx("span",{className:"ml-2",children:e.original_invoice_number})]})]})]})}),n.jsx("div",{children:n.jsxs("table",{className:"w-full border-2 border-black text-xs print:text-[10px]",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"border-b-2 border-black bg-white",children:[n.jsx("th",{className:"border-r border-black p-1.5 text-center font-bold print:p-1",children:"No."}),n.jsx("th",{className:"border-r border-black p-1.5 text-left font-bold print:p-1",children:"Product Name"}),n.jsx("th",{className:"border-r border-black p-1.5 text-center font-bold print:p-1",children:"Batch No."}),n.jsx("th",{className:"border-r border-black p-1.5 text-center font-bold print:p-1",children:"Quantity"}),n.jsx("th",{className:"border-r border-black p-1.5 text-right font-bold print:p-1",children:"Unit Price (IDR)"}),n.jsx("th",{className:"p-1.5 text-right font-bold print:p-1",children:"Sub Total (IDR)"})]})}),n.jsxs("tbody",{children:[t.map((A,x)=>{var g,y;const p=A.quantity||0,b=A.unit_price||0,m=p*b;return n.jsxs("tr",{className:"border-b border-black",children:[n.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:x+1}),n.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:((g=A.products)==null?void 0:g.product_name)||"Unknown Product"}),n.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:((y=A.batches)==null?void 0:y.batch_number)||"N/A"}),n.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:p.toLocaleString()}),n.jsx("td",{className:"border-r border-black p-1.5 text-right print:p-1",children:i(b)}),n.jsx("td",{className:"p-1.5 text-right print:p-1",children:i(m)})]},A.id||x)}),t.length<2&&Array.from({length:2-t.length}).map((A,x)=>n.jsxs("tr",{className:"border-b border-black",children:[n.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:""}),n.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),n.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),n.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),n.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),n.jsx("td",{className:"p-1.5 print:p-1",children:""})]},`empty-${x}`))]})]})}),n.jsxs("div",{className:"border-2 border-black border-t-0",children:[n.jsxs("div",{className:"flex items-stretch border-b-2 border-black",children:[n.jsxs("div",{className:"flex-1 p-2 border-r-2 border-black print:p-1.5",children:[n.jsx("p",{className:"text-xs font-bold print:text-[10px]",children:s==="id"?"Amount In words:":"Amount in words:"}),n.jsxs("p",{className:"text-xs mt-0.5 font-bold uppercase print:text-[10px] print:mt-0",children:["IDR ",l(Math.round(e.total_amount))," RUPIAH"]})]}),n.jsxs("div",{className:"w-80 text-xs p-2 print:text-[10px] print:p-1.5",children:[n.jsxs("div",{className:"flex justify-between py-1 print:py-0.5",children:[n.jsx("span",{className:"font-bold",children:"Sub Total"}),n.jsx("span",{className:"font-bold",children:i(e.subtotal)})]}),n.jsxs("div",{className:"flex justify-between border-t border-black py-1 print:py-0.5",children:[n.jsx("span",{className:"font-bold",children:"VAT (PPN) 11%"}),n.jsx("span",{className:"font-bold",children:i(e.tax_amount)})]}),n.jsxs("div",{className:"flex justify-between border-t-2 border-black py-1 print:py-0.5",children:[n.jsx("span",{className:"font-bold",children:"Total Credit"}),n.jsx("span",{className:"font-bold text-sm text-red-600 print:text-xs",children:i(e.total_amount)})]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-0 text-xs print:text-[10px]",children:[n.jsxs("div",{className:"p-3 border-r-2 border-black print:p-2",children:[n.jsx("p",{className:"font-semibold mb-2 print:mb-1",children:"Reason for Credit:"}),n.jsx("p",{className:"text-sm",children:e.reason})]}),n.jsxs("div",{className:"p-3 print:p-2",children:[n.jsx("p",{className:"font-semibold mb-1",children:"Authorized Signatory:"}),n.jsx("p",{className:"font-semibold mb-10 print:mb-8",children:"PT. SHUBHAM ANZEN PHARMA JAYA"}),n.jsx("div",{className:"w-4/5 border-t border-black pt-1",children:"Pharmacist"})]})]})]}),e.notes&&n.jsx("div",{className:"mt-3 border-2 border-black p-2 print:mt-2 print:p-1.5",children:n.jsxs("p",{className:"text-xs print:text-[10px]",children:[n.jsx("span",{className:"font-bold",children:"Notes: "}),n.jsx("span",{children:e.notes})]})})]})]})}),n.jsx("style",{children:`
        @media print {
          @page {
            size: A4 portrait;
            margin: 8mm;
          }

          .sticky {
            display: none !important;
          }

          body {
            margin: 0;
            padding: 0;
          }

          body * {
            visibility: hidden;
          }

          #credit-note-print-content,
          #credit-note-print-content * {
            visibility: visible;
          }

          #credit-note-print-content {
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            page-break-inside: avoid;
            page-break-after: auto;
          }

          #credit-note-print-content > div {
            page-break-inside: avoid;
          }

          table {
            page-break-inside: auto;
          }

          tr {
            page-break-inside: avoid;
            page-break-after: auto;
          }

          thead {
            display: table-header-group;
          }

          tfoot {
            display: table-footer-group;
          }
        }
      `})]})}function OAe(){const{t:e}=cn(),{user:t,profile:r}=Cr(),[a,s]=Q.useState([]),[i,o]=Q.useState(!0),[l,c]=Q.useState(!1),[d,u]=Q.useState(!1),[f,h]=Q.useState(null),[A,x]=Q.useState([]),[p,b]=Q.useState([]),[m,g]=Q.useState([]),[y,v]=Q.useState([]),[_,j]=Q.useState([]),[N,B]=Q.useState({credit_note_number:"",credit_note_date:new Date().toISOString().split("T")[0],customer_id:"",original_invoice_id:"",original_invoice_number:"",reason:"",notes:"",currency:"IDR"}),[E,C]=Q.useState([{product_id:"",batch_id:"",quantity:0,unit_price:0}]);Q.useEffect(()=>{k()},[]);const k=async()=>{o(!0),await w(),await T(),await R(),o(!1)},w=async()=>{try{const{data:ne,error:te}=await Z.from("credit_notes").select(`
          *,
          customers(company_name, address, city, phone, npwp, pharmacy_license)
        `).order("created_at",{ascending:!1});if(te)throw te;s(ne||[])}catch(ne){console.error("Error loading credit notes:",ne)}},T=async()=>{try{const{data:ne,error:te}=await Z.from("customers").select("id, company_name").eq("is_active",!0).order("company_name");if(te)throw te;b(ne||[])}catch(ne){console.error("Error loading customers:",ne)}},R=async()=>{try{const{data:ne,error:te}=await Z.from("products").select("id, product_name, product_code").eq("is_active",!0).order("product_name");if(te)throw te;g(ne||[])}catch(ne){console.error("Error loading products:",ne)}},q=async ne=>{try{const{data:te,error:ce}=await Z.from("batches").select("id, batch_number, product_id, current_stock").eq("product_id",ne).eq("is_active",!0).order("batch_number");if(ce)throw ce;v(te||[])}catch(te){console.error("Error loading batches:",te)}},z=async ne=>{h(ne);try{const{data:te,error:ce}=await Z.from("credit_note_items").select(`
          *,
          products(product_name, product_code),
          batches(batch_number)
        `).eq("credit_note_id",ne.id);if(ce)throw ce;x(te||[]),u(!0)}catch(te){console.error("Error loading credit note items:",te)}},ee=async ne=>{try{const{data:te,error:ce}=await Z.from("sales_invoices").select("id, invoice_number, invoice_date, total_amount").eq("customer_id",ne).order("invoice_date",{ascending:!1});if(ce)throw ce;j(te||[])}catch(te){console.error("Error loading invoices:",te)}},Y=ne=>{B({...N,customer_id:ne,original_invoice_id:"",original_invoice_number:""}),ne?ee(ne):j([])},G=async ne=>{const te=_.find(ce=>ce.id===ne);B({...N,original_invoice_id:ne,original_invoice_number:(te==null?void 0:te.invoice_number)||""}),ne?await re(ne):C([{product_id:"",batch_id:"",quantity:0,unit_price:0}])},re=async ne=>{try{const{data:te,error:ce}=await Z.from("sales_invoice_items").select(`
          product_id,
          batch_id,
          quantity,
          unit_price,
          products(product_name, product_code),
          batches(batch_number, current_stock)
        `).eq("invoice_id",ne);if(ce)throw ce;if(te&&te.length>0){const _e=te.map(de=>({product_id:de.product_id,batch_id:de.batch_id||"",quantity:de.quantity,unit_price:de.unit_price}));C(_e)}}catch(te){console.error("Error loading invoice items:",te)}},U=()=>{C([...E,{product_id:"",batch_id:"",quantity:0,unit_price:0}])},S=ne=>{E.length>1&&C(E.filter((te,ce)=>ce!==ne))},D=(ne,te,ce)=>{const _e=[...E];_e[ne]={..._e[ne],[te]:ce},te==="product_id"&&(q(ce),_e[ne].batch_id=""),C(_e)},L=()=>{const ne=E.reduce((_e,de)=>_e+de.quantity*de.unit_price,0),te=ne*.11,ce=ne+te;return{subtotal:ne,tax_amount:te,total_amount:ce}},P=async ne=>{if(ne.preventDefault(),!N.customer_id||!N.reason||E.length===0){alert("Please complete all required fields");return}if(E.some(ce=>!ce.product_id||!ce.batch_id||ce.quantity<=0||ce.unit_price<=0)){alert("Please complete all item details");return}try{const ce=L(),{data:_e,error:de}=await Z.from("credit_notes").insert({...N,...ce,created_by:t==null?void 0:t.id}).select().single();if(de)throw de;const ye=E.map(we=>({...we,credit_note_id:_e.id})),{error:Le}=await Z.from("credit_note_items").insert(ye);if(Le)throw Le;alert("Credit note created successfully. Stock has been added back to inventory."),c(!1),W(),k()}catch(ce){console.error("Error creating credit note:",ce),alert(ce.message||"Failed to create credit note. Please try again.")}},I=async ne=>{if(confirm("Approve this credit note? Stock will be adjusted accordingly."))try{const{error:te}=await Z.from("credit_notes").update({status:"approved",approved_by:t==null?void 0:t.id}).eq("id",ne);if(te)throw te;alert("Credit note approved successfully"),k()}catch(te){console.error("Error approving credit note:",te),alert(te.message||"Failed to approve credit note")}},H=async ne=>{const te=prompt("Enter reason for rejection:");if(te)try{const{error:ce}=await Z.from("credit_notes").update({status:"rejected",approved_by:t==null?void 0:t.id,notes:te}).eq("id",ne);if(ce)throw ce;alert("Credit note rejected"),k()}catch(ce){console.error("Error rejecting credit note:",ce),alert(ce.message||"Failed to reject credit note")}},V=async ne=>{if(confirm("Are you sure you want to delete this credit note? This will reverse the stock adjustment."))try{const{error:te}=await Z.from("credit_notes").delete().eq("id",ne);if(te)throw te;alert("Credit note deleted successfully"),k()}catch(te){console.error("Error deleting credit note:",te),alert(te.message||"Failed to delete credit note")}},W=()=>{B({credit_note_number:"",credit_note_date:new Date().toISOString().split("T")[0],customer_id:"",original_invoice_id:"",original_invoice_number:"",reason:"",notes:"",currency:"IDR"}),C([{product_id:"",batch_id:"",quantity:0,unit_price:0}])},M=(r==null?void 0:r.role)==="admin"||(r==null?void 0:r.role)==="sales"||(r==null?void 0:r.role)==="manager",se=(r==null?void 0:r.role)==="admin"||(r==null?void 0:r.role)==="manager",K=[{key:"credit_note_number",label:"Credit Note #",render:(ne,te)=>te.credit_note_number||"Pending"},{key:"credit_note_date",label:"Date",render:(ne,te)=>new Date(te.credit_note_date).toLocaleDateString()},{key:"customer",label:"Customer",render:(ne,te)=>{var ce;return((ce=te.customers)==null?void 0:ce.company_name)||"N/A"}},{key:"original_invoice_number",label:"Original Invoice",render:(ne,te)=>te.original_invoice_number||"N/A"},{key:"total_amount",label:"Amount",render:(ne,te)=>`${te.currency} ${te.total_amount.toLocaleString("id-ID",{minimumFractionDigits:2})}`},{key:"status",label:"Status",render:(ne,te)=>{var ce;return n.jsx("span",{className:`inline-block px-2 py-1 rounded-full text-xs font-medium ${te.status==="approved"?"bg-green-100 text-green-800":te.status==="rejected"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:((ce=te.status)==null?void 0:ce.replace("_"," "))||"pending approval"})}},{key:"reason",label:"Reason",render:(ne,te)=>n.jsx("span",{className:"text-sm text-gray-600 truncate max-w-xs block",children:te.reason})}],he=L();return n.jsx(Un,{children:n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Credit Notes"}),n.jsx("p",{className:"text-gray-600 mt-1",children:"Manage credit notes for returns and adjustments after invoicing"})]}),M&&n.jsxs("button",{onClick:()=>{W(),c(!0)},className:"flex items-center gap-2 bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition",children:[n.jsx(Pr,{className:"w-5 h-5"}),"Create Credit Note"]})]}),n.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 flex gap-3",children:[n.jsx(En,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}),n.jsxs("div",{className:"text-sm text-yellow-800",children:[n.jsx("p",{className:"font-medium",children:"When to use Credit Notes:"}),n.jsx("p",{className:"mt-1",children:"Use Credit Notes for goods returned or price adjustments AFTER an invoice has been issued and filed for tax purposes. For physical returns before invoicing, use Material Returns instead."})]})]}),n.jsx(Fs,{columns:K,data:a,loading:i,actions:ne=>n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>z(ne),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",title:"View Credit Note",children:n.jsx(bi,{className:"w-4 h-4"})}),se&&(!ne.status||ne.status==="pending_approval")&&n.jsxs(n.Fragment,{children:[n.jsx("button",{onClick:()=>I(ne.id),className:"p-1 text-green-600 hover:bg-green-50 rounded",title:"Approve Credit Note",children:n.jsx(Zr,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>H(ne.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Reject Credit Note",children:n.jsx(gn,{className:"w-4 h-4"})})]}),M&&(!ne.status||ne.status==="pending_approval")&&n.jsx("button",{onClick:()=>V(ne.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"Delete Credit Note",children:n.jsx(Lr,{className:"w-4 h-4"})})]})}),n.jsx(Ot,{isOpen:l,onClose:()=>{c(!1),W()},title:"Create Credit Note",children:n.jsxs("form",{onSubmit:P,className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer *"}),n.jsxs("select",{value:N.customer_id,onChange:ne=>Y(ne.target.value),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",children:[n.jsx("option",{value:"",children:"Select Customer"}),p.map(ne=>n.jsx("option",{value:ne.id,children:ne.company_name},ne.id))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Original Invoice (Optional)"}),n.jsxs("select",{value:N.original_invoice_id,onChange:ne=>G(ne.target.value),disabled:!N.customer_id,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent disabled:bg-gray-100",children:[n.jsx("option",{value:"",children:"Select Invoice"}),_.map(ne=>n.jsxs("option",{value:ne.id,children:[ne.invoice_number," - ",new Date(ne.invoice_date).toLocaleDateString()," - Rp ",ne.total_amount.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})]},ne.id))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Credit Note Date *"}),n.jsx("input",{type:"date",value:N.credit_note_date,onChange:ne=>B({...N,credit_note_date:ne.target.value}),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Currency"}),n.jsxs("select",{value:N.currency,onChange:ne=>B({...N,currency:ne.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",children:[n.jsx("option",{value:"IDR",children:"IDR"}),n.jsx("option",{value:"USD",children:"USD"})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reason for Credit Note *"}),n.jsx("textarea",{value:N.reason,onChange:ne=>B({...N,reason:ne.target.value}),required:!0,rows:2,placeholder:"e.g., Goods returned due to quality issue, Price adjustment, etc.",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent"})]}),n.jsxs("div",{className:"border-t pt-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsx("h4",{className:"text-sm font-semibold text-gray-900",children:"Items Being Credited"}),!N.original_invoice_id&&n.jsx("button",{type:"button",onClick:U,className:"text-sm text-red-600 hover:text-red-700 font-medium",children:"+ Add Item"})]}),n.jsx("div",{className:"space-y-3",children:E.map((ne,te)=>{var ce;return n.jsxs("div",{className:"p-3 border border-gray-200 rounded-lg space-y-2",children:[n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[n.jsxs("div",{children:[n.jsxs("select",{value:ne.product_id,onChange:_e=>D(te,"product_id",_e.target.value),required:!0,disabled:!!N.original_invoice_id,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg disabled:bg-gray-100",children:[n.jsx("option",{value:"",children:"Select Product"}),m.map(_e=>n.jsxs("option",{value:_e.id,children:[_e.product_name," (",_e.product_code,")"]},_e.id))]}),ne.product_id&&m.find(_e=>_e.id===ne.product_id)&&n.jsx("div",{className:"text-xs text-gray-500 mt-1",children:(ce=m.find(_e=>_e.id===ne.product_id))==null?void 0:ce.product_name})]}),n.jsx("div",{children:n.jsxs("select",{value:ne.batch_id,onChange:_e=>D(te,"batch_id",_e.target.value),required:!0,disabled:!ne.product_id||!!N.original_invoice_id,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg disabled:bg-gray-100",children:[n.jsx("option",{value:"",children:"Select Batch"}),y.filter(_e=>_e.product_id===ne.product_id).map(_e=>n.jsxs("option",{value:_e.id,children:[_e.batch_number," (Stock: ",_e.current_stock,")"]},_e.id))]})}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Quantity (Kg)"}),n.jsx("input",{type:"number",step:"0.001",placeholder:"Quantity in Kg",value:ne.quantity||"",onChange:_e=>D(te,"quantity",parseFloat(_e.target.value)||0),required:!0,min:"0.001",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Unit Price (per Kg)"}),n.jsx("input",{type:"number",step:"0.01",placeholder:"Price per Kg",value:ne.unit_price||"",onChange:_e=>D(te,"unit_price",parseFloat(_e.target.value)||0),required:!0,min:"0",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg"})]})]}),n.jsxs("div",{className:"flex items-center justify-between text-sm",children:[n.jsxs("span",{className:"text-gray-600",children:["Line Total: ",n.jsxs("span",{className:"font-semibold",children:[N.currency," ",(ne.quantity*ne.unit_price).toLocaleString("id-ID",{minimumFractionDigits:2})]})]}),E.length>1&&n.jsx("button",{type:"button",onClick:()=>S(te),className:"text-red-600 hover:text-red-800",children:n.jsx(Lr,{className:"w-4 h-4"})})]})]},te)})})]}),n.jsx("div",{className:"border-t pt-4",children:n.jsxs("div",{className:"space-y-2 text-sm",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"Subtotal:"}),n.jsxs("span",{className:"font-semibold",children:[N.currency," ",he.subtotal.toLocaleString("id-ID",{minimumFractionDigits:2})]})]}),n.jsxs("div",{className:"flex justify-between text-lg font-bold border-t pt-2",children:[n.jsx("span",{children:"Total Credit:"}),n.jsxs("span",{className:"text-red-600",children:[N.currency," ",he.total_amount.toLocaleString("id-ID",{minimumFractionDigits:2})]})]})]})}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Additional Notes"}),n.jsx("textarea",{value:N.notes,onChange:ne=>B({...N,notes:ne.target.value}),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent"})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[n.jsx("button",{type:"button",onClick:()=>{c(!1),W()},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),n.jsx("button",{type:"submit",className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition",children:"Create Credit Note"})]})]})}),d&&f&&n.jsx(PAe,{creditNote:f,items:A,onClose:()=>{u(!1),h(null),x([])}})]})})}function UAe({purchaseOrder:e,items:t,onClose:r}){const a=Q.useRef(null),{t:s,language:i}=cn(),o=p=>p==null?e.currency==="USD"?"$ 0.00":"Rp 0":e.currency==="USD"?`$ ${p.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`:`Rp ${p.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})}`,l=p=>{const b=new Date(p),m=i==="id"?["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agt","Sep","Okt","Nov","Des"]:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],g=b.getDate(),y=m[b.getMonth()],v=b.getFullYear();return`${g} ${y} ${v}`},c=p=>i==="id"?d(p):u(p),d=p=>{if(p===0)return"Nol";const b=["","Satu","Dua","Tiga","Empat","Lima","Enam","Tujuh","Delapan","Sembilan"],m=["Sepuluh","Sebelas","Dua Belas","Tiga Belas","Empat Belas","Lima Belas","Enam Belas","Tujuh Belas","Delapan Belas","Sembilan Belas"],g=["","","Dua Puluh","Tiga Puluh","Empat Puluh","Lima Puluh","Enam Puluh","Tujuh Puluh","Delapan Puluh","Sembilan Puluh"],y=v=>{if(v===0)return"";if(v<10)return b[v];if(v>=10&&v<20)return m[v-10];if(v<100){const B=Math.floor(v/10),E=v%10;return g[B]+(E>0?" "+b[E]:"")}const _=Math.floor(v/100),j=v%100;return(_===1?"Seratus":b[_]+" Ratus")+(j>0?" "+y(j):"")};if(p<1e3)return y(p);if(p<1e6){const v=Math.floor(p/1e3),_=p%1e3;return(v===1?"Seribu":y(v)+" Ribu")+(_>0?" "+y(_):"")}if(p<1e9){const v=Math.floor(p/1e6),_=p%1e6,j=y(v)+" Juta",N=_>=1e3?(Math.floor(_/1e3)===1?"Seribu":y(Math.floor(_/1e3))+" Ribu")+(_%1e3>0?" "+y(_%1e3):""):_>0?y(_):"";return j+(N?" "+N:"")}return p.toString()},u=p=>{if(p===0)return"Zero";const b=["","One","Two","Three","Four","Five","Six","Seven","Eight","Nine"],m=["Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"],g=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"],y=v=>{if(v===0)return"";if(v<10)return b[v];if(v>=10&&v<20)return m[v-10];if(v<100){const N=Math.floor(v/10),B=v%10;return g[N]+(B>0?" "+b[B]:"")}const _=Math.floor(v/100),j=v%100;return b[_]+" Hundred"+(j>0?" "+y(j):"")};if(p<1e3)return y(p);if(p<1e6){const v=Math.floor(p/1e3),_=p%1e3;return y(v)+" Thousand"+(_>0?" "+y(_):"")}if(p<1e9){const v=Math.floor(p/1e6),_=p%1e6,j=_>=1e3?y(Math.floor(_/1e3))+" Thousand"+(_%1e3>0?" "+y(_%1e3):""):_>0?y(_):"";return y(v)+" Million"+(j?" "+j:"")}return p.toString()},f=()=>{window.print()},h=async()=>{if(a.current)try{const p=await Zo(a.current,{scale:2,useCORS:!0,allowTaint:!0,logging:!1,backgroundColor:"#ffffff"}),b=p.toDataURL("image/png"),m=new Ut("p","mm","a4"),g=m.internal.pageSize.getWidth(),y=m.internal.pageSize.getHeight(),v=p.width,_=p.height,j=g/v,N=_*j;if(N>y){let B=0,E=N;for(;E>0;)m.addImage(b,"PNG",0,B,g,N),E-=y,B-=y,E>0&&m.addPage()}else m.addImage(b,"PNG",0,0,g,N);m.save(`PO-${e.po_number}.pdf`)}catch(p){console.error("Error generating PDF:",p),alert("Failed to generate PDF. Please try again.")}},A=e.suppliers,x=e.currency==="USD"?"USD":"IDR";return n.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto bg-gray-900 bg-opacity-75 print:static print:bg-white print:overflow-visible",children:[n.jsx("div",{className:"flex min-h-screen items-start justify-center p-4 pt-10 print:p-0 print:min-h-0 print:block",children:n.jsxs("div",{className:"relative w-full max-w-5xl bg-white shadow-xl print:shadow-none print:max-w-full",children:[n.jsxs("div",{className:"sticky top-0 z-10 flex items-center justify-between border-b bg-white px-6 py-4 print:hidden",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:["Purchase Order ",e.po_number]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("button",{onClick:f,className:"flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-2 text-white hover:bg-blue-700",children:[n.jsx($l,{className:"h-4 w-4"}),"Print"]}),n.jsxs("button",{onClick:h,className:"flex items-center gap-2 rounded-lg bg-green-600 px-4 py-2 text-white hover:bg-green-700",children:[n.jsx(Zn,{className:"h-4 w-4"}),"PDF"]}),n.jsx("button",{onClick:r,className:"rounded-lg bg-gray-100 p-2 text-gray-600 hover:bg-gray-200",children:n.jsx(wr,{className:"h-5 w-5"})})]})]}),n.jsxs("div",{id:"po-print-content",ref:a,className:"p-8",children:[n.jsxs("div",{className:"mb-3 border-2 border-black p-3 print:mb-2 print:p-2",children:[n.jsxs("div",{className:"mb-2 flex items-start justify-between",children:[n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"h-16 w-16 flex items-center justify-center print:h-12 print:w-12",children:n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",xmlSpace:"preserve",width:"100%",height:"100%",viewBox:"0 0 15686.55 15480.24",style:{shapeRendering:"geometricPrecision",fillRule:"evenodd",clipRule:"evenodd"},children:n.jsxs("g",{children:[n.jsx("path",{fill:"#FDB763",d:"M69.94 10438.12l10353.39 0 0 -1798.67 1665.92 0 0 1868.6 0 320.44 0 4552.28c0,38.48 -31.45,69.94 -69.94,69.94l-11949.38 0c-38.48,0 -69.94,-31.45 -69.94,-69.94l0 -4872.72c0,-38.48 31.45,-69.94 69.94,-69.94zm1605.9 1710.15l8737.57 0c13.58,0 24.68,11.11 24.68,24.68l0 1719.84c0,13.58 -11.11,24.68 -24.68,24.68l-8737.57 0c-13.58,0 -24.68,-11.11 -24.68,-24.68l0 -1719.84c0,-13.58 11.11,-24.68 24.68,-24.68z"}),n.jsx("path",{fill:"#FDB763",d:"M15587.15 5136.67l-10353.49 0 0 1822.07 -1665.92 0 0 -1892.9 0 -324.61 0 -4611.43c0,-39 31.45,-70.87 69.94,-70.87l11949.47 0c38.48,0 69.94,31.87 69.94,70.87l0 4936.04c0,39 -31.45,70.83 -69.94,70.83zm-1605.9 -1732.36l-8737.67 0c-13.58,0 -24.68,-11.27 -24.68,-25l0 -1742.21c0,-13.74 11.11,-25 24.68,-25l8737.67 0c13.58,0 24.68,11.27 24.68,25l0 1742.21c0,13.74 -11.11,25 -24.68,25z"}),n.jsx("polygon",{fill:"#FD6D26",points:"-0,0 1651.16,0 1651.16,6929.27 15657.09,6929.27 15657.09,6958.74 15686.55,6958.74 15686.55,15480.24 14022.85,15480.24 14022.85,8639.45 1651.16,8639.45 -0,8639.45 -0,6929.27"})]})})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-base font-bold print:text-sm",children:"PT. SHUBHAM ANZEN PHARMA JAYA"}),n.jsx("p",{className:"text-xs print:text-[10px]",children:"Komplek Ruko Metro Sunter Blok A1 NO.15, Jl. Metro Indah Raya,"}),n.jsx("p",{className:"text-xs print:text-[10px]",children:"Kelurahan Papanggo, Kec. Tanjung Priok, Jakarta Utara - 14340"}),n.jsx("p",{className:"text-xs print:text-[10px]",children:"Telp: (+62 21) 65832426"})]})]}),n.jsx("div",{className:"text-right",children:n.jsx("h2",{className:"text-3xl font-bold print:text-2xl",children:"PURCHASE ORDER"})})]}),n.jsxs("div",{className:"text-xs space-y-0.5 print:text-[10px] print:space-y-0",children:[n.jsxs("div",{children:[n.jsx("span",{className:"font-semibold",children:"No izin PBF"}),n.jsx("span",{className:"ml-16",children:": 27092400534390007"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"font-semibold",children:"No Sertifikasi CDOB"}),n.jsx("span",{className:"ml-4",children:": 270924005343900070001"})]})]})]}),n.jsx("div",{className:"mb-3 border-2 border-black p-3 print:mb-2 print:p-2",children:n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("div",{className:"space-y-1 text-xs print:text-[10px] print:space-y-0 flex-1",children:[n.jsxs("div",{children:[n.jsx("span",{className:"font-bold",children:"Supplier:"}),n.jsxs("span",{className:"font-semibold",children:[" ",(A==null?void 0:A.company_name)||""]})]}),n.jsxs("div",{className:"pt-1 flex",children:[n.jsx("span",{className:"font-bold",style:{minWidth:"72px"},children:"Address:"}),n.jsxs("div",{children:[n.jsx("p",{children:(A==null?void 0:A.address)||""}),n.jsx("p",{children:(A==null?void 0:A.city)||""})]})]}),n.jsxs("div",{className:"flex pt-1",children:[n.jsx("span",{className:"font-bold",style:{minWidth:"72px"},children:"Phone:"}),n.jsx("span",{children:(A==null?void 0:A.phone)||""})]}),n.jsxs("div",{className:"flex",children:[n.jsx("span",{className:"font-bold",style:{minWidth:"72px"},children:"Contact:"}),n.jsx("span",{children:(A==null?void 0:A.contact_person)||""})]})]}),n.jsxs("div",{className:"space-y-1 text-xs print:text-[10px] print:space-y-0 text-right",style:{minWidth:"200px"},children:[n.jsxs("div",{children:[n.jsx("span",{className:"font-bold",children:"PO No:"}),n.jsx("span",{className:"ml-2",children:e.po_number})]}),n.jsxs("div",{children:[n.jsx("span",{className:"font-bold",children:"PO Date:"}),n.jsx("span",{className:"ml-2",children:l(e.po_date)})]}),n.jsxs("div",{className:"pt-1",children:[n.jsx("span",{className:"font-bold",children:"Expected Delivery:"}),n.jsx("span",{className:"ml-2",children:e.expected_delivery_date?l(e.expected_delivery_date):"N/A"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"font-bold",children:"Payment Terms:"}),n.jsx("span",{className:"ml-2",children:e.payment_terms||"N/A"})]})]})]})}),n.jsx("div",{children:n.jsxs("table",{className:"w-full border-2 border-black text-xs print:text-[10px]",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"border-b-2 border-black bg-white",children:[n.jsx("th",{className:"border-r border-black p-1.5 text-center font-bold print:p-1",children:"No."}),n.jsx("th",{className:"border-r border-black p-1.5 text-left font-bold print:p-1",children:"Product Name"}),n.jsx("th",{className:"border-r border-black p-1.5 text-left font-bold print:p-1",children:"Specification"}),n.jsx("th",{className:"border-r border-black p-1.5 text-center font-bold print:p-1",children:"COA No."}),n.jsx("th",{className:"border-r border-black p-1.5 text-center font-bold print:p-1",children:"Quantity"}),n.jsx("th",{className:"border-r border-black p-1.5 text-center font-bold print:p-1",children:"UOM"}),n.jsxs("th",{className:"border-r border-black p-1.5 text-right font-bold print:p-1",children:["Unit Price (",x,")"]}),n.jsx("th",{className:"border-r border-black p-1.5 text-center font-bold print:p-1",children:"Disc%"}),n.jsxs("th",{className:"p-1.5 text-right font-bold print:p-1",children:["Sub Total (",x,")"]})]})}),n.jsxs("tbody",{children:[t.map((p,b)=>{var m;return n.jsxs("tr",{className:"border-b border-black",children:[n.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:b+1}),n.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:((m=p.products)==null?void 0:m.product_name)||"Unknown Product"}),n.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:p.specification||"-"}),n.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:p.coa_code||"-"}),n.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:p.quantity.toLocaleString()}),n.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:p.unit}),n.jsx("td",{className:"border-r border-black p-1.5 text-right print:p-1",children:o(p.unit_price)}),n.jsxs("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:[p.discount_percent,"%"]}),n.jsx("td",{className:"p-1.5 text-right print:p-1",children:o(p.line_total)})]},p.id||b)}),t.length<2&&Array.from({length:2-t.length}).map((p,b)=>n.jsxs("tr",{className:"border-b border-black",children:[n.jsx("td",{className:"border-r border-black p-1.5 text-center print:p-1",children:""}),n.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),n.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),n.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),n.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),n.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),n.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),n.jsx("td",{className:"border-r border-black p-1.5 print:p-1",children:""}),n.jsx("td",{className:"p-1.5 print:p-1",children:""})]},`empty-${b}`))]})]})}),n.jsxs("div",{className:"border-2 border-black border-t-0",children:[n.jsxs("div",{className:"flex items-stretch border-b-2 border-black",children:[n.jsxs("div",{className:"flex-1 p-2 border-r-2 border-black print:p-1.5",children:[n.jsx("p",{className:"text-xs font-bold print:text-[10px]",children:"Amount in words:"}),n.jsxs("p",{className:"text-xs mt-0.5 font-bold uppercase print:text-[10px] print:mt-0",children:[x," ",c(Math.round(e.total_amount))," ",e.currency==="USD"?"DOLLARS":"RUPIAH"]})]}),n.jsx("div",{className:"w-80 text-xs p-2 print:text-[10px] print:p-1.5",children:n.jsxs("div",{className:"flex justify-between border-t-2 border-black py-1 print:py-0.5",children:[n.jsx("span",{className:"font-bold",children:"Total Amount"}),n.jsx("span",{className:"font-bold text-sm print:text-xs",children:o(e.total_amount)})]})})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-0 text-xs print:text-[10px]",children:[n.jsxs("div",{className:"p-3 border-r-2 border-black print:p-2",children:[n.jsx("p",{className:"font-semibold mb-1",children:"Delivery Address:"}),n.jsx("p",{className:"whitespace-pre-line",children:e.delivery_address||"Same as company address"})]}),n.jsxs("div",{className:"p-3 print:p-2",children:[n.jsx("p",{className:"font-semibold mb-1",children:"Authorized By:"}),n.jsx("p",{className:"font-semibold mb-10 print:mb-8",children:"PT. SHUBHAM ANZEN PHARMA JAYA"}),n.jsx("div",{className:"w-4/5 border-t border-black pt-1",children:"Authorized Signatory"})]})]})]}),(e.notes||e.terms_conditions)&&n.jsxs("div",{className:"mt-3 border-2 border-black p-2 print:mt-2 print:p-1.5",children:[e.notes&&n.jsx("div",{className:"mb-2",children:n.jsxs("p",{className:"text-xs print:text-[10px]",children:[n.jsx("span",{className:"font-bold",children:"Notes: "}),n.jsx("span",{children:e.notes})]})}),e.terms_conditions&&n.jsx("div",{children:n.jsxs("p",{className:"text-xs print:text-[10px]",children:[n.jsx("span",{className:"font-bold",children:"Terms & Conditions: "}),n.jsx("span",{children:e.terms_conditions})]})})]})]})]})}),n.jsx("style",{children:`
        @media print {
          @page {
            size: A4 portrait;
            margin: 8mm;
          }

          .print\\:hidden {
            display: none !important;
          }

          body {
            margin: 0;
            padding: 0;
          }

          body * {
            visibility: hidden;
          }

          #po-print-content,
          #po-print-content * {
            visibility: visible;
          }

          #po-print-content {
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
          }
        }
      `})]})}function RAe(){const{user:e,profile:t}=Cr(),[r,a]=Q.useState([]),[s,i]=Q.useState([]),[o,l]=Q.useState([]),[c,d]=Q.useState([]),[u,f]=Q.useState(!0),[h,A]=Q.useState(""),[x,p]=Q.useState("all"),[b,m]=Q.useState(!1),[g,y]=Q.useState(!1),[v,_]=Q.useState(null),[j,N]=Q.useState(null),[B,E]=Q.useState({supplier_id:"",po_date:new Date().toISOString().split("T")[0],expected_delivery_date:"",delivery_address:"",currency:"IDR",exchange_rate:1,payment_terms:"Net 30",notes:"",terms_conditions:""}),[C,k]=Q.useState([{line_number:1,product_id:"",description:"",quantity:0,unit:"",unit_price:0,discount_percent:0,discount_amount:0,line_total:0,quantity_received:0,quantity_pending:0,coa_code:"",specification:""}]);Q.useEffect(()=>{w(),T(),R()},[]),Q.useEffect(()=>{q()},[h,x,r]);const w=async()=>{try{f(!0);const{data:W,error:M}=await Z.from("purchase_orders").select(`
          *,
          suppliers (
            id,
            company_name,
            contact_person,
            email,
            phone,
            address
          ),
          purchase_order_items (
            *,
            products (
              id,
              product_name,
              product_code,
              unit
            )
          )
        `).order("created_at",{ascending:!1});if(M)throw M;a(W||[])}catch(W){console.error("Error fetching purchase orders:",W.message),alert("Failed to load purchase orders")}finally{f(!1)}},T=async()=>{try{const{data:W,error:M}=await Z.from("suppliers").select("id, company_name, contact_person, email, phone").eq("is_active",!0).order("company_name");if(M)throw M;l(W||[])}catch(W){console.error("Error fetching suppliers:",W.message)}},R=async()=>{try{const{data:W,error:M}=await Z.from("products").select("id, product_name, product_code, unit").eq("is_active",!0).order("product_name");if(M)throw M;d(W||[])}catch(W){console.error("Error fetching products:",W.message)}},q=()=>{let W=r;h&&(W=W.filter(M=>{var se;return M.po_number.toLowerCase().includes(h.toLowerCase())||((se=M.suppliers)==null?void 0:se.company_name.toLowerCase().includes(h.toLowerCase()))})),x!=="all"&&(W=W.filter(M=>M.status===x)),i(W)},z=W=>{const M={draft:{color:"bg-gray-100 text-gray-800",label:"Draft"},pending_approval:{color:"bg-yellow-100 text-yellow-800",label:"Pending Approval"},approved:{color:"bg-green-100 text-green-800",label:"Approved"},partially_received:{color:"bg-blue-100 text-blue-800",label:"Partially Received"},received:{color:"bg-purple-100 text-purple-800",label:"Received"},cancelled:{color:"bg-red-100 text-red-800",label:"Cancelled"}},se=M[W]||M.draft;return n.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded ${se.color}`,children:se.label})},ee=(W,M)=>M==="USD"?`$ ${W.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`:`Rp ${W.toLocaleString("id-ID",{minimumFractionDigits:2,maximumFractionDigits:2})}`,Y=()=>{N(null),E({supplier_id:"",po_date:new Date().toISOString().split("T")[0],expected_delivery_date:"",delivery_address:"",currency:"IDR",exchange_rate:1,payment_terms:"Net 30",notes:"",terms_conditions:""}),k([{line_number:1,product_id:"",description:"",quantity:0,unit:"",unit_price:0,discount_percent:0,discount_amount:0,line_total:0,quantity_received:0,quantity_pending:0}]),m(!0)},G=W=>{N(W),E({supplier_id:W.supplier_id,po_date:W.po_date,expected_delivery_date:W.expected_delivery_date||"",delivery_address:W.delivery_address||"",currency:W.currency,exchange_rate:W.exchange_rate,payment_terms:W.payment_terms||"Net 30",notes:W.notes||"",terms_conditions:W.terms_conditions||""}),k(W.purchase_order_items||[]),m(!0)},re=(W,M)=>{const se=c.find(K=>K.id===M);if(se){const K=[...C];K[W]={...K[W],product_id:M,description:se.product_name,unit:se.unit,unit_price:0},U(W,K),k(K)}},U=(W,M)=>{const se=M[W],K=se.quantity*se.unit_price,he=K*se.discount_percent/100;M[W].discount_amount=he,M[W].line_total=K-he},S=()=>{k([...C,{line_number:C.length+1,product_id:"",description:"",quantity:0,unit:"",unit_price:0,discount_percent:0,discount_amount:0,line_total:0,quantity_received:0,quantity_pending:0,coa_code:"",specification:""}])},D=W=>{C.length>1&&k(C.filter((M,se)=>se!==W))},L=()=>{const W=C.reduce((K,he)=>K+he.line_total,0);return{subtotal:W,tax:0,total:W}},P=async W=>{if(W.preventDefault(),!B.supplier_id){alert("Please select a supplier");return}if(!B.po_date){alert("Please select a PO date");return}if(C.length===0||!C[0].product_id){alert("Please add at least one product");return}for(let M=0;M<C.length;M++){const se=C[M];if(!se.product_id){alert(`Please select a product for line ${M+1}`);return}if(se.quantity<=0){alert(`Please enter a valid quantity for line ${M+1}`);return}if(se.unit_price<=0){alert(`Please enter a valid unit price for line ${M+1}`);return}}try{const{subtotal:M,tax:se,total:K}=L(),he={...B,subtotal:M,tax_amount:se,total_amount:K,status:"draft",created_by:e==null?void 0:e.id};if(j){const{error:ne}=await Z.from("purchase_orders").update(he).eq("id",j.id);if(ne)throw ne;await Z.from("purchase_order_items").delete().eq("po_id",j.id);const te=C.map((_e,de)=>({po_id:j.id,line_number:de+1,product_id:_e.product_id,description:_e.description,quantity:_e.quantity,unit:_e.unit,unit_price:_e.unit_price,discount_percent:_e.discount_percent||0,discount_amount:_e.discount_amount||0,line_total:_e.line_total,quantity_received:0,coa_code:_e.coa_code||null,specification:_e.specification||null,notes:_e.notes||null})),{error:ce}=await Z.from("purchase_order_items").insert(te);if(ce)throw ce;alert("Purchase Order updated successfully!")}else{const{data:ne,error:te}=await Z.from("purchase_orders").insert(he).select().single();if(te)throw te;const ce=C.map((de,ye)=>({po_id:ne.id,line_number:ye+1,product_id:de.product_id,description:de.description,quantity:de.quantity,unit:de.unit,unit_price:de.unit_price,discount_percent:de.discount_percent||0,discount_amount:de.discount_amount||0,line_total:de.line_total,quantity_received:0,coa_code:de.coa_code||null,specification:de.specification||null,notes:de.notes||null})),{error:_e}=await Z.from("purchase_order_items").insert(ce);if(_e)throw _e;alert("Purchase Order created successfully!")}m(!1),w()}catch(M){console.error("Error saving purchase order:",M),alert("Failed to save purchase order: "+M.message)}},I=async W=>{if(confirm("Approve this Purchase Order?"))try{const{error:M}=await Z.from("purchase_orders").update({status:"approved",approved_by:e==null?void 0:e.id,approved_at:new Date().toISOString()}).eq("id",W);if(M)throw M;alert("Purchase Order approved successfully!"),w()}catch(M){console.error("Error approving PO:",M),alert("Failed to approve PO: "+M.message)}},H=async W=>{if(confirm("Are you sure you want to delete this Purchase Order?"))try{const{error:M}=await Z.from("purchase_orders").delete().eq("id",W);if(M)throw M;alert("Purchase Order deleted successfully!"),w()}catch(M){console.error("Error deleting PO:",M),alert("Failed to delete PO: "+M.message)}},V=W=>{_(W),y(!0)};return u?n.jsx(Un,{children:n.jsx("div",{className:"flex items-center justify-center h-64",children:n.jsx("div",{className:"text-gray-500",children:"Loading..."})})}):n.jsx(Un,{children:n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"mb-6 flex justify-between items-center",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Purchase Orders"}),n.jsx("p",{className:"text-gray-600",children:"Manage procurement from suppliers"})]}),n.jsxs("button",{onClick:Y,className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:[n.jsx(Pr,{className:"h-5 w-5"}),"New Purchase Order"]})]}),n.jsxs("div",{className:"mb-6 flex gap-4",children:[n.jsx("div",{className:"flex-1",children:n.jsxs("div",{className:"relative",children:[n.jsx(Ca,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),n.jsx("input",{type:"text",placeholder:"Search PO number, supplier...",value:h,onChange:W=>A(W.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg"})]})}),n.jsxs("select",{value:x,onChange:W=>p(W.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg",children:[n.jsx("option",{value:"all",children:"All Status"}),n.jsx("option",{value:"draft",children:"Draft"}),n.jsx("option",{value:"pending_approval",children:"Pending Approval"}),n.jsx("option",{value:"approved",children:"Approved"}),n.jsx("option",{value:"partially_received",children:"Partially Received"}),n.jsx("option",{value:"received",children:"Received"}),n.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"PO Number"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Supplier"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Products"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Total Amount"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s.map(W=>{var M;return n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:W.po_number}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(W.po_date).toLocaleDateString()}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(M=W.suppliers)==null?void 0:M.company_name}),n.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:n.jsx("div",{className:"flex flex-col gap-1 max-w-xs",children:W.purchase_order_items&&W.purchase_order_items.length>0?n.jsxs(n.Fragment,{children:[W.purchase_order_items.slice(0,2).map((se,K)=>{var he;return n.jsxs("div",{className:"flex items-center gap-1 text-xs",children:[n.jsx(Rr,{className:"w-3 h-3 text-blue-500 flex-shrink-0"}),n.jsxs("span",{className:"truncate",children:[((he=se.products)==null?void 0:he.product_name)||se.description,n.jsxs("span",{className:"text-gray-400 ml-1",children:["",se.quantity]})]})]},K)}),W.purchase_order_items.length>2&&n.jsxs("span",{className:"text-xs text-gray-400 italic",children:["+",W.purchase_order_items.length-2," more"]})]}):n.jsx("span",{className:"text-gray-400 text-xs italic",children:"No items"})})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 font-medium",children:ee(W.total_amount,W.currency)}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:z(W.status)}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{onClick:()=>V(W),className:"text-blue-600 hover:text-blue-800",title:"View",children:n.jsx(bi,{className:"h-5 w-5"})}),W.status==="draft"&&n.jsxs(n.Fragment,{children:[n.jsx("button",{onClick:()=>G(W),className:"text-green-600 hover:text-green-800",title:"Edit",children:n.jsx(Aa,{className:"h-5 w-5"})}),n.jsx("button",{onClick:()=>H(W.id),className:"text-red-600 hover:text-red-800",title:"Delete",children:n.jsx(Lr,{className:"h-5 w-5"})})]}),W.status==="draft"&&(t==null?void 0:t.role)==="admin"&&n.jsx("button",{onClick:()=>I(W.id),className:"text-purple-600 hover:text-purple-800",title:"Approve",children:n.jsx(Zr,{className:"h-5 w-5"})})]})})]},W.id)})})]}),s.length===0&&n.jsx("div",{className:"text-center py-12 text-gray-500",children:"No purchase orders found"})]}),b&&n.jsx(Ot,{isOpen:b,onClose:()=>m(!1),title:j?"Edit Purchase Order":"New Purchase Order",maxWidth:"max-w-6xl",children:n.jsxs("form",{onSubmit:P,className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Supplier *"}),n.jsx(Qo,{value:B.supplier_id,onChange:W=>E({...B,supplier_id:W}),options:o.map(W=>({value:W.id,label:W.company_name})),placeholder:"Select Supplier",className:"text-sm",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"PO Date"}),n.jsx("input",{type:"date",value:B.po_date,onChange:W=>E({...B,po_date:W.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Expected Delivery"}),n.jsx("input",{type:"date",value:B.expected_delivery_date,onChange:W=>E({...B,expected_delivery_date:W.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500"})]})]}),n.jsxs("div",{className:"grid grid-cols-6 gap-3",children:[n.jsxs("div",{className:"col-span-1",children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Currency"}),n.jsxs("select",{value:B.currency,onChange:W=>E({...B,currency:W.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",children:[n.jsx("option",{value:"IDR",children:"IDR"}),n.jsx("option",{value:"USD",children:"USD"})]})]}),n.jsxs("div",{className:"col-span-5",children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Payment Terms"}),n.jsxs("select",{value:B.payment_terms,onChange:W=>E({...B,payment_terms:W.target.value}),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",required:!0,children:[n.jsx("option",{value:"Net 7",children:"Net 7"}),n.jsx("option",{value:"Net 15",children:"Net 15"}),n.jsx("option",{value:"Net 30",children:"Net 30"}),n.jsx("option",{value:"Net 45",children:"Net 45"}),n.jsx("option",{value:"Net 60",children:"Net 60"}),n.jsx("option",{value:"Net 90",children:"Net 90"}),n.jsx("option",{value:"Advance",children:"Advance Payment"}),n.jsx("option",{value:"50-50",children:"50% Advance & 50% on Delivery"}),n.jsx("option",{value:"COD",children:"Cash on Delivery"})]})]})]}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex justify-between items-center mb-2",children:[n.jsx("label",{className:"block text-xs font-semibold text-gray-700",children:"Items"}),n.jsx("button",{type:"button",onClick:S,className:"text-xs text-blue-600 hover:text-blue-800 font-medium",children:"+ Add Item"})]}),n.jsx("div",{className:"border border-gray-300 rounded overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-2 py-1.5 text-left text-xs font-medium text-gray-600 whitespace-nowrap",style:{width:"180px"},children:"Product"}),n.jsx("th",{className:"px-2 py-1.5 text-left text-xs font-medium text-gray-600 whitespace-nowrap",style:{width:"120px"},children:"Specification"}),n.jsx("th",{className:"px-2 py-1.5 text-left text-xs font-medium text-gray-600 whitespace-nowrap",style:{width:"80px"},children:"COA No"}),n.jsx("th",{className:"px-2 py-1.5 text-left text-xs font-medium text-gray-600 whitespace-nowrap",style:{width:"60px"},children:"Qty"}),n.jsx("th",{className:"px-2 py-1.5 text-left text-xs font-medium text-gray-600 whitespace-nowrap",style:{width:"50px"},children:"Unit"}),n.jsx("th",{className:"px-2 py-1.5 text-left text-xs font-medium text-gray-600 whitespace-nowrap",style:{width:"90px"},children:"Price"}),n.jsx("th",{className:"px-2 py-1.5 text-left text-xs font-medium text-gray-600 whitespace-nowrap",style:{width:"50px"},children:"Disc%"}),n.jsx("th",{className:"px-2 py-1.5 text-left text-xs font-medium text-gray-600 whitespace-nowrap",style:{width:"100px"},children:"Total"}),n.jsx("th",{className:"px-2 py-1.5 text-center text-xs font-medium text-gray-600",style:{width:"40px"}})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:C.map((W,M)=>n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-2 py-1",children:n.jsx(Qo,{value:W.product_id,onChange:se=>re(M,se),options:c.map(se=>({value:se.id,label:se.product_name})),placeholder:"Select",className:"text-xs",required:!0})}),n.jsx("td",{className:"px-2 py-1",children:n.jsx("input",{type:"text",value:W.specification||"",onChange:se=>{const K=[...C];K[M].specification=se.target.value,k(K)},className:"w-full px-1.5 py-1 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",placeholder:"Specs"})}),n.jsx("td",{className:"px-2 py-1",children:n.jsx("input",{type:"text",value:W.coa_code||"",onChange:se=>{const K=[...C];K[M].coa_code=se.target.value,k(K)},className:"w-full px-1.5 py-1 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",placeholder:"COA"})}),n.jsx("td",{className:"px-2 py-1",children:n.jsx("input",{type:"number",value:W.quantity,onChange:se=>{const K=[...C];K[M].quantity=parseFloat(se.target.value)||0,U(M,K),k(K)},className:"w-full px-1.5 py-1 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 text-right",required:!0})}),n.jsx("td",{className:"px-2 py-1",children:n.jsx("input",{type:"text",value:W.unit,className:"w-full px-1.5 py-1 text-xs border border-gray-300 rounded bg-gray-50",readOnly:!0})}),n.jsx("td",{className:"px-2 py-1",children:n.jsx("input",{type:"number",value:W.unit_price,onChange:se=>{const K=[...C];K[M].unit_price=parseFloat(se.target.value)||0,U(M,K),k(K)},className:"w-full px-1.5 py-1 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 text-right",required:!0})}),n.jsx("td",{className:"px-2 py-1",children:n.jsx("input",{type:"number",value:W.discount_percent,onChange:se=>{const K=[...C];K[M].discount_percent=parseFloat(se.target.value)||0,U(M,K),k(K)},className:"w-full px-1.5 py-1 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 text-right"})}),n.jsx("td",{className:"px-2 py-1",children:n.jsx("input",{type:"text",value:ee(W.line_total,B.currency),readOnly:!0,className:"w-full px-1.5 py-1 text-xs border border-gray-300 rounded bg-gray-50 text-right font-medium"})}),n.jsx("td",{className:"px-2 py-1 text-center",children:C.length>1&&n.jsx("button",{type:"button",onClick:()=>D(M),className:"text-red-600 hover:text-red-800 p-0.5",children:n.jsx(Lr,{className:"h-4 w-4"})})})]},M))})]})})]}),n.jsx("div",{className:"border-t pt-2",children:n.jsx("div",{className:"flex justify-end",children:n.jsx("div",{className:"w-56",children:n.jsxs("div",{className:"flex justify-between text-base font-bold bg-gray-50 px-3 py-2 rounded",children:[n.jsx("span",{children:"Total:"}),n.jsx("span",{children:ee(L().total,B.currency)})]})})})}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Notes"}),n.jsx("textarea",{value:B.notes,onChange:W=>E({...B,notes:W.target.value}),rows:2,className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500",placeholder:"Additional notes or instructions..."})]}),n.jsxs("div",{className:"flex justify-end gap-3",children:[n.jsx("button",{type:"button",onClick:()=>m(!1),className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),n.jsxs("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[j?"Update":"Create"," Purchase Order"]})]})]})}),g&&v&&n.jsx(UAe,{purchaseOrder:v,items:v.purchase_order_items||[],onClose:()=>{y(!1),_(null)}})]})})}function MAe(){const{profile:e}=Cr(),{setCurrentPage:t}=Go(),[r,a]=Q.useState([]),[s,i]=Q.useState(!1),[o,l]=Q.useState(!1);Q.useEffect(()=>{(e==null?void 0:e.role)==="admin"&&c()},[e]);const c=async()=>{try{const f=[],{data:h}=await Z.from("sales_orders").select(`
          id,
          so_number,
          so_date,
          total_amount,
          customers (company_name)
        `).eq("status","pending_approval").order("created_at",{ascending:!1}).limit(5);h&&h.forEach(x=>{var p;f.push({id:x.id,type:"sales_order",number:x.so_number,customer_name:((p=x.customers)==null?void 0:p.company_name)||"Unknown",amount:x.total_amount,date:x.so_date})});const{data:A}=await Z.from("delivery_challans").select(`
          id,
          challan_number,
          challan_date,
          customers (company_name)
        `).eq("approval_status","pending_approval").order("created_at",{ascending:!1}).limit(5);A&&A.forEach(x=>{var p;f.push({id:x.id,type:"delivery_challan",number:x.challan_number,customer_name:((p=x.customers)==null?void 0:p.company_name)||"Unknown",date:x.challan_date})}),a(f),f.length>0&&!o&&i(!0)}catch(f){console.error("Error loading pending approvals:",f)}},d=f=>{i(!1),l(!0),f.type==="sales_order"?t("sales-orders"):t("delivery-challan")},u=()=>{i(!1),l(!0)};return!s||r.length===0?null:n.jsxs("div",{className:"fixed bottom-4 right-4 z-50 w-96 max-h-[600px] overflow-hidden rounded-lg shadow-2xl bg-white border border-gray-200 animate-slide-up",children:[n.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 text-white px-4 py-3 flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),n.jsx("h3",{className:"font-semibold",children:"Pending Approvals"}),n.jsx("span",{className:"bg-white/20 text-xs px-2 py-0.5 rounded-full",children:r.length})]}),n.jsx("button",{onClick:u,className:"text-white/80 hover:text-white transition",children:n.jsx(wr,{className:"w-5 h-5"})})]}),n.jsx("div",{className:"max-h-[500px] overflow-y-auto",children:r.map((f,h)=>n.jsx("div",{className:`p-4 border-b border-gray-100 hover:bg-gray-50 cursor-pointer transition ${h===0?"bg-blue-50":""}`,onClick:()=>d(f),children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:`p-2 rounded-lg ${f.type==="sales_order"?"bg-blue-100 text-blue-600":"bg-green-100 text-green-600"}`,children:f.type==="sales_order"?n.jsx(Zt,{className:"w-5 h-5"}):n.jsx(us,{className:"w-5 h-5"})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-start justify-between gap-2",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-semibold text-gray-900",children:f.type==="sales_order"?"Sales Order":"Delivery Challan"}),n.jsx("p",{className:"text-xs text-gray-600 mt-0.5",children:f.number})]}),n.jsx("span",{className:"text-xs text-gray-500 whitespace-nowrap",children:new Date(f.date).toLocaleDateString("en-GB",{day:"2-digit",month:"short"})})]}),n.jsx("p",{className:"text-sm text-gray-700 mt-1 truncate",children:f.customer_name}),f.amount&&n.jsxs("p",{className:"text-xs font-medium text-blue-600 mt-1",children:["Rp ",f.amount.toLocaleString("id-ID",{minimumFractionDigits:0,maximumFractionDigits:0})]}),h===0&&n.jsx("div",{className:"flex items-center gap-2 mt-2",children:n.jsx("span",{className:"text-xs text-blue-600 font-medium",children:"Click to review "})})]})]})},`${f.type}-${f.id}`))}),n.jsx("div",{className:"bg-gray-50 px-4 py-3 text-center",children:n.jsx("p",{className:"text-xs text-gray-500",children:"Click on an item above to review and approve"})}),n.jsx("style",{children:`
        @keyframes slide-up {
          from {
            transform: translateY(100%);
            opacity: 0;
          }
          to {
            transform: translateY(0);
            opacity: 1;
          }
        }
        .animate-slide-up {
          animation: slide-up 0.3s ease-out;
        }
      `})]})}async function tN(e){try{const{error:t}=await Z.from("notifications").insert([{user_id:e.userId,type:e.type,title:e.title,message:e.message,reference_id:e.referenceId||null,reference_type:e.referenceType||null,is_read:!1}]);if(t)throw t}catch(t){console.error("Error creating notification:",t)}}async function PS(){var e;try{const{data:t}=await Z.from("products").select("id, product_name, min_stock_level").gt("min_stock_level",0);if(!t||t.length===0)return;const r=[];for(const a of t){const{data:s}=await Z.from("batches").select("current_stock").eq("product_id",a.id).eq("is_active",!0),i=(s==null?void 0:s.reduce((o,l)=>o+(l.current_stock||0),0))||0;i<a.min_stock_level&&r.push({product_name:a.product_name,current_stock:i,min_stock_level:a.min_stock_level})}if(r&&r.length>0){const{data:a}=await Z.from("user_profiles").select("id").eq("is_active",!0).in("role",["admin","warehouse"]);if(a)for(const s of a)(e=(await Z.from("notifications").select("id").eq("user_id",s.id).eq("type","low_stock").eq("is_read",!1).limit(1)).data)!=null&&e.length||await tN({userId:s.id,type:"low_stock",title:"Low Stock Alert",message:`${r.length} batch(es) are running low on stock.`})}}catch(t){console.error("Error checking low stock:",t)}}async function OS(){var e;try{const{data:t}=await Z.from("app_settings").select("expiry_alert_days").maybeSingle(),r=(t==null?void 0:t.expiry_alert_days)||30,a=new Date;a.setDate(a.getDate()+r);const{data:s}=await Z.from("batches").select("id, batch_number, expiry_date, products(product_name)").eq("is_active",!0).not("expiry_date","is",null).lte("expiry_date",a.toISOString()).gte("expiry_date",new Date().toISOString());if(s&&s.length>0){const{data:i}=await Z.from("user_profiles").select("id").eq("is_active",!0).in("role",["admin","warehouse","sales"]);if(i)for(const o of i)(e=(await Z.from("notifications").select("id").eq("user_id",o.id).eq("type","near_expiry").eq("is_read",!1).limit(1)).data)!=null&&e.length||await tN({userId:o.id,type:"near_expiry",title:"Products Near Expiry",message:`${s.length} batch(es) will expire within ${r} days.`})}}catch(t){console.error("Error checking expiry dates:",t)}}async function US(){try{const e=new Date().toISOString().split("T")[0],{data:t}=await Z.from("crm_activities").select("id, customer_id, activity_type, crm_contacts(company_name)").eq("is_completed",!1).not("follow_up_date","is",null).lte("follow_up_date",e);if(t&&t.length>0){const{data:r}=await Z.from("user_profiles").select("id").eq("is_active",!0).in("role",["admin","sales"]);if(r)for(const a of r)await tN({userId:a.id,type:"follow_up",title:"Follow-ups Due",message:`You have ${t.length} follow-up(s) due today.`})}}catch(e){console.error("Error checking follow-ups:",e)}}let V1=null;async function QAe(){V1&&clearInterval(V1),await PS(),await OS(),await US(),V1=setInterval(async()=>{await PS(),await OS(),await US()},6e5)}function HAe(){const{user:e,profile:t,loading:r}=Cr(),{currentPage:a}=Go();if(Q.useEffect(()=>{let i;if(e&&t){const o=setTimeout(()=>{QAe()},2e3);i=()=>clearTimeout(o)}return i},[e,t]),window.location.pathname==="/setup")return n.jsx(SAe,{});if(window.location.pathname==="/auth/gmail/callback")return n.jsx(BAe,{});if(r)return n.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600 mx-auto"}),n.jsx("p",{className:"mt-4 text-gray-600",children:"Loading..."})]})});if(!e||!t)return n.jsx(t7,{});const s=()=>{switch(a){case"dashboard":return n.jsx(S5,{});case"products":return n.jsx(P7,{});case"stock":return n.jsx(Q7,{});case"batches":return n.jsx(K7,{});case"inventory":return n.jsx(dV,{});case"customers":return n.jsx(M7,{});case"sales-orders":return n.jsx(TAe,{});case"purchase-orders":return n.jsx(RAe,{});case"import-requirements":return n.jsx(DAe,{});case"import-containers":return n.jsx(LAe,{});case"crm":return n.jsx(Lue,{});case"command-center":return n.jsx(Hue,{});case"tasks":return n.jsx($ue,{});case"delivery-challan":return n.jsx(Wue,{});case"sales":return n.jsx(Xue,{});case"credit-notes":return n.jsx(OAe,{});case"material-returns":return n.jsx(EF,{});case"finance":return n.jsx(bAe,{});case"settings":return n.jsx(CAe,{});default:return n.jsx(S5,{})}};return n.jsxs(n.Fragment,{children:[s(),n.jsx(MAe,{}),n.jsx(I7,{})]})}function qAe(){return n.jsx(JU,{children:n.jsx(ZU,{children:n.jsx(e7,{children:n.jsx(HAe,{})})})})}ZB(document.getElementById("root")).render(n.jsx(Q.StrictMode,{children:n.jsx(qAe,{})}));export{zr as _,hi as c,RS as g};
